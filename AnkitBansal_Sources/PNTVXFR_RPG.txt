     H/TITLE PFS Reopen Order      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/30/23  Time  : 09:54:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFNCPL5IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FCAB7CPLNIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Order/Trans Sel ERR
      *
     FPPBMCPL4IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      *
     FPPBKCPL7IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      *
     FOPEYCPL0UF  E           K        DISK
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FCAB7CPL0UF  E           K        DISK
      * UPD : Item Transaction Detail   Update index
      *
     FPPBMCPL0UF  E           K        DISK
      * UPD : PFS Ship Order Detail     Update index
      *
     FPPBKCPL0UF  E           K        DISK
      * UPD : PFS Ship Load/Order Sts   Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@EYCPZE
      * Order Events              Co/Order/Event Code
      * Renamed input format fields
     I              EYAIC3                          WAAIC3
     I              EYC4NB                          WAC4NB
     I              EYQ2NB                          WAQ2NB
     I              EYJPCD                          WAJPCD
     I              EYAUC3                          WAAUC3
     I              EYQ7NB                          WAQ7NB
     I              EYOMST                          WAOMST
     I              EYD2DT                          WAD2DT
     I              EYONST                          WAONST
     I              EYOOST                          WAOOST
     I              EYOPST                          WAOPST
     I              EYAWC3                          WAAWC3
     I              EYQ8NB                          WAQ8NB
     I              EYQ9NB                          WAQ9NB
     I              EYBKC7                          WABKC7
     I              EYUVST                          WAUVST
     I              EYUWST                          WAUWST
     I              EYUXST                          WAUXST
     I              EYAATM                          WAAATM
     I              EYAYNA                          WAAYNA
     I              EYA0NA                          WAA0NA
     I              EYAXDT                          WAAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WEAIC3
     I              EOBKC7                          WEBKC7
     I              EOAQCD                          WEAQCD
     I              EOR4CD                          WER4CD
     I              EOBYNA                          WEBYNA
     I              EOB6NA                          WEB6NA
     I              EOBZNA                          WEBZNA
     I              EOLLST                          WELLST
     I              EOPPST                          WEPPST
     I              EOR5NB                          WER5NB
     I              EOR6NB                          WER6NB
     I              EOQGST                          WEQGST
     I              EOBOCD                          WEBOCD
     I              EOTBNB                          WETBNB
     I              EOMTCU                          WEMTCU
     I              EOW2NB                          WEW2NB
     I              EORPCD                          WERPCD
     I              EOAJCD                          WEAJCD
     I              EOX9ST                          WEX9ST
     I              EOT9CD                          WET9CD
     I              EOUBCD                          WEUBCD
     I              EOISTX                          WEISTX
     I              EOLQCD                          WELQCD
     I              EONJNA                          WENJNA
     I              EOI0TX                          WEI0TX
     I              EONKNA                          WENKNA
     I              EOI1TX                          WEI1TX
     I              EOVLST                          WEVLST
     I              EORLST                          WERLST
     I              EOMMTX                          WEMMTX
     I              EOOHNA                          WEOHNA
     I              EOQ6ST                          WEQ6ST
     I              EOQ8ST                          WEQ8ST
     I              EORBST                          WERBST
     I              EOREST                          WEREST
     I              EOUVST                          WEUVST
     I              EOUWST                          WEUWST
     I              EOUXST                          WEUXST
     I              EOVSST                          WEVSST
     I              EOAATM                          WEAATM
     I              EOAYNA                          WEAYNA
     I              EOA0NA                          WEA0NA
     I              EOAXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@FNCPEZ
      * Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      * Renamed input format fields
     I              FNAIC3                          WGAIC3
     I              FNC4NB                          WGC4NB
     I              FNDPNB                          WGDPNB
     I              FNUENB                          WGUENB
     I              FNRZNB                          WGRZNB
     I              FNFOQT                          WGFOQT
     I              FNR0NB                          WGR0NB
     I              FNPMST                          WGPMST
     I              FNK7DT                          WGK7DT
     I              FNPFNX                          WGPFNX
     I              FNHGCD                          WGHGCD
     I              FNAJCD                          WGAJCD
     I              FNELDT                          WGELDT
     I              FNN5WG                          WGN5WG
     I              FNRZNA                          WGRZNA
     I              FNH5NY                          WGH5NY
     I              FNH6NY                          WGH6NY
     I              FNH7NY                          WGH7NY
     I              FNGBTX                          WGGBTX
     I              FNN6WG                          WGN6WG
     I              FNN7WG                          WGN7WG
     I              FNGCTX                          WGGCTX
     I              FNGDTX                          WGGDTX
     I              FNRBDT                          WGRBDT
     I              FNITNY                          WGITNY
     I              FNIVNY                          WGIVNY
     I              FNIUNY                          WGIUNY
     I              FNIWNY                          WGIWNY
     I              FNIXNY                          WGIXNY
     I              FNIYNY                          WGIYNY
     I              FNUVST                          WGUVST
     I              FNUWST                          WGUWST
     I              FNUXST                          WGUXST
     I              FNVSST                          WGVSST
     I              FNAATM                          WGAATM
     I              FNAYNA                          WGAYNA
     I              FNA0NA                          WGA0NA
     I              FNAXDT                          WGAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WHAIC3
     I              BZHGCD                          WHHGCD
     I              BZAVNA                          WHAVNA
     I              BZAWNA                          WHAWNA
     I              BZL7NA                          WHL7NA
     I              BZL8NA                          WHL8NA
     I              BZL6NA                          WHL6NA
     I              BZMFNA                          WHMFNA
     I              BZADCD                          WHADCD
     I              BZAWPC                          WHAWPC
     I              BZLXST                          WHLXST
     I              BZAECD                          WHAECD
     I              BZAXPC                          WHAXPC
     I              BZLYST                          WHLYST
     I              BZAFCD                          WHAFCD
     I              BZAICD                          WHAICD
     I              BZAIWG                          WHAIWG
     I              BZHICD                          WHHICD
     I              BZRBCD                          WHRBCD
     I              BZFZST                          WHFZST
     I              BZAVST                          WHAVST
     I              BZCZWG                          WHCZWG
     I              BZC0WG                          WHC0WG
     I              BZURTN                          WHURTN
     I              BZAJC8                          WHAJC8
     I              BZRINB                          WHRINB
     I              BZRHNB                          WHRHNB
     I              BZRGNB                          WHRGNB
     I              BZLNCD                          WHLNCD
     I              BZTFNB                          WHTFNB
     I              BZN0CD                          WHN0CD
     I              BZX4ST                          WHX4ST
     I              BZTMVA                          WHTMVA
     I              BZTNVA                          WHTNVA
     I              BZBLPR                          WHBLPR
     I              BZBMPR                          WHBMPR
     I              BZLRCD                          WHLRCD
     I              BZU9ST                          WHU9ST
     I              BZCMCO                          WHCMCO
     I              BZQ1CD                          WHQ1CD
     I              BZQ8CD                          WHQ8CD
     I              BZCHTM                          WHCHTM
     I              BZQZCD                          WHQZCD
     I              BZXWST                          WHXWST
     I              BZXXST                          WHXXST
     I              BZVMST                          WHVMST
     I              BZSWGH                          WHSWGH
     I              BZPPHE                          WHPPHE
     I              BZR3CD                          WHR3CD
     I              BZSDCD                          WHSDCD
     I              BZICN1                          WHICN1
     I              BZSVCD                          WHSVCD
     I              BZICN2                          WHICN2
     I              BZSWCD                          WHSWCD
     I              BZV2NB                          WHV2NB
     I              BZSXCD                          WHSXCD
     I              BZITCN                          WHITCN
     I              BZSYCD                          WHSYCD
     I              BZITC5                          WHITC5
     I              BZSZCD                          WHSZCD
     I              BZICN6                          WHICN6
     I              BZS0CD                          WHS0CD
     I              BZICN7                          WHICN7
     I              BZS1CD                          WHS1CD
     I              BZICN8                          WHICN8
     I              BZS2CD                          WHS2CD
     I              BZICN9                          WHICN9
     I              BZS3CD                          WHS3CD
     I              BZICN0                          WHICN0
     I              BZS4CD                          WHS4CD
     I              BZSFNB                          WHSFNB
     I              BZA3WG                          WHA3WG
     I              BZSJNB                          WHSJNB
     I              BZLLCD                          WHLLCD
     I              BZLMCD                          WHLMCD
     I              BZP3ST                          WHP3ST
     I              BZSKNB                          WHSKNB
     I              BZSLNB                          WHSLNB
     I              BZSMNB                          WHSMNB
     I              BZP4ST                          WHP4ST
     I              BZCFNB                          WHCFNB
     I              BZCGNB                          WHCGNB
     I              BZILNB                          WHILNB
     I              BZCHNB                          WHCHNB
     I              BZCINB                          WHCINB
     I              BZCJNB                          WHCJNB
     I              BZCMNB                          WHCMNB
     I              BZCNNB                          WHCNNB
     I              BZCRNB                          WHCRNB
     I              BZCSNB                          WHCSNB
     I              BZCVNB                          WHCVNB
     I              BZCWNB                          WHCWNB
     I              BZCXNB                          WHCXNB
     I              BZCZNB                          WHCZNB
     I              BZC0NB                          WHC0NB
     I              BZN1CD                          WHN1CD
     I              BZB4NB                          WHB4NB
     I              BZB5NB                          WHB5NB
     I              BZX5ST                          WHX5ST
     I              BZX6ST                          WHX6ST
     I              BZX7ST                          WHX7ST
     I              BZPCCT                          WHPCCT
     I              BZBDNB                          WHBDNB
     I              BZBJNB                          WHBJNB
     I              BZSUST                          WHSUST
     I              BZSVST                          WHSVST
     I              BZSYST                          WHSYST
     I              BZSZST                          WHSZST
     I              BZS1ST                          WHS1ST
     I              BZXRCD                          WHXRCD
     I              BZXTCD                          WHXTCD
     I              BZXUCD                          WHXUCD
     I              BZF5WG                          WHF5WG
     I              BZF6WG                          WHF6WG
     I              BZF7WG                          WHF7WG
     I              BZBLNB                          WHBLNB
     I              BZBNNB                          WHBNNB
     I              BZS2ST                          WHS2ST
     I              BZS4ST                          WHS4ST
     I              BZS5ST                          WHS5ST
     I              BZS6ST                          WHS6ST
     I              BZS8ST                          WHS8ST
     I              BZS9ST                          WHS9ST
     I              BZTCST                          WHTCST
     I              BZTDST                          WHTDST
     I              BZUVST                          WHUVST
     I              BZUWST                          WHUWST
     I              BZUXST                          WHUXST
     I              BZVSST                          WHVSST
     I              BZAATM                          WHAATM
     I              BZAYNA                          WHAYNA
     I              BZA0NA                          WHA0NA
     I              BZAXDT                          WHAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@L8CPZO
      * Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      * Renamed input format fields
     I              L8AIC3                          WKAIC3
     I              L8C4NB                          WKC4NB
     I              L8DPNB                          WKDPNB
     I              L8UENB                          WKUENB
     I              L8ALSW                          WKALSW
     I              L8J6QT                          WKJ6QT
     I              L8G9WG                          WKG9WG
     I              L8J9QT                          WKJ9QT
     I              L8HAWG                          WKHAWG
     I              L8IOSE                          WKIOSE
     I              L8OIMN                          WKOIMN
     I              L8SOAS                          WKSOAS
     I              L8ARSX                          WKARSX
     I              L8OTUS                          WKOTUS
     I              L8OTMP                          WKOTMP
     I              L8HGCD                          WKHGCD
     I              L8AJCD                          WKAJCD
     I              L8ELDT                          WKELDT
     I              L8LXNM                          WKLXNM
     I              L8YMCD                          WKYMCD
     I              L8YNCD                          WKYNCD
     I              L8UVST                          WKUVST
     I              L8UWST                          WKUWST
     I              L8UXST                          WKUXST
     I              L8VSST                          WKVSST
     I              L8AATM                          WKAATM
     I              L8AYNA                          WKAYNA
     I              L8A0NA                          WKA0NA
     I              L8AXDT                          WKAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WLAIC3
     I              L7HGCD                          WLHGCD
     I              L7AJCD                          WLAJCD
     I              L7LTRT                          WLLTRT
     I              L7LRDT                          WLLRDT
     I              L7LLTS                          WLLLTS
     I              L7LSDT                          WLLSDT
     I              L7J5QT                          WLJ5QT
     I              L7G8WG                          WLG8WG
     I              L7LLTN                          WLLLTN
     I              L7YMCD                          WLYMCD
     I              L7LLCL                          WLLLCL
     I              L7BNAA                          WLBNAA
     I              L7LLTR                          WLLLTR
     I              L7Y2CD                          WLY2CD
     I              L7LLTL                          WLLLTL
     I              L7C4NB                          WLC4NB
     I              L7LOST                          WLLOST
     I              L7LLTU                          WLLLTU
     I              L7LLYT                          WLLLYT
     I              L7UVST                          WLUVST
     I              L7UWST                          WLUWST
     I              L7UXST                          WLUXST
     I              L7VSST                          WLVSST
     I              L7AATM                          WLAATM
     I              L7AYNA                          WLAYNA
     I              L7A0NA                          WLA0NA
     I              L7AXDT                          WLAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WMAIC3
     I              L7HGCD                          WMHGCD
     I              L7AJCD                          WMAJCD
     I              L7LTRT                          WMLTRT
     I              L7LRDT                          WMLRDT
     I              L7LLTS                          WMLLTS
     I              L7LSDT                          WMLSDT
     I              L7J5QT                          WMJ5QT
     I              L7G8WG                          WMG8WG
     I              L7LLTN                          WMLLTN
     I              L7YMCD                          WMYMCD
     I              L7LLCL                          WMLLCL
     I              L7BNAA                          WMBNAA
     I              L7LLTR                          WMLLTR
     I              L7Y2CD                          WMY2CD
     I              L7LLTL                          WMLLTL
     I              L7C4NB                          WMC4NB
     I              L7LOST                          WMLOST
     I              L7LLTU                          WMLLTU
     I              L7LLYT                          WMLLYT
     I              L7UVST                          WMUVST
     I              L7UWST                          WMUWST
     I              L7UXST                          WMUXST
     I              L7VSST                          WMVSST
     I              L7AATM                          WMAATM
     I              L7AYNA                          WMAYNA
     I              L7A0NA                          WMA0NA
     I              L7AXDT                          WMAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WOAIC3
     I              L5HGCD                          WOHGCD
     I              L5AJCD                          WOAJCD
     I              L5ELDT                          WOELDT
     I              L5LXNM                          WOLXNM
     I              L5YMCD                          WOYMCD
     I              L5YNCD                          WOYNCD
     I              L5J2QT                          WOJ2QT
     I              L5G5WG                          WOG5WG
     I              L5J3QT                          WOJ3QT
     I              L5G6WG                          WOG6WG
     I              L5J4QT                          WOJ4QT
     I              L5G7WG                          WOG7WG
     I              L5LODT                          WOLODT
     I              L5LPDT                          WOLPDT
     I              L5LQDT                          WOLQDT
     I              L5NBR                           WONBR
     I              L5YTCD                          WOYTCD
     I              L5AMSX                          WOAMSX
     I              L5ASSX                          WOASSX
     I              L5ATSX                          WOATSX
     I              L5AUSX                          WOAUSX
     I              L5YSCD                          WOYSCD
     I              L5UVST                          WOUVST
     I              L5UWST                          WOUWST
     I              L5UXST                          WOUXST
     I              L5VSST                          WOVSST
     I              L5AATM                          WOAATM
     I              L5AYNA                          WOAYNA
     I              L5A0NA                          WOA0NA
     I              L5AXDT                          WOAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WRAJCD
     I              L2YMCD                          WRYMCD
     I              L2YPCD                          WRYPCD
     I              L2LCBY                          WRLCBY
     I              L2LCCT                          WRLCCT
     I              L2WLUS                          WRWLUS
     I              L2WUSD                          WRWUSD
     I              L2WLUN                          WRWLUN
     I              L2AGSX                          WRAGSX
     I              L2UVST                          WRUVST
     I              L2UWST                          WRUWST
     I              L2UXST                          WRUXST
     I              L2VSST                          WRVSST
     I              L2AATM                          WRAATM
     I              L2AYNA                          WRAYNA
     I              L2A0NA                          WRA0NA
     I              L2AXDT                          WRAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WSAGSX
     I              MEOPNA                          WSOPNA
     I              MESLTY                          WSSLTY
     I              MEAHSX                          WSAHSX
     I              MEAISX                          WSAISX
     I              MEUVST                          WSUVST
     I              MEUWST                          WSUWST
     I              MEUXST                          WSUXST
     I              MEVSST                          WSVSST
     I              MEAATM                          WSAATM
     I              MEAYNA                          WSAYNA
     I              MEA0NA                          WSA0NA
     I              MEAXDT                          WSAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WTAIC3
     I              L5HGCD                          WTHGCD
     I              L5AJCD                          WTAJCD
     I              L5ELDT                          WTELDT
     I              L5LXNM                          WTLXNM
     I              L5YMCD                          WTYMCD
     I              L5YNCD                          WTYNCD
     I              L5J2QT                          WTJ2QT
     I              L5G5WG                          WTG5WG
     I              L5J3QT                          WTJ3QT
     I              L5G6WG                          WTG6WG
     I              L5J4QT                          WTJ4QT
     I              L5G7WG                          WTG7WG
     I              L5LODT                          WTLODT
     I              L5LPDT                          WTLPDT
     I              L5LQDT                          WTLQDT
     I              L5NBR                           WTNBR
     I              L5YTCD                          WTYTCD
     I              L5AMSX                          WTAMSX
     I              L5ASSX                          WTASSX
     I              L5ATSX                          WTATSX
     I              L5AUSX                          WTAUSX
     I              L5YSCD                          WTYSCD
     I              L5UVST                          WTUVST
     I              L5UWST                          WTUWST
     I              L5UXST                          WTUXST
     I              L5VSST                          WTVSST
     I              L5AATM                          WTAATM
     I              L5AYNA                          WTAYNA
     I              L5A0NA                          WTA0NA
     I              L5AXDT                          WTAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WVAIC3
     I              B1HGCD                          WVHGCD
     I              B1AJCD                          WVAJCD
     I              B1ELDT                          WVELDT
     I              B1ABWG                          WVABWG
     I              B1AGQT                          WVAGQT
     I              B1AHQT                          WVAHQT
     I              B1AIQT                          WVAIQT
     I              B1CTST                          WVCTST
     I              B1ACWG                          WVACWG
     I              B1ARQT                          WVARQT
     I              B1ASQT                          WVASQT
     I              B1ATQT                          WVATQT
     I              B1HDQT                          WVHDQT
     I              B1HEQT                          WVHEQT
     I              B1F6ST                          WVF6ST
     I              B1BMWG                          WVBMWG
     I              B1DSQT                          WVDSQT
     I              B1DTQT                          WVDTQT
     I              B1DUQT                          WVDUQT
     I              B1DHDT                          WVDHDT
     I              B1AGCS                          WVAGCS
     I              B1AECS                          WVAECS
     I              B1IDVA                          WVIDVA
     I              B1K7DT                          WVK7DT
     I              B1RINB                          WVRINB
     I              B1RHNB                          WVRHNB
     I              B1RGNB                          WVRGNB
     I              B1UVST                          WVUVST
     I              B1UWST                          WVUWST
     I              B1UXST                          WVUXST
     I              B1VSST                          WVVSST
     I              B1AATM                          WVAATM
     I              B1AYNA                          WVAYNA
     I              B1A0NA                          WVA0NA
     I              B1AXDT                          WVAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WWAIC3
     I              L8C4NB                          WWC4NB
     I              L8DPNB                          WWDPNB
     I              L8UENB                          WWUENB
     I              L8ALSW                          WWALSW
     I              L8J6QT                          WWJ6QT
     I              L8G9WG                          WWG9WG
     I              L8J9QT                          WWJ9QT
     I              L8HAWG                          WWHAWG
     I              L8IOSE                          WWIOSE
     I              L8OIMN                          WWOIMN
     I              L8SOAS                          WWSOAS
     I              L8ARSX                          WWARSX
     I              L8OTUS                          WWOTUS
     I              L8OTMP                          WWOTMP
     I              L8HGCD                          WWHGCD
     I              L8AJCD                          WWAJCD
     I              L8ELDT                          WWELDT
     I              L8LXNM                          WWLXNM
     I              L8YMCD                          WWYMCD
     I              L8YNCD                          WWYNCD
     I              L8UVST                          WWUVST
     I              L8UWST                          WWUWST
     I              L8UXST                          WWUXST
     I              L8VSST                          WWVSST
     I              L8AATM                          WWAATM
     I              L8AYNA                          WWAYNA
     I              L8A0NA                          WWA0NA
     I              L8AXDT                          WWAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WXRMNB
     I              FJAIC3                          WXAIC3
     I              FJAODT                          WXAODT
     I              FJPJST                          WXPJST
     I              FJPKST                          WXPKST
     I              FJRNNB                          WXRNNB
     I              FJDMTX                          WXDMTX
     I              FJDNTX                          WXDNTX
     I              FJDOTX                          WXDOTX
     I              FJWTTX                          WXWTTX
     I              FJWUTX                          WXWUTX
     I              FJRPNB                          WXRPNB
     I              FJFLAM                          WXFLAM
     I              FJXQST                          WXXQST
     I              FJRRNB                          WXRRNB
     I              FJDXTX                          WXDXTX
     I              FJDYTX                          WXDYTX
     I              FJSBNB                          WXSBNB
     I              FJBZNA                          WXBZNA
     I              FJRONB                          WXRONB
     I              FJSQNB                          WXSQNB
     I              FJR1NB                          WXR1NB
     I              FJVCST                          WXVCST
     I              FJVDST                          WXVDST
     I              FJSDNB                          WXSDNB
     I              FJPAOU                          WXPAOU
     I              FJDGWG                          WXDGWG
     I              FJSXNB                          WXSXNB
     I              FJHADT                          WXHADT
     I              FJAART                          WXAART
     I              FJDHWG                          WXDHWG
     I              FJDIWG                          WXDIWG
     I              FJAQDT                          WXAQDT
     I              FJS6NB                          WXS6NB
     I              FJT4NB                          WXT4NB
     I              FJPRTM                          WXPRTM
     I              FJNPSV                          WXNPSV
     I              FJJ8TX                          WXJ8TX
     I              FJTLMI                          WXTLMI
     I              FJJ9TX                          WXJ9TX
     I              FJQ2CD                          WXQ2CD
     I              FJVPCD                          WXVPCD
     I              FJDBCD                          WXDBCD
     I              FJGRWE                          WXGRWE
     I              FJXCCD                          WXXCCD
     I              FJU2ST                          WXU2ST
     I              FJF9DT                          WXF9DT
     I              FJONTM                          WXONTM
     I              FJJ4DT                          WXJ4DT
     I              FJTRTM                          WXTRTM
     I              FJJ5DT                          WXJ5DT
     I              FJSPTM                          WXSPTM
     I              FJJ6DT                          WXJ6DT
     I              FJLFTM                          WXLFTM
     I              FJJ7DT                          WXJ7DT
     I              FJBOTM                          WXBOTM
     I              FJJ8DT                          WXJ8DT
     I              FJBLTM                          WXBLTM
     I              FJKIDT                          WXKIDT
     I              FJASTM                          WXASTM
     I              FJKADT                          WXKADT
     I              FJAJCM                          WXAJCM
     I              FJXACD                          WXXACD
     I              FJOANA                          WXOANA
     I              FJK4TX                          WXK4TX
     I              FJVOAG                          WXVOAG
     I              FJKBDT                          WXKBDT
     I              FJNBBO                          WXNBBO
     I              FJW4CD                          WXW4CD
     I              FJEFDT                          WXEFDT
     I              FJCNTN                          WXCNTN
     I              FJKCDT                          WXKCDT
     I              FJTMIN                          WXTMIN
     I              FJKDDT                          WXKDDT
     I              FJVMNB                          WXVMNB
     I              FJOCFR                          WXOCFR
     I              FJKJDT                          WXKJDT
     I              FJATTM                          WXATTM
     I              FJOTRS                          WXOTRS
     I              FJRNST                          WXRNST
     I              FJBRBK                          WXBRBK
     I              FJEIDT                          WXEIDT
     I              FJRMST                          WXRMST
     I              FJAJCD                          WXAJCD
     I              FJKKDT                          WXKKDT
     I              FJAVTM                          WXAVTM
     I              FJKZDT                          WXKZDT
     I              FJAXTM                          WXAXTM
     I              FJLHOS                          WXLHOS
     I              FJLHOR                          WXLHOR
     I              FJWNTX                          WXWNTX
     I              FJOITX                          WXOITX
     I              FJOJTX                          WXOJTX
     I              FJLLDT                          WXLLDT
     I              FJLSHG                          WXLSHG
     I              FJYPST                          WXYPST
     I              FJK0DT                          WXK0DT
     I              FJAYTM                          WXAYTM
     I              FJKNNX                          WXKNNX
     I              FJICWG                          WXICWG
     I              FJIDWG                          WXIDWG
     I              FJH9SX                          WXH9SX
     I              FJWOTX                          WXWOTX
     I              FJK1DT                          WXK1DT
     I              FJAZTM                          WXAZTM
     I              FJK2DT                          WXK2DT
     I              FJA0TM                          WXA0TM
     I              FJROST                          WXROST
     I              FJRPST                          WXRPST
     I              FJRQST                          WXRQST
     I              FJRRST                          WXRRST
     I              FJZBVA                          WXZBVA
     I              FJWPTX                          WXWPTX
     I              FJWQTX                          WXWQTX
     I              FJWRTX                          WXWRTX
     I              FJWSTX                          WXWSTX
     I              FJRVSX                          WXRVSX
     I              FJRUSX                          WXRUSX
     I              FJRWSX                          WXRWSX
     I              FJRXSX                          WXRXSX
     I              FJRYSX                          WXRYSX
     I              FJRZSX                          WXRZSX
     I              FJR0SX                          WXR0SX
     I              FJR1SX                          WXR1SX
     I              FJR2SX                          WXR2SX
     I              FJR3SX                          WXR3SX
     I              FJR4SX                          WXR4SX
     I              FJPYDT                          WXPYDT
     I              FJCKTM                          WXCKTM
     I              FJPZDT                          WXPZDT
     I              FJCLTM                          WXCLTM
     I              FJP0DT                          WXP0DT
     I              FJCMTM                          WXCMTM
     I              FJP1DT                          WXP1DT
     I              FJCNTM                          WXCNTM
     I              FJP2DT                          WXP2DT
     I              FJCOTM                          WXCOTM
     I              FJP3DT                          WXP3DT
     I              FJCQTM                          WXCQTM
     I              FJUVST                          WXUVST
     I              FJUWST                          WXUWST
     I              FJUXST                          WXUXST
     I              FJAATM                          WXAATM
     I              FJAYNA                          WXAYNA
     I              FJA0NA                          WXA0NA
     I              FJAXDT                          WXAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WYRMNB
     I              FJAIC3                          WYAIC3
     I              FJAODT                          WYAODT
     I              FJPJST                          WYPJST
     I              FJPKST                          WYPKST
     I              FJRNNB                          WYRNNB
     I              FJDMTX                          WYDMTX
     I              FJDNTX                          WYDNTX
     I              FJDOTX                          WYDOTX
     I              FJWTTX                          WYWTTX
     I              FJWUTX                          WYWUTX
     I              FJRPNB                          WYRPNB
     I              FJFLAM                          WYFLAM
     I              FJXQST                          WYXQST
     I              FJRRNB                          WYRRNB
     I              FJDXTX                          WYDXTX
     I              FJDYTX                          WYDYTX
     I              FJSBNB                          WYSBNB
     I              FJBZNA                          WYBZNA
     I              FJRONB                          WYRONB
     I              FJSQNB                          WYSQNB
     I              FJR1NB                          WYR1NB
     I              FJVCST                          WYVCST
     I              FJVDST                          WYVDST
     I              FJSDNB                          WYSDNB
     I              FJPAOU                          WYPAOU
     I              FJDGWG                          WYDGWG
     I              FJSXNB                          WYSXNB
     I              FJHADT                          WYHADT
     I              FJAART                          WYAART
     I              FJDHWG                          WYDHWG
     I              FJDIWG                          WYDIWG
     I              FJAQDT                          WYAQDT
     I              FJS6NB                          WYS6NB
     I              FJT4NB                          WYT4NB
     I              FJPRTM                          WYPRTM
     I              FJNPSV                          WYNPSV
     I              FJJ8TX                          WYJ8TX
     I              FJTLMI                          WYTLMI
     I              FJJ9TX                          WYJ9TX
     I              FJQ2CD                          WYQ2CD
     I              FJVPCD                          WYVPCD
     I              FJDBCD                          WYDBCD
     I              FJGRWE                          WYGRWE
     I              FJXCCD                          WYXCCD
     I              FJU2ST                          WYU2ST
     I              FJF9DT                          WYF9DT
     I              FJONTM                          WYONTM
     I              FJJ4DT                          WYJ4DT
     I              FJTRTM                          WYTRTM
     I              FJJ5DT                          WYJ5DT
     I              FJSPTM                          WYSPTM
     I              FJJ6DT                          WYJ6DT
     I              FJLFTM                          WYLFTM
     I              FJJ7DT                          WYJ7DT
     I              FJBOTM                          WYBOTM
     I              FJJ8DT                          WYJ8DT
     I              FJBLTM                          WYBLTM
     I              FJKIDT                          WYKIDT
     I              FJASTM                          WYASTM
     I              FJKADT                          WYKADT
     I              FJAJCM                          WYAJCM
     I              FJXACD                          WYXACD
     I              FJOANA                          WYOANA
     I              FJK4TX                          WYK4TX
     I              FJVOAG                          WYVOAG
     I              FJKBDT                          WYKBDT
     I              FJNBBO                          WYNBBO
     I              FJW4CD                          WYW4CD
     I              FJEFDT                          WYEFDT
     I              FJCNTN                          WYCNTN
     I              FJKCDT                          WYKCDT
     I              FJTMIN                          WYTMIN
     I              FJKDDT                          WYKDDT
     I              FJVMNB                          WYVMNB
     I              FJOCFR                          WYOCFR
     I              FJKJDT                          WYKJDT
     I              FJATTM                          WYATTM
     I              FJOTRS                          WYOTRS
     I              FJRNST                          WYRNST
     I              FJBRBK                          WYBRBK
     I              FJEIDT                          WYEIDT
     I              FJRMST                          WYRMST
     I              FJAJCD                          WYAJCD
     I              FJKKDT                          WYKKDT
     I              FJAVTM                          WYAVTM
     I              FJKZDT                          WYKZDT
     I              FJAXTM                          WYAXTM
     I              FJLHOS                          WYLHOS
     I              FJLHOR                          WYLHOR
     I              FJWNTX                          WYWNTX
     I              FJOITX                          WYOITX
     I              FJOJTX                          WYOJTX
     I              FJLLDT                          WYLLDT
     I              FJLSHG                          WYLSHG
     I              FJYPST                          WYYPST
     I              FJK0DT                          WYK0DT
     I              FJAYTM                          WYAYTM
     I              FJKNNX                          WYKNNX
     I              FJICWG                          WYICWG
     I              FJIDWG                          WYIDWG
     I              FJH9SX                          WYH9SX
     I              FJWOTX                          WYWOTX
     I              FJK1DT                          WYK1DT
     I              FJAZTM                          WYAZTM
     I              FJK2DT                          WYK2DT
     I              FJA0TM                          WYA0TM
     I              FJROST                          WYROST
     I              FJRPST                          WYRPST
     I              FJRQST                          WYRQST
     I              FJRRST                          WYRRST
     I              FJZBVA                          WYZBVA
     I              FJWPTX                          WYWPTX
     I              FJWQTX                          WYWQTX
     I              FJWRTX                          WYWRTX
     I              FJWSTX                          WYWSTX
     I              FJRVSX                          WYRVSX
     I              FJRUSX                          WYRUSX
     I              FJRWSX                          WYRWSX
     I              FJRXSX                          WYRXSX
     I              FJRYSX                          WYRYSX
     I              FJRZSX                          WYRZSX
     I              FJR0SX                          WYR0SX
     I              FJR1SX                          WYR1SX
     I              FJR2SX                          WYR2SX
     I              FJR3SX                          WYR3SX
     I              FJR4SX                          WYR4SX
     I              FJPYDT                          WYPYDT
     I              FJCKTM                          WYCKTM
     I              FJPZDT                          WYPZDT
     I              FJCLTM                          WYCLTM
     I              FJP0DT                          WYP0DT
     I              FJCMTM                          WYCMTM
     I              FJP1DT                          WYP1DT
     I              FJCNTM                          WYCNTM
     I              FJP2DT                          WYP2DT
     I              FJCOTM                          WYCOTM
     I              FJP3DT                          WYP3DT
     I              FJCQTM                          WYCQTM
     I              FJUVST                          WYUVST
     I              FJUWST                          WYUWST
     I              FJUXST                          WYUXST
     I              FJAATM                          WYAATM
     I              FJAYNA                          WYAYNA
     I              FJA0NA                          WYA0NA
     I              FJAXDT                          WYAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          TAAIC3
     I              BEC4NB                          TAC4NB
     I              BEJNCD                          TAJNCD
     I              BEANC7                          TAANC7
     I              BEBKC7                          TABKC7
     I              BEBRTX                          TABRTX
     I              BEHMNA                          TAHMNA
     I              BEHONA                          TAHONA
     I              BEHPNA                          TAHPNA
     I              BEHNNA                          TAHNNA
     I              BEDBCD                          TADBCD
     I              BECKTX                          TACKTX
     I              BEB0C7                          TAB0C7
     I              BEAETX                          TAAETX
     I              BEB1NA                          TAB1NA
     I              BEB3NA                          TAB3NA
     I              BEB4NA                          TAB4NA
     I              BEB2NA                          TAB2NA
     I              BEBHCD                          TABHCD
     I              BEC8TX                          TAC8TX
     I              BEBCNA                          TABCNA
     I              BEA0DT                          TAA0DT
     I              BEA5DT                          TAA5DT
     I              BEGNDT                          TAGNDT
     I              BEACDT                          TAACDT
     I              BEAQCD                          TAAQCD
     I              BEB6NA                          TAB6NA
     I              BEBYNA                          TABYNA
     I              BEBZNA                          TABZNA
     I              BEGTST                          TAGTST
     I              BEGVST                          TAGVST
     I              BEGUST                          TAGUST
     I              BEQFST                          TAQFST
     I              BECQCD                          TACQCD
     I              BEGJST                          TAGJST
     I              BEGWST                          TAGWST
     I              BEGXST                          TAGXST
     I              BEGYST                          TAGYST
     I              BEAODT                          TAAODT
     I              BEAIVN                          TAAIVN
     I              BECXDT                          TACXDT
     I              BEJZVA                          TAJZVA
     I              BEA1WG                          TAA1WG
     I              BEXIST                          TAXIST
     I              BEXJST                          TAXJST
     I              BEXKST                          TAXKST
     I              BEEIDT                          TAEIDT
     I              BEAFTM                          TAAFTM
     I              BEE8CD                          TAE8CD
     I              BEE9CD                          TAE9CD
     I              BERMNB                          TARMNB
     I              BETBNB                          TATBNB
     I              BER1NB                          TAR1NB
     I              BEPJST                          TAPJST
     I              BEU0ST                          TAU0ST
     I              BEU1ST                          TAU1ST
     I              BEQ2CD                          TAQ2CD
     I              BEU2ST                          TAU2ST
     I              BEVEST                          TAVEST
     I              BEVFST                          TAVFST
     I              BEVGST                          TAVGST
     I              BERPCD                          TARPCD
     I              BERNNB                          TARNNB
     I              BEVDST                          TAVDST
     I              BEATIN                          TAATIN
     I              BEU4ST                          TAU4ST
     I              BEU5ST                          TAU5ST
     I              BERSRN                          TARSRN
     I              BEMHNA                          TAMHNA
     I              BEMINA                          TAMINA
     I              BEWBST                          TAWBST
     I              BER4CD                          TAR4CD
     I              BEBFCD                          TABFCD
     I              BEQ4CD                          TAQ4CD
     I              BET3NB                          TAT3NB
     I              BESICD                          TASICD
     I              BECONB                          TACONB
     I              BECEST                          TACEST
     I              BEAWDT                          TAAWDT
     I              BEJPCD                          TAJPCD
     I              BEXUST                          TAXUST
     I              BEZ1ST                          TAZ1ST
     I              BEVRVA                          TAVRVA
     I              BEOBST                          TAOBST
     I              BEBCST                          TABCST
     I              BEBDST                          TABDST
     I              BEB7VL                          TAB7VL
     I              BEGASX                          TAGASX
     I              BEGBSX                          TAGBSX
     I              BEGCSX                          TAGCSX
     I              BEGDSX                          TAGDSX
     I              BEFNSX                          TAFNSX
     I              BEFOSX                          TAFOSX
     I              BEFPSX                          TAFPSX
     I              BEFQSX                          TAFQSX
     I              BEFRSX                          TAFRSX
     I              BEFSSX                          TAFSSX
     I              BEFTSX                          TAFTSX
     I              BEFUSX                          TAFUSX
     I              BEFVSX                          TAFVSX
     I              BEFWSX                          TAFWSX
     I              BEFXSX                          TAFXSX
     I              BEFYSX                          TAFYSX
     I              BENODT                          TANODT
     I              BENPDT                          TANPDT
     I              BENQDT                          TANQDT
     I              BENRDT                          TANRDT
     I              BENSDT                          TANSDT
     I              BEBPTM                          TABPTM
     I              BEBQTM                          TABQTM
     I              BEBRTM                          TABRTM
     I              BEBSTM                          TABSTM
     I              BEBTTM                          TABTTM
     I              BEH0NX                          TAH0NX
     I              BEH1NX                          TAH1NX
     I              BEH2NX                          TAH2NX
     I              BEH3NX                          TAH3NX
     I              BEH4NX                          TAH4NX
     I              BEC0C7                          TAC0C7
     I              BEUVST                          TAUVST
     I              BEUWST                          TAUWST
     I              BEUXST                          TAUXST
     I              BEAATM                          TAAATM
     I              BEAYNA                          TAAYNA
     I              BEA0NA                          TAA0NA
     I              BEAXDT                          TAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          TBAIC3
     I              BEC4NB                          TBC4NB
     I              BEJNCD                          TBJNCD
     I              BEANC7                          TBANC7
     I              BEBKC7                          TBBKC7
     I              BEBRTX                          TBBRTX
     I              BEHMNA                          TBHMNA
     I              BEHONA                          TBHONA
     I              BEHPNA                          TBHPNA
     I              BEHNNA                          TBHNNA
     I              BEDBCD                          TBDBCD
     I              BECKTX                          TBCKTX
     I              BEB0C7                          TBB0C7
     I              BEAETX                          TBAETX
     I              BEB1NA                          TBB1NA
     I              BEB3NA                          TBB3NA
     I              BEB4NA                          TBB4NA
     I              BEB2NA                          TBB2NA
     I              BEBHCD                          TBBHCD
     I              BEC8TX                          TBC8TX
     I              BEBCNA                          TBBCNA
     I              BEA0DT                          TBA0DT
     I              BEA5DT                          TBA5DT
     I              BEGNDT                          TBGNDT
     I              BEACDT                          TBACDT
     I              BEAQCD                          TBAQCD
     I              BEB6NA                          TBB6NA
     I              BEBYNA                          TBBYNA
     I              BEBZNA                          TBBZNA
     I              BEGTST                          TBGTST
     I              BEGVST                          TBGVST
     I              BEGUST                          TBGUST
     I              BEQFST                          TBQFST
     I              BECQCD                          TBCQCD
     I              BEGJST                          TBGJST
     I              BEGWST                          TBGWST
     I              BEGXST                          TBGXST
     I              BEGYST                          TBGYST
     I              BEAODT                          TBAODT
     I              BEAIVN                          TBAIVN
     I              BECXDT                          TBCXDT
     I              BEJZVA                          TBJZVA
     I              BEA1WG                          TBA1WG
     I              BEXIST                          TBXIST
     I              BEXJST                          TBXJST
     I              BEXKST                          TBXKST
     I              BEEIDT                          TBEIDT
     I              BEAFTM                          TBAFTM
     I              BEE8CD                          TBE8CD
     I              BEE9CD                          TBE9CD
     I              BERMNB                          TBRMNB
     I              BETBNB                          TBTBNB
     I              BER1NB                          TBR1NB
     I              BEPJST                          TBPJST
     I              BEU0ST                          TBU0ST
     I              BEU1ST                          TBU1ST
     I              BEQ2CD                          TBQ2CD
     I              BEU2ST                          TBU2ST
     I              BEVEST                          TBVEST
     I              BEVFST                          TBVFST
     I              BEVGST                          TBVGST
     I              BERPCD                          TBRPCD
     I              BERNNB                          TBRNNB
     I              BEVDST                          TBVDST
     I              BEATIN                          TBATIN
     I              BEU4ST                          TBU4ST
     I              BEU5ST                          TBU5ST
     I              BERSRN                          TBRSRN
     I              BEMHNA                          TBMHNA
     I              BEMINA                          TBMINA
     I              BEWBST                          TBWBST
     I              BER4CD                          TBR4CD
     I              BEBFCD                          TBBFCD
     I              BEQ4CD                          TBQ4CD
     I              BET3NB                          TBT3NB
     I              BESICD                          TBSICD
     I              BECONB                          TBCONB
     I              BECEST                          TBCEST
     I              BEAWDT                          TBAWDT
     I              BEJPCD                          TBJPCD
     I              BEXUST                          TBXUST
     I              BEZ1ST                          TBZ1ST
     I              BEVRVA                          TBVRVA
     I              BEOBST                          TBOBST
     I              BEBCST                          TBBCST
     I              BEBDST                          TBBDST
     I              BEB7VL                          TBB7VL
     I              BEGASX                          TBGASX
     I              BEGBSX                          TBGBSX
     I              BEGCSX                          TBGCSX
     I              BEGDSX                          TBGDSX
     I              BEFNSX                          TBFNSX
     I              BEFOSX                          TBFOSX
     I              BEFPSX                          TBFPSX
     I              BEFQSX                          TBFQSX
     I              BEFRSX                          TBFRSX
     I              BEFSSX                          TBFSSX
     I              BEFTSX                          TBFTSX
     I              BEFUSX                          TBFUSX
     I              BEFVSX                          TBFVSX
     I              BEFWSX                          TBFWSX
     I              BEFXSX                          TBFXSX
     I              BEFYSX                          TBFYSX
     I              BENODT                          TBNODT
     I              BENPDT                          TBNPDT
     I              BENQDT                          TBNQDT
     I              BENRDT                          TBNRDT
     I              BENSDT                          TBNSDT
     I              BEBPTM                          TBBPTM
     I              BEBQTM                          TBBQTM
     I              BEBRTM                          TBBRTM
     I              BEBSTM                          TBBSTM
     I              BEBTTM                          TBBTTM
     I              BEH0NX                          TBH0NX
     I              BEH1NX                          TBH1NX
     I              BEH2NX                          TBH2NX
     I              BEH3NX                          TBH3NX
     I              BEH4NX                          TBH4NX
     I              BEC0C7                          TBC0C7
     I              BEUVST                          TBUVST
     I              BEUWST                          TBUWST
     I              BEUXST                          TBUXST
     I              BEAATM                          TBAATM
     I              BEAYNA                          TBAYNA
     I              BEA0NA                          TBA0NA
     I              BEAXDT                          TBAXDT
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                          TCAIC3
     I              MSC4NB                          TCC4NB
     I              MSDGSX                          TCDGSX
     I              MSKXCD                          TCKXCD
     I              MSDPNB                          TCDPNB
     I              MSUENB                          TCUENB
     I              MSDIC7                          TCDIC7
     I              MSO3NA                          TCO3NA
     I              MSO4NA                          TCO4NA
     I              MSRMTX                          TCRMTX
     I              MSPTTX                          TCPTTX
     I              MSHJWG                          TCHJWG
     I              MSHKWG                          TCHKWG
     I              MSRNTX                          TCRNTX
     I              MSAONX                          TCAONX
     I              MSROTX                          TCROTX
     I              MSORNA                          TCORNA
     I              MSAMNX                          TCAMNX
     I              MSANNX                          TCANNX
     I              MSAPNX                          TCAPNX
     I              MSDKPR                          TCDKPR
     I              MSA9VL                          TCA9VL
     I              MSC8SX                          TCC8SX
     I              MSRATX                          TCRATX
     I              MSRBTX                          TCRBTX
     I              MSAJNX                          TCAJNX
     I              MSZWTX                          TCZWTX
     I              MSZXTX                          TCZXTX
     I              MSZYTX                          TCZYTX
     I              MSZZTX                          TCZZTX
     I              MSK0U1                          TCK0U1
     I              MSK1U1                          TCK1U1
     I              MSIJSC                          TCIJSC
     I              MSIKSC                          TCIKSC
     I              MSK2U1                          TCK2U1
     I              MSW0DT                          TCW0DT
     I              MSUVST                          TCUVST
     I              MSUWST                          TCUWST
     I              MSUXST                          TCUXST
     I              MSVSST                          TCVSST
     I              MSAATM                          TCAATM
     I              MSAYNA                          TCAYNA
     I              MSA0NA                          TCA0NA
     I              MSAXDT                          TCAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TDAIC3
     I              MSC4NB                          TDC4NB
     I              MSDGSX                          TDDGSX
     I              MSKXCD                          TDKXCD
     I              MSDPNB                          TDDPNB
     I              MSUENB                          TDUENB
     I              MSDIC7                          TDDIC7
     I              MSO3NA                          TDO3NA
     I              MSO4NA                          TDO4NA
     I              MSRMTX                          TDRMTX
     I              MSPTTX                          TDPTTX
     I              MSHJWG                          TDHJWG
     I              MSHKWG                          TDHKWG
     I              MSRNTX                          TDRNTX
     I              MSAONX                          TDAONX
     I              MSROTX                          TDROTX
     I              MSORNA                          TDORNA
     I              MSAMNX                          TDAMNX
     I              MSANNX                          TDANNX
     I              MSAPNX                          TDAPNX
     I              MSDKPR                          TDDKPR
     I              MSA9VL                          TDA9VL
     I              MSC8SX                          TDC8SX
     I              MSRATX                          TDRATX
     I              MSRBTX                          TDRBTX
     I              MSAJNX                          TDAJNX
     I              MSZWTX                          TDZWTX
     I              MSZXTX                          TDZXTX
     I              MSZYTX                          TDZYTX
     I              MSZZTX                          TDZZTX
     I              MSK0U1                          TDK0U1
     I              MSK1U1                          TDK1U1
     I              MSIJSC                          TDIJSC
     I              MSIKSC                          TDIKSC
     I              MSK2U1                          TDK2U1
     I              MSW0DT                          TDW0DT
     I              MSUVST                          TDUVST
     I              MSUWST                          TDUWST
     I              MSUXST                          TDUXST
     I              MSVSST                          TDVSST
     I              MSAATM                          TDAATM
     I              MSAYNA                          TDAYNA
     I              MSA0NA                          TDA0NA
     I              MSAXDT                          TDAXDT
      *
     I@B7CPJD
      * Item Transaction Detail   Co/Order/Trans Sel ERR
      * Renamed input format fields
     I              B7AIC3                          TEAIC3
     I              B7HGCD                          TEHGCD
     I              B7AJCD                          TEAJCD
     I              B7W9ST                          TEW9ST
     I              B7BSST                          TEBSST
     I              B7B4DT                          TEB4DT
     I              B7C4NY                          TEC4NY
     I              B7DXNB                          TEDXNB
     I              B7ELDT                          TEELDT
     I              B7HVCD                          TEHVCD
     I              B7F1ST                          TEF1ST
     I              B7AUNA                          TEAUNA
     I              B7A5QT                          TEA5QT
     I              B7AHWG                          TEAHWG
     I              B7AKCS                          TEAKCS
     I              B7CGCD                          TECGCD
     I              B7AYVA                          TEAYVA
     I              B7BJNA                          TEBJNA
     I              B7CKNB                          TECKNB
     I              B7BMST                          TEBMST
     I              B7CQCD                          TECQCD
     I              B7DTCD                          TEDTCD
     I              B7MGNA                          TEMGNA
     I              B7TRBN                          TETRBN
     I              B7TRBS                          TETRBS
     I              B7C4NB                          TEC4NB
     I              B7RINB                          TERINB
     I              B7RHNB                          TERHNB
     I              B7RGNB                          TERGNB
     I              B7M3NA                          TEM3NA
     I              B7AWTM                          TEAWTM
     I              B7XLCD                          TEXLCD
     I              B7K7DT                          TEK7DT
     I              B7UVST                          TEUVST
     I              B7UWST                          TEUWST
     I              B7UXST                          TEUXST
     I              B7VSST                          TEVSST
     I              B7AATM                          TEAATM
     I              B7AYNA                          TEAYNA
     I              B7A0NA                          TEA0NA
     I              B7AXDT                          TEAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TFAIC3
     I              B7HGCD                          TFHGCD
     I              B7AJCD                          TFAJCD
     I              B7W9ST                          TFW9ST
     I              B7BSST                          TFBSST
     I              B7B4DT                          TFB4DT
     I              B7C4NY                          TFC4NY
     I              B7DXNB                          TFDXNB
     I              B7ELDT                          TFELDT
     I              B7HVCD                          TFHVCD
     I              B7F1ST                          TFF1ST
     I              B7AUNA                          TFAUNA
     I              B7A5QT                          TFA5QT
     I              B7AHWG                          TFAHWG
     I              B7AKCS                          TFAKCS
     I              B7CGCD                          TFCGCD
     I              B7AYVA                          TFAYVA
     I              B7BJNA                          TFBJNA
     I              B7CKNB                          TFCKNB
     I              B7BMST                          TFBMST
     I              B7CQCD                          TFCQCD
     I              B7DTCD                          TFDTCD
     I              B7MGNA                          TFMGNA
     I              B7TRBN                          TFTRBN
     I              B7TRBS                          TFTRBS
     I              B7C4NB                          TFC4NB
     I              B7RINB                          TFRINB
     I              B7RHNB                          TFRHNB
     I              B7RGNB                          TFRGNB
     I              B7M3NA                          TFM3NA
     I              B7AWTM                          TFAWTM
     I              B7XLCD                          TFXLCD
     I              B7K7DT                          TFK7DT
     I              B7UVST                          TFUVST
     I              B7UWST                          TFUWST
     I              B7UXST                          TFUXST
     I              B7VSST                          TFVSST
     I              B7AATM                          TFAATM
     I              B7AYNA                          TFAYNA
     I              B7A0NA                          TFA0NA
     I              B7AXDT                          TFAXDT
      *
     I@BMCPE9
      * PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      * Renamed input format fields
     I              BMY1NX                          TGY1NX
     I              BMAID8                          TGAID8
     I              BMAFTS                          TGAFTS
     I              BMBCNY                          TGBCNY
     I              BMZPNX                          TGZPNX
     I              BMZXNX                          TGZXNX
     I              BMZYNX                          TGZYNX
     I              BMY2NX                          TGY2NX
     I              BMAFD8                          TGAFD8
     I              BMAUNY                          TGAUNY
     I              BMAVNY                          TGAVNY
     I              BMVVSX                          TGVVSX
     I              BMUWSX                          TGUWSX
     I              BMUXSX                          TGUXSX
     I              BMV3SX                          TGV3SX
     I              BMAHNY                          TGAHNY
     I              BMAINY                          TGAINY
     I              BMAJNY                          TGAJNY
     I              BMAKNY                          TGAKNY
      *
     I@BMCPYU
      * PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          THY1NX
     I              BMAID8                          THAID8
     I              BMAFTS                          THAFTS
     I              BMBCNY                          THBCNY
     I              BMZPNX                          THZPNX
     I              BMZXNX                          THZXNX
     I              BMZYNX                          THZYNX
     I              BMY2NX                          THY2NX
     I              BMAFD8                          THAFD8
     I              BMAUNY                          THAUNY
     I              BMAVNY                          THAVNY
     I              BMVVSX                          THVVSX
     I              BMUWSX                          THUWSX
     I              BMUXSX                          THUXSX
     I              BMV3SX                          THV3SX
     I              BMAHNY                          THAHNY
     I              BMAINY                          THAINY
     I              BMAJNY                          THAJNY
     I              BMAKNY                          THAKNY
      *
     I@BKCPFD
      * PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      * Renamed input format fields
     I              BKY1NX                          TIY1NX
     I              BKAID8                          TIAID8
     I              BKAFTS                          TIAFTS
     I              BKBCNY                          TIBCNY
     I              BKVRSX                          TIVRSX
     I              BKZGNX                          TIZGNX
     I              BKZPNX                          TIZPNX
     I              BKW0SX                          TIW0SX
     I              BKUWSX                          TIUWSX
     I              BKUXSX                          TIUXSX
     I              BKV3SX                          TIV3SX
     I              BKAHNY                          TIAHNY
     I              BKAINY                          TIAINY
     I              BKAJNY                          TIAJNY
     I              BKAKNY                          TIAKNY
      *
     I@BKCPZU
      * PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          TJY1NX
     I              BKAID8                          TJAID8
     I              BKAFTS                          TJAFTS
     I              BKBCNY                          TJBCNY
     I              BKVRSX                          TJVRSX
     I              BKZGNX                          TJZGNX
     I              BKZPNX                          TJZPNX
     I              BKW0SX                          TJW0SX
     I              BKUWSX                          TJUWSX
     I              BKUXSX                          TJUXSX
     I              BKV3SX                          TJV3SX
     I              BKAHNY                          TJAHNY
     I              BKAINY                          TJAINY
     I              BKAJNY                          TJAJNY
     I              BKAKNY                          TJAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     IYARDCS      DS                            525
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WMAIC3
     I              L7HGCD                          WMHGCD
     I              L7AJCD                          WMAJCD
     I              L7LTRT                          WMLTRT
     I              L7LRDT                          WMLRDT
     I              L7LLTS                          WMLLTS
     I              L7LSDT                          WMLSDT
     I              L7J5QT                          WMJ5QT
     I              L7G8WG                          WMG8WG
     I              L7LLTN                          WMLLTN
     I              L7YMCD                          WMYMCD
     I              L7LLCL                          WMLLCL
     I              L7BNAA                          WMBNAA
     I              L7LLTR                          WMLLTR
     I              L7Y2CD                          WMY2CD
     I              L7LLTL                          WMLLTL
     I              L7C4NB                          WMC4NB
     I              L7LOST                          WMLOST
     I              L7LLTU                          WMLLTU
     I              L7LLYT                          WMLLYT
     I              L7UVST                          WMUVST
     I              L7UWST                          WMUWST
     I              L7UXST                          WMUXST
     I              L7VSST                          WMVSST
     I              L7AATM                          WMAATM
     I              L7AYNA                          WMAYNA
     I              L7A0NA                          WMA0NA
     I              L7AXDT                          WMAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WTAIC3
     I              L5HGCD                          WTHGCD
     I              L5AJCD                          WTAJCD
     I              L5ELDT                          WTELDT
     I              L5LXNM                          WTLXNM
     I              L5YMCD                          WTYMCD
     I              L5YNCD                          WTYNCD
     I              L5J2QT                          WTJ2QT
     I              L5G5WG                          WTG5WG
     I              L5J3QT                          WTJ3QT
     I              L5G6WG                          WTG6WG
     I              L5J4QT                          WTJ4QT
     I              L5G7WG                          WTG7WG
     I              L5LODT                          WTLODT
     I              L5LPDT                          WTLPDT
     I              L5LQDT                          WTLQDT
     I              L5NBR                           WTNBR
     I              L5YTCD                          WTYTCD
     I              L5AMSX                          WTAMSX
     I              L5ASSX                          WTASSX
     I              L5ATSX                          WTATSX
     I              L5AUSX                          WTAUSX
     I              L5YSCD                          WTYSCD
     I              L5UVST                          WTUVST
     I              L5UWST                          WTUWST
     I              L5UXST                          WTUXST
     I              L5VSST                          WTVSST
     I              L5AATM                          WTAATM
     I              L5AYNA                          WTAYNA
     I              L5A0NA                          WTA0NA
     I              L5AXDT                          WTAXDT
      *
     IYBRDCS      DS                            111
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WVAIC3
     I              B1HGCD                          WVHGCD
     I              B1AJCD                          WVAJCD
     I              B1ELDT                          WVELDT
     I              B1ABWG                          WVABWG
     I              B1AGQT                          WVAGQT
     I              B1AHQT                          WVAHQT
     I              B1AIQT                          WVAIQT
     I              B1CTST                          WVCTST
     I              B1ACWG                          WVACWG
     I              B1ARQT                          WVARQT
     I              B1ASQT                          WVASQT
     I              B1ATQT                          WVATQT
     I              B1HDQT                          WVHDQT
     I              B1HEQT                          WVHEQT
     I              B1F6ST                          WVF6ST
     I              B1BMWG                          WVBMWG
     I              B1DSQT                          WVDSQT
     I              B1DTQT                          WVDTQT
     I              B1DUQT                          WVDUQT
     I              B1DHDT                          WVDHDT
     I              B1AGCS                          WVAGCS
     I              B1AECS                          WVAECS
     I              B1IDVA                          WVIDVA
     I              B1K7DT                          WVK7DT
     I              B1RINB                          WVRINB
     I              B1RHNB                          WVRHNB
     I              B1RGNB                          WVRGNB
     I              B1UVST                          WVUVST
     I              B1UWST                          WVUWST
     I              B1UXST                          WVUXST
     I              B1VSST                          WVVSST
     I              B1AATM                          WVAATM
     I              B1AYNA                          WVAYNA
     I              B1A0NA                          WVA0NA
     I              B1AXDT                          WVAXDT
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WWAIC3
     I              L8C4NB                          WWC4NB
     I              L8DPNB                          WWDPNB
     I              L8UENB                          WWUENB
     I              L8ALSW                          WWALSW
     I              L8J6QT                          WWJ6QT
     I              L8G9WG                          WWG9WG
     I              L8J9QT                          WWJ9QT
     I              L8HAWG                          WWHAWG
     I              L8IOSE                          WWIOSE
     I              L8OIMN                          WWOIMN
     I              L8SOAS                          WWSOAS
     I              L8ARSX                          WWARSX
     I              L8OTUS                          WWOTUS
     I              L8OTMP                          WWOTMP
     I              L8HGCD                          WWHGCD
     I              L8AJCD                          WWAJCD
     I              L8ELDT                          WWELDT
     I              L8LXNM                          WWLXNM
     I              L8YMCD                          WWYMCD
     I              L8YNCD                          WWYNCD
     I              L8UVST                          WWUVST
     I              L8UWST                          WWUWST
     I              L8UXST                          WWUXST
     I              L8VSST                          WWVSST
     I              L8AATM                          WWAATM
     I              L8AYNA                          WWAYNA
     I              L8A0NA                          WWA0NA
     I              L8AXDT                          WWAXDT
      *
     IYCRDCS      DS                             91
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WYRMNB
     I              FJAIC3                          WYAIC3
     I              FJAODT                          WYAODT
     I              FJPJST                          WYPJST
     I              FJPKST                          WYPKST
     I              FJRNNB                          WYRNNB
     I              FJDMTX                          WYDMTX
     I              FJDNTX                          WYDNTX
     I              FJDOTX                          WYDOTX
     I              FJWTTX                          WYWTTX
     I              FJWUTX                          WYWUTX
     I              FJRPNB                          WYRPNB
     I              FJFLAM                          WYFLAM
     I              FJXQST                          WYXQST
     I              FJRRNB                          WYRRNB
     I              FJDXTX                          WYDXTX
     I              FJDYTX                          WYDYTX
     I              FJSBNB                          WYSBNB
     I              FJBZNA                          WYBZNA
     I              FJRONB                          WYRONB
     I              FJSQNB                          WYSQNB
     I              FJR1NB                          WYR1NB
     I              FJVCST                          WYVCST
     I              FJVDST                          WYVDST
     I              FJSDNB                          WYSDNB
     I              FJPAOU                          WYPAOU
     I              FJDGWG                          WYDGWG
     I              FJSXNB                          WYSXNB
     I              FJHADT                          WYHADT
     I              FJAART                          WYAART
     I              FJDHWG                          WYDHWG
     I              FJDIWG                          WYDIWG
     I              FJAQDT                          WYAQDT
     I              FJS6NB                          WYS6NB
     I              FJT4NB                          WYT4NB
     I              FJPRTM                          WYPRTM
     I              FJNPSV                          WYNPSV
     I              FJJ8TX                          WYJ8TX
     I              FJTLMI                          WYTLMI
     I              FJJ9TX                          WYJ9TX
     I              FJQ2CD                          WYQ2CD
     I              FJVPCD                          WYVPCD
     I              FJDBCD                          WYDBCD
     I              FJGRWE                          WYGRWE
     I              FJXCCD                          WYXCCD
     I              FJU2ST                          WYU2ST
     I              FJF9DT                          WYF9DT
     I              FJONTM                          WYONTM
     I              FJJ4DT                          WYJ4DT
     I              FJTRTM                          WYTRTM
     I              FJJ5DT                          WYJ5DT
     I              FJSPTM                          WYSPTM
     I              FJJ6DT                          WYJ6DT
     I              FJLFTM                          WYLFTM
     I              FJJ7DT                          WYJ7DT
     I              FJBOTM                          WYBOTM
     I              FJJ8DT                          WYJ8DT
     I              FJBLTM                          WYBLTM
     I              FJKIDT                          WYKIDT
     I              FJASTM                          WYASTM
     I              FJKADT                          WYKADT
     I              FJAJCM                          WYAJCM
     I              FJXACD                          WYXACD
     I              FJOANA                          WYOANA
     I              FJK4TX                          WYK4TX
     I              FJVOAG                          WYVOAG
     I              FJKBDT                          WYKBDT
     I              FJNBBO                          WYNBBO
     I              FJW4CD                          WYW4CD
     I              FJEFDT                          WYEFDT
     I              FJCNTN                          WYCNTN
     I              FJKCDT                          WYKCDT
     I              FJTMIN                          WYTMIN
     I              FJKDDT                          WYKDDT
     I              FJVMNB                          WYVMNB
     I              FJOCFR                          WYOCFR
     I              FJKJDT                          WYKJDT
     I              FJATTM                          WYATTM
     I              FJOTRS                          WYOTRS
     I              FJRNST                          WYRNST
     I              FJBRBK                          WYBRBK
     I              FJEIDT                          WYEIDT
     I              FJRMST                          WYRMST
     I              FJAJCD                          WYAJCD
     I              FJKKDT                          WYKKDT
     I              FJAVTM                          WYAVTM
     I              FJKZDT                          WYKZDT
     I              FJAXTM                          WYAXTM
     I              FJLHOS                          WYLHOS
     I              FJLHOR                          WYLHOR
     I              FJWNTX                          WYWNTX
     I              FJOITX                          WYOITX
     I              FJOJTX                          WYOJTX
     I              FJLLDT                          WYLLDT
     I              FJLSHG                          WYLSHG
     I              FJYPST                          WYYPST
     I              FJK0DT                          WYK0DT
     I              FJAYTM                          WYAYTM
     I              FJKNNX                          WYKNNX
     I              FJICWG                          WYICWG
     I              FJIDWG                          WYIDWG
     I              FJH9SX                          WYH9SX
     I              FJWOTX                          WYWOTX
     I              FJK1DT                          WYK1DT
     I              FJAZTM                          WYAZTM
     I              FJK2DT                          WYK2DT
     I              FJA0TM                          WYA0TM
     I              FJROST                          WYROST
     I              FJRPST                          WYRPST
     I              FJRQST                          WYRQST
     I              FJRRST                          WYRRST
     I              FJZBVA                          WYZBVA
     I              FJWPTX                          WYWPTX
     I              FJWQTX                          WYWQTX
     I              FJWRTX                          WYWRTX
     I              FJWSTX                          WYWSTX
     I              FJRVSX                          WYRVSX
     I              FJRUSX                          WYRUSX
     I              FJRWSX                          WYRWSX
     I              FJRXSX                          WYRXSX
     I              FJRYSX                          WYRYSX
     I              FJRZSX                          WYRZSX
     I              FJR0SX                          WYR0SX
     I              FJR1SX                          WYR1SX
     I              FJR2SX                          WYR2SX
     I              FJR3SX                          WYR3SX
     I              FJR4SX                          WYR4SX
     I              FJPYDT                          WYPYDT
     I              FJCKTM                          WYCKTM
     I              FJPZDT                          WYPZDT
     I              FJCLTM                          WYCLTM
     I              FJP0DT                          WYP0DT
     I              FJCMTM                          WYCMTM
     I              FJP1DT                          WYP1DT
     I              FJCNTM                          WYCNTM
     I              FJP2DT                          WYP2DT
     I              FJCOTM                          WYCOTM
     I              FJP3DT                          WYP3DT
     I              FJCQTM                          WYCQTM
     I              FJUVST                          WYUVST
     I              FJUWST                          WYUWST
     I              FJUXST                          WYUXST
     I              FJAATM                          WYAATM
     I              FJAYNA                          WYAYNA
     I              FJA0NA                          WYA0NA
     I              FJAXDT                          WYAXDT
      *
     IYDRDCS      DS                            793
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          TBAIC3
     I              BEC4NB                          TBC4NB
     I              BEJNCD                          TBJNCD
     I              BEANC7                          TBANC7
     I              BEBKC7                          TBBKC7
     I              BEBRTX                          TBBRTX
     I              BEHMNA                          TBHMNA
     I              BEHONA                          TBHONA
     I              BEHPNA                          TBHPNA
     I              BEHNNA                          TBHNNA
     I              BEDBCD                          TBDBCD
     I              BECKTX                          TBCKTX
     I              BEB0C7                          TBB0C7
     I              BEAETX                          TBAETX
     I              BEB1NA                          TBB1NA
     I              BEB3NA                          TBB3NA
     I              BEB4NA                          TBB4NA
     I              BEB2NA                          TBB2NA
     I              BEBHCD                          TBBHCD
     I              BEC8TX                          TBC8TX
     I              BEBCNA                          TBBCNA
     I              BEA0DT                          TBA0DT
     I              BEA5DT                          TBA5DT
     I              BEGNDT                          TBGNDT
     I              BEACDT                          TBACDT
     I              BEAQCD                          TBAQCD
     I              BEB6NA                          TBB6NA
     I              BEBYNA                          TBBYNA
     I              BEBZNA                          TBBZNA
     I              BEGTST                          TBGTST
     I              BEGVST                          TBGVST
     I              BEGUST                          TBGUST
     I              BEQFST                          TBQFST
     I              BECQCD                          TBCQCD
     I              BEGJST                          TBGJST
     I              BEGWST                          TBGWST
     I              BEGXST                          TBGXST
     I              BEGYST                          TBGYST
     I              BEAODT                          TBAODT
     I              BEAIVN                          TBAIVN
     I              BECXDT                          TBCXDT
     I              BEJZVA                          TBJZVA
     I              BEA1WG                          TBA1WG
     I              BEXIST                          TBXIST
     I              BEXJST                          TBXJST
     I              BEXKST                          TBXKST
     I              BEEIDT                          TBEIDT
     I              BEAFTM                          TBAFTM
     I              BEE8CD                          TBE8CD
     I              BEE9CD                          TBE9CD
     I              BERMNB                          TBRMNB
     I              BETBNB                          TBTBNB
     I              BER1NB                          TBR1NB
     I              BEPJST                          TBPJST
     I              BEU0ST                          TBU0ST
     I              BEU1ST                          TBU1ST
     I              BEQ2CD                          TBQ2CD
     I              BEU2ST                          TBU2ST
     I              BEVEST                          TBVEST
     I              BEVFST                          TBVFST
     I              BEVGST                          TBVGST
     I              BERPCD                          TBRPCD
     I              BERNNB                          TBRNNB
     I              BEVDST                          TBVDST
     I              BEATIN                          TBATIN
     I              BEU4ST                          TBU4ST
     I              BEU5ST                          TBU5ST
     I              BERSRN                          TBRSRN
     I              BEMHNA                          TBMHNA
     I              BEMINA                          TBMINA
     I              BEWBST                          TBWBST
     I              BER4CD                          TBR4CD
     I              BEBFCD                          TBBFCD
     I              BEQ4CD                          TBQ4CD
     I              BET3NB                          TBT3NB
     I              BESICD                          TBSICD
     I              BECONB                          TBCONB
     I              BECEST                          TBCEST
     I              BEAWDT                          TBAWDT
     I              BEJPCD                          TBJPCD
     I              BEXUST                          TBXUST
     I              BEZ1ST                          TBZ1ST
     I              BEVRVA                          TBVRVA
     I              BEOBST                          TBOBST
     I              BEBCST                          TBBCST
     I              BEBDST                          TBBDST
     I              BEB7VL                          TBB7VL
     I              BEGASX                          TBGASX
     I              BEGBSX                          TBGBSX
     I              BEGCSX                          TBGCSX
     I              BEGDSX                          TBGDSX
     I              BEFNSX                          TBFNSX
     I              BEFOSX                          TBFOSX
     I              BEFPSX                          TBFPSX
     I              BEFQSX                          TBFQSX
     I              BEFRSX                          TBFRSX
     I              BEFSSX                          TBFSSX
     I              BEFTSX                          TBFTSX
     I              BEFUSX                          TBFUSX
     I              BEFVSX                          TBFVSX
     I              BEFWSX                          TBFWSX
     I              BEFXSX                          TBFXSX
     I              BEFYSX                          TBFYSX
     I              BENODT                          TBNODT
     I              BENPDT                          TBNPDT
     I              BENQDT                          TBNQDT
     I              BENRDT                          TBNRDT
     I              BENSDT                          TBNSDT
     I              BEBPTM                          TBBPTM
     I              BEBQTM                          TBBQTM
     I              BEBRTM                          TBBRTM
     I              BEBSTM                          TBBSTM
     I              BEBTTM                          TBBTTM
     I              BEH0NX                          TBH0NX
     I              BEH1NX                          TBH1NX
     I              BEH2NX                          TBH2NX
     I              BEH3NX                          TBH3NX
     I              BEH4NX                          TBH4NX
     I              BEC0C7                          TBC0C7
     I              BEUVST                          TBUVST
     I              BEUWST                          TBUWST
     I              BEUXST                          TBUXST
     I              BEAATM                          TBAATM
     I              BEAYNA                          TBAYNA
     I              BEA0NA                          TBA0NA
     I              BEAXDT                          TBAXDT
      *
     IYERDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IYFRDCS      DS                            793
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TDAIC3
     I              MSC4NB                          TDC4NB
     I              MSDGSX                          TDDGSX
     I              MSKXCD                          TDKXCD
     I              MSDPNB                          TDDPNB
     I              MSUENB                          TDUENB
     I              MSDIC7                          TDDIC7
     I              MSO3NA                          TDO3NA
     I              MSO4NA                          TDO4NA
     I              MSRMTX                          TDRMTX
     I              MSPTTX                          TDPTTX
     I              MSHJWG                          TDHJWG
     I              MSHKWG                          TDHKWG
     I              MSRNTX                          TDRNTX
     I              MSAONX                          TDAONX
     I              MSROTX                          TDROTX
     I              MSORNA                          TDORNA
     I              MSAMNX                          TDAMNX
     I              MSANNX                          TDANNX
     I              MSAPNX                          TDAPNX
     I              MSDKPR                          TDDKPR
     I              MSA9VL                          TDA9VL
     I              MSC8SX                          TDC8SX
     I              MSRATX                          TDRATX
     I              MSRBTX                          TDRBTX
     I              MSAJNX                          TDAJNX
     I              MSZWTX                          TDZWTX
     I              MSZXTX                          TDZXTX
     I              MSZYTX                          TDZYTX
     I              MSZZTX                          TDZZTX
     I              MSK0U1                          TDK0U1
     I              MSK1U1                          TDK1U1
     I              MSIJSC                          TDIJSC
     I              MSIKSC                          TDIKSC
     I              MSK2U1                          TDK2U1
     I              MSW0DT                          TDW0DT
     I              MSUVST                          TDUVST
     I              MSUWST                          TDUWST
     I              MSUXST                          TDUXST
     I              MSVSST                          TDVSST
     I              MSAATM                          TDAATM
     I              MSAYNA                          TDAYNA
     I              MSA0NA                          TDA0NA
     I              MSAXDT                          TDAXDT
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TFAIC3
     I              B7HGCD                          TFHGCD
     I              B7AJCD                          TFAJCD
     I              B7W9ST                          TFW9ST
     I              B7BSST                          TFBSST
     I              B7B4DT                          TFB4DT
     I              B7C4NY                          TFC4NY
     I              B7DXNB                          TFDXNB
     I              B7ELDT                          TFELDT
     I              B7HVCD                          TFHVCD
     I              B7F1ST                          TFF1ST
     I              B7AUNA                          TFAUNA
     I              B7A5QT                          TFA5QT
     I              B7AHWG                          TFAHWG
     I              B7AKCS                          TFAKCS
     I              B7CGCD                          TFCGCD
     I              B7AYVA                          TFAYVA
     I              B7BJNA                          TFBJNA
     I              B7CKNB                          TFCKNB
     I              B7BMST                          TFBMST
     I              B7CQCD                          TFCQCD
     I              B7DTCD                          TFDTCD
     I              B7MGNA                          TFMGNA
     I              B7TRBN                          TFTRBN
     I              B7TRBS                          TFTRBS
     I              B7C4NB                          TFC4NB
     I              B7RINB                          TFRINB
     I              B7RHNB                          TFRHNB
     I              B7RGNB                          TFRGNB
     I              B7M3NA                          TFM3NA
     I              B7AWTM                          TFAWTM
     I              B7XLCD                          TFXLCD
     I              B7K7DT                          TFK7DT
     I              B7UVST                          TFUVST
     I              B7UWST                          TFUWST
     I              B7UXST                          TFUXST
     I              B7VSST                          TFVSST
     I              B7AATM                          TFAATM
     I              B7AYNA                          TFAYNA
     I              B7A0NA                          TFA0NA
     I              B7AXDT                          TFAXDT
      *
     IYGRDCS      DS                            192
     IQPPBM1    E DSPPBMCPL0
      * UPD : PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          THY1NX
     I              BMAID8                          THAID8
     I              BMAFTS                          THAFTS
     I              BMBCNY                          THBCNY
     I              BMZPNX                          THZPNX
     I              BMZXNX                          THZXNX
     I              BMZYNX                          THZYNX
     I              BMY2NX                          THY2NX
     I              BMAFD8                          THAFD8
     I              BMAUNY                          THAUNY
     I              BMAVNY                          THAVNY
     I              BMVVSX                          THVVSX
     I              BMUWSX                          THUWSX
     I              BMUXSX                          THUXSX
     I              BMV3SX                          THV3SX
     I              BMAHNY                          THAHNY
     I              BMAINY                          THAINY
     I              BMAJNY                          THAJNY
     I              BMAKNY                          THAKNY
      *
     IYHRDCS      DS                            101
     IQPPBK1    E DSPPBKCPL0
      * UPD : PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          TJY1NX
     I              BKAID8                          TJAID8
     I              BKAFTS                          TJAFTS
     I              BKBCNY                          TJBCNY
     I              BKVRSX                          TJVRSX
     I              BKZGNX                          TJZGNX
     I              BKZPNX                          TJZPNX
     I              BKW0SX                          TJW0SX
     I              BKUWSX                          TJUWSX
     I              BKUXSX                          TJUXSX
     I              BKV3SX                          TJV3SX
     I              BKAHNY                          TJAHNY
     I              BKAINY                          TJAINY
     I              BKAJNY                          TJAJNY
     I              BKAKNY                          TJAKNY
      *
     IYIRDCS      DS                             75
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Ship Load/Order Sts
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Transaction Date
     I                                        4  110P1AID8
      * I :  PFS Transaction Time
     I                                       12  170P1AFTS
      * I :  PFS Load ID
     I                                       18  240P1ZGNX
      * I :  PFS Order Number
     I                                       25  310P1ZPNX
      * B :  PFS Process Status
     I                                       32  320P1UXSX
     IP2PARM      DS
      * FLD: Order Header TRG
      * N :  Company Number
     I                                    P   1   20P2AIC3
      * N :  Order Number
     I                                    P   3   60P2C4NB
      * I :  Ship To Customer
     I                                    P   7  100P2BKC7
      * I :  Scheduled Ship Date
     I                                    P  11  140P2AODT
      * N :  Load ID
     I                                    P  15  180P2RMNB
      * I :  Trans Contol AS400_Plant
     I                                       19  19 P2XUST
      * I :  Billing Activity Type
     I                                       20  20 P2OBST
     IP3PARM      DS
      * FLD: *Arrays
      * I :  Called From Program
     I                                        1  10 P3COAB
      * O :  Send Email f/Failed API U
     I                                       11  11 P3OVSC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1AID8    PARM           WP0002  80       PFS Transaction
     C           P1AFTS    PARM           WP0003  60       PFS Transaction
     C           P1ZGNX    PARM           WP0004  70       PFS Load ID
     C           P1ZPNX    PARM           WP0005  70       PFS Order Numbe
     C           P1UXSX    PARM P1UXSX    WP0006  10       PFS Process Sta
     C           P2BKC7    PARM           WP0007  70       Ship To Custome
     C           P2AODT    PARM           WP0008  70       Scheduled Ship
     C           P2XUST    PARM           WP0009  1        Trans Contol AS
     C           P2OBST    PARM           WP0010  1        Billing Activit
     C           P3COAB    PARM           WP0011 10        Called From Pro
     C           P3OVSC    PARM P3OVSC    WP0012  1        Send Email f/Fa
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Reopen Order      XF
     C                     Z-ADDP1Y1NX    P2AIC3           Company Number
     C                     Z-ADDP1ZPNX    P2C4NB           Order Number
     C                     Z-ADDP1ZGNX    P2RMNB           Load ID
      * RTV Delete Ship Event  RT - Order Events  * 
     C                     EXSR SARVGN
      * RTV Next Event Number  RT - Order Events  * 
     C                     EXSR SCRVGN
      * RTV Event Code         RT - Order Events  * 
     C                     EXSR SDRVGN
      * WI517 DN 10/04/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Unship Ship Detail RT - Order Detail  * 
     C                     EXSR SERVGN
      * ** FP1127 Use Load ID for Lot# if Ext Whse, not PFS, Lot Trk=Y
      * Cnf Order Ship/Unship IF
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
     C                     EXSR SLRVGN
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0087  30       Company Number
     C                     PARM P2C4NB    WQ0088  70       Order Number
     C           WUJSVA    PARM WUJSVA    WQ0089 112       USR Order Value
     C           WUAYWG    PARM WUAYWG    WQ0090 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0091  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0092  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Unship Load Status RT - Load Header  * 
     C                     EXSR SYRVGN
      * PFS Unship Order      RT - Order Header TRG  * 
     C                     EXSR TARVGN
      * remove sched ship date as input. 12/10/14
      * CHG Load Sts/ActShp   CH - Load Header  * 
     C                     EXSR TCCHRC
      * S00619 RMC 01/06/09 Del exp doc dtls
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
     C                     EXSR TDRVGN
      * UPD Err Transactions   RT - Item Transaction Detail  * 
     C                     EXSR TFRVGN
     C                     Z-ADD1         P1UXSX           PFS Process Sta
      * ** Mark Previous Transactions with Process Status = 3 **
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
     C                     EXSR THRVGN
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
     C                     EXSR TJRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Delete Ship Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
     C           *LIKE     DEFN WAJPCD    WQSA03           Event Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           Event Code
      * Setup key
     C                     Z-ADDP2AIC3    WQSA01           Company Number
     C                     Z-ADDP2C4NB    WQSA02           Order Number
     C                     MOVEL'04'      WQSA03           Event Code
      * Establish starting position
     C           KRSSA     SETLL@EYCPZE                    *
     C           KRSSA     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Event         DC - OP Order Events  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * DEL Ship Event         DC - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     Z-ADDWAQ2NB    WBQ2NB           Event Number
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBQ2NB           Event Number
     C           KLDLSB    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSC01           Company Number
     C                     Z-ADDP2C4NB    WQSC02           Order Number
     C                     Z-ADDYL0001    WCQ2NB           Event Number
      * Establish starting position
     C           KPSSC     SETLL@EYCPY2                    *
     C           KRSSC     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0001           Event Number
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCQ2NB    YL0001           Event Number
     C           KRSSC     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Event Code         RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Setup key
     C                     Z-ADDP2AIC3    WCAIC3           Company Number
     C                     Z-ADDP2C4NB    WCC4NB           Order Number
     C                     Z-ADDYL0001    WCQ2NB           Event Number
      * Establish starting position
     C           KRSSD     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      P2AIC3    IFNE WCAIC3                     Company Number
     C           P2C4NB    ORNE WCC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCJPCD    YL0002           Event Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPD Unship Ship Detail RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0002  1        Price Audit
     C                     MOVEL*BLANK    WN0003  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0004 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0005 112       Weight Shipped
     C                     MOVEL*BLANK    WN0006  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0007  1        Inter-Plant Tra
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSE01           Company Number
     C                     Z-ADDP2C4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Detail Line Status is Confirmed
      *   |- c2    : DB1.Item Code is Not Fuel Surcharge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDGMST    IFEQ 'R'                        *IF
     C           WDHGCD    IFNE 99400                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWDGMST    WN0001           Detail Line Sta
     C                     MOVELWDU0ST    WN0002           Price Audit
     C                     MOVELWDRFCD    WN0003           Price Audit Rea
      * If qty and weight are zero then make price audit "N".
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDCBQT    IFEQ 0                          *IF
     C           WDATWG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0002           Price Audit
     C                     MOVEL'SUB'     WN0003           Price Audit Rea
     C                     END                             *FI
      * Set Quantity/Weight shipped to 0 if this is a Plant order
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           P2XUST    IFEQ 'P'                        *IF
     C                     Z-ADD*ZERO     WN0004           Quantity Shippe
     C                     Z-ADD*ZERO     WN0005           Weight Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDCBQT    WN0004           Quantity Shippe
     C                     Z-ADDWDATWG    WN0005           Weight Shipped
     C                     END                             *FI
      * Reverse Issue
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Shipped Total is not equal zero
      *   |- c2    : DB1.Weight Shipped Total is Not equal zero
      *   '-
     C           WDCBQT    IFNE 0                          *IF
     C           WDATWG    ORNE 0                          *OR
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P2OBST    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR SFRVGN
      * 12/04/06 PKD Added Inter-Plant Transfer Processing.
      * Rtv Warehouse SHP     RT - Warehouse  * 
     C                     EXSR SGRVGN
      * Inter-Plant Transfer?
      * CASE:
      *  - c2 AND c3
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   |- c3    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'I'                        *IF
     C           YL0007    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0007           Inter-Plant Tra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0007           Inter-Plant Tra
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0007           Inter-Plant Tra
     C                     END                             *FI
      * WI517 DN 10/04/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Inv From Unship    RT - Manifest Detail  * 
     C                     EXSR SHRVGN
      * WI517 DN 10/06/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE: LCL.Send Email f/Failed API U is Yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVELYL0008    P3OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
      * CHG for UnShip         CH - Order Detail  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2AIC3    WEAIC3           Company Number
     C                     Z-ADDP2BKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0006           Warehouse Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAJCD    WN0006           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0006    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Trans Contol AS
     C                     MOVEL*BLANK    YL0004           Warehouse Locat
     C                     Z-ADD*ZERO     YL0005           Shipping Compan
     C                     Z-ADD*ZERO     YL0006           Accounting Comp
     C                     MOVEL*BLANK    YL0007           WHS Live with C
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFXUST    YL0003           Trans Contol AS
     C                     MOVELWFT0ST    YL0004           Warehouse Locat
     C                     Z-ADDWFBWC3    YL0005           Shipping Compan
     C                     Z-ADDWFBTC3    YL0006           Accounting Comp
     C                     MOVELWFRRSX    YL0007           WHS Live with C
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPD Inv From Unship    RT - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  70       Label Date
     C                     Z-ADD*ZERO     WN0009  70       Production Date
     C                     Z-ADD*ZERO     WN0010 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0011 112       Weight Shipped
     C                     MOVEL*BLANK    WN0012  1        First Time Flag
     C                     Z-ADD*ZERO     WN0013 112       Weight Billed
     C                     MOVEL*BLANK    WN0014 30        Description
     C                     MOVEL*BLANK    WN0015  2        UOM Cost
     C                     MOVEL*BLANK    WN0016  1        Shift Number
     C                     MOVEL*BLANK    WN0017 30        Description Lin
     C                     MOVEL*BLANK    WN0018 30        Description Lin
     C                     MOVEL*BLANK    WN0019  2        UOM Primary
     C                     Z-ADD*ZERO     WN0020  94       Conversion Fact
     C                     MOVEL*BLANK    WN0021  1        Operation Facto
     C                     MOVEL*BLANK    WN0022  2        UOM Second
     C                     Z-ADD*ZERO     WN0023  94       Conversion Fact
     C                     MOVEL*BLANK    WN0024  1        Operation Facto
     C                     MOVEL*BLANK    WN0025  2        UOM Third
     C                     MOVEL*BLANK    WN0026  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0027 112       Unit Weight
     C                     MOVEL*BLANK    WN0028  1        Production Date
     C                     MOVEL*BLANK    WN0029  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0030  52       Fresh Chilling
     C                     Z-ADD*ZERO     WN0031 114       Cost based on U
     C                     Z-ADD*ZERO     WN0032 114       Cost based on U
     C                     Z-ADD*ZERO     WN0033 114       Cost based on U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0012           First Time Flag
     C                     Z-ADD*ZERO     WN0010           Quantity Shippe
     C                     Z-ADD*ZERO     WN0011           Weight Shipped
     C                     Z-ADD*ZERO     WN0013           Weight Billed
     C                     MOVEL'1'       WN0016           Shift Number
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0009    PARM *ZERO     WQ0001 155       Current System
     C           YL0010    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Initialize Flags.
     C                     MOVEL'N'       YL0011           API was Called?
     C                     MOVEL'N'       YL0012           Inventory Updat
     C                     MOVEL'Y'       YL0013           First Time Thro
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WGDPNB    WQSH03           Order Sequence
     C           *LIKE     DEFN WGUENB    WQSH04           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Order Sequence
     C                     KFLD           WQSH04           Order Secondary
      * Setup key
     C                     Z-ADDWDAIC3    WQSH01           Company Number
     C                     Z-ADDWDC4NB    WQSH02           Order Number
     C                     Z-ADDWDDPNB    WQSH03           Order Sequence
     C                     Z-ADDWDUENB    WQSH04           Order Secondary
      * Establish starting position
     C           KRSSH     SETLL@FNCPEZ                    *
     C           KRSSH     READE@FNCPEZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0008           Label Date
     C                     Z-ADD*ZERO     WN0009           Production Date
     C                     Z-ADD*ZERO     WN0010           Quantity Shippe
     C                     Z-ADD*ZERO     WN0011           Weight Shipped
     C                     MOVEL*BLANK    WN0012           First Time Flag
     C                     Z-ADD*ZERO     WN0013           Weight Billed
     C                     MOVEL*BLANK    WN0014           Description
     C                     MOVEL*BLANK    WN0015           UOM Cost
     C                     MOVEL*BLANK    WN0016           Shift Number
     C                     MOVEL*BLANK    WN0017           Description Lin
     C                     MOVEL*BLANK    WN0018           Description Lin
     C                     MOVEL*BLANK    WN0019           UOM Primary
     C                     Z-ADD*ZERO     WN0020           Conversion Fact
     C                     MOVEL*BLANK    WN0021           Operation Facto
     C                     MOVEL*BLANK    WN0022           UOM Second
     C                     Z-ADD*ZERO     WN0023           Conversion Fact
     C                     MOVEL*BLANK    WN0024           Operation Facto
     C                     MOVEL*BLANK    WN0025           UOM Third
     C                     MOVEL*BLANK    WN0026           UOM Pricing
     C                     Z-ADD*ZERO     WN0027           Unit Weight
     C                     MOVEL*BLANK    WN0028           Production Date
     C                     MOVEL*BLANK    WN0029           Catch Weight St
     C                     Z-ADD*ZERO     WN0030           Fresh Chilling
     C                     Z-ADD*ZERO     WN0031           Cost based on U
     C                     Z-ADD*ZERO     WN0032           Cost based on U
     C                     Z-ADD*ZERO     WN0033           Cost based on U
     C                     MOVEL*BLANK    YL0008           Send Email f/Fa
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set production date for break usage & rtv item info
      * CASE: PAR.First Time Flag is Yes
     C           WN0012    IFEQ 'Y'                        *IF
     C                     Z-ADDWGELDT    WN0009           Production Date
     C                     Z-ADDWGK7DT    WN0008           Label Date
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SIRVGN
      * Set unit of measure for cost
      * CASE: PAR.Catch Weight Status is yes
     C           WN0029    IFEQ 'Y'                        *IF
     C                     MOVEL'LB'      WN0015           UOM Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0019    WN0015           UOM Cost
     C                     END                             *FI
     C                     MOVEL*BLANK    WUE7TX           Order Number Al
     C                     MOVELWDC4NB    WUE7TX           Order Number Al
     C                     MOVEL@CN,001   WUI6TX           Description 14A
     C                     Z-ADD1         ZQ      50
     C           WUI6TX    CAT  WUE7TX:ZQ WN0014    P      Description
     C                     MOVEL'N'       WN0012           First Time Flag
     C                     END                             *FI
      * When production date changes update inventory files
      * CASE: PAR.Production Date NE DB1.Production Date
     C           WN0009    IFNE WGELDT                     *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
      * 07/07/23 DN WI517-Added 'Upd Both Legacy & WIM USR=Y'.
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0003  30       Company Number
     C                     PARM WDHGCD    WQ0004  70       Item Code
     C                     PARM WDAJCD    WQ0005  3        Warehouse Code
     C                     PARM 'I'       WQ0006  1        Inventory Trans
     C                     PARM 'IO'      WQ0007  2        Inventory Trans
     C                     PARM YL0009    WQ0008  70       Transaction Dat
     C                     PARM WN0009    WQ0009  70       Production Date
     C                     PARM 'OP'      WQ0010  2        Item Transactio
     C                     PARM WN0014    WQ0011 30        Description
     C                     PARM *BLANK    WQ0012  3        Reason Code
     C                     PARM *BLANK    WQ0013 10        Lot ID
     C                     PARM WDC4NB    WQ0014  70       Order Number
     C                     PARM WN0016    WQ0015  1        Shift Number
     C                     PARM WN0008    WQ0016  70       Label Date
     C                     PARM WN0011    WQ0017 112       USR Weight Accu
     C                     PARM WN0010    WQ0018 112       Transaction Qty
     C                     PARM 'Y'       WQ0019  1        USR Unship Flag
     C                     PARM 'Y'       WQ0020  1        Upd Both Legacy
     C           YL0012    PARM *BLANK    WQ0021  1        Inventory Updat
     C           YL0011    PARM *BLANK    WQ0022  1        API was Called?
     C                     PARM P3COAB    WQ0023 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'N'                        *IF
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0013           First Time Thro
     C                     MOVEL'Y'       YL0008           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P2OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0024  30       Company Number
     C                     PARM WDHGCD    WQ0025  70       Item Code
     C                     PARM WDAJCD    WQ0026  3        Warehouse Code
     C                     PARM 'T'       WQ0027  1        Inventory Trans
     C                     PARM 'TW'      WQ0028  2        Inventory Trans
     C                     PARM YL0009    WQ0029  70       Transaction Dat
     C                     PARM WN0009    WQ0030  70       Production Date
     C                     PARM 'OP'      WQ0031  2        Item Transactio
     C                     PARM WN0014    WQ0032 30        Description
     C                     PARM *BLANK    WQ0033  3        Reason Code
     C                     PARM WDC4NB    WQ0034  70       Order Number
     C                     PARM WN0016    WQ0035  1        Shift Number
     C                     PARM WN0008    WQ0036  70       Label Date
     C                     PARM WN0006    WQ0037  3        USR Warehouse C
     C                     PARM WN0011    WQ0038 112       USR Weight Accu
     C                     PARM WN0010    WQ0039 112       USR Quantity
     C                     PARM 'Y'       WQ0040  1        USR Unship Flag
     C                     PARM WN0007    WQ0041  1        Inter-Plant Tra
     C           YL0012    PARM *BLANK    WQ0042  1        Inventory Updat
     C           YL0011    PARM *BLANK    WQ0043  1        API was Called?
     C                     PARM P3COAB    WQ0044 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'N'                        *IF
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0013           First Time Thro
     C                     MOVEL'Y'       YL0008           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWGELDT    WN0009           Production Date
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SJRVGN
      * If item bal detail doesn't exist, use manifest label date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     Z-ADDWGK7DT    WN0008           Label Date
     C                     END                             *FI
     C                     Z-ADD*ZERO     WN0010           Quantity Shippe
     C                     Z-ADD*ZERO     WN0011           Weight Shipped
     C                     END                             *FI
      * Add up quantity and weight for production date
     C                     ADD  WGFOQT    WN0010           Quantity Shippe
     C                     ADD  WGR0NB    WN0011           Weight Shipped
     C                     ADD  WGR0NB    WN0013           Weight Billed
     C           KRSSH     READE@FNCPEZ                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update inventory for last production date read
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
      * 07/07/23 DN WI517-Added 'Upd Both Legacy & WIM USR=Y'.
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0045  30       Company Number
     C                     PARM WDHGCD    WQ0046  70       Item Code
     C                     PARM WDAJCD    WQ0047  3        Warehouse Code
     C                     PARM 'I'       WQ0048  1        Inventory Trans
     C                     PARM 'IO'      WQ0049  2        Inventory Trans
     C                     PARM YL0009    WQ0050  70       Transaction Dat
     C                     PARM WN0009    WQ0051  70       Production Date
     C                     PARM 'OP'      WQ0052  2        Item Transactio
     C                     PARM WN0014    WQ0053 30        Description
     C                     PARM *BLANK    WQ0054  3        Reason Code
     C                     PARM *BLANK    WQ0055 10        Lot ID
     C                     PARM WDC4NB    WQ0056  70       Order Number
     C                     PARM WN0016    WQ0057  1        Shift Number
     C                     PARM WN0008    WQ0058  70       Label Date
     C                     PARM WN0011    WQ0059 112       USR Weight Accu
     C                     PARM WN0010    WQ0060 112       Transaction Qty
     C                     PARM 'Y'       WQ0061  1        USR Unship Flag
     C                     PARM 'Y'       WQ0062  1        Upd Both Legacy
     C           YL0012    PARM *BLANK    WQ0063  1        Inventory Updat
     C           YL0011    PARM *BLANK    WQ0064  1        API was Called?
     C                     PARM P3COAB    WQ0065 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'N'                        *IF
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0013           First Time Thro
     C                     MOVEL'Y'       YL0008           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P2OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0066  30       Company Number
     C                     PARM WDHGCD    WQ0067  70       Item Code
     C                     PARM WDAJCD    WQ0068  3        Warehouse Code
     C                     PARM 'T'       WQ0069  1        Inventory Trans
     C                     PARM 'TW'      WQ0070  2        Inventory Trans
     C                     PARM YL0009    WQ0071  70       Transaction Dat
     C                     PARM WN0009    WQ0072  70       Production Date
     C                     PARM 'OP'      WQ0073  2        Item Transactio
     C                     PARM WN0014    WQ0074 30        Description
     C                     PARM *BLANK    WQ0075  3        Reason Code
     C                     PARM WDC4NB    WQ0076  70       Order Number
     C                     PARM WN0016    WQ0077  1        Shift Number
     C                     PARM WN0008    WQ0078  70       Label Date
     C                     PARM WN0006    WQ0079  3        USR Warehouse C
     C                     PARM WN0011    WQ0080 112       USR Weight Accu
     C                     PARM WN0010    WQ0081 112       USR Quantity
     C                     PARM 'Y'       WQ0082  1        USR Unship Flag
     C                     PARM WN0007    WQ0083  1        Inter-Plant Tra
     C           YL0012    PARM *BLANK    WQ0084  1        Inventory Updat
     C           YL0011    PARM *BLANK    WQ0085  1        API was Called?
     C                     PARM P3COAB    WQ0086 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'N'                        *IF
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0013           First Time Thro
     C                     MOVEL'Y'       YL0008           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
      * Setup key
     C                     Z-ADDWDAIC3    WHAIC3           Company Number
     C                     Z-ADDWDHGCD    WHHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0017           Description Lin
     C                     MOVEL*BLANK    WN0018           Description Lin
     C                     MOVEL*BLANK    WN0019           UOM Primary
     C                     Z-ADD*ZERO     WN0020           Conversion Fact
     C                     MOVEL*BLANK    WN0021           Operation Facto
     C                     MOVEL*BLANK    WN0022           UOM Second
     C                     Z-ADD*ZERO     WN0023           Conversion Fact
     C                     MOVEL*BLANK    WN0024           Operation Facto
     C                     MOVEL*BLANK    WN0025           UOM Third
     C                     MOVEL*BLANK    WN0026           UOM Pricing
     C                     Z-ADD*ZERO     WN0027           Unit Weight
     C                     MOVEL*BLANK    WN0028           Production Date
     C                     MOVEL*BLANK    WN0029           Catch Weight St
     C                     Z-ADD*ZERO     WN0030           Fresh Chilling
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAVNA    WN0017           Description Lin
     C                     MOVELWHAWNA    WN0018           Description Lin
     C                     MOVELWHADCD    WN0019           UOM Primary
     C                     Z-ADDWHAWPC    WN0020           Conversion Fact
     C                     MOVELWHLXST    WN0021           Operation Facto
     C                     MOVELWHAECD    WN0022           UOM Second
     C                     Z-ADDWHAXPC    WN0023           Conversion Fact
     C                     MOVELWHLYST    WN0024           Operation Facto
     C                     MOVELWHAFCD    WN0025           UOM Third
     C                     MOVELWHAICD    WN0026           UOM Pricing
     C                     Z-ADDWHAIWG    WN0027           Unit Weight
     C                     MOVELWHFZST    WN0028           Production Date
     C                     MOVELWHAVST    WN0029           Catch Weight St
     C                     Z-ADDWHCHTM    WN0030           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIELDT           Production Date
      * Setup key
     C                     Z-ADDWDAIC3    WIAIC3           Company Number
     C                     Z-ADDWDHGCD    WIHGCD           Item Code
     C                     MOVELWDAJCD    WIAJCD           Warehouse Code
     C                     Z-ADDWN0009    WIELDT           Production Date
      * Establish starting position
     C           KRSSJ     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIK7DT    WN0008           Label Date
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG for UnShip         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034  70       Item Code
     C                     MOVEL*BLANK    WN0035  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0036  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0037  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0038 112       Billing Detail
     C                     Z-ADD*ZERO     WN0039 112       Billing Detail
     C                     Z-ADD*ZERO     WN0040 112       Billing Detail
     C                     Z-ADD*ZERO     WN0041 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0042  1        Comment Print A
     C                     MOVEL*BLANK    WN0043  1        Comment Print I
     C                     MOVEL*BLANK    WN0044  1        Comment Print P
     C                     MOVEL*BLANK    WN0045  1        Comment Print S
     C                     Z-ADD*ZERO     WN0046 112       Extended Amount
     C                     Z-ADD*ZERO     WN0047  70       Market Pricing
     C                     MOVEL*BLANK    WN0048  3        Commodity Marke
     C                     MOVEL*BLANK    WN0049  3        Date Method Cod
     C                     MOVEL*BLANK    WN0050  3        Price Method Co
     C                     Z-ADD*ZERO     WN0051 114       Price Overage O
     C                     Z-ADD*ZERO     WN0052  70       Contract Number
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     Z-ADD*ZERO     WN0054  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0055  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0056  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0057  1        Work Confirm St
     C                     MOVEL*BLANK    WN0058  1        Work Over_Short
     C                     MOVEL*BLANK    WN0059  1        OD Production P
     C                     MOVEL*BLANK    WN0060 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0061 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0062  1        Age Code
     C                     MOVEL*BLANK    WN0063  1        Palletize
     C                     MOVEL*BLANK    WN0064  1        Slip Sheet
     C                     MOVEL*BLANK    WN0065  1        Catch Weight St
     C                     MOVEL*BLANK    WN0066  1        Production Date
     C                     Z-ADD*ZERO     WN0067 112       Rated Freight
     C                     Z-ADD*ZERO     WN0068 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0069 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0070 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0071 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0072 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0073 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0074 114       Unit Price
     C                     Z-ADD*ZERO     WN0075 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0076 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0077 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0078 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0079  70       Requested Ship
     C                     Z-ADD*ZERO     WN0080  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0081  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0082  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0083  30       Item Structure
     C                     Z-ADD*ZERO     WN0084  30       Item Structure
     C                     Z-ADD*ZERO     WN0085  30       Item Structure
     C                     MOVEL*BLANK    WN0086  2        Item Level
     C                     MOVEL*BLANK    WN0087  2        Quality Level
     C                     MOVEL*BLANK    WN0088  2        Pricing Product
     C                     MOVEL*BLANK    WN0089  2        Season Product
     C                     Z-ADD*ZERO     WN0090  70       Date of Origina
     C                     MOVEL*BLANK    WN0091 10        User Profile Na
     C                     MOVEL*BLANK    WN0092  6        Country Code
     C                     MOVEL*BLANK    WN0093  3        Reason Code
     C                     MOVEL*BLANK    WN0094  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0095  1        Modified Flag
     C                     MOVEL*BLANK    WN0096  1        Substituted Fla
     C                     MOVEL*BLANK    WN0097  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0098 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0099 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0100  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0101  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0102  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0103  1        Affect Commissi
     C                     MOVEL*BLANK    WN0104  1        Affect Pricing
     C                     MOVEL*BLANK    WN0105  1        Released by Use
     C                     MOVEL*BLANK    WN0106  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0107  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0108  3        Production Ware
     C                     MOVEL*BLANK    WN0109  3        OD Price Type
     C                     Z-ADD*ZERO     WN0110  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0111  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0112  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0113  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0114  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0115  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0116  60       Price Code
     C                     Z-ADD*ZERO     WN0117  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0118  60       Substitution Li
     C                     Z-ADD*ZERO     WN0119  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0120 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0121 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0122 112       OD Item Target
     C                     Z-ADD*ZERO     WN0123 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0124 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0125 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0126 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0127 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0128 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0129 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0130 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0131 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0132 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0133  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0134  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0135  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0136 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0137  40       Item Age Days
     C                     Z-ADD*ZERO     WN0138  70       Production Ovr
     C                     Z-ADD*ZERO     WN0139  70       Production Ovr
     C                     MOVEL*BLANK    WN0140  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0141  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0142  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0143  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0144  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0145  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0146  1        EDI Status 1
     C                     MOVEL*BLANK    WN0147  1        EDI Status 2
     C                     MOVEL*BLANK    WN0148  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0149  60       Job Time
     C                     MOVEL*BLANK    WN0150 10        User Id
     C                     MOVEL*BLANK    WN0151 10        Job Name
     C                     Z-ADD*ZERO     WN0152  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWDAIC3    WJAIC3           Company Number
     C                     Z-ADDWDC4NB    WJC4NB           Order Number
     C                     Z-ADDWDDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWDUENB    WJUENB           Order Secondary
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHSK    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'A'       WJGMST    P      Detail Line Sta
     C                     MOVELWN0001    WJGNST    P      Detail Line Sta
     C                     MOVELWN0002    WJU0ST    P      Price Audit
     C                     MOVELWN0003    WJRFCD    P      Price Audit Rea
     C                     Z-ADDWN0004    WJCBQT           Quantity Shippe
     C                     Z-ADDWN0005    WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     MOVELWDAMST    WJAMST    P      Affect Inventor
     C                     MOVELYL0002    WJJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WJAATM' defaulted for 'Job Time'.
      * Field '(DB1) WJAYNA' defaulted for 'User Id'.
      * Field '(DB1) WJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C                     MOVEL@CN,003   WJA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0153  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0154  70       Item Code
     C                     MOVEL*BLANK    WN0155  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0156  70       Production Date
     C                     Z-ADD*ZERO     WN0157  50       Lot Number
     C                     MOVEL*BLANK    WN0158  4        Location Code
     C                     Z-ADD*ZERO     WN0159  20       Location Level
     C                     Z-ADD*ZERO     WN0160  50       LLT Transaction
     C                     Z-ADD*ZERO     WN0161 112       LLT Transaction
     C                     Z-ADD*ZERO     WN0162 112       Weight Order 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0014           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSL01           Company Number
     C                     Z-ADDP2C4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@L8CPZO                    *
     C           KRSSL     READE@L8CPZO                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0153           Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0162           Weight Order 2
      * 1ST:  First time process
      * CASE: LCL.First Time Flag is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     Z-ADDWKHGCD    WN0154           Item Code
     C                     MOVELWKAJCD    WN0155           Warehouse Code
     C                     Z-ADDWKELDT    WN0156           Production Date
     C                     Z-ADDWKLXNM    WN0157           Lot Number
     C                     MOVELWKYMCD    WN0158           Location Code
     C                     Z-ADDWKYNCD    WN0159           Location Level
     C                     MOVEL'N'       YL0014           First Time Flag
     C                     END                             *FI
      * CHG: Item, Whs, PDte, Lot, Loc, Level
      * CASE: CHG: Item, Whs, PDte, Lot, Loc, Level
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Item Code NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   |- c3    : PAR.Production Date NE DB1.Production Date
      *   |- c4    : PAR.Lot Number NE DB1.Lot Number
      *   |- c5    : PAR.Location Code NE DB1.Location Code
      *   |- c6    : PAR.Location Level NE DB1.Location Level
      *   '-
     C           WN0154    IFNE WKHGCD                     *IF
     C           WN0155    ORNE WKAJCD                     *OR
     C           WN0156    ORNE WKELDT                     *OR
     C           WN0157    ORNE WKLXNM                     *OR
     C           WN0158    ORNE WKYMCD                     *OR
     C           WN0159    ORNE WKYNCD                     *OR
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0160    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0163  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0164  1        EDI Status 1
     C                     MOVEL*BLANK    WN0165  1        EDI Status 2
     C                     MOVEL*BLANK    WN0166  1        EDI Status 3
     C                     MOVEL*BLANK    WN0167  1        Record Status
     C                     Z-ADD*ZERO     WN0168  60       Job Time
     C                     MOVEL*BLANK    WN0169 10        User Id
     C                     MOVEL*BLANK    WN0170 10        Job Name
     C                     Z-ADD*ZERO     WN0171  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0001           Company Number
     C                     Z-ADDWN0154    WL0002           Item Code
     C                     MOVELWN0155    WL0003    P      Warehouse Code
     C                     MOVEL'S'       WL0004    P      LLT Transaction
     C                     Z-ADD##JDT     WL0005           LLT Transaction
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0163           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0007           Company Number
     C                     Z-ADDWN0154    WL0008           Item Code
     C                     MOVELWN0155    WL0009    P      Warehouse Code
     C                     MOVEL'S'       WL0010    P      LLT Transaction
     C                     Z-ADD##JDT     WL0011           LLT Transaction
     C                     Z-ADDWN0163    WL0012           LLT Sequence Nu
     C                     Z-ADDWN0156    WL0013           LLT Production
     C                     Z-ADDWN0160    WL0014           LLT Transaction
     C                     Z-ADDWN0161    WL0015           LLT Transaction
     C                     Z-ADDWN0157    WL0016           LLT Lot Number
     C                     MOVELWN0158    WL0017    P      Location Code
     C                     Z-ADDWN0159    WL0018           LLT Location Le
     C                     MOVEL*BLANK    WL0019           Transfer Wareho
     C                     Z-ADD*ZERO     WL0020           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0021           Transfer Locati
     C                     Z-ADD*ZERO     WL0022           LLT Transfer Lo
     C                     Z-ADDWKC4NB    WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0164    WL0027    P      EDI Status 1
     C                     MOVELWN0165    WL0028    P      EDI Status 2
     C                     MOVELWN0166    WL0029    P      EDI Status 3
     C                     MOVELWN0167    WL0030    P      Record Status
     C                     Z-ADDWN0168    WL0031           Job Time
     C                     MOVELWN0169    WL0032    P      User Id
     C                     MOVELWN0170    WL0033    P      Job Name
     C                     Z-ADDWN0171    WL0034           Job Date
     C                     EXSR SNCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0035           Company Number
     C                     Z-ADDWN0154    WL0036           Item Code
     C                     MOVELWN0155    WL0037    P      Warehouse Code
     C                     Z-ADDWN0156    WL0038           Production Date
     C                     Z-ADDWN0157    WL0039           Lot Number
     C                     MOVELWN0158    WL0040    P      Location Code
     C                     Z-ADDWN0159    WL0041           Location Level
     C                     Z-ADDWN0160    WL0042           Quantity Loc Tr
     C                     Z-ADDWN0161    WL0043           Weight Order 2
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     Z-ADDWKHGCD    WN0154           Item Code
     C                     MOVELWKAJCD    WN0155           Warehouse Code
     C                     Z-ADDWKELDT    WN0156           Production Date
     C                     Z-ADDWKLXNM    WN0157           Lot Number
     C                     MOVELWKYMCD    WN0158           Location Code
     C                     Z-ADDWKYNCD    WN0159           Location Level
     C                     Z-ADD*ZERO     WN0160           LLT Transaction
     C                     Z-ADD*ZERO     WN0161           LLT Transaction
     C                     END                             *FI
      * PRC:  Accumulate Quantity
      * CASE: PAR.OIA Allocation Sts is Shipped
     C           'U'       IFEQ 'S'                        *IF
     C           WKJ6QT    MULT -1        WN0153           Quantity Loc Tr
     C                     ADD  WN0153    WN0160           LLT Transaction
      * RMC 1/9/17 reduce weight too
     C           WKG9WG    MULT -1        WN0162           Weight Order 2
     C                     ADD  WN0162    WN0161           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0095           Company Number
     C                     Z-ADDWKC4NB    WL0096           Order Number
     C                     Z-ADDWKDPNB    WL0097           Order Sequence
     C                     Z-ADDWKUENB    WL0098           Order Secondary
     C                     Z-ADDWKALSW    WL0099           Allocation Seq
     C                     MOVEL'U'       WL0100    P      OIA Allocation
     C                     EXSR SXCHRC
     C                     ELSE
      * CASE: PAR.OIA Allocation Sts is Unshipped
     C           'U'       IFEQ 'U'                        *IF
     C                     ADD  WKJ6QT    WN0160           LLT Transaction
      * RMC 1/9/17 increase weight too
     C                     ADD  WKG9WG    WN0161           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0095           Company Number
     C                     Z-ADDWKC4NB    WL0096           Order Number
     C                     Z-ADDWKDPNB    WL0097           Order Sequence
     C                     Z-ADDWKUENB    WL0098           Order Secondary
     C                     Z-ADDWKALSW    WL0099           Allocation Seq
     C                     MOVEL'U'       WL0100    P      OIA Allocation
     C                     EXSR SXCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@L8CPZO                  90*
     C                     ENDDO
      * USER: Exit processing
      * Do if qty> 0    ----RMC 2/15/06
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0160    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0244  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0245  1        EDI Status 1
     C                     MOVEL*BLANK    WN0246  1        EDI Status 2
     C                     MOVEL*BLANK    WN0247  1        EDI Status 3
     C                     MOVEL*BLANK    WN0248  1        Record Status
     C                     Z-ADD*ZERO     WN0249  60       Job Time
     C                     MOVEL*BLANK    WN0250 10        User Id
     C                     MOVEL*BLANK    WN0251 10        Job Name
     C                     Z-ADD*ZERO     WN0252  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0001           Company Number
     C                     Z-ADDWN0154    WL0002           Item Code
     C                     MOVELWN0155    WL0003    P      Warehouse Code
     C                     MOVEL'S'       WL0004    P      LLT Transaction
     C                     Z-ADD##JDT     WL0005           LLT Transaction
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0244           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0007           Company Number
     C                     Z-ADDWN0154    WL0008           Item Code
     C                     MOVELWN0155    WL0009    P      Warehouse Code
     C                     MOVEL'S'       WL0010    P      LLT Transaction
     C                     Z-ADD##JDT     WL0011           LLT Transaction
     C                     Z-ADDWN0244    WL0012           LLT Sequence Nu
     C                     Z-ADDWN0156    WL0013           LLT Production
     C                     Z-ADDWN0160    WL0014           LLT Transaction
     C                     Z-ADDWN0161    WL0015           LLT Transaction
     C                     Z-ADDWN0157    WL0016           LLT Lot Number
     C                     MOVELWN0158    WL0017    P      Location Code
     C                     Z-ADDWN0159    WL0018           LLT Location Le
     C                     MOVEL*BLANK    WL0019           Transfer Wareho
     C                     Z-ADD*ZERO     WL0020           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0021           Transfer Locati
     C                     Z-ADD*ZERO     WL0022           LLT Transfer Lo
     C                     Z-ADDWKC4NB    WL0023           Order Number
     C                     MOVEL'P'       WL0024    P      LLT Status
     C                     MOVELWULLTU    WL0025    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0026    P      LTT Unused Sts
     C                     MOVELWN0245    WL0027    P      EDI Status 1
     C                     MOVELWN0246    WL0028    P      EDI Status 2
     C                     MOVELWN0247    WL0029    P      EDI Status 3
     C                     MOVELWN0248    WL0030    P      Record Status
     C                     Z-ADDWN0249    WL0031           Job Time
     C                     MOVELWN0250    WL0032    P      User Id
     C                     MOVELWN0251    WL0033    P      Job Name
     C                     Z-ADDWN0252    WL0034           Job Date
     C                     EXSR SNCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0035           Company Number
     C                     Z-ADDWN0154    WL0036           Item Code
     C                     MOVELWN0155    WL0037    P      Warehouse Code
     C                     Z-ADDWN0156    WL0038           Production Date
     C                     Z-ADDWN0157    WL0039           Lot Number
     C                     MOVELWN0158    WL0040    P      Location Code
     C                     Z-ADDWN0159    WL0041           Location Level
     C                     Z-ADDWN0160    WL0042           Quantity Loc Tr
     C                     Z-ADDWN0161    WL0043           Weight Order 2
     C                     EXSR SORVGN
     C                     END                             *FI
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WLHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WLAJCD    WQSM03           Warehouse Code
     C           *LIKE     DEFN WLLTRT    WQSM04           LLT Transaction
     C           *LIKE     DEFN WLLRDT    WQSM05           LLT Transaction
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
     C                     KFLD           WQSM04           LLT Transaction
     C                     KFLD           WQSM05           LLT Transaction
      * Setup key
     C                     Z-ADDWL0001    WQSM01           Company Number
     C                     Z-ADDWL0002    WQSM02           Item Code
     C                     MOVELWL0003    WQSM03           Warehouse Code
     C                     MOVELWL0004    WQSM04           LLT Transaction
     C                     Z-ADDWL0005    WQSM05           LLT Transaction
      * Establish starting position
     C           KRSSM     SETLL@L7CPUK                    *
     C           KRSSM     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0006           LLT Sequence Nu
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WLLLTS    ADD  1         WL0006           LLT Sequence Nu
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0007    WMAIC3           Company Number
     C                     Z-ADDWL0008    WMHGCD           Item Code
     C                     MOVELWL0009    WMAJCD           Warehouse Code
     C                     MOVELWL0010    WMLTRT           LLT Transaction
     C                     Z-ADDWL0011    WMLRDT           LLT Transaction
     C                     Z-ADDWL0012    WMLLTS           LLT Sequence Nu
     C                     Z-ADDWL0013    WMLSDT           LLT Production
     C                     Z-ADDWL0014    WMJ5QT           LLT Transaction
     C                     Z-ADDWL0015    WMG8WG           LLT Transaction
     C                     Z-ADDWL0016    WMLLTN           LLT Lot Number
     C                     MOVELWL0017    WMYMCD           Location Code
     C                     Z-ADDWL0018    WMLLCL           LLT Location Le
     C                     MOVELWL0019    WMBNAA           Transfer Wareho
     C                     Z-ADDWL0020    WMLLTR           LLT Transfer Lo
     C                     MOVELWL0021    WMY2CD           Transfer Locati
     C                     Z-ADDWL0022    WMLLTL           LLT Transfer Lo
     C                     Z-ADDWL0023    WMC4NB           Order Number
     C                     MOVELWL0024    WMLOST           LLT Status
     C                     MOVELWL0025    WMLLTU           LTT Unused Sts
     C                     MOVELWL0026    WMLLYT           LTT Unused Sts
     C                     MOVELWL0027    WMUVST           EDI Status 1
     C                     MOVELWL0028    WMUWST           EDI Status 2
     C                     MOVELWL0029    WMUXST           EDI Status 3
     C                     MOVELWL0030    WMVSST           Record Status
     C                     Z-ADDWL0031    WMAATM           Job Time
     C                     MOVELWL0032    WMAYNA           User Id
     C                     MOVELWL0033    WMA0NA           Job Name
     C                     Z-ADDWL0034    WMAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WMVSST           Record Status
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##PGM     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRSN    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
     C                     KFLD           WMLTRT           LLT Transaction
     C                     KFLD           WMLRDT           LLT Transaction
     C                     KFLD           WMLLTS           LLT Sequence Nu
      * Check for duplicate primary key
     C           KLCRSN    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0172  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0173 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0174  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0175 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0176  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0177 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0178  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0179  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0180  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0181  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0182  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0183  1        ILL Status
     C                     MOVEL*BLANK    WN0184  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0185  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0186  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0187  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0188  1        EDI Status 1
     C                     MOVEL*BLANK    WN0189  1        EDI Status 2
     C                     MOVEL*BLANK    WN0190  1        EDI Status 3
     C                     MOVEL*BLANK    WN0191  1        Record Status
     C                     Z-ADD*ZERO     WN0192  60       Job Time
     C                     MOVEL*BLANK    WN0193 10        User Id
     C                     MOVEL*BLANK    WN0194 10        Job Name
     C                     Z-ADD*ZERO     WN0195  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOAJCD           Warehouse Code
     C                     KFLD           WOELDT           Production Date
     C                     KFLD           WOLXNM           Lot Number
     C                     KFLD           WOYMCD           Location Code
     C                     KFLD           WOYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0035    WOAIC3           Company Number
     C                     Z-ADDWL0036    WOHGCD           Item Code
     C                     MOVELWL0037    WOAJCD           Warehouse Code
     C                     Z-ADDWL0038    WOELDT           Production Date
     C                     Z-ADDWL0039    WOLXNM           Lot Number
     C                     MOVELWL0040    WOYMCD           Location Code
     C                     Z-ADDWL0041    WOYNCD           Location Level
      * Establish starting position
     C           KRSSO     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0196  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0197  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0037    WL0044    P      Warehouse Code
     C                     MOVELWL0040    WL0045    P      Location Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WN0196    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0196    WL0047    P      WLT Type Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0048    WN0197           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0038    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0197    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0178
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0178
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0035    WL0049           Company Number
     C                     Z-ADDWL0036    WL0050           Item Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0051    WN0173           Unit Weight
     C                     MOVELWL0052    YL0015    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0035    WL0053           Company Number
     C                     Z-ADDWL0036    WL0054           Item Code
     C                     MOVELWL0037    WL0055    P      Warehouse Code
     C                     Z-ADDWL0038    WL0056           Production Date
     C                     Z-ADDWL0039    WL0057           Lot Number
     C                     MOVELWL0040    WL0058    P      Location Code
     C                     Z-ADDWL0041    WL0059           Location Level
     C                     Z-ADDWL0042    WL0060           ILL Item Qty On
     C                     Z-ADDWN0173    WL0061           ILL Unit Weight
     C                     Z-ADDWN0174    WL0062           ILL Co-Packer L
     C                     Z-ADDWN0175    WL0063           ILL Item Wgt On
     C                     Z-ADDWN0176    WL0064           ILL Unused Qty
     C                     Z-ADDWN0177    WL0065           ILL Unused Wgt
     C                     Z-ADDWN0178    WL0066           ILL Avail Ship
     C                     Z-ADDWN0179    WL0067           ILL Unused Date
     C                     Z-ADDWN0180    WL0068           ILL Unused Date
     C                     Z-ADDWN0181    WL0069           ILL Unused Nbr
     C                     MOVELWN0182    WL0070    P      ILL Customer Co
     C                     MOVEL'A'       WL0071    P      ILL Status
     C                     MOVELWN0184    WL0072    P      ILL Unused Sts
     C                     MOVELWN0185    WL0073    P      ILL Unused Sts
     C                     MOVELWN0186    WL0074    P      ILL Unused Sts
     C                     MOVELWN0187    WL0075    P      Inv Hold Reason
     C                     MOVELWN0188    WL0076    P      EDI Status 1
     C                     MOVELWN0189    WL0077    P      EDI Status 2
     C                     MOVELWN0190    WL0078    P      EDI Status 3
     C                     MOVELWN0191    WL0079    P      Record Status
     C                     Z-ADDWN0192    WL0080           Job Time
     C                     MOVELWN0193    WL0081    P      User Id
     C                     MOVELWN0194    WL0082    P      Job Name
     C                     Z-ADDWN0195    WL0083           Job Date
     C                     EXSR SSCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WOJ2QT    ADD  WL0042    WN0172           ILL Item Qty On
     C           WOG6WG    ADD  WL0043    WN0175           ILL Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0172    IFGT 0                          *IF
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
     C                     EXSR STCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0084           Company Number
     C                     Z-ADDWOHGCD    WL0085           Item Code
     C                     MOVELWOAJCD    WL0086    P      Warehouse Code
     C                     Z-ADDWOELDT    WL0087           Production Date
     C                     Z-ADDWOLXNM    WL0088           Lot Number
     C                     MOVELWOYMCD    WL0089    P      Location Code
     C                     Z-ADDWOYNCD    WL0090           Location Level
     C                     EXSR SUDLRC
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0091           Company Number
     C                     Z-ADDWOHGCD    WL0092           Item Code
     C                     MOVELWOAJCD    WL0093    P      Warehouse Code
     C                     Z-ADDWOELDT    WL0094           Production Date
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRYMCD           Location Code
      * Setup key
     C                     MOVELWL0044    WRAJCD           Warehouse Code
     C                     MOVELWL0045    WRYMCD           Location Code
      * Establish starting position
     C           KRSSP     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0046           WLT Type Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAGSX    WL0046           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WSAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0047    WSAGSX           WLT Type Code
      * Establish starting position
     C           KRSSQ     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0048           WLT Type Chill
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSSLTY    WL0048           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0049    WHAIC3           Company Number
     C                     Z-ADDWL0050    WHHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0051           Unit Weight
     C                     MOVEL*BLANK    WL0052           Quality Level
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHAIWG    WL0051           Unit Weight
     C                     MOVELWHHICD    WL0052           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0053    WTAIC3           Company Number
     C                     Z-ADDWL0054    WTHGCD           Item Code
     C                     MOVELWL0055    WTAJCD           Warehouse Code
     C                     Z-ADDWL0056    WTELDT           Production Date
     C                     Z-ADDWL0057    WTLXNM           Lot Number
     C                     MOVELWL0058    WTYMCD           Location Code
     C                     Z-ADDWL0059    WTYNCD           Location Level
     C                     Z-ADDWL0060    WTJ2QT           ILL Item Qty On
     C                     Z-ADDWL0061    WTG5WG           ILL Unit Weight
     C                     Z-ADDWL0062    WTJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0063    WTG6WG           ILL Item Wgt On
     C                     Z-ADDWL0064    WTJ4QT           ILL Unused Qty
     C                     Z-ADDWL0065    WTG7WG           ILL Unused Wgt
     C                     Z-ADDWL0066    WTLODT           ILL Avail Ship
     C                     Z-ADDWL0067    WTLPDT           ILL Unused Date
     C                     Z-ADDWL0068    WTLQDT           ILL Unused Date
     C                     Z-ADDWL0069    WTNBR            ILL Unused Nbr
     C                     MOVELWL0070    WTYTCD           ILL Customer Co
     C                     MOVELWL0071    WTAMSX           ILL Status
     C                     MOVELWL0072    WTASSX           ILL Unused Sts
     C                     MOVELWL0073    WTATSX           ILL Unused Sts
     C                     MOVELWL0074    WTAUSX           ILL Unused Sts
     C                     MOVELWL0075    WTYSCD           Inv Hold Reason
     C                     MOVELWL0076    WTUVST           EDI Status 1
     C                     MOVELWL0077    WTUWST           EDI Status 2
     C                     MOVELWL0078    WTUXST           EDI Status 3
     C                     MOVELWL0079    WTVSST           Record Status
     C                     Z-ADDWL0080    WTAATM           Job Time
     C                     MOVELWL0081    WTAYNA           User Id
     C                     MOVELWL0082    WTA0NA           Job Name
     C                     Z-ADDWL0083    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSS    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0198 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0199  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0200  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0201 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0202  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0203  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0204  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0205  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0206  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0207  1        ILL Status
     C                     MOVEL*BLANK    WN0208  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0209  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0210  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0211  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0212  1        EDI Status 1
     C                     MOVEL*BLANK    WN0213  1        EDI Status 2
     C                     MOVEL*BLANK    WN0214  1        EDI Status 3
     C                     MOVEL*BLANK    WN0215  1        Record Status
     C                     Z-ADD*ZERO     WN0216  60       Job Time
     C                     MOVEL*BLANK    WN0217 10        User Id
     C                     MOVEL*BLANK    WN0218 10        Job Name
     C                     Z-ADD*ZERO     WN0219  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWOAIC3    WTAIC3           Company Number
     C                     Z-ADDWOHGCD    WTHGCD           Item Code
     C                     MOVELWOAJCD    WTAJCD    P      Warehouse Code
     C                     Z-ADDWOELDT    WTELDT           Production Date
     C                     Z-ADDWOLXNM    WTLXNM           Lot Number
     C                     MOVELWOYMCD    WTYMCD    P      Location Code
     C                     Z-ADDWOYNCD    WTYNCD           Location Level
      *
     C           KLCHST    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
     C           KLCHST    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YBRDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0172    WTJ2QT           ILL Item Qty On
     C                     Z-ADDWN0175    WTG6WG           ILL Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0220  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0084    WTAIC3           Company Number
     C                     Z-ADDWL0085    WTHGCD           Item Code
     C                     MOVELWL0086    WTAJCD           Warehouse Code
     C                     Z-ADDWL0087    WTELDT           Production Date
     C                     Z-ADDWL0088    WTLXNM           Lot Number
     C                     MOVELWL0089    WTYMCD           Location Code
     C                     Z-ADDWL0090    WTYNCD           Location Level
      *
     C           KLDLSU    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
     C           KLDLSU    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIELDT           Production Date
      * Setup key
     C                     Z-ADDWL0091    WIAIC3           Company Number
     C                     Z-ADDWL0092    WIHGCD           Item Code
     C                     MOVELWL0093    WIAJCD           Warehouse Code
     C                     Z-ADDWL0094    WIELDT           Production Date
      * Establish starting position
     C           KRSSV     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           WIARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR SWDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWIAIC3    WVAIC3           Company Number
     C                     Z-ADDWIHGCD    WVHGCD           Item Code
     C                     MOVELWIAJCD    WVAJCD           Warehouse Code
     C                     Z-ADDWIELDT    WVELDT           Production Date
      *
     C           KLDLSW    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C                     KFLD           WVELDT           Production Date
     C           KLDLSW    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0221  50       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0222 112       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0223  50       OIA Co-Packer L
     C                     Z-ADD*ZERO     WN0224 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0225  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0226  1        OIA Modified St
     C                     MOVEL*BLANK    WN0227  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0228  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0229  2        OIA Unused Sts
     C                     Z-ADD*ZERO     WN0230  70       Item Code
     C                     MOVEL*BLANK    WN0231  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0232  70       Production Date
     C                     Z-ADD*ZERO     WN0233  50       Lot Number
     C                     MOVEL*BLANK    WN0234  4        Location Code
     C                     Z-ADD*ZERO     WN0235  20       Location Level
     C                     MOVEL*BLANK    WN0236  1        EDI Status 1
     C                     MOVEL*BLANK    WN0237  1        EDI Status 2
     C                     MOVEL*BLANK    WN0238  1        EDI Status 3
     C                     MOVEL*BLANK    WN0239  1        Record Status
     C                     Z-ADD*ZERO     WN0240  60       Job Time
     C                     MOVEL*BLANK    WN0241 10        User Id
     C                     MOVEL*BLANK    WN0242 10        Job Name
     C                     Z-ADD*ZERO     WN0243  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @L8CPSX
     C                     Z-ADDWL0095    WWAIC3           Company Number
     C                     Z-ADDWL0096    WWC4NB           Order Number
     C                     Z-ADDWL0097    WWDPNB           Order Sequence
     C                     Z-ADDWL0098    WWUENB           Order Secondary
     C                     Z-ADDWL0099    WWALSW           Allocation Seq
      *
     C           KLCHSX    KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
     C                     KFLD           WWDPNB           Order Sequence
     C                     KFLD           WWUENB           Order Secondary
     C                     KFLD           WWALSW           Allocation Seq
     C           KLCHSX    CHAIN@L8CPSX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL81    YCRDCS
      * Move non-key fields to @L8CPSX
     C                     MOVELWL0100    WWSOAS    P      OIA Allocation
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##PGM     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@L8CPSX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * UPD Unship Load Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WXRMNB           Load ID
      * Setup key
     C                     Z-ADDP2RMNB    WXRMNB           Load ID
      * Establish starting position
     C           KRSSY     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 11/12/02  zero out actual ship date
      * CASE: DB1.Load Status is Shipped
     C           WXPKST    IFEQ 'S'                        *IF
      * CHG Load when UnshippedCH - Load Header  * 
     C                     EXSR SZCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * CHG Load when UnshippedCH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0253  1        LTL Flag
     C                     Z-ADD*ZERO     WN0254  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0255 15        Seal 1
     C                     MOVEL*BLANK    WN0256 15        Seal 2
     C                     MOVEL*BLANK    WN0257 15        Seal 3
     C                     MOVEL*BLANK    WN0258 15        Seal 4
     C                     MOVEL*BLANK    WN0259 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0260  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0261 112       Flat Amount
     C                     MOVEL*BLANK    WN0262  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0263  50       Total Stops
     C                     MOVEL*BLANK    WN0264 20        Trailer Id
     C                     MOVEL*BLANK    WN0265  3        Transloader Car
     C                     Z-ADD*ZERO     WN0266  40       BOL Time
     C                     MOVEL*BLANK    WN0267  3        Carrier Code
     C                     MOVEL*BLANK    WN0268  7        Truck Size
     C                     Z-ADD*ZERO     WN0269  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0270 112       Rated Freight
     C                     MOVEL*BLANK    WN0271  1        Ship Status
     C                     MOVEL*BLANK    WN0272  1        Load Type
     C                     Z-ADD*ZERO     WN0273  50       Number Pallets
     C                     Z-ADD*ZERO     WN0274  50       Number Pallets
     C                     Z-ADD*ZERO     WN0275 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0276  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0277  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0278  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0279 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0280 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0281  70       Actual Departur
     C                     Z-ADD*ZERO     WN0282  40       Departure Time
     C                     Z-ADD*ZERO     WN0283  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0284  52       Product Tempera
     C                     Z-ADD*ZERO     WN0285  50       Number Spacers
     C                     MOVEL*BLANK    WN0286 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0287  70       Total Load Mile
     C                     MOVEL*BLANK    WN0288 12        Recorder ID
     C                     MOVEL*BLANK    WN0289  2        Shipping Method
     C                     MOVEL*BLANK    WN0290  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0291  2        Ship To State C
     C                     Z-ADD*ZERO     WN0292  70       Gross Weight
     C                     MOVEL*BLANK    WN0293  3        Carrier Broker
     C                     MOVEL*BLANK    WN0294  1        Export Status
     C                     MOVEL*BLANK    WN0295  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0296  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0297  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0298  70       Spotted Date
     C                     Z-ADD*ZERO     WN0299  60       Spotted Time
     C                     Z-ADD*ZERO     WN0300  70       Load Finished D
     C                     Z-ADD*ZERO     WN0301  60       Load Finished T
     C                     Z-ADD*ZERO     WN0302  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0303  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0304  70       Truck Departure
     C                     Z-ADD*ZERO     WN0305  60       Truck Departure
     C                     Z-ADD*ZERO     WN0306  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0307  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0308  3        Shipping Line
     C                     MOVEL*BLANK    WN0309 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0310 30        Vessel Name
     C                     Z-ADD*ZERO     WN0311  50       Voyage
     C                     Z-ADD*ZERO     WN0312  70       Sail Date
     C                     MOVEL*BLANK    WN0313 12        Booking Number
     C                     MOVEL*BLANK    WN0314 20        Discharge Port
     C                     Z-ADD*ZERO     WN0315  70       Arrival Date
     C                     MOVEL*BLANK    WN0316 12        Container Numbe
     C                     Z-ADD*ZERO     WN0317  70       Date In
     C                     Z-ADD*ZERO     WN0318  60       Time In
     C                     Z-ADD*ZERO     WN0319  70       Date Out
     C                     Z-ADD*ZERO     WN0320  60       Time Out
     C                     Z-ADD*ZERO     WN0321 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0322  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0323  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0324  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0325  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0326  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0327  70       Requested Deliv
     C                     MOVEL*BLANK    WN0328  1        Load Acceptance
     C                     MOVEL*BLANK    WN0329  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0330  70       On Yard Date
     C                     Z-ADD*ZERO     WN0331  60       On Yard Time
     C                     Z-ADD*ZERO     WN0332  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0333  60       Deadline Depart
     C                     MOVEL*BLANK    WN0334  1        Load Held Over
     C                     MOVEL*BLANK    WN0335  1        Load Held Over
     C                     MOVEL*BLANK    WN0336 15        Load Held Over
     C                     MOVEL*BLANK    WN0337 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0338 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0339  70       Express Mail Da
     C                     MOVEL*BLANK    WN0340  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0341  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0342  70       Product Complet
     C                     Z-ADD*ZERO     WN0343  60       Product Complet
     C                     Z-ADD*ZERO     WN0344  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0345  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0346  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0347  1        Load Confirmed
     C                     MOVEL*BLANK    WN0348 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0349  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0350  60       Load Door 1
     C                     Z-ADD*ZERO     WN0351  70       Override Total
     C                     Z-ADD*ZERO     WN0352  60       Load Door 2
     C                     MOVEL*BLANK    WN0353  1        Partial Load
     C                     MOVEL*BLANK    WN0354  1        Load Confirmati
     C                     MOVEL*BLANK    WN0355  1        Export Load USD
     C                     MOVEL*BLANK    WN0356  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0357 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0358 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0359 15        Late Billing Em
     C                     MOVEL*BLANK    WN0360 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0361 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0362  1        Multi Company L
     C                     MOVEL*BLANK    WN0363  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0364  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0365  1        LH Power Only L
     C                     MOVEL*BLANK    WN0366  1        MG Created Load
     C                     MOVEL*BLANK    WN0367  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0368  2        Load U_M
     C                     MOVEL*BLANK    WN0369  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0370  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0371  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0372  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0373  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0374  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0375  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0376  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0377  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0378  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0379  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0380  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0381  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0382  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0383  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0384  60       LH Unused Time
     C                     MOVEL*BLANK    WN0385  1        EDI Status 1
     C                     MOVEL*BLANK    WN0386  1        EDI Status 2
     C                     MOVEL*BLANK    WN0387  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0388  60       Job Time
     C                     MOVEL*BLANK    WN0389 10        User Id
     C                     MOVEL*BLANK    WN0390 10        Job Name
     C                     Z-ADD*ZERO     WN0391  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWXRMNB    WYRMNB           Load ID
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WYRMNB           Load ID
     C           KLCHSZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWXAIC3    WYAIC3           Company Number
     C                     Z-ADDWXAODT    WYAODT           Scheduled Ship
     C                     MOVEL'L'       WYPKST    P      Load Status
     C                     Z-ADD*ZERO     WYF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WYJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WYBOTM           BOL Complete Ti
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WYAATM           Job Time
     C                     MOVEL##USR     WYAYNA           User Id
     C                     MOVEL##JOB     WYA0NA           Job Name
     C                     Z-ADD##JDT     WYAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * PFS Unship Order      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    TAAIC3           Company Number
     C                     Z-ADDP2C4NB    TAC4NB           Order Number
      * Establish starting position
     C           KRSTA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELTAGWST    YL0016           Header Status L
     C                     MOVEL'A'       YL0017           Header Status
      * CHG for Unship         CH - Order Header TRG  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * CHG for Unship         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0392  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0393  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0394  70       Ship To Custome
     C                     MOVEL*BLANK    WN0395 30        Ship To Name
     C                     MOVEL*BLANK    WN0396 30        Ship To Address
     C                     MOVEL*BLANK    WN0397 30        Ship To Address
     C                     MOVEL*BLANK    WN0398 30        Ship To Address
     C                     MOVEL*BLANK    WN0399 20        Ship To City
     C                     MOVEL*BLANK    WN0400  2        Ship To State C
     C                     MOVEL*BLANK    WN0401 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0402  70       Bill to Custome
     C                     MOVEL*BLANK    WN0403 30        Bill to Name
     C                     MOVEL*BLANK    WN0404 30        Bill to Address
     C                     MOVEL*BLANK    WN0405 30        Bill to Address
     C                     MOVEL*BLANK    WN0406 30        Bill to Address
     C                     MOVEL*BLANK    WN0407 20        Bill to City
     C                     MOVEL*BLANK    WN0408  2        Bill to State C
     C                     MOVEL*BLANK    WN0409 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0410 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0411  70       Order Date
     C                     Z-ADD*ZERO     WN0412  70       Requested Ship
     C                     Z-ADD*ZERO     WN0413  70       Cancel Date
     C                     MOVEL*BLANK    WN0414  2        Terms Code
     C                     MOVEL*BLANK    WN0415 40        Special Instruc
     C                     MOVEL*BLANK    WN0416 40        Special Instruc
     C                     MOVEL*BLANK    WN0417  3        Carrier Code
     C                     MOVEL*BLANK    WN0418  1        Comment Print A
     C                     MOVEL*BLANK    WN0419  1        Comment Print I
     C                     MOVEL*BLANK    WN0420  1        Comment Print P
     C                     MOVEL*BLANK    WN0421  1        Comment Print S
     C                     MOVEL*BLANK    WN0422  3        Reason Code
     C                     MOVEL*BLANK    WN0423  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0424  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0425 10        User Original E
     C                     Z-ADD*ZERO     WN0426  70       Date of Origina
     C                     Z-ADD*ZERO     WN0427 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0428 112       Order Weight To
     C                     MOVEL*BLANK    WN0429  1        Credit Hold
     C                     MOVEL*BLANK    WN0430  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0431  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0432  40       Requested Deliv
     C                     MOVEL*BLANK    WN0433  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0434 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0435  70       Load ID
     C                     Z-ADD*ZERO     WN0436  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0437 112       Rated Freight
     C                     MOVEL*BLANK    WN0438  1        LTL Flag
     C                     MOVEL*BLANK    WN0439  1        Price Audit
     C                     MOVEL*BLANK    WN0440  1        Price Status
     C                     MOVEL*BLANK    WN0441  2        Shipping Method
     C                     MOVEL*BLANK    WN0442  1        Export Status
     C                     MOVEL*BLANK    WN0443  1        Palletize
     C                     MOVEL*BLANK    WN0444  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0445  1        Slip Sheet
     C                     MOVEL*BLANK    WN0446  1        Age Code
     C                     Z-ADD*ZERO     WN0447  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0448  1        Load Type
     C                     Z-ADD*ZERO     WN0449  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0450  1        Load Plan Order
     C                     MOVEL*BLANK    WN0451  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0452  70       Resell Referenc
     C                     MOVEL*BLANK    WN0453 30        Special Comment
     C                     MOVEL*BLANK    WN0454 30        Special Comment
     C                     MOVEL*BLANK    WN0455  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0456  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0457  2        Manager Level C
     C                     MOVEL*BLANK    WN0458  3        VP Level Code
     C                     Z-ADD*ZERO     WN0459  70       Attach to Order
     C                     MOVEL*BLANK    WN0460  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0461  70       Invoice Number
     C                     MOVEL*BLANK    WN0462  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0463  70       Invoice Date
     C                     MOVEL*BLANK    WN0464  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0465  1        Block Order Fla
     C                     MOVEL*BLANK    WN0466  1        Order Certifica
     C                     Z-ADD*ZERO     WN0467 112       Invoice Order V
     C                     MOVEL*BLANK    WN0468  1        Process Sts for
     C                     MOVEL*BLANK    WN0469  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0470  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0471  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0472  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0473  1        Email Cust On O
     C                     MOVEL*BLANK    WN0474  1        Order Emailed
     C                     MOVEL*BLANK    WN0475  1        Export Docs Go
     C                     MOVEL*BLANK    WN0476  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0477  1        Broker Order St
     C                     MOVEL*BLANK    WN0478  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0479  2        Order Requires
     C                     MOVEL*BLANK    WN0480  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0481  2        Export USDA App
     C                     MOVEL*BLANK    WN0482  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0483  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0484  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0485  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0486  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0487  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0488  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0489  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0490  60       Time of Origina
     C                     Z-ADD*ZERO     WN0491  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0492  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0493  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0494 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0495 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0496 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0497 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0498 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0499  70       Claim Number
     C                     MOVEL*BLANK    WN0500  1        EDI Status 1
     C                     MOVEL*BLANK    WN0501  1        EDI Status 2
     C                     MOVEL*BLANK    WN0502  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0503  60       Job Time
     C                     MOVEL*BLANK    WN0504 10        User Id
     C                     MOVEL*BLANK    WN0505 10        Job Name
     C                     Z-ADD*ZERO     WN0506  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDTAAIC3    TBAIC3           Company Number
     C                     Z-ADDTAC4NB    TBC4NB           Order Number
      *
     C           KLCHTB    KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBC4NB           Order Number
     C           KLCHTB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     TBGNDT           Actual Shipped
     C                     MOVEL'N'       TBGJST    P      Order in Use
     C                     MOVELYL0017    TBGWST    P      Header Status
     C                     MOVELYL0016    TBGXST    P      Header Status L
     C                     MOVELTAXJST    TBXJST    P      Production Hold
     C                     MOVELYL0002    TBJPCD    P      Event Code
     C                     MOVELTAZ1ST    TBZ1ST    P      Modified Flag
     C                     Z-ADDTAVRVA    TBVRVA           A/R order Value
     C                     MOVELTAOBST    TBOBST    P      Billing Activit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##PGM     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDTBAIC3    PAAIC3           Company Number
     C                     Z-ADDTBC4NB    PAC4NB           Order Number
     C                     MOVELTBJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDTBANC7    PAANC7           AR Customer Num
     C                     Z-ADDTBBKC7    PABKC7           Ship To Custome
     C                     MOVELTBBRTX    PABRTX    P      Ship To Name
     C                     MOVELTBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELTBHONA    PAHONA    P      Ship To Address
     C                     MOVELTBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELTBHNNA    PAHNNA    P      Ship To City
     C                     MOVELTBDBCD    PADBCD    P      Ship To State C
     C                     MOVELTBCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDTBB0C7    PAB0C7           Bill to Custome
     C                     MOVELTBAETX    PAAETX    P      Bill to Name
     C                     MOVELTBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELTBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELTBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELTBB2NA    PAB2NA    P      Bill to City
     C                     MOVELTBBHCD    PABHCD    P      Bill to State C
     C                     MOVELTBC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELTBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDTBA0DT    PAA0DT           Order Date
     C                     Z-ADDTBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDTBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDTBACDT    PAACDT           Cancel Date
     C                     MOVELTBAQCD    PAAQCD    P      Terms Code
     C                     MOVELTBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELTBBYNA    PABYNA    P      Special Instruc
     C                     MOVELTBBZNA    PABZNA    P      Carrier Code
     C                     MOVELTBGTST    PAGTST    P      Comment Print A
     C                     MOVELTBGVST    PAGVST    P      Comment Print I
     C                     MOVELTBGUST    PAGUST    P      Comment Print P
     C                     MOVELTBQFST    PAQFST    P      Comment Print S
     C                     MOVELTBCQCD    PACQCD    P      Reason Code
     C                     MOVELTBGJST    PAGJST    P      Order in Use
     C                     MOVELTBGWST    PAGWST    P      Header Status
     C                     MOVELTBGXST    PAGXST    P      Header Status L
     C                     MOVELTBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDTBAODT    PAAODT           Scheduled Ship
     C                     MOVELTBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDTBCXDT    PACXDT           Date of Origina
     C                     Z-ADDTBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDTBA1WG    PAA1WG           Order Weight To
     C                     MOVELTBXIST    PAXIST    P      Credit Hold
     C                     MOVELTBXJST    PAXJST    P      Production Hold
     C                     MOVELTBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDTBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDTBAFTM    PAAFTM           Requested Deliv
     C                     MOVELTBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELTBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDTBRMNB    PARMNB           Load ID
     C                     Z-ADDTBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDTBR1NB    PAR1NB           Rated Freight
     C                     MOVELTBPJST    PAPJST    P      LTL Flag
     C                     MOVELTBU0ST    PAU0ST    P      Price Audit
     C                     MOVELTBU1ST    PAU1ST    P      Price Status
     C                     MOVELTBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELTBU2ST    PAU2ST    P      Export Status
     C                     MOVELTBVEST    PAVEST    P      Palletize
     C                     MOVELTBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELTBVGST    PAVGST    P      Slip Sheet
     C                     MOVELTBRPCD    PARPCD    P      Age Code
     C                     Z-ADDTBRNNB    PARNNB           Reefer Temperat
     C                     MOVELTBVDST    PAVDST    P      Load Type
     C                     Z-ADDTBATIN    PAATIN           Attach to Invoi
     C                     MOVELTBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELTBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDTBRSRN    PARSRN           Resell Referenc
     C                     MOVELTBMHNA    PAMHNA    P      Special Comment
     C                     MOVELTBMINA    PAMINA    P      Special Comment
     C                     MOVELTBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELTBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELTBBFCD    PABFCD    P      Manager Level C
     C                     MOVELTBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDTBT3NB    PAT3NB           Attach to Order
     C                     MOVELTBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDTBCONB    PACONB           Invoice Number
     C                     MOVELTBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDTBAWDT    PAAWDT           Invoice Date
     C                     MOVELTBJPCD    PAJPCD    P      Event Code
     C                     MOVELTBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELTBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDTBVRVA    PAVRVA           A/R order Value
     C                     MOVELTBOBST    PAOBST    P      Billing Activit
     C                     MOVELTBBCST    PABCST    P      Block Order Fla
     C                     MOVELTBBDST    PABDST    P      Order Certifica
     C                     Z-ADDTBB7VL    PAB7VL           Invoice Order V
     C                     MOVELTBGASX    PAGASX    P      Process Sts for
     C                     MOVELTBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELTBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELTBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELTBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELTBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELTBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELTBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELTBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELTBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELTBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELTBFUSX    PAFUSX    P      Order Requires
     C                     MOVELTBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELTBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELTBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELTBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDTBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDTBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDTBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDTBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDTBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDTBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDTBBQTM    PABQTM           Time of Origina
     C                     Z-ADDTBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDTBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDTBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDTBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDTBH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDTBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDTBH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDTBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDTBC0C7    PAC0C7           Claim Number
     C                     MOVELTBUVST    PAUVST    P      EDI Status 1
     C                     MOVELTBUWST    PAUWST    P      EDI Status 2
     C                     MOVELTBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDTBAATM    PAAATM           Job Time
     C                     MOVELTBAYNA    PAAYNA    P      User Id
     C                     MOVELTBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDTBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Load Sts/ActShp   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0507  30       Company Number
     C                     Z-ADD*ZERO     WN0508  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0509  1        LTL Flag
     C                     Z-ADD*ZERO     WN0510  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0511 15        Seal 1
     C                     MOVEL*BLANK    WN0512 15        Seal 2
     C                     MOVEL*BLANK    WN0513 15        Seal 3
     C                     MOVEL*BLANK    WN0514 15        Seal 4
     C                     MOVEL*BLANK    WN0515 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0516  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0517 112       Flat Amount
     C                     MOVEL*BLANK    WN0518  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0519  50       Total Stops
     C                     MOVEL*BLANK    WN0520 20        Trailer Id
     C                     MOVEL*BLANK    WN0521  3        Transloader Car
     C                     Z-ADD*ZERO     WN0522  40       BOL Time
     C                     MOVEL*BLANK    WN0523  3        Carrier Code
     C                     MOVEL*BLANK    WN0524  7        Truck Size
     C                     Z-ADD*ZERO     WN0525  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0526 112       Rated Freight
     C                     MOVEL*BLANK    WN0527  1        Ship Status
     C                     MOVEL*BLANK    WN0528  1        Load Type
     C                     Z-ADD*ZERO     WN0529  50       Number Pallets
     C                     Z-ADD*ZERO     WN0530  50       Number Pallets
     C                     Z-ADD*ZERO     WN0531 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0532  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0533  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0534  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0535 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0536 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0537  70       Actual Departur
     C                     Z-ADD*ZERO     WN0538  40       Departure Time
     C                     Z-ADD*ZERO     WN0539  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0540  52       Product Tempera
     C                     Z-ADD*ZERO     WN0541  50       Number Spacers
     C                     MOVEL*BLANK    WN0542 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0543  70       Total Load Mile
     C                     MOVEL*BLANK    WN0544 12        Recorder ID
     C                     MOVEL*BLANK    WN0545  2        Shipping Method
     C                     MOVEL*BLANK    WN0546  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0547  2        Ship To State C
     C                     Z-ADD*ZERO     WN0548  70       Gross Weight
     C                     MOVEL*BLANK    WN0549  3        Carrier Broker
     C                     MOVEL*BLANK    WN0550  1        Export Status
     C                     MOVEL*BLANK    WN0551  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0552  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0553  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0554  70       Spotted Date
     C                     Z-ADD*ZERO     WN0555  60       Spotted Time
     C                     Z-ADD*ZERO     WN0556  70       Load Finished D
     C                     Z-ADD*ZERO     WN0557  60       Load Finished T
     C                     Z-ADD*ZERO     WN0558  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0559  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0560  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0561  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0562  70       Truck Departure
     C                     Z-ADD*ZERO     WN0563  60       Truck Departure
     C                     Z-ADD*ZERO     WN0564  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0565  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0566  3        Shipping Line
     C                     MOVEL*BLANK    WN0567 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0568 30        Vessel Name
     C                     Z-ADD*ZERO     WN0569  50       Voyage
     C                     Z-ADD*ZERO     WN0570  70       Sail Date
     C                     MOVEL*BLANK    WN0571 12        Booking Number
     C                     MOVEL*BLANK    WN0572 20        Discharge Port
     C                     Z-ADD*ZERO     WN0573  70       Arrival Date
     C                     MOVEL*BLANK    WN0574 12        Container Numbe
     C                     Z-ADD*ZERO     WN0575  70       Date In
     C                     Z-ADD*ZERO     WN0576  60       Time In
     C                     Z-ADD*ZERO     WN0577  70       Date Out
     C                     Z-ADD*ZERO     WN0578  60       Time Out
     C                     Z-ADD*ZERO     WN0579 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0580  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0581  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0582  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0583  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0584  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0585  70       Requested Deliv
     C                     MOVEL*BLANK    WN0586  1        Load Acceptance
     C                     MOVEL*BLANK    WN0587  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0588  70       On Yard Date
     C                     Z-ADD*ZERO     WN0589  60       On Yard Time
     C                     Z-ADD*ZERO     WN0590  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0591  60       Deadline Depart
     C                     MOVEL*BLANK    WN0592  1        Load Held Over
     C                     MOVEL*BLANK    WN0593  1        Load Held Over
     C                     MOVEL*BLANK    WN0594 15        Load Held Over
     C                     MOVEL*BLANK    WN0595 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0596 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0597  70       Express Mail Da
     C                     MOVEL*BLANK    WN0598  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0599  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0600  70       Product Complet
     C                     Z-ADD*ZERO     WN0601  60       Product Complet
     C                     Z-ADD*ZERO     WN0602  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0603  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0604  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0605  1        Load Confirmed
     C                     MOVEL*BLANK    WN0606 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0607  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0608  60       Load Door 1
     C                     Z-ADD*ZERO     WN0609  70       Override Total
     C                     Z-ADD*ZERO     WN0610  60       Load Door 2
     C                     MOVEL*BLANK    WN0611  1        Partial Load
     C                     MOVEL*BLANK    WN0612  1        Load Confirmati
     C                     MOVEL*BLANK    WN0613  1        Export Load USD
     C                     MOVEL*BLANK    WN0614  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0615 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0616 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0617 15        Late Billing Em
     C                     MOVEL*BLANK    WN0618 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0619 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0620  1        Multi Company L
     C                     MOVEL*BLANK    WN0621  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0622  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0623  1        LH Power Only L
     C                     MOVEL*BLANK    WN0624  1        MG Created Load
     C                     MOVEL*BLANK    WN0625  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0626  2        Load U_M
     C                     MOVEL*BLANK    WN0627  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0628  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0629  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0630  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0631  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0632  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0633  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0634  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0635  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0636  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0637  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0638  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0639  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0640  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0641  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0642  60       LH Unused Time
     C                     MOVEL*BLANK    WN0643  1        EDI Status 1
     C                     MOVEL*BLANK    WN0644  1        EDI Status 2
     C                     MOVEL*BLANK    WN0645  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0646  60       Job Time
     C                     MOVEL*BLANK    WN0647 10        User Id
     C                     MOVEL*BLANK    WN0648 10        Job Name
     C                     Z-ADD*ZERO     WN0649  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP2RMNB    WYRMNB           Load ID
      *
     C           KLCHTC    KLIST
     C                     KFLD           WYRMNB           Load ID
     C           KLCHTC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'L'       WYPKST    P      Load Status
     C                     Z-ADD*ZERO     WYF9DT           Actual Ship Dat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WYAATM           Job Time
     C                     MOVEL##USR     WYAYNA           User Id
     C                     MOVEL##JOB     WYA0NA           Job Name
     C                     Z-ADD##JDT     WYAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTD01           Company Number
     C           *LIKE     DEFN TCC4NB    WQTD02           Order Number
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQTD01           Company Number
     C                     Z-ADDP2C4NB    WQTD02           Order Number
      * Establish starting position
     C           KRSTD     SETLL@MSREX2                    *
     C           KRSTD     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR TEDLRC
     C           KRSTD     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TEDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDTCAIC3    TDAIC3           Company Number
     C                     Z-ADDTCC4NB    TDC4NB           Order Number
     C                     MOVELTCDGSX    TDDGSX           ED Export Docum
     C                     MOVELTCKXCD    TDKXCD           Country Code
     C                     Z-ADDTCDPNB    TDDPNB           Order Sequence
     C                     Z-ADDTCUENB    TDUENB           Order Secondary
      *
     C           KLDLTE    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDC4NB           Order Number
     C                     KFLD           TDDGSX           ED Export Docum
     C                     KFLD           TDKXCD           Country Code
     C                     KFLD           TDDPNB           Order Sequence
     C                     KFLD           TDUENB           Order Secondary
     C           KLDLTE    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * UPD Err Transactions   RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTF01           Company Number
     C           *LIKE     DEFN TEC4NB    WQTF02           Order Number
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQTF01           Company Number
     C                     Z-ADDP2C4NB    WQTF02           Order Number
      * Establish starting position
     C           KRSTF     SETLL@B7CPJD                    *
     C           KRSTF     READE@B7CPJD                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Reason Code        CH - Item Transaction Detail  * 
     C                     EXSR TGCHRC
     C           KRSTF     READE@B7CPJD                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG Reason Code        CH - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0650  70       Production Date
     C                     MOVEL*BLANK    WN0651  2        UOM Transaction
     C                     MOVEL*BLANK    WN0652  2        Item Transactio
     C                     MOVEL*BLANK    WN0653 30        Description
     C                     Z-ADD*ZERO     WN0654 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0655 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0656 114       USR Transaction
     C                     MOVEL*BLANK    WN0657  2        UOM Cost
     C                     Z-ADD*ZERO     WN0658 112       Extended Amount
     C                     MOVEL*BLANK    WN0659  6        Ticket Number
     C                     Z-ADD*ZERO     WN0660  80       GL Document Num
     C                     MOVEL*BLANK    WN0661  1        GL Update Statu
     C                     MOVEL*BLANK    WN0662 15        Reference Numbe
     C                     MOVEL*BLANK    WN0663 10        Lot ID
     C                     Z-ADD*ZERO     WN0664  70       Transfer Batch
     C                     Z-ADD*ZERO     WN0665  30       Transfer Batch
     C                     Z-ADD*ZERO     WN0666  70       Order Number
     C                     Z-ADD*ZERO     WN0667  30       Item Structure
     C                     Z-ADD*ZERO     WN0668  30       Item Structure
     C                     Z-ADD*ZERO     WN0669  30       Item Structure
     C                     MOVEL*BLANK    WN0670 10        Employee Badge
     C                     Z-ADD*ZERO     WN0671  60       Production Time
     C                     MOVEL*BLANK    WN0672  1        Shift Number
     C                     Z-ADD*ZERO     WN0673  70       Label Date
     C                     MOVEL*BLANK    WN0674  1        EDI Status 1
     C                     MOVEL*BLANK    WN0675  1        EDI Status 2
     C                     MOVEL*BLANK    WN0676  1        EDI Status 3
     C                     MOVEL*BLANK    WN0677  1        Record Status
     C                     Z-ADD*ZERO     WN0678  60       Job Time
     C                     MOVEL*BLANK    WN0679 10        User Id
     C                     MOVEL*BLANK    WN0680 10        Job Name
     C                     Z-ADD*ZERO     WN0681  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @B7CPJZ
     C                     Z-ADDTEAIC3    TFAIC3           Company Number
     C                     Z-ADDTEHGCD    TFHGCD           Item Code
     C                     MOVELTEAJCD    TFAJCD    P      Warehouse Code
     C                     MOVELTEW9ST    TFW9ST    P      Inventory Trans
     C                     MOVELTEBSST    TFBSST    P      Inventory Trans
     C                     Z-ADDTEB4DT    TFB4DT           Transaction Dat
     C                     Z-ADDTEC4NY    TFC4NY           ITD Sequence Nu
     C                     Z-ADDTEDXNB    TFDXNB           Sequence Number
      *
     C           KLCHTG    KLIST
     C                     KFLD           TFAIC3           Company Number
     C                     KFLD           TFHGCD           Item Code
     C                     KFLD           TFAJCD           Warehouse Code
     C                     KFLD           TFW9ST           Inventory Trans
     C                     KFLD           TFBSST           Inventory Trans
     C                     KFLD           TFB4DT           Transaction Dat
     C                     KFLD           TFC4NY           ITD Sequence Nu
     C                     KFLD           TFDXNB           Sequence Number
     C           KLCHTG    CHAIN@B7CPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB7CPL0'MDACP
     C                     MOVEL'@B7CPJZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB71    YGRDCS
      * Move non-key fields to @B7CPJZ
     C                     MOVEL*BLANK    TFCQCD    P      Reason Code
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * 01/29/02 PKD Do not change the Record Stamp per Tom Dye. This
      *              causes inaccurate reporting on the Item Transaction
      *              Journal.
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@B7CPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TGY1NX    WQTH01           PFS Company Num
     C           *LIKE     DEFN TGZPNX    WQTH02           PFS Order Numbe
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH01           PFS Company Num
     C                     KFLD           WQTH02           PFS Order Numbe
     C                     KFLD           TGAID8           PFS Transaction
     C                     KFLD           TGAFTS           PFS Transaction
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           PFS Company Num
     C                     KFLD           WQTH02           PFS Order Numbe
      * Setup key
     C                     Z-ADDP1Y1NX    WQTH01           PFS Company Num
     C                     Z-ADDP1ZPNX    WQTH02           PFS Order Numbe
     C                     Z-ADDP1AID8    TGAID8           PFS Transaction
     C                     Z-ADDP1AFTS    TGAFTS           PFS Transaction
      * Establish starting position
     C           KPSTH     SETLL@BMCPE9                    *
     C           KRSTH     READE@BMCPE9                  90*
      * Data record not found
     C   90                MOVEL'USR3508' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TGAID8    IFEQ P1AID8                     *IF
     C           TGAFTS    IFEQ P1AFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
     C                     EXSR TICHRC
     C                     END                             *FI
     C           KRSTH     READE@BMCPE9                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0682  70       PFS Item Code
     C                     Z-ADD*ZERO     WN0683  80       PFS Actual Ship
     C                     Z-ADD*ZERO     WN0684  50       PFS Shipped Qua
     C                     Z-ADD*ZERO     WN0685  82       PFS Shipped Wei
     C                     MOVEL*BLANK    WN0686  2        PFS Short/Over
     C                     MOVEL*BLANK    WN0687  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0688  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0689  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0690  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0691  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BMCPYU
     C                     Z-ADDTGY1NX    THY1NX           PFS Company Num
     C                     Z-ADDTGAID8    THAID8           PFS Transaction
     C                     Z-ADDTGAFTS    THAFTS           PFS Transaction
     C                     Z-ADDTGBCNY    THBCNY           PFS Transaction
      *
     C           KLCHTI    KLIST
     C                     KFLD           THY1NX           PFS Company Num
     C                     KFLD           THAID8           PFS Transaction
     C                     KFLD           THAFTS           PFS Transaction
     C                     KFLD           THBCNY           PFS Transaction
     C           KLCHTI    CHAIN@BMCPYU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBMCPL0'MDACP
     C                     MOVEL'@BMCPYU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBM1    YHRDCS
      * Move non-key fields to @BMCPYU
     C                     Z-ADDTGZPNX    THZPNX           PFS Order Numbe
     C                     Z-ADDTGZXNX    THZXNX           PFS Order Line
     C                     Z-ADDTGZYNX    THZYNX           PFS Substitutio
     C                     Z-ADD3         THUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   THV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBM1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BMCPYU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBMCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TIY1NX    WQTJ01           PFS Company Num
     C           *LIKE     DEFN TIZGNX    WQTJ02           PFS Load ID
      * Define keylist
     C           KPSTJ     KLIST
     C                     KFLD           WQTJ01           PFS Company Num
     C                     KFLD           WQTJ02           PFS Load ID
     C                     KFLD           TIAID8           PFS Transaction
     C                     KFLD           TIAFTS           PFS Transaction
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           PFS Company Num
     C                     KFLD           WQTJ02           PFS Load ID
      * Setup key
     C                     Z-ADDP1Y1NX    WQTJ01           PFS Company Num
     C                     Z-ADDP1ZGNX    WQTJ02           PFS Load ID
     C                     Z-ADDP1AID8    TIAID8           PFS Transaction
     C                     Z-ADDP1AFTS    TIAFTS           PFS Transaction
      * Establish starting position
     C           KPSTJ     SETLL@BKCPFD                    *
     C           KRSTJ     READE@BKCPFD                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TIAID8    IFEQ P1AID8                     *IF
     C           TIAFTS    IFEQ P1AFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C           KRSTJ     READE@BKCPFD                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0692  2        PFS Ship Status
     C                     Z-ADD*ZERO     WN0693  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0694  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0695  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0696  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0697  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0698  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0699  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0700  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDTIY1NX    TJY1NX           PFS Company Num
     C                     Z-ADDTIAID8    TJAID8           PFS Transaction
     C                     Z-ADDTIAFTS    TJAFTS           PFS Transaction
     C                     Z-ADDTIBCNY    TJBCNY           PFS Transaction
      *
     C           KLCHTK    KLIST
     C                     KFLD           TJY1NX           PFS Company Num
     C                     KFLD           TJAID8           PFS Transaction
     C                     KFLD           TJAFTS           PFS Transaction
     C                     KFLD           TJBCNY           PFS Transaction
     C           KLCHTK    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YIRDCS
      * Move non-key fields to @BKCPZU
     C                     Z-ADD3         TJUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   TJV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     Z-ADD*ZERO     P2C4NB           Order Number
     C                     Z-ADD*ZERO     P2RMNB           Load ID
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAQ2NB           Event Number
     C                     Z-ADD*ZERO     WAAUC3           Invoice_Memo Co
     C                     Z-ADD*ZERO     WAQ7NB           Invoice_Memo Nu
     C                     Z-ADD*ZERO     WAD2DT           Event Date
     C                     Z-ADD*ZERO     WAAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WAQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WAQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WER5NB           Deliver after t
     C                     Z-ADD*ZERO     WER6NB           Deliver before
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WEW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WFBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WFBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WFBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WGFOQT           Case Quantity
     C                     Z-ADD*ZERO     WGR0NB           Case Weight
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WGH5NY           Manifest Total
     C                     Z-ADD*ZERO     WGH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WGH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WGN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WGN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WGRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WGITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WGIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WGIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WGIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WGIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WGIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WHAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WHAIWG           Unit Weight
     C                     Z-ADD*ZERO     WHCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WHC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WHURTN           Number Cases On
     C                     Z-ADD*ZERO     WHAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHTFNB           Transportation
     C                     Z-ADD*ZERO     WHTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WHTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WHBLPR           Market Overage
     C                     Z-ADD*ZERO     WHBMPR           Standard Overag
     C                     Z-ADD*ZERO     WHCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WHCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WHSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WHPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WHICN1           Item Category N
     C                     Z-ADD*ZERO     WHICN2           Item Category N
     C                     Z-ADD*ZERO     WHV2NB           Item Category N
     C                     Z-ADD*ZERO     WHITCN           Item Category N
     C                     Z-ADD*ZERO     WHITC5           Item Category N
     C                     Z-ADD*ZERO     WHICN6           Item Category N
     C                     Z-ADD*ZERO     WHICN7           Item Category N
     C                     Z-ADD*ZERO     WHICN8           Item Category N
     C                     Z-ADD*ZERO     WHICN9           Item Category N
     C                     Z-ADD*ZERO     WHICN0           Item Category N
     C                     Z-ADD*ZERO     WHSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WHA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WHSJNB           Production Lead
     C                     Z-ADD*ZERO     WHSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WHSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WHSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WHCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WHCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WHILNB           Packages per ca
     C                     Z-ADD*ZERO     WHCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WHCINB           PM Batch Size
     C                     Z-ADD*ZERO     WHCJNB           Package Level s
     C                     Z-ADD*ZERO     WHCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WHCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WHCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WHCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WHCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WHCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WHCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WHCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WHC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WHB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WHB5NB           PM Line Number
     C                     Z-ADD*ZERO     WHBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WHBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WHF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WHF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WHF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WHBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WHBNNB           Production Qty
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Order Number Alpha
     C                     MOVEL*BLANK    WUE7TX  7
      * Define work field Description 14A      USR
     C                     MOVEL*BLANK    WUI6TX 14
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIELDT           Production Date
     C                     Z-ADD*ZERO     WIABWG           Physical Count
     C                     Z-ADD*ZERO     WIAGQT           Physical Count
     C                     Z-ADD*ZERO     WIAHQT           Physical Count
     C                     Z-ADD*ZERO     WIAIQT           Physical Count
     C                     Z-ADD*ZERO     WIACWG           Quantity on Han
     C                     Z-ADD*ZERO     WIARQT           Quantity on Han
     C                     Z-ADD*ZERO     WIASQT           Quantity on Han
     C                     Z-ADD*ZERO     WIATQT           Quantity on Han
     C                     Z-ADD*ZERO     WIHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WIHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WIBMWG           Physical Start
     C                     Z-ADD*ZERO     WIDSQT           Physical Start
     C                     Z-ADD*ZERO     WIDTQT           Physical Start
     C                     Z-ADD*ZERO     WIDUQT           Physical Start
     C                     Z-ADD*ZERO     WIDHDT           Physical Start
     C                     Z-ADD*ZERO     WIAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WIAECS           Last Cost
     C                     Z-ADD*ZERO     WIIDVA           Value of On Han
     C                     Z-ADD*ZERO     WIK7DT           Label Date
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKALSW           Allocation Seq
     C                     Z-ADD*ZERO     WKJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WKG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WKJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WKHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKELDT           Production Date
     C                     Z-ADD*ZERO     WKLXNM           Lot Number
     C                     Z-ADD*ZERO     WKYNCD           Location Level
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLLRDT           LLT Transaction
     C                     Z-ADD*ZERO     WLLLTS           LLT Sequence Nu
     C                     Z-ADD*ZERO     WLLSDT           LLT Production
     C                     Z-ADD*ZERO     WLJ5QT           LLT Transaction
     C                     Z-ADD*ZERO     WLG8WG           LLT Transaction
     C                     Z-ADD*ZERO     WLLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WLLLCL           LLT Location Le
     C                     Z-ADD*ZERO     WLLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WLLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOLXNM           Lot Number
     C                     Z-ADD*ZERO     WOYNCD           Location Level
     C                     Z-ADD*ZERO     WOJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WOG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WOJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WOG6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     WOJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WOG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WOLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WOLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WOLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WONBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRLCBY           Location Bay
     C                     Z-ADD*ZERO     WRLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field USR Order Value
     C                     Z-ADD*ZERO     WUJSVA 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXRMNB           Load ID
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WXRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WXRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WXFLAM           Flat Amount
     C                     Z-ADD*ZERO     WXRRNB           Total Stops
     C                     Z-ADD*ZERO     WXSBNB           BOL Time
     C                     Z-ADD*ZERO     WXSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WXR1NB           Rated Freight
     C                     Z-ADD*ZERO     WXSDNB           Number Pallets
     C                     Z-ADD*ZERO     WXPAOU           Number Pallets
     C                     Z-ADD*ZERO     WXDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WXSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WXHADT           Actual Arrival
     C                     Z-ADD*ZERO     WXAART           Actual Arrival
     C                     Z-ADD*ZERO     WXDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WXDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WXAQDT           Actual Departur
     C                     Z-ADD*ZERO     WXS6NB           Departure Time
     C                     Z-ADD*ZERO     WXT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WXPRTM           Product Tempera
     C                     Z-ADD*ZERO     WXNPSV           Number Spacers
     C                     Z-ADD*ZERO     WXTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WXGRWE           Gross Weight
     C                     Z-ADD*ZERO     WXF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WXJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WXTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WXJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WXSPTM           Spotted Time
     C                     Z-ADD*ZERO     WXJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WXLFTM           Load Finished T
     C                     Z-ADD*ZERO     WXJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WXBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WXJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WXBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WXKIDT           Truck Departure
     C                     Z-ADD*ZERO     WXASTM           Truck Departure
     C                     Z-ADD*ZERO     WXKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WXAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WXVOAG           Voyage
     C                     Z-ADD*ZERO     WXKBDT           Sail Date
     C                     Z-ADD*ZERO     WXEFDT           Arrival Date
     C                     Z-ADD*ZERO     WXKCDT           Date In
     C                     Z-ADD*ZERO     WXTMIN           Time In
     C                     Z-ADD*ZERO     WXKDDT           Date Out
     C                     Z-ADD*ZERO     WXVMNB           Time Out
     C                     Z-ADD*ZERO     WXOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WXKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WXATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WXBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WXEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WXKKDT           On Yard Date
     C                     Z-ADD*ZERO     WXAVTM           On Yard Time
     C                     Z-ADD*ZERO     WXKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WXAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WXLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WXK0DT           Product Complet
     C                     Z-ADD*ZERO     WXAYTM           Product Complet
     C                     Z-ADD*ZERO     WXKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WXICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WXIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WXK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WXAZTM           Load Door 1
     C                     Z-ADD*ZERO     WXK2DT           Override Total
     C                     Z-ADD*ZERO     WXA0TM           Load Door 2
     C                     Z-ADD*ZERO     WXZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WXPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WXCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WXPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WXCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WXP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WXCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WXP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WXCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WXP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WXCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WXP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WXCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAC4NB           Order Number
     C                     Z-ADD*ZERO     TAANC7           AR Customer Num
     C                     Z-ADD*ZERO     TABKC7           Ship To Custome
     C                     Z-ADD*ZERO     TAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     TAA0DT           Order Date
     C                     Z-ADD*ZERO     TAA5DT           Requested Ship
     C                     Z-ADD*ZERO     TAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     TAACDT           Cancel Date
     C                     Z-ADD*ZERO     TAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     TACXDT           Date of Origina
     C                     Z-ADD*ZERO     TAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     TAA1WG           Order Weight To
     C                     Z-ADD*ZERO     TAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     TAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     TARMNB           Load ID
     C                     Z-ADD*ZERO     TATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     TAR1NB           Rated Freight
     C                     Z-ADD*ZERO     TARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     TAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     TARSRN           Resell Referenc
     C                     Z-ADD*ZERO     TAT3NB           Attach to Order
     C                     Z-ADD*ZERO     TACONB           Invoice Number
     C                     Z-ADD*ZERO     TAAWDT           Invoice Date
     C                     Z-ADD*ZERO     TAVRVA           A/R order Value
     C                     Z-ADD*ZERO     TAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     TANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     TANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     TANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     TANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     TANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     TABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     TABQTM           Time of Origina
     C                     Z-ADD*ZERO     TABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     TABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     TABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     TAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     TAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     TAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     TAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     TAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     TAC0C7           Claim Number
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCC4NB           Order Number
     C                     Z-ADD*ZERO     TCDPNB           Order Sequence
     C                     Z-ADD*ZERO     TCUENB           Order Secondary
     C                     Z-ADD*ZERO     TCDIC7           ED Item Code
     C                     Z-ADD*ZERO     TCHJWG           ED Product Net
     C                     Z-ADD*ZERO     TCHKWG           ED Product Net
     C                     Z-ADD*ZERO     TCAONX           ED Product Nbr
     C                     Z-ADD*ZERO     TCAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     TCANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     TCAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     TCDKPR           ED Product Unit
     C                     Z-ADD*ZERO     TCA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     TCAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     TCW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAIC3           Company Number
     C                     Z-ADD*ZERO     TEHGCD           Item Code
     C                     Z-ADD*ZERO     TEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     TEC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     TEDXNB           Sequence Number
     C                     Z-ADD*ZERO     TEELDT           Production Date
     C                     Z-ADD*ZERO     TEA5QT           Transaction Qua
     C                     Z-ADD*ZERO     TEAHWG           Transaction Wei
     C                     Z-ADD*ZERO     TEAKCS           USR Transaction
     C                     Z-ADD*ZERO     TEAYVA           Extended Amount
     C                     Z-ADD*ZERO     TECKNB           GL Document Num
     C                     Z-ADD*ZERO     TETRBN           Transfer Batch
     C                     Z-ADD*ZERO     TETRBS           Transfer Batch
     C                     Z-ADD*ZERO     TEC4NB           Order Number
     C                     Z-ADD*ZERO     TERINB           Item Structure
     C                     Z-ADD*ZERO     TERHNB           Item Structure
     C                     Z-ADD*ZERO     TERGNB           Item Structure
     C                     Z-ADD*ZERO     TEAWTM           Production Time
     C                     Z-ADD*ZERO     TEK7DT           Label Date
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TGY1NX           PFS Company Num
     C                     Z-ADD*ZERO     TGAID8           PFS Transaction
     C                     Z-ADD*ZERO     TGAFTS           PFS Transaction
     C                     Z-ADD*ZERO     TGBCNY           PFS Transaction
     C                     Z-ADD*ZERO     TGZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     TGZXNX           PFS Order Line
     C                     Z-ADD*ZERO     TGZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     TGY2NX           PFS Item Code
     C                     Z-ADD*ZERO     TGAFD8           PFS Actual Ship
     C                     Z-ADD*ZERO     TGAUNY           PFS Shipped Qua
     C                     Z-ADD*ZERO     TGAVNY           PFS Shipped Wei
     C                     Z-ADD*ZERO     TGUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     TGAHNY           PFS Create Date
     C                     Z-ADD*ZERO     TGAINY           PFS Create Time
     C                     Z-ADD*ZERO     TGAJNY           PFS Change Date
     C                     Z-ADD*ZERO     TGAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TIY1NX           PFS Company Num
     C                     Z-ADD*ZERO     TIAID8           PFS Transaction
     C                     Z-ADD*ZERO     TIAFTS           PFS Transaction
     C                     Z-ADD*ZERO     TIBCNY           PFS Transaction
     C                     Z-ADD*ZERO     TIZGNX           PFS Load ID
     C                     Z-ADD*ZERO     TIZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     TIUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     TIAHNY           PFS Create Date
     C                     Z-ADD*ZERO     TIAINY           PFS Create Time
     C                     Z-ADD*ZERO     TIAJNY           PFS Change Date
     C                     Z-ADD*ZERO     TIAKNY           PFS Change time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
      * Define local variables for subroutine SNCRRC.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  2
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  50
     C                     MOVEL*BLANK    WL0017  4
     C                     Z-ADD*ZERO     WL0018  20
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020  50
     C                     MOVEL*BLANK    WL0021  4
     C                     Z-ADD*ZERO     WL0022  20
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  60
     C                     MOVEL*BLANK    WL0032 10
     C                     MOVEL*BLANK    WL0033 10
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  50
     C                     MOVEL*BLANK    WL0040  4
     C                     Z-ADD*ZERO     WL0041  20
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043 112
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0044  3
     C                     MOVEL*BLANK    WL0045  4
     C                     MOVEL*BLANK    WL0046  1
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048  52
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0049  30
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051 112
     C                     MOVEL*BLANK    WL0052  2
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  50
     C                     MOVEL*BLANK    WL0058  4
     C                     Z-ADD*ZERO     WL0059  20
     C                     Z-ADD*ZERO     WL0060  50
     C                     Z-ADD*ZERO     WL0061 112
     C                     Z-ADD*ZERO     WL0062  50
     C                     Z-ADD*ZERO     WL0063 112
     C                     Z-ADD*ZERO     WL0064  50
     C                     Z-ADD*ZERO     WL0065 112
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  72
     C                     MOVEL*BLANK    WL0070  6
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072  1
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074  2
     C                     MOVEL*BLANK    WL0075  3
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  60
     C                     MOVEL*BLANK    WL0081 10
     C                     MOVEL*BLANK    WL0082 10
     C                     Z-ADD*ZERO     WL0083  70
      * Define local variables for subroutine SUDLRC.
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  70
     C                     MOVEL*BLANK    WL0086  3
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  50
     C                     MOVEL*BLANK    WL0089  4
     C                     Z-ADD*ZERO     WL0090  20
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0091  30
     C                     Z-ADD*ZERO     WL0092  70
     C                     MOVEL*BLANK    WL0093  3
     C                     Z-ADD*ZERO     WL0094  70
      * Define local variables for subroutine SXCHRC.
     C                     Z-ADD*ZERO     WL0095  30
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  30
     C                     Z-ADD*ZERO     WL0098  30
     C                     Z-ADD*ZERO     WL0099  50
     C                     MOVEL*BLANK    WL0100  1
      * Define local work field Event Number
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Send Email f/Failed API U
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0009 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0010 155
      * Define local work field API was Called? U
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field First Time Through USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0017  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Unship Order
00002 Y2U0005
00003 UNSHIP
