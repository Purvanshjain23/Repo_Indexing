     H/TITLE Pmt Crt New Batch Whse PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/31/22  Time  : 09:22:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPMQKPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Crt New Batch Whse PV Prompt & validate record
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FPMCCCPL3IF  E           K        DISK
      * RSQ : COA Batch Header          Comp, Whse, Batch Hdr St
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FPNGCREL1IF  E           K        DISK
      * RTV : RFS Fuel Code - D Code    Retrieval index
      *
     FPNGDREL1IF  E           K        DISK
      * RTV : RFS Process Code          Retrieval index
      *
     FPNGEREL1IF  E           K        DISK
      * RTV : RFS Fuel Category Code    Retrieval index
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FPMCCCPL1IF  E           K        DISK
      * RTV : COA Batch Header          Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     E                    #L3         3  1
      * DETAIL Screen: Field position and name array
     E                    W0BEG   6 006  5 0A
     E                    W0END   6 006  5 0A
     E                    W0NAM   6 006 10
      * Long constants
     E                    @CN#    1  02  6   @CN    25
      * Set wdw location allowed?
     E                    YSL         1  1
     I@CAREOB
      * COA Property Define Hdr   Retrieval index
      * Renamed input format fields
     I              CAAIC3                          WAAIC3
     I              CAIDAA                          WAIDAA
     I              CAR2NA                          WAR2NA
     I              CAL2T1                          WAL2T1
     I              CAL3T1                          WAL3T1
     I              CAL4T1                          WAL4T1
     I              CAL5T1                          WAL5T1
     I              CAL6T1                          WAL6T1
     I              CAL7T1                          WAL7T1
     I              CAL8T1                          WAL8T1
     I              CAL9T1                          WAL9T1
     I              CAMAT1                          WAMAT1
     I              CAJCNY                          WAJCNY
     I              CAJDNY                          WAJDNY
     I              CAJENY                          WAJENY
     I              CAJFNY                          WAJFNY
     I              CAGMPC                          WAGMPC
     I              CAMBT1                          WAMBT1
     I              CAIEAA                          WAIEAA
     I              CAIFAA                          WAIFAA
     I              CAIGAA                          WAIGAA
     I              CAIHAA                          WAIHAA
     I              CAIIAA                          WAIIAA
     I              CAIJAA                          WAIJAA
     I              CAJQNY                          WAJQNY
     I              CALXST                          WALXST
     I              CAJRNY                          WAJRNY
     I              CALYST                          WALYST
     I              CAIMTX                          WAIMTX
     I              CAFEDS                          WAFEDS
     I              CAIBAA                          WAIBAA
     I              CAI1NY                          WAI1NY
     I              CAHCTU                          WAHCTU
     I              CAMCT1                          WAMCT1
     I              CAVSST                          WAVSST
     I              CAMJDT                          WAMJDT
     I              CABETM                          WABETM
     I              CACCVN                          WACCVN
     I              CACDVN                          WACDVN
     I              CAMKDT                          WAMKDT
     I              CABFTM                          WABFTM
     I              CACEVN                          WACEVN
     I              CACFVN                          WACFVN
      *
     I@CCCPPD
      * COA Batch Header          Comp, Whse, Batch Hdr St
      * Renamed input format fields
     I              CCAIC3                          WBAIC3
     I              CCL6T1                          WBL6T1
     I              CCI3NY                          WBI3NY
     I              CCIKAA                          WBIKAA
     I              CCIDAA                          WBIDAA
     I              CCRFDT                          WBRFDT
     I              CCC2TM                          WBC2TM
     I              CCMHT1                          WBMHT1
     I              CCRGDT                          WBRGDT
     I              CCC3TM                          WBC3TM
     I              CCMKT1                          WBMKT1
     I              CCJHNY                          WBJHNY
     I              CCR1NA                          WBR1NA
     I              CCRHDT                          WBRHDT
     I              CCC4TM                          WBC4TM
     I              CCMIT1                          WBMIT1
     I              CCMJT1                          WBMJT1
     I              CCHXTX                          WBHXTX
     I              CCHJTX                          WBHJTX
     I              CCHYTX                          WBHYTX
     I              CCJENY                          WBJENY
     I              CCJVNY                          WBJVNY
     I              CCJWNY                          WBJWNY
     I              CCIMTX                          WBIMTX
     I              CCFEDS                          WBFEDS
     I              CCMTT1                          WBMTT1
     I              CCJXNY                          WBJXNY
     I              CCJ1NY                          WBJ1NY
     I              CCJCNY                          WBJCNY
     I              CCJDNY                          WBJDNY
     I              CCJ3NY                          WBJ3NY
     I              CCRLDT                          WBRLDT
     I              CCMSAA                          WBMSAA
     I              CCMTAA                          WBMTAA
     I              CCMUAA                          WBMUAA
     I              CCL8T1                          WBL8T1
     I              CCR0NY                          WBR0NY
     I              CCL7T1                          WBL7T1
     I              CCJQST                          WBJQST
     I              CCWUT1                          WBWUT1
     I              CCWVT1                          WBWVT1
     I              CCJZST                          WBJZST
     I              CCJ0ST                          WBJ0ST
     I              CCTTDT                          WBTTDT
     I              CCDRTM                          WBDRTM
     I              CCWYT1                          WBWYT1
     I              CCJUST                          WBJUST
     I              CCR4NY                          WBR4NY
     I              CCMZAA                          WBMZAA
     I              CCTUDT                          WBTUDT
     I              CCDSTM                          WBDSTM
     I              CCWZT1                          WBWZT1
     I              CCM0AA                          WBM0AA
     I              CCSANY                          WBSANY
     I              CCKJST                          WBKJST
     I              CCKKST                          WBKKST
     I              CCGZPC                          WBGZPC
     I              CCW2T1                          WBW2T1
     I              CCM1AA                          WBM1AA
     I              CCSBNY                          WBSBNY
     I              CCKLST                          WBKLST
     I              CCKPST                          WBKPST
     I              CCG0PC                          WBG0PC
     I              CCW3T1                          WBW3T1
     I              CCM2AA                          WBM2AA
     I              CCSCNY                          WBSCNY
     I              CCKQST                          WBKQST
     I              CCKRST                          WBKRST
     I              CCG1PC                          WBG1PC
     I              CCW4T1                          WBW4T1
     I              CCVSST                          WBVSST
     I              CCMJDT                          WBMJDT
     I              CCBETM                          WBBETM
     I              CCCCVN                          WBCCVN
     I              CCCDVN                          WBCDVN
     I              CCMKDT                          WBMKDT
     I              CCBFTM                          WBBFTM
     I              CCCEVN                          WBCEVN
     I              CCCFVN                          WBCFVN
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@GCREGQ
      * RFS Fuel Code - D Code    Retrieval index
      * Renamed input format fields
     I              GCMSAA                          WDMSAA
     I              GCWOT1                          WDWOT1
     I              GCJGST                          WDJGST
     I              GCVSST                          WDVSST
     I              GCMJDT                          WDMJDT
     I              GCBETM                          WDBETM
     I              GCCCVN                          WDCCVN
     I              GCCDVN                          WDCDVN
     I              GCMKDT                          WDMKDT
     I              GCBFTM                          WDBFTM
     I              GCCEVN                          WDCEVN
     I              GCCFVN                          WDCFVN
      *
     I@GDREGT
      * RFS Process Code          Retrieval index
      * Renamed input format fields
     I              GDMTAA                          WEMTAA
     I              GDWPT1                          WEWPT1
     I              GDJJST                          WEJJST
     I              GDVSST                          WEVSST
     I              GDMJDT                          WEMJDT
     I              GDBETM                          WEBETM
     I              GDCCVN                          WECCVN
     I              GDCDVN                          WECDVN
     I              GDMKDT                          WEMKDT
     I              GDBFTM                          WEBFTM
     I              GDCEVN                          WECEVN
     I              GDCFVN                          WECFVN
      *
     I@GEREGW
      * RFS Fuel Category Code    Retrieval index
      * Renamed input format fields
     I              GEMUAA                          WFMUAA
     I              GEWQT1                          WFWQT1
     I              GEJLST                          WFJLST
     I              GEVSST                          WFVSST
     I              GEMJDT                          WFMJDT
     I              GEBETM                          WFBETM
     I              GECCVN                          WFCCVN
     I              GECDVN                          WFCDVN
     I              GEMKDT                          WFMKDT
     I              GEBFTM                          WFBFTM
     I              GECEVN                          WFCEVN
     I              GECFVN                          WFCFVN
      *
     I@ASREGT
      * Company Control           Retrieval index       NV
      * Renamed input format fields
     I              ASAIC3                          WGAIC3
     I              ASAXNB                          WGAXNB
     I              ASNGNB                          WGNGNB
     I              ASBZNB                          WGBZNB
     I              ASC5NB                          WGC5NB
     I              ASC3NB                          WGC3NB
     I              ASCYNB                          WGCYNB
     I              ASIONB                          WGIONB
     I              ASI6NB                          WGI6NB
     I              ASDCNB                          WGDCNB
     I              ASC7NB                          WGC7NB
     I              ASC2NB                          WGC2NB
     I              ASC1NB                          WGC1NB
     I              ASL8NB                          WGL8NB
     I              ASBANB                          WGBANB
     I              ASCHST                          WGCHST
     I              ASCKST                          WGCKST
     I              ASCIST                          WGCIST
     I              ASCGST                          WGCGST
     I              ASAIPC                          WGAIPC
     I              ASASPC                          WGASPC
     I              ASA2VA                          WGA2VA
     I              ASC2ST                          WGC2ST
     I              ASD8ST                          WGD8ST
     I              ASD7ST                          WGD7ST
     I              ASA8NA                          WGA8NA
     I              ASA9NA                          WGA9NA
     I              ASBANA                          WGBANA
     I              ASBBNA                          WGBBNA
     I              ASEUST                          WGEUST
     I              ASAADY                          WGAADY
     I              ASABDY                          WGABDY
     I              ASACDY                          WGACDY
     I              ASADDY                          WGADDY
     I              ASAEDY                          WGAEDY
     I              ASAFDY                          WGAFDY
     I              ASAGDY                          WGAGDY
     I              ASAHDY                          WGAHDY
     I              ASAENB                          WGAENB
     I              ASALNB                          WGALNB
     I              ASEVNB                          WGEVNB
     I              ASRPOP                          WGRPOP
     I              ASDWNB                          WGDWNB
     I              ASR3NB                          WGR3NB
     I              ASPNST                          WGPNST
     I              ASR4NB                          WGR4NB
     I              ASPOST                          WGPOST
     I              ASSCNB                          WGSCNB
     I              ASVIST                          WGVIST
     I              ASVJST                          WGVJST
     I              ASBVVN                          WGBVVN
     I              ASUVST                          WGUVST
     I              ASUWST                          WGUWST
     I              ASUXST                          WGUXST
     I              ASVSST                          WGVSST
     I              ASAATM                          WGAATM
     I              ASAYNA                          WGAYNA
     I              ASA0NA                          WGA0NA
     I              ASAXDT                          WGAXDT
      *
     I@CCCPOH
      * COA Batch Header          Retrieval index
      * Renamed input format fields
     I              CCAIC3                          WHAIC3
     I              CCL6T1                          WHL6T1
     I              CCI3NY                          WHI3NY
     I              CCIKAA                          WHIKAA
     I              CCIDAA                          WHIDAA
     I              CCRFDT                          WHRFDT
     I              CCC2TM                          WHC2TM
     I              CCMHT1                          WHMHT1
     I              CCRGDT                          WHRGDT
     I              CCC3TM                          WHC3TM
     I              CCMKT1                          WHMKT1
     I              CCJHNY                          WHJHNY
     I              CCR1NA                          WHR1NA
     I              CCRHDT                          WHRHDT
     I              CCC4TM                          WHC4TM
     I              CCMIT1                          WHMIT1
     I              CCMJT1                          WHMJT1
     I              CCHXTX                          WHHXTX
     I              CCHJTX                          WHHJTX
     I              CCHYTX                          WHHYTX
     I              CCJENY                          WHJENY
     I              CCJVNY                          WHJVNY
     I              CCJWNY                          WHJWNY
     I              CCIMTX                          WHIMTX
     I              CCFEDS                          WHFEDS
     I              CCMTT1                          WHMTT1
     I              CCJXNY                          WHJXNY
     I              CCJ1NY                          WHJ1NY
     I              CCJCNY                          WHJCNY
     I              CCJDNY                          WHJDNY
     I              CCJ3NY                          WHJ3NY
     I              CCRLDT                          WHRLDT
     I              CCMSAA                          WHMSAA
     I              CCMTAA                          WHMTAA
     I              CCMUAA                          WHMUAA
     I              CCL8T1                          WHL8T1
     I              CCR0NY                          WHR0NY
     I              CCL7T1                          WHL7T1
     I              CCJQST                          WHJQST
     I              CCWUT1                          WHWUT1
     I              CCWVT1                          WHWVT1
     I              CCJZST                          WHJZST
     I              CCJ0ST                          WHJ0ST
     I              CCTTDT                          WHTTDT
     I              CCDRTM                          WHDRTM
     I              CCWYT1                          WHWYT1
     I              CCJUST                          WHJUST
     I              CCR4NY                          WHR4NY
     I              CCMZAA                          WHMZAA
     I              CCTUDT                          WHTUDT
     I              CCDSTM                          WHDSTM
     I              CCWZT1                          WHWZT1
     I              CCM0AA                          WHM0AA
     I              CCSANY                          WHSANY
     I              CCKJST                          WHKJST
     I              CCKKST                          WHKKST
     I              CCGZPC                          WHGZPC
     I              CCW2T1                          WHW2T1
     I              CCM1AA                          WHM1AA
     I              CCSBNY                          WHSBNY
     I              CCKLST                          WHKLST
     I              CCKPST                          WHKPST
     I              CCG0PC                          WHG0PC
     I              CCW3T1                          WHW3T1
     I              CCM2AA                          WHM2AA
     I              CCSCNY                          WHSCNY
     I              CCKQST                          WHKQST
     I              CCKRST                          WHKRST
     I              CCG1PC                          WHG1PC
     I              CCW4T1                          WHW4T1
     I              CCVSST                          WHVSST
     I              CCMJDT                          WHMJDT
     I              CCBETM                          WHBETM
     I              CCCCVN                          WHCCVN
     I              CCCDVN                          WHCDVN
     I              CCMKDT                          WHMKDT
     I              CCBFTM                          WHBFTM
     I              CCCEVN                          WHCEVN
     I              CCCFVN                          WHCFVN
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WIAIC3
     I              KMV8CD                          WIV8CD
     I              KMAUNA                          WIAUNA
     I              KMI5ST                          WII5ST
     I              KMBXTX                          WIBXTX
     I              KMM8NB                          WIM8NB
     I              KMUVST                          WIUVST
     I              KMUWST                          WIUWST
     I              KMUXST                          WIUXST
     I              KMVSST                          WIVSST
     I              KMAATM                          WIAATM
     I              KMAYNA                          WIAYNA
     I              KMA0NA                          WIA0NA
     I              KMAXDT                          WIAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WJAJVN
     I              DRAUNA                          WJAUNA
     I              DRB8NA                          WJB8NA
     I              DRAHVN                          WJAHVN
     I              DRI6ST                          WJI6ST
     I              DRI7ST                          WJI7ST
     I              DRXMST                          WJXMST
     I              DRXNST                          WJXNST
     I              DRI8ST                          WJI8ST
     I              DRNLNB                          WJNLNB
     I              DRMPNA                          WJMPNA
     I              DRBCCD                          WJBCCD
     I              DRAIC3                          WJAIC3
     I              DRDQCD                          WJDQCD
     I              DRDRCD                          WJDRCD
     I              DRAJCD                          WJAJCD
     I              DRBUVN                          WJBUVN
     I              DRUVST                          WJUVST
     I              DRUWST                          WJUWST
     I              DRUXST                          WJUXST
     I              DRAATM                          WJAATM
     I              DRAYNA                          WJAYNA
     I              DRA0NA                          WJA0NA
     I              DRAXDT                          WJAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WKAJVN
     I              DTDNCD                          WKDNCD
     I              DTAIC3                          WKAIC3
     I              DTDQCD                          WKDQCD
     I              DTDRCD                          WKDRCD
     I              DTAJCD                          WKAJCD
     I              DTJFST                          WKJFST
     I              DTUVST                          WKUVST
     I              DTUWST                          WKUWST
     I              DTUXST                          WKUXST
     I              DTAATM                          WKAATM
     I              DTAYNA                          WKAYNA
     I              DTA0NA                          WKA0NA
     I              DTAXDT                          WKAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WMAIC3
     I              ABADTX                          WMADTX
     I              ABACNA                          WMACNA
     I              ABADNA                          WMADNA
     I              ABAENA                          WMAENA
     I              ABAJNA                          WMAJNA
     I              ABBTTX                          WMBTTX
     I              ABBVTX                          WMBVTX
     I              ABBWTX                          WMBWTX
     I              ABA2NA                          WMA2NA
     I              ABABTX                          WMABTX
     I              ABBGCD                          WMBGCD
     I              ABKXCD                          WMKXCD
     I              ABUVST                          WMUVST
     I              ABUWST                          WMUWST
     I              ABUXST                          WMUXST
     I              ABVSST                          WMVSST
     I              ABAATM                          WMAATM
     I              ABAYNA                          WMAYNA
     I              ABA0NA                          WMA0NA
     I              ABAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: COA Batch Header
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP COA ULSD Company #
     I                                        3   6 P1L6T1
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  User Profile Name
     I                                       13  22 P2AJVN
      * N :  Allow Multi-Company
     I                                       23  23 P2I6ST
      * N :  Allow Multi Warehouse
     I                                       24  24 P2I8ST
      * N :  Default Printer
     I                                       25  34 P2MPNA
      * N :  First Time Flag
     I                                       35  35 P2TAST
      * N :  Name
     I                                       36  65 P2ADTX
      * N :  System Value Alpha
     I                                       66 105 P2BXTX
      * N :  Access Denied (Y/N)
     I                                      106 106 P2WVST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse entered is not'
      * COA Active Whse/Tank
     I                                        1   3 ZA0001
      * Message data for 'The Warehouse is already'
      * COA Batch Number
     I                                    P   1   30ZA0002
      * COA Active Whse/Tank
     I                                        4   6 ZA0003
      * Message data for 'The Warehouse is alread'
      * COA Batch Number
     I                                    P   1   30ZA0004
      * COA Active Whse/Tank
     I                                        4   6 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1L6T1    PARM           WP0002  4        COA ULSD Compan
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * EDT COA Batch Header   E1 - COA Batch Header  * 
     C                     CALL 'PMN7E1R'              90  EDT COA Batch H
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1L6T1    WQ0002  4        COA ULSD Compan
     C                     PARM #1I3NY    WQ0003  50       COA Batch Numbe
     C                     PARM #1IKAA    WQ0004  3        COA Active Whse
     C                     PARM #1IDAA    WQ0005  6        COA Bio-diesel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMN7E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Prompt on warehouse
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.COA Active Whse/Tank
     C           W0CFL     IFEQ '#1IKAA'                   *IF
      * different select
      * SEL AcctCo/Whse w/prd  SR - Warehouse Codes  * 
     C                     CALL 'PUW3SRR'              90  SEL AcctCo/Whse
     C                     PARM *BLANK    W0RTN   7
     C           #1IKAA    PARM #1IKAA    WQ0006  3        Warehouse Code
     C                     PARM #1AIC3    WQ0007  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUW3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * Validate warehouse
      * CASE: DTL.COA Active Whse/Tank is Warehouse Code not Blank
     C           #1IKAA    IFNE *BLANK                     *IF
      * RTV Bio-d Code for Whs RT - COA Property Define Hdr  * 
     C                     EXSR SARVGN
      * Error if Warehouse not on COA Prop Def Hdr
      * CASE: LCL.Description USR is equal to blank
     C           YL0001    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVELYL0002    ZA0001           COA Active Whse
      * Send message 'Warehouse entered is not'
     C                     MOVEL'USR3814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * RTV Check for Warehse  RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     MOVEL#1IKAA    WL0003    P      COA Active Whse
     C                     MOVEL'O'       WL0004    P      COA Batch Heade
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUI3NY           COA Batch Numbe
      * Error if Warehouse is 'Entered' or 'Open' on another batch
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#1I3NY    ZA0002           COA Batch Numbe
     C                     MOVEL#1IKAA    ZA0003           COA Active Whse
      * Send message 'The Warehouse is already'
     C                     MOVEL'USR3815' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Check for Warehse  RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     MOVEL#1IKAA    WL0003    P      COA Active Whse
     C                     MOVEL'E'       WL0004    P      COA Batch Heade
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUI3NY           COA Batch Numbe
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#1I3NY    ZA0004           COA Batch Numbe
     C                     MOVEL#1IKAA    ZA0005           COA Active Whse
      * Send message 'The Warehouse is alread'
     C                     MOVEL'USR3828' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Company Name and Address
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to RFS Fuel Code - D Code
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to RFS Process Code
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to RFS Fuel Category Code
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * COA Bio-diesel Fuel Code required
     C           #1IDAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA Active Whse/Tank required
     C           #1IKAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1RFDT           COA Date Open f
     C                     Z-ADD*ZERO     #1C2TM           COA Time Open f
     C                     MOVEL*BLANK    #1MHT1           COA Open for Sh
     C                     Z-ADD*ZERO     #1RGDT           COA Date Close
     C                     Z-ADD*ZERO     #1C3TM           COA Time Close
     C                     MOVEL*BLANK    #1MKT1           COA Close from
     C                     Z-ADD*ZERO     #1JHNY           COA Gallons Use
     C                     MOVEL*BLANK    #1R1NA           COA Comment
     C                     Z-ADD*ZERO     #1RHDT           COA Batch Produ
     C                     Z-ADD*ZERO     #1C4TM           COA Batch Unuse
     C                     MOVEL*BLANK    #1MIT1           COA Specificati
     C                     MOVEL*BLANK    #1MJT1           COA RFS Program
     C                     MOVEL*BLANK    #1HXTX           COA Batch Heade
     C                     MOVEL*BLANK    #1HJTX           COA Batch Prope
     C                     MOVEL*BLANK    #1HYTX           COA Batch Int/E
     C                     Z-ADD*ZERO     #1JENY           COA Temperature
     C                     Z-ADD*ZERO     #1JVNY           COA Batch Volum
     C                     Z-ADD*ZERO     #1JWNY           COA Batch Denat
     C                     MOVEL*BLANK    #1IMTX           COA RFS Renew F
     C                     MOVEL*BLANK    #1FEDS           COA RFS Rnwbl F
     C                     MOVEL*BLANK    #1MTT1           COA Batch RIN
     C                     Z-ADD*ZERO     #1JXNY           COA Batch Expor
     C                     Z-ADD*ZERO     #1J1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     #1JCNY           COA Density Loa
     C                     Z-ADD*ZERO     #1JDNY           COA Density Ref
     C                     Z-ADD*ZERO     #1J3NY           COA RIN Equival
     C                     Z-ADD*ZERO     #1RLDT           COA Batch Unuse
     C                     MOVEL*BLANK    #1MSAA           RFS Fuel Code
     C                     MOVEL*BLANK    #1MTAA           RFS Process Cod
     C                     MOVEL*BLANK    #1MUAA           RFS Fuel Catego
     C                     MOVEL*BLANK    #1L8T1           COA RIN Equival
     C                     Z-ADD*ZERO     #1R0NY           COA RIN Quantit
     C                     MOVEL*BLANK    #1L7T1           COA ULSD Facili
     C                     MOVEL*BLANK    #1JQST           COA Co-Product
     C                     MOVEL*BLANK    #1WUT1           COA Co-Product
     C                     MOVEL*BLANK    #1WVT1           COA Transaction
     C                     MOVEL*BLANK    #1JZST           COA BH RFS Vers
     C                     MOVEL*BLANK    #1J0ST           COA BH EMTS Sts
     C                     Z-ADD*ZERO     #1TTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     #1DRTM           COA BH EMTS Tim
     C                     MOVEL*BLANK    #1WYT1           COA Reviewed By
     C                     MOVEL*BLANK    #1JUST           COA BH Equiv Va
     C                     Z-ADD*ZERO     #1R4NY           COA BH Yield Pe
     C                     MOVEL*BLANK    #1MZAA           COA BH Unused C
     C                     Z-ADD*ZERO     #1TUDT           COA Sample Date
     C                     Z-ADD*ZERO     #1DSTM           COA Sample Time
     C                     MOVEL*BLANK    #1WZT1           COA LIMS ID
     C                     MOVEL*BLANK    #1M0AA           RFS Feedstock C
     C                     Z-ADD*ZERO     #1SANY           COA BH Feedstck
     C                     MOVEL*BLANK    #1KJST           COA BH Feedstck
     C                     MOVEL*BLANK    #1KKST           COA BH Feedstck
     C                     Z-ADD*ZERO     #1GZPC           COA BH Feedstck
     C                     MOVEL*BLANK    #1W2T1           COA BH Feedstck
     C                     MOVEL*BLANK    #1M1AA           RFS Feedstock C
     C                     Z-ADD*ZERO     #1SBNY           COA BH Feedstck
     C                     MOVEL*BLANK    #1KLST           COA BH Feedstck
     C                     MOVEL*BLANK    #1KPST           COA BH Feedstck
     C                     Z-ADD*ZERO     #1G0PC           COA BH Feedstck
     C                     MOVEL*BLANK    #1W3T1           COA BH Feedstck
     C                     MOVEL*BLANK    #1M2AA           RFS Feedstock C
     C                     Z-ADD*ZERO     #1SCNY           COA BH Feedstck
     C                     MOVEL*BLANK    #1KQST           COA BH Feedstck
     C                     MOVEL*BLANK    #1KRST           COA BH Feedstck
     C                     Z-ADD*ZERO     #1G1PC           cOA BH Feedstck
     C                     MOVEL*BLANK    #1W4T1           COA BH Feedstck
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1MJDT           Create Date
     C                     Z-ADD*ZERO     #1BETM           Create Time
     C                     MOVEL*BLANK    #1CCVN           Create User
     C                     MOVEL*BLANK    #1CDVN           Create Program
     C                     Z-ADD*ZERO     #1MKDT           Change Date
     C                     Z-ADD*ZERO     #1BFTM           Change Time
     C                     MOVEL*BLANK    #1CEVN           Change User
     C                     MOVEL*BLANK    #1CFVN           Change Program
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP1L6T1    #1L6T1           COA ULSD Compan
     C                     Z-ADD*ZERO     #1I3NY           COA Batch Numbe
     C                     MOVEL*BLANK    #1IDAA           COA Bio-diesel
     C                     MOVEL*BLANK    #1IKAA           COA Active Whse
     C                     MOVEL*BLANK    #DAUNA           Description
      * USER: Load screen
      * RTV Last HPB Batch #   RT - Company Control  * 
     C                     EXSR SCRVGN
     C                     MOVEL'Y'       YL0004           Record Found US
      * Loop and increment until we find an available Batch #
      * DO WHILE: LCL.Record Found USR is Record Found
     C           YL0004    DOWEQ'Y'                        *DOW
     C                     ADD  1         YL0005           Count USR
      * RTV Check for Batch #  RT - COA Batch Header  * 
     C                     EXSR SDRVGN
      * CASE: PGM.*Return code is COA Batch Header       NF
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'N'       YL0004           Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0003           COA Batch Numbe
      * CASE: LCL.COA Batch Number is 99999
     C           YL0003    IFEQ 99999                      *IF
     C                     Z-ADD1         YL0003           COA Batch Numbe
     C                     END                             *FI
     C                     END                             *FI
      * Avoid looping by skipping out after 99999 reads
      * CASE: LCL.Count USR is 99999
     C           YL0005    IFEQ 99999                      *IF
     C                     MOVEL'N'       YL0004           Record Found US
      * Send message 'All batch numbers have b'
     C                     MOVEL'USR3827' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *ITR
     C                     Z-ADDYL0003    #1I3NY           COA Batch Numbe
      * default
      * Rtv All Values        RT - Company Values  * 
     C                     EXSR SERVGN
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Bio-d Code for Whs RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           COA Bio-dsl Fue
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@CAREOB                    *
     C           KRSSA     READE@CAREOB                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.COA Bio-diesel Fuel Code EQ PAR.COA Bio-diesel Fuel Cod
     C           WAIDAA    IFEQ #1IDAA                     *IF
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : DB1.COA Active Whse/Tank 1 EQ PAR.COA Active Whse/Ta
      *   |- c2    : DB1.COA Active Whse/Tank 2 EQ PAR.COA Active Whse/Ta
      *   |- c3    : DB1.COA Active Whse/Tank 3 EQ PAR.COA Active Whse/Ta
      *   |- c4    : DB1.COA Active Whse/Tank 4 EQ PAR.COA Active Whse/Ta
      *   |- c5    : DB1.COA Active Whse/Tank 5 EQ PAR.COA Active Whse/Ta
      *   |- c6    : DB1.COA Active Whse/Tank 6 EQ PAR.COA Active Whse/Ta
      *   '-
     C           WAIEAA    IFEQ #1IKAA                     *IF
     C           WAIFAA    OREQ #1IKAA                     *OR
     C           WAIGAA    OREQ #1IKAA                     *OR
     C           WAIHAA    OREQ #1IKAA                     *OR
     C           WAIIAA    OREQ #1IKAA                     *OR
     C           WAIJAA    OREQ #1IKAA                     *OR
      * PAR = DB1 By name
     C                     MOVELWAR2NA    YL0001           COA Bio-dsl Fue
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@CAREOB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Check for Warehse  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           COA Batch Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBIKAA    WQSB02           COA Active Whse
     C           *LIKE     DEFN WBHXTX    WQSB03           COA Batch Heade
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           COA Active Whse
     C                     KFLD           WQSB03           COA Batch Heade
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     MOVELWL0003    WQSB02           COA Active Whse
     C                     MOVELWL0004    WQSB03           COA Batch Heade
      * Establish starting position
     C           KRSSB     SETLL@CCCPPD                    *
     C           KRSSB     READE@CCCPPD                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBI3NY    WL0002           COA Batch Numbe
      * There should only ever be one record found, but quit just in case
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@CCCPPD                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Last HPB Batch #   RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ASREGT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     YL0003           Batch Number 5.
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWGBANB    YL0003           Batch Number 5.
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Check for Batch #  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHL6T1           COA ULSD Compan
     C                     KFLD           WHI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     MOVELP1L6T1    WHL6T1           COA ULSD Compan
     C                     Z-ADDYL0003    WHI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSD     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv All Values        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV8CD           Company Value C
      * Setup key
     C                     Z-ADD#1AIC3    WIAIC3           Company Number
     C                     MOVE *BLANK    WIV8CD           Company Value C
     C                     MOVEL'DFTFUEL' WIV8CD           Company Value C
      * Establish starting position
     C           KRSSE     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1IDAA           System Value Al
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIBXTX    #1IDAA           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WJAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WJAJVN           User Profile Na
      * Establish starting position
     C           KRSSF     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELWJMPNA    P2MPNA           Default Printer
     C                     MOVELWJBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDWJAIC3    YL0007           Company Number
     C                     MOVELWJBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WKAJVN           User Profile Na
     C                     KFLD           WKDNCD           Application Cod
      * Setup key
     C                     MOVELWL0005    WKAJVN           User Profile Na
     C                     MOVELWL0006    WKDNCD           Application Cod
      * Establish starting position
     C           KRSSG     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIC3    WL0007           Company Number
     C                     MOVELWKAJCD    WL0008           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLBWC3    WQSH01           Shipping Compan
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0009    WQSH01           Shipping Compan
      * Establish starting position
     C           KRSSH     SETLL@ADREWA                    *
     C           KRSSH     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WLVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WLAOCD    IFNE *BLANK                     *IF
     C                     MOVELWLAOCD    P2AJCD           Warehouse Code
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WMAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WMAIC3           Company Number
      * Establish starting position
     C           KRSSI     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P2ADTX           Name
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMADTX    P2ADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0008  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWC    KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WCAIC3
     C           KLVAWC    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to RFS Fuel Code - D Code
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1MSAA    WK1X01  1
     C           WK1X01    IFEQ '?'                        RFS Fuel Code
     C           YPMTFD    OREQ '#1MSAA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1MSAA' defaulted for 'RFS Fuel Code'.
     C                     CALL 'PNRUSRR'              90  Sel RFS Fuel Co
     C                     PARM *BLANK    W0RTN   7
     C           #1MSAA    PARM #1MSAA    WQ0009  1        RFS Fuel Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNRUSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1MSAA    IFNE *BLANK                     RFS Fuel Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1MSAA    IFEQ *BLANK                     RFS Fuel Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWD    KLIST
     C                     KFLD           WDMSAA           RFS Fuel Code
      * Setup key
     C                     MOVEL#1MSAA    WDMSAA
     C           KLVBWD    CHAIN@GCREGQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'RFS Fuel Code - D Code NF'
     C                     MOVEL'USR4316' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR4316' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to RFS Process Code
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1MTAA    WK1X01  1
     C           WK1X01    IFEQ '?'                        RFS Process Cod
     C           YPMTFD    OREQ '#1MTAA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1MTAA' defaulted for 'RFS Process Code'.
     C                     CALL 'PNRYSRR'              90  Sel RFS Process
     C                     PARM *BLANK    W0RTN   7
     C           #1MTAA    PARM #1MTAA    WQ0010  3        RFS Process Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNRYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1MTAA    IFNE *BLANK                     RFS Process Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1MTAA    IFEQ *BLANK                     RFS Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWE    KLIST
     C                     KFLD           WEMTAA           RFS Process Cod
      * Setup key
     C                     MOVEL#1MTAA    WEMTAA
     C           KLVCWE    CHAIN@GDREGT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'RFS Process Code       NF'
     C                     MOVEL'USR4318' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR4318' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to RFS Fuel Category Code
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1MUAA    WK1X01  1
     C           WK1X01    IFEQ '?'                        RFS Fuel Catego
     C           YPMTFD    OREQ '#1MUAA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1MUAA' defaulted for 'RFS Fuel Category Code'.
     C                     CALL 'PNRWSRR'              90  Sel RFS Fuel Ca
     C                     PARM *BLANK    W0RTN   7
     C           #1MUAA    PARM #1MUAA    WQ0011  3        RFS Fuel Catego
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNRWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1MUAA    IFNE *BLANK                     RFS Fuel Catego
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1MUAA    IFEQ *BLANK                     RFS Fuel Catego
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWF    KLIST
     C                     KFLD           WFMUAA           RFS Fuel Catego
      * Setup key
     C                     MOVEL#1MUAA    WFMUAA
     C           KLVDWF    CHAIN@GEREGW              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'RFS Fuel Category Code NF'
     C                     MOVEL'USR4320' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR4320' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD057       YWWDWD           Window width
     C                     Z-ADD013       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           ##WSR     ADD  013       YWWDRW
     C           ##WSC     ADD  057       YWWDCL
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2ADTX           Name
     C                     MOVEL*BLANK    P2BXTX           System Value Al
     C                     MOVEL*BLANK    P2WVST           Access Denied (
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WAJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WAJENY           COA Temperature
     C                     Z-ADD*ZERO     WAJFNY           COA Temperature
     C                     Z-ADD*ZERO     WAGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WAJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WAJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WAI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field COA Batch Number
     C                     Z-ADD*ZERO     WUI3NY  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WBRFDT           COA Date Open f
     C                     Z-ADD*ZERO     WBC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WBRGDT           COA Date Close
     C                     Z-ADD*ZERO     WBC3TM           COA Time Close
     C                     Z-ADD*ZERO     WBJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WBRHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WBC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WBJENY           COA Temperature
     C                     Z-ADD*ZERO     WBJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WBJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WBJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WBJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WBJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WBJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WBJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WBRLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WBR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WBTTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WBDRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WBR4NY           COA BH Yield Pe
     C                     Z-ADD*ZERO     WBTUDT           COA Sample Date
     C                     Z-ADD*ZERO     WBDSTM           COA Sample Time
     C                     Z-ADD*ZERO     WBSANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WBGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WBSBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WBG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WBSCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WBG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAXNB           Current Account
     C                     Z-ADD*ZERO     WGNGNB           Current Account
     C                     Z-ADD*ZERO     WGBZNB           OM Week
     C                     Z-ADD*ZERO     WGC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WGC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WGCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WGIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WGI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WGDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WGC7NB           Next Customer #
     C                     Z-ADD*ZERO     WGC2NB           Next Inventory
     C                     Z-ADD*ZERO     WGC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WGL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WGBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WGAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WGASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WGA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WGAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WGABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WGACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WGADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WGAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WGAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WGAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WGAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WGAENB           Retention Perio
     C                     Z-ADD*ZERO     WGALNB           Retention Perio
     C                     Z-ADD*ZERO     WGEVNB           Retention Perio
     C                     Z-ADD*ZERO     WGRPOP           Retention Perio
     C                     Z-ADD*ZERO     WGDWNB           Retention Perio
     C                     Z-ADD*ZERO     WGR3NB           Next Load ID
     C                     Z-ADD*ZERO     WGR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WGSCNB           Production Numb
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIM8NB           System Value Nu
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJNLNB           Entity Number
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WLBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WLBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WLBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WLBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  50
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0005 10
     C                     MOVEL*BLANK    WL0006  6
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008  3
      * Define local work field Description USR
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field COA Active Whse/Tank
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field COA Batch Number
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define null work field Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field System Value Type
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field System Value Numeric
     C                     Z-ADD*ZERO     YN0003 155
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0009  30
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * OM91553 - Eric L: get the default per the plant/company number an
      *                   the default instead of the B100 always. (per RM
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SFRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0005    P      User Profile Na
     C                     MOVEL'OMS'     WL0006    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    WUAIC3           Company Number
     C                     MOVELWL0008    YL0008    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0005    P      User Profile Na
     C                     MOVEL'OMS'     WL0006    P      Application Cod
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    WUAIC3           Company Number
     C                     MOVELWL0008    YL0008    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0008    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0007    IFGT 0                          *IF
     C                     Z-ADDYL0007    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0008    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    YL0006           Company Number
     C                     MOVELWUWVST    P2WVST           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** DETAIL Screen: Field position and name array
010570131301569018250208102327
** W0END
010590131601573018300208302356
** W0NAM
V1AIC3    #1L6T1    #1I3NY    #1IDAA    #1IKAA    #DAUNA
** @CN
00001 USR3803
00002 Y2U0005
