// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNVPPFR
// ?Date: 14.08.2025 Time: 12:06:02
// ?------------------------------------------------------------------------------------------------

//?USER: Record selection processing

CASE;

// IF DB1.ED Export Document Type is MPD
IF DB1.ED_Export_Document_Type = 'H';

//?If this is the h record is found then this is ok
// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Vry H Record Exists   RT) TYPE(RTVOBJ) FILE(PDMRREP)           AC2010611;
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Order_Number);
PARAMETER('H');
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

//?If the H record is found then this is ok
// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?USER: Print required level headings

// SUPPRESSED PRINT Company Number header format

// SUPPRESSED PRINT Order Number header format

// SUPPRESSED PRINT ED Export Document Type header format

//?USER: On print of detail format

CASE;

// IF PGM.*Record selected is *YES
IF PGM.*Record_selected = 'Y';

// PGM.*Print format = CND.Print format
PGM.*Print_format = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Print format = CND.Do not print format
PGM.*Print_format = 'N';

ENDIF;

//?USER: Print required level totals

// SUPPRESSED PRINT ED Export Document Type totals format

CASE;

IF NEW Order_Number;
// Print Order Number totals format
PRINT Order Number totals format;

ENDIF;

// SUPPRESSED PRINT Company Number totals format

