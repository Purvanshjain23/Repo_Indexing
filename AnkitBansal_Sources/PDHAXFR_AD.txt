// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDHAXFR
// ?Date: 14.08.2025 Time: 03:34:35
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?This internal function will calculate the month and year for the date
//?that is passed in.  If the month passed in is not a valid month, 9's
//?will be moved to the output MM/DD/YY field.
// PAR.TXT Date-DTE          USR = CVTVAR(PAR.@Date - ATR)
PAR.TXT_Date_DTE_USR = CVTVAR(PAR.@Date_ATR);

// PAR.TXT MM/YY             USR = CVTVAR(PAR.Month/Year NBR        USR)
PAR.TXT_MM_YY_USR = CVTVAR(PAR.Month_Year_NBR_USR);

// WRK.TXT Month Number      USR = SUBSTRING(PAR.TXT MM/YY             USR,CON.2,CO
WRK.TXT_Month_Number_USR = SUBSTRING(PAR.TXT_MM_YY_USR:2:2);

CASE;

// IF WRK.TXT Month Number      USR is *Zeroes
IF WRK.TXT_Month_Number_USR = '00';

// PAR.TXT Month Number      USR = SUBSTRING(PAR.TXT Date-DTE          USR,CON.4,CO
PAR.TXT_Month_Number_USR = SUBSTRING(PAR.TXT_Date_DTE_USR:4:2);

// PAR.TXT Year Number       USR = SUBSTRING(PAR.TXT Date-DTE          USR,CON.2,CO
PAR.TXT_Year_Number_USR = SUBSTRING(PAR.TXT_Date_DTE_USR:2:2);

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.TXT Month Number      USR = WRK.TXT Month Number      USR
PAR.TXT_Month_Number_USR = WRK.TXT_Month_Number_USR;

// PAR.TXT Year Number       USR = SUBSTRING(PAR.TXT MM/YY             USR,CON.4,CO
PAR.TXT_Year_Number_USR = SUBSTRING(PAR.TXT_MM_YY_USR:4:2);

ENDIF;

// PAR.TXT Day Number        USR = CON.31
PAR.TXT_Day_Number_USR = 31;

//?old after
CASE;

// IF PAR.TXT Month Number      USR is Valid Month
IF PAR.TXT_Month_Number_USR >= '01';
AND PAR.TXT_Month_Number_USR <= '12';

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Return code = CND.Month Error
PGM.*Return_code = 'MONERR';

QUIT;

ENDIF;

CASE;

// IF PAR.TXT Year Number       USR is Y2K (For Year Use)
IF PAR.TXT_Year_Number_USR < '40';

// PAR.Year 2000 Indicator = CND.*Yes
PAR.Year_2000_Indicator = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Year 2000 Indicator = CND.*No
PAR.Year_2000_Indicator = 'N';

ENDIF;

CASE;

// IF PAR.Year 2000 Indicator is *Yes
IF PAR.Year_2000_Indicator = 'Y';

// PAR.TXT Date-DTE          USR = CONCAT(CON.1,PAR.TXT Year Number       USR,CON.*
PAR.TXT_Date_DTE_USR = '1' + PAR.TXT_Year_Number_USR (*ZERO);

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.TXT Date-DTE          USR = CONCAT(CON.0,PAR.TXT Year Number       USR,CON.*
PAR.TXT_Date_DTE_USR = '0' + PAR.TXT_Year_Number_USR (*ZERO);

ENDIF;

// PAR.TXT Date-DTE          USR = CONCAT(PAR.TXT Date-DTE          USR,PAR.TXT Mon
PAR.TXT_Date_DTE_USR = PAR.TXT_Date_DTE_USR + PAR.TXT_Month_Number_USR (*ZERO);

// PAR.TXT Date-DTE          USR = CONCAT(PAR.TXT Date-DTE          USR,PAR.TXT Day
PAR.TXT_Date_DTE_USR = PAR.TXT_Date_DTE_USR + PAR.TXT_Day_Number_USR (*ZERO);

// PAR.@Date - ATR = CVTVAR(PAR.TXT Date-DTE          USR)
PAR.@Date_ATR = CVTVAR(PAR.TXT_Date_DTE_USR);

// PAR.TXT MM/YY             USR = CONCAT(PAR.TXT Month Number      USR,PAR.TXT Yea
PAR.TXT_MM_YY_USR = PAR.TXT_Month_Number_USR + PAR.TXT_Year_Number_USR (*ZERO);

// WRK.Month/Year NBR        USR = CVTVAR(PAR.TXT MM/YY             USR)
WRK.Month_Year_NBR_USR = CVTVAR(PAR.TXT_MM_YY_USR);

// PAR.Month/Year NBR        USR = WRK.Month/Year NBR        USR / CON.10 *
PAR.Month_Year_NBR_USR = WRK.Month_Year_NBR_USR / 10;

