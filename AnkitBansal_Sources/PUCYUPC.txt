/*********************************************************************/
/* PROGRAM : PUCYUPC                                                 */
/* DESC    : SQL PRD ITM HLD TO XLS UP EXECUTE USER PROGRAM          */
/* DATE    : 06/08/2017                                              */
/* PROJECT : T10731 - INVENTORY VISIBILITY ENHANCEMENT               */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Call SEQUEL to send Production Item Hold info as an     */
/*           excel via email.                                        */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* 11/21/19 JBB E15817 - Request and Sched ship date on 4-12 screen  */
/*                       Passing in Requested Ship Date instead of   */
/*                       Scheduled Ship Date.  Sequel View PRDITMHLD */
/*                       modified also for Requested Ship Date.      */
/*                                                                   */
/*********************************************************************/

/*  ‚        PGM        PARM(&COMP &SCHDTE &ORDER &ITMCDE &SLSRTE +
    ‚                     &PRDHLD &EMAIL)                            */

             PGM        PARM(&COMP &REQDTE &ORDER &ITMCDE &SLSRTE +
                          &PRDHLD &EMAIL)

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMPA) TYPE(*CHAR) LEN(5)
             DCL        VAR(&COMPA2) TYPE(*CHAR) LEN(3)
/*  ‚        DCL        VAR(&SCHDTE) TYPE(*CHAR) LEN(7)              */
/* ‚         DCL        VAR(&SCHDTEN) TYPE(*DEC) LEN(7 0)            */
             DCL        VAR(&REQDTE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&REQDTEN) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ORDER) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ORDERA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&ITMCDE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&ITMCDEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&SLSRTE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&SLSRTE2) TYPE(*CHAR) LEN(4)
             DCL        VAR(&PRDHLD) TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)

             CHGVAR     VAR(&COMPA2) VALUE(&COMP)
             CHGVAR     VAR(&COMPA) VALUE(&COMPA2)
/*  ‚        CHGVAR     VAR(&SCHDTEN) VALUE(&SCHDTE)                 */
             CHGVAR     VAR(&REQDTEN) VALUE(&REQDTE)
             CHGVAR     VAR(&ORDERA) VALUE(&ORDER)
             CHGVAR     VAR(&SLSRTE2) VALUE(&SLSRTE)
             CHGVAR     VAR(&ITMCDEA) VALUE(&ITMCDE)

/*-------------------------------------------------------------------*/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to       */
/* receipient.                                                       */
/*-------------------------------------------------------------------*/
    /* Format Data to Blanks. */
         /* Company */
             IF         COND(&COMP = 0) THEN(DO)
             CHGVAR     VAR(&COMPA) VALUE('*ALL')
             ENDDO
/*  ‚       Scheduled Ship Date                                      */
/*  ‚        IF         COND(&SCHDTE = '0000000') THEN(DO)           */
/*  ‚        CHGVAR     VAR(&SCHDTE) VALUE('*ALL')                   */
/*  ‚        ENDDO                                                   */
         /* Requested Ship Date */
             IF         COND(&REQDTE = '0000000') THEN(DO)
             CHGVAR     VAR(&REQDTE) VALUE('*ALL')
             ENDDO
         /* Order Number */
             IF         COND(&ORDERA = '0000000') THEN(DO)
             CHGVAR     VAR(&ORDERA) VALUE('*ALL')
             ENDDO
         /* Sales Route */
             IF         COND(&SLSRTE = ' ') THEN(DO)
             CHGVAR     VAR(&SLSRTE2) VALUE('*ALL')
             ENDDO
         /* Item Code */
             IF         COND(&ITMCDEA = '0000000') THEN(DO)
             CHGVAR     VAR(&ITMCDEA) VALUE('*ALL')
             ENDDO

/* ‚         EXECUTE    VIEW(PRDITMHLD) PCFMT(*XLS) +
   ‚                      RECIPIENT(&EMAIL) EMLMSG('Production Item +
    ‚                     Hold: PRDITMHLD Export to Excel') +
    ‚                     SETVAR((&PRDHLD &PRDHLD) (&COMP &COMPA) +
    ‚                     (&SCHDTEN &SCHDTE) (&ORDER &ORDERA) +
   ‚                      (&SLSRTE &SLSRTE2) (&ITMCDE &ITMCDEA))     */

             EXECUTE    VIEW(PRDITMHLD) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG('Production Item +
                          Hold: PRDITMHLD Export to Excel') +
                          SETVAR((&PRDHLD &PRDHLD) (&COMP &COMPA) +
                          (&REQDTEN &REQDTE) (&ORDER &ORDERA) +
                          (&SLSRTE &SLSRTE2) (&ITMCDE &ITMCDEA))

 ENDPGM:
             ENDPGM
