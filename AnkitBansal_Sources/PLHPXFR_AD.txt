// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLHPXFR
// ?Date: 14.08.2025 Time: 02:54:19
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?R7522 JJH 02/17/17 - Inactivate Producer Site Mileage
//?E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
//?  Producer Site. - No logic changes.
ENDDO;

EXECUTE FUNCTION(Rtv PrdSiteMileSt MIL Rt) TYPE(RTVOBJ) FILE(PLAVREP)           AB1272876;
{
 //?USER: Process Data record

 //?Triumph only at this time.
 EXECUTE FUNCTION(Rtv Prod SiteMlg Upd  RT) TYPE(RTVOBJ) FILE(PLASREP)           AB1272877;
 PARAMETER(DB1.PSMU_Producer);
 PARAMETER(DB1.PSMU_Site_Id);
 PARAMETER(960);
 PARAMETER(DB1.PSMU_Producer);
 PARAMETER(DB1.PSMU_Site_Id);
 PARAMETER(DB1.PSMU_Site_Name);
 PARAMETER(DB1.PSMU_Mileage);
 PARAMETER(DB1.PSMU_Manager);
 PARAMETER(DB1.PSMU_Address);
 PARAMETER(DB1.PSMU_City);
 PARAMETER(DB1.PSMU_State);
 PARAMETER(DB1.PSMU_Zip_Code);
 PARAMETER(DB1.PSMU_Latitude);
 PARAMETER(DB1.PSMU_Longitude);
 PARAMETER(DB1.PSMU_Facility_Type_County);
 PARAMETER(DB1.PSMU_Veterinarian);
 PARAMETER(DB1.PSMU_Nutritionist);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg Prod Loc Dlv Co   CO) TYPE(CHGOBJ) FILE(PLASREP)           AB1263910;
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(DB1.PS_Site_ID);
  PARAMETER(PAR.PSM_Company_Number);
  PARAMETER(PAR.PSMU_Mileage);
  PARAMETER('A');
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

  //?E3814 JJH 10/01/15 - Add PS Premises ID
  EXECUTE FUNCTION(Rtv PrdSite Inform    RT) TYPE(RTVOBJ) FILE(PLATREP)           AB1273272;
  PARAMETER(DB1.PD_Producer_Code);
  PARAMETER(DB1.PS_Site_ID);
  PARAMETER(NLL.PS_Site_Name);
  PARAMETER(NLL.PS_Manager);
  PARAMETER(NLL.PS_Address);
  PARAMETER(NLL.PS_City);
  PARAMETER(NLL.PS_State);
  PARAMETER(NLL.PS_Zip_Code);
  PARAMETER(NLL.PS_Latitude);
  PARAMETER(NLL.PS_Longitude);
  PARAMETER(NLL.PS_User_Mileage_1);
  PARAMETER(NLL.PS_User_Mileage_2);
  PARAMETER(NLL.PS_Facility_Type_County);
  PARAMETER(NLL.PS_Status_1);
  PARAMETER(NLL.PS_Status_2);
  PARAMETER(NLL.PS_Status_3);
  PARAMETER(NLL.PS_Trace_Sequence_#);
  PARAMETER(NLL.PS_Veterinarian);
  PARAMETER(NLL.PS_Nutritionist);
  PARAMETER(LCL.PS_Premises_ID);
  PARAMETER(NLL.RS_Record_Status);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?R7522 JJH 02/17/17 - Inactivate Producer Site Mileage
  EXECUTE FUNCTION(Chg Producer Site     CH) TYPE(CHGOBJ) FILE(PLATREP)           AB1267656;
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.PS_Site_ID);
  PARAMETER(PAR.PSMU_Site_Name);
  PARAMETER(PAR.PSMU_Manager);
  PARAMETER(PAR.PSMU_Address);
  PARAMETER(PAR.PSMU_City);
  PARAMETER(PAR.PSMU_State);
  PARAMETER(PAR.PSMU_Zip_Code);
  PARAMETER(PAR.PSMU_Latitude);
  PARAMETER(PAR.PSMU_Longitude);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(PAR.PSMU_Facility_Type_County);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(*ZERO);
  PARAMETER(PAR.PSMU_Veterinarian);
  PARAMETER(PAR.PSMU_Nutritionist);
  PARAMETER(LCL.PS_Premises_ID);
  PARAMETER('A');
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp-SysDtIF) TYPE(EXCINTFUN)                      AB1237006;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // Call program Rtv System Date & Tim UP.
    CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
    PARAMETER(PAR.RS_Date_Changed);
    PARAMETER(PAR.RS_Time_Changed);

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

   //?USER: Processing after Data update

   //?R7522A JJH 02/17/17 - Set the Producer Site Mileage - RS Record
   //?  Status to the same RS Record Status as the Producer Site.
   EXECUTE FUNCTION(Rtv Upd Record Status RT) TYPE(RTVOBJ) FILE(PLASREP)           AB1331615;
   PARAMETER(DB1.PD_Producer_Code);
   PARAMETER(DB1.PS_Site_ID);
   PARAMETER(DB1.RS_Record_Status);
   {
    //?USER: Process Data record

    CASE;

    // IF DB1.RS Record Status NE PAR.RS Record Status
    IF DB1.RS_Record_Status <> PAR.RS_Record_Status;

    EXECUTE FUNCTION(Chg RS Record Status  CO) TYPE(CHGOBJ) FILE(PLASREP)           AB1331616;
    PARAMETER(DB1.PD_Producer_Code);
    PARAMETER(DB1.PS_Site_ID);
    PARAMETER(DB1.PSM_Company_Number);
    PARAMETER(PAR.RS_Record_Status);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
     PARAMETER(DB1.RS_User_Changed);
     PARAMETER(DB1.RS_Date_Changed);
     PARAMETER(DB1.RS_Time_Changed);
     PARAMETER(DB1.RS_Job);
     PARAMETER(DB1.RS_Program);
     {
      //?Execute internal function

      // PAR.RS User Changed = JOB.*USER
      PAR.RS_User_Changed = JOB.*USER;

      // PAR.RS Date Changed = JOB.*Job date
      PAR.RS_Date_Changed = JOB.*Job_date;

      // PAR.RS Time Changed = JOB.*Job time
      PAR.RS_Time_Changed = JOB.*Job_time;

      // PAR.RS Job = JOB.*JOB
      PAR.RS_Job = JOB.*JOB;

      // PAR.RS Program = JOB.*PROGRAM
      PAR.RS_Program = JOB.*PROGRAM;

     }

    }

    ENDIF;

   }

  }

 }

}


