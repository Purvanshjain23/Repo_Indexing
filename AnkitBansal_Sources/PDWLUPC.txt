/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PDQNUPC                                       */
/*  PROGRAM NAME:    Print ORDER INQURIY FOR SHIPPING              */
/*  PROGRAMMER:      JOHN TREMPER                                  */
/*  CREATE DATE:     06/23/98                                      */
/*                                                                 */
/*  FUNCTION:        This CLP is submitted FROM THE ORDER          */
/*                   INQUIRY FOR SHIPPING DISPLAY FILE AND WILL    */
/*                   RUN AN OPEN QUERY FILE TO MINIMIZE RECORDS.   */
/*                                                                 */
/*                   USER OPTIONS ARE PASSED THROUGH THE PARMS.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*                                                                 */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&COMP &PDATE)
/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* INPUT PARAMETERS                                                */
             DCL        VAR(&COMP)  TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&PDATE) TYPE(*DEC)

/*-----------------------------------------------------------------*/
/* PROGRAM VARIABLES                                               */
             DCL        VAR(&PDTE)     TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&QRYCOMP)  TYPE(*CHAR) LEN(3)
             DCL        VAR(&QRYPDATE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&A)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&B)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&C)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&D)        TYPE(*CHAR) LEN(25)
             DCL        VAR(&E)        TYPE(*CHAR) LEN(200)

/*-----------------------------------------------------------------*/
/* MOVES INPUT TO QUERY FIELDS                                     */
             CHGVAR     VAR(&QRYCOMP)  VALUE(&COMP)
             CHGVAR     VAR(&PDTE)     VALUE(&PDATE)
             CHGVAR     VAR(&QRYPDATE) VALUE(&PDTE)

/*-----------------------------------------------------------------*/
/* OPEN QUERY FILE CONCATS                                         */
             CHGVAR     VAR(&A) VALUE('NDAIC3 *EQ ' *CAT &QRYCOMP)
             CHGVAR     VAR(&B) VALUE('*AND NDN2DT *EQ ' +
                                       *CAT &QRYPDATE)
             CHGVAR     VAR(&E) VALUE(&A *BCAT &B)

/*-----------------------------------------------------------------*/
/* OPEN QUERY                                                      */
/*-----------------------------------------------------------------*/
/* PLEASE NOTE:                                                    */
/*   THE 'OVRSCOPE' PARAMETER FOR THE OVRDBF MUST BE SET TO *JOB   */
/*   IN ORDER FOR THIS FUNCTION TO WORK PROPERLY.  AFTER THE       */
/*   PRINT FILE HAS COMPLETED AN EXECUTABLE MESSAGE WILL WILL      */
/*   DELETE THE OVERRIDE.  THE 'OVERSCOPE' ON THE EXECUTABLE       */
/*   MUST BE SET TO *JOB AS WELL.                                  */
/*      JOHN TREMPER, JUNE 24, 1998                                */
/*-----------------------------------------------------------------*/
             OVRDBF     FILE(PDNDCPL2) OVRSCOPE(*JOB) SHARE(*YES)
             OPNQRYF    FILE((PDNDCPL2)) QRYSLT(&E) KEYFLD(*FILE)

/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:

             ENDPGM
