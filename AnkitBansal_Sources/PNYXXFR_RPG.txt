     H/TITLE Crt Orders f/SSIS Upld XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 04/17/25  Time  : 01:04:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNHGCPL2IF  E           K        DISK
      * RSQ : WF Export Upload Header   Co#, ShipTo, PO#
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPNHGCPL3IF  E           K        DISK
      * RSQ : WF Export Upload Header   Co#,Broker,ShipTo,PO#
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
      * Long constants
     E                    @CN#    1  21  6   @CN    25
     I@HGCPLN
      * WF Export Upload Header   Co#, ShipTo, PO#
      * Renamed input format fields
     I              HGBKC7                          WABKC7
     I              HGBCNA                          WABCNA
     I              HGAIC3                          WAAIC3
     I              HGAJCD                          WAAJCD
     I              HGBVTM                          WABVTM
     I              HGXECD                          WAXECD
     I              HGTYNA                          WATYNA
     I              HGTZNA                          WATZNA
     I              HGRINY                          WARINY
     I              HGQ2CD                          WAQ2CD
     I              HGYMT1                          WAYMT1
     I              HGRHTX                          WARHTX
     I              HGRITX                          WARITX
     I              HGRJTX                          WARJTX
     I              HGSCTX                          WASCTX
     I              HGSDTX                          WASDTX
     I              HGAAAB                          WAAAAB
     I              HGPHU1                          WAPHU1
     I              HGABAB                          WAABAB
     I              HGHHAA                          WAHHAA
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WBDOCD
     I              DPAUNA                          WBAUNA
     I              DPI5ST                          WBI5ST
     I              DPBXTX                          WBBXTX
     I              DPM8NB                          WBM8NB
     I              DPUVST                          WBUVST
     I              DPUWST                          WBUWST
     I              DPUXST                          WBUXST
     I              DPVSST                          WBVSST
     I              DPAATM                          WBAATM
     I              DPAYNA                          WBAYNA
     I              DPA0NA                          WBA0NA
     I              DPAXDT                          WBAXDT
      *
     I@HGCPTP
      * WF Export Upload Header   Co#,Broker,ShipTo,PO#
      * Renamed input format fields
     I              HGBKC7                          WCBKC7
     I              HGBCNA                          WCBCNA
     I              HGAIC3                          WCAIC3
     I              HGAJCD                          WCAJCD
     I              HGBVTM                          WCBVTM
     I              HGXECD                          WCXECD
     I              HGTYNA                          WCTYNA
     I              HGTZNA                          WCTZNA
     I              HGRINY                          WCRINY
     I              HGQ2CD                          WCQ2CD
     I              HGYMT1                          WCYMT1
     I              HGRHTX                          WCRHTX
     I              HGRITX                          WCRITX
     I              HGRJTX                          WCRJTX
     I              HGSCTX                          WCSCTX
     I              HGSDTX                          WCSDTX
     I              HGAAAB                          WCAAAB
     I              HGPHU1                          WCPHU1
     I              HGABAB                          WCABAB
     I              HGHHAA                          WCHHAA
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * B :  Return Code Usr
     I                                        1   7 P1H3TX
     IP2PARM      DS
      * FLD: WF Export Upload Header
      * I :  Company Number
     I                                    P   1   20P2AIC3
      * I :  Broker Code
     I                                        3   8 P2HHAA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1H3TX    PARM P1H3TX    WP0001  7        Return Code Usr
     C           P2AIC3    PARM           WP0002  30       Company Number
     C           P2HHAA    PARM           WP0003  6        Broker Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Orders f/SSIS Upld XF
      * ***This Function is Called from SSIS Process OR from Submit
      *    Automated Orders menu option.***
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0001  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0002  6        PFS Interface C
     C           WUO1ST    PARM *BLANK    WQ0003  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0004  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0005  6        PFS Interface C
     C           WUWSSX    PARM *BLANK    WQ0006  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Creates Orders from uploads, and Loads if not live w/tpm
      * ** Program selection is made in the called function
      * R17029 DN 01/21/21-NEW Logic. Removed 'C&K Brokerage' Logic.
      * CASE: PAR.Broker Code is Japanese Broker
     C           P2HHAA    IFEQ 'SEI'                      *IF
      * Broker code passed as an additional parm              E003326
      * RMC S14549 RMC - chk broker in rtv
      * RTV Jpn Ords by Co#    RT - WF Export Upload Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2AIC3    WL0001           Company Number
     C                     MOVELP2HHAA    WL0002    P      Broker Code
     C                     MOVELP1H3TX    WL0003    P      Return Code Usr
     C                     MOVELWUO1ST    WL0004    P      Live with TPM
     C                     MOVELWUWSSX    WL0005    P      PFS AccuSort Ac
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    P1H3TX    P      Return Code Usr
     C                     ELSE
      * CASE: PAR.Broker Code is Mexico
     C           P2HHAA    IFEQ 'MEX'                      *IF
      * R17013 DN 01/29/21-Added Order Automation Creation for Mexico.
      * RTV MEX Ords by Co#    RT - WF Export Upload Header  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * * E7358 for domestic customers, such as Jetro, etc
      * R17029 DN 01/21/21-C&K Brokerage will also process here.
      * RTV Ords by Co#,Brkr   RT - WF Export Upload Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1H3TX    WL0009    P      Return Code Usr
     C                     Z-ADDP2AIC3    WL0010           Company Number
     C                     MOVELP2HHAA    WL0011    P      Broker Code
     C                     MOVELWUO1ST    WL0012    P      Live with TPM
     C                     MOVELWUWSSX    WL0013    P      PFS AccuSort Ac
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    P1H3TX    P      Return Code Usr
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Jpn Ords by Co#    RT - WF Export Upload Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 15        ED Shipping Mar
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@HGCPLN                    *
     C           KRSSA     READE@HGCPLN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4442' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WL0003           Return Code Usr
      * CASE: PAR.Broker Code NE DB1.Broker Code
     C           WL0002    IFNE WAHHAA                     *IF
      * RMC 2/21/19 only process if hdr broker is SEI- matching par.broke
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Creates Load & Order records for Japanese & Domestic Orders
      * ** This function is called by an SSIS function
      * ** Default Load ID and Order Number to zeros for this procedure
      * ** Put Price Code into the Item Code PASS USR field
     C                     Z-ADD*ZERO     YL0001           System Value Nu
     C                     Z-ADD*ZERO     YL0002           Order Number 1
      * ** Build the Special Instructions, pass in Customer Name parm
     C                     MOVEL*BLANK    YL0003           Reference Field
     C                     Z-ADD1         ZQ      50
     C           'CAF'     CAT  WAXECD:ZQ YL0003    P      Reference Field
      * ** Build the Shipping Instructions
     C                     Z-ADD*ZERO     ZQ      50
     C           WABCNA    CAT  '/':ZQ    WN0001    P      ED Shipping Mar
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0001    CAT  WAYMT1:ZQ WN0001    P      ED Shipping Mar
      * ** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to SSD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0007 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0008 11        Date To Convert
     C                     PARM '*YYMD'   WQ0009  8        Date From Forma
     C                     PARM '*CYMD'   WQ0010  8        Date To Format
     C                     PARM '*NONE'   WQ0011  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Scheduled Ship Date USR = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUHODT           Scheduled Ship
      * ** Parse RDD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to RDD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0012 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0013 11        Date To Convert
     C                     PARM '*YYMD'   WQ0014  8        Date From Forma
     C                     PARM '*CYMD'   WQ0015  8        Date To Format
     C                     PARM '*NONE'   WQ0016  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Req Delivery Date = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUNYDT           Req Delivery Da
      * ** Don't create orders if SSD is before today else Do   E002587
      * CASE: WRK.Scheduled Ship Date USR LT JOB.*Job date
     C           WUHODT    IFLT ##JDT                      *IF
     C                     MOVEL*BLANK    WL0003           Return Code Usr
     C                     MOVEL'NOUPD'   WL0003           Return Code Usr
      * R16637 DN 11/17/20-Check PROD/TEST Data Library to Set Email DL.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0004           Email Address
     C                     MOVEL@CN,001   YL0004           Email Address
      * RTV Data Libraries     RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'DTALIB'  WL0006    P      System Value Co
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0005    P      Library List Co
     C                     MOVELWL0008    YN0001    P      @Library List C
      * CASE: LCL.Library List Code is PRKFLIB Prod Lib
     C           YL0005    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    YL0004           Email Address
     C                     MOVEL@CN,005   YL0004           Email Address
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0006           Company Number
     C                     MOVELWL0001    YL0006           Company Number
     C                     MOVEL*BLANK    YL0007           Text USR 7
     C                     MOVELWUHODT    YL0007           Text USR 7
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0007    WQ0017 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0018 11        Date To Convert
     C                     PARM '*CYMD'   WQ0019  8        Date From Forma
     C                     PARM '*MDYY'   WQ0020  8        Date To Format
     C                     PARM '/'       WQ0021  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  WN0001:ZQ YL0008    P      Subject Line US
     C                     Z-ADD1         ZQ      50
     C           WUTAT1    CAT  @CN,007:ZQYL0009    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  @CN,008:ZQYL0009    P      Pager Msg 256 U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0009    CAT  @CN,009:ZQYL0009    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  YL0006:ZQ YL0009    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  @CN,010:ZQYL0009    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  @CN,011:ZQYL0009    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  @CN,012:ZQYL0009    P      Pager Msg 256 U
      * R16637 DN 11/17/20-CONCAT 'Test' to Email Msg if in TEST Env.
      * CASE: LCL.Library List Code is Not PRKFLIB
     C           YL0005    IFNE @CN,004                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  @CN,013:ZQYL0009    P      Pager Msg 256 U
     C                     END                             *FI
      * CLP Exe ESNDMAIL Cmd   UP - /UT User Programs  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM YL0010    WQ0022  7        Return Code Usr
     C                     PARM YL0004    WQ0023 50        Email Address
     C                     PARM YL0008    WQ0024100        Subject Line US
     C                     PARM YL0009    WQ0025256        Pager Msg 256 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * * If Live w/TPM = "N" or "P" then create order and load. E004019
      * * If Live w/TPM = "Y" then create orders only
      *      but it live with DOM/EX only, still created the loads here
      * * Create orders and loads - or just orders if Live w/TPM & not ju
      * CASE: PAR.Broker Code is Japanese Broker
     C           WL0002    IFEQ 'SEI'                      *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Live with TPM is Not Yes
      *   |- c2    : PAR.PFS AccuSort Active is Yes
      *   '-
     C           WL0004    IFEQ 'N'                        *IF
     C           WL0004    OREQ 'P'
     C           WL0005    OREQ 'Y'                        *OR
      * if live with tpm but DOM/EX only, create order/loads for type ES
      * * Pass in Consignee info                              E004201
      * R16637 DN 10/02/20-Set Consignee Addr 4, State, Zip & Country.
      * CRT Japan Chlld Orders XF - Customer Price Header  * 
     C                     CALL 'PMV5XFR'              90  CRT Japan Chlld
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0026 155       Company Number
     C                     PARM WABKC7    WQ0027 155       Customer Number
     C                     PARM WUHODT    WQ0028 155       Date 1
     C                     PARM WUHODT    WQ0029 155       Date 2
     C                     PARM WUNYDT    WQ0030 155       From Date Pass
     C           YL0002    PARM YL0002    WQ0031 155       Order Number 1
     C           YL0001    PARM YL0001    WQ0032 155       System Value Nu
     C                     PARM WAAJCD    WQ0033  3        Warehouse Code
     C                     PARM WABVTM    WQ0034 155       Item Code PASS
     C                     PARM 'U'       WQ0035  1        Change Flag USR
     C                     PARM YL0003    WQ0036 30        Customer Name
     C                     PARM WABCNA    WQ0037 15        Customer Purcha
     C                     PARM WARINY    WQ0038  40       Days to Age  Pa
     C                     PARM YL0011    WQ0039 155       Date 4 RGF   Pa
     C                     PARM YL0012    WQ0040 155       Date 4 RGT   Pa
     C                     PARM WN0001    WQ0041 15        ED Shipping Mar
     C                     PARM WARHTX    WQ0042 63        ED Consignee Na
     C                     PARM WARITX    WQ0043 63        ED Consignee Ad
     C                     PARM WARJTX    WQ0044 63        ED Consignee Ad
     C                     PARM WASCTX    WQ0045 63        ED Consignee Ad
     C                     PARM WASDTX    WQ0046 63        ED Consignee Ad
     C                     PARM WAAAAB    WQ0047  2        ED Consignee St
     C                     PARM WAPHU1    WQ0048 20        ED Consignee Po
     C                     PARM WAABAB    WQ0049  6        ED Consignee Co
     C                     PARM WAHHAA    WQ0050  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMV5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT JPN Orders Not LoadXF - Customer Price Header  * 
     C                     CALL 'PBH2XFR'              90  Zzz JPN Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0051 155       Company Number
     C                     PARM WABKC7    WQ0052 155       Customer Number
     C                     PARM WUHODT    WQ0053 155       Date 1
     C                     PARM WUHODT    WQ0054 155       Date 2
     C                     PARM WUNYDT    WQ0055 155       From Date Pass
     C           YL0002    PARM YL0002    WQ0056 155       Order Number 1
     C           YL0001    PARM YL0001    WQ0057 155       System Value Nu
     C                     PARM WAAJCD    WQ0058  3        Warehouse Code
     C                     PARM WABVTM    WQ0059 155       Item Code PASS
     C                     PARM 'U'       WQ0060  1        Change Flag USR
     C                     PARM YL0003    WQ0061 30        Customer Name
     C                     PARM WABCNA    WQ0062 15        Customer Purcha
     C                     PARM WARINY    WQ0063  40       Days to Age  Pa
     C                     PARM YL0011    WQ0064 155       Date 4 RGF   Pa
     C                     PARM YL0012    WQ0065 155       Date 4 RGT   Pa
     C                     PARM WN0001    WQ0066 15        ED Shipping Mar
     C                     PARM WARHTX    WQ0067 63        ED Consignee Na
     C                     PARM WARITX    WQ0068 63        ED Consignee Ad
     C                     PARM WARJTX    WQ0069 63        ED Consignee Ad
     C                     PARM WASCTX    WQ0070 63        ED Consignee Ad
     C                     PARM WASDTX    WQ0071 63        ED Consignee Ad
     C                     PARM WAAAAB    WQ0072  2        ED Consignee St
     C                     PARM WAPHU1    WQ0073 20        ED Consignee Po
     C                     PARM WAABAB    WQ0074  6        ED Consignee Co
     C                     PARM WAHHAA    WQ0075  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBH2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ** Default printer to Sales, and don't put on hold  E001973
     C                     MOVEL*BLANK    WUBCSX           Hold
     C                     MOVEL'*NO'     WUBCSX           Hold
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0076  30       Company Number
     C                     PARM @CN,014   WQ0077 10        Company Value C
     C           WUDEV     PARM *BLANK    WQ0078 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E2176 SLM 03/14/2013
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM WAAIC3    WQ0079 155       Company Number
     C                     PARM YL0002    WQ0080 155       Order Number 1
     C                     PARM YL0002    WQ0081 155       Order Number 2
     C                     PARM *ZERO     WQ0082 155       Date 1
     C                     PARM *ZERO     WQ0083 155       Date 2
     C                     PARM *ZERO     WQ0084 155       Thru Date Pass
     C                     PARM *BLANK    WQ0085  2        Order Type_Sale
     C                     PARM WUOTTX    WQ0086  2        Shipping Method
     C                     PARM '1'       WQ0087  1        Billing Activit
     C                     PARM 'A'       WQ0088  1        Export Sales
     C                     PARM *BLANK    WQ0089  3        USR Warehouse C
     C                     PARM *BLANK    WQ0090  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0091  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0092  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0093  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0094  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0095  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0096  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0097  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0098  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0099  1        USR Select/Omit
     C                     PARM WUDEV     WQ0100 10        PRT Printer Dev
     C                     PARM WUBCSX    WQ0101  4        PRT Hold Output
     C                     PARM '*YES'    WQ0102  4        PRT Save Output
     C                     PARM 1         WQ0103 155       System Value Nu
     C                     PARM *BLANK    WQ0104 10        PRT Night Queue
     C                     PARM *ZERO     WQ0105 155       Date 3
     C                     PARM *BLANK    WQ0106  1        Email To Whs
     C                     PARM *BLANK    WQ0107  3        Email to Wareho
     C                     PARM 'N'       WQ0108  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@HGCPLN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Data Libraries     RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WBDOCD           System Value Co
      * Setup key
     C                     MOVELWL0006    WBDOCD           System Value Co
      * Establish starting position
     C           KPSSB     SETLL@DPRETD                    *
     C                     READ @DPRETD                  90*
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.System Value Code is Data File Library
     C           WBDOCD    IFEQ @CN,002                    *IF
     C                     MOVELWBBXTX    WL0007           Library List Co
     C                     ELSE
      * CASE: DB1.System Value Code is History File Library
     C           WBDOCD    IFEQ @CN,003                    *IF
     C                     MOVELWBBXTX    WL0008           @Library List C
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @DPRETD                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV MEX Ords by Co#    RT - WF Export Upload Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002 15        ED Shipping Mar
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSC01           Company Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSC01           Company Number
      * Establish starting position
     C           KRSSC     SETLL@HGCPLN                    *
     C           KRSSC     READE@HGCPLN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4442' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    P1H3TX           Return Code Usr
      * CASE: PAR.Broker Code NE DB1.Broker Code
     C           P2HHAA    IFNE WAHHAA                     *IF
      * Only process if hdr broker is MEX- matching par.broker
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Creates Order (Not Load) records for Mexico Orders.
      * ** This function is called by an SSIS function
      * ** Default Order Number to zeros for this procedure
      * ** Put Price Code into the Item Code PASS USR field
     C                     Z-ADD*ZERO     YL0013           System Value Nu
     C                     Z-ADD*ZERO     YL0014           Order Number 1
      * ** Build the Special Instructions, pass in Customer Name parm
     C                     MOVEL*BLANK    YL0015           Reference Field
     C                     Z-ADD1         ZQ      50
     C           'CAF'     CAT  WAXECD:ZQ YL0015    P      Reference Field
      * ** Build the Shipping Instructions
      * R17013 DN 03/03/21-Don't Populate the Shipping Marks in PDMRREP F
     C                     Z-ADD*ZERO     ZQ      50
     C           WABCNA    CAT  '/':ZQ    YL0016    P      ED Shipping Mar
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0016    CAT  WAYMT1:ZQ YL0016    P      ED Shipping Mar
      * ** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to SSD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATYNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0109 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0110 11        Date To Convert
     C                     PARM '*YYMD'   WQ0111  8        Date From Forma
     C                     PARM '*CYMD'   WQ0112  8        Date To Format
     C                     PARM '*NONE'   WQ0113  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Scheduled Ship Date USR = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUHODT           Scheduled Ship
      * ** Parse RDD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to RDD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWATZNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0114 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0115 11        Date To Convert
     C                     PARM '*YYMD'   WQ0116  8        Date From Forma
     C                     PARM '*CYMD'   WQ0117  8        Date To Format
     C                     PARM '*NONE'   WQ0118  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Req Delivery Date = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUNYDT           Req Delivery Da
      * ** Don't create orders if SSD is before today else Do   E002587
      * CASE: WRK.Scheduled Ship Date USR LT JOB.*Job date
     C           WUHODT    IFLT ##JDT                      *IF
     C                     MOVEL*BLANK    P1H3TX           Return Code Usr
     C                     MOVEL'NOUPD'   P1H3TX           Return Code Usr
      * R16637 DN 11/17/20-Check PROD/TEST Data Library to Set Email DL.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0017           Email Address
     C                     MOVEL@CN,001   YL0017           Email Address
      * RTV Data Libraries     RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'DTALIB'  WL0006    P      System Value Co
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0018    P      Library List Co
     C                     MOVELWL0008    YN0002    P      @Library List C
      * CASE: LCL.Library List Code is PRKFLIB Prod Lib
     C           YL0018    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    YL0017           Email Address
     C                     MOVEL@CN,005   YL0017           Email Address
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0019           Company Number
     C                     MOVELP2AIC3    YL0019           Company Number
     C                     MOVEL*BLANK    YL0020           Text USR 7
     C                     MOVELWUHODT    YL0020           Text USR 7
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0020    WQ0119 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0120 11        Date To Convert
     C                     PARM '*CYMD'   WQ0121  8        Date From Forma
     C                     PARM '*MDYY'   WQ0122  8        Date To Format
     C                     PARM '/'       WQ0123  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * R17013 DN 03/03/21-Use LCL.ED Shipping Marks Txt here.
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  YL0016:ZQ YL0021    P      Subject Line US
     C                     Z-ADD1         ZQ      50
     C           WUTAT1    CAT  @CN,007:ZQYL0022    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,008:ZQYL0022    P      Pager Msg 256 U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0022    CAT  @CN,009:ZQYL0022    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  YL0019:ZQ YL0022    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,010:ZQYL0022    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,011:ZQYL0022    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,012:ZQYL0022    P      Pager Msg 256 U
      * R16637 DN 11/17/20-CONCAT 'Test' to Email Msg if in TEST Env.
      * CASE: LCL.Library List Code is Not PRKFLIB
     C           YL0018    IFNE @CN,004                    *IF
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,013:ZQYL0022    P      Pager Msg 256 U
     C                     END                             *FI
      * CLP Exe ESNDMAIL Cmd   UP - /UT User Programs  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM YL0023    WQ0124  7        Return Code Usr
     C                     PARM YL0017    WQ0125 50        Email Address
     C                     PARM YL0021    WQ0126100        Subject Line US
     C                     PARM YL0022    WQ0127256        Pager Msg 256 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * R17013 DN 01/29/21-Create Orders and Not Load. MG Creates the Loa
      * S17053 DN 04/02/21-Set ED Shipping Marks Txt to 'Not Required'.
      * CRT MEX Orders Not LoadXF - Customer Price Header  * 
     C                     CALL 'PUR9XFR'              90  CRT MEX Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0128 155       Company Number
     C                     PARM WABKC7    WQ0129 155       Customer Number
     C                     PARM WUHODT    WQ0130 155       Date 1
     C                     PARM WUHODT    WQ0131 155       Date 2
     C                     PARM WUNYDT    WQ0132 155       From Date Pass
     C           YL0014    PARM YL0014    WQ0133 155       Order Number 1
     C           YL0013    PARM YL0013    WQ0134 155       System Value Nu
     C                     PARM WAAJCD    WQ0135  3        Warehouse Code
     C                     PARM WABVTM    WQ0136 155       Item Code PASS
     C                     PARM 'U'       WQ0137  1        Change Flag USR
     C                     PARM YL0015    WQ0138 30        Customer Name
     C                     PARM WABCNA    WQ0139 15        Customer Purcha
     C                     PARM 'MEX'     WQ0140  6        Country Code
     C                     PARM WARINY    WQ0141  40       Days to Age  Pa
     C                     PARM YL0024    WQ0142 155       Date 4 RGF   Pa
     C                     PARM YL0025    WQ0143 155       Date 4 RGT   Pa
     C                     PARM @CN,015   WQ0144 15        ED Shipping Mar
     C                     PARM WAQ2CD    WQ0145  2        Shipping Method
     C                     PARM WARHTX    WQ0146 63        ED Consignee Na
     C                     PARM WARITX    WQ0147 63        ED Consignee Ad
     C                     PARM WARJTX    WQ0148 63        ED Consignee Ad
     C                     PARM WASCTX    WQ0149 63        ED Consignee Ad
     C                     PARM WASDTX    WQ0150 63        ED Consignee Ad
     C                     PARM WAAAAB    WQ0151  2        ED Consignee St
     C                     PARM WAPHU1    WQ0152 20        ED Consignee Po
     C                     PARM WAABAB    WQ0153  6        ED Consignee Co
     C                     PARM WAHHAA    WQ0154  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUR9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * S17053 DN 04/02/21-Changed HOLD to 'Yes'.
     C                     MOVEL*BLANK    WUBCSX           Hold
     C                     MOVEL'*YES'    WUBCSX           Hold
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0155  30       Company Number
     C                     PARM @CN,014   WQ0156 10        Company Value C
     C           WUDEV     PARM *BLANK    WQ0157 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM WAAIC3    WQ0158 155       Company Number
     C                     PARM YL0014    WQ0159 155       Order Number 1
     C                     PARM YL0014    WQ0160 155       Order Number 2
     C                     PARM *ZERO     WQ0161 155       Date 1
     C                     PARM *ZERO     WQ0162 155       Date 2
     C                     PARM *ZERO     WQ0163 155       Thru Date Pass
     C                     PARM *BLANK    WQ0164  2        Order Type_Sale
     C                     PARM WUOTTX    WQ0165  2        Shipping Method
     C                     PARM '1'       WQ0166  1        Billing Activit
     C                     PARM 'A'       WQ0167  1        Export Sales
     C                     PARM *BLANK    WQ0168  3        USR Warehouse C
     C                     PARM *BLANK    WQ0169  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0170  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0171  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0172  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0173  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0174  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0175  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0176  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0177  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0178  1        USR Select/Omit
     C                     PARM WUDEV     WQ0179 10        PRT Printer Dev
     C                     PARM WUBCSX    WQ0180  4        PRT Hold Output
     C                     PARM '*YES'    WQ0181  4        PRT Save Output
     C                     PARM 1         WQ0182 155       System Value Nu
     C                     PARM *BLANK    WQ0183 10        PRT Night Queue
     C                     PARM *ZERO     WQ0184 155       Date 3
     C                     PARM *BLANK    WQ0185  1        Email To Whs
     C                     PARM *BLANK    WQ0186  3        Email to Wareho
     C                     PARM 'N'       WQ0187  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@HGCPLN                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Ords by Co#,Brkr   RT - WF Export Upload Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0003 15        ED Shipping Mar
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and Comments
     C                     EXSR UASUBR                     ***** Changes a
      * R16637 DN 10/23/20-Get Data File Library.
      * RTV Data Libraries     XF - System Values  * 
     C                     CALL 'CAQXXFR'              90  RTV Data Librar
     C                     PARM *BLANK    W0RTN   7
     C           YL0026    PARM YL0026    WQ0188 10        Library List Co
     C           YL0027    PARM YL0027    WQ0189 10        @Library List C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCHHAA    WQSD02           Broker Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Broker Code
      * Setup key
     C                     Z-ADDWL0010    WQSD01           Company Number
     C                     MOVELWL0011    WQSD02           Broker Code
      * Establish starting position
     C           KRSSD     SETLL@HGCPTP                    *
     C           KRSSD     READE@HGCPTP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4442' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ***** Comments and changes
     C                     EXSR UBSUBR                     ***** Comments
     C                     MOVEL*BLANK    WL0009           Return Code Usr
      * ** Format the CYYMMDD date from the 26 char date passed from SSIS
     C                     Z-ADD*ZERO     YL0028           System Value Nu
     C                     Z-ADD*ZERO     YL0029           Order Number 1
     C                     MOVEL*BLANK    YL0030           Reference Field
     C                     Z-ADD*ZERO     ZQ      50
     C           WCBCNA    CAT  '/':ZQ    WN0003    P      ED Shipping Mar
      * ** Parse SSD from *char(26) (from SSIS) to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to SSD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTYNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTYNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTYNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0190 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0191 11        Date To Convert
     C                     PARM '*YYMD'   WQ0192  8        Date From Forma
     C                     PARM '*CYMD'   WQ0193  8        Date To Format
     C                     PARM '*NONE'   WQ0194  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Scheduled Ship Date USR = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUHODT           Scheduled Ship
      * ** Parse RDD - 26 alpha from SSIS to 10 alpha for CVT DATE
      * ** Then move 11 alpha date to 7 alpha, convert 7 alpha
      * ** to 7 numeric. Finally move 7 numeric to RDD
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTZNA:ZQ WUZ7TX    P  90  Text USR 4
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTZNA:ZQ WUHKT1    P  90  Text 2
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCTZNA:ZQ WUW2TX    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUHKT1:ZQ WUK1TX    P      Text 10A USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUK1TX    CAT  WUW2TX:ZQ WUK1TX    P      Text 10A USR
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM WUK1TX    WQ0195 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0196 11        Date To Convert
     C                     PARM '*YYMD'   WQ0197  8        Date From Forma
     C                     PARM '*CYMD'   WQ0198  8        Date To Format
     C                     PARM '*NONE'   WQ0199  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUTAT1    WUY8TX           Text USR 7
     C                     MOVE WUY8TX    WUODNB           Number Value -
      * WRK.Req Delivery Date = WRK.Number Value - 7
     C                     Z-ADDWUODNB    WUNYDT           Req Delivery Da
      * ** Don't create orders if SSD is before today
      * CASE: WRK.Scheduled Ship Date USR LT JOB.*Job date
     C           WUHODT    IFLT ##JDT                      *IF
     C                     MOVEL*BLANK    WL0009           Return Code Usr
     C                     MOVEL'NOUPD'   WL0009           Return Code Usr
      * CASE: PAR.Broker Code is Japanese Broker
     C           WL0011    IFEQ 'SEI'                      *IF
     C                     MOVEL*BLANK    YL0031           Email Address
     C                     MOVEL@CN,016   YL0031           Email Address
     C                     ELSE
      * CASE: PAR.Broker Code is C&K Brokerage
     C           WL0011    IFEQ 'CKB'                      *IF
     C                     MOVEL*BLANK    YL0031           Email Address
     C                     MOVEL@CN,017   YL0031           Email Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0031           Email Address
     C                     MOVEL@CN,018   YL0031           Email Address
     C                     END                             *FI
     C                     END                             *FI
      * R16637 DN 10/23/20-If in Test Env, Use Test Email DL.
      * CASE: LCL.@Library List Code is Not PRKFLIB
     C           YL0027    IFNE @CN,004                    *IF
     C                     MOVEL*BLANK    YL0031           Email Address
     C                     MOVEL@CN,019   YL0031           Email Address
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0032           Company Number
     C                     MOVELWL0010    YL0032           Company Number
     C                     MOVEL*BLANK    YL0033           Text USR 7
     C                     MOVELWUHODT    YL0033           Text USR 7
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0033    WQ0200 10        Date From Conve
     C           WUTAT1    PARM *BLANK    WQ0201 11        Date To Convert
     C                     PARM '*CYMD'   WQ0202  8        Date From Forma
     C                     PARM '*MDYY'   WQ0203  8        Date To Format
     C                     PARM '/'       WQ0204  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  WCBCNA:ZQ YL0034    P      Subject Line US
     C                     Z-ADD1         ZQ      50
     C           WUTAT1    CAT  @CN,007:ZQYL0035    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0035    CAT  @CN,008:ZQYL0035    P      Pager Msg 256 U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0035    CAT  @CN,009:ZQYL0035    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0035    CAT  YL0032:ZQ YL0035    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0035    CAT  @CN,010:ZQYL0035    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0035    CAT  @CN,011:ZQYL0035    P      Pager Msg 256 U
     C                     Z-ADD1         ZQ      50
     C           YL0035    CAT  @CN,012:ZQYL0035    P      Pager Msg 256 U
      * CLP Exe ESNDMAIL Cmd   UP - /UT User Programs  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM YL0036    WQ0205  7        Return Code Usr
     C                     PARM YL0031    WQ0206 50        Email Address
     C                     PARM YL0034    WQ0207100        Subject Line US
     C                     PARM YL0035    WQ0208256        Pager Msg 256 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * * If Live w/TPM = "N" or "P" then create order and load. E004019
      * * If Live w/TPM = "Y" then create orders only
      *      but if live with DOM/EX only, still created the loads here
      * * Crt Upload Orders - Based on - Live w/TPM flag (for Domestic)
      * CASE: PAR.Live with TPM is Not Yes
     C           WL0012    IFEQ 'N'                        *IF
     C           WL0012    OREQ 'P'
      * CRT Domestic Auto Ords XF - Customer Price Header  * 
     C                     CALL 'PBO8XFR'              90  Zzz Domestic Au
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0209 155       Company Number
     C                     PARM WCBKC7    WQ0210 155       Customer Number
     C                     PARM WUHODT    WQ0211 155       Date 1
     C                     PARM WUHODT    WQ0212 155       Date 2
     C                     PARM WUNYDT    WQ0213 155       From Date Pass
     C           YL0029    PARM YL0029    WQ0214 155       Order Number 1
     C           YL0028    PARM YL0028    WQ0215 155       System Value Nu
     C                     PARM WCAJCD    WQ0216  3        Warehouse Code
     C                     PARM WCBVTM    WQ0217 155       Item Code PASS
     C                     PARM 'U'       WQ0218  1        Change Flag USR
     C                     PARM YL0030    WQ0219 30        Customer Name
     C                     PARM WCBCNA    WQ0220 15        Customer Purcha
     C                     PARM WCRINY    WQ0221  40       Days to Age  Pa
     C                     PARM YL0037    WQ0222 155       Date 4 RGF   Pa
     C                     PARM YL0038    WQ0223 155       Date 4 RGT   Pa
     C                     PARM WCHHAA    WQ0224  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBO8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Dom Auto Ords Only XF - Customer Price Header  * 
     C                     CALL 'PBQQXFR'              90  CRT Dom Auto Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0225 155       Company Number
     C                     PARM WCBKC7    WQ0226 155       Customer Number
     C                     PARM WUHODT    WQ0227 155       Date 1
     C                     PARM WUHODT    WQ0228 155       Date 2
     C                     PARM WUNYDT    WQ0229 155       From Date Pass
     C           YL0029    PARM YL0029    WQ0230 155       Order Number 1
     C           YL0028    PARM YL0028    WQ0231 155       System Value Nu
     C                     PARM WCAJCD    WQ0232  3        Warehouse Code
     C                     PARM WCBVTM    WQ0233 155       Item Code PASS
     C                     PARM 'U'       WQ0234  1        Change Flag USR
     C                     PARM YL0030    WQ0235 30        Customer Name
     C                     PARM WCBCNA    WQ0236 15        Customer Purcha
     C                     PARM WCRINY    WQ0237  40       Days to Age  Pa
     C                     PARM YL0037    WQ0238 155       Date 4 RGF   Pa
     C                     PARM YL0038    WQ0239 155       Date 4 RGT   Pa
     C                     PARM WCHHAA    WQ0240  6        Broker Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBQQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Default printer to Sales, Domestic, don't put on hold
      * CASE: PAR.Broker Code is C&K Brokerage
     C           WL0011    IFEQ 'CKB'                      *IF
     C                     MOVEL@CN,020   WUWICD           Company Value C
     C                     ELSE
      * CASE: PAR.Broker Code is JETRO Broker
     C           WL0011    IFEQ 'JETRO'                    *IF
     C                     MOVEL@CN,021   WUWICD           Company Value C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,020   WUWICD           Company Value C
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WUBCSX           Hold
     C                     MOVEL'*NO'     WUBCSX           Hold
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0241  30       Company Number
     C                     PARM WUWICD    WQ0242 10        Company Value C
     C           WUDEV     PARM *BLANK    WQ0243 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM WCAIC3    WQ0244 155       Company Number
     C                     PARM YL0029    WQ0245 155       Order Number 1
     C                     PARM YL0029    WQ0246 155       Order Number 2
     C                     PARM *ZERO     WQ0247 155       Date 1
     C                     PARM *ZERO     WQ0248 155       Date 2
     C                     PARM *ZERO     WQ0249 155       Thru Date Pass
     C                     PARM *BLANK    WQ0250  2        Order Type_Sale
     C                     PARM WUOTTX    WQ0251  2        Shipping Method
     C                     PARM '1'       WQ0252  1        Billing Activit
     C                     PARM 'A'       WQ0253  1        Export Sales
     C                     PARM *BLANK    WQ0254  3        USR Warehouse C
     C                     PARM *BLANK    WQ0255  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0256  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0257  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0258  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0259  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0260  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0261  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0262  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0263  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0264  1        USR Select/Omit
     C                     PARM WUDEV     WQ0265 10        PRT Printer Dev
     C                     PARM WUBCSX    WQ0266  4        PRT Hold Output
     C                     PARM '*YES'    WQ0267  4        PRT Save Output
     C                     PARM 1         WQ0268 155       System Value Nu
     C                     PARM *BLANK    WQ0269 10        PRT Night Queue
     C                     PARM *ZERO     WQ0270 155       Date 3
     C                     PARM *BLANK    WQ0271  1        Email To Whs
     C                     PARM *BLANK    WQ0272  3        Email to Wareho
     C                     PARM 'N'       WQ0273  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * RTV Order Qty/Wgt TotalRT - Order Header TRG  * 
     C                     EXSR SERVGN
      * EDT Post Open Orders 2 XF - Order Header TRG  * 
     C                     CALL 'POI4XFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0274  30       Company Number
     C                     PARM YL0029    WQ0275  70       Order Number
     C                     PARM WCBKC7    WQ0276  70       Ship To Custome
     C           YL0039    PARM YL0039    WQ0277 112       Order Value Tot
     C           YL0040    PARM *ZERO     WQ0278 112       Order Weight To
     C                     PARM *BLANK    WQ0279  6        USR Country Cod
     C                     PARM WCAJCD    WQ0280  3        USR Warehouse C
     C                     PARM 'OE'      WQ0281  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSD     READE@HGCPTP                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Order Qty/Wgt TotalRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDYL0029    WDC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDJZVA    YL0039           Order Value Tot
     C                     Z-ADDWDA1WG    YL0040           Order Weight To
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Changes and Comments
      *================================================================
      * * E7353 LJB 10/6/2016   Use this for other domestic customers. Th
      *      must have a Broker Code, even if it is one that does not hav
      *      customers assigned to it. This code will group customers
      *      together to process at one time
      * * E004019 RMC 07/13/2016    Retrieve PFS Interface value TMSLDP f
      *                         "Live w/TPM" value
      * * E004019 LJB 03/20/2015    Retrieve "Live w/TPM" flag. If =Y the
      * *    call pgm that does not create the load header & detail
      * *    If "N" or "P" then call the pgm that creates order and load
      * * E003326 LJB 08/22/2014    Pass in the Broker Code. Domestic ord
      * *    are now being created using this function
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Comments and changes
      *================================================================
      * ** Creates Load & Order records for Domestic customers
      * ** This function is called from the network by an SSIS function
      * ** Default Load ID and Order Number to zeros for this procedure
      * ** Put Price Code into the Item Code PASS USR field
      * ** Format the CYYMMDD date from the 26 char date passed from SSIS
      * ** Default printer to Sales, Domestic, don't put on hold
      * * If Live w/TPM = "N" or "P" then create order and load. E004019
      * * If Live w/TPM = "Y" then create orders only
      *      but if live with DOM/EX only, still created the loads here
      * ** Determine printer using the Broker Code
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Live with TPM
     C                     MOVEL*BLANK    WUO1ST  1
      * Define work field PFS AccuSort Active
     C                     MOVEL*BLANK    WUWSSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WARINY           Item Age Days
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Define work field Text 2
     C                     MOVEL*BLANK    WUHKT1  2
      * Define work field Text 2 Length USR
     C                     MOVEL*BLANK    WUW2TX  2
      * Define work field Text 10A USR
     C                     MOVEL*BLANK    WUK1TX 10
      * Define work field Text usr 11
     C                     MOVEL*BLANK    WUTAT1 11
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Number Value - 7
     C                     Z-ADD*ZERO     WUODNB  70
      * Define work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     WUHODT  70
      * Define work field Req Delivery Date
     C                     Z-ADD*ZERO     WUNYDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBM8NB           System Value Nu
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Hold
     C                     MOVEL*BLANK    WUBCSX  5
      * Define work field Printer Device
     C                     MOVEL*BLANK    WUDEV  10
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Company Value Code Usr
     C                     MOVEL*BLANK    WUWICD 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A_R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  7
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007 10
     C                     MOVEL*BLANK    WL0008 10
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0009  7
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  6
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0001 155
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0002 155
      * Define local work field Reference Field
     C                     MOVEL*BLANK    YL0003 15
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0004 50
      * Define local work field Library List Code
     C                     MOVEL*BLANK    YL0005 10
      * Define null work field @Library List Code
     C                     MOVEL*BLANK    YN0001 10
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0007  7
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0008100
      * Define local work field Pager Msg 256 USR
     C                     MOVEL*BLANK    YL0009256
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0010  7
      * Define local work field Date 4 RGF   Pass
     C                     Z-ADD*ZERO     YL0011 155
      * Define local work field Date 4 RGT   Pass
     C                     Z-ADD*ZERO     YL0012 155
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0013 155
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0014 155
      * Define local work field Reference Field
     C                     MOVEL*BLANK    YL0015 15
      * Define local work field ED Shipping Marks Txt
     C                     MOVEL*BLANK    YL0016 15
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0017 50
      * Define local work field Library List Code
     C                     MOVEL*BLANK    YL0018 10
      * Define null work field @Library List Code
     C                     MOVEL*BLANK    YN0002 10
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0020  7
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0021100
      * Define local work field Pager Msg 256 USR
     C                     MOVEL*BLANK    YL0022256
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0023  7
      * Define local work field Date 4 RGF   Pass
     C                     Z-ADD*ZERO     YL0024 155
      * Define local work field Date 4 RGT   Pass
     C                     Z-ADD*ZERO     YL0025 155
      * Define local work field Library List Code
     C                     MOVEL*BLANK    YL0026 10
      * Define local work field @Library List Code
     C                     MOVEL*BLANK    YL0027 10
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0028 155
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0029 155
      * Define local work field Reference Field
     C                     MOVEL*BLANK    YL0030 15
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0031 50
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0033  7
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0034100
      * Define local work field Pager Msg 256 USR
     C                     MOVEL*BLANK    YL0035256
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0036  7
      * Define local work field Date 4 RGF   Pass
     C                     Z-ADD*ZERO     YL0037 155
      * Define local work field Date 4 RGT   Pass
     C                     Z-ADD*ZERO     YL0038 155
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0039 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0040 112
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DL PDINETCT_Test
00002 DTALIB
00003 HISLIB
00004 PRKFLIB
00005 DL PDINETCT
00006 Order not created for
00007 - Scheduled
00008 Ship Date is too old-Orde
00009 r not created for Company
00010 . Delete old record
00011 from AS400 before
00012 recreating orders.
00013 - TEST
00014 JPNPRINTER
00015 Not Required
00016 DL PRKPRD
00017 DL PUBLIX
00018 DL JETRO
00019 DL PRKDEV
00020 DOMPRINTER
00021 JETPRINTER
