// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLACXFR
// ?Date: 14.08.2025 Time: 03:42:27
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(UPD Alloc Frt one time RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1788192;
{
 //?USER: Process Data record

 CASE;

 // IF DB1.LH Carrier Payment Sts is Paid
 IF DB1.LH_Carrier_Payment_Sts = 'P';

 //?** Calculate total freight from Load Freight Charge file
 EXECUTE FUNCTION(Rtv Act/Tot Amount    RT) TYPE(RTVOBJ) FILE(POBCCPP)           AC1889266;
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Rated_Freight);
 PARAMETER(LCL.Actual_Frt_Tot_USR);
 PARAMETER(LCL.Total_Freight_USR);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  // PAR.Actual Frt Tot USR = PAR.Rated Freight
  PAR.Actual_Frt_Tot_USR = PAR.Rated_Freight;

  // PAR.Total Freight USR = PAR.Rated Freight
  PAR.Total_Freight_USR = PAR.Rated_Freight;

  //?USER: Process Data record

  //?Total Freight
  CASE;

  // IF DB1.LFC Tot Freight Inc Sts is Yes
  IF DB1.LFC_Tot_Freight_Inc_Sts = 'Y';

  // PAR.Total Freight USR = PAR.Total Freight USR + DB1.LFC Amount
  PAR.Total_Freight_USR = PAR.Total_Freight_USR + DB1.LFC_Amount;

  ENDIF;

  //?Actual Freight
  CASE;

  // IF DB1.LFC Act Frt Include Sts is Yes
  IF DB1.LFC_Act_Frt_Include_Sts = 'Y';

  // PAR.Actual Frt Tot USR = PAR.Actual Frt Tot USR + DB1.LFC Amount
  PAR.Actual_Frt_Tot_USR = PAR.Actual_Frt_Tot_USR + DB1.LFC_Amount;

  ENDIF;

 }

 //?** Update Order Header with Air Freight Amount and Actual Freight
 //?** Allocation Amount for each order on the Load.
 //?** Then update each Sales History detail record with the freight
 //?** allocated to it.
 // Call program UPD Alloc Frt to Hist  XF.
 CALL PROGRAM(UPD Alloc Frt to Hist  XF) ('PLABXFR');
 PARAMETER(DB1.Load_ID);
 PARAMETER(LCL.Actual_Frt_Tot_USR);
 PARAMETER(LCL.Total_Freight_USR);

 ENDIF;

}


