// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PVK5XFR
// ?Date: 14.08.2025 Time: 03:52:25
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV ASN rental pallet  RT) TYPE(RTVOBJ) FILE(ECP042)           AC2243807;
PARAMETER(PAR.EDI_SURROGATE_NUMBER);
PARAMETER(PAR.REF02_Ref_ID_Load_ID);
PARAMETER(PAR.TRADE_PARTNER_CODE);
PARAMETER(PAR.PRF01_Customer_PO);
PARAMETER(PAR.Order_Number_Alpha);
PARAMETER(PAR.USR_Return_Code);
{
 //?USER: Initialize routine

 // PAR.USR Return Code = CND.Not Returned
 PAR.USR_Return_Code = *BLANK;

 // LCL.Match Found USR = CND.No
 LCL.Match_Found_USR = 'N';

 //?USER: Process Data record

 // Execute function Eus Search for Order # US.
 EXECUTE FUNCTION(Eus Search for Order # US) TYPE(EXCUSRSRC) ('PVK6UFR');
 PARAMETER(DB1.Orders_on_PO_TXT);
 PARAMETER(PAR.Order_Number_Alpha);
 PARAMETER(LCL.Match_Found_USR);
 {
  ‚*--------------------------------------------------------------------*
  ‚* SYSTEM:      OMS PRODUCTION
  ‚* PROGRAM:     NA
  ‚* TITLE:       Validate order is present in EDI
  ‚* PROGRAMMER:  Jagdish
  ‚* CREATED:     06/19/2025
  ‚* Scan for Order Number in field 'Orders on PO - TXT' &
  ‚* Set Match Found Flag.
  ‚* This is RP4 EXCUSRSRC & it will validate if order is present in PO -TXT
  ‚*--------------------------------------------------------------------*
  D$order_number    S              7    Inz
  Dwkstring         DS                  qualified Inz
  D  wkOrder                       7    Dim(5)
  Dwkpos            S              3  0 Dim(5) Inz
  DwkCnt            S              3  0        Inz
  /free

  wkstring      =  #INVU1;
  $order_number =  #IE7TX;

  wkpos = %scan($order_number:wkstring.wkOrder(*));
  #OMLSC = 'N';
  Dow wkCnt < 5;
  wkCnt += 1;
  If wkpos(wkCnt) > 0 ;
  #OMLSC = 'Y';
  Leave;
  EndIf;
  EndDo;
  /end-free
 }

 CASE;

 // IF LCL.Match Found USR is Yes
 IF LCL.Match_Found_USR = 'Y';

 // PAR.USR Return Code = CND.Exists
 PAR.USR_Return_Code = 'E';

 QUIT;

 ENDIF;

}


