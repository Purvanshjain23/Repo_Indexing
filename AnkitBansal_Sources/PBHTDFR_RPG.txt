     H/TITLE WW Pre-Inv Shipped Or DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/07/19  Time  : 09:46:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPBHTDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Pre-Inv Shipped Or DF  Display file
      *
     FOPBFCPLVIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Co Order#/Shipped
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLHCPLJIF  E           K        DISK
      * RSQ : Load Order Change Log     Create Date(D)/Time/Seq
      *
     FPDLHCPL9IF  E           K        DISK
      * RSQ : Load Order Change Log     Load ID/Seg Num-1
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDLHCPL0IF  E           K        DISK                      A
      * UPD : Load Order Change Log     Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 036  5 0A
     E                    W0END   7 036  5 0A
     E                    W0NAM   7 036 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@LHCPQR
      * Load Order Change Log     Load ID/Seg Num-1
      * Renamed input format fields
     I              LHK4DT                          WCK4DT
     I              LHA1TM                          WCA1TM
     I              LHDXNB                          WCDXNB
     I              LHRMNB                          WCRMNB
     I              LHRVNB                          WCRVNB
     I              LHRVST                          WCRVST
     I              LHUJST                          WCUJST
     I              LHMNTX                          WCMNTX
     I              LHMOTX                          WCMOTX
     I              LHAYNA                          WCAYNA
     I              LHA0NA                          WCA0NA
     I              LHBZNA                          WCBZNA
     I              LHXMCD                          WCXMCD
     I              LHAIC3                          WCAIC3
     I              LHC4NB                          WCC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WDK4DT
     I              LHA1TM                          WDA1TM
     I              LHDXNB                          WDDXNB
     I              LHRMNB                          WDRMNB
     I              LHRVNB                          WDRVNB
     I              LHRVST                          WDRVST
     I              LHUJST                          WDUJST
     I              LHMNTX                          WDMNTX
     I              LHMOTX                          WDMOTX
     I              LHAYNA                          WDAYNA
     I              LHA0NA                          WDA0NA
     I              LHBZNA                          WDBZNA
     I              LHXMCD                          WDXMCD
     I              LHAIC3                          WDAIC3
     I              LHC4NB                          WDC4NB
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      * Outward parameters
     IPARC        DS                             10
      * KEY : Order Header TRG          Co/Order Decend/Date Ord
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Order Number
     I                                    P   3   60PAC4NB
      * I : RST Order Date
     I                                    P   7  100PAA0DT
      *
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WDK4DT
     I              LHA1TM                          WDA1TM
     I              LHDXNB                          WDDXNB
     I              LHRMNB                          WDRMNB
     I              LHRVNB                          WDRVNB
     I              LHRVST                          WDRVST
     I              LHUJST                          WDUJST
     I              LHMNTX                          WDMNTX
     I              LHMOTX                          WDMOTX
     I              LHAYNA                          WDAYNA
     I              LHA0NA                          WDA0NA
     I              LHBZNA                          WDBZNA
     I              LHXMCD                          WDXMCD
     I              LHAIC3                          WDAIC3
     I              LHC4NB                          WDC4NB
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            779
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     IYCRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  System Date Format
     I                                       15  17 P1B8NA
      * N :  User Profile Name
     I                                       18  27 P1AJVN
      * N :  Allow Multi-Company
     I                                       28  28 P1I6ST
      * N :  Default Printer
     I                                       29  38 P1MPNA
      * N :  First Time Flag
     I                                       39  39 P1TAST
     IP2PARM      DS
      * N :  USR First Line on Screen
     I                                    P   1   40P2PLUF
     IP3PARM      DS
      * FLD: Order Header TRG
      * N :  Customer Purchase Order #
     I                                        1  15 P3BCNA
      * N :  Order Date
     I                                    P  16  190P3A0DT
      * N :  Header Status
     I                                       20  20 P3GWST
      * N :  Sales Route Code
     I                                       21  23 P3R4CD
      * N :  Event Code
     I                                       24  25 P3JPCD
      * N :  Billing Activity Type
     I                                       26  26 P3OBST
     IP4PARM      DS
      * N :  USR Status (Y/N)
     I                                        1   1 P4E6ST
     IP5PARM      DS
      * N :  USR Company Number
     I                                    P   1   20P5FKNB
     IP6PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P6G3TX
      * N : MAP PRT Printer Device
     I                                       26  35 P6WRST
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P6WSST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P6WTST
      * N : MAP PRT Number of Copies
     I                                       44  450P6DYNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P6WUST
      * N : MAP PRT Night Queue
     I                                       47  56 P6BVVN
      * N : MAP Company Number Pass   USR
     I                                    P  57  645P6AJAA
      * N : MAP Order Number 1  PASS  USR
     I                                    P  65  725P6AJAE
      * N : MAP System Value Numeric
     I                                    P  73  805P6M8NB
      * N : MAP Ship to Customer Pass USR
     I                                    P  81  885P6SHTC
     IP7PARM      DS
      * N :  USR Check Y/N Status
     I                                        1   1 P7JDST
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(SHPNO-    1 256 #S0001
     I              'TINV) JOBD(*USRPRF) '
     I            DS
     I I            'SBMJOB     JOB(LOGAC-    1 256 #S0002
     I              'TSHP) JOBD(*USRPRF) '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Company reqd for Sprdshts'
      * Company
     I                                        1   3 ZA0001
      * Message data for 'Company reqd for Sprdshts'
      * Company
     I                                        1   3 ZA0002
      * Message data for 'Inv date chg-too far out'
      * Actual Ship Date Usr
     I                                    P   1   40ZA0003
      * Message data for 'Inv date change. Rev wkcl'
      * Actual Ship Date Usr
     I                                    P   1   40ZA0004
      * Message data for 'Date must be entered'
      * Message data for 'New date not different'
      * Actual Ship Date Usr
     I                                    P   1   40ZA0005
      * Actual Ship Date
     I                                    P   5   80ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0009
      * Application Code
     I                                       11  16 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time Through Program
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     MOVEL'N'       #CB8ST           Status - Y or N
      * Rtv Prior Saturday    RT - Calendar  * 
     C                     EXSR SARVGN
      * *Set Cursor: CTL.Order Number  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD013       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEBKC7           Ship To Custome
     C                     KFLD           BER4CD           Sales Route Cod
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C                     Z-ADD#2BKC7    BEBKC7
     C                     MOVEL#2R4CD    BER4CD
     C           KPOS      SETLL@BFCPZW
     C                     READ @BFCPZW                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2OBST    WZOBST
     C                     MOVEL#2OBST    WZOBST           Billing Activit
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2BCST    WZBCST
     C                     MOVEL#2BCST    WZBCST           Block Order Fla
     C           *LIKE     DEFN #2CONB    WZCONB
     C                     MOVEL#2CONB    WZCONB           Invoice Number
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2U0ST    WZU0ST
     C                     MOVEL#2U0ST    WZU0ST           Price Audit
     C           *LIKE     DEFN #2U1ST    WZU1ST
     C                     MOVEL#2U1ST    WZU1ST           Price Status
     C           *LIKE     DEFN #2R4CD    WZR4CD
     C                     MOVEL#2R4CD    WZR4CD           Sales Route Cod
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2BCNA    WQBCNA           Customer Purcha
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2BCNA    WQBCNA           Customer Purcha
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPZW                  90*
     C  N82                READ @BFCPZW                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,49
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2A0DT    IFNE *ZERO                      Order Date
     C           BEA0DT    CABGT#2A0DT    BB020            Order Date
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           BEBCNA           Customer Purcha
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQBCNA
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABNE1         BB020
     C                     END
     C           #2OBST    IFNE *BLANK                     Billing Activit
     C           BEOBST    CABNE#2OBST    BB020            Billing Activit
     C                     END
     C           #2JNCD    IFNE *BLANK                     Order Type - Sa
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type - Sa
     C                     END
     C           #2BCST    IFNE *BLANK                     Block Order Fla
     C           BEBCST    CABNE#2BCST    BB020            Block Order Fla
     C                     END
     C           #2CONB    IFNE *ZERO                      Invoice Number
     C           BECONB    CABNE#2CONB    BB020            Invoice Number
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2U0ST    IFNE *BLANK                     Price Audit
     C           BEU0ST    CABNE#2U0ST    BB020            Price Audit
     C                     END
     C           #2U1ST    IFNE *BLANK                     Price Status
     C           BEU1ST    CABNE#2U1ST    BB020            Price Status
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2C4NB    OREQ *ZERO                      Order Number
     C           #2BKC7    OREQ *ZERO                      Ship To Custome
     C           #2R4CD    IFNE *BLANK                     Sales Route Cod
     C           BER4CD    CABNE#2R4CD    BB020            Sales Route Cod
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2C4NB    OREQ *ZERO                      Order Number
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C                     END
     C           #2GNDT    IFNE *ZERO                      Actual Shipped
     C           BEGNDT    CABNE#2GNDT    BB020            Actual Shipped
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           BEEIDT    CABNE#2EIDT    BB020            Requested Deliv
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Regular OR only
      * CASE: RCD.Order Type - Sales is Not Regular Order
     C           #1JNCD    IFNE 'OR'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL: Thru ship date
      * CASE: CTL.Thru Date             USR is Entered
     C           #COADT    IFNE *ZERO                      *IF
      * CASE: CTL.Thru Date             USR LT RCD.Actual Shipped Date
     C           #COADT    IFLT #1GNDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Company Number
      * CASE: CTL.Company Number is Equal to zero
     C           #2AIC3    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Company Number EQ CTL.Company Number
     C           BEAIC3    IFEQ #2AIC3                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Sel: Customer Name
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.USR Description - 15 NE WRK.BLANK
     C           #CJUNA    IFNE WUGSTX                     *IF
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEA#CJUNA    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       #CJUNA           LOAD OUTPUT
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM #1BRTX    WQ0001256        USR Qclscan fie
     C                     PARM 30        WQ0002  30       USR Qclscan Len
     C                     PARM 1         WQ0003  30       USR Qclscan Sta
     C                     PARM #CJUNA    WQ0004256        USR Qclscan Mas
     C                     PARM 15        WQ0005  30       USR Qclscan Mas
     C                     PARM '1'       WQ0006  1        USR Qclscan Tra
     C                     PARM '1'       WQ0007  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0008  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0009  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Clc Line on Scrn       US - /UT User Source  * 
0110 C*****  ##RR CONTAINS THE 1ST LINE ON SCREEN                    *****
0124 C*****  ##RRMAX CONTAINS THE LAST LINE ON PRIOR SCREEN          *****
0124 C*****  IF ##RR - ##RRMAX = 1, THIS IS THE FIRST LINE ON SCREEN *****
0125 C           ##RR      SUB  ##RRMX    P2PLUF
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SBRVGN
      * SEL: 1st Warehouse code
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #CAJCD    IFNE *BLANK                     *IF
      * CASE: CTL.Warehouse Code NE RCD.Warehouse Code
     C           #CAJCD    IFNE #RAJCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV Country Code only  RT - Order Detail  * 
     C                     EXSR SDRVGN
     C                     MOVEL#1BRTX    #RW6TX           Customer Name
      * RTV OHE Arrival Dt    RT - Order Header Extension  * 
     C                     EXSR SERVGN
      * SEL: Country Code
      * CASE: CTL.Country Code is Entered
     C           #CKXCD    IFNE *BLANK                     *IF
      * CASE: CTL.Country Code NE RCD.Country Code
     C           #CKXCD    IFNE #RKXCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * 05/23/16 RMC E4119 remove live with tpm check
      * RTV Departure DT/TM   RT - Load Header  * 
     C                     EXSR SFRVGN
      * SEL: Departure Dt=0
      * CASE: CTL.Status - Y or N is yes
     C           #CB8ST    IFEQ 'Y'                        *IF
      * CASE: RCD.Truck Departure Date is Entered
     C           #RKIDT    IFNE *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Departure Dt
      * CASE: CTL.Truck Departure Date is Entered
     C           #CKIDT    IFNE *ZERO                      *IF
      * CASE: CTL.Truck Departure Date NE RCD.Truck Departure Date
     C           #CKIDT    IFNE #RKIDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Departure Tm  >=
      * CASE: CTL.Truck Departure Time is Entered
     C           #CASTM    IFGT *ZERO                      *IF
      * CASE: RCD.Truck Departure Time LT CTL.Truck Departure Time
     C           #RASTM    IFLT #CASTM                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPZW                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Thru Date             USR
      * External date
     C                     Z-ADDVCOADT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #COADT
      * Validate Status - Y or N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CB8ST'  IFEQ YPMTFD
      * Status - Y or N
     C                     MOVEL#CB8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFB8ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFB8ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFB8ST
     C                     ENDSL
     C                     EXFMTZEB8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFB8ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFB8ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CB8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Actual Ship Date Usr
      * External date
     C                     Z-ADDVCT5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #CT5DT
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Price Audit
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2U0ST'  IFEQ YPMTFD
      * Price Audit
     C                     MOVEL#2U0ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFU0ST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZFU0ST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZFU0ST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD3         ZFU0ST
     C           W0INVL    WHEQ 'M'                        M
     C                     Z-ADD4         ZFU0ST
     C                     ENDSL
     C                     EXFMTZEU0ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFU0ST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZFU0ST    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFU0ST    WHEQ 3
     C                     MOVEL'N'       W0INVL           N
     C           ZFU0ST    WHEQ 4
     C                     MOVEL'M'       W0INVL           M
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2U0ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Price Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2U1ST'  IFEQ YPMTFD
      * Price Status
     C                     MOVEL#2U1ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFU1ST
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZFU1ST
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD2         ZFU1ST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFU1ST
     C                     ENDSL
     C                     EXFMTZEU1ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFU1ST    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZFU1ST    WHEQ 2
     C                     MOVEL'U'       W0INVL           U
     C           ZFU1ST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2U1ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Actual Shipped Date
      * External date
     C                     Z-ADDV2GNDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
     C                     Z-ADDXDINDT    #2GNDT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Truck Departure Date
      * External date
     C                     Z-ADDVCKIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     Z-ADDXDINDT    #CKIDT
      * Validate Truck Departure Time
     C                     Z-ADD#CASTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
      * Validate Header Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GWST    W0NSRQ  1        Header Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GWST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1160607   Y2LSNO  70
     C           #2GWST    PARM #2GWST    W0EXVL 25        Header Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZU0ST    CASNE#2U0ST    FBRQRL
     C           WZU1ST    CASNE#2U1ST    FBRQRL
     C           WZR4CD    CASNE#2R4CD    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZGNDT    CASNE#2GNDT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZGWST    CASNE#2GWST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * F4 on Company Number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0010  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * F4 Prompt for Customer Number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Ship To Customer   SR - Customer  * 
     C                     CALL 'PDR5SRR'              90  SEL Ship To Cus
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0011  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
      * F4 Prompt for warehouse code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CAJCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CAJCD    PARM #CAJCD    WQ0012  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     END                             *FI
      * F4 Prompt for Sales Route
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Sales Route Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#2R4CD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL PD Sales Route Act SR - Sales Route  * 
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #2R4CD    PARM #2R4CD    WQ0013  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     END                             *FI
      * F4 Customer name
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.USR Description - 15
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#CJUNA'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 42704 slm add select on shipped to customer name
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0014  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SGRVGN
     C                     MOVELYL0002    #CJUNA           USR Description
     C                     END                             *FI
      * F5 Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F21=Email it
      * CASE: CTL.*CMD key is CF21
     C           *IN21     IFEQ '1'                        *IF
      * Pmt Enter Email Addr  PV - /UT Report Prompts  * 
     C                     CALL 'POWGPVR'              90  Pmt Enter Email
     C                     PARM *BLANK    W0RTN   7
     C           YL0003    PARM YL0003    WQ0015 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POWGPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: CTL.Company Number is Equal to zero
     C           #2AIC3    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0001           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company reqd for Sprdshts'
     C                     MOVEL'USR4505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * Email it
      * CASE:
      *  - c1ORc2
      *   |- c1    : PGM.*Return code is *User QUIT requested
      *   |- c2    : LCL.Email Address is Blank
      *   '-
     C           W0RTN     IFEQ @CN,002                    *IF
     C           YL0003    OREQ *BLANK                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * email SHPNOTINV
     C                     Z-ADD#2AIC3    YL0004           Company Number
      * CASE: CTL.Thru Date             USR is Not Entered
     C           #COADT    IFEQ *ZERO                      *IF
     C                     Z-ADD##JDT     #COADT           Thru Date
     C                     END                             *FI
      * LCL.Date 1          PASS  USR = CTL.Thru Date             USR
     C                     Z-ADD#COADT    YL0005           Date 1
      * SBMJOB: CLP Exec sql SHPNOTINV UP - Order Header TRG  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PBH0UPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELYL0006    #SSTR     P      Return Code Usr
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0005    #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0004    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0003    #SSTR     P      Email Address
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 50        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PBH0UPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBH0UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F22=Email Chg Log for ACTSHP
      * CASE: CTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
      * CASE: CTL.Company Number is Equal to zero
     C           #2AIC3    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0002           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company reqd for Sprdshts'
     C                     MOVEL'USR4505' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0007           From Date
     C                     Z-ADD*ZERO     YL0008           To Date
      * Pmt Enter Email/Dt RngPV - /UT Report Prompts  * 
     C                     CALL 'PBHYPVR'              90  Pmt Enter Email
     C                     PARM *BLANK    W0RTN   7
     C           YL0007    PARM YL0007    WQ0016  70       From Date
     C           YL0008    PARM YL0008    WQ0017  70       To Date
     C           YL0003    PARM YL0003    WQ0018 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBHYPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Email it
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : PGM.*Return code is *User QUIT requested
      *   |- c2    : LCL.Email Address is Blank
      *   |- c3    : LCL.From Date             USR is Zero
      *   |- c4    : LCL.To Date               USR is Zero
      *   '-
     C           W0RTN     IFEQ @CN,002                    *IF
     C           YL0003    OREQ *BLANK                     *OR
     C           YL0007    OREQ *ZERO                      *OR
     C           YL0008    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * email load order change log for type "ACTSHP"
     C                     Z-ADD#2AIC3    YL0004           Company Number
      * LCL.Date 1          PASS  USR = LCL.From Date             USR
     C                     Z-ADDYL0007    YL0005           Date 1
      * LCL.Date 2          PASS  USR = LCL.To Date               USR
     C                     Z-ADDYL0008    YL0009           Date 2
      * SBMJOB: CLP Exec sql ACTSHP  UP - Load Order Change Log  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PBHZUPC '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELYL0006    #SSTR     P      Return Code Usr
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0005    #SPAK  309       Date 1
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0009    #SPAK  309       Date 2
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDYL0004    #SPAK  309       Company Number
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 15        #SLEN   50
     C                     PARM 5         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELYL0003    #SSTR     P      Email Address
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 50        #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PBHZUPC 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBHZUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * thru date change
      * CASE: CTL.Thru Date             USR NE LCL.Thru Date
     C           #COADT    IFNE YL0010                     *IF
     C                     Z-ADD#COADT    YL0010           Thru Date
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * departure date sts
      * CASE: CTL.Status - Y or N NE LCL.Status - Y or N
     C           #CB8ST    IFNE YL0011                     *IF
     C                     MOVEL#CB8ST    YL0011           Status - Y or N
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * description
      * CASE: CTL.USR Description - 15 NE WRK.USR Description - 15
     C           #CJUNA    IFNE WUJUNA                     *IF
     C                     MOVEL#CJUNA    WUJUNA           USR Description
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * whse change
      * CASE: CTL.Warehouse Code NE WRK.Warehouse Code
     C           #CAJCD    IFNE WUAJCD                     *IF
     C                     MOVEL#CAJCD    WUAJCD           Warehouse Code
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * departure change
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.Truck Departure Date NE LCL.Truck Departure Date
      *   |- c2    : CTL.Truck Departure Time NE LCL.Truck Departure Time
      *   '-
     C           #CKIDT    IFNE YL0012                     *IF
     C           #CASTM    ORNE YL0013                     *OR
     C                     Z-ADD#CKIDT    YL0012           Truck Departure
     C                     Z-ADD#CASTM    YL0013           Truck Departure
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * country code change
      * CASE: CTL.Country Code NE LCL.Country Code
     C           #CKXCD    IFNE YL0014                     *IF
     C                     MOVEL#CKXCD    YL0014           Country Code
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Validate NEW actual ship date
      * CASE: CTL.Actual Ship Date Usr is entered
     C           #CT5DT    IFNE *ZERO                      *IF
      * RTV Next Saturday      RT - Calendar  * 
     C                     EXSR SHRVGN
      * New date cant be > week ending date
      * CASE: CTL.Actual Ship Date Usr GT LCL.Week End Date        USR
     C           #CT5DT    IFGT YL0015                     *IF
      * Setup message data for message
      * Convert Actual Ship Date Usr to display format
      * Convert date
     C           1000000   ADD  #CT5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'Inv date chg-too far out'
     C                     MOVEL'USR4587' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * ** New date cannot be in a revenue closed week
      * ** TF812 requires the date in CCYYMMDD format.
      *
     C                     MOVEL*BLANK    WN0001  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0002  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0003  2        Month (Char) US
     C                     MOVEL*BLANK    WN0004  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           #CT5DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0016
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           #CT5DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0017
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           #CT5DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0018
     C                     MOVEL*BLANK    WN0002           Year Alpha (YYY
     C                     MOVELYL0016    WN0002           Year Alpha (YYY
     C                     MOVELYL0017    WN0003           Month (Char) US
     C                     MOVELYL0018    WN0004           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0002    CAT  WN0003:ZQ WN0001    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0001    CAT  WN0004:ZQ WN0001    P      Date (Char-8) U
     C                     MOVE WN0001    WUAHD8           Date Out (8,0)
     C                     MOVEL'N'       P7JDST           USR Check Y/N S
      * VRY Dte is Closed Rev UP - STR TF Functions  * 
     C                     CALL 'TF812'                90  VRY Dte is Clos
     C                     PARM WUAHD8    WQ0019  80       ISC Week Ending
     C           P7JDST    PARM P7JDST    WQ0020  1        Status Flag 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'TF812'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** If the Status flag = "N" then the Revenue Week is still open
      * ** If it is "Y" then the Revenue Week is Closed.
      * ** Posting to a closed Revenue Week is not allowed.
      * ** If Actual Ship Date is in a Closed Revenue Week, dont allow
      * CASE: PAR.USR Check Y/N Status is yes
     C           P7JDST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Actual Ship Date Usr to display format
      * Convert date
     C           1000000   ADD  #CT5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
      * Send message 'Inv date change. Rev wkcl'
     C                     MOVEL'USR4586' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,49
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * 1=Select for date change
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * CASE: CTL.Actual Ship Date Usr is not entered
     C           #CT5DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Date must be entered'
     C                     MOVEL'USR0231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Actual Ship Date Usr EQ RCD.Actual Shipped Date
     C           #CT5DT    IFEQ #1GNDT                     *IF
      * Setup message data for message
      * Convert Actual Ship Date Usr to display format
      * Convert date
     C           1000000   ADD  #CT5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'New date not different'
     C                     MOVEL'USR4584' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 5=Process request for detail
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * CASE: RCD.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * DSP Credit/Debit Memo  DR - OP Order Header  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
     C                     Z-ADD#1A0DT    PAA0DT           Order Date
      *
     C                     CALL 'PDIXD1R'              90  DSP Credit/Debi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDIXD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * DSP Ord Inq Ship Dtl   DF - Order Detail  * 
     C                     CALL 'PDP3DFR'              90  DSP Ord Inq Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0021  30       Company Number
     C                     PARM #1C4NB    WQ0022  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0023  30       Order Sequence
     C           P1DNCD    PARM P1DNCD    WQ0024  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0025  30       Company Number
     C                     PARM #1C4NB    WQ0026  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0027  30       Order Sequence
     C           WUUENB    PARM *ZERO     WQ0028  30       Order Secondary
     C           P1DNCD    PARM P1DNCD    WQ0029  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 8=Process request Ordered vs. Shipped
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * CASE: RCD.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * Send message 'No Shipping Detail CM/DM'
     C                     MOVEL'USR2328' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Order vs. Ship Dtl DF - PD Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0030  30       Company Number
     C                     PARM #1C4NB    WQ0031  70       Order Number
     C                     PARM #1JNCD    WQ0032  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0033  70       Ship To Custome
     C                     PARM #1BRTX    WQ0034 30        Ship To Name
     C                     PARM #1BCNA    WQ0035 15        Customer Purcha
     C                     PARM #1A0DT    WQ0036  70       Order Date
     C                     PARM #1GNDT    WQ0037  70       Actual Shipped
     C                     PARM #1GWST    WQ0038  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0039  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0040  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0041  1        New Customer Ho
     C                     PARM #1R4CD    WQ0042  3        Sales Route Cod
     C                     PARM P1DNCD    WQ0043  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 9=Process Display Dispatch/Tracer request
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * DSP Dispatch/Tracer    DF - OM Load Detail  * 
     C                     CALL 'PDT3DFR'              90  DSP Dispatch/Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0044  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  014       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 16=Display Order Header
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * Dsp Order Header       PV - Order Header TRG  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0045  30       Company Number
     C                     PARM #1C4NB    WQ0046  70       Order Number
     C                     PARM #1BCNA    WQ0047 15        Customer Purcha
     C                     PARM #1CXDT    WQ0048  70       Date of Origina
     C                     PARM #1AFTM    WQ0049  40       Requested Deliv
     C                     PARM P1DNCD    WQ0050  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,49
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * 1=Chg act ship date
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * CASE: CTL.Actual Ship Date Usr is entered
     C           #CT5DT    IFNE *ZERO                      *IF
      * CHG Act Shp Dte + Dtl  IF
      * CHG Act Shp Dte + Dtl  RT - Order Header TRG  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPZW fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V1GNDT
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADD*ZERO     #RXENX           Stop/Drop Usr
     C                     MOVEL*BLANK    #RW6TX           Customer Name
     C                     MOVEL*BLANK    #RKTNA           USR Customer Na
     C                     MOVEL*BLANK    #RM2NA           USR Cust. P.O.
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     Z-ADD*ZERO     #RKIDT           Truck Departure
      * Clear external version also
     C                     Z-ADD*ZERO     VRKIDT
     C                     Z-ADD*ZERO     #RASTM           Truck Departure
     C                     MOVEL*BLANK    #RKXCD           Country Code
     C                     Z-ADD*ZERO     #RQYDT           OHE Arrival Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VRQYDT
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP6SHTC    #PSHTC           Ship to Custome
     C                     MOVELP6G3TX    #PG3TX           PRT Description
     C                     MOVELP6WRST    #PWRST           PRT Printer Dev
     C                     MOVELP6WSST    #PWSST           PRT Hold Output
     C                     MOVELP6WTST    #PWTST           PRT Save Output
     C                     Z-ADDP6DYNB    #PDYNB           PRT Number of C
     C                     MOVELP6WUST    #PWUST           PRT Night Queue
     C                     MOVELP6BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP6AJAA    #PAJAA           Company Number
     C                     Z-ADDP6AJAE    #PAJAE           Order Number 1
     C                     Z-ADDP6M8NB    #PM8NB           System Value Nu
     C                     Z-ADD*ZERO     #CXENX           Stop/Drop Usr
     C                     MOVEL*BLANK    #CEVTX           USR Customer Sh
     C                     Z-ADD*ZERO     #2A0DT           Order Date
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     MOVEL*BLANK    #2OBST           Billing Activit
     C                     MOVEL*BLANK    #CM2NA           USR Cust. P.O.
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     MOVEL*BLANK    #2BCST           Block Order Fla
     C                     Z-ADD*ZERO     #2CONB           Invoice Number
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #CLWAA           OHE Intended fo
     C                     Z-ADD*ZERO     #COADT           Thru Date
      * Clear external version also
     C                     Z-ADD*ZERO     VCOADT
     C                     MOVEL*BLANK    #CB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #CT5DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VCT5DT
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2U0ST           Price Audit
     C                     MOVEL*BLANK    #2U1ST           Price Status
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #2R4CD           Sales Route Cod
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CJUNA           USR Description
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     Z-ADD*ZERO     #CKIDT           Truck Departure
      * Clear external version also
     C                     Z-ADD*ZERO     VCKIDT
     C                     Z-ADD*ZERO     #CASTM           Truck Departure
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVEL*BLANK    #CKXCD           Country Code
     C                     Z-ADD*ZERO     #CQYDT           OHE Arrival Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VCQYDT
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1GNDT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #RKIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRKIDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  #RQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRQYDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Thru Date             USR to display format
      * Convert date
     C           1000000   ADD  #COADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCOADT
      * Convert Actual Ship Date Usr to display format
      * Convert date
     C           1000000   ADD  #CT5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCT5DT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #CKIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCKIDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  #CQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCQYDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Prior Saturday    RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSA01           Company Number
     C                     Z-ADD##JDT     AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREPU                    *
     C           KRSSA     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #COADT           Date Out
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Day of Week is Saturday
     C           AFA9ST    IFEQ '7'                        *IF
     C                     Z-ADDAFBCDT    #COADT           Date Out
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     Z-ADD#1C4NB    WQSB02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKAE                    *
     C           KRSSB     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SCRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #RAJCD           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    #1XUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSD01           Company Number
     C                     Z-ADD#1C4NB    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKAE                    *
     C           KRSSD     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RKXCD           Country Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELOMKXCD    #RKXCD           Country Code
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV OHE Arrival Dt    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RQYDT           OHE Arrival Dat
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMQYDT    #RQYDT           OHE Arrival Dat
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Departure DT/TM   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJRMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FJCPSB                    *
     C           KRSSF     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RKIDT           Truck Departure
     C                     Z-ADD*ZERO     #RASTM           Truck Departure
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJKIDT    #RKIDT           Truck Departure
     C                     Z-ADDFJASTM    #RASTM           Truck Departure
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#2BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    YL0002           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Next Saturday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSH01           Company Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSH01           Company Number
     C                     Z-ADD##JDT     WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSH     SETLL@AFREBE                    *
     C           KRSSH     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           Scheduled Ship
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Saturday
     C           WAA9ST    IFEQ '7'                        *IF
     C                     Z-ADDWABCDT    YL0015           Scheduled Ship
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * CHG Act Shp Dte + Dtl  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADD#1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Crt change log:
     C                     MOVEL*BLANK    YL0019           Change Log Prio
     C                     MOVELWBGNDT    YL0019           Change Log Prio
     C                     MOVEL*BLANK    YL0020           Change Log New
     C                     MOVEL#CT5DT    YL0020           Change Log New
      * CRT Load/Order Chg Log IF
      * CASE: PAR.Load ID is Blank
     C           WBRMNB    IFEQ 0                          *IF
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Key           RT - Load Order Change Log  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      * Use system date/time to minimize dup record creation
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0022    PARM *ZERO     WQ0051 155       Current System
     C           YL0023    PARM *ZERO     WQ0052 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0022    WL0001           Created Date
     C                     Z-ADDYL0023    WL0002           Created Time
     C                     Z-ADDYL0021    WL0003           Sequence Number
     C                     Z-ADDWBRMNB    WL0004           Load ID
     C                     Z-ADD0         WL0005           Stop/Drop
     C                     MOVEL'ACTSHP'  WL0006    P      Load Change Typ
     C                     MOVEL'ACC'     WL0007    P      Department Cont
     C                     MOVELYL0019    WL0008    P      Change Log Prio
     C                     MOVELYL0020    WL0009    P      Change Log New
     C                     MOVEL##USR     WL0010    P      User Id
     C                     MOVEL##PGM     WL0011    P      Job Name
     C                     MOVEL*BLANK    WL0012           Carrier Code
     C                     MOVEL*BLANK    WL0013           Carrier Broker
     C                     Z-ADDWBAIC3    WL0014           Company Number
     C                     Z-ADDWBC4NB    WL0015           Order Number
     C                     EXSR SLCRRC
      * Add seconds until it can be added successfully
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
      * LCL.Created Time = LCL.Current System Time
     C                     Z-ADDYL0023    YL0024           Created Time
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,003                    *DOW
      * LCL.Created Time = LCL.Created Time + CON.1 *SECONDS
     C                     Z-ADDYL0024    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C                     ADD  1         XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     YL0024
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0022    WL0001           Created Date
     C                     Z-ADDYL0024    WL0002           Created Time
     C                     Z-ADDYL0021    WL0003           Sequence Number
     C                     Z-ADDWBRMNB    WL0004           Load ID
     C                     Z-ADD0         WL0005           Stop/Drop
     C                     MOVEL'ACTSHP'  WL0006    P      Load Change Typ
     C                     MOVEL'ACC'     WL0007    P      Department Cont
     C                     MOVELYL0019    WL0008    P      Change Log Prio
     C                     MOVELYL0020    WL0009    P      Change Log New
     C                     MOVEL##USR     WL0010    P      User Id
     C                     MOVEL##PGM     WL0011    P      Job Name
     C                     MOVEL*BLANK    WL0012           Carrier Code
     C                     MOVEL*BLANK    WL0013           Carrier Broker
     C                     Z-ADDWBAIC3    WL0014           Company Number
     C                     Z-ADDWBC4NB    WL0015           Order Number
     C                     EXSR SLCRRC
     C                     END                             *ITR
     C                     END                             *FI
      * CHG Act Shp Dte + Dtl  CH - Order Header TRG  * 
     C                     EXSR SMCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0021           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN LHK4DT    WQSJ01           Created Date
     C           *LIKE     DEFN LHA1TM    WQSJ02           Created Time
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Created Date
     C                     KFLD           WQSJ02           Created Time
      * Setup key
     C                     Z-ADD##JDT     WQSJ01           Created Date
     C                     Z-ADD##JTM     WQSJ02           Created Time
      * Establish starting position
     C           KRSSJ     SETLL@LHCPBN                    *
     C           KRSSJ     READE@LHCPBN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0021           Sequence Number
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           LHDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           LHDXNB    ADD  1         YL0021           Sequence Number
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@LHCPBN                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0021           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSK02           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSK02           Load ID
      * Establish starting position
     C           KRSSK     SETLL@LHCPQR                    *
     C           KRSSK     READE@LHCPQR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0021           Sequence Number
     C                     GOTO SKEXIT                     *QUIT
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WCDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WCDXNB    ADD  1         YL0021           Sequence Number
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@LHCPQR                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LHCPN6
     C                     Z-ADDWL0001    WDK4DT           Created Date
     C                     Z-ADDWL0002    WDA1TM           Created Time
     C                     Z-ADDWL0003    WDDXNB           Sequence Number
     C                     Z-ADDWL0004    WDRMNB           Load ID
     C                     Z-ADDWL0005    WDRVNB           Stop/Drop
     C                     MOVELWL0006    WDRVST           Load Change Typ
     C                     MOVELWL0007    WDUJST           Department Cont
     C                     MOVELWL0008    WDMNTX           Change Log Prio
     C                     MOVELWL0009    WDMOTX           Change Log New
     C                     MOVELWL0010    WDAYNA           User Id
     C                     MOVELWL0011    WDA0NA           Job Name
     C                     MOVELWL0012    WDBZNA           Carrier Code
     C                     MOVELWL0013    WDXMCD           Carrier Broker
     C                     Z-ADDWL0014    WDAIC3           Company Number
     C                     Z-ADDWL0015    WDC4NB           Order Number
      *
     C           KLCRSL    KLIST
     C                     KFLD           WDK4DT           Created Date
     C                     KFLD           WDA1TM           Created Time
     C                     KFLD           WDDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSL    SETLL@LHCPN6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2472' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@LHCPN6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Act Shp Dte + Dtl  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0005  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0006  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0007  70       Ship To Custome
     C                     MOVEL*BLANK    WN0008 30        Ship To Name
     C                     MOVEL*BLANK    WN0009 30        Ship To Address
     C                     MOVEL*BLANK    WN0010 30        Ship To Address
     C                     MOVEL*BLANK    WN0011 30        Ship To Address
     C                     MOVEL*BLANK    WN0012 20        Ship To City
     C                     MOVEL*BLANK    WN0013  2        Ship To State C
     C                     MOVEL*BLANK    WN0014 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0015  70       Bill to Custome
     C                     MOVEL*BLANK    WN0016 30        Bill to Name
     C                     MOVEL*BLANK    WN0017 30        Bill to Address
     C                     MOVEL*BLANK    WN0018 30        Bill to Address
     C                     MOVEL*BLANK    WN0019 30        Bill to Address
     C                     MOVEL*BLANK    WN0020 20        Bill to City
     C                     MOVEL*BLANK    WN0021  2        Bill to State C
     C                     MOVEL*BLANK    WN0022 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0023 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0024  70       Order Date
     C                     Z-ADD*ZERO     WN0025  70       Requested Ship
     C                     Z-ADD*ZERO     WN0026  70       Cancel Date
     C                     MOVEL*BLANK    WN0027  2        Terms Code
     C                     MOVEL*BLANK    WN0028 40        Special Instruc
     C                     MOVEL*BLANK    WN0029 40        Special Instruc
     C                     MOVEL*BLANK    WN0030  3        Carrier Code
     C                     MOVEL*BLANK    WN0031  1        Comment Print A
     C                     MOVEL*BLANK    WN0032  1        Comment Print I
     C                     MOVEL*BLANK    WN0033  1        Comment Print P
     C                     MOVEL*BLANK    WN0034  1        Comment Print S
     C                     MOVEL*BLANK    WN0035  3        Reason Code
     C                     MOVEL*BLANK    WN0036  1        Order in Use
     C                     MOVEL*BLANK    WN0037  1        Header Status
     C                     MOVEL*BLANK    WN0038  1        Header Status L
     C                     MOVEL*BLANK    WN0039  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0040  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0041 10        User Original E
     C                     Z-ADD*ZERO     WN0042  70       Date of Origina
     C                     Z-ADD*ZERO     WN0043 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0044 112       Order Weight To
     C                     MOVEL*BLANK    WN0045  1        Credit Hold
     C                     MOVEL*BLANK    WN0046  1        Production Hold
     C                     MOVEL*BLANK    WN0047  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0048  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0049  40       Requested Deliv
     C                     MOVEL*BLANK    WN0050  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0051 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0052  70       Load ID
     C                     Z-ADD*ZERO     WN0053  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0054 112       Rated Freight
     C                     MOVEL*BLANK    WN0055  1        LTL Flag
     C                     MOVEL*BLANK    WN0056  1        Price Audit
     C                     MOVEL*BLANK    WN0057  1        Price Status
     C                     MOVEL*BLANK    WN0058  2        Shipping Method
     C                     MOVEL*BLANK    WN0059  1        Export Status
     C                     MOVEL*BLANK    WN0060  1        Palletize
     C                     MOVEL*BLANK    WN0061  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0062  1        Slip Sheet
     C                     MOVEL*BLANK    WN0063  1        Age Code
     C                     Z-ADD*ZERO     WN0064  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0065  1        Load Type
     C                     Z-ADD*ZERO     WN0066  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0067  1        Load Plan Order
     C                     MOVEL*BLANK    WN0068  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0069  70       Resell Referenc
     C                     MOVEL*BLANK    WN0070 30        Special Comment
     C                     MOVEL*BLANK    WN0071 30        Special Comment
     C                     MOVEL*BLANK    WN0072  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0073  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0074  2        Manager Level C
     C                     MOVEL*BLANK    WN0075  3        VP Level Code
     C                     Z-ADD*ZERO     WN0076  70       Attach to Order
     C                     MOVEL*BLANK    WN0077  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0078  70       Invoice Number
     C                     MOVEL*BLANK    WN0079  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0080  70       Invoice Date
     C                     MOVEL*BLANK    WN0081  2        Event Code
     C                     MOVEL*BLANK    WN0082  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0083  1        Modified Flag
     C                     Z-ADD*ZERO     WN0084 112       A/R order Value
     C                     MOVEL*BLANK    WN0085  1        Billing Activit
     C                     MOVEL*BLANK    WN0086  1        Block Order Fla
     C                     MOVEL*BLANK    WN0087  1        Order Certifica
     C                     Z-ADD*ZERO     WN0088 112       Invoice Order V
     C                     MOVEL*BLANK    WN0089  1        Process Sts for
     C                     MOVEL*BLANK    WN0090  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0091  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0092  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0093  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0094  1        Email Cust On O
     C                     MOVEL*BLANK    WN0095  1        Order Emailed
     C                     MOVEL*BLANK    WN0096  1        Export Docs Go
     C                     MOVEL*BLANK    WN0097  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0098  1        Broker Order St
     C                     MOVEL*BLANK    WN0099  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0100  2        Order Requires
     C                     MOVEL*BLANK    WN0101  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0102  2        Export USDA App
     C                     MOVEL*BLANK    WN0103  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0104  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0105  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0106  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0107  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0108  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0109  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0110  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0111  60       Time of Origina
     C                     Z-ADD*ZERO     WN0112  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0113  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0114  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0115 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0116 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0117 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0118 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0119 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0120  70       Claim Number
     C                     MOVEL*BLANK    WN0121  1        EDI Status 1
     C                     MOVEL*BLANK    WN0122  1        EDI Status 2
     C                     MOVEL*BLANK    WN0123  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0124  60       Job Time
     C                     MOVEL*BLANK    WN0125 10        User Id
     C                     MOVEL*BLANK    WN0126 10        Job Name
     C                     Z-ADD*ZERO     WN0127  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * CHG All Act Ship Date  RT - Order Detail  * 
     C                     EXSR SNRVGN
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WEAIC3           Company Number
     C                     Z-ADDWBC4NB    WEC4NB           Order Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSM    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#CT5DT    WEGNDT           Actual Shipped
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDWEAIC3    PBAIC3           Company Number
     C                     Z-ADDWEC4NB    PBC4NB           Order Number
     C                     MOVELWEJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDWEANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDWEBKC7    PBBKC7           Ship To Custome
     C                     MOVELWEBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWEHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWEHONA    PBHONA    P      Ship To Address
     C                     MOVELWEHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWEHNNA    PBHNNA    P      Ship To City
     C                     MOVELWEDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWECKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWEB0C7    PBB0C7           Bill to Custome
     C                     MOVELWEAETX    PBAETX    P      Bill to Name
     C                     MOVELWEB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWEB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWEB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWEB2NA    PBB2NA    P      Bill to City
     C                     MOVELWEBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWEC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELWEBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWEA0DT    PBA0DT           Order Date
     C                     Z-ADDWEA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWEGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWEACDT    PBACDT           Cancel Date
     C                     MOVELWEAQCD    PBAQCD    P      Terms Code
     C                     MOVELWEB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWEBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWEBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWEGTST    PBGTST    P      Comment Print A
     C                     MOVELWEGVST    PBGVST    P      Comment Print I
     C                     MOVELWEGUST    PBGUST    P      Comment Print P
     C                     MOVELWEQFST    PBQFST    P      Comment Print S
     C                     MOVELWECQCD    PBCQCD    P      Reason Code
     C                     MOVELWEGJST    PBGJST    P      Order in Use
     C                     MOVELWEGWST    PBGWST    P      Header Status
     C                     MOVELWEGXST    PBGXST    P      Header Status L
     C                     MOVELWEGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWEAODT    PBAODT           Scheduled Ship
     C                     MOVELWEAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWECXDT    PBCXDT           Date of Origina
     C                     Z-ADDWEJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWEA1WG    PBA1WG           Order Weight To
     C                     MOVELWEXIST    PBXIST    P      Credit Hold
     C                     MOVELWEXJST    PBXJST    P      Production Hold
     C                     MOVELWEXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWEEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWEAFTM    PBAFTM           Requested Deliv
     C                     MOVELWEE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWEE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWERMNB    PBRMNB           Load ID
     C                     Z-ADDWETBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    PBR1NB           Rated Freight
     C                     MOVELWEPJST    PBPJST    P      LTL Flag
     C                     MOVELWEU0ST    PBU0ST    P      Price Audit
     C                     MOVELWEU1ST    PBU1ST    P      Price Status
     C                     MOVELWEQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWEU2ST    PBU2ST    P      Export Status
     C                     MOVELWEVEST    PBVEST    P      Palletize
     C                     MOVELWEVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWEVGST    PBVGST    P      Slip Sheet
     C                     MOVELWERPCD    PBRPCD    P      Age Code
     C                     Z-ADDWERNNB    PBRNNB           Reefer Temperat
     C                     MOVELWEVDST    PBVDST    P      Load Type
     C                     Z-ADDWEATIN    PBATIN           Attach to Invoi
     C                     MOVELWEU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWEU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWERSRN    PBRSRN           Resell Referenc
     C                     MOVELWEMHNA    PBMHNA    P      Special Comment
     C                     MOVELWEMINA    PBMINA    P      Special Comment
     C                     MOVELWEWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWER4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWEBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWEQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWET3NB    PBT3NB           Attach to Order
     C                     MOVELWESICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWECONB    PBCONB           Invoice Number
     C                     MOVELWECEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWEAWDT    PBAWDT           Invoice Date
     C                     MOVELWEJPCD    PBJPCD    P      Event Code
     C                     MOVELWEXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWEZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWEVRVA    PBVRVA           A/R order Value
     C                     MOVELWEOBST    PBOBST    P      Billing Activit
     C                     MOVELWEBCST    PBBCST    P      Block Order Fla
     C                     MOVELWEBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWEB7VL    PBB7VL           Invoice Order V
     C                     MOVELWEGASX    PBGASX    P      Process Sts for
     C                     MOVELWEGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWEGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWEGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWEFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWEFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWEFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWEFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWEFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWEFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWEFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWEFUSX    PBFUSX    P      Order Requires
     C                     MOVELWEFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWEFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWEFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWEFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWENODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWENPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWENQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWENRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWENSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWEBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWEBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWEBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWEBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWEBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWEH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWEH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDWEH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWEH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDWEH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWEC0C7    PBC0C7           Claim Number
     C                     MOVELWEUVST    PBUVST    P      EDI Status 1
     C                     MOVELWEUWST    PBUWST    P      EDI Status 2
     C                     MOVELWEUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWEAATM    PBAATM           Job Time
     C                     MOVELWEAYNA    PBAYNA    P      User Id
     C                     MOVELWEA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWEAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Actual Ship Dt    RT - Load Header  * 
     C                     EXSR SPRVGN
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * CHG All Act Ship Date  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSN01           Company Number
     C                     Z-ADDWBC4NB    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@BGWKL1                    *
     C           KRSSN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Actual Ship Date   CH - Order Detail  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
     C           KRSSN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Actual Ship Date   CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0128  70       Item Code
     C                     MOVEL*BLANK    WN0129  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0130  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0131  70       Order Group Cod
     C                     MOVEL*BLANK    WN0132  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0133  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0134 112       Billing Detail
     C                     Z-ADD*ZERO     WN0135 112       Billing Detail
     C                     Z-ADD*ZERO     WN0136 112       Billing Detail
     C                     Z-ADD*ZERO     WN0137 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0138  1        Comment Print A
     C                     MOVEL*BLANK    WN0139  1        Comment Print I
     C                     MOVEL*BLANK    WN0140  1        Comment Print P
     C                     MOVEL*BLANK    WN0141  1        Comment Print S
     C                     Z-ADD*ZERO     WN0142 112       Extended Amount
     C                     Z-ADD*ZERO     WN0143  70       Market Pricing
     C                     MOVEL*BLANK    WN0144  3        Commodity Marke
     C                     MOVEL*BLANK    WN0145  3        Date Method Cod
     C                     MOVEL*BLANK    WN0146  3        Price Method Co
     C                     Z-ADD*ZERO     WN0147 114       Price Overage O
     C                     Z-ADD*ZERO     WN0148  70       Contract Number
     C                     MOVEL*BLANK    WN0149  1        Price Status
     C                     Z-ADD*ZERO     WN0150  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0151  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0152  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0153  1        Work Confirm St
     C                     MOVEL*BLANK    WN0154  1        Work Over/Short
     C                     MOVEL*BLANK    WN0155  1        OD Production P
     C                     MOVEL*BLANK    WN0156 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0157 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0158  1        Age Code
     C                     MOVEL*BLANK    WN0159  1        Palletize
     C                     MOVEL*BLANK    WN0160  1        Slip Sheet
     C                     MOVEL*BLANK    WN0161  1        Catch Weight St
     C                     MOVEL*BLANK    WN0162  1        Price Audit
     C                     MOVEL*BLANK    WN0163  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0164  1        Production Date
     C                     Z-ADD*ZERO     WN0165 112       Rated Freight
     C                     Z-ADD*ZERO     WN0166 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0167 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0168 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0169 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0170 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0171 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0172 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0173 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0174 114       Unit Price
     C                     Z-ADD*ZERO     WN0175 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0176 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0177 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0178 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0179  70       Requested Ship
     C                     Z-ADD*ZERO     WN0180  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0181  1        Affect Inventor
     C                     MOVEL*BLANK    WN0182  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0183  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0184  30       Item Structure
     C                     Z-ADD*ZERO     WN0185  30       Item Structure
     C                     Z-ADD*ZERO     WN0186  30       Item Structure
     C                     MOVEL*BLANK    WN0187  2        Item Level
     C                     MOVEL*BLANK    WN0188  2        Quality Level
     C                     MOVEL*BLANK    WN0189  2        Pricing Product
     C                     MOVEL*BLANK    WN0190  2        Season Product
     C                     Z-ADD*ZERO     WN0191  70       Date of Origina
     C                     MOVEL*BLANK    WN0192 10        User Profile Na
     C                     MOVEL*BLANK    WN0193  6        Country Code
     C                     MOVEL*BLANK    WN0194  2        Event Code
     C                     MOVEL*BLANK    WN0195  3        Reason Code
     C                     MOVEL*BLANK    WN0196  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0197  1        Modified Flag
     C                     MOVEL*BLANK    WN0198  1        Substituted Fla
     C                     MOVEL*BLANK    WN0199  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0200 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0201 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0202  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0203  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0204  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0205  1        Affect Commissi
     C                     MOVEL*BLANK    WN0206  1        Affect Pricing
     C                     MOVEL*BLANK    WN0207  1        Released by Use
     C                     MOVEL*BLANK    WN0208  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0209  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0210  3        Production Ware
     C                     MOVEL*BLANK    WN0211  3        OD Price Type
     C                     Z-ADD*ZERO     WN0212  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0213  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0214  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0215  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0216  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0217  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0218  60       Price Code
     C                     Z-ADD*ZERO     WN0219  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0220  60       Substitution Li
     C                     Z-ADD*ZERO     WN0221  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0222 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0223 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0224 112       OD Item Target
     C                     Z-ADD*ZERO     WN0225 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0226 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0227 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0228 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0229 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0230 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0231 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0232 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0233 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0234 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0235  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0236  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0237  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0238 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0239  40       Item Age Days
     C                     Z-ADD*ZERO     WN0240  70       Production Ovr
     C                     Z-ADD*ZERO     WN0241  70       Production Ovr
     C                     MOVEL*BLANK    WN0242  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0243  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0244  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0245  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0246  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0247  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0248  1        EDI Status 1
     C                     MOVEL*BLANK    WN0249  1        EDI Status 2
     C                     MOVEL*BLANK    WN0250  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0251  60       Job Time
     C                     MOVEL*BLANK    WN0252 10        User Id
     C                     MOVEL*BLANK    WN0253 10        Job Name
     C                     Z-ADD*ZERO     WN0254  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
      *
     C           KLCHSO    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSO    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#CT5DT    WGGNDT           Actual Shipped
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd Actual Ship Dt    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WHRMNB           Load ID
      * Setup key
     C                     Z-ADDWERMNB    WHRMNB           Load ID
      * Establish starting position
     C           KRSSP     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Actual Ship Date  CH - Load Header  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Actual Ship Date  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0255  30       Company Number
     C                     Z-ADD*ZERO     WN0256  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0257  1        LTL Flag
     C                     MOVEL*BLANK    WN0258  1        Load Status
     C                     Z-ADD*ZERO     WN0259  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0260 15        Seal 1
     C                     MOVEL*BLANK    WN0261 15        Seal 2
     C                     MOVEL*BLANK    WN0262 15        Seal 3
     C                     MOVEL*BLANK    WN0263 15        Seal 4
     C                     MOVEL*BLANK    WN0264 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0265  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0266 112       Flat Amount
     C                     MOVEL*BLANK    WN0267  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0268  50       Total Stops
     C                     MOVEL*BLANK    WN0269 20        Trailer Id
     C                     MOVEL*BLANK    WN0270  3        Transloader Car
     C                     Z-ADD*ZERO     WN0271  40       BOL Time
     C                     MOVEL*BLANK    WN0272  3        Carrier Code
     C                     MOVEL*BLANK    WN0273  7        Truck Size
     C                     Z-ADD*ZERO     WN0274  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0275 112       Rated Freight
     C                     MOVEL*BLANK    WN0276  1        Ship Status
     C                     MOVEL*BLANK    WN0277  1        Load Type
     C                     Z-ADD*ZERO     WN0278  50       Number Pallets
     C                     Z-ADD*ZERO     WN0279  50       Number Pallets
     C                     Z-ADD*ZERO     WN0280 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0281  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0282  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0283  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0284 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0285 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0286  70       Actual Departur
     C                     Z-ADD*ZERO     WN0287  40       Departure Time
     C                     Z-ADD*ZERO     WN0288  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0289  52       Product Tempera
     C                     Z-ADD*ZERO     WN0290  50       Number Spacers
     C                     MOVEL*BLANK    WN0291 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0292  70       Total Load Mile
     C                     MOVEL*BLANK    WN0293 12        Recorder ID
     C                     MOVEL*BLANK    WN0294  2        Shipping Method
     C                     MOVEL*BLANK    WN0295  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0296  2        Ship To State C
     C                     Z-ADD*ZERO     WN0297  70       Gross Weight
     C                     MOVEL*BLANK    WN0298  3        Carrier Broker
     C                     MOVEL*BLANK    WN0299  1        Export Status
     C                     MOVEL*BLANK    WN0300  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0301  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0302  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0303  70       Spotted Date
     C                     Z-ADD*ZERO     WN0304  60       Spotted Time
     C                     Z-ADD*ZERO     WN0305  70       Load Finished D
     C                     Z-ADD*ZERO     WN0306  60       Load Finished T
     C                     Z-ADD*ZERO     WN0307  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0308  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0309  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0310  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0311  70       Truck Departure
     C                     Z-ADD*ZERO     WN0312  60       Truck Departure
     C                     Z-ADD*ZERO     WN0313  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0314  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0315  3        Shipping Line
     C                     MOVEL*BLANK    WN0316 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0317 30        Vessel Name
     C                     Z-ADD*ZERO     WN0318  50       Voyage
     C                     Z-ADD*ZERO     WN0319  70       Sail Date
     C                     MOVEL*BLANK    WN0320 12        Booking Number
     C                     MOVEL*BLANK    WN0321 20        Discharge Port
     C                     Z-ADD*ZERO     WN0322  70       Arrival Date
     C                     MOVEL*BLANK    WN0323 12        Container Numbe
     C                     Z-ADD*ZERO     WN0324  70       Date In
     C                     Z-ADD*ZERO     WN0325  60       Time In
     C                     Z-ADD*ZERO     WN0326  70       Date Out
     C                     Z-ADD*ZERO     WN0327  60       Time Out
     C                     Z-ADD*ZERO     WN0328 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0329  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0330  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0331  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0332  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0333  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0334  70       Requested Deliv
     C                     MOVEL*BLANK    WN0335  1        Load Acceptance
     C                     MOVEL*BLANK    WN0336  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0337  70       On Yard Date
     C                     Z-ADD*ZERO     WN0338  60       On Yard Time
     C                     Z-ADD*ZERO     WN0339  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0340  60       Deadline Depart
     C                     MOVEL*BLANK    WN0341  1        Load Held Over
     C                     MOVEL*BLANK    WN0342  1        Load Held Over
     C                     MOVEL*BLANK    WN0343 15        Load Held Over
     C                     MOVEL*BLANK    WN0344 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0345 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0346  70       Express Mail Da
     C                     MOVEL*BLANK    WN0347  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0348  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0349  70       Product Complet
     C                     Z-ADD*ZERO     WN0350  60       Product Complet
     C                     Z-ADD*ZERO     WN0351  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0352  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0353  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0354  1        Load Confirmed
     C                     MOVEL*BLANK    WN0355 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0356  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0357  60       Load Door 1
     C                     Z-ADD*ZERO     WN0358  70       Override Total
     C                     Z-ADD*ZERO     WN0359  60       Load Door 2
     C                     MOVEL*BLANK    WN0360  1        Partial Load
     C                     MOVEL*BLANK    WN0361  1        Load Confirmati
     C                     MOVEL*BLANK    WN0362  1        Export Load USD
     C                     MOVEL*BLANK    WN0363  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0364 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0365 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0366 15        Late Billing Em
     C                     MOVEL*BLANK    WN0367 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0368 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0369  1        Multi Company L
     C                     MOVEL*BLANK    WN0370  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0371  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0372  1        LH Power Only L
     C                     MOVEL*BLANK    WN0373  1        MG Created Load
     C                     MOVEL*BLANK    WN0374  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0375  2        Load U/M
     C                     MOVEL*BLANK    WN0376  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0377  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0378  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0379  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0380  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0381  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0382  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0383  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0384  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0385  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0386  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0387  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0388  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0389  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0390  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0391  60       LH Unused Time
     C                     MOVEL*BLANK    WN0392  1        EDI Status 1
     C                     MOVEL*BLANK    WN0393  1        EDI Status 2
     C                     MOVEL*BLANK    WN0394  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0395  60       Job Time
     C                     MOVEL*BLANK    WN0396 10        User Id
     C                     MOVEL*BLANK    WN0397 10        Job Name
     C                     Z-ADD*ZERO     WN0398  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWHRMNB    WIRMNB           Load ID
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHSQ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#CT5DT    WIF9DT           Actual Ship Dat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0399    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSR     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0025           Company Number
     C                     MOVELDRBUVN    WN0400           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0016    DTAJVN           User Profile Na
     C                     MOVELWL0017    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSS     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0018           Company Number
     C                     MOVELDTAJCD    WL0019           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQST01           Application Cod
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Application Cod
      * Setup key
     C                     MOVELP1DNCD    WQST01           Application Cod
      * Establish starting position
     C           KRSST     SETLL@DNRESF                    *
     C           KRSST     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SURVGN
     C                     END                             *FI
     C           KRSST     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSU01           Application Cod
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSU01           Application Cod
      * Establish starting position
     C           KRSSU     SETLL@DNRESF                    *
     C           KRSSU     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03584
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  14        W0CSRR  50
     C           03584     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDEQ064
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CB8ST'  YPMTFD           Status - Y or N
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2U0ST'  YPMTFD           Price Audit
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2U1ST'  YPMTFD           Price Status
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ113
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GWST'  YPMTFD           Header Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P2PLUF           USR First Line
     C                     MOVEL*BLANK    P3BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P3A0DT           Order Date
     C                     MOVEL*BLANK    P3GWST           Header Status
     C                     MOVEL*BLANK    P3R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P3JPCD           Event Code
     C                     MOVEL*BLANK    P3OBST           Billing Activit
     C                     MOVEL*BLANK    P4E6ST           USR Status (Y/N
     C                     Z-ADD*ZERO     P5FKNB           USR Company Num
     C                     MOVEL*BLANK    P6G3TX           PRT Description
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     Z-ADD*ZERO     P6DYNB           PRT Number of C
     C                     MOVEL*BLANK    P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P6AJAA           Company Number
     C                     Z-ADD*ZERO     P6AJAE           Order Number 1
     C                     Z-ADD*ZERO     P6M8NB           System Value Nu
     C                     Z-ADD*ZERO     P6SHTC           Ship to Custome
     C                     MOVEL*BLANK    P7JDST           USR Check Y/N S
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Description - 15
     C                     MOVEL*BLANK    WUJUNA 15
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Date Out (8,0) USR
     C                     Z-ADD*ZERO     WUAHD8  80
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCK4DT           Created Date
     C                     Z-ADD*ZERO     WCA1TM           Created Time
     C                     Z-ADD*ZERO     WCDXNB           Sequence Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WFGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WHFLAM           Flat Amount
     C                     Z-ADD*ZERO     WHRRNB           Total Stops
     C                     Z-ADD*ZERO     WHSBNB           BOL Time
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHSDNB           Number Pallets
     C                     Z-ADD*ZERO     WHPAOU           Number Pallets
     C                     Z-ADD*ZERO     WHDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHHADT           Actual Arrival
     C                     Z-ADD*ZERO     WHAART           Actual Arrival
     C                     Z-ADD*ZERO     WHDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WHDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WHAQDT           Actual Departur
     C                     Z-ADD*ZERO     WHS6NB           Departure Time
     C                     Z-ADD*ZERO     WHT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WHPRTM           Product Tempera
     C                     Z-ADD*ZERO     WHNPSV           Number Spacers
     C                     Z-ADD*ZERO     WHTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WHGRWE           Gross Weight
     C                     Z-ADD*ZERO     WHF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WHJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WHTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WHJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WHSPTM           Spotted Time
     C                     Z-ADD*ZERO     WHJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WHLFTM           Load Finished T
     C                     Z-ADD*ZERO     WHJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WHBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WHJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WHBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WHKIDT           Truck Departure
     C                     Z-ADD*ZERO     WHASTM           Truck Departure
     C                     Z-ADD*ZERO     WHKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WHAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WHVOAG           Voyage
     C                     Z-ADD*ZERO     WHKBDT           Sail Date
     C                     Z-ADD*ZERO     WHEFDT           Arrival Date
     C                     Z-ADD*ZERO     WHKCDT           Date In
     C                     Z-ADD*ZERO     WHTMIN           Time In
     C                     Z-ADD*ZERO     WHKDDT           Date Out
     C                     Z-ADD*ZERO     WHVMNB           Time Out
     C                     Z-ADD*ZERO     WHOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WHLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WHK0DT           Product Complet
     C                     Z-ADD*ZERO     WHAYTM           Product Complet
     C                     Z-ADD*ZERO     WHKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WHICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WHIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WHK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WHAZTM           Load Door 1
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHA0TM           Load Door 2
     C                     Z-ADD*ZERO     WHZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WHPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WHCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WHPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WHCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WHP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WHCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WHP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WHCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  60
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  50
     C                     MOVEL*BLANK    WL0006  6
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008 12
     C                     MOVEL*BLANK    WL0009 12
     C                     MOVEL*BLANK    WL0010 10
     C                     MOVEL*BLANK    WL0011 10
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  3
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0016 10
     C                     MOVEL*BLANK    WL0017  6
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0003 50
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0004 155
      * Define local work field Date 1          PASS  USR
     C                     Z-ADD*ZERO     YL0005 155
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0006  7
      * Define local work field From Date             USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field To Date               USR
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Date 2          PASS  USR
     C                     Z-ADD*ZERO     YL0009 155
      * Define local work field Thru Date             USR
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field Week End Date        USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0016  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0017  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0018  20
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0019 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0020 12
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0022 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0023 155
      * Define local work field Created Time
     C                     Z-ADD*ZERO     YL0024  60
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0025  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0026  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0027  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD10        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'OMS'     P1DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0399 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0399           User Profile Na
      *
     C                     MOVEL*BLANK    WN0400 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SRRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0399    ZA0007           User Profile Na
     C                     MOVELP1DNCD    ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0400    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0399    WL0016    P      User Profile Na
     C                     MOVELP1DNCD    WL0017    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    P1AIC3           Company Number
     C                     MOVELWL0019    YL0026    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0400    WL0016    P      User Profile Na
     C                     MOVELP1DNCD    WL0017    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    P1AIC3           Company Number
     C                     MOVELWL0019    YL0026    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0026    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0399    ZA0009           User Profile Na
     C                     MOVELP1DNCD    ZA0010           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0025    IFNE 0                          *IF
     C                     Z-ADDYL0025    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0026    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0053  3        Warehouse Code
     C                     PARM YL0025    WQ0054  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR STRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADD*ZERO     P2PLUF           USR First Line
     C                     MOVEL'Y'       P1TAST           First Time Flag
     C                     MOVEL'N'       P4E6ST           USR Status (Y/N
     C                     MOVEL##USR     P1AJVN           User Profile Na
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0055  30       Company Number
     C                     PARM *BLANK    WQ0056  1        Plant Company S
     C           YL0027    PARM *BLANK    WQ0057  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Company Organization is Daily's
     C           YL0027    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       P1I6ST           Allow Multi-Com
     C                     END                             *FI
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01052010880156403333033410334603355
03360033650337003375033840340103411
03421034310344103444034520358603589
03597036020361103616036210362603631
03640036570366703677036870369703700
03708
** W0END
01057010880157103339033430335203355
03360033670337203381033980340803418
03428034380344103449034590358703595
03599036080361103616036230362803637
03654036640367403684036940369703705
03715
** W0NAM
VCOADT    #CB8ST    VCT5DT    V2C4NB    V2AIC3    #2RMNB    #2U0ST
#2U1ST    #CAJCD    #2R4CD    V2BKC7    #CJUNA    V2GNDT    V2EIDT
VCKIDT    #CASTM    #2GWST    #CKXCD    VCQYDT    #1SEL     V1C4NB
V1AIC3    #1RMNB    #1U0ST    #1U1ST    #RAJCD    #1R4CD    V1BKC7
#1BRTX    V1GNDT    V1EIDT    VRKIDT    #RASTM    #1GWST    #RKXCD
VRQYDT
** @CN
00001 USR0752
00002 Y2U9999
00003 Y2U0003
00004 Y2U0005
