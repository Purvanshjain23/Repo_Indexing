// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMLYXFR
// ?Date: 14.08.2025 Time: 03:43:24
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Prt Broker Stmt Drivr RT) TYPE(RTVOBJ) FILE(POC5REP)           AC1841917;
PARAMETER(PAR.Payee_Type);
PARAMETER(PAR.Broker_Code);
PARAMETER(PAR.From_Date_USR);
PARAMETER(PAR.To_Date_USR);
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(PAR.Accrual_Code);
PARAMETER(PAR.Print_Yes_No_USR);
PARAMETER(PAR.Company_Number);
{
 //?USER: Process Data record

 CASE;

 // IF PAR.Broker Code is Not entered
 IF PAR.Broker_Code = *BLANK;

 // OR DB1.Broker Code EQ PAR.Broker Code
 OR DB1.Broker_Code = PAR.Broker_Code;

 EXECUTE FUNCTION(Prt Broker Stmt Drivr RT) TYPE(RTVOBJ) FILE(OMHRCPP)           AC1841936;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Ship_To_Customer);
 PARAMETER(DB1.Broker_Code);
 PARAMETER(PAR.Accrual_Code);
 PARAMETER(PAR.From_Date_USR);
 PARAMETER(PAR.To_Date_USR);
 PARAMETER(LCL.Record_Selected_USR);
 {
  //?USER: Processing if Data record not found

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  //?USER: Process Data record

  // PAR.Record Selected       USR = CND.yes
  PAR.Record_Selected_USR = 'Y';

  //?Record Selected??
  CASE;

  // IF DB1.SDA Actual Ship Date GE PAR.From Date             USR
  IF DB1.SDA_Actual_Ship_Date >= PAR.From_Date_USR;

  // AND DB1.SDA Actual Ship Date LE PAR.To Date               USR
  AND DB1.SDA_Actual_Ship_Date <= PAR.To_Date_USR;

  //?SEL: Broker Entered
  CASE;

  // IF DB1.Broker Code is Not entered
  IF DB1.Broker_Code = *BLANK;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  //?SEL: Company
  CASE;

  // IF PAR.Company Number is greater than zero
  IF PAR.Company_Number > *ZERO;

  EXECUTE FUNCTION(RTV Whse Acct Co      RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC1809259;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(LCL.Accounting_Company);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   EXECUTE FUNCTION(Rtv Acct Co          RT) TYPE(RTVOBJ) FILE(CAADREP)            AC1802492;
   PARAMETER(DB1.Warehouse_Code);
   PARAMETER(PAR.Accounting_Company);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   QUIT;

  }

  CASE;

  // IF PAR.Company Number NE LCL.Accounting Company
  IF PAR.Company_Number <> LCL.Accounting_Company;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  ENDIF;

  //?SEL: Broker
  CASE;

  // IF PAR.Broker Code is Entered
  IF PAR.Broker_Code <> *BLANK;

  // AND DB1.Broker Code NE PAR.Broker Code
  AND DB1.Broker_Code <> PAR.Broker_Code;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  //?SEL: Accrual Code
  CASE;

  // IF PAR.Accrual Code is Entered
  IF PAR.Accrual_Code <> *BLANK;

  // AND DB1.Accrual Code NE PAR.Accrual Code
  AND DB1.Accrual_Code <> PAR.Accrual_Code;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  //?SEL: Ship To Customer
  CASE;

  // IF PAR.Ship To Customer is not equal to zero
  IF PAR.Ship_To_Customer <> *ZERO;

  // AND DB1.Ship To Customer NE PAR.Ship To Customer
  AND DB1.Ship_To_Customer <> PAR.Ship_To_Customer;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  //?Record Selected??
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Record Selected       USR = CND.no
  PAR.Record_Selected_USR = 'N';

  ENDIF;

  //?Quit if 1 rcd is found
  CASE;

  // IF PAR.Record Selected       USR is yes
  IF PAR.Record_Selected_USR = 'Y';

  QUIT;

  ENDIF;

 }

 CASE;

 // IF LCL.Record Selected       USR is yes
 IF LCL.Record_Selected_USR = 'Y';

 // Call program Prt Broker Perf       PF.
 CALL PROGRAM(Prt Broker Perf       PF) ('PPBEPFR');
 PARAMETER(PAR.Ship_To_Customer);
 PARAMETER(DB1.Broker_Code);
 PARAMETER(PAR.Accrual_Code);
 PARAMETER(PAR.From_Date_USR);
 PARAMETER(PAR.To_Date_USR);
 PARAMETER(PAR.Print_Yes_No_USR);
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Payee_Type);

 ENDIF;

 ENDIF;

}


