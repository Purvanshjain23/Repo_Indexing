     H/TITLE TST Load UnConfirmed      Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Display file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 10/05/07  Time  : 16:24:05
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMOBDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: TST Load UnConfirmed      Display file
      *
     FOMFJCPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Load Header               Retrieval index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
      * Outward parameters
     IPBRC        DS                             18
      * KEY : Load Order Change Log     Ld Id,Dte/Tm/Seq/Ord
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop/Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Order Change Log
      * N :  Load Change Type
     I                                        1   6 P1RVST
      * N :  Department Control Code
     I                                        7   9 P1UJST
      * N :  Change Log Prior Value
     I                                       10  21 P1MNTX
      * N :  Change Log New Value
     I                                       22  33 P1MOTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB
     C           KPOS      SETLL@FJCPBN
     C                     READ @FJCPBN                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2RNNB    WZRNNB
     C                     MOVEL#2RNNB    WZRNNB           Reefer Temperat
     C           *LIKE     DEFN #2DMTX    WZDMTX
     C                     MOVEL#2DMTX    WZDMTX           Seal 1
     C           *LIKE     DEFN #2DNTX    WZDNTX
     C                     MOVEL#2DNTX    WZDNTX           Seal 2
     C           *LIKE     DEFN #2DOTX    WZDOTX
     C                     MOVEL#2DOTX    WZDOTX           Seal 3
     C           *LIKE     DEFN #2WTTX    WZWTTX
     C                     MOVEL#2WTTX    WZWTTX           Seal 1 Unused
     C           *LIKE     DEFN #2WUTX    WZWUTX
     C                     MOVEL#2WUTX    WZWUTX           Seal 2 Unused
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Load Orde
     C           *LIKE     DEFN #2FLAM    WZFLAM
     C                     MOVEL#2FLAM    WZFLAM           Flat Amount
     C           *LIKE     DEFN #2XQST    WZXQST
     C                     MOVEL#2XQST    WZXQST           Allocate Pounds
     C           *LIKE     DEFN #2RRNB    WZRRNB
     C                     MOVEL#2RRNB    WZRRNB           Total Stops
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2DYTX    WZDYTX
     C                     MOVEL#2DYTX    WZDYTX           Initials of Con
     C           *LIKE     DEFN #2SBNB    WZSBNB
     C                     MOVEL#2SBNB    WZSBNB           BOL Time
     C           *LIKE     DEFN #2RONB    WZRONB
     C                     MOVEL#2RONB    WZRONB           Truck Size
     C           *LIKE     DEFN #2SQNB    WZSQNB
     C                     MOVEL#2SQNB    WZSQNB           Ld Hdr/Ld Dtl U
     C           *LIKE     DEFN #2R1NB    WZR1NB
     C                     MOVEL#2R1NB    WZR1NB           Rated Freight
     C           *LIKE     DEFN #2VCST    WZVCST
     C                     MOVEL#2VCST    WZVCST           Ship Status
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2SDNB    WZSDNB
     C                     MOVEL#2SDNB    WZSDNB           Number Pallets
     C           *LIKE     DEFN #2PAOU    WZPAOU
     C                     MOVEL#2PAOU    WZPAOU           Number Pallets
     C           *LIKE     DEFN #2DGWG    WZDGWG
     C                     MOVEL#2DGWG    WZDGWG           Load Carrier Pa
     C           *LIKE     DEFN #2SXNB    WZSXNB
     C                     MOVEL#2SXNB    WZSXNB           Estimated Arriv
     C           *LIKE     DEFN #2HADT    WZHADT
     C                     MOVEL#2HADT    WZHADT           Actual Arrival
     C           *LIKE     DEFN #2AART    WZAART
     C                     MOVEL#2AART    WZAART           Actual Arrival
     C           *LIKE     DEFN #2DHWG    WZDHWG
     C                     MOVEL#2DHWG    WZDHWG           Trailer IN Weig
     C           *LIKE     DEFN #2DIWG    WZDIWG
     C                     MOVEL#2DIWG    WZDIWG           Trailer OUT Wei
     C           *LIKE     DEFN #2AQDT    WZAQDT
     C                     MOVEL#2AQDT    WZAQDT           Actual Departur
     C           *LIKE     DEFN #2S6NB    WZS6NB
     C                     MOVEL#2S6NB    WZS6NB           Departure Time
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2PRTM    WZPRTM
     C                     MOVEL#2PRTM    WZPRTM           Product Tempera
     C           *LIKE     DEFN #2NPSV    WZNPSV
     C                     MOVEL#2NPSV    WZNPSV           Number Pallets
     C           *LIKE     DEFN #2J8TX    WZJ8TX
     C                     MOVEL#2J8TX    WZJ8TX           Car/Veh. Initia
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2J9TX    WZJ9TX
     C                     MOVEL#2J9TX    WZJ9TX           Recorder ID
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2VPCD    WZVPCD
     C                     MOVEL#2VPCD    WZVPCD           Ship From Wareh
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2GRWE    WZGRWE
     C                     MOVEL#2GRWE    WZGRWE           Gross Weight
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2F9DT    WZF9DT
     C                     MOVEL#2F9DT    WZF9DT           Actual Ship Dat
     C           *LIKE     DEFN #2ONTM    WZONTM
     C                     MOVEL#2ONTM    WZONTM           On Time - (Y/N)
     C           *LIKE     DEFN #2J4DT    WZJ4DT
     C                     MOVEL#2J4DT    WZJ4DT           Truck Ready Dat
     C           *LIKE     DEFN #2TRTM    WZTRTM
     C                     MOVEL#2TRTM    WZTRTM           Truck Ready Tim
     C           *LIKE     DEFN #2J5DT    WZJ5DT
     C                     MOVEL#2J5DT    WZJ5DT           Spotted Date
     C           *LIKE     DEFN #2SPTM    WZSPTM
     C                     MOVEL#2SPTM    WZSPTM           Spotted Time
     C           *LIKE     DEFN #2J6DT    WZJ6DT
     C                     MOVEL#2J6DT    WZJ6DT           Load Finished D
     C           *LIKE     DEFN #2LFTM    WZLFTM
     C                     MOVEL#2LFTM    WZLFTM           Load Finished T
     C           *LIKE     DEFN #2J7DT    WZJ7DT
     C                     MOVEL#2J7DT    WZJ7DT           BOL Complete Da
     C           *LIKE     DEFN #2BOTM    WZBOTM
     C                     MOVEL#2BOTM    WZBOTM           BOL Complete Ti
     C           *LIKE     DEFN #2J8DT    WZJ8DT
     C                     MOVEL#2J8DT    WZJ8DT           BOL Received Da
     C           *LIKE     DEFN #2BLTM    WZBLTM
     C                     MOVEL#2BLTM    WZBLTM           BOL Received Ti
     C           *LIKE     DEFN #2KIDT    WZKIDT
     C                     MOVEL#2KIDT    WZKIDT           Truck Departure
     C           *LIKE     DEFN #2ASTM    WZASTM
     C                     MOVEL#2ASTM    WZASTM           Truck Departure
     C           *LIKE     DEFN #2KADT    WZKADT
     C                     MOVEL#2KADT    WZKADT           Adjusted Depart
     C           *LIKE     DEFN #2AJCM    WZAJCM
     C                     MOVEL#2AJCM    WZAJCM           Adjusted Depart
     C           *LIKE     DEFN #2XACD    WZXACD
     C                     MOVEL#2XACD    WZXACD           Shipping Line
     C           *LIKE     DEFN #2OANA    WZOANA
     C                     MOVEL#2OANA    WZOANA           Port Delv Termi
     C           *LIKE     DEFN #2K4TX    WZK4TX
     C                     MOVEL#2K4TX    WZK4TX           Vessel Name
     C           *LIKE     DEFN #2VOAG    WZVOAG
     C                     MOVEL#2VOAG    WZVOAG           Voyage
     C           *LIKE     DEFN #2KBDT    WZKBDT
     C                     MOVEL#2KBDT    WZKBDT           Sail Date
     C           *LIKE     DEFN #2NBBO    WZNBBO
     C                     MOVEL#2NBBO    WZNBBO           Booking Number
     C           *LIKE     DEFN #2W4CD    WZW4CD
     C                     MOVEL#2W4CD    WZW4CD           Discharge Port
     C           *LIKE     DEFN #2EFDT    WZEFDT
     C                     MOVEL#2EFDT    WZEFDT           Arrival Date
     C           *LIKE     DEFN #2CNTN    WZCNTN
     C                     MOVEL#2CNTN    WZCNTN           Container Numbe
     C           *LIKE     DEFN #2KCDT    WZKCDT
     C                     MOVEL#2KCDT    WZKCDT           Date In
     C           *LIKE     DEFN #2TMIN    WZTMIN
     C                     MOVEL#2TMIN    WZTMIN           Time In
     C           *LIKE     DEFN #2KDDT    WZKDDT
     C                     MOVEL#2KDDT    WZKDDT           Date Out
     C           *LIKE     DEFN #2VMNB    WZVMNB
     C                     MOVEL#2VMNB    WZVMNB           Time Out
     C           *LIKE     DEFN #2OCFR    WZOCFR
     C                     MOVEL#2OCFR    WZOCFR           Ocean Freight
     C           *LIKE     DEFN #2KJDT    WZKJDT
     C                     MOVEL#2KJDT    WZKJDT           Scheduled Deliv
     C           *LIKE     DEFN #2ATTM    WZATTM
     C                     MOVEL#2ATTM    WZATTM           Scheduled Deliv
     C           *LIKE     DEFN #2OTRS    WZOTRS
     C                     MOVEL#2OTRS    WZOTRS           LH Unused Sts
     C           *LIKE     DEFN #2RNST    WZRNST
     C                     MOVEL#2RNST    WZRNST           LH Carrier Paym
     C           *LIKE     DEFN #2BRBK    WZBRBK
     C                     MOVEL#2BRBK    WZBRBK           Bring Back Mile
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2RMST    WZRMST
     C                     MOVEL#2RMST    WZRMST           Load Acceptance
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2KKDT    WZKKDT
     C                     MOVEL#2KKDT    WZKKDT           On Yard Date
     C           *LIKE     DEFN #2AVTM    WZAVTM
     C                     MOVEL#2AVTM    WZAVTM           On Yard Time
     C           *LIKE     DEFN #2KZDT    WZKZDT
     C                     MOVEL#2KZDT    WZKZDT           Deadline Depart
     C           *LIKE     DEFN #2AXTM    WZAXTM
     C                     MOVEL#2AXTM    WZAXTM           Deadline Depart
     C           *LIKE     DEFN #2LHOS    WZLHOS
     C                     MOVEL#2LHOS    WZLHOS           Load Held Over
     C           *LIKE     DEFN #2LHOR    WZLHOR
     C                     MOVEL#2LHOR    WZLHOR           Load Held Over
     C           *LIKE     DEFN #2WNTX    WZWNTX
     C                     MOVEL#2WNTX    WZWNTX           Load Held Over
     C           *LIKE     DEFN #2OITX    WZOITX
     C                     MOVEL#2OITX    WZOITX           Ocean BOL Numbe
     C           *LIKE     DEFN #2OJTX    WZOJTX
     C                     MOVEL#2OJTX    WZOJTX           Express Mail Nu
     C           *LIKE     DEFN #2LLDT    WZLLDT
     C                     MOVEL#2LLDT    WZLLDT           Express Mail Da
     C           *LIKE     DEFN #2LSHG    WZLSHG
     C                     MOVEL#2LSHG    WZLSHG           Load Shag Flag
     C           *LIKE     DEFN #2YPST    WZYPST
     C                     MOVEL#2YPST    WZYPST           Load Wash Flag
     C           *LIKE     DEFN #2K0DT    WZK0DT
     C                     MOVEL#2K0DT    WZK0DT           Product Complet
     C           *LIKE     DEFN #2AYTM    WZAYTM
     C                     MOVEL#2AYTM    WZAYTM           Product Complet
     C           *LIKE     DEFN #2KNNX    WZKNNX
     C                     MOVEL#2KNNX    WZKNNX           Pallets Loaded
     C           *LIKE     DEFN #2ICWG    WZICWG
     C                     MOVEL#2ICWG    WZICWG           Avg Pallet Tare
     C           *LIKE     DEFN #2IDWG    WZIDWG
     C                     MOVEL#2IDWG    WZIDWG           Tot Pallet Tare
     C           *LIKE     DEFN #2AZTM    WZAZTM
     C                     MOVEL#2AZTM    WZAZTM           Load Door 1
     C           *LIKE     DEFN #2K2DT    WZK2DT
     C                     MOVEL#2K2DT    WZK2DT           Unused Load Dat
     C           *LIKE     DEFN #2A0TM    WZA0TM
     C                     MOVEL#2A0TM    WZA0TM           Load Door 2
     C           *LIKE     DEFN #2ROST    WZROST
     C                     MOVEL#2ROST    WZROST           Partial Load
     C           *LIKE     DEFN #2RQST    WZRQST
     C                     MOVEL#2RQST    WZRQST           Export Load USD
     C           *LIKE     DEFN #2RRST    WZRRST
     C                     MOVEL#2RRST    WZRRST           Late Delivery E
     C           *LIKE     DEFN #2ZBVA    WZZBVA
     C                     MOVEL#2ZBVA    WZZBVA           Load Actual Fre
     C           *LIKE     DEFN #2WPTX    WZWPTX
     C                     MOVEL#2WPTX    WZWPTX           Hide on WW Load
     C           *LIKE     DEFN #2WQTX    WZWQTX
     C                     MOVEL#2WQTX    WZWQTX           Late Billing Em
     C           *LIKE     DEFN #2WRTX    WZWRTX
     C                     MOVEL#2WRTX    WZWRTX           Shipping Temp C
     C           *LIKE     DEFN #2WSTX    WZWSTX
     C                     MOVEL#2WSTX    WZWSTX           LH Held Over Rs
     C           *LIKE     DEFN #2RVSX    WZRVSX
     C                     MOVEL#2RVSX    WZRVSX           Multi Company L
     C           *LIKE     DEFN #2RUSX    WZRUSX
     C                     MOVEL#2RUSX    WZRUSX           LH Unused Sts 1
     C           *LIKE     DEFN #2RWSX    WZRWSX
     C                     MOVEL#2RWSX    WZRWSX           LH Unused Sts 2
     C           *LIKE     DEFN #2RXSX    WZRXSX
     C                     MOVEL#2RXSX    WZRXSX           LH Unused Sts 3
     C           *LIKE     DEFN #2RYSX    WZRYSX
     C                     MOVEL#2RYSX    WZRYSX           LH Unused Sts 4
     C           *LIKE     DEFN #2RZSX    WZRZSX
     C                     MOVEL#2RZSX    WZRZSX           LH Unused Sts 5
     C           *LIKE     DEFN #2R0SX    WZR0SX
     C                     MOVEL#2R0SX    WZR0SX           Load U/M
     C           *LIKE     DEFN #2R1SX    WZR1SX
     C                     MOVEL#2R1SX    WZR1SX           LH Unused Sts 7
     C           *LIKE     DEFN #2R2SX    WZR2SX
     C                     MOVEL#2R2SX    WZR2SX           LH Unused Sts 8
     C           *LIKE     DEFN #2R3SX    WZR3SX
     C                     MOVEL#2R3SX    WZR3SX           LH On-Time Reas
     C           *LIKE     DEFN #2R4SX    WZR4SX
     C                     MOVEL#2R4SX    WZR4SX           LH Held Over Re
     C           *LIKE     DEFN #2PYDT    WZPYDT
     C                     MOVEL#2PYDT    WZPYDT           LH Carrier Paid
     C           *LIKE     DEFN #2CKTM    WZCKTM
     C                     MOVEL#2CKTM    WZCKTM           LH Carrier Paid
     C           *LIKE     DEFN #2PZDT    WZPZDT
     C                     MOVEL#2PZDT    WZPZDT           LH Unused Date
     C           *LIKE     DEFN #2CLTM    WZCLTM
     C                     MOVEL#2CLTM    WZCLTM           LH Unused Time
     C           *LIKE     DEFN #2P0DT    WZP0DT
     C                     MOVEL#2P0DT    WZP0DT           LH Unused Date
     C           *LIKE     DEFN #2CMTM    WZCMTM
     C                     MOVEL#2CMTM    WZCMTM           LH Unused Time
     C           *LIKE     DEFN #2P1DT    WZP1DT
     C                     MOVEL#2P1DT    WZP1DT           LH Unused Date
     C           *LIKE     DEFN #2CNTM    WZCNTM
     C                     MOVEL#2CNTM    WZCNTM           LH Unused Time
     C           *LIKE     DEFN #2P2DT    WZP2DT
     C                     MOVEL#2P2DT    WZP2DT           LH Unused Date
     C           *LIKE     DEFN #2COTM    WZCOTM
     C                     MOVEL#2COTM    WZCOTM           LH Unused Time
     C           *LIKE     DEFN #2P3DT    WZP3DT
     C                     MOVEL#2P3DT    WZP3DT           LH Unused Date
     C           *LIKE     DEFN #2CQTM    WZCQTM
     C                     MOVEL#2CQTM    WZCQTM           LH Unused Time
     C           *LIKE     DEFN #2UVST    WZUVST
     C                     MOVEL#2UVST    WZUVST           EDI Status 1
     C           *LIKE     DEFN #2UWST    WZUWST
     C                     MOVEL#2UWST    WZUWST           EDI Status 2
     C           *LIKE     DEFN #2UXST    WZUXST
     C                     MOVEL#2UXST    WZUXST           EDI Status 3
     C           *LIKE     DEFN #2AATM    WZAATM
     C                     MOVEL#2AATM    WZAATM           Job Time
     C           *LIKE     DEFN #2AYNA    WZAYNA
     C                     MOVEL#2AYNA    WZAYNA           User Id
     C           *LIKE     DEFN #2A0NA    WZA0NA
     C                     MOVEL#2A0NA    WZA0NA           Job Name
     C           *LIKE     DEFN #2AXDT    WZAXDT
     C                     MOVEL#2AXDT    WZAXDT           Job Date
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2XCCD    WZXCCD
     C                     MOVEL#2XCCD    WZXCCD           Carrier Broker
     C           *LIKE     DEFN #2H9SX    WZH9SX
     C                     MOVEL#2H9SX    WZH9SX           Load Confirmed
     C           *LIKE     DEFN #2WOTX    WZWOTX
     C                     MOVEL#2WOTX    WZWOTX           Load Confirmed
     C           *LIKE     DEFN #2K1DT    WZK1DT
     C                     MOVEL#2K1DT    WZK1DT           Load Confirmati
     C           *LIKE     DEFN #2RPST    WZRPST
     C                     MOVEL#2RPST    WZRPST           Load Confirmati
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2DMTX    WQDMTX           Seal 1
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2DMTX    WQDMTX           Seal 1
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WTTX    WQWTTX           Seal 1 Unused
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2WTTX    WQWTTX           Seal 1 Unused
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WUTX    WQWUTX           Seal 2 Unused
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2WUTX    WQWUTX           Seal 2 Unused
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2DXTX    WQDXTX           Trailer Id
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 20        WQA5N   50
     C                     PARM #2DXTX    WQDXTX           Trailer Id
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2DYTX    WQDYTX           Initials of Con
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 3         WQA5N   50
     C                     PARM #2DYTX    WQDYTX           Initials of Con
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WPTX    WQWPTX           Hide on WW Load
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2WPTX    WQWPTX           Hide on WW Load
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WQTX    WQWQTX           Late Billing Em
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2WQTX    WQWQTX           Late Billing Em
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WRTX    WQWRTX           Shipping Temp C
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 25        WQA5N   50
     C                     PARM #2WRTX    WQWRTX           Shipping Temp C
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
     C           *LIKE     DEFN #2WSTX    WQWSTX           LH Held Over Rs
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 25        WQA5N   50
     C                     PARM #2WSTX    WQWSTX           LH Held Over Rs
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPBN                  90*
     C  N82                READ @FJCPBN                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,42
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2PKST    IFNE *BLANK                     Load Status
     C           FJPKST    CABNE#2PKST    BB020            Load Status
     C                     END
     C           #2RNNB    IFNE *ZERO                      Reefer Temperat
     C           FJRNNB    CABNE#2RNNB    BB020            Reefer Temperat
     C                     END
     C           #2DMTX    IFNE *BLANK                     Seal 1
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJDMTX           Seal 1
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQDMTX
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2DNTX    IFNE *BLANK                     Seal 2
     C           FJDNTX    CABNE#2DNTX    BB020            Seal 2
     C                     END
     C           #2DOTX    IFNE *BLANK                     Seal 3
     C           FJDOTX    CABNE#2DOTX    BB020            Seal 3
     C                     END
     C           #2WTTX    IFNE *BLANK                     Seal 1 Unused
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWTTX           Seal 1 Unused
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWTTX
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2WUTX    IFNE *BLANK                     Seal 2 Unused
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWUTX           Seal 2 Unused
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWUTX
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Load Orde
     C           FJRPNB    CABNE#2RPNB    BB020            Total Load Orde
     C                     END
     C           #2FLAM    IFNE *ZERO                      Flat Amount
     C           FJFLAM    CABNE#2FLAM    BB020            Flat Amount
     C                     END
     C           #2XQST    IFNE *BLANK                     Allocate Pounds
     C           FJXQST    CABNE#2XQST    BB020            Allocate Pounds
     C                     END
     C           #2RRNB    IFNE *ZERO                      Total Stops
     C           FJRRNB    CABNE#2RRNB    BB020            Total Stops
     C                     END
     C           #2DXTX    IFNE *BLANK                     Trailer Id
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJDXTX           Trailer Id
      * Length
     C                     PARM 20        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQDXTX
      * Length
     C                     PARM 20        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2DYTX    IFNE *BLANK                     Initials of Con
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJDYTX           Initials of Con
      * Length
     C                     PARM 3         WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQDYTX
      * Length
     C                     PARM 3         WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2SBNB    IFNE *ZERO                      BOL Time
     C           FJSBNB    CABNE#2SBNB    BB020            BOL Time
     C                     END
     C           #2RONB    IFNE *BLANK                     Truck Size
     C           FJRONB    CABNE#2RONB    BB020            Truck Size
     C                     END
     C           #2SQNB    IFNE *ZERO                      Ld Hdr/Ld Dtl U
     C           FJSQNB    CABNE#2SQNB    BB020            Ld Hdr/Ld Dtl U
     C                     END
     C           #2R1NB    IFNE *ZERO                      Rated Freight
     C           FJR1NB    CABNE#2R1NB    BB020            Rated Freight
     C                     END
     C           #2VCST    IFNE *BLANK                     Ship Status
     C           FJVCST    CABNE#2VCST    BB020            Ship Status
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2SDNB    IFNE *ZERO                      Number Pallets
     C           FJSDNB    CABNE#2SDNB    BB020            Number Pallets
     C                     END
     C           #2PAOU    IFNE *ZERO                      Number Pallets
     C           FJPAOU    CABNE#2PAOU    BB020            Number Pallets
     C                     END
     C           #2DGWG    IFNE *ZERO                      Load Carrier Pa
     C           FJDGWG    CABNE#2DGWG    BB020            Load Carrier Pa
     C                     END
     C           #2SXNB    IFNE *ZERO                      Estimated Arriv
     C           FJSXNB    CABNE#2SXNB    BB020            Estimated Arriv
     C                     END
     C           #2HADT    IFNE *ZERO                      Actual Arrival
     C           FJHADT    CABNE#2HADT    BB020            Actual Arrival
     C                     END
     C           #2AART    IFNE *ZERO                      Actual Arrival
     C           FJAART    CABNE#2AART    BB020            Actual Arrival
     C                     END
     C           #2DHWG    IFNE *ZERO                      Trailer IN Weig
     C           FJDHWG    CABNE#2DHWG    BB020            Trailer IN Weig
     C                     END
     C           #2DIWG    IFNE *ZERO                      Trailer OUT Wei
     C           FJDIWG    CABNE#2DIWG    BB020            Trailer OUT Wei
     C                     END
     C           #2AQDT    IFNE *ZERO                      Actual Departur
     C           FJAQDT    CABNE#2AQDT    BB020            Actual Departur
     C                     END
     C           #2S6NB    IFNE *ZERO                      Departure Time
     C           FJS6NB    CABNE#2S6NB    BB020            Departure Time
     C                     END
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABNE#2T4NB    BB020            Schedule Sequen
     C                     END
     C           #2PRTM    IFNE *ZERO                      Product Tempera
     C           FJPRTM    CABNE#2PRTM    BB020            Product Tempera
     C                     END
     C           #2NPSV    IFNE *ZERO                      Number Pallets
     C           FJNPSV    CABNE#2NPSV    BB020            Number Pallets
     C                     END
     C           #2J8TX    IFNE *BLANK                     Car/Veh. Initia
     C           FJJ8TX    CABNE#2J8TX    BB020            Car/Veh. Initia
     C                     END
     C           #2TLMI    IFNE *ZERO                      Total Load Mile
     C           FJTLMI    CABNE#2TLMI    BB020            Total Load Mile
     C                     END
     C           #2J9TX    IFNE *BLANK                     Recorder ID
     C           FJJ9TX    CABNE#2J9TX    BB020            Recorder ID
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           FJQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2VPCD    IFNE *BLANK                     Ship From Wareh
     C           FJVPCD    CABNE#2VPCD    BB020            Ship From Wareh
     C                     END
     C           #2DBCD    IFNE *BLANK                     Ship To State C
     C           FJDBCD    CABNE#2DBCD    BB020            Ship To State C
     C                     END
     C           #2GRWE    IFNE *ZERO                      Gross Weight
     C           FJGRWE    CABNE#2GRWE    BB020            Gross Weight
     C                     END
     C           #2U2ST    IFNE *BLANK                     Export Status
     C           FJU2ST    CABNE#2U2ST    BB020            Export Status
     C                     END
     C           #2F9DT    IFNE *ZERO                      Actual Ship Dat
     C           FJF9DT    CABNE#2F9DT    BB020            Actual Ship Dat
     C                     END
     C           #2ONTM    IFNE *BLANK                     On Time - (Y/N)
     C           FJONTM    CABNE#2ONTM    BB020            On Time - (Y/N)
     C                     END
     C           #2J4DT    IFNE *ZERO                      Truck Ready Dat
     C           FJJ4DT    CABNE#2J4DT    BB020            Truck Ready Dat
     C                     END
     C           #2TRTM    IFNE *ZERO                      Truck Ready Tim
     C           FJTRTM    CABNE#2TRTM    BB020            Truck Ready Tim
     C                     END
     C           #2J5DT    IFNE *ZERO                      Spotted Date
     C           FJJ5DT    CABNE#2J5DT    BB020            Spotted Date
     C                     END
     C           #2SPTM    IFNE *ZERO                      Spotted Time
     C           FJSPTM    CABNE#2SPTM    BB020            Spotted Time
     C                     END
     C           #2J6DT    IFNE *ZERO                      Load Finished D
     C           FJJ6DT    CABNE#2J6DT    BB020            Load Finished D
     C                     END
     C           #2LFTM    IFNE *ZERO                      Load Finished T
     C           FJLFTM    CABNE#2LFTM    BB020            Load Finished T
     C                     END
     C           #2J7DT    IFNE *ZERO                      BOL Complete Da
     C           FJJ7DT    CABNE#2J7DT    BB020            BOL Complete Da
     C                     END
     C           #2BOTM    IFNE *ZERO                      BOL Complete Ti
     C           FJBOTM    CABNE#2BOTM    BB020            BOL Complete Ti
     C                     END
     C           #2J8DT    IFNE *ZERO                      BOL Received Da
     C           FJJ8DT    CABNE#2J8DT    BB020            BOL Received Da
     C                     END
     C           #2BLTM    IFNE *ZERO                      BOL Received Ti
     C           FJBLTM    CABNE#2BLTM    BB020            BOL Received Ti
     C                     END
     C           #2KIDT    IFNE *ZERO                      Truck Departure
     C           FJKIDT    CABNE#2KIDT    BB020            Truck Departure
     C                     END
     C           #2ASTM    IFNE *ZERO                      Truck Departure
     C           FJASTM    CABNE#2ASTM    BB020            Truck Departure
     C                     END
     C           #2KADT    IFNE *ZERO                      Adjusted Depart
     C           FJKADT    CABNE#2KADT    BB020            Adjusted Depart
     C                     END
     C           #2AJCM    IFNE *ZERO                      Adjusted Depart
     C           FJAJCM    CABNE#2AJCM    BB020            Adjusted Depart
     C                     END
     C           #2XACD    IFNE *BLANK                     Shipping Line
     C           FJXACD    CABNE#2XACD    BB020            Shipping Line
     C                     END
     C           #2OANA    IFNE *BLANK                     Port Delv Termi
     C           FJOANA    CABNE#2OANA    BB020            Port Delv Termi
     C                     END
     C           #2K4TX    IFNE *BLANK                     Vessel Name
     C           FJK4TX    CABNE#2K4TX    BB020            Vessel Name
     C                     END
     C           #2VOAG    IFNE *ZERO                      Voyage
     C           FJVOAG    CABNE#2VOAG    BB020            Voyage
     C                     END
     C           #2KBDT    IFNE *ZERO                      Sail Date
     C           FJKBDT    CABNE#2KBDT    BB020            Sail Date
     C                     END
     C           #2NBBO    IFNE *BLANK                     Booking Number
     C           FJNBBO    CABNE#2NBBO    BB020            Booking Number
     C                     END
     C           #2W4CD    IFNE *BLANK                     Discharge Port
     C           FJW4CD    CABNE#2W4CD    BB020            Discharge Port
     C                     END
     C           #2EFDT    IFNE *ZERO                      Arrival Date
     C           FJEFDT    CABNE#2EFDT    BB020            Arrival Date
     C                     END
     C           #2CNTN    IFNE *BLANK                     Container Numbe
     C           FJCNTN    CABNE#2CNTN    BB020            Container Numbe
     C                     END
     C           #2KCDT    IFNE *ZERO                      Date In
     C           FJKCDT    CABNE#2KCDT    BB020            Date In
     C                     END
     C           #2TMIN    IFNE *ZERO                      Time In
     C           FJTMIN    CABNE#2TMIN    BB020            Time In
     C                     END
     C           #2KDDT    IFNE *ZERO                      Date Out
     C           FJKDDT    CABNE#2KDDT    BB020            Date Out
     C                     END
     C           #2VMNB    IFNE *ZERO                      Time Out
     C           FJVMNB    CABNE#2VMNB    BB020            Time Out
     C                     END
     C           #2OCFR    IFNE *ZERO                      Ocean Freight
     C           FJOCFR    CABNE#2OCFR    BB020            Ocean Freight
     C                     END
     C           #2KJDT    IFNE *ZERO                      Scheduled Deliv
     C           FJKJDT    CABNE#2KJDT    BB020            Scheduled Deliv
     C                     END
     C           #2ATTM    IFNE *ZERO                      Scheduled Deliv
     C           FJATTM    CABNE#2ATTM    BB020            Scheduled Deliv
     C                     END
     C           #2OTRS    IFNE *BLANK                     LH Unused Sts
     C           FJOTRS    CABNE#2OTRS    BB020            LH Unused Sts
     C                     END
     C           #2RNST    IFNE *BLANK                     LH Carrier Paym
     C           FJRNST    CABNE#2RNST    BB020            LH Carrier Paym
     C                     END
     C           #2BRBK    IFNE *ZERO                      Bring Back Mile
     C           FJBRBK    CABNE#2BRBK    BB020            Bring Back Mile
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           FJEIDT    CABNE#2EIDT    BB020            Requested Deliv
     C                     END
     C           #2RMST    IFNE *BLANK                     Load Acceptance
     C           FJRMST    CABNE#2RMST    BB020            Load Acceptance
     C                     END
     C           #2AJCD    IFNE *BLANK                     Warehouse Code
     C           FJAJCD    CABNE#2AJCD    BB020            Warehouse Code
     C                     END
     C           #2KKDT    IFNE *ZERO                      On Yard Date
     C           FJKKDT    CABNE#2KKDT    BB020            On Yard Date
     C                     END
     C           #2AVTM    IFNE *ZERO                      On Yard Time
     C           FJAVTM    CABNE#2AVTM    BB020            On Yard Time
     C                     END
     C           #2KZDT    IFNE *ZERO                      Deadline Depart
     C           FJKZDT    CABNE#2KZDT    BB020            Deadline Depart
     C                     END
     C           #2AXTM    IFNE *ZERO                      Deadline Depart
     C           FJAXTM    CABNE#2AXTM    BB020            Deadline Depart
     C                     END
     C           #2LHOS    IFNE *BLANK                     Load Held Over
     C           FJLHOS    CABNE#2LHOS    BB020            Load Held Over
     C                     END
     C           #2LHOR    IFNE *BLANK                     Load Held Over
     C           FJLHOR    CABNE#2LHOR    BB020            Load Held Over
     C                     END
     C           #2WNTX    IFNE *BLANK                     Load Held Over
     C           FJWNTX    CABNE#2WNTX    BB020            Load Held Over
     C                     END
     C           #2OITX    IFNE *BLANK                     Ocean BOL Numbe
     C           FJOITX    CABNE#2OITX    BB020            Ocean BOL Numbe
     C                     END
     C           #2OJTX    IFNE *BLANK                     Express Mail Nu
     C           FJOJTX    CABNE#2OJTX    BB020            Express Mail Nu
     C                     END
     C           #2LLDT    IFNE *ZERO                      Express Mail Da
     C           FJLLDT    CABNE#2LLDT    BB020            Express Mail Da
     C                     END
     C           #2LSHG    IFNE *BLANK                     Load Shag Flag
     C           FJLSHG    CABNE#2LSHG    BB020            Load Shag Flag
     C                     END
     C           #2YPST    IFNE *BLANK                     Load Wash Flag
     C           FJYPST    CABNE#2YPST    BB020            Load Wash Flag
     C                     END
     C           #2K0DT    IFNE *ZERO                      Product Complet
     C           FJK0DT    CABNE#2K0DT    BB020            Product Complet
     C                     END
     C           #2AYTM    IFNE *ZERO                      Product Complet
     C           FJAYTM    CABNE#2AYTM    BB020            Product Complet
     C                     END
     C           #2KNNX    IFNE *ZERO                      Pallets Loaded
     C           FJKNNX    CABNE#2KNNX    BB020            Pallets Loaded
     C                     END
     C           #2ICWG    IFNE *ZERO                      Avg Pallet Tare
     C           FJICWG    CABNE#2ICWG    BB020            Avg Pallet Tare
     C                     END
     C           #2IDWG    IFNE *ZERO                      Tot Pallet Tare
     C           FJIDWG    CABNE#2IDWG    BB020            Tot Pallet Tare
     C                     END
     C           #2AZTM    IFNE *ZERO                      Load Door 1
     C           FJAZTM    CABNE#2AZTM    BB020            Load Door 1
     C                     END
     C           #2K2DT    IFNE *ZERO                      Unused Load Dat
     C           FJK2DT    CABNE#2K2DT    BB020            Unused Load Dat
     C                     END
     C           #2A0TM    IFNE *ZERO                      Load Door 2
     C           FJA0TM    CABNE#2A0TM    BB020            Load Door 2
     C                     END
     C           #2ROST    IFNE *BLANK                     Partial Load
     C           FJROST    CABNE#2ROST    BB020            Partial Load
     C                     END
     C           #2RQST    IFNE *BLANK                     Export Load USD
     C           FJRQST    CABNE#2RQST    BB020            Export Load USD
     C                     END
     C           #2RRST    IFNE *BLANK                     Late Delivery E
     C           FJRRST    CABNE#2RRST    BB020            Late Delivery E
     C                     END
     C           #2ZBVA    IFNE *ZERO                      Load Actual Fre
     C           FJZBVA    CABNE#2ZBVA    BB020            Load Actual Fre
     C                     END
     C           #2WPTX    IFNE *BLANK                     Hide on WW Load
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWPTX           Hide on WW Load
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWPTX
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2WQTX    IFNE *BLANK                     Late Billing Em
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWQTX           Late Billing Em
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWQTX
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2WRTX    IFNE *BLANK                     Shipping Temp C
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWRTX           Shipping Temp C
      * Length
     C                     PARM 25        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWRTX
      * Length
     C                     PARM 25        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2WSTX    IFNE *BLANK                     LH Held Over Rs
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           FJWSTX           LH Held Over Rs
      * Length
     C                     PARM 25        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQWSTX
      * Length
     C                     PARM 25        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2RVSX    IFNE *BLANK                     Multi Company L
     C           FJRVSX    CABNE#2RVSX    BB020            Multi Company L
     C                     END
     C           #2RUSX    IFNE *BLANK                     LH Unused Sts 1
     C           FJRUSX    CABNE#2RUSX    BB020            LH Unused Sts 1
     C                     END
     C           #2RWSX    IFNE *BLANK                     LH Unused Sts 2
     C           FJRWSX    CABNE#2RWSX    BB020            LH Unused Sts 2
     C                     END
     C           #2RXSX    IFNE *BLANK                     LH Unused Sts 3
     C           FJRXSX    CABNE#2RXSX    BB020            LH Unused Sts 3
     C                     END
     C           #2RYSX    IFNE *BLANK                     LH Unused Sts 4
     C           FJRYSX    CABNE#2RYSX    BB020            LH Unused Sts 4
     C                     END
     C           #2RZSX    IFNE *BLANK                     LH Unused Sts 5
     C           FJRZSX    CABNE#2RZSX    BB020            LH Unused Sts 5
     C                     END
     C           #2R0SX    IFNE *BLANK                     Load U/M
     C           FJR0SX    CABNE#2R0SX    BB020            Load U/M
     C                     END
     C           #2R1SX    IFNE *BLANK                     LH Unused Sts 7
     C           FJR1SX    CABNE#2R1SX    BB020            LH Unused Sts 7
     C                     END
     C           #2R2SX    IFNE *BLANK                     LH Unused Sts 8
     C           FJR2SX    CABNE#2R2SX    BB020            LH Unused Sts 8
     C                     END
     C           #2R3SX    IFNE *BLANK                     LH On-Time Reas
     C           FJR3SX    CABNE#2R3SX    BB020            LH On-Time Reas
     C                     END
     C           #2R4SX    IFNE *BLANK                     LH Held Over Re
     C           FJR4SX    CABNE#2R4SX    BB020            LH Held Over Re
     C                     END
     C           #2PYDT    IFNE *ZERO                      LH Carrier Paid
     C           FJPYDT    CABNE#2PYDT    BB020            LH Carrier Paid
     C                     END
     C           #2CKTM    IFNE *ZERO                      LH Carrier Paid
     C           FJCKTM    CABNE#2CKTM    BB020            LH Carrier Paid
     C                     END
     C           #2PZDT    IFNE *ZERO                      LH Unused Date
     C           FJPZDT    CABNE#2PZDT    BB020            LH Unused Date
     C                     END
     C           #2CLTM    IFNE *ZERO                      LH Unused Time
     C           FJCLTM    CABNE#2CLTM    BB020            LH Unused Time
     C                     END
     C           #2P0DT    IFNE *ZERO                      LH Unused Date
     C           FJP0DT    CABNE#2P0DT    BB020            LH Unused Date
     C                     END
     C           #2CMTM    IFNE *ZERO                      LH Unused Time
     C           FJCMTM    CABNE#2CMTM    BB020            LH Unused Time
     C                     END
     C           #2P1DT    IFNE *ZERO                      LH Unused Date
     C           FJP1DT    CABNE#2P1DT    BB020            LH Unused Date
     C                     END
     C           #2CNTM    IFNE *ZERO                      LH Unused Time
     C           FJCNTM    CABNE#2CNTM    BB020            LH Unused Time
     C                     END
     C           #2P2DT    IFNE *ZERO                      LH Unused Date
     C           FJP2DT    CABNE#2P2DT    BB020            LH Unused Date
     C                     END
     C           #2COTM    IFNE *ZERO                      LH Unused Time
     C           FJCOTM    CABNE#2COTM    BB020            LH Unused Time
     C                     END
     C           #2P3DT    IFNE *ZERO                      LH Unused Date
     C           FJP3DT    CABNE#2P3DT    BB020            LH Unused Date
     C                     END
     C           #2CQTM    IFNE *ZERO                      LH Unused Time
     C           FJCQTM    CABNE#2CQTM    BB020            LH Unused Time
     C                     END
     C           #2UVST    IFNE *BLANK                     EDI Status 1
     C           FJUVST    CABNE#2UVST    BB020            EDI Status 1
     C                     END
     C           #2UWST    IFNE *BLANK                     EDI Status 2
     C           FJUWST    CABNE#2UWST    BB020            EDI Status 2
     C                     END
     C           #2UXST    IFNE *BLANK                     EDI Status 3
     C           FJUXST    CABNE#2UXST    BB020            EDI Status 3
     C                     END
     C           #2AATM    IFNE *ZERO                      Job Time
     C           FJAATM    CABNE#2AATM    BB020            Job Time
     C                     END
     C           #2AYNA    IFNE *BLANK                     User Id
     C           FJAYNA    CABNE#2AYNA    BB020            User Id
     C                     END
     C           #2A0NA    IFNE *BLANK                     Job Name
     C           FJA0NA    CABNE#2A0NA    BB020            Job Name
     C                     END
     C           #2AXDT    IFNE *ZERO                      Job Date
     C           FJAXDT    CABNE#2AXDT    BB020            Job Date
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           FJAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           FJAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2BZNA    IFNE *BLANK                     Carrier Code
     C           FJBZNA    CABNE#2BZNA    BB020            Carrier Code
     C                     END
     C           #2XCCD    IFNE *BLANK                     Carrier Broker
     C           FJXCCD    CABNE#2XCCD    BB020            Carrier Broker
     C                     END
     C           #2H9SX    IFNE *BLANK                     Load Confirmed
     C           FJH9SX    CABNE#2H9SX    BB020            Load Confirmed
     C                     END
     C           #2WOTX    IFNE *BLANK                     Load Confirmed
     C           FJWOTX    CABNE#2WOTX    BB020            Load Confirmed
     C                     END
     C           #2K1DT    IFNE *ZERO                      Load Confirmati
     C           FJK1DT    CABNE#2K1DT    BB020            Load Confirmati
     C                     END
     C           #2RPST    IFNE *BLANK                     Load Confirmati
     C           FJRPST    CABNE#2RPST    BB020            Load Confirmati
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPBN                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Load Change Type
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CRVST    W0NSRQ  1        Load Change Typ
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CRVST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1463079   Y2LSNO  70
     C           #CRVST    PARM #CRVST    W0EXVL 25        Load Change Typ
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Confirmed Sts
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2H9SX    W0NSRQ  1        Load Confirmed
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2H9SX'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1106245   Y2LSNO  70
     C           #2H9SX    PARM #2H9SX    W0EXVL 25        Load Confirmed
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C           WZH9SX    CASNE#2H9SX    FBRQRL
     C           WZWOTX    CASNE#2WOTX    FBRQRL
     C           WZK1DT    CASNE#2K1DT    FBRQRL
     C           WZRPST    CASNE#2RPST    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * CASE: CTL.Load Change Type NE WRK.BLANK
     C           #CRVST    IFNE WUGSTX                     *IF
      * CASE: RCD.*SFLSEL is *Change
     C           #1SEL     IFEQ '2'                        *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADDWURVNB    PARVNB           Stop/Drop
     C                     MOVEL#CRVST    PARVST    P      Load Change Typ
     C                     MOVEL#CUJST    PAUJST    P      Department Cont
     C                     MOVEL#CMNTX    PAMNTX    P      Change Log Prio
     C                     MOVEL#CMOTX    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     SETON                     3334  *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Copy
     C           #1SEL     IFEQ '3'                        *IF
      * DSP Change Log Entries DF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDCRDFR'              90  DSP Change Log
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCRDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete#1
     C           #1SEL     IFEQ '4'                        *IF
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADDWURVNB    PCRVNB           Stop/Drop
     C                     MOVEL#CRVST    PCRVST    P      Load Change Typ
     C                     MOVEL#CUJST    PCUJST    P      Department Cont
     C                     MOVEL#CMNTX    PCMNTX    P      Change Log Prio
     C                     MOVEL#CMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     SETON                     3334  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPBN fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 1 Unused
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Initials of Con
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Pallets
     C                     MOVELFJJ8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Ocean Freight
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Unused Load Dat
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           LH Unused Sts 1
     C                     MOVELFJRWSX    #1RWSX           LH Unused Sts 2
     C                     MOVELFJRXSX    #1RXSX           LH Unused Sts 3
     C                     MOVELFJRYSX    #1RYSX           LH Unused Sts 4
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U/M
     C                     MOVELFJR1SX    #1R1SX           LH Unused Sts 7
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Unused Date
     C                     Z-ADDFJCLTM    #1CLTM           LH Unused Time
     C                     Z-ADDFJP0DT    #1P0DT           LH Unused Date
     C                     Z-ADDFJCMTM    #1CMTM           LH Unused Time
     C                     Z-ADDFJP1DT    #1P1DT           LH Unused Date
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     Z-ADD*ZERO     #2RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #2DMTX           Seal 1
     C                     MOVEL*BLANK    #2DNTX           Seal 2
     C                     MOVEL*BLANK    #2DOTX           Seal 3
     C                     MOVEL*BLANK    #2WTTX           Seal 1 Unused
     C                     MOVEL*BLANK    #2WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #2RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #2FLAM           Flat Amount
     C                     MOVEL*BLANK    #2XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #2RRNB           Total Stops
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     MOVEL*BLANK    #2DYTX           Initials of Con
     C                     Z-ADD*ZERO     #2SBNB           BOL Time
     C                     MOVEL*BLANK    #2RONB           Truck Size
     C                     Z-ADD*ZERO     #2SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL*BLANK    #2VCST           Ship Status
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2SDNB           Number Pallets
     C                     Z-ADD*ZERO     #2PAOU           Number Pallets
     C                     Z-ADD*ZERO     #2DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #2SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #2HADT           Actual Arrival
     C                     Z-ADD*ZERO     #2AART           Actual Arrival
     C                     Z-ADD*ZERO     #2DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #2DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #2AQDT           Actual Departur
     C                     Z-ADD*ZERO     #2S6NB           Departure Time
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #2PRTM           Product Tempera
     C                     Z-ADD*ZERO     #2NPSV           Number Pallets
     C                     MOVEL*BLANK    #2J8TX           Car/Veh. Initia
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     MOVEL*BLANK    #2J9TX           Recorder ID
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #2VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2GRWE           Gross Weight
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     Z-ADD*ZERO     #2F9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #2ONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     #2J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #2TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #2J5DT           Spotted Date
     C                     Z-ADD*ZERO     #2SPTM           Spotted Time
     C                     Z-ADD*ZERO     #2J6DT           Load Finished D
     C                     Z-ADD*ZERO     #2LFTM           Load Finished T
     C                     Z-ADD*ZERO     #2J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #2BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #2J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #2BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #2KIDT           Truck Departure
     C                     Z-ADD*ZERO     #2ASTM           Truck Departure
     C                     Z-ADD*ZERO     #2KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #2AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #2XACD           Shipping Line
     C                     MOVEL*BLANK    #2OANA           Port Delv Termi
     C                     MOVEL*BLANK    #2K4TX           Vessel Name
     C                     Z-ADD*ZERO     #2VOAG           Voyage
     C                     Z-ADD*ZERO     #2KBDT           Sail Date
     C                     MOVEL*BLANK    #2NBBO           Booking Number
     C                     MOVEL*BLANK    #2W4CD           Discharge Port
     C                     Z-ADD*ZERO     #2EFDT           Arrival Date
     C                     MOVEL*BLANK    #2CNTN           Container Numbe
     C                     Z-ADD*ZERO     #2KCDT           Date In
     C                     Z-ADD*ZERO     #2TMIN           Time In
     C                     Z-ADD*ZERO     #2KDDT           Date Out
     C                     Z-ADD*ZERO     #2VMNB           Time Out
     C                     Z-ADD*ZERO     #2OCFR           Ocean Freight
     C                     Z-ADD*ZERO     #2KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #2ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #2OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #2RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #2BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     MOVEL*BLANK    #2RMST           Load Acceptance
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #2KKDT           On Yard Date
     C                     Z-ADD*ZERO     #2AVTM           On Yard Time
     C                     Z-ADD*ZERO     #2KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #2AXTM           Deadline Depart
     C                     MOVEL*BLANK    #2LHOS           Load Held Over
     C                     MOVEL*BLANK    #2LHOR           Load Held Over
     C                     MOVEL*BLANK    #2WNTX           Load Held Over
     C                     MOVEL*BLANK    #2OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #2OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #2LLDT           Express Mail Da
     C                     MOVEL*BLANK    #2LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #2YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #2K0DT           Product Complet
     C                     Z-ADD*ZERO     #2AYTM           Product Complet
     C                     Z-ADD*ZERO     #2KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #2ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #2IDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     #2AZTM           Load Door 1
     C                     Z-ADD*ZERO     #2K2DT           Unused Load Dat
     C                     Z-ADD*ZERO     #2A0TM           Load Door 2
     C                     MOVEL*BLANK    #2ROST           Partial Load
     C                     MOVEL*BLANK    #2RQST           Export Load USD
     C                     MOVEL*BLANK    #2RRST           Late Delivery E
     C                     Z-ADD*ZERO     #2ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #2WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #2WQTX           Late Billing Em
     C                     MOVEL*BLANK    #2WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #2WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #2RVSX           Multi Company L
     C                     MOVEL*BLANK    #2RUSX           LH Unused Sts 1
     C                     MOVEL*BLANK    #2RWSX           LH Unused Sts 2
     C                     MOVEL*BLANK    #2RXSX           LH Unused Sts 3
     C                     MOVEL*BLANK    #2RYSX           LH Unused Sts 4
     C                     MOVEL*BLANK    #2RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #2R0SX           Load U/M
     C                     MOVEL*BLANK    #2R1SX           LH Unused Sts 7
     C                     MOVEL*BLANK    #2R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #2R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #2R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #2PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #2CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #2PZDT           LH Unused Date
     C                     Z-ADD*ZERO     #2CLTM           LH Unused Time
     C                     Z-ADD*ZERO     #2P0DT           LH Unused Date
     C                     Z-ADD*ZERO     #2CMTM           LH Unused Time
     C                     Z-ADD*ZERO     #2P1DT           LH Unused Date
     C                     Z-ADD*ZERO     #2CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #2P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #2COTM           LH Unused Time
     C                     Z-ADD*ZERO     #2P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #2CQTM           LH Unused Time
     C                     MOVEL*BLANK    #2UVST           EDI Status 1
     C                     MOVEL*BLANK    #2UWST           EDI Status 2
     C                     MOVEL*BLANK    #2UXST           EDI Status 3
     C                     Z-ADD*ZERO     #2AATM           Job Time
     C                     MOVEL*BLANK    #2AYNA           User Id
     C                     MOVEL*BLANK    #2A0NA           Job Name
     C                     Z-ADD*ZERO     #2AXDT           Job Date
     C                     MOVEL*BLANK    #CRVST           Load Change Typ
     C                     MOVEL*BLANK    #CUJST           Department Cont
     C                     MOVEL*BLANK    #CMNTX           Change Log Prio
     C                     MOVEL*BLANK    #CMOTX           Change Log New
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #2XCCD           Carrier Broker
     C                     MOVEL*BLANK    #2H9SX           Load Confirmed
     C                     MOVEL*BLANK    #2WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #2K1DT           Load Confirmati
     C                     MOVEL*BLANK    #2RPST           Load Confirmati
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE022
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CRVST'  YPMTFD           Load Change Typ
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ047
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2H9SX'  YPMTFD           Load Confirmed
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1RVST           Load Change Typ
     C                     MOVEL*BLANK    P1UJST           Department Cont
     C                     MOVEL*BLANK    P1MNTX           Change Log Prio
     C                     MOVEL*BLANK    P1MOTX           Change Log New
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL
     C                     MOVE ZZFLB     @1FLB
     C                     MOVE ZZFMB     @1FMB
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD10        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
