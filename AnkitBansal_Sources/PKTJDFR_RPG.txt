     H/TITLE WW Balance To Kill    DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 12/06/21  Time  : 11:16:08
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKTJDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Balance To Kill    DF  Display file
      *
     FPKA1CPL5IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Tattoo Header             Shft/Kill/Err/Tatto
      *
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKA4CPL3IF  E           K        DISK
      * RSQ : Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      *
     FPWAXCPL2IF  E           K        DISK
      * RSQ : Tattoo Repayment Detail   Tattoo Hdr keys/Repay ID
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKCGCPL4IF  E           K        DISK
      * RSQ : Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKBVCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * Long constants
     E                    @CN#    1  32  6   @CN    25
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WBHSNB
     I              BVA9DT                          WBA9DT
     I              BVFJNB                          WBFJNB
     I              BVHCNB                          WBHCNB
     I              BVGDNB                          WBGDNB
     I              BVFINB                          WBFINB
     I              BVLKNB                          WBLKNB
     I              BVEAST                          WBEAST
     I              BVAMPC                          WBAMPC
     I              BVAIPC                          WBAIPC
     I              BVAJPC                          WBAJPC
     I              BVAKPC                          WBAKPC
     I              BVX8NB                          WBX8NB
     I              BVFVPC                          WBFVPC
     I              BVFWPC                          WBFWPC
     I              BVFXPC                          WBFXPC
     I              BVALPC                          WBALPC
     I              BVDIST                          WBDIST
     I              BVFYST                          WBFYST
     I              BVD2ST                          WBD2ST
     I              BVEHST                          WBEHST
     I              BVG1ST                          WBG1ST
     I              BVH4ST                          WBH4ST
     I              BVJLST                          WBJLST
     I              BVUUST                          WBUUST
     I              BVVHST                          WBVHST
     I              BVVIST                          WBVIST
     I              BVVJST                          WBVJST
     I              BVVKST                          WBVKST
     I              BVVLST                          WBVLST
     I              BVHMNB                          WBHMNB
     I              BVBNNB                          WBBNNB
     I              BVBONB                          WBBONB
     I              BVCVNB                          WBCVNB
     I              BVB0DT                          WBB0DT
     I              BVAAVN                          WBAAVN
     I              BVAADT                          WBAADT
     I              BVAMTM                          WBAMTM
     I              BVAJST                          WBAJST
     I              BVAHVN                          WBAHVN
     I              BVAGVN                          WBAGVN
     I              BVABVN                          WBABVN
     I              BVABDT                          WBABDT
     I              BVABTM                          WBABTM
     I              BVB8DT                          WBB8DT
     I              BVAOTM                          WBAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             21
      * KEY : Eval Trans                Co/Bol/Tto/KDt/Ln-d/Hw-d
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : RST BOL Load Number
     I                                    P   7   90PABONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : RST TH Kill Date
     I                                    P  13  160PAB0DT
      *
      * Outward parameters
     IPBRC        DS                             15
      * KEY : Producer History WKLY     Co/Prod/WkEndDte(D)/Type
      * I : RST PH Company Number
     I                                    P   1   20PBY3A1
      * I : RST PD Producer Code
     I                                        3   8 PBABCD
      *
      * Outward parameters
     IPCRC        DS                             24
      * KEY : Eval/Loss Error           Retrieval index
      * I : RST KV Company Number
     I                                    P   1   20PCHRNB
      * I : RST KV Kill Date
     I                                    P   3   60PCBPDT
      * I : RST KV TATTOO NUMBER
     I                                    P   7   90PCIRNB
      * I : RST KV Buy Order Number
     I                                    P  10  130PCBONM
      * I : RST KV Load Number
     I                                    P  14  160PCLDNM
      * I :  KV Record Number
     I                                    P  17  200PCFPNB
      * I :  KV Record Type
     I                                       21  21 PCDYST
      *
      * Outward parameters
     IPDRC        DS                             16
      * KEY : Loss Trans                By Bo/Ld/Tattoo No Delet
      * I : RST BOH Company Number
     I                                    P   1   20PDHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PDBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PDBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PDCVNB
      * I : RST TH Kill Date
     I                                    P  13  160PDB0DT
      *
      * Outward parameters
     IPERC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PEHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PEBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PEBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PECVNB
      * I : RST TH Kill Date
     I                                    P  13  160PEB0DT
      *
      * Outward parameters
     IPFRC        DS                             19
      * KEY : Tattoo Header Comment     Co/BOL/Tto/KDt/Typ/Lin
      * I : RST BOH Company Number
     I                                    P   1   20PFHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PFBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PFBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PFCVNB
      * I : RST TH Kill Date
     I                                    P  13  160PFB0DT
      * I :  THC Comment Type
     I                                       17  17 PFETST
      *
      * Outward parameters
     IPGRC        DS                            583
      * RCD : Tattoo Header             Retrieval index
      * I :  BOH Company Number
     I                                    P   1   20PGHMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60PGBNNB
      * I :  BOL Load Number
     I                                    P   7   90PGBONB
      * I :  TH Tattoo Number
     I                                    P  10  120PGCVNB
      * I :  TH Kill Date
     I                                    P  13  160PGB0DT
      * I :  TH Purchase Date
     I                                    P  17  200PGAWDT
      * I :  TH Group Reference
     I                                       21  30 PGBICD
      * I :  TH Live Purchase UOM
     I                                       31  32 PGCPST
      * I :  TH Live Purchase Price
     I                                    P  33  352PGACPR
      * I :  TH Live Gross Amt
     I                                    P  36  392PGB9PR
      * I :  TH LIve Net Amt
     I                                    P  40  432PGCAPR
      * I :  TH Resale UOM
     I                                       44  45 PGC4ST
      * I :  TH Recalc Live Wgt Yld
     I                                    P  46  482PGAIPR
      * I :  TH Pricing Date
     I                                    P  49  520PGA6DT
      * I :  TH Resale Spread Sts
     I                                       53  53 PGC2ST
      * I :  TH Dead On Arrival
     I                                    P  54  560PGCXNB
      * I :  TH Head Received
     I                                    P  57  590PGCWNB
      * I :  TH Yard Deads
     I                                    P  60  620PGFCNB
      * I :  TH Held Over
     I                                    P  63  650PGH9NB
      * I :  TH Head Condemned
     I                                    P  66  680PGFDNB
      * I :  TH Head Killed
     I                                    P  69  710PGFENB
      * I :  TH Head Adds
     I                                    P  72  740PGHENB
      * I :  TH Head Accepted
     I                                    P  75  770PGHFNB
      * I :  TH Live Wgt
     I                                    P  78  811PGCYNB
      * I :  TH Adj Live Wgt
     I                                    P  82  851PGLRNB
      * I :  TH Hot Wgt
     I                                    P  86  891PGE0NB
      * I :  TH Tot Loin Eye Depth
     I                                    P  90  931PGA5PC
      * I :  TH Tot Backfat Inches
     I                                    P  94  971PGFBNB
      * I :  TH Tot Light Reflectance
     I                                    P  98 1011PGA4PC
      * I :  TH Avg Live Wgt
     I                                    P 102 1041PGF7NB
      * I :  TH Avg Hot Wgt
     I                                    P 105 1071PGHDNB
      * I :  TH Avg Light Reflectance
     I                                    P 108 1091PGF5NB
      * I :  TH Avg Lean Percent
     I                                    P 110 1111PGF4NB
      * I :  TH Avg Loin Eye Depth
     I                                    P 112 1131PGF3NB
      * I :  TH Avg Backfat
     I                                    P 114 1151PGF2NB
      * I :  TH Std Yield Percent
     I                                    P 116 1182PGAVPC
      * I :  TH Actual Yield %
     I                                    P 119 1212PGAWPC
      * I :  TH Adj Actual Yield %
     I                                    P 122 1242PGCWPC
      * I :  TH Yield Difference
     I                                    P 125 1272PGA8PC
      * I :  TH Recalc Live Wgt
     I                                    P 128 1291PGA7PC
      * I :  TH CM Market Price
     I                                    P 130 1322PGB8PR
      * I :  TH CM Base Mkt Price
     I                                    P 133 1352PGAMPR
      * I :  TH CM Base Mkt Price Amt
     I                                    P 136 1392PGANPR
      * I :  TH CM Sort Discount Amt
     I                                    P 140 1432PGAYVA
      * I :  TH CM Yield Gain/Loss Amt
     I                                    P 144 1472PGAWVA
      * I :  TH CM Base Carcass Value
     I                                    P 148 1512PGAOPR
      * I :  TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552PGAXVA
      * I :  TH CM Carcass Gross Amt
     I                                    P 156 1592PGAPPR
      * I :  TH Deduction Amt
     I                                    P 160 1632PGASPR
      * I :  TH Total Net WO Adds
     I                                    P 164 1672PGA4VA
      * I :  TH Carcass Net Amt
     I                                    P 168 1712PGATPR
      * I :  TH Additions Amt
     I                                    P 172 1752PGA5VA
      * I :  TH Payment Gross
     I                                    P 176 1792PGCBPR
      * I :  Th Payment Net Amt
     I                                    P 180 1832PGCCPR
      * I :  TH AP Voucher/Document#
     I                                    P 184 1880PGLPNB
      * I :  TH Freight Amount
     I                                    P 189 1922PGCDPR
      * I :  TH Accrual Amount
     I                                    P 193 1962PGA7VA
      * I :  TH Fixed Cost Amount
     I                                    P 197 2002PGA2PR
      * I :  TH Calc Net Sts
     I                                      201 201 PGJWST
      * I :  TH Payment Sts
     I                                      202 203 PGCWST
      * N :  TH Header Error Sts
     I                                      204 204 PGD7ST
      * N :  TH Detail Error Sts
     I                                      205 205 PGD8ST
      * N :  TH Kill Balancing Sts
     I                                      206 206 PGDWST
      * I :  TH Bal to Kill Gen
     I                                      207 207 PGD6ST
      * I :  TH Commission A/P Voucher
     I                                      208 2150PGGHNB
      * I :  TH Voucher Payment Date
     I                                    P 216 2190PGBYDT
      * I :  TH User Error Override
     I                                      220 220 PGE0ST
      * I :  TH Held Over Record
     I                                      221 221 PGE1ST
      * I :  TH Sex
     I                                      222 222 PGE2ST
      * I :  TH Held/Ovr Completed Dte
     I                                    P 223 2260PGBSDT
      * I :  TH Commission Paid Date
     I                                    P 227 2300PGBTDT
      * I :  TH Actual Check Date
     I                                    P 231 2340PGBUDT
      * I :  TH Shipped Weight
     I                                    P 235 2381PGHGNB
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421PGHHNB
      * I :  TH FFLI
     I                                    P 243 2441PGHINB
      * I :  TH Kill Product Value
     I                                    P 245 2482PGA3PR
      * I :  TH Cut Product Value
     I                                    P 249 2522PGA4PR
      * I :  TH Render Product Value
     I                                    P 253 2562PGA6PR
      * I :  TH Head Excluded
     I                                    P 257 2590PGJ9NB
      * I :  TH CM Bse Mkt Live /CWT
     I                                    P 260 2622PGD6PR
      * I :  TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652PGD7PR
      * I :  TH CM Srt Dsc Live /CWT
     I                                    P 266 2682PGD8PR
      * I :  TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712PGD9PR
      * I :  TH CM Yld G/L Live /CWT
     I                                    P 272 2742PGEAPR
      * I :  TH CM Yld G/L Carc /CWT
     I                                    P 275 2772PGEBPR
      * I :  TH CM Crc Val Live /CWT
     I                                    P 278 2802PGECPR
      * I :  TH CM Crc Val Carc /CWT
     I                                    P 281 2832PGEDPR
      * I :  TH CM Lean Prem Live /CWT
     I                                    P 284 2862PGEEPR
      * I :  TH CM Lean Prem Carc /CWT
     I                                    P 287 2892PGEFPR
      * I :  TH CM Gross Live /CWT
     I                                    P 290 2922PGEGPR
      * I :  TH CM Gross Carc /CWT
     I                                    P 293 2952PGEHPR
      * I :  TH Source Type
     I                                      296 296 PGKAST
      * I :  TH Scale Ticket Sts
     I                                      297 297 PGJ7ST
      * I :  TH Payment Type
     I                                      298 298 PGJ9ST
      * I :  TH HPS Movement Ref #
     I                                    P 299 3020PGOXNB
      * I :  TH Source Code
     I                                      303 305 PGLKST
      * I :  TH Hog Class Type
     I                                      306 306 PGLLST
      * I :  TH Posted to HPS Flag
     I                                      307 307 PGJ8ST
      * I :  TH Schedule Kill Shift
     I                                      308 308 PGLIST
      * I :  TH Shift Held Over
     I                                      309 309 PGLJST
      * I :  DF Defect Code
     I                                      492 497 PGBDCD
      * I :  THP Process Code
     I                                      498 503 PGCSCD
      * I :  PD Producer Code
     I                                      504 509 PGABCD
      * I :  PL Location Code
     I                                      510 515 PGAECD
      * I :  HB Buyer Code
     I                                      516 518 PGACCD
      * I :  GN Genetic Code
     I                                      519 523 PGAGCD
      * I :  HC Class Code
     I                                      524 526 PGBECD
      * I :  RS User Changed
     I                                      527 536 PGAAVN
      * I :  RS Date Changed
     I                                    P 537 5400PGAADT
      * I :  RS Time Changed
     I                                    P 541 5440PGAMTM
      * I :  RS Record Status
     I                                      545 545 PGAJST
      * I :  RS Job
     I                                      546 555 PGAHVN
      * I :  RS Program
     I                                      556 565 PGAGVN
      * I :  RS User Added
     I                                      566 575 PGABVN
      * I :  RS Date Added
     I                                    P 576 5790PGABDT
      * I :  RS Time Added
     I                                    P 580 5830PGABTM
      *
      * Outward parameters
     IPHRC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PHHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PHBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PHBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PHCVNB
      * I : RST TH Kill Date
     I                                    P  13  160PHB0DT
      *
      * Outward parameters
     IPIRC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PIHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PIBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PIBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PICVNB
      * I : RST TH Kill Date
     I                                    P  13  160PIB0DT
      *
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P1ETTX
      * N : MAP PRT Printer Device
     I                                       26  35 P1ACVN
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P1AKST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P1AMST
      * N : MAP PRT Copies
     I                                       44  450P1AKNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P1ALST
      * N : MAP PRT Night Queue
     I                                       47  56 P1AIVN
     IP2PARM      DS
      * FLD: *Arrays
      * N : MAP Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N : MAP CC Company Number
     I                                    P   4   50P2HONB
      * N : MAP Oms SalesPerson Code
     I                                        6   8 P2C8CD
      * N : MAP Oms Allow Multi-Company
     I                                        9   9 P2G8ST
      * N : MAP Oms Default Printer
     I                                       10  19 P2G9ST
      * N : MAP Oms Name
     I                                       20  49 P2EUTX
      * N : MAP Oms System Value Alpha
     I                                       50  89 P2EVTX
      * N : MAP Oms Access Denied (Y/N)
     I                                       90  90 P2HAST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0002
      * Message data for 'SBM Prt Bal to Kill Rpt'
      * BOH Company Number
     I                                    P   1   20ZA0003
      * Date Alpha USR
     I                                        3   9 ZA0004
      * PRT Printer Device
     I                                       10  19 ZA0005
      * PRT Hold Output Sts
     I                                       20  23 ZA0006
      * PRT Save Output Sts
     I                                       24  27 ZA0007
      * PRT Copies
     I                                    P  28  290ZA0008
      * PRT Night Queue
     I                                       30  39 ZA0009
      * Oms System Value Alpha
     I                                       40  79 ZA0010
      * TH Schedule Kill Shift
     I                                       80  80 ZA0011
      * Message data for 'Opt not allowed'
      * *SFLSEL
     I                                        1   1 ZA0012
      * Message data for 'Opt not allowed'
      * *SFLSEL
     I                                        1   1 ZA0013
      * Message data for 'Co cannot Pay Hist Avg'
      * BOH Company Number
     I                                    P   1   20ZA0014
      * Message data for 'Opt Not Allowed For Grd'
      * Carc Merit Pgm Code USR
     I                                        1   3 ZA0015
      * Message data for 'Opt not allowed unlss H/O'
      * *SFLSEL
     I                                        1   1 ZA0016
      * Message data for 'Invalid Process Code'
      * TH Tattoo Number
     I                                    P   1   30ZA0017
      * THP Process Code
     I                                        4   9 ZA0018
      * Message data for 'Co cannot Pay Hist Avg'
      * BOH Company Number
     I                                    P   1   20ZA0019
      * Message data for 'Evan Trans Already Exits'
      * *SFLSEL
     I                                        1   1 ZA0020
      * Message data for 'Carcass Dtl is Found'
      * *SFLSEL
     I                                        1   1 ZA0021
      * Message data for 'Payment Process not Allow'
      * Sel Processing
     I                                        1   1 ZA0022
      * Message data for 'Opt not allowed'
      * *SFLSEL
     I                                        1   1 ZA0023
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: WRK.First Time Flag Usr EQ WRK.Blank USR
     C           WUHBST    IFEQ WUCRTX                     *IF
     C                     MOVEL'1'       #2LIST           TH Schedule Kil
     C                     Z-ADDWUHONB    #2HMNB           BOH Company Num
     C                     Z-ADD#2HMNB    #PHONB           CC Company Numb
     C                     MOVEL'E'       #2DWST           TH Kill Balanci
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       WUHBST           First Time Flag
     C                     MOVEL'N'       P1ALST           PRT Night Queue
     C                     END                             *FI
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0001  30       CC Company Numb
     C           #PEUTX    PARM *BLANK    WQ0002 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0003  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#2HMNB    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
     C                     MOVEL@CN,001   YL0001           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0004  30       BOH Company Num
     C                     PARM YL0001    WQ0005 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0006 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: CTL.TH Kill Date EQ WRK.Zero USR
     C           #2B0DT    IFEQ WUE9NB                     *IF
      * RTV Payment Prc        RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1LIST           TH Schedule Kil
     C                     KFLD           A1B0DT           TH Kill Date
     C                     KFLD           A1DWST           TH Kill Balanci
     C                     KFLD           A1CVNB           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#2HMNB    A1HMNB
     C                     MOVEL#2LIST    A1LIST
     C                     Z-ADD#2B0DT    A1B0DT
     C                     MOVEL#2DWST    A1DWST
     C                     Z-ADD#2CVNB    A1CVNB
     C           KPOS      SETLL@A1CPHN
     C                     READ @A1CPHN                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2BICD    WZBICD
     C                     MOVEL#2BICD    WZBICD           TH Group Refere
     C           *LIKE     DEFN #2CPST    WZCPST
     C                     MOVEL#2CPST    WZCPST           TH Live Purchas
     C           *LIKE     DEFN #2ACPR    WZACPR
     C                     MOVEL#2ACPR    WZACPR           TH Live Purchas
     C           *LIKE     DEFN #2C4ST    WZC4ST
     C                     MOVEL#2C4ST    WZC4ST           TH Resale UOM
     C           *LIKE     DEFN #2AIPR    WZAIPR
     C                     MOVEL#2AIPR    WZAIPR           TH Recalc Live
     C           *LIKE     DEFN #2A6DT    WZA6DT
     C                     MOVEL#2A6DT    WZA6DT           TH Pricing Date
     C           *LIKE     DEFN #2C2ST    WZC2ST
     C                     MOVEL#2C2ST    WZC2ST           TH Resale Sprea
     C           *LIKE     DEFN #2CWST    WZCWST
     C                     MOVEL#2CWST    WZCWST           TH Payment Sts
     C           *LIKE     DEFN #2F2NB    WZF2NB
     C                     MOVEL#2F2NB    WZF2NB           TH Avg Backfat
     C           *LIKE     DEFN #2F3NB    WZF3NB
     C                     MOVEL#2F3NB    WZF3NB           TH Avg Loin Eye
     C           *LIKE     DEFN #2F4NB    WZF4NB
     C                     MOVEL#2F4NB    WZF4NB           TH Avg Lean Per
     C           *LIKE     DEFN #2F5NB    WZF5NB
     C                     MOVEL#2F5NB    WZF5NB           TH Avg Light Re
     C           *LIKE     DEFN #2AMPR    WZAMPR
     C                     MOVEL#2AMPR    WZAMPR           TH CM Base Mkt
     C           *LIKE     DEFN #2AVPC    WZAVPC
     C                     MOVEL#2AVPC    WZAVPC           TH Std Yield Pe
     C           *LIKE     DEFN #2A8PC    WZA8PC
     C                     MOVEL#2A8PC    WZA8PC           TH Yield Differ
     C           *LIKE     DEFN #2A7PC    WZA7PC
     C                     MOVEL#2A7PC    WZA7PC           TH Recalc Live
     C           *LIKE     DEFN #2ANPR    WZANPR
     C                     MOVEL#2ANPR    WZANPR           TH CM Base Mkt
     C           *LIKE     DEFN #2AYVA    WZAYVA
     C                     MOVEL#2AYVA    WZAYVA           TH CM Sort Disc
     C           *LIKE     DEFN #2AWVA    WZAWVA
     C                     MOVEL#2AWVA    WZAWVA           TH CM Yield Gai
     C           *LIKE     DEFN #2AOPR    WZAOPR
     C                     MOVEL#2AOPR    WZAOPR           TH CM Base Carc
     C           *LIKE     DEFN #2AXVA    WZAXVA
     C                     MOVEL#2AXVA    WZAXVA           TH CM LN AddOn/
     C           *LIKE     DEFN #2APPR    WZAPPR
     C                     MOVEL#2APPR    WZAPPR           TH CM Carcass G
     C           *LIKE     DEFN #2ASPR    WZASPR
     C                     MOVEL#2ASPR    WZASPR           TH Deduction Am
     C           *LIKE     DEFN #2A4VA    WZA4VA
     C                     MOVEL#2A4VA    WZA4VA           TH Total Net WO
     C           *LIKE     DEFN #2A5VA    WZA5VA
     C                     MOVEL#2A5VA    WZA5VA           TH Additions Am
     C           *LIKE     DEFN #2A7VA    WZA7VA
     C                     MOVEL#2A7VA    WZA7VA           TH Accrual Amou
     C           *LIKE     DEFN #2D6ST    WZD6ST
     C                     MOVEL#2D6ST    WZD6ST           TH Bal to Kill
     C           *LIKE     DEFN #2GHNB    WZGHNB
     C                     MOVEL#2GHNB    WZGHNB           TH Commission A
     C           *LIKE     DEFN #2BYDT    WZBYDT
     C                     MOVEL#2BYDT    WZBYDT           TH Voucher Paym
     C           *LIKE     DEFN #2E0ST    WZE0ST
     C                     MOVEL#2E0ST    WZE0ST           TH User Error O
     C           *LIKE     DEFN #2E1ST    WZE1ST
     C                     MOVEL#2E1ST    WZE1ST           TH Held Over Re
     C           *LIKE     DEFN #2E2ST    WZE2ST
     C                     MOVEL#2E2ST    WZE2ST           TH Sex
     C           *LIKE     DEFN #2BSDT    WZBSDT
     C                     MOVEL#2BSDT    WZBSDT           TH Held/Ovr Com
     C           *LIKE     DEFN #2BTDT    WZBTDT
     C                     MOVEL#2BTDT    WZBTDT           TH Commission P
     C           *LIKE     DEFN #2BUDT    WZBUDT
     C                     MOVEL#2BUDT    WZBUDT           TH Actual Check
     C           *LIKE     DEFN #2D7ST    WZD7ST
     C                     MOVEL#2D7ST    WZD7ST           TH Header Error
     C           *LIKE     DEFN #2D8ST    WZD8ST
     C                     MOVEL#2D8ST    WZD8ST           TH Detail Error
     C           *LIKE     DEFN #2FBNB    WZFBNB
     C                     MOVEL#2FBNB    WZFBNB           TH Tot Backfat
     C           *LIKE     DEFN #2A4PC    WZA4PC
     C                     MOVEL#2A4PC    WZA4PC           TH Tot Light Re
     C           *LIKE     DEFN #2F7NB    WZF7NB
     C                     MOVEL#2F7NB    WZF7NB           TH Avg Live Wgt
     C           *LIKE     DEFN #2A5PC    WZA5PC
     C                     MOVEL#2A5PC    WZA5PC           TH Tot Loin Eye
     C           *LIKE     DEFN #2AGCD    WZAGCD
     C                     MOVEL#2AGCD    WZAGCD           GN Genetic Code
     C           *LIKE     DEFN #2AAVN    WZAAVN
     C                     MOVEL#2AAVN    WZAAVN           RS User Changed
     C           *LIKE     DEFN #2AADT    WZAADT
     C                     MOVEL#2AADT    WZAADT           RS Date Changed
     C           *LIKE     DEFN #2AMTM    WZAMTM
     C                     MOVEL#2AMTM    WZAMTM           RS Time Changed
     C           *LIKE     DEFN #2AJST    WZAJST
     C                     MOVEL#2AJST    WZAJST           RS Record Statu
     C           *LIKE     DEFN #2AHVN    WZAHVN
     C                     MOVEL#2AHVN    WZAHVN           RS Job
     C           *LIKE     DEFN #2AGVN    WZAGVN
     C                     MOVEL#2AGVN    WZAGVN           RS Program
     C           *LIKE     DEFN #2ABVN    WZABVN
     C                     MOVEL#2ABVN    WZABVN           RS User Added
     C           *LIKE     DEFN #2ABDT    WZABDT
     C                     MOVEL#2ABDT    WZABDT           RS Date Added
     C           *LIKE     DEFN #2ABTM    WZABTM
     C                     MOVEL#2ABTM    WZABTM           RS Time Added
     C           *LIKE     DEFN #2BNNB    WZBNNB
     C                     MOVEL#2BNNB    WZBNNB           BOH Buy Order N
     C           *LIKE     DEFN #2BONB    WZBONB
     C                     MOVEL#2BONB    WZBONB           BOL Load Number
     C           *LIKE     DEFN #2CXNB    WZCXNB
     C                     MOVEL#2CXNB    WZCXNB           TH Dead On Arri
     C           *LIKE     DEFN #2ABCD    WZABCD
     C                     MOVEL#2ABCD    WZABCD           PD Producer Cod
     C           *LIKE     DEFN #2AWDT    WZAWDT
     C                     MOVEL#2AWDT    WZAWDT           TH Purchase Dat
     C           *LIKE     DEFN #2AWPC    WZAWPC
     C                     MOVEL#2AWPC    WZAWPC           TH Actual Yield
     C           *LIKE     DEFN #2BECD    WZBECD
     C                     MOVEL#2BECD    WZBECD           HC Class Code
     C           *LIKE     DEFN #2BDCD    WZBDCD
     C                     MOVEL#2BDCD    WZBDCD           DF Defect Code
     C           *LIKE     DEFN #2ATPR    WZATPR
     C                     MOVEL#2ATPR    WZATPR           TH Carcass Net
     C           *LIKE     DEFN #2HMNB    WZHMNB
     C                     MOVEL#2HMNB    WZHMNB           BOH Company Num
     C           *LIKE     DEFN #2B0DT    WZB0DT
     C                     MOVEL#2B0DT    WZB0DT           TH Kill Date
     C           *LIKE     DEFN #2LIST    WZLIST
     C                     MOVEL#2LIST    WZLIST           TH Schedule Kil
     C           *LIKE     DEFN #2DWST    WZDWST
     C                     MOVEL#2DWST    WZDWST           TH Kill Balanci
     C           *LIKE     DEFN #2CVNB    WZCVNB
     C                     MOVEL#2CVNB    WZCVNB           TH Tattoo Numbe
     C           *LIKE     DEFN #2CWNB    WZCWNB
     C                     MOVEL#2CWNB    WZCWNB           TH Head Receive
     C           *LIKE     DEFN #2FCNB    WZFCNB
     C                     MOVEL#2FCNB    WZFCNB           TH Yard Deads
     C           *LIKE     DEFN #2FDNB    WZFDNB
     C                     MOVEL#2FDNB    WZFDNB           TH Head Condemn
     C           *LIKE     DEFN #2FENB    WZFENB
     C                     MOVEL#2FENB    WZFENB           TH Head Killed
     C           *LIKE     DEFN #2H9NB    WZH9NB
     C                     MOVEL#2H9NB    WZH9NB           TH Held Over
     C           *LIKE     DEFN #2CYNB    WZCYNB
     C                     MOVEL#2CYNB    WZCYNB           TH Live Wgt
     C           *LIKE     DEFN #2E0NB    WZE0NB
     C                     MOVEL#2E0NB    WZE0NB           TH Hot Wgt
     C           *LIKE     DEFN #2CWPC    WZCWPC
     C                     MOVEL#2CWPC    WZCWPC           TH Adj Actual Y
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@A1CPHN                  90*
     C  N82                READ @A1CPHN                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,36
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2A8PC    IFNE *ZERO                      TH Yield Differ
     C           A1A8PC    CABNE#2A8PC    BB020            TH Yield Differ
     C                     END
     C           #2A7PC    IFNE *ZERO                      TH Recalc Live
     C           A1A7PC    CABNE#2A7PC    BB020            TH Recalc Live
     C                     END
     C           #2AYVA    IFNE *ZERO                      TH CM Sort Disc
     C           A1AYVA    CABNE#2AYVA    BB020            TH CM Sort Disc
     C                     END
     C           #2AWVA    IFNE *ZERO                      TH CM Yield Gai
     C           A1AWVA    CABNE#2AWVA    BB020            TH CM Yield Gai
     C                     END
     C           #2AXVA    IFNE *ZERO                      TH CM LN AddOn/
     C           A1AXVA    CABNE#2AXVA    BB020            TH CM LN AddOn/
     C                     END
     C           #2A4VA    IFNE *ZERO                      TH Total Net WO
     C           A1A4VA    CABNE#2A4VA    BB020            TH Total Net WO
     C                     END
     C           #2A5VA    IFNE *ZERO                      TH Additions Am
     C           A1A5VA    CABNE#2A5VA    BB020            TH Additions Am
     C                     END
     C           #2GHNB    IFNE *ZERO                      TH Commission A
     C           A1GHNB    CABNE#2GHNB    BB020            TH Commission A
     C                     END
     C           #2BYDT    IFNE *ZERO                      TH Voucher Paym
     C           A1BYDT    CABNE#2BYDT    BB020            TH Voucher Paym
     C                     END
     C           #2E0ST    IFNE *BLANK                     TH User Error O
     C           A1E0ST    CABNE#2E0ST    BB020            TH User Error O
     C                     END
     C           #2E1ST    IFNE *BLANK                     TH Held Over Re
     C           A1E1ST    CABNE#2E1ST    BB020            TH Held Over Re
     C                     END
     C           #2E2ST    IFNE *BLANK                     TH Sex
     C           A1E2ST    CABNE#2E2ST    BB020            TH Sex
     C                     END
     C           #2BSDT    IFNE *ZERO                      TH Held/Ovr Com
     C           A1BSDT    CABNE#2BSDT    BB020            TH Held/Ovr Com
     C                     END
     C           #2BTDT    IFNE *ZERO                      TH Commission P
     C           A1BTDT    CABNE#2BTDT    BB020            TH Commission P
     C                     END
     C           #2BUDT    IFNE *ZERO                      TH Actual Check
     C           A1BUDT    CABNE#2BUDT    BB020            TH Actual Check
     C                     END
     C           #2D7ST    IFNE *BLANK                     TH Header Error
     C           A1D7ST    CABNE#2D7ST    BB020            TH Header Error
     C                     END
     C           #2D8ST    IFNE *BLANK                     TH Detail Error
     C           A1D8ST    CABNE#2D8ST    BB020            TH Detail Error
     C                     END
     C           #2FBNB    IFNE *ZERO                      TH Tot Backfat
     C           A1FBNB    CABNE#2FBNB    BB020            TH Tot Backfat
     C                     END
     C           #2A4PC    IFNE *ZERO                      TH Tot Light Re
     C           A1A4PC    CABNE#2A4PC    BB020            TH Tot Light Re
     C                     END
     C           #2F7NB    IFNE *ZERO                      TH Avg Live Wgt
     C           A1F7NB    CABNE#2F7NB    BB020            TH Avg Live Wgt
     C                     END
     C           #2A5PC    IFNE *ZERO                      TH Tot Loin Eye
     C           A1A5PC    CABNE#2A5PC    BB020            TH Tot Loin Eye
     C                     END
     C           #2AGCD    IFNE *BLANK                     GN Genetic Code
     C           A1AGCD    CABNE#2AGCD    BB020            GN Genetic Code
     C                     END
     C           #2AAVN    IFNE *BLANK                     RS User Changed
     C           A1AAVN    CABNE#2AAVN    BB020            RS User Changed
     C                     END
     C           #2AADT    IFNE *ZERO                      RS Date Changed
     C           A1AADT    CABNE#2AADT    BB020            RS Date Changed
     C                     END
     C           #2AMTM    IFNE *ZERO                      RS Time Changed
     C           A1AMTM    CABNE#2AMTM    BB020            RS Time Changed
     C                     END
     C           #2AJST    IFNE *BLANK                     RS Record Statu
     C           A1AJST    CABNE#2AJST    BB020            RS Record Statu
     C                     END
     C           #2AHVN    IFNE *BLANK                     RS Job
     C           A1AHVN    CABNE#2AHVN    BB020            RS Job
     C                     END
     C           #2AGVN    IFNE *BLANK                     RS Program
     C           A1AGVN    CABNE#2AGVN    BB020            RS Program
     C                     END
     C           #2ABVN    IFNE *BLANK                     RS User Added
     C           A1ABVN    CABNE#2ABVN    BB020            RS User Added
     C                     END
     C           #2ABDT    IFNE *ZERO                      RS Date Added
     C           A1ABDT    CABNE#2ABDT    BB020            RS Date Added
     C                     END
     C           #2ABTM    IFNE *ZERO                      RS Time Added
     C           A1ABTM    CABNE#2ABTM    BB020            RS Time Added
     C                     END
     C           #2BNNB    IFNE *ZERO                      BOH Buy Order N
     C           A1BNNB    CABNE#2BNNB    BB020            BOH Buy Order N
     C                     END
     C           #2BONB    IFNE *ZERO                      BOL Load Number
     C           A1BONB    CABNE#2BONB    BB020            BOL Load Number
     C                     END
     C           #2AWDT    IFNE *ZERO                      TH Purchase Dat
     C           A1AWDT    CABNE#2AWDT    BB020            TH Purchase Dat
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2LIST    OREQ *BLANK                     TH Schedule Kil
     C           #2B0DT    IFNE *ZERO                      TH Kill Date
     C           A1B0DT    CABNE#2B0DT    BB020            TH Kill Date
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2LIST    IFNE *BLANK                     TH Schedule Kil
     C           A1LIST    CABNE#2LIST    BB020            TH Schedule Kil
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2LIST    OREQ *BLANK                     TH Schedule Kil
     C           #2B0DT    OREQ *ZERO                      TH Kill Date
     C           #2DWST    IFNE *BLANK                     TH Kill Balanci
     C           A1DWST    CABNE#2DWST    BB020            TH Kill Balanci
     C                     END
     C                     END
     C           #2HMNB    IFEQ *ZERO                      BOH Company Num
     C           #2LIST    OREQ *BLANK                     TH Schedule Kil
     C           #2B0DT    OREQ *ZERO                      TH Kill Date
     C           #2DWST    OREQ *BLANK                     TH Kill Balanci
     C           #2CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           A1CVNB    CABLT#2CVNB    BB020            TH Tattoo Numbe
     C                     END
     C                     END
     C           #2CWNB    IFNE *ZERO                      TH Head Receive
     C           A1CWNB    CABNE#2CWNB    BB020            TH Head Receive
     C                     END
     C           #2FDNB    IFNE *ZERO                      TH Head Condemn
     C           A1FDNB    CABNE#2FDNB    BB020            TH Head Condemn
     C                     END
     C           #2H9NB    IFNE *ZERO                      TH Held Over
     C           A1H9NB    CABNE#2H9NB    BB020            TH Held Over
     C                     END
     C           #2CWPC    IFNE *ZERO                      TH Adj Actual Y
     C           A1CWPC    CABNE#2CWPC    BB020            TH Adj Actual Y
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
     C                     EXSR MC#1FN
     C                     SUB  1         ##RR
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * only for specify kill date
      * CASE: DB1.TH Kill Date EQ CTL.TH Kill Date
     C           A1B0DT    IFEQ #2B0DT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * ONLY FOR SELECTED BALANCE OR ERROR RECORD, OR ALL
      * CASE: DB1.TH Kill Balancing Sts EQ CTL.TH Kill Balancing Sts
     C           A1DWST    IFEQ #2DWST                     *IF
     C                     ELSE
      * CASE: CTL.TH Kill Balancing Sts EQ WRK.Blank Usr 1 fld Usr
     C           #2DWST    IFEQ WUIXTX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * OMT:  Hog Class Type = Resale
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Only select Market, or subject
      * Do not select any resale hogs,
      * No resale hogs
      * CASE: DB1.TH Hog Class Type is Resale
     C           A1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Reverse Image Tattoo
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Check if there are any error for this tattoo, If so this routine
      * will check which error and flag field in reverse image.
      * RTV Check for Error   RT - Eval/Loss Error  * 
     C                     EXSR SBRVGN
      * CASE: RCD.Net Head Usr NE RCD.TH Head Killed
     C           #RF6NB    IFNE #1FENB                     *IF
     C                     MOVEL'Y'       #RFJST           Error Type 5 Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.TH Recalc Live Wgt is Greater than 0
     C           A1A7PC    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       #RP4ST           Status 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RP4ST           Status 1
     C                     END                             *FI
      * CASE: LCL.Held Over Records Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.TH Held Over is greater than 0
      *   |- c2    : RCD.TH Held Over Record is Yes
      *   '-
     C           #1H9NB    IFGT *ZERO                      *IF
     C           #1E1ST    OREQ 'Y'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @A1CPHN                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN81     IFNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN81     CAIN81  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate TH Kill Date
      * External date
     C                     Z-ADDV2B0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #2B0DT
      * Validate TH Schedule Kill Shift
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2LIST    W0NSRQ  1        TH Schedule Kil
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2LIST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100059   Y2LSNO  70
     C           #2LIST    PARM #2LIST    W0EXVL 25        TH Schedule Kil
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate TH Kill Balancing Sts
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2DWST    W0NSRQ  1        TH Kill Balanci
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2DWST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1104537   Y2LSNO  70
     C           #2DWST    PARM #2DWST    W0EXVL 25        TH Kill Balanci
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZHMNB    CASNE#2HMNB    FBRQRL
     C           WZB0DT    CASNE#2B0DT    FBRQRL
     C           WZLIST    CASNE#2LIST    FBRQRL
     C           WZDWST    CASNE#2DWST    FBRQRL
     C           WZCVNB    CASNE#2CVNB    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * CASE: CTL.*CMD key is Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: LCL.Held Over Records Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0004           Held Over Recor
     C                     ELSE
      * CASE: LCL.Held Over Records Y/N is No
     C           YL0004    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0004           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0007  30       CC Company Numb
     C           #PEUTX    PARM *BLANK    WQ0008 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0009  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#2HMNB    ZA0002           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      * CASE: CTL.TH Kill Date EQ WRK.Zero USR
     C           #2B0DT    IFEQ WUE9NB                     *IF
     C                     Z-ADD##JDT     #2B0DT           TH Kill Date
     C                     END                             *FI
      * F21-Print Bal to Kill Report
      * CASE: CTL.*CMD key is Print List
     C           *IN21     IFEQ '1'                        *IF
      * Pmt Print Options     XF - STR Order Management Sys  * 
     C                     CALL 'PDG0PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0010 25        PRT Description
     C           P1ACVN    PARM P1ACVN    WQ0011 10        PRT Printer Dev
     C           P1AKST    PARM P1AKST    WQ0012  4        PRT Hold Output
     C           P1AMST    PARM P1AMST    WQ0013  4        PRT Save Output
     C           P1AKNB    PARM P1AKNB    WQ0014  20       PRT Copies
     C           P1ALST    PARM P1ALST    WQ0015  1        PRT Night Queue
     C           P1AIVN    PARM P1AIVN    WQ0016 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0017  6        Oms Application
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL#2B0DT    WUCZCD           Date Alpha USR
      * Setup message data for message
     C                     Z-ADD#2HMNB    ZA0003           BOH Company Num
     C                     MOVELWUCZCD    ZA0004           Date Alpha USR
     C                     MOVELP1ACVN    ZA0005           PRT Printer Dev
     C                     MOVELP1AKST    ZA0006           PRT Hold Output
     C                     MOVELP1AMST    ZA0007           PRT Save Output
     C                     Z-ADDP1AKNB    ZA0008           PRT Copies
     C                     MOVELP1AIVN    ZA0009           PRT Night Queue
     C                     MOVELP2EVTX    ZA0010           Oms System Valu
     C                     MOVEL#2LIST    ZA0011           TH Schedule Kil
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0686' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     993133*
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
     C                     EXSR MC#1FN
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
     C                     MOVEL'N'       WUG2ST           Requested by Us
      * Subfile selection User
      * CASE: RCD.*SFLSEL NE WRK.Blank USR
     C           #1SEL     IFNE WUCRTX                     *IF
      * E9815 JBB  3/29/17  Check if company excluded from subfile option
      * Rtv Company Values    XF - STR Order Management Sys  * XCOPAYHIST
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0018  30       BOH Company Num
     C                     PARM @CN,003   WQ0019 10        Company Value C
     C           YL0005    PARM *BLANK    WQ0020 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      * Valid Option
      * CASE: RCD.*SFLSEL is WW Evaluation
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVE #1CVNB    WUFINB           ET Tattoo Numbe
      * WW Eval Tran Dsp Only DF - Eval Trans  * 
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PABONB           BOL Load Number
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKTKDFR'              90  WW Eval Tran Ds
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Eval Trans
     C                     PARM #1AWDT    WQ0021  70       TH Purchase Dat
     C                     PARM #1BICD    WQ0022 10        TH Group Refere
     C                     PARM #1CPST    WQ0023  2        TH Live Purchas
     C                     PARM #1ACPR    WQ0024  52       TH Live Purchas
     C                     PARM #1C4ST    WQ0025  2        TH Resale UOM
     C                     PARM #1AIPR    WQ0026  52       TH Recalc Live
     C                     PARM #1A6DT    WQ0027  70       TH Pricing Date
     C                     PARM #1C2ST    WQ0028  1        TH Resale Sprea
     C                     PARM #1CXNB    WQ0029  50       TH Dead On Arri
     C                     PARM #1CWNB    WQ0030  50       TH Head Receive
     C                     PARM #1FCNB    WQ0031  50       TH Yard Deads
     C                     PARM #1FDNB    WQ0032  50       TH Head Condemn
     C                     PARM #1FENB    WQ0033  50       TH Head Killed
     C                     PARM #1HFNB    WQ0034  50       TH Head Accepte
     C                     PARM #1CYNB    WQ0035  71       TH Live Wgt
     C                     PARM #1E0NB    WQ0036  71       TH Hot Wgt
     C                     PARM #1A5PC    WQ0037  61       TH Tot Loin Eye
     C                     PARM #1FBNB    WQ0038  61       TH Tot Backfat
     C                     PARM #1A4PC    WQ0039  61       TH Tot Light Re
     C                     PARM #1F7NB    WQ0040  51       TH Avg Live Wgt
     C                     PARM #1HDNB    WQ0041  51       TH Avg Hot Wgt
     C                     PARM #1F5NB    WQ0042  31       TH Avg Light Re
     C                     PARM #1F4NB    WQ0043  31       TH Avg Lean Per
     C                     PARM #1F3NB    WQ0044  31       TH Avg Loin Eye
     C                     PARM #1F2NB    WQ0045  31       TH Avg Backfat
     C                     PARM #1AVPC    WQ0046  52       TH Std Yield Pe
     C                     PARM #1AWPC    WQ0047  52       TH Actual Yield
     C                     PARM #1CWPC    WQ0048  52       TH Adj Actual Y
     C                     PARM #1A8PC    WQ0049  52       TH Yield Differ
     C                     PARM #1A7PC    WQ0050  31       TH Recalc Live
     C                     PARM #1AMPR    WQ0051  52       TH CM Base Mkt
     C                     PARM #1ANPR    WQ0052  72       TH CM Base Mkt
     C                     PARM #1AYVA    WQ0053  72       TH CM Sort Disc
     C                     PARM #1AWVA    WQ0054  72       TH CM Yield Gai
     C                     PARM #1AOPR    WQ0055  72       TH CM Base Carc
     C                     PARM #1AXVA    WQ0056  72       TH CM LN AddOn/
     C                     PARM #1APPR    WQ0057  72       TH CM Carcass G
     C                     PARM #1ASPR    WQ0058  72       TH Deduction Am
     C                     PARM #1CWST    WQ0059  2        TH Payment Sts
     C                     PARM #1D7ST    WQ0060  1        TH Header Error
     C                     PARM #1D8ST    WQ0061  1        TH Detail Error
     C                     PARM #1DWST    WQ0062  1        TH Kill Balanci
     C                     PARM #1D6ST    WQ0063  1        TH Bal to Kill
     C                     PARM #1HHNB    WQ0064  71       TH Avg Hot Wgt
     C                     PARM #1LIST    WQ0065  1        TH Schedule Kil
     C                     PARM #1T2WT    WQ0066  71       TH Avg Lean % E
     C                     PARM #1KOER    WQ0067  50       TH Head Identif
     C                     PARM #1OPIR    WQ0068  52       TH Percent Iden
     C                     PARM #1OPEM    WQ0069  52       TH Percent Acce
     C                     PARM #1OQET    WQ0070  1        TH PHA Add Type
     C                     PARM #1URST    WQ0071  3        TH PHA Average
     C                     PARM #1USST    WQ0072  1        TH PHA Add Reas
     C                     PARM #1ORJK    WQ0073  52       TH Yld Parm Adj
     C                     PARM #1BDCD    WQ0074  6        DF Defect Code
     C                     PARM #1CSCD    WQ0075  6        THP Process Cod
     C                     PARM #1ABCD    WQ0076  6        PD Producer Cod
     C                     PARM #1AECD    WQ0077  6        PL Location Cod
     C                     PARM #1AGCD    WQ0078  5        GN Genetic Code
     C                     PARM #1BECD    WQ0079  3        HC Class Code
     C                     PARM #RF6NB    WQ0080  50       Net Head Usr
     C                     PARM P2EVTX    WQ0081 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 7 request
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * display historical avg
      * Dsp Prcdr Histrcl Avg DF - Producer History WKLY  * 
     C                     CLEARPBRC
     C                     Z-ADD#1HMNB    PBY3A1           PH Company Numb
     C                     MOVEL#1ABCD    PBABCD    P      PD Producer Cod
      *
     C                     CALL 'PKT0DFR'              90  Dsp Prcdr Histr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Producer H
     C                     PARM P2EVTX    WQ0082 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKT0DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Select Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Display Error
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Dsp Error             DF - Eval/Loss Error  * 
     C                     CLEARPCRC
     C                     Z-ADD#1HMNB    PCHRNB           KV Company Numb
     C                     Z-ADD#1B0DT    PCBPDT           KV Kill Date
     C                     Z-ADD#1CVNB    PCIRNB           KV TATTOO NUMBE
     C                     Z-ADD#1BNNB    PCBONM           KV Buy Order Nu
     C                     Z-ADD#1BONB    PCLDNM           KV Load Number
     C                     Z-ADD*ZERO     PCFPNB           KV Record Numbe
     C                     MOVEL'H'       PCDYST    P      KV Record Type
      *
     C                     CALL 'PKEUDFR'              90  Dsp Error
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Eval/Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKEUDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 10 (Reusable)
     C           #1SEL     IFEQ '10'                       *IF
      * Display Loss Transactions
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Dsp Loss Transactions DF - Loss Trans  * 
     C                     CLEARPDRC
     C                     Z-ADD#1HMNB    PDHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PDBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PDBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PDCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PDB0DT           TH Kill Date
      *
     C                     CALL 'PKT4DFR'              90  Dsp Loss Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Loss Trans
     C                     PARM #1AWDT    WQ0083  70       TH Purchase Dat
     C                     PARM #1BICD    WQ0084 10        TH Group Refere
     C                     PARM #1CPST    WQ0085  2        TH Live Purchas
     C                     PARM #1ACPR    WQ0086  52       TH Live Purchas
     C                     PARM #1C4ST    WQ0087  2        TH Resale UOM
     C                     PARM #1AIPR    WQ0088  52       TH Recalc Live
     C                     PARM #1A6DT    WQ0089  70       TH Pricing Date
     C                     PARM #1C2ST    WQ0090  1        TH Resale Sprea
     C                     PARM #1CXNB    WQ0091  50       TH Dead On Arri
     C                     PARM #1CWNB    WQ0092  50       TH Head Receive
     C                     PARM #1FCNB    WQ0093  50       TH Yard Deads
     C                     PARM #1FDNB    WQ0094  50       TH Head Condemn
     C                     PARM #1FENB    WQ0095  50       TH Head Killed
     C                     PARM #1CYNB    WQ0096  71       TH Live Wgt
     C                     PARM #1E0NB    WQ0097  71       TH Hot Wgt
     C                     PARM #1A5PC    WQ0098  61       TH Tot Loin Eye
     C                     PARM #1FBNB    WQ0099  61       TH Tot Backfat
     C                     PARM #1A4PC    WQ0100  61       TH Tot Light Re
     C                     PARM #1AVPC    WQ0101  52       TH Std Yield Pe
     C                     PARM #1AWPC    WQ0102  52       TH Actual Yield
     C                     PARM #1AMPR    WQ0103  52       TH CM Base Mkt
     C                     PARM #1ANPR    WQ0104  72       TH CM Base Mkt
     C                     PARM #1AOPR    WQ0105  72       TH CM Base Carc
     C                     PARM #1APPR    WQ0106  72       TH CM Carcass G
     C                     PARM #1ASPR    WQ0107  72       TH Deduction Am
     C                     PARM #1ATPR    WQ0108  72       TH Carcass Net
     C                     PARM #1CWST    WQ0109  2        TH Payment Sts
     C                     PARM #1DWST    WQ0110  1        TH Kill Balanci
     C                     PARM #1LIST    WQ0111  1        TH Schedule Kil
     C                     PARM #1BDCD    WQ0112  6        DF Defect Code
     C                     PARM #1ABCD    WQ0113  6        PD Producer Cod
     C                     PARM #1AECD    WQ0114  6        PL Location Cod
     C                     PARM #1AGCD    WQ0115  5        GN Genetic Code
     C                     PARM #1BECD    WQ0116  3        HC Class Code
     C                     PARM #PEVTX    WQ0117 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKT4DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 13 (Reusable)
     C           #1SEL     IFEQ '13'                       *IF
      * Display Additional Tattoo Info
      * Rtv Prdcr Name, Sts   RT - Producer  * 
     C                     EXSR SDRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Dsp Add Tattoo Info   D1 - Tattoo Header  * 
     C                     CLEARPERC
     C                     Z-ADD#1HMNB    PEHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PEBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PEBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PECVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PEB0DT           TH Kill Date
      *
     C                     CALL 'PKRXD1R'              90  Dsp Add Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Tattoo Hea
     C                     PARM WUAGTX    WQ0118 25        Name Producer U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKRXD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 14 (Resuable)
     C           #1SEL     IFEQ '14'                       *IF
      * Edit Comments
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt Tattoo Comment    EF - Tattoo Header Comment  * 
     C                     CLEARPFRC
     C                     Z-ADD#1HMNB    PFHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PFBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PFBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PFCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PFB0DT           TH Kill Date
     C                     MOVELYL0006    PFETST    P      THC Comment Typ
      *
     C                     CALL 'PKIVEFR'              90  Edt Tattoo Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Tattoo Hea
     C                     PARM #PEVTX    WQ0119 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKIVEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : RCD.*SFLSEL is Option 81
      *   |- c2    : JOB.*USER is Pork Test User
      *   |- c3    : JOB.*USER is Purva Patel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1SEL     IFEQ '81'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           ##USR     IFEQ @CN,004                    *IF
     C           ##USR     OREQ @CN,005                    *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SERVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPGRC
     C                     Z-ADD#1HMNB    PGHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PGBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PGB0DT           TH Kill Date
     C                     Z-ADD#1AWDT    PGAWDT           TH Purchase Dat
     C                     MOVEL#1BICD    PGBICD    P      TH Group Refere
     C                     MOVEL#1CPST    PGCPST    P      TH Live Purchas
     C                     Z-ADD#1ACPR    PGACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    PGB9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    PGCAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    PGC4ST    P      TH Resale UOM
     C                     Z-ADD#1AIPR    PGAIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    PGA6DT           TH Pricing Date
     C                     MOVEL#1C2ST    PGC2ST    P      TH Resale Sprea
     C                     Z-ADD#1CXNB    PGCXNB           TH Dead On Arri
     C                     Z-ADD#1CWNB    PGCWNB           TH Head Receive
     C                     Z-ADD#1FCNB    PGFCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    PGH9NB           TH Held Over
     C                     Z-ADD#1FDNB    PGFDNB           TH Head Condemn
     C                     Z-ADD#1FENB    PGFENB           TH Head Killed
     C                     Z-ADD#1HENB    PGHENB           TH Head Adds
     C                     Z-ADD#1HFNB    PGHFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    PGCYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    PGLRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    PGE0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    PGA5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    PGFBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    PGA4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    PGF7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    PGF5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    PGF4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    PGF3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    PGF2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    PGAVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    PGAWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    PGCWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    PGA8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    PGA7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    PGB8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    PGAMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    PGANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    PGAYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    PGAWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    PGAOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    PGAXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    PGAPPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    PGASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    PGA4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    PGATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    PGA5VA           TH Additions Am
     C                     Z-ADD#1CBPR    PGCBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    PGCCPR           Th Payment Net
     C                     Z-ADD#1LPNB    PGLPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    PGCDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    PGA7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    PGA2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    PGJWST    P      TH Calc Net Sts
     C                     MOVEL#1CWST    PGCWST    P      TH Payment Sts
     C                     MOVEL#1D6ST    PGD6ST    P      TH Bal to Kill
     C                     Z-ADD#1GHNB    PGGHNB           TH Commission A
     C                     Z-ADD#1BYDT    PGBYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    PGE0ST    P      TH User Error O
     C                     MOVEL#1E1ST    PGE1ST    P      TH Held Over Re
     C                     MOVEL#1E2ST    PGE2ST    P      TH Sex
     C                     Z-ADD#1BSDT    PGBSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    PGBTDT           TH Commission P
     C                     Z-ADD#1BUDT    PGBUDT           TH Actual Check
     C                     Z-ADD#1HGNB    PGHGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    PGHINB           TH FFLI
     C                     Z-ADD#1A3PR    PGA3PR           TH Kill Product
     C                     Z-ADD#1A4PR    PGA4PR           TH Cut Product
     C                     Z-ADD#1A6PR    PGA6PR           TH Render Produ
     C                     Z-ADD#1J9NB    PGJ9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    PGEAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    PGEBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    PGECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    PGEDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    PGEEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    PGEFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    PGEGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    PGEHPR           TH CM Gross Car
     C                     MOVEL#1KAST    PGKAST    P      TH Source Type
     C                     MOVEL#1J7ST    PGJ7ST    P      TH Scale Ticket
     C                     MOVEL#1J9ST    PGJ9ST    P      TH Payment Type
     C                     Z-ADD#1OXNB    PGOXNB           TH HPS Movement
     C                     MOVEL#1LKST    PGLKST    P      TH Source Code
     C                     MOVEL#1LLST    PGLLST    P      TH Hog Class Ty
     C                     MOVEL#1J8ST    PGJ8ST    P      TH Posted to HP
     C                     MOVEL#1LIST    PGLIST    P      TH Schedule Kil
     C                     MOVEL#1LJST    PGLJST    P      TH Shift Held O
     C                     MOVEL#1BDCD    PGBDCD    P      DF Defect Code
     C                     MOVEL#1CSCD    PGCSCD    P      THP Process Cod
     C                     MOVEL#1ABCD    PGABCD    P      PD Producer Cod
     C                     MOVEL#1AECD    PGAECD    P      PL Location Cod
     C                     MOVEL#1ACCD    PGACCD    P      HB Buyer Code
     C                     MOVEL#1AGCD    PGAGCD    P      GN Genetic Code
     C                     MOVEL#1BECD    PGBECD    P      HC Class Code
     C                     MOVEL#1AAVN    PGAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    PGAADT           RS Date Changed
     C                     Z-ADD#1AMTM    PGAMTM           RS Time Changed
     C                     MOVEL#1AJST    PGAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    PGAHVN    P      RS Job
     C                     MOVEL#1AGVN    PGAGVN    P      RS Program
     C                     MOVEL#1ABVN    PGABVN    P      RS User Added
     C                     Z-ADD#1ABDT    PGABDT           RS Date Added
     C                     Z-ADD#1ABTM    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0120  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0121  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0122  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0123  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0124  71       %Lean High Min
     C                     PARM YL0012    WQ0125  71       %Lean High Max
     C                     PARM YL0013    WQ0126  71       %Lean Low Min
     C                     PARM YL0014    WQ0127  71       %Lean Low Max
     C                     PARM YL0015    WQ0128  71       High Yield Min
     C                     PARM YL0016    WQ0129  71       High Yield Max
     C                     PARM YL0017    WQ0130  71       Low Yield Min
     C                     PARM YL0018    WQ0131  71       Low Yield Max
     C                     PARM YL0019    WQ0132  71       Head < Percent
     C                     PARM YL0020    WQ0133  71       Head < Percent
     C                     PARM YL0021    WQ0134  71       Head > Percent
     C                     PARM YL0022    WQ0135  71       Head > Percent
     C                     PARM YL0023    WQ0136  71       BackFat High Mi
     C                     PARM YL0024    WQ0137  71       BackFat High Ma
     C                     PARM YL0025    WQ0138  71       BackFat Low Min
     C                     PARM YL0026    WQ0139  71       Backfat Low Max
     C                     PARM YL0027    WQ0140  71       LoinEye High Mi
     C                     PARM YL0028    WQ0141  71       LoinEye High Ma
     C                     PARM YL0029    WQ0142  71       LoinEye Low Min
     C                     PARM YL0030    WQ0143  71       LoinEye Low Max
     C                     PARM 'N'       WQ0144  1        Requested by Us
     C                     PARM *BLANK    WQ0145  1        Bal w/History
     C                     PARM *BLANK    WQ0146  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0147  3        TH PHA Average
     C                     PARM *BLANK    WQ0148  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0149  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0150  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0151  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0152  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0153  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0154  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0155  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0156  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0157  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0158  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Option Valid Prior to Payment.
      * CASE: Receiving or Slaughter is only allowed for pgm
      *  - c1 OR c2
      *   |- c1    : RCD.THP Process Code is Receiving
      *   |- c2    : RCD.THP Process Code is Slaughter
      *   '-
     C           #1CSCD    IFEQ 'RECV'                     *IF
     C           #1CSCD    OREQ 'SLG'                      *OR
      * CASE: RCD.*SFLSEL is *option 9 request
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * Edit Live Price
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Edt Live Price        E1 - Tattoo Header  * 
     C                     CLEARPHRC
     C                     Z-ADD#1HMNB    PHHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PHBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PHBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PHCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PHB0DT           TH Kill Date
      *
     C                     CALL 'PKGBE1R'              90  Edt Live Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PHRC             KEY: Tattoo Hea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGBE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 11 (Reusable)
     C           #1SEL     IFEQ '11'                       *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.TH Held Over is greater than 0
      *   |- c2    : RCD.TH Held Over Record is Yes
      *   '-
     C           #1H9NB    IFGT *ZERO                      *IF
     C           #1E1ST    OREQ 'Y'                        *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0012           *SFLSEL
      * Send message 'Opt not allowed'
     C                     MOVEL'PRK0648' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Re-Balance Tattoo
      * Edt Tattoo Comment    EF - Tattoo Header Comment  * 
     C                     CLEARPFRC
     C                     Z-ADD#1HMNB    PFHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PFBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PFBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PFCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PFB0DT           TH Kill Date
     C                     MOVEL'B'       PFETST    P      THC Comment Typ
      *
     C                     CALL 'PKIVEFR'              90  Edt Tattoo Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Tattoo Hea
     C                     PARM #PEVTX    WQ0159 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKIVEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Val Comment Exist     RT - Tattoo Header Comment  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Record Found USR is Record Found
     C           YL0032    IFEQ 'Y'                        *IF
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SGRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPGRC
     C                     Z-ADD#1HMNB    PGHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PGBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PGB0DT           TH Kill Date
     C                     Z-ADD#1AWDT    PGAWDT           TH Purchase Dat
     C                     MOVEL#1BICD    PGBICD    P      TH Group Refere
     C                     MOVEL#1CPST    PGCPST    P      TH Live Purchas
     C                     Z-ADD#1ACPR    PGACPR           TH Live Purchas
     C                     Z-ADD#1B9PR    PGB9PR           TH Live Gross A
     C                     Z-ADD#1CAPR    PGCAPR           TH LIve Net Amt
     C                     MOVEL#1C4ST    PGC4ST    P      TH Resale UOM
     C                     Z-ADD#1AIPR    PGAIPR           TH Recalc Live
     C                     Z-ADD#1A6DT    PGA6DT           TH Pricing Date
     C                     MOVEL#1C2ST    PGC2ST    P      TH Resale Sprea
     C                     Z-ADD#1CXNB    PGCXNB           TH Dead On Arri
     C                     Z-ADD#1CWNB    PGCWNB           TH Head Receive
     C                     Z-ADD#1FCNB    PGFCNB           TH Yard Deads
     C                     Z-ADD#1H9NB    PGH9NB           TH Held Over
     C                     Z-ADD#1FDNB    PGFDNB           TH Head Condemn
     C                     Z-ADD#1FENB    PGFENB           TH Head Killed
     C                     Z-ADD#1HENB    PGHENB           TH Head Adds
     C                     Z-ADD#1HFNB    PGHFNB           TH Head Accepte
     C                     Z-ADD#1CYNB    PGCYNB           TH Live Wgt
     C                     Z-ADD#1LRNB    PGLRNB           TH Adj Live Wgt
     C                     Z-ADD#1E0NB    PGE0NB           TH Hot Wgt
     C                     Z-ADD#1A5PC    PGA5PC           TH Tot Loin Eye
     C                     Z-ADD#1FBNB    PGFBNB           TH Tot Backfat
     C                     Z-ADD#1A4PC    PGA4PC           TH Tot Light Re
     C                     Z-ADD#1F7NB    PGF7NB           TH Avg Live Wgt
     C                     Z-ADD#1HDNB    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADD#1F5NB    PGF5NB           TH Avg Light Re
     C                     Z-ADD#1F4NB    PGF4NB           TH Avg Lean Per
     C                     Z-ADD#1F3NB    PGF3NB           TH Avg Loin Eye
     C                     Z-ADD#1F2NB    PGF2NB           TH Avg Backfat
     C                     Z-ADD#1AVPC    PGAVPC           TH Std Yield Pe
     C                     Z-ADD#1AWPC    PGAWPC           TH Actual Yield
     C                     Z-ADD#1CWPC    PGCWPC           TH Adj Actual Y
     C                     Z-ADD#1A8PC    PGA8PC           TH Yield Differ
     C                     Z-ADD#1A7PC    PGA7PC           TH Recalc Live
     C                     Z-ADD#1B8PR    PGB8PR           TH CM Market Pr
     C                     Z-ADD#1AMPR    PGAMPR           TH CM Base Mkt
     C                     Z-ADD#1ANPR    PGANPR           TH CM Base Mkt
     C                     Z-ADD#1AYVA    PGAYVA           TH CM Sort Disc
     C                     Z-ADD#1AWVA    PGAWVA           TH CM Yield Gai
     C                     Z-ADD#1AOPR    PGAOPR           TH CM Base Carc
     C                     Z-ADD#1AXVA    PGAXVA           TH CM LN AddOn/
     C                     Z-ADD#1APPR    PGAPPR           TH CM Carcass G
     C                     Z-ADD#1ASPR    PGASPR           TH Deduction Am
     C                     Z-ADD#1A4VA    PGA4VA           TH Total Net WO
     C                     Z-ADD#1ATPR    PGATPR           TH Carcass Net
     C                     Z-ADD#1A5VA    PGA5VA           TH Additions Am
     C                     Z-ADD#1CBPR    PGCBPR           TH Payment Gros
     C                     Z-ADD#1CCPR    PGCCPR           Th Payment Net
     C                     Z-ADD#1LPNB    PGLPNB           TH AP Voucher/D
     C                     Z-ADD#1CDPR    PGCDPR           TH Freight Amou
     C                     Z-ADD#1A7VA    PGA7VA           TH Accrual Amou
     C                     Z-ADD#1A2PR    PGA2PR           TH Fixed Cost A
     C                     MOVEL#1JWST    PGJWST    P      TH Calc Net Sts
     C                     MOVEL#1CWST    PGCWST    P      TH Payment Sts
     C                     MOVEL#1D6ST    PGD6ST    P      TH Bal to Kill
     C                     Z-ADD#1GHNB    PGGHNB           TH Commission A
     C                     Z-ADD#1BYDT    PGBYDT           TH Voucher Paym
     C                     MOVEL#1E0ST    PGE0ST    P      TH User Error O
     C                     MOVEL#1E1ST    PGE1ST    P      TH Held Over Re
     C                     MOVEL#1E2ST    PGE2ST    P      TH Sex
     C                     Z-ADD#1BSDT    PGBSDT           TH Held/Ovr Com
     C                     Z-ADD#1BTDT    PGBTDT           TH Commission P
     C                     Z-ADD#1BUDT    PGBUDT           TH Actual Check
     C                     Z-ADD#1HGNB    PGHGNB           TH Shipped Weig
     C                     Z-ADD#1HHNB    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADD#1HINB    PGHINB           TH FFLI
     C                     Z-ADD#1A3PR    PGA3PR           TH Kill Product
     C                     Z-ADD#1A4PR    PGA4PR           TH Cut Product
     C                     Z-ADD#1A6PR    PGA6PR           TH Render Produ
     C                     Z-ADD#1J9NB    PGJ9NB           TH Head Exclude
     C                     Z-ADD#1D6PR    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADD#1D7PR    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADD#1D8PR    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADD#1D9PR    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADD#1EAPR    PGEAPR           TH CM Yld G/L L
     C                     Z-ADD#1EBPR    PGEBPR           TH CM Yld G/L C
     C                     Z-ADD#1ECPR    PGECPR           TH CM Crc Val L
     C                     Z-ADD#1EDPR    PGEDPR           TH CM Crc Val C
     C                     Z-ADD#1EEPR    PGEEPR           TH CM Lean Prem
     C                     Z-ADD#1EFPR    PGEFPR           TH CM Lean Prem
     C                     Z-ADD#1EGPR    PGEGPR           TH CM Gross Liv
     C                     Z-ADD#1EHPR    PGEHPR           TH CM Gross Car
     C                     MOVEL#1KAST    PGKAST    P      TH Source Type
     C                     MOVEL#1J7ST    PGJ7ST    P      TH Scale Ticket
     C                     MOVEL#1J9ST    PGJ9ST    P      TH Payment Type
     C                     Z-ADD#1OXNB    PGOXNB           TH HPS Movement
     C                     MOVEL#1LKST    PGLKST    P      TH Source Code
     C                     MOVEL#1LLST    PGLLST    P      TH Hog Class Ty
     C                     MOVEL#1J8ST    PGJ8ST    P      TH Posted to HP
     C                     MOVEL#1LIST    PGLIST    P      TH Schedule Kil
     C                     MOVEL#1LJST    PGLJST    P      TH Shift Held O
     C                     MOVEL#1BDCD    PGBDCD    P      DF Defect Code
     C                     MOVEL#1CSCD    PGCSCD    P      THP Process Cod
     C                     MOVEL#1ABCD    PGABCD    P      PD Producer Cod
     C                     MOVEL#1AECD    PGAECD    P      PL Location Cod
     C                     MOVEL#1ACCD    PGACCD    P      HB Buyer Code
     C                     MOVEL#1AGCD    PGAGCD    P      GN Genetic Code
     C                     MOVEL#1BECD    PGBECD    P      HC Class Code
     C                     MOVEL#1AAVN    PGAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    PGAADT           RS Date Changed
     C                     Z-ADD#1AMTM    PGAMTM           RS Time Changed
     C                     MOVEL#1AJST    PGAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    PGAHVN    P      RS Job
     C                     MOVEL#1AGVN    PGAGVN    P      RS Program
     C                     MOVEL#1ABVN    PGABVN    P      RS User Added
     C                     Z-ADD#1ABDT    PGABDT           RS Date Added
     C                     Z-ADD#1ABTM    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0160  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0161  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0162  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0163  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0164  71       %Lean High Min
     C                     PARM YL0012    WQ0165  71       %Lean High Max
     C                     PARM YL0013    WQ0166  71       %Lean Low Min
     C                     PARM YL0014    WQ0167  71       %Lean Low Max
     C                     PARM YL0015    WQ0168  71       High Yield Min
     C                     PARM YL0016    WQ0169  71       High Yield Max
     C                     PARM YL0017    WQ0170  71       Low Yield Min
     C                     PARM YL0018    WQ0171  71       Low Yield Max
     C                     PARM YL0019    WQ0172  71       Head < Percent
     C                     PARM YL0020    WQ0173  71       Head < Percent
     C                     PARM YL0021    WQ0174  71       Head > Percent
     C                     PARM YL0022    WQ0175  71       Head > Percent
     C                     PARM YL0023    WQ0176  71       BackFat High Mi
     C                     PARM YL0024    WQ0177  71       BackFat High Ma
     C                     PARM YL0025    WQ0178  71       BackFat Low Min
     C                     PARM YL0026    WQ0179  71       Backfat Low Max
     C                     PARM YL0027    WQ0180  71       LoinEye High Mi
     C                     PARM YL0028    WQ0181  71       LoinEye High Ma
     C                     PARM YL0029    WQ0182  71       LoinEye Low Min
     C                     PARM YL0030    WQ0183  71       LoinEye Low Max
     C                     PARM 'N'       WQ0184  1        Requested by Us
     C                     PARM *BLANK    WQ0185  1        Bal w/History
     C                     PARM *BLANK    WQ0186  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0187  3        TH PHA Average
     C                     PARM *BLANK    WQ0188  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0189  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0190  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0191  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0192  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0193  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0194  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0195  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0196  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0197  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0198  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *  6/07/2021 JBB SDD619 - Repayments by Business Users
     C                     EXSR UASUBR                      6/07/2021 JBB
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'ReBal Comments Req'
     C                     MOVEL'PRK0929' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 19
     C           #1SEL     IFEQ '19'                       *IF
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : RCD.TH Held Over is greater than 0
      *   |- c2    : RCD.TH Held Over Record is Yes
      *   |- c3    : RCD.TH Source Type is Internal
      *   '-
     C           #1H9NB    IFGT *ZERO                      *IF
     C           #1E1ST    OREQ 'Y'                        *OR
     C           #1KAST    OREQ 'I'                        *OR
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Send message 'Opt not allowed'
     C                     MOVEL'PRK0648' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Recalc LvWgt Yld  E1 - Tattoo Header  * 
     C                     CLEARPIRC
     C                     Z-ADD#1HMNB    PIHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PIBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PIBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PICVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PIB0DT           TH Kill Date
      *
     C                     CALL 'PLEYE1R'              90  Edt Recalc LvWg
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PIRC             KEY: Tattoo Hea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLEYE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 15 (Resuable)
     C           #1SEL     IFEQ '15'                       *IF
      * If Exclude Company from Payment History/Average flag <> No
      * CASE: LCL.Exclude Flag is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HMNB    ZA0014           BOH Company Num
      * Send message 'Co cannot Pay Hist Avg'
     C                     MOVEL'PRK1420' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * pay w/historical avgs
      * Rtv BO Info           RT - Buy Order Header  * 
     C                     EXSR SIRVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SJRVGN
      * CASE: LCL.CMP Grading Type is Meat Value
     C           YL0042    IFEQ 'M'                        *IF
      * Setup message data for message
     C                     MOVELYL0040    ZA0015           CMP Program Cod
      * Send message 'Opt Not Allowed For Grd'
     C                     MOVEL'PRK1157' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Pmt Pay w/Hist Avgs   PV - Tattoo Header  * 
     C                     CALL 'PKTNPVR'              90  Pmt Pay w/Hist
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0199  30       BOH Company Num
     C                     PARM #1BNNB    WQ0200  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0201  50       BOL Load Number
     C                     PARM #1CVNB    WQ0202  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0203  70       TH Kill Date
     C                     PARM #1CWNB    WQ0204  50       TH Head Receive
     C                     PARM #1FCNB    WQ0205  50       TH Yard Deads
     C                     PARM #1FDNB    WQ0206  50       TH Head Condemn
     C                     PARM #1FENB    WQ0207  50       TH Head Killed
     C                     PARM #1HFNB    WQ0208  50       TH Head Accepte
     C                     PARM #1CWPC    WQ0209  52       TH Adj Actual Y
     C                     PARM #1HHNB    WQ0210  71       TH Avg Hot Wgt
     C                     PARM #1T2WT    WQ0211  71       TH Avg Lean % E
     C                     PARM #1KOER    WQ0212  50       TH Head Identif
     C                     PARM #1OPIR    WQ0213  52       TH Percent Iden
     C                     PARM #1OPEM    WQ0214  52       TH Percent Acce
     C                     PARM #1OQET    WQ0215  1        TH PHA Add Type
     C                     PARM #1URST    WQ0216  3        TH PHA Average
     C                     PARM #1USST    WQ0217  1        TH PHA Add Reas
     C                     PARM #1ABCD    WQ0218  6        PD Producer Cod
     C                     PARM P2EVTX    WQ0219 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTNPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Option 18
     C           #1SEL     IFEQ '18'                       *IF
      * transfer carcs
      * CASE: RCD.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
      * Pmt Trnsfr H/O Crcss  PV - Tattoo Header  * 
     C                     CALL 'PKTZPVR'              90  Pmt Trnsfr H/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0220  30       BOH Company Num
     C                     PARM #1BNNB    WQ0221  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0222  50       BOL Load Number
     C                     PARM #1CVNB    WQ0223  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0224  70       TH Kill Date
     C                     PARM #1AWDT    WQ0225  70       TH Purchase Dat
     C                     PARM #1BICD    WQ0226 10        TH Group Refere
     C                     PARM #1CPST    WQ0227  2        TH Live Purchas
     C                     PARM #1ACPR    WQ0228  52       TH Live Purchas
     C                     PARM #1B9PR    WQ0229  72       TH Live Gross A
     C                     PARM #1CAPR    WQ0230  72       TH LIve Net Amt
     C                     PARM #1C4ST    WQ0231  2        TH Resale UOM
     C                     PARM #1AIPR    WQ0232  52       TH Recalc Live
     C                     PARM #1A6DT    WQ0233  70       TH Pricing Date
     C                     PARM #1C2ST    WQ0234  1        TH Resale Sprea
     C                     PARM #1CXNB    WQ0235  50       TH Dead On Arri
     C                     PARM #1CWNB    WQ0236  50       TH Head Receive
     C                     PARM #1FCNB    WQ0237  50       TH Yard Deads
     C                     PARM #1H9NB    WQ0238  50       TH Held Over
     C                     PARM #1FDNB    WQ0239  50       TH Head Condemn
     C                     PARM #1FENB    WQ0240  50       TH Head Killed
     C                     PARM #1HENB    WQ0241  50       TH Head Adds
     C                     PARM #1HFNB    WQ0242  50       TH Head Accepte
     C                     PARM #1CYNB    WQ0243  71       TH Live Wgt
     C                     PARM #1LRNB    WQ0244  71       TH Adj Live Wgt
     C                     PARM #1E0NB    WQ0245  71       TH Hot Wgt
     C                     PARM #1A5PC    WQ0246  61       TH Tot Loin Eye
     C                     PARM #1FBNB    WQ0247  61       TH Tot Backfat
     C                     PARM #1A4PC    WQ0248  61       TH Tot Light Re
     C                     PARM #1F7NB    WQ0249  51       TH Avg Live Wgt
     C                     PARM #1HDNB    WQ0250  51       TH Avg Hot Wgt
     C                     PARM #1F5NB    WQ0251  31       TH Avg Light Re
     C                     PARM #1F4NB    WQ0252  31       TH Avg Lean Per
     C                     PARM #1F3NB    WQ0253  31       TH Avg Loin Eye
     C                     PARM #1F2NB    WQ0254  31       TH Avg Backfat
     C                     PARM #1AVPC    WQ0255  52       TH Std Yield Pe
     C                     PARM #1AWPC    WQ0256  52       TH Actual Yield
     C                     PARM #1CWPC    WQ0257  52       TH Adj Actual Y
     C                     PARM #1A8PC    WQ0258  52       TH Yield Differ
     C                     PARM #1A7PC    WQ0259  31       TH Recalc Live
     C                     PARM #1B8PR    WQ0260  52       TH CM Market Pr
     C                     PARM #1AMPR    WQ0261  52       TH CM Base Mkt
     C                     PARM #1ANPR    WQ0262  72       TH CM Base Mkt
     C                     PARM #1AYVA    WQ0263  72       TH CM Sort Disc
     C                     PARM #1AWVA    WQ0264  72       TH CM Yield Gai
     C                     PARM #1AOPR    WQ0265  72       TH CM Base Carc
     C                     PARM #1AXVA    WQ0266  72       TH CM LN AddOn/
     C                     PARM #1APPR    WQ0267  72       TH CM Carcass G
     C                     PARM #1ASPR    WQ0268  72       TH Deduction Am
     C                     PARM #1A4VA    WQ0269  72       TH Total Net WO
     C                     PARM #1ATPR    WQ0270  72       TH Carcass Net
     C                     PARM #1A5VA    WQ0271  72       TH Additions Am
     C                     PARM #1CBPR    WQ0272  72       TH Payment Gros
     C                     PARM #1CCPR    WQ0273  72       Th Payment Net
     C                     PARM #1LPNB    WQ0274  80       TH AP Voucher/D
     C                     PARM #1CDPR    WQ0275  72       TH Freight Amou
     C                     PARM #1A7VA    WQ0276  72       TH Accrual Amou
     C                     PARM #1A2PR    WQ0277  72       TH Fixed Cost A
     C                     PARM #1JWST    WQ0278  1        TH Calc Net Sts
     C                     PARM #1CWST    WQ0279  2        TH Payment Sts
     C                     PARM #1D6ST    WQ0280  1        TH Bal to Kill
     C                     PARM #1GHNB    WQ0281  80       TH Commission A
     C                     PARM #1BYDT    WQ0282  70       TH Voucher Paym
     C                     PARM #1E0ST    WQ0283  1        TH User Error O
     C                     PARM #1E1ST    WQ0284  1        TH Held Over Re
     C                     PARM #1E2ST    WQ0285  1        TH Sex
     C                     PARM #1BSDT    WQ0286  70       TH Held/Ovr Com
     C                     PARM #1BTDT    WQ0287  70       TH Commission P
     C                     PARM #1BUDT    WQ0288  70       TH Actual Check
     C                     PARM #1HGNB    WQ0289  71       TH Shipped Weig
     C                     PARM #1HHNB    WQ0290  71       TH Avg Hot Wgt
     C                     PARM #1HINB    WQ0291  31       TH FFLI
     C                     PARM #1A3PR    WQ0292  72       TH Kill Product
     C                     PARM #1A4PR    WQ0293  72       TH Cut Product
     C                     PARM #1A6PR    WQ0294  72       TH Render Produ
     C                     PARM #1J9NB    WQ0295  50       TH Head Exclude
     C                     PARM #1D6PR    WQ0296  52       TH CM Bse Mkt L
     C                     PARM #1D7PR    WQ0297  52       TH CM Bse Mkt C
     C                     PARM #1D8PR    WQ0298  52       TH CM Srt Dsc L
     C                     PARM #1D9PR    WQ0299  52       TH CM Srt Dsc C
     C                     PARM #1EAPR    WQ0300  52       TH CM Yld G/L L
     C                     PARM #1EBPR    WQ0301  52       TH CM Yld G/L C
     C                     PARM #1ECPR    WQ0302  52       TH CM Crc Val L
     C                     PARM #1EDPR    WQ0303  52       TH CM Crc Val C
     C                     PARM #1EEPR    WQ0304  52       TH CM Lean Prem
     C                     PARM #1EFPR    WQ0305  52       TH CM Lean Prem
     C                     PARM #1EGPR    WQ0306  52       TH CM Gross Liv
     C                     PARM #1EHPR    WQ0307  52       TH CM Gross Car
     C                     PARM #1KAST    WQ0308  1        TH Source Type
     C                     PARM #1J7ST    WQ0309  1        TH Scale Ticket
     C                     PARM #1J9ST    WQ0310  1        TH Payment Type
     C                     PARM #1OXNB    WQ0311  70       TH HPS Movement
     C                     PARM #1LKST    WQ0312  3        TH Source Code
     C                     PARM #1LLST    WQ0313  1        TH Hog Class Ty
     C                     PARM #1J8ST    WQ0314  1        TH Posted to HP
     C                     PARM #1LIST    WQ0315  1        TH Schedule Kil
     C                     PARM #1LJST    WQ0316  1        TH Shift Held O
     C                     PARM #1KOER    WQ0317  50       TH Head Identif
     C                     PARM #1OPIR    WQ0318  52       TH Percent Iden
     C                     PARM #1OPEM    WQ0319  52       TH Percent Acce
     C                     PARM #1BDCD    WQ0320  6        DF Defect Code
     C                     PARM #1CSCD    WQ0321  6        THP Process Cod
     C                     PARM #1ABCD    WQ0322  6        PD Producer Cod
     C                     PARM #1AECD    WQ0323  6        PL Location Cod
     C                     PARM #1ACCD    WQ0324  3        HB Buyer Code
     C                     PARM #1AGCD    WQ0325  5        GN Genetic Code
     C                     PARM #1BECD    WQ0326  3        HC Class Code
     C                     PARM #1AAVN    WQ0327 10        RS User Changed
     C                     PARM #1AADT    WQ0328  70       RS Date Changed
     C                     PARM #1AMTM    WQ0329  60       RS Time Changed
     C                     PARM #1AJST    WQ0330  1        RS Record Statu
     C                     PARM #1AHVN    WQ0331 10        RS Job
     C                     PARM #1AGVN    WQ0332 10        RS Program
     C                     PARM #1ABVN    WQ0333 10        RS User Added
     C                     PARM #1ABDT    WQ0334  70       RS Date Added
     C                     PARM #1ABTM    WQ0335  60       RS Time Added
     C                     PARM P2EVTX    WQ0336 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTZPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0016           *SFLSEL
      * Send message 'Opt not allowed unlss H/O'
     C                     MOVEL'PRK0918' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0017           TH Tattoo Numbe
     C                     MOVEL#1CSCD    ZA0018           THP Process Cod
      * Send message 'Invalid Process Code'
     C                     MOVEL'PRK0405' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Option 97 = Balance First Day
      * CASE: RCD.*SFLSEL is Option 97
     C           #1SEL     IFEQ '97'                       *IF
      * If Exclude Company from Payment History/Average flag <> No
      * CASE: LCL.Exclude Flag is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HMNB    ZA0019           BOH Company Num
      * Send message 'Co cannot Pay Hist Avg'
     C                     MOVEL'PRK1420' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SKRVGN
      * E9815 JBB  3/29/17  Add Company Number as primary key to function
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
     C                     EXSR SLRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * First Day: Kill Date
     C                     CLEARPGRC
     C                     Z-ADD#1HMNB    PGHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PGBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PGB0DT           TH Kill Date
     C                     Z-ADDYL0063    PGAWDT           TH Purchase Dat
     C                     MOVELYL0064    PGBICD    P      TH Group Refere
     C                     MOVELYL0065    PGCPST    P      TH Live Purchas
     C                     Z-ADDYL0066    PGACPR           TH Live Purchas
     C                     Z-ADDYL0067    PGB9PR           TH Live Gross A
     C                     Z-ADDYL0068    PGCAPR           TH LIve Net Amt
     C                     MOVELYL0069    PGC4ST    P      TH Resale UOM
     C                     Z-ADDYL0070    PGAIPR           TH Recalc Live
     C                     Z-ADDYL0071    PGA6DT           TH Pricing Date
     C                     MOVELYL0072    PGC2ST    P      TH Resale Sprea
     C                     Z-ADDYL0073    PGCXNB           TH Dead On Arri
     C                     Z-ADDYL0074    PGCWNB           TH Head Receive
     C                     Z-ADDYL0075    PGFCNB           TH Yard Deads
     C                     Z-ADDYL0076    PGH9NB           TH Held Over
     C                     Z-ADDYL0077    PGFDNB           TH Head Condemn
     C                     Z-ADDYL0078    PGFENB           TH Head Killed
     C                     Z-ADDYL0079    PGHENB           TH Head Adds
     C                     Z-ADDYL0080    PGHFNB           TH Head Accepte
     C                     Z-ADDYL0081    PGCYNB           TH Live Wgt
     C                     Z-ADDYL0082    PGLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0083    PGE0NB           TH Hot Wgt
     C                     Z-ADDYL0084    PGA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0085    PGFBNB           TH Tot Backfat
     C                     Z-ADDYL0086    PGA4PC           TH Tot Light Re
     C                     Z-ADDYL0087    PGF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0088    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0089    PGF5NB           TH Avg Light Re
     C                     Z-ADDYL0090    PGF4NB           TH Avg Lean Per
     C                     Z-ADDYL0091    PGF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0092    PGF2NB           TH Avg Backfat
     C                     Z-ADDYL0093    PGAVPC           TH Std Yield Pe
     C                     Z-ADDYL0094    PGAWPC           TH Actual Yield
     C                     Z-ADDYL0095    PGCWPC           TH Adj Actual Y
     C                     Z-ADDYL0096    PGA8PC           TH Yield Differ
     C                     Z-ADDYL0097    PGA7PC           TH Recalc Live
     C                     Z-ADDYL0098    PGB8PR           TH CM Market Pr
     C                     Z-ADDYL0099    PGAMPR           TH CM Base Mkt
     C                     Z-ADDYL0100    PGANPR           TH CM Base Mkt
     C                     Z-ADDYL0101    PGAYVA           TH CM Sort Disc
     C                     Z-ADDYL0102    PGAWVA           TH CM Yield Gai
     C                     Z-ADDYL0103    PGAOPR           TH CM Base Carc
     C                     Z-ADDYL0104    PGAXVA           TH CM LN AddOn/
     C                     Z-ADDYL0105    PGAPPR           TH CM Carcass G
     C                     Z-ADDYL0106    PGASPR           TH Deduction Am
     C                     Z-ADDYL0107    PGA4VA           TH Total Net WO
     C                     Z-ADDYL0108    PGATPR           TH Carcass Net
     C                     Z-ADDYL0109    PGA5VA           TH Additions Am
     C                     Z-ADDYL0110    PGCBPR           TH Payment Gros
     C                     Z-ADDYL0111    PGCCPR           Th Payment Net
     C                     Z-ADDYL0112    PGLPNB           TH AP Voucher/D
     C                     Z-ADDYL0113    PGCDPR           TH Freight Amou
     C                     Z-ADDYL0114    PGA7VA           TH Accrual Amou
     C                     Z-ADDYL0115    PGA2PR           TH Fixed Cost A
     C                     MOVELYL0116    PGJWST    P      TH Calc Net Sts
     C                     MOVELYL0117    PGCWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PGD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0118    PGGHNB           TH Commission A
     C                     Z-ADDYL0119    PGBYDT           TH Voucher Paym
     C                     MOVELYL0120    PGE0ST    P      TH User Error O
     C                     MOVELYL0121    PGE1ST    P      TH Held Over Re
     C                     MOVELYL0122    PGE2ST    P      TH Sex
     C                     Z-ADDYL0123    PGBSDT           TH Held/Ovr Com
     C                     Z-ADDYL0124    PGBTDT           TH Commission P
     C                     Z-ADDYL0125    PGBUDT           TH Actual Check
     C                     Z-ADDYL0126    PGHGNB           TH Shipped Weig
     C                     Z-ADDYL0127    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0128    PGHINB           TH FFLI
     C                     Z-ADDYL0129    PGA3PR           TH Kill Product
     C                     Z-ADDYL0130    PGA4PR           TH Cut Product
     C                     Z-ADDYL0131    PGA6PR           TH Render Produ
     C                     Z-ADDYL0132    PGJ9NB           TH Head Exclude
     C                     Z-ADDYL0133    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADDYL0134    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADDYL0135    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADDYL0136    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADDYL0137    PGEAPR           TH CM Yld G/L L
     C                     Z-ADDYL0138    PGEBPR           TH CM Yld G/L C
     C                     Z-ADDYL0139    PGECPR           TH CM Crc Val L
     C                     Z-ADDYL0140    PGEDPR           TH CM Crc Val C
     C                     Z-ADDYL0141    PGEEPR           TH CM Lean Prem
     C                     Z-ADDYL0142    PGEFPR           TH CM Lean Prem
     C                     Z-ADDYL0143    PGEGPR           TH CM Gross Liv
     C                     Z-ADDYL0144    PGEHPR           TH CM Gross Car
     C                     MOVELYL0145    PGKAST    P      TH Source Type
     C                     MOVELYL0146    PGJ7ST    P      TH Scale Ticket
     C                     MOVELYL0147    PGJ9ST    P      TH Payment Type
     C                     Z-ADDYL0148    PGOXNB           TH HPS Movement
     C                     MOVELYL0149    PGLKST    P      TH Source Code
     C                     MOVELYL0150    PGLLST    P      TH Hog Class Ty
     C                     MOVELYL0151    PGJ8ST    P      TH Posted to HP
     C                     MOVELYL0152    PGLIST    P      TH Schedule Kil
     C                     MOVELYL0153    PGLJST    P      TH Shift Held O
     C                     MOVELYL0154    PGBDCD    P      DF Defect Code
     C                     MOVELYL0155    PGCSCD    P      THP Process Cod
     C                     MOVELYL0036    PGABCD    P      PD Producer Cod
     C                     MOVELYL0037    PGAECD    P      PL Location Cod
     C                     MOVELYL0156    PGACCD    P      HB Buyer Code
     C                     MOVELYL0038    PGAGCD    P      GN Genetic Code
     C                     MOVELYL0157    PGBECD    P      HC Class Code
     C                     MOVELYL0158    PGAAVN    P      RS User Changed
     C                     Z-ADDYL0159    PGAADT           RS Date Changed
     C                     Z-ADDYL0160    PGAMTM           RS Time Changed
     C                     MOVELYL0050    PGAJST    P      RS Record Statu
     C                     MOVELYL0161    PGAHVN    P      RS Job
     C                     MOVELYL0162    PGAGVN    P      RS Program
     C                     MOVELYL0163    PGABVN    P      RS User Added
     C                     Z-ADDYL0164    PGABDT           RS Date Added
     C                     Z-ADDYL0165    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0337  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0338  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0339  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0340  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0341  71       %Lean High Min
     C                     PARM YL0012    WQ0342  71       %Lean High Max
     C                     PARM YL0013    WQ0343  71       %Lean Low Min
     C                     PARM YL0014    WQ0344  71       %Lean Low Max
     C                     PARM YL0015    WQ0345  71       High Yield Min
     C                     PARM YL0016    WQ0346  71       High Yield Max
     C                     PARM YL0017    WQ0347  71       Low Yield Min
     C                     PARM YL0018    WQ0348  71       Low Yield Max
     C                     PARM YL0019    WQ0349  71       Head < Percent
     C                     PARM YL0020    WQ0350  71       Head < Percent
     C                     PARM YL0021    WQ0351  71       Head > Percent
     C                     PARM YL0022    WQ0352  71       Head > Percent
     C                     PARM YL0023    WQ0353  71       BackFat High Mi
     C                     PARM YL0024    WQ0354  71       BackFat High Ma
     C                     PARM YL0025    WQ0355  71       BackFat Low Min
     C                     PARM YL0026    WQ0356  71       Backfat Low Max
     C                     PARM YL0027    WQ0357  71       LoinEye High Mi
     C                     PARM YL0028    WQ0358  71       LoinEye High Ma
     C                     PARM YL0029    WQ0359  71       LoinEye Low Min
     C                     PARM YL0030    WQ0360  71       LoinEye Low Max
     C                     PARM 'Y'       WQ0361  1        Requested by Us
     C                     PARM 'P'       WQ0362  1        Bal w/History
     C                     PARM #1OQET    WQ0363  1        TH PHA Add Type
     C                     PARM #1URST    WQ0364  3        TH PHA Average
     C                     PARM #1USST    WQ0365  1        TH PHA Add Reas
     C                     PARM YL0052    WQ0366  51       PH GA Avg Live
     C                     PARM YL0166    WQ0367  52       PH GA Adjusted
     C                     PARM YL0054    WQ0368  31       PH GA Avg Lean%
     C                     PARM YL0055    WQ0369  31       PH GA Avg Backf
     C                     PARM YL0056    WQ0370  31       PH GA Avg Loin
     C                     PARM YL0057    WQ0371  31       PH GA Avg Light
     C                     PARM YL0167    WQ0372  52       PH GA Lean Prm
     C                     PARM YL0059    WQ0373  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0374  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0375  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * Option 98 = Transfer Carcasses
      * CASE: RCD.*SFLSEL is Option 98
     C           #1SEL     IFEQ '98'                       *IF
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SMRVGN
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
     C                     EXSR SNRVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Option 99 = Balance Second Day
      * CASE: RCD.*SFLSEL is Option 99
     C           #1SEL     IFEQ '99'                       *IF
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SYRVGN
      * Bal/Val Tattoo        XF - Tattoo Header  * Second Day: TH Kill D
     C                     CLEARPGRC
     C                     Z-ADD#1HMNB    PGHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PGBONB           BOL Load Number
     C                     Z-ADD#1CVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PGB0DT           TH Kill Date
     C                     Z-ADDYL0063    PGAWDT           TH Purchase Dat
     C                     MOVELYL0064    PGBICD    P      TH Group Refere
     C                     MOVELYL0065    PGCPST    P      TH Live Purchas
     C                     Z-ADDYL0066    PGACPR           TH Live Purchas
     C                     Z-ADDYL0067    PGB9PR           TH Live Gross A
     C                     Z-ADDYL0068    PGCAPR           TH LIve Net Amt
     C                     MOVELYL0069    PGC4ST    P      TH Resale UOM
     C                     Z-ADDYL0070    PGAIPR           TH Recalc Live
     C                     Z-ADDYL0071    PGA6DT           TH Pricing Date
     C                     MOVELYL0072    PGC2ST    P      TH Resale Sprea
     C                     Z-ADDYL0073    PGCXNB           TH Dead On Arri
     C                     Z-ADDYL0074    PGCWNB           TH Head Receive
     C                     Z-ADDYL0075    PGFCNB           TH Yard Deads
     C                     Z-ADDYL0076    PGH9NB           TH Held Over
     C                     Z-ADDYL0077    PGFDNB           TH Head Condemn
     C                     Z-ADDYL0078    PGFENB           TH Head Killed
     C                     Z-ADDYL0079    PGHENB           TH Head Adds
     C                     Z-ADDYL0080    PGHFNB           TH Head Accepte
     C                     Z-ADDYL0081    PGCYNB           TH Live Wgt
     C                     Z-ADDYL0082    PGLRNB           TH Adj Live Wgt
     C                     Z-ADDYL0083    PGE0NB           TH Hot Wgt
     C                     Z-ADDYL0084    PGA5PC           TH Tot Loin Eye
     C                     Z-ADDYL0085    PGFBNB           TH Tot Backfat
     C                     Z-ADDYL0086    PGA4PC           TH Tot Light Re
     C                     Z-ADDYL0087    PGF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0088    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0089    PGF5NB           TH Avg Light Re
     C                     Z-ADDYL0090    PGF4NB           TH Avg Lean Per
     C                     Z-ADDYL0091    PGF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0092    PGF2NB           TH Avg Backfat
     C                     Z-ADDYL0093    PGAVPC           TH Std Yield Pe
     C                     Z-ADDYL0094    PGAWPC           TH Actual Yield
     C                     Z-ADDYL0095    PGCWPC           TH Adj Actual Y
     C                     Z-ADDYL0096    PGA8PC           TH Yield Differ
     C                     Z-ADDYL0097    PGA7PC           TH Recalc Live
     C                     Z-ADDYL0098    PGB8PR           TH CM Market Pr
     C                     Z-ADDYL0099    PGAMPR           TH CM Base Mkt
     C                     Z-ADDYL0100    PGANPR           TH CM Base Mkt
     C                     Z-ADDYL0101    PGAYVA           TH CM Sort Disc
     C                     Z-ADDYL0102    PGAWVA           TH CM Yield Gai
     C                     Z-ADDYL0103    PGAOPR           TH CM Base Carc
     C                     Z-ADDYL0104    PGAXVA           TH CM LN AddOn/
     C                     Z-ADDYL0105    PGAPPR           TH CM Carcass G
     C                     Z-ADDYL0106    PGASPR           TH Deduction Am
     C                     Z-ADDYL0107    PGA4VA           TH Total Net WO
     C                     Z-ADDYL0108    PGATPR           TH Carcass Net
     C                     Z-ADDYL0109    PGA5VA           TH Additions Am
     C                     Z-ADDYL0110    PGCBPR           TH Payment Gros
     C                     Z-ADDYL0111    PGCCPR           Th Payment Net
     C                     Z-ADDYL0112    PGLPNB           TH AP Voucher/D
     C                     Z-ADDYL0113    PGCDPR           TH Freight Amou
     C                     Z-ADDYL0114    PGA7VA           TH Accrual Amou
     C                     Z-ADDYL0115    PGA2PR           TH Fixed Cost A
     C                     MOVELYL0116    PGJWST    P      TH Calc Net Sts
     C                     MOVELYL0117    PGCWST    P      TH Payment Sts
     C                     MOVELYL0174    PGD6ST    P      TH Bal to Kill
     C                     Z-ADDYL0118    PGGHNB           TH Commission A
     C                     Z-ADDYL0119    PGBYDT           TH Voucher Paym
     C                     MOVELYL0120    PGE0ST    P      TH User Error O
     C                     MOVELYL0121    PGE1ST    P      TH Held Over Re
     C                     MOVELYL0122    PGE2ST    P      TH Sex
     C                     Z-ADDYL0123    PGBSDT           TH Held/Ovr Com
     C                     Z-ADDYL0124    PGBTDT           TH Commission P
     C                     Z-ADDYL0125    PGBUDT           TH Actual Check
     C                     Z-ADDYL0126    PGHGNB           TH Shipped Weig
     C                     Z-ADDYL0127    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADDYL0128    PGHINB           TH FFLI
     C                     Z-ADDYL0129    PGA3PR           TH Kill Product
     C                     Z-ADDYL0130    PGA4PR           TH Cut Product
     C                     Z-ADDYL0131    PGA6PR           TH Render Produ
     C                     Z-ADDYL0132    PGJ9NB           TH Head Exclude
     C                     Z-ADDYL0133    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADDYL0134    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADDYL0135    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADDYL0136    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADDYL0137    PGEAPR           TH CM Yld G/L L
     C                     Z-ADDYL0138    PGEBPR           TH CM Yld G/L C
     C                     Z-ADDYL0139    PGECPR           TH CM Crc Val L
     C                     Z-ADDYL0140    PGEDPR           TH CM Crc Val C
     C                     Z-ADDYL0141    PGEEPR           TH CM Lean Prem
     C                     Z-ADDYL0142    PGEFPR           TH CM Lean Prem
     C                     Z-ADDYL0143    PGEGPR           TH CM Gross Liv
     C                     Z-ADDYL0144    PGEHPR           TH CM Gross Car
     C                     MOVELYL0145    PGKAST    P      TH Source Type
     C                     MOVELYL0146    PGJ7ST    P      TH Scale Ticket
     C                     MOVELYL0147    PGJ9ST    P      TH Payment Type
     C                     Z-ADDYL0148    PGOXNB           TH HPS Movement
     C                     MOVELYL0149    PGLKST    P      TH Source Code
     C                     MOVELYL0150    PGLLST    P      TH Hog Class Ty
     C                     MOVELYL0151    PGJ8ST    P      TH Posted to HP
     C                     MOVELYL0152    PGLIST    P      TH Schedule Kil
     C                     MOVELYL0153    PGLJST    P      TH Shift Held O
     C                     MOVELYL0154    PGBDCD    P      DF Defect Code
     C                     MOVELYL0155    PGCSCD    P      THP Process Cod
     C                     MOVELYL0036    PGABCD    P      PD Producer Cod
     C                     MOVELYL0037    PGAECD    P      PL Location Cod
     C                     MOVELYL0156    PGACCD    P      HB Buyer Code
     C                     MOVELYL0038    PGAGCD    P      GN Genetic Code
     C                     MOVELYL0157    PGBECD    P      HC Class Code
     C                     MOVELYL0158    PGAAVN    P      RS User Changed
     C                     Z-ADDYL0159    PGAADT           RS Date Changed
     C                     Z-ADDYL0160    PGAMTM           RS Time Changed
     C                     MOVELYL0050    PGAJST    P      RS Record Statu
     C                     MOVELYL0161    PGAHVN    P      RS Job
     C                     MOVELYL0162    PGAGVN    P      RS Program
     C                     MOVELYL0163    PGABVN    P      RS User Added
     C                     Z-ADDYL0164    PGABDT           RS Date Added
     C                     Z-ADDYL0165    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0454  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0455  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0456  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0457  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0458  71       %Lean High Min
     C                     PARM YL0012    WQ0459  71       %Lean High Max
     C                     PARM YL0013    WQ0460  71       %Lean Low Min
     C                     PARM YL0014    WQ0461  71       %Lean Low Max
     C                     PARM YL0015    WQ0462  71       High Yield Min
     C                     PARM YL0016    WQ0463  71       High Yield Max
     C                     PARM YL0017    WQ0464  71       Low Yield Min
     C                     PARM YL0018    WQ0465  71       Low Yield Max
     C                     PARM YL0019    WQ0466  71       Head < Percent
     C                     PARM YL0020    WQ0467  71       Head < Percent
     C                     PARM YL0021    WQ0468  71       Head > Percent
     C                     PARM YL0022    WQ0469  71       Head > Percent
     C                     PARM YL0023    WQ0470  71       BackFat High Mi
     C                     PARM YL0024    WQ0471  71       BackFat High Ma
     C                     PARM YL0025    WQ0472  71       BackFat Low Min
     C                     PARM YL0026    WQ0473  71       Backfat Low Max
     C                     PARM YL0027    WQ0474  71       LoinEye High Mi
     C                     PARM YL0028    WQ0475  71       LoinEye High Ma
     C                     PARM YL0029    WQ0476  71       LoinEye Low Min
     C                     PARM YL0030    WQ0477  71       LoinEye Low Max
     C                     PARM 'N'       WQ0478  1        Requested by Us
     C                     PARM *BLANK    WQ0479  1        Bal w/History
     C                     PARM *BLANK    WQ0480  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0481  3        TH PHA Average
     C                     PARM *BLANK    WQ0482  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0483  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0484  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0485  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0486  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0487  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0488  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0489  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0490  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0491  1        Undo MPR USR
     C           YL0031    PARM *BLANK    WQ0492  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Option 20 - Reprocess Eval Trans Upl
      * CASE: RCD.*SFLSEL is *Option 20
     C           #1SEL     IFEQ '20'                       *IF
      * Documentation
     C                     EXSR UBSUBR                     Documentation
      * ERROR MESSAGES
      *                - Option only allowed if company value is batch
      *                - Tattoo can not be in PAYMENT PROCESS
      *                - A record can not exits in the Carcass Detail
      * Company Value Code    USR = HPE Receiving Prc Type
     C                     MOVEL@CN,001   YL0001           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2HMNB    WQ0493  30       BOH Company Num
     C                     PARM YL0001    WQ0494 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0495 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      * HPE Receiving Prc Type   = BATCH
      * CASE: LCL.HPERCVTYPE Alpha Usr is BATCH
     C           YL0002    IFEQ 'BATCH'                    *IF
      * CASE: RCD.THP Process Code is NE Payment
     C           #1CSCD    IFNE @CN,006                    *IF
      * Val Crc Dtl for Val  RT - Carcass Detail  * 
     C                     EXSR SZRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
      * Val Eval Trans Exists RT - Eval Trans  * 
     C                     EXSR TARVGN
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,004                    *IF
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C           ##USR     OREQ @CN,028
     C           ##USR     OREQ @CN,029
     C           ##USR     OREQ @CN,030
     C           ##USR     OREQ @CN,031
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0020           *SFLSEL
      * Send message 'Evan Trans Already Exits'
     C                     MOVEL'PRK1166' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
      * Unflag the Eval Trans Upl, and allow User to Reprocess
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.THP Process Code is NE Payment
      *   |- c2    : LCL.HPERCVTYPE Alpha Usr is BATCH
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1CSCD    IFNE @CN,006                    *IF
     C           YL0002    IFEQ 'BATCH'                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Eval Trans Upl ReDoXF - Eval Trans UPL  * 
     C                     CALL 'PLIOXFR'              90  UPD Eval Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0496  30       EA Company Numb
     C                     PARM #1B0DT    WQ0497  70       EA Kill Date
     C                     PARM #1CVNB    WQ0498  50       EA Tattoo Numbe
     C                     PARM #1BNNB    WQ0499  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0500  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLIOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Send message 'Eval Tran Upl - Reprocess'
     C                     MOVEL'PRK1162' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0021           *SFLSEL
      * Send message 'Carcass Dtl is Found'
     C                     MOVEL'PRK1167' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0022           *SFLSEL
      * Send message 'Payment Process not Allow'
     C                     MOVEL'PRK0453' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0023           *SFLSEL
      * Send message 'Opt not allowed'
     C                     MOVEL'PRK0648' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Force PUTOVR
     C                     SETON                     86
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN77
     C           #1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #RFJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #RP4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #RFHST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           #1LJST    IFEQ *BLANK                     *IF
     C           #1LJST    OREQ 'N'
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P2G8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0002    IFEQ @CN,032                    *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A1CPHN fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDA1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDA1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #1BONB           BOL Load Number
     C                     Z-ADDA1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #1KAST           TH Source Type
     C                     MOVELA1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELA1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELA1LJST    #1LJST           TH Shift Held O
     C                     MOVELA1NZTX    #1NZTX           TH State
     C                     MOVELA1HJCD    #1HJCD           TH Unused Code
     C                     MOVELA1R4ST    #1R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #1R5ST           TH Commission S
     C                     MOVELA1R6ST    #1R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #1R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #1THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #1T2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    #1THHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #1OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #1KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #1IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #1OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #1OQET           TH PHA Add Type
     C                     MOVELA1URST    #1URST           TH PHA Average
     C                     MOVELA1USST    #1USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #1HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #1S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #1TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #1TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #1JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #1KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #1KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #1KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #1KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #1OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #1IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #1IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #1IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #1KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #1OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #1KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #1ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #1OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #1MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #1MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #1NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #1NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #1IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #1KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #1EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #1EBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    #1ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #1EDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    #1EEDT           TH Unused Date
     C                     MOVELA1U4ST    #1U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #1U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #1U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #1U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #1U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #1U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #1VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #1VBST           TH Unused Sts 8
     C                     MOVELA1J9ST    #1J9ST           TH Payment Type
     C                     Z-ADDA1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELA1LKST    #1LKST           TH Source Code
     C                     MOVELA1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA1AADT    #1AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #1AMTM           RS Time Changed
     C                     MOVELA1AJST    #1AJST           RS Record Statu
     C                     MOVELA1AHVN    #1AHVN           RS Job
     C                     MOVELA1AGVN    #1AGVN           RS Program
     C                     MOVELA1ABVN    #1ABVN           RS User Added
     C                     Z-ADDA1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #1ABTM           RS Time Added
     C                     Z-ADDA1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1CWPC    #1CWPC           TH Adj Actual Y
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1LIST    #1LIST           TH Schedule Kil
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #RGSNB           Error Type 1 Us
     C                     MOVEL*BLANK    #RFGST           Error Type 2 Us
     C                     MOVEL*BLANK    #RFHST           Error Type 3 Us
     C                     MOVEL*BLANK    #RFIST           Error Type 4 Us
     C                     MOVEL*BLANK    #RFJST           Error Type 5 Us
     C                     MOVEL*BLANK    #RP4ST           Status 1
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RF6NB           Net Head Usr
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MC#1FN    BEGSR
      *================================================================
      * CALC: Subfile record function fields
      *================================================================
      * CALC: Subfile record function fields
      * Get Producer name
      * Calculate Net Head
     C           #1CWNB    SUB  #1FCNB    #RF6NB           Net Head Usr
     C                     SUB  #1FDNB    #RF6NB           Net Head Usr
      *================================================================
     CSR         MCEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1ETTX    #PETTX           PRT Description
     C                     MOVELP1ACVN    #PACVN           PRT Printer Dev
     C                     MOVELP1AKST    #PAKST           PRT Hold Output
     C                     MOVELP1AMST    #PAMST           PRT Save Output
     C                     Z-ADDP1AKNB    #PAKNB           PRT Copies
     C                     MOVELP1ALST    #PALST           PRT Night Queue
     C                     MOVELP1AIVN    #PAIVN           PRT Night Queue
     C                     MOVELP2J8NB    #PJ8NB           Oms Warehouse C
     C                     Z-ADDP2HONB    #PHONB           CC Company Numb
     C                     MOVELP2C8CD    #PC8CD           Oms SalesPerson
     C                     MOVELP2G8ST    #PG8ST           Oms Allow Multi
     C                     MOVELP2G9ST    #PG9ST           Oms Default Pri
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     MOVELP2HAST    #PHAST           Oms Access Deni
     C                     MOVEL*BLANK    #2BICD           TH Group Refere
     C                     MOVEL*BLANK    #2CPST           TH Live Purchas
     C                     Z-ADD*ZERO     #2ACPR           TH Live Purchas
     C                     MOVEL*BLANK    #2C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #2AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #2A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #2C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    #2CWST           TH Payment Sts
     C                     Z-ADD*ZERO     #2F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #2F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #2F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #2F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #2AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #2A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #2A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #2ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #2AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #2AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #2AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #2AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #2APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #2ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #2A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #2A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #2A7VA           TH Accrual Amou
     C                     MOVEL*BLANK    #2D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #2GHNB           TH Commission A
     C                     Z-ADD*ZERO     #2BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #2E0ST           TH User Error O
     C                     MOVEL*BLANK    #2E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #2E2ST           TH Sex
     C                     Z-ADD*ZERO     #2BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #2BTDT           TH Commission P
     C                     Z-ADD*ZERO     #2BUDT           TH Actual Check
     C                     MOVEL*BLANK    #2D7ST           TH Header Error
     C                     MOVEL*BLANK    #2D8ST           TH Detail Error
     C                     Z-ADD*ZERO     #2FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #2A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #2F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #2A5PC           TH Tot Loin Eye
     C                     MOVEL*BLANK    #2AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #2AAVN           RS User Changed
     C                     Z-ADD*ZERO     #2AADT           RS Date Changed
     C                     Z-ADD*ZERO     #2AMTM           RS Time Changed
     C                     MOVEL*BLANK    #2AJST           RS Record Statu
     C                     MOVEL*BLANK    #2AHVN           RS Job
     C                     MOVEL*BLANK    #2AGVN           RS Program
     C                     MOVEL*BLANK    #2ABVN           RS User Added
     C                     Z-ADD*ZERO     #2ABDT           RS Date Added
     C                     Z-ADD*ZERO     #2ABTM           RS Time Added
     C                     Z-ADD*ZERO     #2BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #2BONB           BOL Load Number
     C                     Z-ADD*ZERO     #2CXNB           TH Dead On Arri
     C                     MOVEL*BLANK    #2ABCD           PD Producer Cod
     C                     Z-ADD*ZERO     #2AWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     #2AWPC           TH Actual Yield
     C                     MOVEL*BLANK    #2BECD           HC Class Code
     C                     MOVEL*BLANK    #2BDCD           DF Defect Code
     C                     Z-ADD*ZERO     #2ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #2HMNB           BOH Company Num
     C                     MOVELP2EUTX    #PEUTX           Oms Name
     C                     Z-ADD*ZERO     #2B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2B0DT
     C                     MOVEL*BLANK    #2LIST           TH Schedule Kil
     C                     MOVEL*BLANK    #2DWST           TH Kill Balanci
     C                     Z-ADD*ZERO     #2CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #2CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #2FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #2FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #CF6NB           Net Head Usr
     C                     Z-ADD*ZERO     #2FENB           TH Head Killed
     C                     Z-ADD*ZERO     #2H9NB           TH Held Over
     C                     Z-ADD*ZERO     #2CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #2E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #2CWPC           TH Adj Actual Y
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #2B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2B0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Payment Prc        RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           C4HONB           CC Company Numb
      * Setup key
     C                     Z-ADD#PHONB    C4HONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
      * Data record not found
     C   90                MOVEL'PRK0434' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC4CKDT    #2B0DT           Pmt Current Pay
     C                     Z-ADDC4M1NB    YL0003           Pmt Current Pay
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Check for Error   RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #RGSNB           Error Type 1 Us
     C                     MOVEL'N'       #RFGST           Error Type 2 Us
     C                     MOVEL'N'       #RFHST           Error Type 3 Us
     C                     MOVEL'N'       #RFIST           Error Type 4 Us
     C                     MOVEL'N'       #RFJST           Error Type 5 Us
     C                     MOVEL'N'       WUGYST           Error Type Foun
     C                     MOVEL'N'       WUIIST           Error Type 6 Us
     C                     MOVEL'N'       WUIJST           Error Type 7 Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN B6HRNB    WQSB01           KV Company Numb
     C           *LIKE     DEFN B6BPDT    WQSB02           KV Kill Date
     C           *LIKE     DEFN B6IRNB    WQSB03           KV TATTOO NUMBE
     C           *LIKE     DEFN B6BONM    WQSB04           KV Buy Order Nu
     C           *LIKE     DEFN B6LDNM    WQSB05           KV Load Number
     C           *LIKE     DEFN B6FPNB    WQSB06           KV Record Numbe
     C           *LIKE     DEFN B6DYST    WQSB07           KV Record Type
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           KV Company Numb
     C                     KFLD           WQSB02           KV Kill Date
     C                     KFLD           WQSB03           KV TATTOO NUMBE
     C                     KFLD           WQSB04           KV Buy Order Nu
     C                     KFLD           WQSB05           KV Load Number
     C                     KFLD           WQSB06           KV Record Numbe
     C                     KFLD           WQSB07           KV Record Type
      * Setup key
     C                     Z-ADD#1HMNB    WQSB01           KV Company Numb
     C                     Z-ADD#1B0DT    WQSB02           KV Kill Date
     C                     Z-ADD#1CVNB    WQSB03           KV TATTOO NUMBE
     C                     Z-ADD#1BNNB    WQSB04           KV Buy Order Nu
     C                     Z-ADD#1BONB    WQSB05           KV Load Number
     C                     Z-ADD999999    WQSB06           KV Record Numbe
     C                     MOVEL'H'       WQSB07           KV Record Type
      * Establish starting position
     C           KRSSB     SETLL@B6CPGX                    *
     C           KRSSB     READE@B6CPGX                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Eval Val Error    RT - Evaluation Validation  * 
     C                     EXSR SCRVGN
      * Check for Type of Error to Send back Flag
      * CASE: WRK.EV Type is Carcass Weights
     C           WUFEST    IFEQ 'C'                        *IF
     C                     MOVEL'Y'       #RGSNB           Error Type 1 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE: WRK.EV Type is % Rule for Head Killed
     C           WUFEST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       #RFJST           Error Type 5 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE: WRK.EV Type is % Lean
     C           WUFEST    IFEQ 'L'                        *IF
     C                     MOVEL'Y'       #RFGST           Error Type 2 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.EV Type is Yield
      *   |- c2    : DB1.KV Error Code is Yield Parameter Error
      *   '-
     C           WUFEST    IFEQ 'Y'                        *IF
     C           B6DXST    OREQ 'YLD'                      *OR
     C                     MOVEL'Y'       #RFHST           Error Type 3 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE: WRK.EV Type is Missing Transaction
     C           WUFEST    IFEQ 'B'                        *IF
     C                     MOVEL'Y'       #RFIST           Error Type 4 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE: WRK.EV Type is Backfat
     C           WUFEST    IFEQ 'F'                        *IF
     C                     MOVEL'Y'       WUIIST           Error Type 6 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     ELSE
      * CASE: WRK.EV Type is Loin Eye
     C           WUFEST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUIJST           Error Type 7 Us
     C                     MOVEL'Y'       WUGYST           Error Type Foun
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@B6CPGX                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Eval Val Error    RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BOBVCD           EV Validation C
      * Setup key
     C                     MOVELB6DXST    BOBVCD           EV Validation C
      * Establish starting position
     C           KRSSC     CHAIN@BOREFN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0107' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUCBTX           EV Description
     C                     Z-ADD*ZERO     WUAFPC           EV Minimum
     C                     Z-ADD*ZERO     WUAGPC           EV Maximum
     C                     MOVEL*BLANK    WUFEST           EV Type
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBOCBTX    WUCBTX           EV Description
     C                     Z-ADDBOAFPC    WUAFPC           EV Minimum
     C                     Z-ADDBOAGPC    WUAGPC           EV Maximum
     C                     MOVELBOFEST    WUFEST           EV Type
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Name, Sts   RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSD     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    WUAGTX           PD Name
     C                     MOVELACAJST    #1AJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Comment Exist     RT - Tattoo Header Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0032           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN A4HMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN A4BNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN A4BONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN A4CVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN A4B0DT    WQSF05           TH Kill Date
     C           *LIKE     DEFN A4ETST    WQSF06           THC Comment Typ
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
     C                     KFLD           WQSF06           THC Comment Typ
      * Setup key
     C                     Z-ADD#1HMNB    WQSF01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSF03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSF05           TH Kill Date
     C                     MOVEL'B'       WQSF06           THC Comment Typ
      * Establish starting position
     C           KRSSF     SETLL@A4CPL4                    *
     C           KRSSF     READE@A4CPL4                  90*
      * Data record not found
     C   90                MOVEL'PRK0067' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0032           Record Found US
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@A4CPL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Chk Tattoo Rcd Exists RT - Tattoo Repayment Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AXHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN AXBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN AXBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN AXCVNB    WQSH04           TH Tattoo Numbe
     C           *LIKE     DEFN AXB0DT    WQSH05           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           TH Tattoo Numbe
     C                     KFLD           WQSH05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSH01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSH02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSH03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSH04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSH05           TH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@AXCPA1                    *
     C           KRSSH     READE@AXCPA1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1566' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0033           Repay Record Ex
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Update status to Edited if not alsready marked
      * CASE: TRD Repayment Status <> Edited AND <> Repaid
      *  - NOTc1 AND NOTc2
      *   |- c1    : DB1.TRD Repayment Status is Edited
      *   |- c2    : DB1.TRD Repayment Status is Repaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AXMCSS    IFEQ 'E'                        *IF
     C                     ELSE
     C           AXMCSS    IFEQ 'R'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0033           Repay Record Ex
     C                     END                             *FI
     C           KRSSH     READE@AXCPA1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv BO Info           RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSI     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA4ST    YL0035           BOH Payment Typ
     C                     MOVELAWABCD    YL0036           PD Producer Cod
     C                     MOVELAWAECD    YL0037           PL Location Cod
     C                     MOVELAWAGCD    YL0038           GN Genetic Code
     C                     MOVELAWAICD    YL0039           PO Option Code
     C                     MOVELAWAMCD    YL0040           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELYL0040    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSJ     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0041           CMP Description
     C                     MOVEL*BLANK    YL0042           CMP Grading Typ
     C                     MOVEL*BLANK    YL0043           CMP Sort Basis
     C                     MOVEL*BLANK    YL0044           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     YL0045           CMP Std Lean Pe
     C                     Z-ADD*ZERO     YL0046           CMP Lean Factor
     C                     MOVEL*BLANK    YL0047           CMP Optimal Row
     C                     MOVEL*BLANK    YL0048           CMP Type
     C                     Z-ADD*ZERO     YL0049           CMP Market Add/
     C                     MOVEL*BLANK    YL0050           RS Record Statu
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    YL0041           CMP Description
     C                     MOVELARDLST    YL0042           CMP Grading Typ
     C                     MOVELARDMST    YL0043           CMP Sort Basis
     C                     MOVELARDQST    YL0044           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    YL0045           CMP Std Lean Pe
     C                     Z-ADDARA0PC    YL0046           CMP Lean Factor
     C                     MOVELARDTST    YL0047           CMP Optimal Row
     C                     MOVELARF5ST    YL0048           CMP Type
     C                     Z-ADDARI1PR    YL0049           CMP Market Add/
     C                     MOVELARAJST    YL0050           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv GA Prod Hist Avgs RT - Producer History WKLY  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0051           PH Summary Type
     C                     Z-ADD*ZERO     YL0052           PH GA Avg Live
     C                     Z-ADD*ZERO     YL0053           PH GA Adjusted
     C                     Z-ADD*ZERO     YL0054           PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0055           PH GA Avg Backf
     C                     Z-ADD*ZERO     YL0056           PH GA Avg Loin
     C                     Z-ADD*ZERO     YL0057           PH GA Avg Light
     C                     Z-ADD*ZERO     YL0058           PH GA Lean Prm
     C                     Z-ADD*ZERO     YL0059           PH GA Avg Srt D
     C                     MOVEL*BLANK    YL0060           History Avail S
     C                     MOVEL'N'       YL0060           History Avail S
     C                     MOVEL'Y'       YL0061           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN CGY3A1    WQSL01           PH Company Numb
     C           *LIKE     DEFN CGABCD    WQSL02           PD Producer Cod
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           PH Company Numb
     C                     KFLD           WQSL02           PD Producer Cod
     C                     KFLD           CGDZDT           PH Week Ending
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           PH Company Numb
     C                     KFLD           WQSL02           PD Producer Cod
      * Setup key
     C                     Z-ADD#1HMNB    WQSL01           PH Company Numb
     C                     MOVEL#1ABCD    WQSL02           PD Producer Cod
     C                     Z-ADD#1AWDT    CGDZDT           PH Week Ending
      * Establish starting position
     C           KPSSL     SETLL@CGCPEJ                    *
     C           KRSSL     READE@CGCPEJ                  90*
      * Data record not found
     C   90                MOVEL'PRK0180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0061    IFEQ 'Y'                        *IF
     C                     Z-ADDCGDZDT    YL0062           PH Week Ending
     C                     MOVEL'N'       YL0061           First Time Flag
     C                     END                             *FI
      * CASE: DB1.PH Week Ending Date NE LCL.PH Week Ending Date
     C           CGDZDT    IFNE YL0062                     *IF
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.PH Summary Type is 2 Week
     C           CGUVST    IFEQ '2WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GE 600
     C           CGOWUI    IFGE 600                        *IF
      * PAR = DB1 By name
     C                     MOVELCGUVST    YL0051           PH Summary Type
     C                     Z-ADDCGORMB    YL0052           PH GA Avg Live
     C                     Z-ADDCGG9PC    YL0053           PH GA Adjusted
     C                     Z-ADDCGHBPC    YL0054           PH GA Avg Lean%
     C                     Z-ADDCGUWOE    YL0055           PH GA Avg Backf
     C                     Z-ADDCGHEPC    YL0056           PH GA Avg Loin
     C                     Z-ADDCGHGPC    YL0057           PH GA Avg Light
     C                     Z-ADDCGTIPR    YL0058           PH GA Lean Prm
     C                     Z-ADDCGB8A1    YL0059           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0060           History Avail S
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PH Summary Type is 4 Week
     C           CGUVST    IFEQ '4WK'                      *IF
      * CASE: DB1.PH GA Head Killed is GT Zero
     C           CGOWUI    IFGT 0                          *IF
      * PAR = DB1 By name
     C                     MOVELCGUVST    YL0051           PH Summary Type
     C                     Z-ADDCGORMB    YL0052           PH GA Avg Live
     C                     Z-ADDCGG9PC    YL0053           PH GA Adjusted
     C                     Z-ADDCGHBPC    YL0054           PH GA Avg Lean%
     C                     Z-ADDCGUWOE    YL0055           PH GA Avg Backf
     C                     Z-ADDCGHEPC    YL0056           PH GA Avg Loin
     C                     Z-ADDCGHGPC    YL0057           PH GA Avg Light
     C                     Z-ADDCGTIPR    YL0058           PH GA Lean Prm
     C                     Z-ADDCGB8A1    YL0059           PH GA Avg Srt D
     C                     MOVEL'Y'       YL0060           History Avail S
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@CGCPEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0014  50       TH Held Over
     C                     Z-ADD*ZERO     WN0015  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057  80       TH Commission A
     C                     Z-ADD*ZERO     WN0058  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0059  1        TH User Error O
     C                     MOVEL*BLANK    WN0060  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0061  1        TH Sex
     C                     Z-ADD*ZERO     WN0062  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063  70       TH Commission P
     C                     Z-ADD*ZERO     WN0064  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0065  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067  31       TH FFLI
     C                     Z-ADD*ZERO     WN0068  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0069  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0070  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0071  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0072  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0084  1        TH Source Type
     C                     MOVEL*BLANK    WN0085  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0086  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0087  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0088  3        TH Source Code
     C                     MOVEL*BLANK    WN0089  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0091  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0092  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0093  6        DF Defect Code
     C                     MOVEL*BLANK    WN0094  6        THP Process Cod
     C                     MOVEL*BLANK    WN0095  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0096  6        PL Location Cod
     C                     MOVEL*BLANK    WN0097  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0098  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0099  3        HC Class Code
     C                     MOVEL*BLANK    WN0100 10        RS User Changed
     C                     Z-ADD*ZERO     WN0101  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0102  60       RS Time Changed
     C                     MOVEL*BLANK    WN0103  1        RS Record Statu
     C                     MOVEL*BLANK    WN0104 10        RS Job
     C                     MOVEL*BLANK    WN0105 10        RS Program
     C                     MOVEL*BLANK    WN0106 10        RS User Added
     C                     Z-ADD*ZERO     WN0107  70       RS Date Added
     C                     Z-ADD*ZERO     WN0108  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S13236 RMC 6/12/18 fixed parms on call to rebalance the FROM date
      *   was passing in DB1. which is from the last day's records. it ne
      *   pass in the PAR context previousely retrieved.  and only do it
      *  are transfer carcasses
     C                     MOVEL'Y'       YL0168           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSN03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSN04           TH Tattoo Numbe
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
     C                     KFLD           WQSN04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSN01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSN02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSN03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSN04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSN     SETLL@A1CPC4                    *
     C           KRSSN     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag Usr is Yes
     C           YL0168    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0168           First Time Flag
      * Net Head Usr
      * LCL.Net Head Usr =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : DB1.TH Head Received
      * -     : PGM.*Synon (15,0) work field
      * x2    : DB1.TH Yard Deads
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.TH Head Condemned
     C           WACWNB    SUB  WAFCNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WAFDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0169           Net Head Usr
     C           YL0169    SUB  WAFENB    YL0170           Transfer Carcas
     C                     Z-ADDWAB0DT    YL0171           TH Kill Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAB0DT    YL0172           Kill Date Usr
     C                     END                             *FI
     C           KRSSN     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Transfer Carcasses    USR is *Zeros
     C           YL0170    IFEQ 0                          *IF
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is GT Zero
     C           YL0170    IFGT 0                          *IF
      * Transfer from the Held Over To Date.
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR SORVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SSRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPGRC
     C                     Z-ADDWAHMNB    PGHMNB           BOH Company Num
     C                     Z-ADDWABNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    PGBONB           BOL Load Number
     C                     Z-ADDWACVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0171    PGB0DT           TH Kill Date
     C                     Z-ADDWN0001    PGAWDT           TH Purchase Dat
     C                     MOVELWN0002    PGBICD    P      TH Group Refere
     C                     MOVELWN0003    PGCPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PGACPR           TH Live Purchas
     C                     Z-ADDWN0005    PGB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PGCAPR           TH LIve Net Amt
     C                     MOVELWN0007    PGC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PGAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PGA6DT           TH Pricing Date
     C                     MOVELWN0010    PGC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PGCXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PGCWNB           TH Head Receive
     C                     Z-ADDWN0013    PGFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PGH9NB           TH Held Over
     C                     Z-ADDWN0015    PGFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PGFENB           TH Head Killed
     C                     Z-ADDWN0017    PGHENB           TH Head Adds
     C                     Z-ADDWN0018    PGHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PGCYNB           TH Live Wgt
     C                     Z-ADDWN0020    PGLRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PGE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PGA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PGFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PGA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PGF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PGF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PGF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PGF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PGF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PGAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PGAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PGCWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PGA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PGA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PGB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PGAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PGANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PGAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PGAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PGAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PGAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PGAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PGASPR           TH Deduction Am
     C                     Z-ADDWN0045    PGA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PGATPR           TH Carcass Net
     C                     Z-ADDWN0047    PGA5VA           TH Additions Am
     C                     Z-ADDWN0048    PGCBPR           TH Payment Gros
     C                     Z-ADDWN0049    PGCCPR           Th Payment Net
     C                     Z-ADDWN0050    PGLPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PGCDPR           TH Freight Amou
     C                     Z-ADDWN0052    PGA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PGA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PGJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PGCWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PGD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PGGHNB           TH Commission A
     C                     Z-ADDWN0058    PGBYDT           TH Voucher Paym
     C                     MOVELWN0059    PGE0ST    P      TH User Error O
     C                     MOVELWN0060    PGE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PGE2ST    P      TH Sex
     C                     Z-ADDWN0062    PGBSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PGBTDT           TH Commission P
     C                     Z-ADDWN0064    PGBUDT           TH Actual Check
     C                     Z-ADDWN0065    PGHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PGHINB           TH FFLI
     C                     Z-ADDWN0068    PGA3PR           TH Kill Product
     C                     Z-ADDWN0069    PGA4PR           TH Cut Product
     C                     Z-ADDWN0070    PGA6PR           TH Render Produ
     C                     Z-ADDWN0071    PGJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PGEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PGEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PGECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PGEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PGEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PGEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PGEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PGEHPR           TH CM Gross Car
     C                     MOVELWN0084    PGKAST    P      TH Source Type
     C                     MOVELWN0085    PGJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PGJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PGOXNB           TH HPS Movement
     C                     MOVELWN0088    PGLKST    P      TH Source Code
     C                     MOVELWN0089    PGLLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PGJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PGLIST    P      TH Schedule Kil
     C                     MOVELWN0092    PGLJST    P      TH Shift Held O
     C                     MOVELWN0093    PGBDCD    P      DF Defect Code
     C                     MOVELWN0094    PGCSCD    P      THP Process Cod
     C                     MOVELWN0095    PGABCD    P      PD Producer Cod
     C                     MOVELWN0096    PGAECD    P      PL Location Cod
     C                     MOVELWN0097    PGACCD    P      HB Buyer Code
     C                     MOVELWN0098    PGAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PGBECD    P      HC Class Code
     C                     MOVELWN0100    PGAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PGAADT           RS Date Changed
     C                     Z-ADDWN0102    PGAMTM           RS Time Changed
     C                     MOVELWN0103    PGAJST    P      RS Record Statu
     C                     MOVELWN0104    PGAHVN    P      RS Job
     C                     MOVELWN0105    PGAGVN    P      RS Program
     C                     MOVELWN0106    PGABVN    P      RS User Added
     C                     Z-ADDWN0107    PGABDT           RS Date Added
     C                     Z-ADDWN0108    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0376  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0377  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0378  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0379  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0380  71       %Lean High Min
     C                     PARM YL0012    WQ0381  71       %Lean High Max
     C                     PARM YL0013    WQ0382  71       %Lean Low Min
     C                     PARM YL0014    WQ0383  71       %Lean Low Max
     C                     PARM YL0015    WQ0384  71       High Yield Min
     C                     PARM YL0016    WQ0385  71       High Yield Max
     C                     PARM YL0017    WQ0386  71       Low Yield Min
     C                     PARM YL0018    WQ0387  71       Low Yield Max
     C                     PARM YL0019    WQ0388  71       Head < Percent
     C                     PARM YL0020    WQ0389  71       Head < Percent
     C                     PARM YL0021    WQ0390  71       Head > Percent
     C                     PARM YL0022    WQ0391  71       Head > Percent
     C                     PARM YL0023    WQ0392  71       BackFat High Mi
     C                     PARM YL0024    WQ0393  71       BackFat High Ma
     C                     PARM YL0025    WQ0394  71       BackFat Low Min
     C                     PARM YL0026    WQ0395  71       Backfat Low Max
     C                     PARM YL0027    WQ0396  71       LoinEye High Mi
     C                     PARM YL0028    WQ0397  71       LoinEye High Ma
     C                     PARM YL0029    WQ0398  71       LoinEye Low Min
     C                     PARM YL0030    WQ0399  71       LoinEye Low Max
     C                     PARM 'N'       WQ0400  1        Requested by Us
     C                     PARM *BLANK    WQ0401  1        Bal w/History
     C                     PARM *BLANK    WQ0402  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0403  3        TH PHA Average
     C                     PARM *BLANK    WQ0404  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0405  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0406  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0407  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0408  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0409  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0410  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0411  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0412  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0413  1        Undo MPR USR
     C           YL0173    PARM *BLANK    WQ0414  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: LCL.Transfer Carcasses    USR is LT Zero
     C           YL0170    IFLT 0                          *IF
      * Transfer from the Held Over From Date.
     C                     MULT -1        YL0170           Transfer Carcas
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
     C                     EXSR STRVGN
      * RMC - moved here from below
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
     C                     EXSR SXRVGN
      * RMC chg to PAR to pick up orig kill date fields
      * Bal/Val Tattoo        XF - Tattoo Header  * 
     C                     CLEARPGRC
     C                     Z-ADDWAHMNB    PGHMNB           BOH Company Num
     C                     Z-ADDWABNNB    PGBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    PGBONB           BOL Load Number
     C                     Z-ADDWACVNB    PGCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0171    PGB0DT           TH Kill Date
     C                     Z-ADDWN0001    PGAWDT           TH Purchase Dat
     C                     MOVELWN0002    PGBICD    P      TH Group Refere
     C                     MOVELWN0003    PGCPST    P      TH Live Purchas
     C                     Z-ADDWN0004    PGACPR           TH Live Purchas
     C                     Z-ADDWN0005    PGB9PR           TH Live Gross A
     C                     Z-ADDWN0006    PGCAPR           TH LIve Net Amt
     C                     MOVELWN0007    PGC4ST    P      TH Resale UOM
     C                     Z-ADDWN0008    PGAIPR           TH Recalc Live
     C                     Z-ADDWN0009    PGA6DT           TH Pricing Date
     C                     MOVELWN0010    PGC2ST    P      TH Resale Sprea
     C                     Z-ADDWN0011    PGCXNB           TH Dead On Arri
     C                     Z-ADDWN0012    PGCWNB           TH Head Receive
     C                     Z-ADDWN0013    PGFCNB           TH Yard Deads
     C                     Z-ADDWN0014    PGH9NB           TH Held Over
     C                     Z-ADDWN0015    PGFDNB           TH Head Condemn
     C                     Z-ADDWN0016    PGFENB           TH Head Killed
     C                     Z-ADDWN0017    PGHENB           TH Head Adds
     C                     Z-ADDWN0018    PGHFNB           TH Head Accepte
     C                     Z-ADDWN0019    PGCYNB           TH Live Wgt
     C                     Z-ADDWN0020    PGLRNB           TH Adj Live Wgt
     C                     Z-ADDWN0021    PGE0NB           TH Hot Wgt
     C                     Z-ADDWN0022    PGA5PC           TH Tot Loin Eye
     C                     Z-ADDWN0023    PGFBNB           TH Tot Backfat
     C                     Z-ADDWN0024    PGA4PC           TH Tot Light Re
     C                     Z-ADDWN0025    PGF7NB           TH Avg Live Wgt
     C                     Z-ADDWN0026    PGHDNB           TH Avg Hot Wgt
     C                     Z-ADDWN0027    PGF5NB           TH Avg Light Re
     C                     Z-ADDWN0028    PGF4NB           TH Avg Lean Per
     C                     Z-ADDWN0029    PGF3NB           TH Avg Loin Eye
     C                     Z-ADDWN0030    PGF2NB           TH Avg Backfat
     C                     Z-ADDWN0031    PGAVPC           TH Std Yield Pe
     C                     Z-ADDWN0032    PGAWPC           TH Actual Yield
     C                     Z-ADDWN0033    PGCWPC           TH Adj Actual Y
     C                     Z-ADDWN0034    PGA8PC           TH Yield Differ
     C                     Z-ADDWN0035    PGA7PC           TH Recalc Live
     C                     Z-ADDWN0036    PGB8PR           TH CM Market Pr
     C                     Z-ADDWN0037    PGAMPR           TH CM Base Mkt
     C                     Z-ADDWN0038    PGANPR           TH CM Base Mkt
     C                     Z-ADDWN0039    PGAYVA           TH CM Sort Disc
     C                     Z-ADDWN0040    PGAWVA           TH CM Yield Gai
     C                     Z-ADDWN0041    PGAOPR           TH CM Base Carc
     C                     Z-ADDWN0042    PGAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0043    PGAPPR           TH CM Carcass G
     C                     Z-ADDWN0044    PGASPR           TH Deduction Am
     C                     Z-ADDWN0045    PGA4VA           TH Total Net WO
     C                     Z-ADDWN0046    PGATPR           TH Carcass Net
     C                     Z-ADDWN0047    PGA5VA           TH Additions Am
     C                     Z-ADDWN0048    PGCBPR           TH Payment Gros
     C                     Z-ADDWN0049    PGCCPR           Th Payment Net
     C                     Z-ADDWN0050    PGLPNB           TH AP Voucher/D
     C                     Z-ADDWN0051    PGCDPR           TH Freight Amou
     C                     Z-ADDWN0052    PGA7VA           TH Accrual Amou
     C                     Z-ADDWN0053    PGA2PR           TH Fixed Cost A
     C                     MOVELWN0054    PGJWST    P      TH Calc Net Sts
     C                     MOVELWN0055    PGCWST    P      TH Payment Sts
     C                     MOVEL*BLANK    PGD6ST    P      TH Bal to Kill
     C                     Z-ADDWN0057    PGGHNB           TH Commission A
     C                     Z-ADDWN0058    PGBYDT           TH Voucher Paym
     C                     MOVELWN0059    PGE0ST    P      TH User Error O
     C                     MOVELWN0060    PGE1ST    P      TH Held Over Re
     C                     MOVELWN0061    PGE2ST    P      TH Sex
     C                     Z-ADDWN0062    PGBSDT           TH Held/Ovr Com
     C                     Z-ADDWN0063    PGBTDT           TH Commission P
     C                     Z-ADDWN0064    PGBUDT           TH Actual Check
     C                     Z-ADDWN0065    PGHGNB           TH Shipped Weig
     C                     Z-ADDWN0066    PGHHNB           TH Avg Hot Wgt
     C                     Z-ADDWN0067    PGHINB           TH FFLI
     C                     Z-ADDWN0068    PGA3PR           TH Kill Product
     C                     Z-ADDWN0069    PGA4PR           TH Cut Product
     C                     Z-ADDWN0070    PGA6PR           TH Render Produ
     C                     Z-ADDWN0071    PGJ9NB           TH Head Exclude
     C                     Z-ADDWN0072    PGD6PR           TH CM Bse Mkt L
     C                     Z-ADDWN0073    PGD7PR           TH CM Bse Mkt C
     C                     Z-ADDWN0074    PGD8PR           TH CM Srt Dsc L
     C                     Z-ADDWN0075    PGD9PR           TH CM Srt Dsc C
     C                     Z-ADDWN0076    PGEAPR           TH CM Yld G/L L
     C                     Z-ADDWN0077    PGEBPR           TH CM Yld G/L C
     C                     Z-ADDWN0078    PGECPR           TH CM Crc Val L
     C                     Z-ADDWN0079    PGEDPR           TH CM Crc Val C
     C                     Z-ADDWN0080    PGEEPR           TH CM Lean Prem
     C                     Z-ADDWN0081    PGEFPR           TH CM Lean Prem
     C                     Z-ADDWN0082    PGEGPR           TH CM Gross Liv
     C                     Z-ADDWN0083    PGEHPR           TH CM Gross Car
     C                     MOVELWN0084    PGKAST    P      TH Source Type
     C                     MOVELWN0085    PGJ7ST    P      TH Scale Ticket
     C                     MOVELWN0086    PGJ9ST    P      TH Payment Type
     C                     Z-ADDWN0087    PGOXNB           TH HPS Movement
     C                     MOVELWN0088    PGLKST    P      TH Source Code
     C                     MOVELWN0089    PGLLST    P      TH Hog Class Ty
     C                     MOVELWN0090    PGJ8ST    P      TH Posted to HP
     C                     MOVELWN0091    PGLIST    P      TH Schedule Kil
     C                     MOVELWN0092    PGLJST    P      TH Shift Held O
     C                     MOVELWN0093    PGBDCD    P      DF Defect Code
     C                     MOVELWN0094    PGCSCD    P      THP Process Cod
     C                     MOVELWN0095    PGABCD    P      PD Producer Cod
     C                     MOVELWN0096    PGAECD    P      PL Location Cod
     C                     MOVELWN0097    PGACCD    P      HB Buyer Code
     C                     MOVELWN0098    PGAGCD    P      GN Genetic Code
     C                     MOVELWN0099    PGBECD    P      HC Class Code
     C                     MOVELWN0100    PGAAVN    P      RS User Changed
     C                     Z-ADDWN0101    PGAADT           RS Date Changed
     C                     Z-ADDWN0102    PGAMTM           RS Time Changed
     C                     MOVELWN0103    PGAJST    P      RS Record Statu
     C                     MOVELWN0104    PGAHVN    P      RS Job
     C                     MOVELWN0105    PGAGVN    P      RS Program
     C                     MOVELWN0106    PGABVN    P      RS User Added
     C                     Z-ADDWN0107    PGABDT           RS Date Added
     C                     Z-ADDWN0108    PGABTM           RS Time Added
      *
     C                     CALL 'PKAAXFR'              90  Bal/Val Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Tattoo Hea
     C                     PARM YL0007    WQ0415  71       Carcass Dbw Min
     C                     PARM YL0008    WQ0416  71       Carcass Dbw Max
     C                     PARM YL0009    WQ0417  71       Carcass Lgt Min
     C                     PARM YL0010    WQ0418  71       Carcass Lgt Max
     C                     PARM YL0011    WQ0419  71       %Lean High Min
     C                     PARM YL0012    WQ0420  71       %Lean High Max
     C                     PARM YL0013    WQ0421  71       %Lean Low Min
     C                     PARM YL0014    WQ0422  71       %Lean Low Max
     C                     PARM YL0015    WQ0423  71       High Yield Min
     C                     PARM YL0016    WQ0424  71       High Yield Max
     C                     PARM YL0017    WQ0425  71       Low Yield Min
     C                     PARM YL0018    WQ0426  71       Low Yield Max
     C                     PARM YL0019    WQ0427  71       Head < Percent
     C                     PARM YL0020    WQ0428  71       Head < Percent
     C                     PARM YL0021    WQ0429  71       Head > Percent
     C                     PARM YL0022    WQ0430  71       Head > Percent
     C                     PARM YL0023    WQ0431  71       BackFat High Mi
     C                     PARM YL0024    WQ0432  71       BackFat High Ma
     C                     PARM YL0025    WQ0433  71       BackFat Low Min
     C                     PARM YL0026    WQ0434  71       Backfat Low Max
     C                     PARM YL0027    WQ0435  71       LoinEye High Mi
     C                     PARM YL0028    WQ0436  71       LoinEye High Ma
     C                     PARM YL0029    WQ0437  71       LoinEye Low Min
     C                     PARM YL0030    WQ0438  71       LoinEye Low Max
     C                     PARM 'N'       WQ0439  1        Requested by Us
     C                     PARM *BLANK    WQ0440  1        Bal w/History
     C                     PARM *BLANK    WQ0441  1        TH PHA Add Type
     C                     PARM *BLANK    WQ0442  3        TH PHA Average
     C                     PARM *BLANK    WQ0443  1        TH PHA Add Reas
     C                     PARM *ZERO     WQ0444  51       PH GA Avg Live
     C                     PARM *ZERO     WQ0445  52       PH GA Adjusted
     C                     PARM *ZERO     WQ0446  31       PH GA Avg Lean%
     C                     PARM *ZERO     WQ0447  31       PH GA Avg Backf
     C                     PARM *ZERO     WQ0448  31       PH GA Avg Loin
     C                     PARM *ZERO     WQ0449  31       PH GA Avg Light
     C                     PARM *ZERO     WQ0450  52       PH GA Lean Prm
     C                     PARM *ZERO     WQ0451  53       PH GA Avg Srt D
     C                     PARM 'N'       WQ0452  1        Undo MPR USR
     C           YL0173    PARM *BLANK    WQ0453  1        Balance First D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Balance Held From Date.
      * RMC chg to PAR to pick up orig kill date fields - and moved up
      *      to run only if a transfer is necessary     6/11/18
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQSO03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQSO04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQSO05           TH Kill Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
     C                     KFLD           WQSO04           TH Tattoo Numbe
     C                     KFLD           WQSO05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSO01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSO02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSO03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSO04           TH Tattoo Numbe
     C                     Z-ADDYL0172    WQSO05           TH Kill Date
      * Establish starting position
     C           KRSSO     SETLL@BVCPQ9                    *
     C           KRSSO     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0170    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SPRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SQCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SRDLRC
     C                     SUB  1         YL0170           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHSNB    WQSP01           ET Company Numb
     C           *LIKE     DEFN WBA9DT    WQSP02           ET Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           ET Company Numb
     C                     KFLD           WQSP02           ET Kill Date
      * Setup key
     C                     Z-ADDBVHSNB    WQSP01           ET Company Numb
     C                     Z-ADDYL0171    WQSP02           ET Kill Date
      * Establish starting position
     C           KRSSP     SETLL@BVCPNE                    *
     C           KRSSP     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SPEXIT                     *QUIT
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WBFJNB    IFGE 000001                     *IF
     C           WBFJNB    ANDLE699999
     C           WBFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDBVHSNB    WCHSNB           ET Company Numb
     C                     Z-ADDYL0171    WCA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WCFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    WCHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    WCGDNB           ET Carcass Numb
     C                     Z-ADD#1CVNB    WCFINB           ET Tattoo Numbe
     C                     Z-ADDBVLKNB    WCLKNB           ET Lot
     C                     MOVELBVEAST    WCEAST           ET Shift
     C                     Z-ADDBVAMPC    WCAMPC           ET Hot Wgt
     C                     Z-ADDBVAIPC    WCAIPC           ET Backfat Thic
     C                     Z-ADDBVAJPC    WCAJPC           ET Loin-Eye Dep
     C                     Z-ADDBVAKPC    WCAKPC           ET Lean Percent
     C                     Z-ADDBVX8NB    WCX8NB           ET Backfat Thic
     C                     Z-ADDBVFVPC    WCFVPC           ET Loineye Dept
     C                     Z-ADDBVFWPC    WCFWPC           ET Light Reflec
     C                     Z-ADDBVFXPC    WCFXPC           ET Lean Percent
     C                     Z-ADDBVALPC    WCALPC           ET Light Reflec
     C                     MOVELBVDIST    WCDIST           ET Trim Area
     C                     MOVELBVFYST    WCFYST           ET Carcass Sex
     C                     MOVELBVD2ST    WCD2ST           ET Error Sts
     C                     MOVELBVEHST    WCEHST           ET Record Add/D
     C                     MOVELBVG1ST    WCG1ST           ET Record Creat
     C                     MOVELBVH4ST    WCH4ST           ET Record Creat
     C                     MOVELBVJLST    WCJLST           ET User Error O
     C                     MOVELBVUUST    WCUUST           ET Adjust/Add T
     C                     MOVELBVVHST    WCVHST           ET Broken Back
     C                     MOVELBVVIST    WCVIST           ET Unused Sts 2
     C                     MOVELBVVJST    WCVJST           ET Adjust/Add S
     C                     MOVELBVVKST    WCVKST           ET Unused Sts 4
     C                     MOVELBVVLST    WCVLST           ET Unused Sts 5
     C                     Z-ADDBVHMNB    WCHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WCBONB           BOL Load Number
     C                     Z-ADD#1CVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0171    WCB0DT           TH Kill Date
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELBVAJST    WCAJST           RS Record Statu
     C                     MOVELBVAHVN    WCAHVN           RS Job
     C                     MOVELBVAGVN    WCAGVN           RS Program
     C                     MOVELBVABVN    WCABVN           RS User Added
     C                     Z-ADDBVABDT    WCABDT           RS Date Added
     C                     Z-ADDBVABTM    WCABTM           RS Time Added
     C                     Z-ADDBVB8DT    WCB8DT           RU Date
     C                     Z-ADDBVAOTM    WCAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WCAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WCHSNB           ET Company Numb
     C                     KFLD           WCA9DT           ET Kill Date
     C                     KFLD           WCFJNB           ET Scale Sequen
     C                     KFLD           WCHCNB           ET Carcass Numb
     C                     KFLD           WCGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDBVHSNB    WCHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    WCA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    WCFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    WCHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    WCGDNB           ET Carcass Numb
      *
     C           KLDLSR    KLIST
     C                     KFLD           WCHSNB           ET Company Numb
     C                     KFLD           WCA9DT           ET Kill Date
     C                     KFLD           WCFJNB           ET Scale Sequen
     C                     KFLD           WCHCNB           ET Carcass Numb
     C                     KFLD           WCGDNB           ET Carcass Numb
     C           KLDLSR    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WABONB           BOL Load Number
     C                     Z-ADDWACVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0171    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSS     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAWDT    WN0001           TH Purchase Dat
     C                     MOVELWABICD    WN0002           TH Group Refere
     C                     MOVELWACPST    WN0003           TH Live Purchas
     C                     Z-ADDWAACPR    WN0004           TH Live Purchas
     C                     Z-ADDWAB9PR    WN0005           TH Live Gross A
     C                     Z-ADDWACAPR    WN0006           TH LIve Net Amt
     C                     MOVELWAC4ST    WN0007           TH Resale UOM
     C                     Z-ADDWAAIPR    WN0008           TH Recalc Live
     C                     Z-ADDWAA6DT    WN0009           TH Pricing Date
     C                     MOVELWAC2ST    WN0010           TH Resale Sprea
     C                     Z-ADDWACXNB    WN0011           TH Dead On Arri
     C                     Z-ADDWACWNB    WN0012           TH Head Receive
     C                     Z-ADDWAFCNB    WN0013           TH Yard Deads
     C                     Z-ADDWAH9NB    WN0014           TH Held Over
     C                     Z-ADDWAFDNB    WN0015           TH Head Condemn
     C                     Z-ADDWAFENB    WN0016           TH Head Killed
     C                     Z-ADDWAHENB    WN0017           TH Head Adds
     C                     Z-ADDWAHFNB    WN0018           TH Head Accepte
     C                     Z-ADDWACYNB    WN0019           TH Live Wgt
     C                     Z-ADDWALRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDWAE0NB    WN0021           TH Hot Wgt
     C                     Z-ADDWAA5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDWAFBNB    WN0023           TH Tot Backfat
     C                     Z-ADDWAA4PC    WN0024           TH Tot Light Re
     C                     Z-ADDWAF7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDWAHDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDWAF5NB    WN0027           TH Avg Light Re
     C                     Z-ADDWAF4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDWAF3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDWAF2NB    WN0030           TH Avg Backfat
     C                     Z-ADDWAAVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDWAAWPC    WN0032           TH Actual Yield
     C                     Z-ADDWACWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDWAA8PC    WN0034           TH Yield Differ
     C                     Z-ADDWAA7PC    WN0035           TH Recalc Live
     C                     Z-ADDWAB8PR    WN0036           TH CM Market Pr
     C                     Z-ADDWAAMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDWAANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDWAAYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDWAAWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDWAAOPR    WN0041           TH CM Base Carc
     C                     Z-ADDWAAXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDWAAPPR    WN0043           TH CM Carcass G
     C                     Z-ADDWAASPR    WN0044           TH Deduction Am
     C                     Z-ADDWAA4VA    WN0045           TH Total Net WO
     C                     Z-ADDWAATPR    WN0046           TH Carcass Net
     C                     Z-ADDWAA5VA    WN0047           TH Additions Am
     C                     Z-ADDWACBPR    WN0048           TH Payment Gros
     C                     Z-ADDWACCPR    WN0049           Th Payment Net
     C                     Z-ADDWALPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDWACDPR    WN0051           TH Freight Amou
     C                     Z-ADDWAA7VA    WN0052           TH Accrual Amou
     C                     Z-ADDWAA2PR    WN0053           TH Fixed Cost A
     C                     MOVELWAJWST    WN0054           TH Calc Net Sts
     C                     MOVELWACWST    WN0055           TH Payment Sts
     C                     MOVELWAD6ST    WN0056           TH Bal to Kill
     C                     Z-ADDWAGHNB    WN0057           TH Commission A
     C                     Z-ADDWABYDT    WN0058           TH Voucher Paym
     C                     MOVELWAE0ST    WN0059           TH User Error O
     C                     MOVELWAE1ST    WN0060           TH Held Over Re
     C                     MOVELWAE2ST    WN0061           TH Sex
     C                     Z-ADDWABSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDWABTDT    WN0063           TH Commission P
     C                     Z-ADDWABUDT    WN0064           TH Actual Check
     C                     Z-ADDWAHGNB    WN0065           TH Shipped Weig
     C                     Z-ADDWAHHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDWAHINB    WN0067           TH FFLI
     C                     Z-ADDWAA3PR    WN0068           TH Kill Product
     C                     Z-ADDWAA4PR    WN0069           TH Cut Product
     C                     Z-ADDWAA6PR    WN0070           TH Render Produ
     C                     Z-ADDWAJ9NB    WN0071           TH Head Exclude
     C                     Z-ADDWAD6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDWAECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDWAEDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDWAEEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDWAEFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDWAEGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDWAEHPR    WN0083           TH CM Gross Car
     C                     MOVELWAKAST    WN0084           TH Source Type
     C                     MOVELWAJ7ST    WN0085           TH Scale Ticket
     C                     MOVELWAJ9ST    WN0086           TH Payment Type
     C                     Z-ADDWAOXNB    WN0087           TH HPS Movement
     C                     MOVELWALKST    WN0088           TH Source Code
     C                     MOVELWALLST    WN0089           TH Hog Class Ty
     C                     MOVELWAJ8ST    WN0090           TH Posted to HP
     C                     MOVELWALIST    WN0091           TH Schedule Kil
     C                     MOVELWALJST    WN0092           TH Shift Held O
     C                     MOVELWABDCD    WN0093           DF Defect Code
     C                     MOVELWACSCD    WN0094           THP Process Cod
     C                     MOVELWAABCD    WN0095           PD Producer Cod
     C                     MOVELWAAECD    WN0096           PL Location Cod
     C                     MOVELWAACCD    WN0097           HB Buyer Code
     C                     MOVELWAAGCD    WN0098           GN Genetic Code
     C                     MOVELWABECD    WN0099           HC Class Code
     C                     MOVELWAAAVN    WN0100           RS User Changed
     C                     Z-ADDWAAADT    WN0101           RS Date Changed
     C                     Z-ADDWAAMTM    WN0102           RS Time Changed
     C                     MOVELWAAJST    WN0103           RS Record Statu
     C                     MOVELWAAHVN    WN0104           RS Job
     C                     MOVELWAAGVN    WN0105           RS Program
     C                     MOVELWAABVN    WN0106           RS User Added
     C                     Z-ADDWAABDT    WN0107           RS Date Added
     C                     Z-ADDWAABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Trnsfr Eval Trns  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQST03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQST04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQST05           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Tattoo Numbe
     C                     KFLD           WQST05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQST01           BOH Company Num
     C                     Z-ADDWABNNB    WQST02           BOH Buy Order N
     C                     Z-ADDWABONB    WQST03           BOL Load Number
     C                     Z-ADDWACVNB    WQST04           TH Tattoo Numbe
     C                     Z-ADDYL0171    WQST05           TH Kill Date
      * Establish starting position
     C           KRSST     SETLL@BVCPQ9                    *
     C           KRSST     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Transfer Carcasses    USR is GT Zero
     C           YL0170    IFGT 0                          *IF
      * 9/29/2010 slm check for deleted record
      * do not move the record if this is a deleted record
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SURVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SVCRRC
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SWDLRC
     C                     SUB  1         YL0170           Transfer Carcas
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHSNB    WQSU01           ET Company Numb
     C           *LIKE     DEFN WBA9DT    WQSU02           ET Kill Date
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           ET Company Numb
     C                     KFLD           WQSU02           ET Kill Date
      * Setup key
     C                     Z-ADDBVHSNB    WQSU01           ET Company Numb
     C                     Z-ADDYL0172    WQSU02           ET Kill Date
      * Establish starting position
     C           KRSSU     SETLL@BVCPNE                    *
     C           KRSSU     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUFJNB           ET Scale Sequen
     C                     GOTO SUEXIT                     *QUIT
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WBFJNB    IFGE 000001                     *IF
     C           WBFJNB    ANDLE699999
     C           WBFJNB    ADD  1         WUFJNB           ET Scale Sequen
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSU     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDBVHSNB    WCHSNB           ET Company Numb
     C                     Z-ADDYL0172    WCA9DT           ET Kill Date
     C                     Z-ADDWUFJNB    WCFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    WCHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    WCGDNB           ET Carcass Numb
     C                     Z-ADDWACVNB    WCFINB           ET Tattoo Numbe
     C                     Z-ADDBVLKNB    WCLKNB           ET Lot
     C                     MOVELBVEAST    WCEAST           ET Shift
     C                     Z-ADDBVAMPC    WCAMPC           ET Hot Wgt
     C                     Z-ADDBVAIPC    WCAIPC           ET Backfat Thic
     C                     Z-ADDBVAJPC    WCAJPC           ET Loin-Eye Dep
     C                     Z-ADDBVAKPC    WCAKPC           ET Lean Percent
     C                     Z-ADDBVX8NB    WCX8NB           ET Backfat Thic
     C                     Z-ADDBVFVPC    WCFVPC           ET Loineye Dept
     C                     Z-ADDBVFWPC    WCFWPC           ET Light Reflec
     C                     Z-ADDBVFXPC    WCFXPC           ET Lean Percent
     C                     Z-ADDBVALPC    WCALPC           ET Light Reflec
     C                     MOVELBVDIST    WCDIST           ET Trim Area
     C                     MOVELBVFYST    WCFYST           ET Carcass Sex
     C                     MOVELBVD2ST    WCD2ST           ET Error Sts
     C                     MOVELBVEHST    WCEHST           ET Record Add/D
     C                     MOVELBVG1ST    WCG1ST           ET Record Creat
     C                     MOVELBVH4ST    WCH4ST           ET Record Creat
     C                     MOVELBVJLST    WCJLST           ET User Error O
     C                     MOVELBVUUST    WCUUST           ET Adjust/Add T
     C                     MOVELBVVHST    WCVHST           ET Broken Back
     C                     MOVELBVVIST    WCVIST           ET Unused Sts 2
     C                     MOVELBVVJST    WCVJST           ET Adjust/Add S
     C                     MOVELBVVKST    WCVKST           ET Unused Sts 4
     C                     MOVELBVVLST    WCVLST           ET Unused Sts 5
     C                     Z-ADDBVHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDYL0172    WCB0DT           TH Kill Date
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVELBVAJST    WCAJST           RS Record Statu
     C                     MOVELBVAHVN    WCAHVN           RS Job
     C                     MOVELBVAGVN    WCAGVN           RS Program
     C                     MOVELBVABVN    WCABVN           RS User Added
     C                     Z-ADDBVABDT    WCABDT           RS Date Added
     C                     Z-ADDBVABTM    WCABTM           RS Time Added
     C                     Z-ADDBVB8DT    WCB8DT           RU Date
     C                     Z-ADDBVAOTM    WCAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WCAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WCAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSV    KLIST
     C                     KFLD           WCHSNB           ET Company Numb
     C                     KFLD           WCA9DT           ET Kill Date
     C                     KFLD           WCFJNB           ET Scale Sequen
     C                     KFLD           WCHCNB           ET Carcass Numb
     C                     KFLD           WCGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSV    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDBVHSNB    WCHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    WCA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    WCFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    WCHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    WCGDNB           ET Carcass Numb
      *
     C           KLDLSW    KLIST
     C                     KFLD           WCHSNB           ET Company Numb
     C                     KFLD           WCA9DT           ET Kill Date
     C                     KFLD           WCFJNB           ET Scale Sequen
     C                     KFLD           WCHCNB           ET Carcass Numb
     C                     KFLD           WCGDNB           ET Carcass Numb
     C           KLDLSW    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Tattoo 4/Balance  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WABONB           BOL Load Number
     C                     Z-ADDWACVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDYL0171    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSX     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Purchase Dat
     C                     MOVEL*BLANK    WN0002           TH Group Refere
     C                     MOVEL*BLANK    WN0003           TH Live Purchas
     C                     Z-ADD*ZERO     WN0004           TH Live Purchas
     C                     Z-ADD*ZERO     WN0005           TH Live Gross A
     C                     Z-ADD*ZERO     WN0006           TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007           TH Resale UOM
     C                     Z-ADD*ZERO     WN0008           TH Recalc Live
     C                     Z-ADD*ZERO     WN0009           TH Pricing Date
     C                     MOVEL*BLANK    WN0010           TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011           TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012           TH Head Receive
     C                     Z-ADD*ZERO     WN0013           TH Yard Deads
     C                     Z-ADD*ZERO     WN0014           TH Held Over
     C                     Z-ADD*ZERO     WN0015           TH Head Condemn
     C                     Z-ADD*ZERO     WN0016           TH Head Killed
     C                     Z-ADD*ZERO     WN0017           TH Head Adds
     C                     Z-ADD*ZERO     WN0018           TH Head Accepte
     C                     Z-ADD*ZERO     WN0019           TH Live Wgt
     C                     Z-ADD*ZERO     WN0020           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023           TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024           TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027           TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028           TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031           TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032           TH Actual Yield
     C                     Z-ADD*ZERO     WN0033           TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034           TH Yield Differ
     C                     Z-ADD*ZERO     WN0035           TH Recalc Live
     C                     Z-ADD*ZERO     WN0036           TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038           TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039           TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040           TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041           TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043           TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044           TH Deduction Am
     C                     Z-ADD*ZERO     WN0045           TH Total Net WO
     C                     Z-ADD*ZERO     WN0046           TH Carcass Net
     C                     Z-ADD*ZERO     WN0047           TH Additions Am
     C                     Z-ADD*ZERO     WN0048           TH Payment Gros
     C                     Z-ADD*ZERO     WN0049           Th Payment Net
     C                     Z-ADD*ZERO     WN0050           TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051           TH Freight Amou
     C                     Z-ADD*ZERO     WN0052           TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053           TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054           TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055           TH Payment Sts
     C                     MOVEL*BLANK    WN0056           TH Bal to Kill
     C                     Z-ADD*ZERO     WN0057           TH Commission A
     C                     Z-ADD*ZERO     WN0058           TH Voucher Paym
     C                     MOVEL*BLANK    WN0059           TH User Error O
     C                     MOVEL*BLANK    WN0060           TH Held Over Re
     C                     MOVEL*BLANK    WN0061           TH Sex
     C                     Z-ADD*ZERO     WN0062           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0063           TH Commission P
     C                     Z-ADD*ZERO     WN0064           TH Actual Check
     C                     Z-ADD*ZERO     WN0065           TH Shipped Weig
     C                     Z-ADD*ZERO     WN0066           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0067           TH FFLI
     C                     Z-ADD*ZERO     WN0068           TH Kill Product
     C                     Z-ADD*ZERO     WN0069           TH Cut Product
     C                     Z-ADD*ZERO     WN0070           TH Render Produ
     C                     Z-ADD*ZERO     WN0071           TH Head Exclude
     C                     Z-ADD*ZERO     WN0072           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0073           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0074           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0075           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0076           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0077           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0078           TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0079           TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0080           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0081           TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082           TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0083           TH CM Gross Car
     C                     MOVEL*BLANK    WN0084           TH Source Type
     C                     MOVEL*BLANK    WN0085           TH Scale Ticket
     C                     MOVEL*BLANK    WN0086           TH Payment Type
     C                     Z-ADD*ZERO     WN0087           TH HPS Movement
     C                     MOVEL*BLANK    WN0088           TH Source Code
     C                     MOVEL*BLANK    WN0089           TH Hog Class Ty
     C                     MOVEL*BLANK    WN0090           TH Posted to HP
     C                     MOVEL*BLANK    WN0091           TH Schedule Kil
     C                     MOVEL*BLANK    WN0092           TH Shift Held O
     C                     MOVEL*BLANK    WN0093           DF Defect Code
     C                     MOVEL*BLANK    WN0094           THP Process Cod
     C                     MOVEL*BLANK    WN0095           PD Producer Cod
     C                     MOVEL*BLANK    WN0096           PL Location Cod
     C                     MOVEL*BLANK    WN0097           HB Buyer Code
     C                     MOVEL*BLANK    WN0098           GN Genetic Code
     C                     MOVEL*BLANK    WN0099           HC Class Code
     C                     MOVEL*BLANK    WN0100           RS User Changed
     C                     Z-ADD*ZERO     WN0101           RS Date Changed
     C                     Z-ADD*ZERO     WN0102           RS Time Changed
     C                     MOVEL*BLANK    WN0103           RS Record Statu
     C                     MOVEL*BLANK    WN0104           RS Job
     C                     MOVEL*BLANK    WN0105           RS Program
     C                     MOVEL*BLANK    WN0106           RS User Added
     C                     Z-ADD*ZERO     WN0107           RS Date Added
     C                     Z-ADD*ZERO     WN0108           RS Time Added
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAWDT    WN0001           TH Purchase Dat
     C                     MOVELWABICD    WN0002           TH Group Refere
     C                     MOVELWACPST    WN0003           TH Live Purchas
     C                     Z-ADDWAACPR    WN0004           TH Live Purchas
     C                     Z-ADDWAB9PR    WN0005           TH Live Gross A
     C                     Z-ADDWACAPR    WN0006           TH LIve Net Amt
     C                     MOVELWAC4ST    WN0007           TH Resale UOM
     C                     Z-ADDWAAIPR    WN0008           TH Recalc Live
     C                     Z-ADDWAA6DT    WN0009           TH Pricing Date
     C                     MOVELWAC2ST    WN0010           TH Resale Sprea
     C                     Z-ADDWACXNB    WN0011           TH Dead On Arri
     C                     Z-ADDWACWNB    WN0012           TH Head Receive
     C                     Z-ADDWAFCNB    WN0013           TH Yard Deads
     C                     Z-ADDWAH9NB    WN0014           TH Held Over
     C                     Z-ADDWAFDNB    WN0015           TH Head Condemn
     C                     Z-ADDWAFENB    WN0016           TH Head Killed
     C                     Z-ADDWAHENB    WN0017           TH Head Adds
     C                     Z-ADDWAHFNB    WN0018           TH Head Accepte
     C                     Z-ADDWACYNB    WN0019           TH Live Wgt
     C                     Z-ADDWALRNB    WN0020           TH Adj Live Wgt
     C                     Z-ADDWAE0NB    WN0021           TH Hot Wgt
     C                     Z-ADDWAA5PC    WN0022           TH Tot Loin Eye
     C                     Z-ADDWAFBNB    WN0023           TH Tot Backfat
     C                     Z-ADDWAA4PC    WN0024           TH Tot Light Re
     C                     Z-ADDWAF7NB    WN0025           TH Avg Live Wgt
     C                     Z-ADDWAHDNB    WN0026           TH Avg Hot Wgt
     C                     Z-ADDWAF5NB    WN0027           TH Avg Light Re
     C                     Z-ADDWAF4NB    WN0028           TH Avg Lean Per
     C                     Z-ADDWAF3NB    WN0029           TH Avg Loin Eye
     C                     Z-ADDWAF2NB    WN0030           TH Avg Backfat
     C                     Z-ADDWAAVPC    WN0031           TH Std Yield Pe
     C                     Z-ADDWAAWPC    WN0032           TH Actual Yield
     C                     Z-ADDWACWPC    WN0033           TH Adj Actual Y
     C                     Z-ADDWAA8PC    WN0034           TH Yield Differ
     C                     Z-ADDWAA7PC    WN0035           TH Recalc Live
     C                     Z-ADDWAB8PR    WN0036           TH CM Market Pr
     C                     Z-ADDWAAMPR    WN0037           TH CM Base Mkt
     C                     Z-ADDWAANPR    WN0038           TH CM Base Mkt
     C                     Z-ADDWAAYVA    WN0039           TH CM Sort Disc
     C                     Z-ADDWAAWVA    WN0040           TH CM Yield Gai
     C                     Z-ADDWAAOPR    WN0041           TH CM Base Carc
     C                     Z-ADDWAAXVA    WN0042           TH CM LN AddOn/
     C                     Z-ADDWAAPPR    WN0043           TH CM Carcass G
     C                     Z-ADDWAASPR    WN0044           TH Deduction Am
     C                     Z-ADDWAA4VA    WN0045           TH Total Net WO
     C                     Z-ADDWAATPR    WN0046           TH Carcass Net
     C                     Z-ADDWAA5VA    WN0047           TH Additions Am
     C                     Z-ADDWACBPR    WN0048           TH Payment Gros
     C                     Z-ADDWACCPR    WN0049           Th Payment Net
     C                     Z-ADDWALPNB    WN0050           TH AP Voucher/D
     C                     Z-ADDWACDPR    WN0051           TH Freight Amou
     C                     Z-ADDWAA7VA    WN0052           TH Accrual Amou
     C                     Z-ADDWAA2PR    WN0053           TH Fixed Cost A
     C                     MOVELWAJWST    WN0054           TH Calc Net Sts
     C                     MOVELWACWST    WN0055           TH Payment Sts
     C                     MOVELWAD6ST    WN0056           TH Bal to Kill
     C                     Z-ADDWAGHNB    WN0057           TH Commission A
     C                     Z-ADDWABYDT    WN0058           TH Voucher Paym
     C                     MOVELWAE0ST    WN0059           TH User Error O
     C                     MOVELWAE1ST    WN0060           TH Held Over Re
     C                     MOVELWAE2ST    WN0061           TH Sex
     C                     Z-ADDWABSDT    WN0062           TH Held/Ovr Com
     C                     Z-ADDWABTDT    WN0063           TH Commission P
     C                     Z-ADDWABUDT    WN0064           TH Actual Check
     C                     Z-ADDWAHGNB    WN0065           TH Shipped Weig
     C                     Z-ADDWAHHNB    WN0066           TH Avg Hot Wgt
     C                     Z-ADDWAHINB    WN0067           TH FFLI
     C                     Z-ADDWAA3PR    WN0068           TH Kill Product
     C                     Z-ADDWAA4PR    WN0069           TH Cut Product
     C                     Z-ADDWAA6PR    WN0070           TH Render Produ
     C                     Z-ADDWAJ9NB    WN0071           TH Head Exclude
     C                     Z-ADDWAD6PR    WN0072           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    WN0073           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    WN0074           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    WN0075           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    WN0076           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    WN0077           TH CM Yld G/L C
     C                     Z-ADDWAECPR    WN0078           TH CM Crc Val L
     C                     Z-ADDWAEDPR    WN0079           TH CM Crc Val C
     C                     Z-ADDWAEEPR    WN0080           TH CM Lean Prem
     C                     Z-ADDWAEFPR    WN0081           TH CM Lean Prem
     C                     Z-ADDWAEGPR    WN0082           TH CM Gross Liv
     C                     Z-ADDWAEHPR    WN0083           TH CM Gross Car
     C                     MOVELWAKAST    WN0084           TH Source Type
     C                     MOVELWAJ7ST    WN0085           TH Scale Ticket
     C                     MOVELWAJ9ST    WN0086           TH Payment Type
     C                     Z-ADDWAOXNB    WN0087           TH HPS Movement
     C                     MOVELWALKST    WN0088           TH Source Code
     C                     MOVELWALLST    WN0089           TH Hog Class Ty
     C                     MOVELWAJ8ST    WN0090           TH Posted to HP
     C                     MOVELWALIST    WN0091           TH Schedule Kil
     C                     MOVELWALJST    WN0092           TH Shift Held O
     C                     MOVELWABDCD    WN0093           DF Defect Code
     C                     MOVELWACSCD    WN0094           THP Process Cod
     C                     MOVELWAABCD    WN0095           PD Producer Cod
     C                     MOVELWAAECD    WN0096           PL Location Cod
     C                     MOVELWAACCD    WN0097           HB Buyer Code
     C                     MOVELWAAGCD    WN0098           GN Genetic Code
     C                     MOVELWABECD    WN0099           HC Class Code
     C                     MOVELWAAAVN    WN0100           RS User Changed
     C                     Z-ADDWAAADT    WN0101           RS Date Changed
     C                     Z-ADDWAAMTM    WN0102           RS Time Changed
     C                     MOVELWAAJST    WN0103           RS Record Statu
     C                     MOVELWAAHVN    WN0104           RS Job
     C                     MOVELWAAGVN    WN0105           RS Program
     C                     MOVELWAABVN    WN0106           RS User Added
     C                     Z-ADDWAABDT    WN0107           RS Date Added
     C                     Z-ADDWAABTM    WN0108           RS Time Added
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Val Crc Dtl for Val  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1HMNB    WQSZ01           BOH Company Num
     C           *LIKE     DEFN B1BNNB    WQSZ02           BOH Buy Order N
     C           *LIKE     DEFN B1BONB    WQSZ03           BOL Load Number
     C           *LIKE     DEFN B1CVNB    WQSZ04           TH Tattoo Numbe
     C           *LIKE     DEFN B1B0DT    WQSZ05           TH Kill Date
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           BOH Company Num
     C                     KFLD           WQSZ02           BOH Buy Order N
     C                     KFLD           WQSZ03           BOL Load Number
     C                     KFLD           WQSZ04           TH Tattoo Numbe
     C                     KFLD           WQSZ05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSZ01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSZ02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSZ03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSZ04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSZ05           TH Kill Date
      * Establish starting position
     C           KRSSZ     SETLL@B1CPG7                    *
     C           KRSSZ     READE@B1CPG7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0138' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Val Eval Trans Exists RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQTA03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQTA04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQTA05           TH Kill Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
     C                     KFLD           WQTA04           TH Tattoo Numbe
     C                     KFLD           WQTA05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQTA01           BOH Company Num
     C                     Z-ADD#1BNNB    WQTA02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQTA03           BOL Load Number
     C                     Z-ADD#1CVNB    WQTA04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQTA05           TH Kill Date
      * Establish starting position
     C           KRSTA     SETLL@BVCPQ9                    *
     C           KRSTA     READE@BVCPQ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Record Add/Del Sts is Uploaded Records
     C           BVEHST    IFEQ *BLANK                     *IF
     C           BVEHST    OREQ 'D'
      * Upload records were already applied to this tattoo number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0008           Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0009           Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0010           Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0011           %Lean High Min
     C                     Z-ADD*ZERO     YL0012           %Lean High Max
     C                     Z-ADD*ZERO     YL0013           %Lean Low Min
     C                     Z-ADD*ZERO     YL0014           %Lean Low Max
     C                     Z-ADD*ZERO     YL0015           High Yield Min
     C                     Z-ADD*ZERO     YL0016           High Yield Max
     C                     Z-ADD*ZERO     YL0017           Low Yield Min
     C                     Z-ADD*ZERO     YL0018           Low Yield Max
     C                     Z-ADD*ZERO     YL0019           Head < Percent
     C                     Z-ADD*ZERO     YL0020           Head < Percent
     C                     Z-ADD*ZERO     YL0021           Head > Percent
     C                     Z-ADD*ZERO     YL0022           Head > Percent
     C                     Z-ADD*ZERO     YL0023           BackFat High Mi
     C                     Z-ADD*ZERO     YL0024           BackFat High Ma
     C                     Z-ADD*ZERO     YL0025           BackFat Low Min
     C                     Z-ADD*ZERO     YL0026           Backfat Low Max
     C                     Z-ADD*ZERO     YL0027           LoinEye High Mi
     C                     Z-ADD*ZERO     YL0028           LoinEye High Ma
     C                     Z-ADD*ZERO     YL0029           LoinEye Low Min
     C                     Z-ADD*ZERO     YL0030           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    YL0007           Carcass Dbw Min
     C                     Z-ADDBOAGPC    YL0008           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    YL0009           Carcass Lgt Min
     C                     Z-ADDBOAGPC    YL0010           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    YL0023           BackFat High Mi
     C                     Z-ADDBOAGPC    YL0024           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    YL0025           BackFat Low Min
     C                     Z-ADDBOAGPC    YL0026           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    YL0027           LoinEye High Mi
     C                     Z-ADDBOAGPC    YL0028           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    YL0029           LoinEye Low Min
     C                     Z-ADDBOAGPC    YL0030           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    YL0011           %Lean High Min
     C                     Z-ADDBOAGPC    YL0012           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    YL0013           %Lean Low Min
     C                     Z-ADDBOAGPC    YL0014           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    YL0019           Head < Percent
     C                     Z-ADDBOAGPC    YL0020           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    YL0021           Head > Percent
     C                     Z-ADDBOAGPC    YL0022           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    YL0015           High Yield Min
     C                     Z-ADDBOAGPC    YL0016           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    YL0017           Low Yield Min
     C                     Z-ADDBOAGPC    YL0018           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      *  6/07/2021 JBB SDD619 - Repayments by Business Users
      *================================================================
      * Chk Tattoo Rcd Exists RT - Tattoo Repayment Detail  * 
     C                     EXSR SHRVGN
      * If repayment record exists
      * CASE: LCL.Repay Record Exists is Yes
     C           YL0033    IFEQ 'Y'                        *IF
     C                     MOVEL'Y2U0003' YL0034           *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' YL0034           *Return code
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Documentation
      *================================================================
      * 12/2006   This function we have been told to allow the user to ha
      * at this time this function will only be used by a IS person
      * not to be turned over to a user at this time per Purva.
      * This function will take the Eval Trans Upl and if flagged as a Y
      * process, then change the Y to a N, once this is done then the
      * balance to kill should be run from the menu option
      * blance to kill by day.
      * 02/06/07 slm Have been asked to stream line this so the user
      *          can do this buy themselfs.  Per Vic,
      * 6/5/2008 AT THIS TIME WE ARE NOT GOING TO ALLOW THE USER TO RUN
      * THIS FUNCTION.
      * 021207 slm ReProcess the Eval Tran Upl
     C                     EXSR UCSUBR                     021207 slm RePr
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * 021207 slm ReProcess the Eval Tran Upl
      *================================================================
      * 2/05/2007 at this time we need to turn this over to the user
      * will use the following logic for what type of receiving
      * is being processed
      * Company Value will store the type of process for Receiving-slg
      * If Receiving is being reported as it happens this will be called
      * REALTIME  - At this time REALTIME will not be using this function
      * If Receiving is being reported AS a BATCH process then this will
      * BATCH
      * BATCH will have some cases where the hot scale rcrds
      * came up but the tattoo # was not found and the rcrd
      * was sent up was flagged as Invalid Tattoo Number,
      * and these records are flagged as P = Processed
      * The following process will unflag the Process
      * flagged records and make these records as UnProcessed
      * so that the user can run the "Run the Balance to Kill Again"
      * which will Rebalance this Tattoo number again.
      * This change will also change the Tattoo Header when
      * Completed, will flag the Tattoo Header as E, so that
      * the Payment Edit will error with Tattoo not balanced
      * Running the Balance to Kill report will rebalance all tattoos
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      *  6/16/2021 JBB SDD619 - Repayments by Business User
      *                P17058   Add a block of code to check if the Plant
      *                         is performing a repayment when option 11
      *                         to rebalance a tattoo is taken.
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      * E34858 JJH 07/24/18 - Valid Users for Opt 20=Reprocess EvalTranUp
      * - Recompile so that *USER PorkISTesting List condition is accepte
      *   to pick up ISJULIUSH.
      *       Also, for subfile option 7, add Company Number as primary
      * 7/19/2006 slm Add rules when the Pay with Historical Aver is allo
      *           at this time only when grade type is not = Meat
      * E9815 JBB  3/29/17  Recompiled for change to Producer History fil
      *       Restrict subfile option 15 by checking company values file
      *       for companies not excluded to Pay with Historical Average.
      *       Currently, only new company 961 will be excluded from optio
      *       Also, for subfile option 7, add Company Number as primary
      *       key to the call function.
      * E3635 JJH 12/03/14 Recomplied so that the Option 20 will allow
      *  all authorized users on the PorkISTesting List condition to
      *  run option.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDEQ037
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2LIST'  YPMTFD           TH Schedule Kil
     C                     END
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDEQ068
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2DWST'  YPMTFD           TH Kill Balanci
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * Pass return code back to repayment program
     C                     MOVELYL0034    W0RTN            *Return code
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1ETTX           PRT Description
     C                     MOVEL*BLANK    P1ACVN           PRT Printer Dev
     C                     MOVEL*BLANK    P1AKST           PRT Hold Output
     C                     MOVEL*BLANK    P1AMST           PRT Save Output
     C                     Z-ADD*ZERO     P1AKNB           PRT Copies
     C                     MOVEL*BLANK    P1ALST           PRT Night Queue
     C                     MOVEL*BLANK    P1AIVN           PRT Night Queue
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P2HONB           CC Company Numb
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field Display Print Prompt  Usr
     C                     MOVEL*BLANK    WUHJST  1
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field Error Type Found
     C                     MOVEL*BLANK    WUGYST  1
      * Define work field Error Type 6 Usr
     C                     MOVEL*BLANK    WUIIST  1
      * Define work field Error Type 7 Usr
     C                     MOVEL*BLANK    WUIJST  1
      * Define work field EV Description
     C                     MOVEL*BLANK    WUCBTX 25
      * Define work field EV Minimum
     C                     Z-ADD*ZERO     WUAFPC  71
      * Define work field EV Maximum
     C                     Z-ADD*ZERO     WUAGPC  71
      * Define work field EV Type
     C                     MOVEL*BLANK    WUFEST  1
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Requested by User to Bal
     C                     MOVEL*BLANK    WUG2ST  1
      * Define work field ET Tattoo Number
     C                     Z-ADD*ZERO     WUFINB  50
      * Define work field PD Name
     C                     MOVEL*BLANK    WUAGTX 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field ET Scale Sequence Number
     C                     Z-ADD*ZERO     WUFJNB  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WBA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WBFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WBHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WBGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WBFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WBLKNB           ET Lot
     C                     Z-ADD*ZERO     WBAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WBAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WBAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WBAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WBX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WBFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WBFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WBFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WBALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
     C                     Z-ADD*ZERO     WBB8DT           RU Date
     C                     Z-ADD*ZERO     WBAOTM           RU Time
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field HPERCVTYPE Alpha Usr
     C                     MOVEL*BLANK    YL0002 40
      * Define local work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Held Over Records Y/N
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Exclude Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field THC Comment Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Carcass Dbw Min
     C                     Z-ADD*ZERO     YL0007  71
      * Define local work field Carcass Dbw Max
     C                     Z-ADD*ZERO     YL0008  71
      * Define local work field Carcass Lgt Min
     C                     Z-ADD*ZERO     YL0009  71
      * Define local work field Carcass Lgt Max
     C                     Z-ADD*ZERO     YL0010  71
      * Define local work field %Lean High Min
     C                     Z-ADD*ZERO     YL0011  71
      * Define local work field %Lean High Max
     C                     Z-ADD*ZERO     YL0012  71
      * Define local work field %Lean Low Min
     C                     Z-ADD*ZERO     YL0013  71
      * Define local work field %Lean Low Max
     C                     Z-ADD*ZERO     YL0014  71
      * Define local work field High Yield Min
     C                     Z-ADD*ZERO     YL0015  71
      * Define local work field High Yield Max
     C                     Z-ADD*ZERO     YL0016  71
      * Define local work field Low Yield Min
     C                     Z-ADD*ZERO     YL0017  71
      * Define local work field Low Yield Max
     C                     Z-ADD*ZERO     YL0018  71
      * Define local work field Head < Percent Min
     C                     Z-ADD*ZERO     YL0019  71
      * Define local work field Head < Percent Max
     C                     Z-ADD*ZERO     YL0020  71
      * Define local work field Head > Percent Min
     C                     Z-ADD*ZERO     YL0021  71
      * Define local work field Head > Percent Max
     C                     Z-ADD*ZERO     YL0022  71
      * Define local work field BackFat High Min
     C                     Z-ADD*ZERO     YL0023  71
      * Define local work field BackFat High Max
     C                     Z-ADD*ZERO     YL0024  71
      * Define local work field BackFat Low Min
     C                     Z-ADD*ZERO     YL0025  71
      * Define local work field Backfat Low Max
     C                     Z-ADD*ZERO     YL0026  71
      * Define local work field LoinEye High Min
     C                     Z-ADD*ZERO     YL0027  71
      * Define local work field LoinEye High Max
     C                     Z-ADD*ZERO     YL0028  71
      * Define local work field LoinEye Low Min
     C                     Z-ADD*ZERO     YL0029  71
      * Define local work field LoinEye Low Max
     C                     Z-ADD*ZERO     YL0030  71
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Repay Record Exists
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0034  7
      * Define local work field BOH Payment Type
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0036  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0037  6
      * Define local work field GN Genetic Code
     C                     MOVEL*BLANK    YL0038  5
      * Define local work field PO Option Code
     C                     MOVEL*BLANK    YL0039  3
      * Define local work field CMP Program Code
     C                     MOVEL*BLANK    YL0040  3
      * Define local work field CMP Description
     C                     MOVEL*BLANK    YL0041 25
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field CMP Sort Basis
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    YL0044  2
      * Define local work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     YL0045  31
      * Define local work field CMP Lean Factor
     C                     Z-ADD*ZERO     YL0046  31
      * Define local work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field CMP Type
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     YL0049  52
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field PH Summary Type
     C                     MOVEL*BLANK    YL0051  3
      * Define local work field PH GA Avg Live Wgt
     C                     Z-ADD*ZERO     YL0052  51
      * Define local work field TH PHA Yield Percent
     C                     Z-ADD*ZERO     YL0053  52
      * Define local work field PH GA Avg Lean%
     C                     Z-ADD*ZERO     YL0054  31
      * Define local work field PH GA Avg Backfat
     C                     Z-ADD*ZERO     YL0055  31
      * Define local work field PH GA Avg Loin Eye
     C                     Z-ADD*ZERO     YL0056  31
      * Define local work field PH GA Avg Light Ref
     C                     Z-ADD*ZERO     YL0057  31
      * Define local work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YL0058  52
      * Define local work field PH GA Avg Srt Disc Fctr
     C                     Z-ADD*ZERO     YL0059  53
      * Define local work field History Avail STS USR
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field PH Week Ending Date
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field TH Purchase Date
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field TH Group Reference
     C                     MOVEL*BLANK    YL0064 10
      * Define local work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YL0065  2
      * Define local work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YL0066  52
      * Define local work field TH Live Gross Amt
     C                     Z-ADD*ZERO     YL0067  72
      * Define local work field TH LIve Net Amt
     C                     Z-ADD*ZERO     YL0068  72
      * Define local work field TH Resale UOM
     C                     MOVEL*BLANK    YL0069  2
      * Define local work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YL0070  52
      * Define local work field TH Pricing Date
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0073  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0074  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0075  50
      * Define local work field TH Held Over
     C                     Z-ADD*ZERO     YL0076  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0077  50
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0078  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0079  50
      * Define local work field TH Head Accepted
     C                     Z-ADD*ZERO     YL0080  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0081  71
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0082  71
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0083  71
      * Define local work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YL0084  61
      * Define local work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YL0085  61
      * Define local work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YL0086  61
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0087  51
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0088  51
      * Define local work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YL0089  31
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0090  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0091  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0092  31
      * Define local work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YL0093  52
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0094  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0095  52
      * Define local work field TH Yield Difference
     C                     Z-ADD*ZERO     YL0096  52
      * Define local work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YL0097  31
      * Define local work field TH CM Market Price
     C                     Z-ADD*ZERO     YL0098  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0099  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0100  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0101  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0102  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0103  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0104  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0105  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0106  72
      * Define local work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YL0107  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0108  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0109  72
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0110  72
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0111  72
      * Define local work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     YL0112  80
      * Define local work field TH Freight Amount
     C                     Z-ADD*ZERO     YL0113  72
      * Define local work field TH Accrual Amount
     C                     Z-ADD*ZERO     YL0114  72
      * Define local work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YL0115  72
      * Define local work field TH Calc Net Sts
     C                     MOVEL*BLANK    YL0116  1
      * Define local work field TH Payment Sts
     C                     MOVEL*BLANK    YL0117  2
      * Define local work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YL0118  80
      * Define local work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YL0119  70
      * Define local work field TH User Error Override
     C                     MOVEL*BLANK    YL0120  1
      * Define local work field TH Held Over Record
     C                     MOVEL*BLANK    YL0121  1
      * Define local work field TH Sex
     C                     MOVEL*BLANK    YL0122  1
      * Define local work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YL0123  70
      * Define local work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YL0124  70
      * Define local work field TH Actual Check Date
     C                     Z-ADD*ZERO     YL0125  70
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0126  71
      * Define local work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YL0127  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0128  31
      * Define local work field TH Kill Product Value
     C                     Z-ADD*ZERO     YL0129  72
      * Define local work field TH Cut Product Value
     C                     Z-ADD*ZERO     YL0130  72
      * Define local work field TH Render Product Value
     C                     Z-ADD*ZERO     YL0131  72
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0132  50
      * Define local work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YL0133  52
      * Define local work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     YL0134  52
      * Define local work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YL0135  52
      * Define local work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YL0136  52
      * Define local work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YL0137  52
      * Define local work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YL0138  52
      * Define local work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YL0139  52
      * Define local work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YL0140  52
      * Define local work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YL0141  52
      * Define local work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YL0142  52
      * Define local work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YL0143  52
      * Define local work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YL0144  52
      * Define local work field TH Source Type
     C                     MOVEL*BLANK    YL0145  1
      * Define local work field TH Scale Ticket Sts
     C                     MOVEL*BLANK    YL0146  1
      * Define local work field TH Payment Type
     C                     MOVEL*BLANK    YL0147  1
      * Define local work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     YL0148  70
      * Define local work field TH Source Code
     C                     MOVEL*BLANK    YL0149  3
      * Define local work field TH Hog Class Type
     C                     MOVEL*BLANK    YL0150  1
      * Define local work field TH Posted to HPS Flag
     C                     MOVEL*BLANK    YL0151  1
      * Define local work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YL0152  1
      * Define local work field TH Shift Held Over
     C                     MOVEL*BLANK    YL0153  1
      * Define local work field DF Defect Code
     C                     MOVEL*BLANK    YL0154  6
      * Define local work field THP Process Code
     C                     MOVEL*BLANK    YL0155  6
      * Define local work field HB Buyer Code
     C                     MOVEL*BLANK    YL0156  3
      * Define local work field HC Class Code
     C                     MOVEL*BLANK    YL0157  3
      * Define local work field RS User Changed
     C                     MOVEL*BLANK    YL0158 10
      * Define local work field RS Date Changed
     C                     Z-ADD*ZERO     YL0159  70
      * Define local work field RS Time Changed
     C                     Z-ADD*ZERO     YL0160  60
      * Define local work field RS Job
     C                     MOVEL*BLANK    YL0161 10
      * Define local work field RS Program
     C                     MOVEL*BLANK    YL0162 10
      * Define local work field RS User Added
     C                     MOVEL*BLANK    YL0163 10
      * Define local work field RS Date Added
     C                     Z-ADD*ZERO     YL0164  70
      * Define local work field RS Time Added
     C                     Z-ADD*ZERO     YL0165  60
      * Define local work field PH GA Adjusted Yield%
     C                     Z-ADD*ZERO     YL0166  52
      * Define local work field PH GA Lean Prm /Carc CWT
     C                     Z-ADD*ZERO     YL0167  52
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0168  1
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0169  50
      * Define local work field Transfer Carcasses    USR
     C                     Z-ADD*ZERO     YL0170  50
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0171  70
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0172  70
      * Define local work field Balance First Day USR
     C                     MOVEL*BLANK    YL0173  1
      * Define local work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YL0174  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD04        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UDSUBR                     Modifications a
      * HPE073
      * NEW Balance to Kill Report
      *   PKDUDTR -- WW Bal to kill
      *   PKGMPFR -- Prt Report
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P2J8NB    PARM *BLANK    WQ0501  3        Oms Warehouse C
     C           WUHONB    PARM *ZERO     WQ0502  30       CC Company Numb
     C                     PARM 'HPE'     WQ0503  6        Oms Application
     C           P2C8CD    PARM *BLANK    WQ0504  3        Oms SalesPerson
     C           P2G8ST    PARM *BLANK    WQ0505  1        Oms Allow Multi
     C           P2G9ST    PARM *BLANK    WQ0506 10        Oms Default Pri
     C           P2EUTX    PARM *BLANK    WQ0507 30        Oms Name
     C           P2EVTX    PARM *BLANK    WQ0508 40        Oms System Valu
     C           P2HAST    PARM *BLANK    WQ0509  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     END                             *FI
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR TBRVGN
     C                     MOVEL'N'       YL0004           Held Over Recor
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 HPERCVBTH
00002 Print Balance to Kill
00003 XCOPAYHIST
00004 PRKTEST
00005 ISPPATE
00006 PAYMNT
00007 Y2U0005
00008 ISSMASO
00009 ISRCENT
00010 ISPURVAP
00011 ISROSEM
00012 ISSHARONZ
00013 ISSZURN
00014 ISJHIGH
00015 ISJBADE
00016 ISJAMESB
00017 ISDNGUY
00018 ISDANNYN
00019 PRKTESTGU
00020 PRKTESTST
00021 PRKTESTTF
00022 TPMTEST
00023 TFTST961
00024 ISSUSANM
00025 ISJULIUSH
00026 ISBGUTI
00027 ISBARBG
00028 ISBBARK
00029 ISNFOY
00030 ISNATHANF
00031 ISDREDD
00032 REALTIME
