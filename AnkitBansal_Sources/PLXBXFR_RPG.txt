     H/TITLE Rtv PRD Serv RcdsCrtBOXF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:38:23
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLBJCPL5IF  E           K        DISK
      * RSQ : Delivery Sched Detail UPL Rtv UnProc/CrtBOL
      *
     FPLAECPL3IF  E           K        DISK
      * RSQ : Delivery Sched Detail     Movement #
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKAXCPL3IF  E           K        DISK
      * RSQ : Buy Order Load            Co/BO/Line(d)
      *
     FPWACCPL1IF  E           K        DISK
      * RTV : Buy Order Load Reference  Retrieval index
      *
     FPLAECPLBIF  E           K        DISK
      * RSQ : Delivery Sched Detail     Co/KDt/DDt/DTm/Sq-d
      *
     FPLAGCPL1IF  E           K        DISK
      * RTV : Delivery Sched Split      Retrieval index
      *
     FPLBJCPL0UF  E           K        DISK
      * UPD : Delivery Sched Detail UPL Update index
      *
     FPKAXCPL1IF  E           K        DISK                      A
      * UPD : Buy Order Load            Update index
      *
     FPWACCPL0UF  E           K        DISK                      A
      * UPD : Buy Order Load Reference  Update index
      *
     FPLAGCPL0UF  E           K        DISK
      * UPD : Delivery Sched Split      Update index
      *
     FPLAECPL1IF  E           K        DISK                      A
      * UPD : Delivery Sched Detail     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     IXBJCPU8
      * Delivery Sched Detail UPL Rtv UnProc/CrtBOL
      * Renamed input format fields
     I              BJTFA1                          WATFA1
     I              BJAADX                          WAAADX
     I              BJTGA1                          WATGA1
     I              BJTHA1                          WATHA1
     I              BJTPA1                          WATPA1
     I              BJGXDT                          WAGXDT
     I              BJGTDT                          WAGTDT
     I              BJB8TH                          WAB8TH
     I              BJTKA1                          WATKA1
     I              BJPJCD                          WAPJCD
     I              BJPKCD                          WAPKCD
     I              BJPLCD                          WAPLCD
     I              BJPMCD                          WAPMCD
     I              BJTMA1                          WATMA1
     I              BJPQCD                          WAPQCD
     I              BJPPCD                          WAPPCD
     I              BJPNCD                          WAPNCD
     I              BJPOCD                          WAPOCD
     I              BJPRCD                          WAPRCD
     I              BJPSCD                          WAPSCD
     I              BJE4SS                          WAE4SS
     I              BJTOA1                          WATOA1
     I              BJPTCD                          WAPTCD
     I              BJPUCD                          WAPUCD
     I              BJE6SS                          WAE6SS
     I              BJGWDT                          WAGWDT
     I              BJCATH                          WACATH
     I              BJGUDT                          WAGUDT
     I              BJB9TH                          WAB9TH
     I              BJGVDT                          WAGVDT
     I              BJCBTH                          WACBTH
     I              BJABCD                          WAABCD
     I              BJAECD                          WAAECD
     I              BJHMNB                          WAHMNB
     I              BJBNNB                          WABNNB
     I              BJBONB                          WABONB
     I              BJYYA1                          WAYYA1
     I              BJYZA1                          WAYZA1
     I              BJDET1                          WADET1
     I              BJDFT1                          WADFT1
     I              BJIHSS                          WAIHSS
     I              BJFFSS                          WAFFSS
     I              BJFGSS                          WAFGSS
     I              BJFHSS                          WAFHSS
     I              BJPVCD                          WAPVCD
     I              BJPWCD                          WAPWCD
      *
     I@AECPJB
      * Delivery Sched Detail     Movement #
      * Renamed input format fields
     I              AEHONB                          WBHONB
     I              AEE0DT                          WBE0DT
     I              AEE6DT                          WBE6DT
     I              AEAGTH                          WBAGTH
     I              AEHZA1                          WBHZA1
     I              AEH0A1                          WBH0A1
     I              AEH1A1                          WBH1A1
     I              AEJ4CD                          WBJ4CD
     I              AEJ5CD                          WBJ5CD
     I              AELBCD                          WBLBCD
     I              AELCCD                          WBLCCD
     I              AEIOA1                          WBIOA1
     I              AEH2A1                          WBH2A1
     I              AEIJA1                          WBIJA1
     I              AEK9CD                          WBK9CD
     I              AEK8CD                          WBK8CD
     I              AEJ6CD                          WBJ6CD
     I              AEJ7CD                          WBJ7CD
     I              AEMGCD                          WBMGCD
     I              AEW1ST                          WBW1ST
     I              AEW2ST                          WBW2ST
     I              AEH3A1                          WBH3A1
     I              AEMECD                          WBMECD
     I              AEMFCD                          WBMFCD
     I              AEW4ST                          WBW4ST
     I              AEXWST                          WBXWST
     I              AEFRDT                          WBFRDT
     I              AEBOTH                          WBBOTH
     I              AEE7DT                          WBE7DT
     I              AEAHTH                          WBAHTH
     I              AEE8DT                          WBE8DT
     I              AEAITH                          WBAITH
     I              AEXBST                          WBXBST
     I              AEXGST                          WBXGST
     I              AEXPST                          WBXPST
     I              AEXNST                          WBXNST
     I              AEXTST                          WBXTST
     I              AEXLST                          WBXLST
     I              AEW0ST                          WBW0ST
     I              AEYEST                          WBYEST
     I              AEFZDT                          WBFZDT
     I              AEB1TH                          WBB1TH
     I              AEAACD                          WBAACD
     I              AEABCD                          WBABCD
     I              AEAECD                          WBAECD
     I              AEHMNB                          WBHMNB
     I              AEBNNB                          WBBNNB
     I              AEBONB                          WBBONB
     I              AEY0A1                          WBY0A1
     I              AEY1A1                          WBY1A1
     I              AEDGT1                          WBDGT1
     I              AEDHT1                          WBDHT1
     I              AEIISS                          WBIISS
     I              AEAAVN                          WBAAVN
     I              AEAADT                          WBAADT
     I              AEAMTM                          WBAMTM
     I              AEAJST                          WBAJST
     I              AEAHVN                          WBAHVN
     I              AEAGVN                          WBAGVN
     I              AEABVN                          WBABVN
     I              AEABDT                          WBABDT
     I              AEABTM                          WBABTM
      *
     I@BJCPRJ
      * Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WCTFA1
     I              BJAADX                          WCAADX
     I              BJTGA1                          WCTGA1
     I              BJTHA1                          WCTHA1
     I              BJTPA1                          WCTPA1
     I              BJGXDT                          WCGXDT
     I              BJGTDT                          WCGTDT
     I              BJB8TH                          WCB8TH
     I              BJTKA1                          WCTKA1
     I              BJPJCD                          WCPJCD
     I              BJPKCD                          WCPKCD
     I              BJPLCD                          WCPLCD
     I              BJPMCD                          WCPMCD
     I              BJTMA1                          WCTMA1
     I              BJPQCD                          WCPQCD
     I              BJPPCD                          WCPPCD
     I              BJPNCD                          WCPNCD
     I              BJPOCD                          WCPOCD
     I              BJPRCD                          WCPRCD
     I              BJPSCD                          WCPSCD
     I              BJE4SS                          WCE4SS
     I              BJTOA1                          WCTOA1
     I              BJPTCD                          WCPTCD
     I              BJPUCD                          WCPUCD
     I              BJE6SS                          WCE6SS
     I              BJGWDT                          WCGWDT
     I              BJCATH                          WCCATH
     I              BJGUDT                          WCGUDT
     I              BJB9TH                          WCB9TH
     I              BJGVDT                          WCGVDT
     I              BJCBTH                          WCCBTH
     I              BJABCD                          WCABCD
     I              BJAECD                          WCAECD
     I              BJHMNB                          WCHMNB
     I              BJBNNB                          WCBNNB
     I              BJBONB                          WCBONB
     I              BJYYA1                          WCYYA1
     I              BJYZA1                          WCYZA1
     I              BJDET1                          WCDET1
     I              BJDFT1                          WCDFT1
     I              BJIHSS                          WCIHSS
     I              BJFFSS                          WCFFSS
     I              BJFGSS                          WCFGSS
     I              BJFHSS                          WCFHSS
     I              BJPVCD                          WCPVCD
     I              BJPWCD                          WCPWCD
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WDABCD
     I              ACAGTX                          WDAGTX
     I              ACALNB                          WDALNB
     I              ACAATH                          WDAATH
     I              ACAMNB                          WDAMNB
     I              ACIWST                          WDIWST
     I              ACAPST                          WDAPST
     I              ACGCNB                          WDGCNB
     I              ACGJNB                          WDGJNB
     I              ACC2TX                          WDC2TX
     I              ACAACD                          WDAACD
     I              ACACCD                          WDACCD
     I              ACADCD                          WDADCD
     I              ACAAVN                          WDAAVN
     I              ACAADT                          WDAADT
     I              ACAMTM                          WDAMTM
     I              ACAJST                          WDAJST
     I              ACAHVN                          WDAHVN
     I              ACAGVN                          WDAGVN
     I              ACABVN                          WDABVN
     I              ACABDT                          WDABDT
     I              ACABTM                          WDABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WEAACD
     I              AAAFTX                          WEAFTX
     I              AAIXST                          WEIXST
     I              AACYSS                          WECYSS
     I              AACZSS                          WECZSS
     I              AAC0SS                          WEC0SS
     I              AAC1SS                          WEC1SS
     I              AAAAVN                          WEAAVN
     I              AAAADT                          WEAADT
     I              AAAMTM                          WEAMTM
     I              AAAJST                          WEAJST
     I              AAAHVN                          WEAHVN
     I              AAAGVN                          WEAGVN
     I              AAABVN                          WEABVN
     I              AAABDT                          WEABDT
     I              AAABTM                          WEABTM
      *
     I@AXCPCY
      * Buy Order Load            Co/BO/Line(d)
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WGHMNB
     I              AXBNNB                          WGBNNB
     I              AXBONB                          WGBONB
     I              AXCQDT                          WGCQDT
     I              AXABTH                          WGABTH
     I              AXACTH                          WGACTH
     I              AXBPNB                          WGBPNB
     I              AXCSNB                          WGCSNB
     I              AXAUDT                          WGAUDT
     I              AXCMST                          WGCMST
     I              AXAGPR                          WGAGPR
     I              AXATVA                          WGATVA
     I              AXI1ST                          WGI1ST
     I              AXDHNB                          WGDHNB
     I              AXDINB                          WGDINB
     I              AXCNST                          WGCNST
     I              AXGINB                          WGGINB
     I              AXBZDT                          WGBZDT
     I              AXLSNB                          WGLSNB
     I              AXF3TX                          WGF3TX
     I              AXO8ST                          WGO8ST
     I              AXO9ST                          WGO9ST
     I              AXPAST                          WGPAST
     I              AXLDSH                          WGLDSH
     I              AXPBST                          WGPBST
     I              AXPCST                          WGPCST
     I              AXPDST                          WGPDST
     I              AXUWST                          WGUWST
     I              AXUXST                          WGUXST
     I              AXUYST                          WGUYST
     I              AXJKRU                          WGJKRU
     I              AXKEOR                          WGKEOR
     I              AXIOEW                          WGIOEW
     I              AXKJIO                          WGKJIO
     I              AXIOJR                          WGIOJR
     I              AXEIRR                          WGEIRR
     I              AXITMF                          WGITMF
     I              AXODJE                          WGODJE
     I              AXRJIF                          WGRJIF
     I              AXOEJF                          WGOEJF
     I              AXD0DT                          WGD0DT
     I              AXD1DT                          WGD1DT
     I              AXD2DT                          WGD2DT
     I              AXD3DT                          WGD3DT
     I              AXD4DT                          WGD4DT
     I              AXBNCD                          WGBNCD
     I              AXABCD                          WGABCD
     I              AXAECD                          WGAECD
     I              AXAAVN                          WGAAVN
     I              AXAADT                          WGAADT
     I              AXAMTM                          WGAMTM
     I              AXAJST                          WGAJST
     I              AXAHVN                          WGAHVN
     I              AXAGVN                          WGAGVN
     I              AXABVN                          WGABVN
     I              AXABDT                          WGABDT
     I              AXABTM                          WGABTM
      *
     I@ACCPW8
      * Buy Order Load Reference  Retrieval index
      * Renamed input format fields
     I              ACHMNB                          WHHMNB
     I              ACBNNB                          WHBNNB
     I              ACBONB                          WHBONB
     I              ACDIT1                          WHDIT1
     I              ACDJT1                          WHDJT1
     I              ACIJSS                          WHIJSS
     I              ACAAVN                          WHAAVN
     I              ACAADT                          WHAADT
     I              ACAMTM                          WHAMTM
     I              ACAJST                          WHAJST
     I              ACAHVN                          WHAHVN
     I              ACAGVN                          WHAGVN
     I              ACABVN                          WHABVN
     I              ACABDT                          WHABDT
     I              ACABTM                          WHABTM
      *
     I@ACCPW7
      * Buy Order Load Reference  Update index
      * Renamed input format fields
     I              ACHMNB                          WIHMNB
     I              ACBNNB                          WIBNNB
     I              ACBONB                          WIBONB
     I              ACDIT1                          WIDIT1
     I              ACDJT1                          WIDJT1
     I              ACIJSS                          WIIJSS
     I              ACAAVN                          WIAAVN
     I              ACAADT                          WIAADT
     I              ACAMTM                          WIAMTM
     I              ACAJST                          WIAJST
     I              ACAHVN                          WIAHVN
     I              ACAGVN                          WIAGVN
     I              ACABVN                          WIABVN
     I              ACABDT                          WIABDT
     I              ACABTM                          WIABTM
      *
     I@AECPJT
      * Delivery Sched Detail     Co/KDt/DDt/DTm/Sq-d
      * Renamed input format fields
     I              AEHONB                          WJHONB
     I              AEE0DT                          WJE0DT
     I              AEE6DT                          WJE6DT
     I              AEAGTH                          WJAGTH
     I              AEHZA1                          WJHZA1
     I              AEH0A1                          WJH0A1
     I              AEH1A1                          WJH1A1
     I              AEJ4CD                          WJJ4CD
     I              AEJ5CD                          WJJ5CD
     I              AELBCD                          WJLBCD
     I              AELCCD                          WJLCCD
     I              AEIOA1                          WJIOA1
     I              AEH2A1                          WJH2A1
     I              AEIJA1                          WJIJA1
     I              AEK9CD                          WJK9CD
     I              AEK8CD                          WJK8CD
     I              AEJ6CD                          WJJ6CD
     I              AEJ7CD                          WJJ7CD
     I              AEMGCD                          WJMGCD
     I              AEW1ST                          WJW1ST
     I              AEW2ST                          WJW2ST
     I              AEH3A1                          WJH3A1
     I              AEMECD                          WJMECD
     I              AEMFCD                          WJMFCD
     I              AEW4ST                          WJW4ST
     I              AEXWST                          WJXWST
     I              AEFRDT                          WJFRDT
     I              AEBOTH                          WJBOTH
     I              AEE7DT                          WJE7DT
     I              AEAHTH                          WJAHTH
     I              AEE8DT                          WJE8DT
     I              AEAITH                          WJAITH
     I              AEXBST                          WJXBST
     I              AEXGST                          WJXGST
     I              AEXPST                          WJXPST
     I              AEXNST                          WJXNST
     I              AEXTST                          WJXTST
     I              AEXLST                          WJXLST
     I              AEW0ST                          WJW0ST
     I              AEYEST                          WJYEST
     I              AEFZDT                          WJFZDT
     I              AEB1TH                          WJB1TH
     I              AEAACD                          WJAACD
     I              AEABCD                          WJABCD
     I              AEAECD                          WJAECD
     I              AEHMNB                          WJHMNB
     I              AEBNNB                          WJBNNB
     I              AEBONB                          WJBONB
     I              AEY0A1                          WJY0A1
     I              AEY1A1                          WJY1A1
     I              AEDGT1                          WJDGT1
     I              AEDHT1                          WJDHT1
     I              AEIISS                          WJIISS
     I              AEAAVN                          WJAAVN
     I              AEAADT                          WJAADT
     I              AEAMTM                          WJAMTM
     I              AEAJST                          WJAJST
     I              AEAHVN                          WJAHVN
     I              AEAGVN                          WJAGVN
     I              AEABVN                          WJABVN
     I              AEABDT                          WJABDT
     I              AEABTM                          WJABTM
      *
     I@AGCPIM
      * Delivery Sched Split      Retrieval index
      * Renamed input format fields
     I              AGHONB                          WKHONB
     I              AGE0DT                          WKE0DT
     I              AGE6DT                          WKE6DT
     I              AGAGTH                          WKAGTH
     I              AGHZA1                          WKHZA1
     I              AGH5A1                          WKH5A1
     I              AGKNCD                          WKKNCD
     I              AGKOCD                          WKKOCD
     I              AGLDCD                          WKLDCD
     I              AGLECD                          WKLECD
     I              AGH6A1                          WKH6A1
     I              AGAAVN                          WKAAVN
     I              AGAADT                          WKAADT
     I              AGAMTM                          WKAMTM
     I              AGAJST                          WKAJST
     I              AGAHVN                          WKAHVN
     I              AGAGVN                          WKAGVN
     I              AGABVN                          WKABVN
     I              AGABDT                          WKABDT
     I              AGABTM                          WKABTM
      *
     I@AGCPIL
      * Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WLHONB
     I              AGE0DT                          WLE0DT
     I              AGE6DT                          WLE6DT
     I              AGAGTH                          WLAGTH
     I              AGHZA1                          WLHZA1
     I              AGH5A1                          WLH5A1
     I              AGKNCD                          WLKNCD
     I              AGKOCD                          WLKOCD
     I              AGLDCD                          WLLDCD
     I              AGLECD                          WLLECD
     I              AGH6A1                          WLH6A1
     I              AGAAVN                          WLAAVN
     I              AGAADT                          WLAADT
     I              AGAMTM                          WLAMTM
     I              AGAJST                          WLAJST
     I              AGAHVN                          WLAHVN
     I              AGAGVN                          WLAGVN
     I              AGABVN                          WLABVN
     I              AGABDT                          WLABDT
     I              AGABTM                          WLABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEY0A1                          WMY0A1
     I              AEY1A1                          WMY1A1
     I              AEDGT1                          WMDGT1
     I              AEDHT1                          WMDHT1
     I              AEIISS                          WMIISS
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLBJ1    E DSPLBJCPL0
      * UPD : Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WCTFA1
     I              BJAADX                          WCAADX
     I              BJTGA1                          WCTGA1
     I              BJTHA1                          WCTHA1
     I              BJTPA1                          WCTPA1
     I              BJGXDT                          WCGXDT
     I              BJGTDT                          WCGTDT
     I              BJB8TH                          WCB8TH
     I              BJTKA1                          WCTKA1
     I              BJPJCD                          WCPJCD
     I              BJPKCD                          WCPKCD
     I              BJPLCD                          WCPLCD
     I              BJPMCD                          WCPMCD
     I              BJTMA1                          WCTMA1
     I              BJPQCD                          WCPQCD
     I              BJPPCD                          WCPPCD
     I              BJPNCD                          WCPNCD
     I              BJPOCD                          WCPOCD
     I              BJPRCD                          WCPRCD
     I              BJPSCD                          WCPSCD
     I              BJE4SS                          WCE4SS
     I              BJTOA1                          WCTOA1
     I              BJPTCD                          WCPTCD
     I              BJPUCD                          WCPUCD
     I              BJE6SS                          WCE6SS
     I              BJGWDT                          WCGWDT
     I              BJCATH                          WCCATH
     I              BJGUDT                          WCGUDT
     I              BJB9TH                          WCB9TH
     I              BJGVDT                          WCGVDT
     I              BJCBTH                          WCCBTH
     I              BJABCD                          WCABCD
     I              BJAECD                          WCAECD
     I              BJHMNB                          WCHMNB
     I              BJBNNB                          WCBNNB
     I              BJBONB                          WCBONB
     I              BJYYA1                          WCYYA1
     I              BJYZA1                          WCYZA1
     I              BJDET1                          WCDET1
     I              BJDFT1                          WCDFT1
     I              BJIHSS                          WCIHSS
     I              BJFFSS                          WCFFSS
     I              BJFGSS                          WCFGSS
     I              BJFHSS                          WCFHSS
     I              BJPVCD                          WCPVCD
     I              BJPWCD                          WCPWCD
      *
     IYARDCS      DS                            223
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WGHMNB
     I              AXBNNB                          WGBNNB
     I              AXBONB                          WGBONB
     I              AXCQDT                          WGCQDT
     I              AXABTH                          WGABTH
     I              AXACTH                          WGACTH
     I              AXBPNB                          WGBPNB
     I              AXCSNB                          WGCSNB
     I              AXAUDT                          WGAUDT
     I              AXCMST                          WGCMST
     I              AXAGPR                          WGAGPR
     I              AXATVA                          WGATVA
     I              AXI1ST                          WGI1ST
     I              AXDHNB                          WGDHNB
     I              AXDINB                          WGDINB
     I              AXCNST                          WGCNST
     I              AXGINB                          WGGINB
     I              AXBZDT                          WGBZDT
     I              AXLSNB                          WGLSNB
     I              AXF3TX                          WGF3TX
     I              AXO8ST                          WGO8ST
     I              AXO9ST                          WGO9ST
     I              AXPAST                          WGPAST
     I              AXLDSH                          WGLDSH
     I              AXPBST                          WGPBST
     I              AXPCST                          WGPCST
     I              AXPDST                          WGPDST
     I              AXUWST                          WGUWST
     I              AXUXST                          WGUXST
     I              AXUYST                          WGUYST
     I              AXJKRU                          WGJKRU
     I              AXKEOR                          WGKEOR
     I              AXIOEW                          WGIOEW
     I              AXKJIO                          WGKJIO
     I              AXIOJR                          WGIOJR
     I              AXEIRR                          WGEIRR
     I              AXITMF                          WGITMF
     I              AXODJE                          WGODJE
     I              AXRJIF                          WGRJIF
     I              AXOEJF                          WGOEJF
     I              AXD0DT                          WGD0DT
     I              AXD1DT                          WGD1DT
     I              AXD2DT                          WGD2DT
     I              AXD3DT                          WGD3DT
     I              AXD4DT                          WGD4DT
     I              AXBNCD                          WGBNCD
     I              AXABCD                          WGABCD
     I              AXAECD                          WGAECD
     I              AXAAVN                          WGAAVN
     I              AXAADT                          WGAADT
     I              AXAMTM                          WGAMTM
     I              AXAJST                          WGAJST
     I              AXAHVN                          WGAHVN
     I              AXAGVN                          WGAGVN
     I              AXABVN                          WGABVN
     I              AXABDT                          WGABDT
     I              AXABTM                          WGABTM
      *
     IQPWAC1    E DSPWACCPL0
      * UPD : Buy Order Load Reference  Update index
      * Renamed input format fields
     I              ACHMNB                          WIHMNB
     I              ACBNNB                          WIBNNB
     I              ACBONB                          WIBONB
     I              ACDIT1                          WIDIT1
     I              ACDJT1                          WIDJT1
     I              ACIJSS                          WIIJSS
     I              ACAAVN                          WIAAVN
     I              ACAADT                          WIAADT
     I              ACAMTM                          WIAMTM
     I              ACAJST                          WIAJST
     I              ACAHVN                          WIAHVN
     I              ACAGVN                          WIAGVN
     I              ACABVN                          WIABVN
     I              ACABDT                          WIABDT
     I              ACABTM                          WIABTM
      *
     IYBRDCS      DS                             88
     IQPLAG1    E DSPLAGCPL0
      * UPD : Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WLHONB
     I              AGE0DT                          WLE0DT
     I              AGE6DT                          WLE6DT
     I              AGAGTH                          WLAGTH
     I              AGHZA1                          WLHZA1
     I              AGH5A1                          WLH5A1
     I              AGKNCD                          WLKNCD
     I              AGKOCD                          WLKOCD
     I              AGLDCD                          WLLDCD
     I              AGLECD                          WLLECD
     I              AGH6A1                          WLH6A1
     I              AGAAVN                          WLAAVN
     I              AGAADT                          WLAADT
     I              AGAMTM                          WLAMTM
     I              AGAJST                          WLAJST
     I              AGAHVN                          WLAHVN
     I              AGAGVN                          WLAGVN
     I              AGABVN                          WLABVN
     I              AGABDT                          WLABDT
     I              AGABTM                          WLABTM
      *
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WMHONB
     I              AEE0DT                          WME0DT
     I              AEE6DT                          WME6DT
     I              AEAGTH                          WMAGTH
     I              AEHZA1                          WMHZA1
     I              AEH0A1                          WMH0A1
     I              AEH1A1                          WMH1A1
     I              AEJ4CD                          WMJ4CD
     I              AEJ5CD                          WMJ5CD
     I              AELBCD                          WMLBCD
     I              AELCCD                          WMLCCD
     I              AEIOA1                          WMIOA1
     I              AEH2A1                          WMH2A1
     I              AEIJA1                          WMIJA1
     I              AEK9CD                          WMK9CD
     I              AEK8CD                          WMK8CD
     I              AEJ6CD                          WMJ6CD
     I              AEJ7CD                          WMJ7CD
     I              AEMGCD                          WMMGCD
     I              AEW1ST                          WMW1ST
     I              AEW2ST                          WMW2ST
     I              AEH3A1                          WMH3A1
     I              AEMECD                          WMMECD
     I              AEMFCD                          WMMFCD
     I              AEW4ST                          WMW4ST
     I              AEXWST                          WMXWST
     I              AEFRDT                          WMFRDT
     I              AEBOTH                          WMBOTH
     I              AEE7DT                          WME7DT
     I              AEAHTH                          WMAHTH
     I              AEE8DT                          WME8DT
     I              AEAITH                          WMAITH
     I              AEXBST                          WMXBST
     I              AEXGST                          WMXGST
     I              AEXPST                          WMXPST
     I              AEXNST                          WMXNST
     I              AEXTST                          WMXTST
     I              AEXLST                          WMXLST
     I              AEW0ST                          WMW0ST
     I              AEYEST                          WMYEST
     I              AEFZDT                          WMFZDT
     I              AEB1TH                          WMB1TH
     I              AEAACD                          WMAACD
     I              AEABCD                          WMABCD
     I              AEAECD                          WMAECD
     I              AEHMNB                          WMHMNB
     I              AEBNNB                          WMBNNB
     I              AEBONB                          WMBONB
     I              AEY0A1                          WMY0A1
     I              AEY1A1                          WMY1A1
     I              AEDGT1                          WMDGT1
     I              AEDHT1                          WMDHT1
     I              AEIISS                          WMIISS
     I              AEAAVN                          WMAAVN
     I              AEAADT                          WMAADT
     I              AEAMTM                          WMAMTM
     I              AEAJST                          WMAJST
     I              AEAHVN                          WMAHVN
     I              AEAGVN                          WMAGVN
     I              AEABVN                          WMABVN
     I              AEABDT                          WMABDT
     I              AEABTM                          WMABTM
      *
     IYCRDCS      DS                            223
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Delivery Sched Detail UPL
      * I : MAP DSU Company Number
     I                                        1   30P1TFA1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TFA1    PARM           WP0001  30       DSU Company Num
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv PRD Serv RcdsCrtBOXF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Rtv PRD Serv RcdsCrtBORT - Delivery Sched Detail UPL  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PRD Serv RcdsCrtBORT - Delivery Sched Detail UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * C9426 032217 slm
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WATFA1    WQSA01           DSU Company Num
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           DSU Company Num
      * Setup key
     C                     Z-ADDP1TFA1    WQSA01           DSU Company Num
      * Establish starting position
     C           KRSSA     SETLLXBJCPU8                    *
     C           KRSSA     READEXBJCPU8                  90*
      * Data record not found
     C   90                MOVEL'PRK1275' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWAFHSS    WUFHSS           DSU Error Reaso
      * Rtv Record By MovementRT - Delivery Sched Detail  * 
     C                     EXSR SBRVGN
      * Validate on Add, 11/3/2017 will now be add only
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * ADD record should not be found
      * CASE: DB1.DSU Record Status is Add
     C           WAFFSS    IFEQ 'A'                        *IF
     C                     Z-ADD2         WUFGSS           DSU Process Sta
     C                     MOVEL'ADDDRF'  WUFHSS           DSU Error Reaso
      * Crt DlvSchDtlUpl ErrorXP - Delivery Sched Detail Err  * 
     C                     CALL 'PLSHXFR'              90  Crt DlvSchDtlUp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATFA1    WQ0004  30       DSU Company Num
     C                     PARM WAAADX    WQ0005  70       DSU Transaction
     C                     PARM WATGA1    WQ0006  60       DSU Transaction
     C                     PARM WATHA1    WQ0007  50       DSU Transaction
     C                     PARM WUFHSS    WQ0008  6        DSE Error Code
     C                     PARM 'TEST1'   WQ0009 60        DSE Line Commen
     C                     PARM ##JOB     WQ0010 10        RS Job
     C                     PARM ##PGM     WQ0011 10        RS Program
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLSHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *  5/08/18 JBB E31600 - Stop reprocessing UPL records when error
      *                       Update UPL Process Status and Error Reason
      * Chg Process/Error     CH - Delivery Sched Detail UPL  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.DSU Error Reason is No Error
     C           WUFHSS    IFEQ *BLANK                     *IF
      * Break Logic Check
     C                     EXSR UCSUBR                     Break Logic Che
      * Update process
      * Detail Records
     C                     EXSR UDSUBR                     Detail Records
     C                     END                             *FI
     C           KRSSA     READEXBJCPU8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Record By MovementRT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSB01           CC Company Numb
     C           *LIKE     DEFN WBH3A1    WQSB02           DSD Movement Nu
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           CC Company Numb
     C                     KFLD           WQSB02           DSD Movement Nu
      * Setup key
     C                     Z-ADDWATFA1    WQSB01           CC Company Numb
     C                     Z-ADDWATOA1    WQSB02           DSD Movement Nu
      * Establish starting position
     C           KRSSB     SETLL@AECPJB                    *
     C           KRSSB     READE@AECPJB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGXDT           DSH Kill Date
     C                     Z-ADD*ZERO     WUGTDT           DSD Delivery Da
     C                     Z-ADD*ZERO     WUB8TH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WUHZA1           DSD Delivery Ti
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    WUABCD           PD Producer Cod
     C                     Z-ADD*ZERO     WUHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WUBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WUBONB           BOL Load Number
     C                     MOVEL*BLANK    WUH7ST           Record Found US
     C                     MOVEL'N'       WUH7ST           Record Found US
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBE0DT    WUGXDT           DSH Kill Date
     C                     Z-ADDWBE6DT    WUGTDT           DSD Delivery Da
     C                     Z-ADDWBAGTH    WUB8TH           DSD Delivery Ti
     C                     Z-ADDWBHZA1    WUHZA1           DSD Delivery Ti
     C                     MOVELWBAACD    WUAACD           SR Source Code
     C                     MOVELWBABCD    WUABCD           PD Producer Cod
     C                     Z-ADDWBHMNB    WUHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WUBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WUBONB           BOL Load Number
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@AECPJB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Process/Error     CH - Delivery Sched Detail UPL  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       DSU Split Seque
     C                     Z-ADD*ZERO     WN0002  70       DSU Kill Date
     C                     Z-ADD*ZERO     WN0003  70       DSU Delivery Da
     C                     Z-ADD*ZERO     WN0004  40       DSU Delivery Ti
     C                     Z-ADD*ZERO     WN0005  50       DSU Farm Site C
     C                     MOVEL*BLANK    WN0006  5        DSU Building
     C                     MOVEL*BLANK    WN0007  5        DSU Room
     C                     MOVEL*BLANK    WN0008  5        DSU Sire Line C
     C                     MOVEL*BLANK    WN0009  7        DSU Hog Group C
     C                     Z-ADD*ZERO     WN0010  30       DSU Scheduled D
     C                     MOVEL*BLANK    WN0011  5        UnUsed Status 5
     C                     MOVEL*BLANK    WN0012  5        UnUsed Code 5
     C                     MOVEL*BLANK    WN0013  5        DSU Driver
     C                     MOVEL*BLANK    WN0014  5        DSU Loading Cre
     C                     MOVEL*BLANK    WN0015  6        DSU Hauler Reas
     C                     MOVEL*BLANK    WN0016  2        DSU Load Type
     C                     MOVEL*BLANK    WN0017  1        DSU Full/Split
     C                     Z-ADD*ZERO     WN0018  70       DSU Movement Nu
     C                     MOVEL*BLANK    WN0019 15        DSU Truck ID
     C                     MOVEL*BLANK    WN0020 15        DSU Trailer ID
     C                     MOVEL*BLANK    WN0021  1        DSU Sched Route
     C                     Z-ADD*ZERO     WN0022  70       DSU Sched Route
     C                     Z-ADD*ZERO     WN0023  40       DSU Sched Route
     C                     Z-ADD*ZERO     WN0024  70       DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WN0025  40       DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WN0026  70       DSU Sch Start L
     C                     Z-ADD*ZERO     WN0027  40       DSU Sch Start L
     C                     MOVEL*BLANK    WN0028  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0029  6        PL Location Cod
     C                     MOVEL*BLANK    WN0030  1        DSU Record Stat
     C                     Z-ADD*ZERO     WN0031  70       DSU Change Date
     C                     Z-ADD*ZERO     WN0032  60       DSU Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BJCPRJ
     C                     Z-ADDWATFA1    WCTFA1           DSU Company Num
     C                     Z-ADDWAAADX    WCAADX           DSU Transaction
     C                     Z-ADDWATGA1    WCTGA1           DSU Transaction
     C                     Z-ADDWATHA1    WCTHA1           DSU Transaction
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCTFA1           DSU Company Num
     C                     KFLD           WCAADX           DSU Transaction
     C                     KFLD           WCTGA1           DSU Transaction
     C                     KFLD           WCTHA1           DSU Transaction
     C           KLCHSC    CHAIN@BJCPRJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLBJCPL0'MDACP
     C                     MOVEL'@BJCPRJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLBJ1    YARDCS
      * Move non-key fields to @BJCPRJ
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWAYYA1    WCYYA1           DSU PRD Srv Bat
     C                     Z-ADDWAYZA1    WCYZA1           DSU PRD Srv Sch
     C                     MOVELWADET1    WCDET1    P      DSU Ref 1
     C                     MOVELWADFT1    WCDFT1    P      DSU Ref 2
     C                     MOVELWAIHSS    WCIHSS    P      DSU Ref Status
     C                     Z-ADDWUFGSS    WCFGSS           DSU Process Sta
     C                     MOVELWUFHSS    WCFHSS    P      DSU Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPLBJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL'C'       WCFFSS           DSU Record Stat
     C                     Z-ADD##JDT     WCPVCD           DSU Change Date
     C                     Z-ADD##JTM     WCPWCD           DSU Change Time
      * Set PGM.*Record Data Changed flag
     C           QPLBJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BJCPRJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLBJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Std Time,buyer    RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDABCD           PD Producer Cod
      * Setup key
     C                     MOVELWAABCD    WDABCD           PD Producer Cod
      * Establish starting position
     C           KRSSD     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAATH    WUAATH           PD Std Delv Tim
     C                     Z-ADDWDAMNB    WUAMNB           PD Std Truck Si
     C                     MOVELWDIWST    WUIWST           PD Freight Exp
     C                     MOVELWDAACD    WUAACD           SR Source Code
     C                     MOVELWDACCD    WUACCD           HB Buyer Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    WEAACD           SR Source Code
      * Establish starting position
     C           KRSSE     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Line Number  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF02           BOH Buy Order N
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
      * Setup key
     C                     Z-ADDP1TFA1    WQSF01           BOH Company Num
     C                     Z-ADDWUTYA1    WQSF02           BOH Buy Order N
      * Establish starting position
     C           KRSSF     SETLL@AXCPCY                    *
     C           KRSSF     READE@AXCPCY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUBONB           BOL Load Number
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WFBONB    ADD  1         WUBONB           BOL Load Number
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@AXCPCY                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Buy Order Detail  CR - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AXCPBY
     C                     Z-ADDP1TFA1    WGHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WGBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WGBONB           BOL Load Number
     C                     Z-ADDWAGXDT    WGCQDT           BOL Kill Date
     C                     Z-ADDWAB8TH    WGABTH           BOL Pln Delv St
     C                     Z-ADDWAB8TH    WGACTH           BOL Pln Delv En
     C                     Z-ADDWUAMNB    WGBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WGCSNB           BOL Shipped Wgt
     C                     Z-ADDWAGTDT    WGAUDT           BOL Pln Delv Da
     C                     MOVELWUCRTX    WGCMST           BOL Freight UOM
     C                     Z-ADD*ZERO     WGAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WGATVA           BOL Freight Amt
     C                     MOVEL*BLANK    WGI1ST           BOL Freight All
     C                     Z-ADD*ZERO     WGDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WGDINB           BOL Live Wgt Re
     C                     MOVEL*BLANK    WGCNST           BOL Trucker Pay
     C                     Z-ADD*ZERO     WGGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WGBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WGLSNB           BOL AP Voucher
     C                     MOVEL*BLANK    WGF3TX           BOL Trailer
     C                     MOVELWUIWST    WGO8ST           BOL Freight Exp
     C                     MOVEL'1'       WGO9ST           BOL Scheduled K
     C                     MOVELWN0033    WGPAST           BOL Truck Scale
     C                     Z-ADDWN0034    WGLDSH           BOL Shipped Hea
     C                     MOVEL*BLANK    WGPBST           Reported to USD
     C                     MOVEL*BLANK    WGPCST           BOL MPR Prior D
     C                     MOVELWUIXTX    WGPDST           BOL Violated Au
     C                     MOVELWN0036    WGUWST           BOL Status 5
     C                     MOVELWN0037    WGUXST           BOL Status 6
     C                     MOVELWN0038    WGUYST           BOL Status 7
     C                     Z-ADDWATOA1    WGJKRU           BOL HPS Movemen
     C                     Z-ADDWN0039    WGKEOR           BOL Head LFT
     C                     Z-ADDWN0040    WGIOEW           BOL Head EUT/KO
     C                     Z-ADDWN0041    WGKJIO           BOL Auth Gate E
     C                     Z-ADDWN0042    WGIOJR           BOL Head Receiv
     C                     Z-ADDWN0043    WGEIRR           BOL Unused Wgt
     C                     Z-ADDWN0044    WGITMF           BOL Unused Wgt
     C                     Z-ADDWN0045    WGODJE           BOL Unused Wgt
     C                     Z-ADDWN0046    WGRJIF           BOL Unused Wgt
     C                     Z-ADDWN0047    WGOEJF           BOL Unused Wgt
     C                     Z-ADDWN0048    WGD0DT           BOL Auth Gate E
     C                     Z-ADDWN0049    WGD1DT           BOL Unused Date
     C                     Z-ADDWN0050    WGD2DT           BOL Unused Date
     C                     Z-ADDWN0051    WGD3DT           BOL Unused Date
     C                     Z-ADDWN0052    WGD4DT           BOL Unused Date
     C                     MOVEL*BLANK    WGBNCD           TRK Trucker Cod
     C                     MOVELWAABCD    WGABCD           PD Producer Cod
     C                     MOVELWAAECD    WGAECD           PL Location Cod
     C                     MOVEL*BLANK    WGAAVN           RS User Changed
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL*BLANK    WGAHVN           RS Job
     C                     MOVEL*BLANK    WGAGVN           RS Program
     C                     MOVEL*BLANK    WGABVN           RS User Added
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL##USR     WGABVN           RS User Added
     C                     Z-ADD##JDT     WGABDT           RS Date Added
     C                     Z-ADD##JTM     WGABTM           RS Time Added
     C                     MOVEL##PGM     WGAGVN           RS Program
     C                     MOVEL##JOB     WGAHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@AXCPBY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0052' W0RTN   7
      * Send message 'Buy Order Load         EX'
     C                     MOVEL'PRK0052' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@AXCPBY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1TFA1    WHHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WHBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WHBONB           BOL Load Number
      * Establish starting position
     C           KRSSH     CHAIN@ACCPW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1418' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
     C                     EXSR SICRRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0062 10        RS User Changed
     C                     Z-ADD*ZERO     WN0063  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0064  60       RS Time Changed
     C                     MOVEL*BLANK    WN0065  1        RS Record Statu
     C                     MOVEL*BLANK    WN0066 10        RS Job
     C                     MOVEL*BLANK    WN0067 10        RS Program
     C                     MOVEL*BLANK    WN0068 10        RS User Added
     C                     Z-ADD*ZERO     WN0069  70       RS Date Added
     C                     Z-ADD*ZERO     WN0070  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ACCPW7
     C                     Z-ADDP1TFA1    WIHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WIBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WIBONB           BOL Load Number
     C                     MOVELWADET1    WIDIT1           BOL Ref 1
     C                     MOVELWADFT1    WIDJT1           BOL Ref 2
     C                     MOVELWAIHSS    WIIJSS           BOL Ref Status
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WIABDT    PARM *ZERO     WQ0024  70       *DATE
     C           WIABTM    PARM *ZERO     WQ0025  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRSI    SETLL@ACCPW7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1419' W0RTN   7
      * Send message 'Buy Order Load Referen EX'
     C                     MOVEL'PRK1419' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@ACCPW7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0071 10        RS User Changed
     C                     Z-ADD*ZERO     WN0072  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0073  60       RS Time Changed
     C                     MOVEL*BLANK    WN0074  1        RS Record Statu
     C                     MOVEL*BLANK    WN0075 10        RS Job
     C                     MOVEL*BLANK    WN0076 10        RS Program
     C                     MOVEL*BLANK    WN0077 10        RS User Added
     C                     Z-ADD*ZERO     WN0078  70       RS Date Added
     C                     Z-ADD*ZERO     WN0079  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ACCPW7
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C           KLCHSJ    CHAIN@ACCPW7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PWACCPL0'MDACP
     C                     MOVEL'@ACCPW7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPWAC1    YBRDCS
      * Move non-key fields to @ACCPW7
     C                     MOVELWADET1    WIDIT1    P      BOL Ref 1
     C                     MOVELWADFT1    WIDJT1    P      BOL Ref 2
     C                     MOVELWAIHSS    WIIJSS    P      BOL Ref Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WIAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WIAADT    PARM *ZERO     WQ0026  70       *DATE
     C           WIAMTM    PARM *ZERO     WQ0027  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ACCPW7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPWACCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Next Seq Num      RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHONB    WQSK01           CC Company Numb
     C           *LIKE     DEFN WJE0DT    WQSK02           DSH Kill Date
     C           *LIKE     DEFN WJE6DT    WQSK03           DSD Delivery Da
     C           *LIKE     DEFN WJAGTH    WQSK04           DSD Delivery Ti
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CC Company Numb
     C                     KFLD           WQSK02           DSH Kill Date
     C                     KFLD           WQSK03           DSD Delivery Da
     C                     KFLD           WQSK04           DSD Delivery Ti
      * Setup key
     C                     Z-ADDWATFA1    WQSK01           CC Company Numb
     C                     Z-ADDWAGXDT    WQSK02           DSH Kill Date
     C                     Z-ADDWAGTDT    WQSK03           DSD Delivery Da
     C                     Z-ADDWAB8TH    WQSK04           DSD Delivery Ti
      * Establish starting position
     C           KRSSK     SETLL@AECPJT                    *
     C           KRSSK     READE@AECPJT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUHZA1           DSD Delivery Ti
     C                     Z-ADD1         WUHZA1           DSD Delivery Ti
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJHZA1    WUHZA1           DSD Delivery Ti
     C           WJHZA1    ADD  1         WUHZA1           DSD Delivery Ti
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@AECPJT                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Del DSS           RT - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHONB    WQSL01           CC Company Numb
     C           *LIKE     DEFN WKE0DT    WQSL02           DSH Kill Date
     C           *LIKE     DEFN WKE6DT    WQSL03           DSD Delivery Da
     C           *LIKE     DEFN WKAGTH    WQSL04           DSD Delivery Ti
     C           *LIKE     DEFN WKHZA1    WQSL05           DSD Delivery Ti
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           CC Company Numb
     C                     KFLD           WQSL02           DSH Kill Date
     C                     KFLD           WQSL03           DSD Delivery Da
     C                     KFLD           WQSL04           DSD Delivery Ti
     C                     KFLD           WQSL05           DSD Delivery Ti
      * Setup key
     C                     Z-ADDWATFA1    WQSL01           CC Company Numb
     C                     Z-ADDWAGXDT    WQSL02           DSH Kill Date
     C                     Z-ADDWAGTDT    WQSL03           DSD Delivery Da
     C                     Z-ADDWAB8TH    WQSL04           DSD Delivery Ti
     C                     Z-ADDWUHZA1    WQSL05           DSD Delivery Ti
      * Establish starting position
     C           KRSSL     SETLL@AGCPIM                    *
     C           KRSSL     READE@AGCPIM                  90*
      * Data record not found
     C   90                MOVEL'PRK1032' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
     C                     EXSR SMDLRC
     C           KRSSL     READE@AGCPIM                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMDLRC    BEGSR
      *================================================================
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AGCPIL
     C                     Z-ADDWKHONB    WLHONB           CC Company Numb
     C                     Z-ADDWKE0DT    WLE0DT           DSH Kill Date
     C                     Z-ADDWKE6DT    WLE6DT           DSD Delivery Da
     C                     Z-ADDWKAGTH    WLAGTH           DSD Delivery Ti
     C                     Z-ADDWKHZA1    WLHZA1           DSD Delivery Ti
     C                     Z-ADDWKH5A1    WLH5A1           DSS Split Seque
      *
     C           KLDLSM    KLIST
     C                     KFLD           WLHONB           CC Company Numb
     C                     KFLD           WLE0DT           DSH Kill Date
     C                     KFLD           WLE6DT           DSD Delivery Da
     C                     KFLD           WLAGTH           DSD Delivery Ti
     C                     KFLD           WLHZA1           DSD Delivery Ti
     C                     KFLD           WLH5A1           DSS Split Seque
     C           KLDLSM    CHAIN@AGCPIL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAGCPL0'MDACP
     C                     MOVEL'@AGCPIL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AGCPIL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Delv Sched Dtl    CR - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AECPIH
     C                     Z-ADDP1TFA1    WMHONB           CC Company Numb
     C                     Z-ADDWAGXDT    WME0DT           DSH Kill Date
     C                     Z-ADDWAGTDT    WME6DT           DSD Delivery Da
     C                     Z-ADDWAB8TH    WMAGTH           DSD Delivery Ti
     C                     Z-ADDWUHZA1    WMHZA1           DSD Delivery Ti
     C                     Z-ADDWUH0A1    WMH0A1           DSD Scheduled H
     C                     Z-ADDWATKA1    WMH1A1           DSD Farm Site C
     C                     MOVELWAPJCD    WMJ4CD           DSD Building
     C                     MOVELWAPKCD    WMJ5CD           DSD Room
     C                     MOVELWAPLCD    WMLBCD           DSD Sire Line C
     C                     MOVELWAPMCD    WMLCCD           DSD Hog Group C
     C                     Z-ADD*ZERO     WMIOA1           DSD Unused Head
     C                     Z-ADDWATMA1    WMH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WMIJA1           DSD Scheduled K
     C                     MOVELYL0002    WMK9CD           DSD Transportat
     C                     MOVELYL0003    WMK8CD           DSD Trucker Cod
     C                     MOVELWAPNCD    WMJ6CD           DSD Driver
     C                     MOVELWAPOCD    WMJ7CD           DSD Loading Cre
     C                     MOVELWAPRCD    WMMGCD           CHR Code
     C                     MOVELWAPSCD    WMW1ST           DSD Load Type
     C                     MOVELWAE4SS    WMW2ST           DSD Full/Split
     C                     Z-ADDWATOA1    WMH3A1           DSD Movement Nu
     C                     MOVELWAPTCD    WMMECD           DSD Truck ID
     C                     MOVELWAPUCD    WMMFCD           DSD Trailer ID
     C                     MOVEL'N'       WMW4ST           DSD Movement Pr
     C                     MOVELWAE6SS    WMXWST           DSD Sched Route
     C                     Z-ADDWAGWDT    WMFRDT           DSD Sched Route
     C                     Z-ADDWACATH    WMBOTH           DSD Sched Route
     C                     Z-ADDWAGUDT    WME7DT           DSD Sch Farm Ar
     C                     Z-ADDWAB9TH    WMAHTH           DSD Sch Farm Ar
     C                     Z-ADDWAGVDT    WME8DT           DSD Sch Start L
     C                     Z-ADDWACBTH    WMAITH           DSD Sch Start L
     C                     MOVEL'1'       WMXBST           DSD Receiving S
     C                     MOVEL'1'       WMXGST           DSD Kill Shift
     C                     MOVEL'1'       WMXPST           DSD BOL Kill Sh
     C                     MOVEL*BLANK    WMXNST           DSD HPS Post St
     C                     MOVEL'N'       WMXTST           DSD HPE Post St
     C                     MOVEL'O'       WMXLST           DSD Lock Status
     C                     MOVELWUIXST    WMW0ST           DSD Source Type
     C                     MOVELWUYEST    WMYEST           DSD Transfer St
     C                     Z-ADDWUFZDT    WMFZDT           DSD Unused Date
     C                     Z-ADDWUB1TH    WMB1TH           DSD Unused Time
     C                     MOVELWUAACD    WMAACD           SR Source Code
     C                     MOVELWAABCD    WMABCD           PD Producer Cod
     C                     MOVELWAAECD    WMAECD           PL Location Cod
     C                     Z-ADDWATFA1    WMHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WMBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WMBONB           BOL Load Number
     C                     Z-ADDWAYYA1    WMY0A1           DSD PRD Srv Bat
     C                     Z-ADDWAYZA1    WMY1A1           DSD PRD Srv Sch
     C                     MOVELWADET1    WMDGT1           DSD Ref 1
     C                     MOVELWADFT1    WMDHT1           DSD Ref 2
     C                     MOVELWAIHSS    WMIISS           DSD Ref Status
     C                     MOVELWUAAVN    WMAAVN           RS User Changed
     C                     Z-ADDWUAADT    WMAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WMAMTM           RS Time Changed
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVELWUAHVN    WMAHVN           RS Job
     C                     MOVELWUAGVN    WMAGVN           RS Program
     C                     MOVELWUABVN    WMABVN           RS User Added
     C                     Z-ADDWUABDT    WMABDT           RS Date Added
     C                     Z-ADDWUABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
     C                     Z-ADD##JDT     WMABDT           RS Date Added
     C                     Z-ADD##JTM     WMABTM           RS Time Added
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRSN    KLIST
     C                     KFLD           WMHONB           CC Company Numb
     C                     KFLD           WME0DT           DSH Kill Date
     C                     KFLD           WME6DT           DSD Delivery Da
     C                     KFLD           WMAGTH           DSD Delivery Ti
     C                     KFLD           WMHZA1           DSD Delivery Ti
      * Check for duplicate primary key
     C           KLCRSN    SETLL@AECPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1029' W0RTN   7
      * Send message 'Delivery Sched Detail  EX'
     C                     MOVEL'PRK1029' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@AECPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Delv Sched DtlBOL CH - Delivery Sched Detail UPL  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0080  50       DSU Split Seque
     C                     Z-ADD*ZERO     WN0081  70       DSU Kill Date
     C                     Z-ADD*ZERO     WN0082  70       DSU Delivery Da
     C                     Z-ADD*ZERO     WN0083  40       DSU Delivery Ti
     C                     Z-ADD*ZERO     WN0084  50       DSU Farm Site C
     C                     MOVEL*BLANK    WN0085  5        DSU Building
     C                     MOVEL*BLANK    WN0086  5        DSU Room
     C                     MOVEL*BLANK    WN0087  5        DSU Sire Line C
     C                     MOVEL*BLANK    WN0088  7        DSU Hog Group C
     C                     Z-ADD*ZERO     WN0089  30       DSU Scheduled D
     C                     MOVEL*BLANK    WN0090  5        UnUsed Status 5
     C                     MOVEL*BLANK    WN0091  5        UnUsed Code 5
     C                     MOVEL*BLANK    WN0092  5        DSU Driver
     C                     MOVEL*BLANK    WN0093  5        DSU Loading Cre
     C                     MOVEL*BLANK    WN0094  6        DSU Hauler Reas
     C                     MOVEL*BLANK    WN0095  2        DSU Load Type
     C                     MOVEL*BLANK    WN0096  1        DSU Full/Split
     C                     Z-ADD*ZERO     WN0097  70       DSU Movement Nu
     C                     MOVEL*BLANK    WN0098 15        DSU Truck ID
     C                     MOVEL*BLANK    WN0099 15        DSU Trailer ID
     C                     MOVEL*BLANK    WN0100  1        DSU Sched Route
     C                     Z-ADD*ZERO     WN0101  70       DSU Sched Route
     C                     Z-ADD*ZERO     WN0102  40       DSU Sched Route
     C                     Z-ADD*ZERO     WN0103  70       DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WN0104  40       DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WN0105  70       DSU Sch Start L
     C                     Z-ADD*ZERO     WN0106  40       DSU Sch Start L
     C                     MOVEL*BLANK    WN0107  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0108  6        PL Location Cod
     C                     Z-ADD*ZERO     WN0109 100       DSU PRD Srv Bat
     C                     Z-ADD*ZERO     WN0110 100       DSU PRD Srv Sch
     C                     MOVEL*BLANK    WN0111 10        DSU Ref 1
     C                     MOVEL*BLANK    WN0112 10        DSU Ref 2
     C                     MOVEL*BLANK    WN0113  2        DSU Ref Status
     C                     MOVEL*BLANK    WN0114  1        DSU Record Stat
     C                     Z-ADD*ZERO     WN0115  70       DSU Change Date
     C                     Z-ADD*ZERO     WN0116  60       DSU Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BJCPRJ
     C                     Z-ADDP1TFA1    WCTFA1           DSU Company Num
     C                     Z-ADDWAAADX    WCAADX           DSU Transaction
     C                     Z-ADDWATGA1    WCTGA1           DSU Transaction
     C                     Z-ADDWATHA1    WCTHA1           DSU Transaction
      *
     C           KLCHSO    KLIST
     C                     KFLD           WCTFA1           DSU Company Num
     C                     KFLD           WCAADX           DSU Transaction
     C                     KFLD           WCTGA1           DSU Transaction
     C                     KFLD           WCTHA1           DSU Transaction
     C           KLCHSO    CHAIN@BJCPRJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLBJCPL0'MDACP
     C                     MOVEL'@BJCPRJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLBJ1    YCRDCS
      * Move non-key fields to @BJCPRJ
     C                     Z-ADDWATFA1    WCHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WCBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WCBONB           BOL Load Number
     C                     Z-ADD1         WCFGSS           DSU Process Sta
     C                     MOVEL*BLANK    WCFHSS    P      DSU Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPLBJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL'C'       WCFFSS           DSU Record Stat
     C                     Z-ADD##JDT     WCPVCD           DSU Change Date
     C                     Z-ADD##JTM     WCPWCD           DSU Change Time
      * Set PGM.*Record Data Changed flag
     C           QPLBJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BJCPRJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLBJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * C9426 032217 slm
      * C9426 use the BOL Reference to store the Ref1,Ref2 and Ref Status
      *  5/08/18 JBB E31600 - Stop reprocessing UPL records when error
      *                       Update current UPL record Process Status to
      *                       Processed, and Error Reason to ADDDRF.
      * 11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1TFA1    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0001           MTech Live Yes
     C                     Z-ADD*ZERO     WUTYA1           Buy Order Numbe
     C                     Z-ADD*ZERO     WUC6DT           Kill Date 1 Usr
     C                     MOVEL'*YES'    WUG6SS           Break Logic Usr
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Break Logic Check
      *================================================================
      * Verify if different kill date
      * CASE: WRK.Kill Date 1 Usr NE DB1.DSU Kill Date
     C           WUC6DT    IFNE WAGXDT                     *IF
     C                     MOVEL'*YES'    WUG6SS           Break Logic Usr
     C                     END                             *FI
      * Break
      * CASE: WRK.Break Logic Usr is *Yes
     C           WUG6SS    IFEQ '*YES'                     *IF
     C                     Z-ADDWAGXDT    WUC6DT           Kill Date 1 Usr
     C                     Z-ADDWAGXDT    WUE0DT           DSH Kill Date
      * Create first buy order for this company and kill date
      * 5/25/2017 - Producer and producer locatin from upl
      * no longer by seaboard or seaboard location
      * upl SHOULD have the producer And producer location
      * Crt BOH f/DSchMTech   XF - Buy Order Header  * 
     C                     CALL 'PLXIXFR'              90  Crt BOH f/DSchM
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATFA1    WQ0012  30       CC Company Numb
     C                     PARM WAGXDT    WQ0013  70       DSH Kill Date
     C                     PARM WAGTDT    WQ0014  70       DSD Delivery Da
     C                     PARM WAB8TH    WQ0015  40       DSD Delivery Ti
     C                     PARM WATMA1    WQ0016  30       DSD Scheduled D
     C                     PARM WATOA1    WQ0017  70       DSD Movement Nu
     C                     PARM WAABCD    WQ0018  6        PD Producer Cod
     C                     PARM WAAECD    WQ0019  6        PL Location Cod
     C           WUHMNB    PARM WUHMNB    WQ0020  30       BOH Company Num
     C           WUBNNB    PARM WUBNNB    WQ0021  70       BOH Buy Order N
     C           WUBONB    PARM WUBONB    WQ0022  50       BOL Load Number
     C                     PARM 'Y'       WQ0023  1        Status 3
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUBNNB    WUTYA1           Buy Order Numbe
     C                     MOVEL*BLANK    WUG6SS           Break Logic Usr
     C                     MOVEL'*NO'     WUG6SS           Break Logic Usr
     C                     END                             *FI
     C                     Z-ADDP1TFA1    WUHMNB           BOH Company Num
     C                     Z-ADDWUTYA1    WUBNNB           BOH Buy Order N
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Detail Records
      *================================================================
      * NOW CREATE THE BUY ORDER LOAD
      * 5/25/2017 pass producer and producer location from UPL
      * Rtv Std Time,buyer    RT - Producer  * 
     C                     EXSR SDRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SERVGN
      *
     C                     MOVEL*BLANK    WN0033  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0034  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0035  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0036  2        BOL Status 5
     C                     MOVEL*BLANK    WN0037  2        BOL Status 6
     C                     MOVEL*BLANK    WN0038  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0039  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0040  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0041  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0042  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0043 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0044 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0045 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0046 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0047 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0048  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0049  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0050  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0051  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0052  70       BOL Unused Date
      *
      * Crt Buy Order DtlMvnm IF
     C                     Z-ADDWATMA1    WUBPNB           BOL Pln Head De
      * If Std truck size is zero, default to Planned head delivered qty
      * CASE: PAR.PD Std Truck Size EQ WRK.Zero USR
     C           WUAMNB    IFEQ WUE9NB                     *IF
     C                     Z-ADDWUBPNB    WUAMNB           PD Std Truck Si
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUAMNB    WUAMNB           PD Std Truck Si
     C                     END                             *FI
      * Write Load records with planned head not exceeding std truck size
      * DO WHILE: WRK.BOL Pln Head Delv GT WRK.Zero USR
     C           WUBPNB    DOWGTWUE9NB                     *DOW
     C                     SUB  WUAMNB    WUBPNB           BOL Pln Head De
      * CASE: WRK.BOL Pln Head Delv LT WRK.Zero USR
     C           WUBPNB    IFLT WUE9NB                     *IF
     C                     ADD  WUBPNB    WUAMNB           PD Std Truck Si
     C                     END                             *FI
      * Rtv Next Line Number  RT - Buy Order Load  * 
     C                     EXSR SFRVGN
      * Crt Buy Order Detail  CR - Buy Order Load  * 
     C                     EXSR SGCRRC
     C                     END                             *ITR
      *
     C                     MOVEL*BLANK    WN0053 10        RS User Changed
     C                     Z-ADD*ZERO     WN0054  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0055  60       RS Time Changed
     C                     MOVEL*BLANK    WN0056  1        RS Record Statu
     C                     MOVEL*BLANK    WN0057 10        RS Job
     C                     MOVEL*BLANK    WN0058 10        RS Program
     C                     MOVEL*BLANK    WN0059 10        RS User Added
     C                     Z-ADD*ZERO     WN0060  70       RS Date Added
     C                     Z-ADD*ZERO     WN0061  60       RS Time Added
      *
      * Crt/Upd BO Load Ref   IF
      * C9426 032217 slm
      * C9426 use the BOL Referene to store the Ref1,Ref2 and Ref Status
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
     C                     EXSR SHRVGN
      * Update process
      * Add to the delivery Schedule detail AND Update UPL
      * CASE: DB1.DSU Record Status is Add
     C           WAFFSS    IFEQ 'A'                        *IF
      * Rtv Next Seq Num      RT - Delivery Sched Detail  * 
     C                     EXSR SKRVGN
      * this delete should not be need but will perform anyway
      * just in case of a restart
      * Rtv Del DSS           RT - Delivery Sched Split  * 
     C                     EXSR SLRVGN
     C                     MOVELWUCRTX    YL0002           DT Transportati
     C                     MOVELWUCRTX    YL0003           DT Trucker Code
      * Create the Delivery Schedule Detail for the 1st record
      * all records will be created as full loads regardless
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
      * If load crew is found then get the transportation office
     C                     EXSR UESUBR                     If load crew is
      * If driver is found then pull the trucker
     C                     EXSR UFSUBR                     If driver is fo
     C                     END                             *FI
      * 052517 slm * come back to this pull off to work on producer
      * producer location, and trucker
      * GET the producer source and the source type
      * this was currently hard code for internal only
      * Changes to all internal or externals
      * Crt Delv Sched Dtl    CR - Delivery Sched Detail  * 
     C                     EXSR SNCRRC
      * Chg Delv Sched DtlBOL CH - Delivery Sched Detail UPL  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * Process is completed move buy order number
     C                     EXSR UGSUBR                     Process is comp
      * Add logic for the new HPS program and what i need tosend
      * Add this to perform a call to a HPS program on every record
      * Barb G ---she will get back to us on this
      * CASE: DB1.DSU Ref Status is HPS Schedule SalesMovemnt
     C           WAIHSS    IFEQ 'SM'                       *IF
      * Snd HPS DelvSch Inf UP - STR HPS Interface  * 
     C                     CALL 'HP2084'               90  Snd HPS DelvSch
     C                     PARM W0RTN     WQ0045  7        *Return code
     C                     PARM WATFA1    WQ0046  30       DSU Company Num
     C                     PARM WATOA1    WQ0047  70       DSU Movement Nu
     C                     PARM WAGTDT    WQ0048  70       DSU Delivery Da
     C                     PARM WAB8TH    WQ0049  40       DSU Delivery Ti
     C                     PARM WUHZA1    WQ0050  30       DSU Delivery Ti
     C                     PARM WUTYA1    WQ0051  70       Buy Order Numbe
     C                     PARM WUBONB    WQ0052  50       Buy Order Load
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP2084'  W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * If load crew is found then get the transportation office
      *================================================================
      * CASE: DB1.DSU Loading Crew is Entered
     C           WAPOCD    IFNE *BLANK                     *IF
      * Val HPS Loading Crew  UP - STR HPS Interface  * 
     C                     CALL 'HP273'                90  Val HPS Loading
     C           WULMST    PARM *BLANK    WQ0028  7        Return Code USR
     C                     PARM WAPOCD    WQ0029  5        DT Loading Crew
     C                     PARM *BLANK    WQ0030 25        HPS Loading Cre
     C           YL0002    PARM *BLANK    WQ0031  5        DT Transportati
     C                     PARM *BLANK    WQ0032  1        RS Record Statu
     C                     PARM *BLANK    WQ0033 20        MTech Load Crew
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP273'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCRTX    YL0002           DT Transportati
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * If driver is found then pull the trucker
      *================================================================
      * CASE: DB1.DSU Driver is Entered
     C           WAPNCD    IFNE *BLANK                     *IF
      * Val HPS Driver        UP - STR HPS Interface  * 
     C                     CALL 'HP272'                90  Val HPS Driver
     C           WULMST    PARM *BLANK    WQ0034  7        Return Code USR
     C                     PARM WAPNCD    WQ0035  5        DT Driver
     C                     PARM *BLANK    WQ0036 25        HPS Driver Name
     C                     PARM *BLANK    WQ0037  5        DT Transportati
     C                     PARM *BLANK    WQ0038  1        RS Record Statu
     C                     PARM *BLANK    WQ0039 15        DT Truck ID
     C                     PARM *BLANK    WQ0040 15        DT Trailer ID
     C           YL0003    PARM *BLANK    WQ0041  5        DT Trucker Code
     C                     PARM *BLANK    WQ0042 25        DT Trucker Name
     C                     PARM *BLANK    WQ0043 20        MTech Trucker R
     C                     PARM *BLANK    WQ0044 20        MTech Driver Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP272'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCRTX    YL0003           DT Trucker Code
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Process is completed move buy order number
      *================================================================
     C                     Z-ADDWUTYA1    WUTYA1           Buy Order Numbe
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Buy Order Number Mtech
     C                     Z-ADD*ZERO     WUTYA1  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WATFA1           DSU Company Num
     C                     Z-ADD*ZERO     WAAADX           DSU Transaction
     C                     Z-ADD*ZERO     WATGA1           DSU Transaction
     C                     Z-ADD*ZERO     WATHA1           DSU Transaction
     C                     Z-ADD*ZERO     WATPA1           DSU Split Seque
     C                     Z-ADD*ZERO     WAGXDT           DSU Kill Date
     C                     Z-ADD*ZERO     WAGTDT           DSU Delivery Da
     C                     Z-ADD*ZERO     WAB8TH           DSU Delivery Ti
     C                     Z-ADD*ZERO     WATKA1           DSU Farm Site C
     C                     Z-ADD*ZERO     WATMA1           DSU Scheduled D
     C                     Z-ADD*ZERO     WATOA1           DSU Movement Nu
     C                     Z-ADD*ZERO     WAGWDT           DSU Sched Route
     C                     Z-ADD*ZERO     WACATH           DSU Sched Route
     C                     Z-ADD*ZERO     WAGUDT           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WAB9TH           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WAGVDT           DSU Sch Start L
     C                     Z-ADD*ZERO     WACBTH           DSU Sch Start L
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAYYA1           DSU PRD Srv Bat
     C                     Z-ADD*ZERO     WAYZA1           DSU PRD Srv Sch
     C                     Z-ADD*ZERO     WAFGSS           DSU Process Sta
     C                     Z-ADD*ZERO     WAPVCD           DSU Change Date
     C                     Z-ADD*ZERO     WAPWCD           DSU Change Time
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Kill Date 1 Usr
     C                     Z-ADD*ZERO     WUC6DT  70
      * Define work field Break Logic Usr
     C                     MOVEL*BLANK    WUG6SS  4
      * Define work field DSU Error Reason
     C                     MOVEL*BLANK    WUFHSS  6
      * Define work field DSU Kill Date
     C                     Z-ADD*ZERO     WUGXDT  70
      * Define work field DSU Delivery Date
     C                     Z-ADD*ZERO     WUGTDT  70
      * Define work field DSU Delivery Time
     C                     Z-ADD*ZERO     WUB8TH  40
      * Define work field DSD Delivery Time Seq
     C                     Z-ADD*ZERO     WUHZA1  30
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field PD Producer Code
     C                     MOVEL*BLANK    WUABCD  6
      * Define work field BOH Company Number
     C                     Z-ADD*ZERO     WUHMNB  30
      * Define work field BOH Buy Order Number
     C                     Z-ADD*ZERO     WUBNNB  70
      * Define work field BOL Load Number
     C                     Z-ADD*ZERO     WUBONB  50
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WBE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WBAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WBHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WBH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WBH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WBIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WBH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WBIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WBH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WBFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WBBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WBE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WBAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WBE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WBAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WBFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WBB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBY0A1           DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WBY1A1           DSD PRD Srv Sch
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field DSU Process Status
     C                     Z-ADD*ZERO     WUFGSS  10
      * Define work field DSH Kill Date
     C                     Z-ADD*ZERO     WUE0DT  70
      * Define work field PD Std Delv Time
     C                     Z-ADD*ZERO     WUAATH  40
      * Define work field PD Std Truck Size
     C                     Z-ADD*ZERO     WUAMNB  50
      * Define work field PD Freight Exp Paid By
     C                     MOVEL*BLANK    WUIWST  1
      * Define work field HB Buyer Code
     C                     MOVEL*BLANK    WUACCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDALNB           PD Production C
     C                     Z-ADD*ZERO     WDAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WDAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WDGCNB           PD VND Address
     C                     Z-ADD*ZERO     WDGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field BOL Pln Head Delv
     C                     Z-ADD*ZERO     WUBPNB  50
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WFABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WFACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WFBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WFCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WFAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WFAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WFATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WFDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WFDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WFGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WFBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WFLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WFLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WFJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WFKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WFIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WFKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WFEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHONB           CC Company Numb
     C                     Z-ADD*ZERO     WKE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WKE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WKAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WKHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WKH5A1           DSS Split Seque
     C                     Z-ADD*ZERO     WKH6A1           DSS Scheduled H
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field DSD Scheduled Hour
     C                     Z-ADD*ZERO     WUH0A1  20
      * Define work field DSD Transfer Sts
     C                     MOVEL*BLANK    WUYEST  4
      * Define work field DSD Unused Date
     C                     Z-ADD*ZERO     WUFZDT  70
      * Define work field DSD Unused Time
     C                     Z-ADD*ZERO     WUB1TH  40
      * Define work field RS User Changed
     C                     MOVEL*BLANK    WUAAVN 10
      * Define work field RS Date Changed
     C                     Z-ADD*ZERO     WUAADT  70
      * Define work field RS Time Changed
     C                     Z-ADD*ZERO     WUAMTM  60
      * Define work field RS Job
     C                     MOVEL*BLANK    WUAHVN 10
      * Define work field RS Program
     C                     MOVEL*BLANK    WUAGVN 10
      * Define work field RS User Added
     C                     MOVEL*BLANK    WUABVN 10
      * Define work field RS Date Added
     C                     Z-ADD*ZERO     WUABDT  70
      * Define work field RS Time Added
     C                     Z-ADD*ZERO     WUABTM  60
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field DT Transportation Office
     C                     MOVEL*BLANK    YL0002  5
      * Define local work field DT Trucker Code HPS
     C                     MOVEL*BLANK    YL0003  5
      * Define null work field HPS Loading Crew Desc
     C                     MOVEL*BLANK    YN0001 25
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field MTech Load Crew Ref
     C                     MOVEL*BLANK    YN0003 20
      * Define null work field HPS Driver Name
     C                     MOVEL*BLANK    YN0004 25
      * Define null work field DT Transportation Office
     C                     MOVEL*BLANK    YN0005  5
      * Define null work field DT Truck ID
     C                     MOVEL*BLANK    YN0006 15
      * Define null work field DT Trailer ID
     C                     MOVEL*BLANK    YN0007 15
      * Define null work field DT Trucker Name Usr 25
     C                     MOVEL*BLANK    YN0008 25
      * Define null work field MTech Trucker Ref
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field MTech Driver Ref
     C                     MOVEL*BLANK    YN0010 20
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
