// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMP3XFR
// ?Date: 14.08.2025 Time: 03:43:44
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?*** WEEKLY ***
// Call program Zzz Prd Beg/End Dt JB XF.
CALL PROGRAM(Zzz Prd Beg/End Dt JB XF) ('PMI2XFR');
PARAMETER(PAR.Company_Number);
PARAMETER('W');
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);

EXECUTE FUNCTION(Crt JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1856856;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER('W');
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: CON);

 // LCL.Item Code 5.0 = DB1.Item Code
 LCL.Item_Code_5_0 = DB1.Item_Code;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 // PAR.TERRITORY = CON.99
 PAR.TERRITORY = 99;

 CASE;

 // IF DB1.Item Structure Type Code is EQ 900
 IF DB1.Item_Structure_Type_Code = 900;

 CASE;

 // IF DB1.Item Code NE DB1.Seaboard Equivalent Item
 IF DB1.Item_Code <> DB1.Seaboard_Equivalent_Item;

 // AND DB1.Seaboard Equivalent Item is Entered
 AND DB1.Seaboard_Equivalent_Item <> *ZERO;

 // PAR.TERRITORY = CON.98
 PAR.TERRITORY = 98;

 // LCL.Item Code 5.0 = DB1.Seaboard Equivalent Item
 LCL.Item_Code_5_0 = DB1.Seaboard_Equivalent_Item;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Rtv Sales Summary     RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1856326;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_From_USR);
 PARAMETER(PAR.Date_To_USR);
 PARAMETER(LCL.Weight_Billed);
 PARAMETER(LCL.Billing_Detail_Cost_Dol);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date To               USR
  IF DB1.Actual_Shipped_Date > PAR.Date_To_USR;

  QUIT;

  ENDIF;

  EXECUTE FUNCTION(RTV Billing Type       RT) TYPE(RTVOBJ) FILE(OPEXREP)          AC1316455;
  PARAMETER(DB1.Order_Type_Sales);
  PARAMETER(LCL.Billing_Activity_Type);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF DB1.Affect Sales Doll Status is yes
  IF DB1.Affect_Sales_Doll_Status = 'Y';

  // PAR.Billing Detail Cost Dol. = PAR.Billing Detail Cost Dol. + DB1.Billing Detail Gross Dol.
  PAR.Billing_Detail_Cost_Dol = PAR.Billing_Detail_Cost_Dol + DB1.Billing_Detail_Gross_Dol;

  ENDIF;

  CASE;

  // IF DB1.Affect Sales Pnds Status is yes
  IF DB1.Affect_Sales_Pnds_Status = 'Y';

  CASE;

  // IF LCL.Billing Activity Type is Credit Memo
  IF LCL.Billing_Activity_Type = '2';

  // PAR.Weight Billed = PAR.Weight Billed - DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed - DB1.Weight_Billed;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Weight Billed = PAR.Weight Billed + DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed + DB1.Weight_Billed;

  ENDIF;

  ENDIF;

 }

 //?UPD: Week
 CASE;

 // IF PAR.Period Type USR is Week
 IF PAR.Period_Type_USR = 'W';

 // PAR.WEEKLY SALES = LCL.Billing Detail Cost Dol.
 PAR.WEEKLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.WEEKLY UNITS = LCL.Weight Billed
 PAR.WEEKLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES WK  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857385;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.WEEKLY_SALES);
 PARAMETER(PAR.WEEKLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES WK  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857386;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
 }

 ENDIF;

 //?UPD: Month
 CASE;

 // IF PAR.Period Type USR is Month
 IF PAR.Period_Type_USR = 'M';

 // PAR.MONTHLY SALES = LCL.Billing Detail Cost Dol.
 PAR.MONTHLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.MONTHLY UNITS = LCL.Weight Billed
 PAR.MONTHLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES MO  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857388;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.MONTHLY_SALES);
 PARAMETER(PAR.MONTHLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES MO  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857389;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
 }

 ENDIF;

 //?UPD: Quarter
 CASE;

 // IF PAR.Period Type USR is Quarter
 IF PAR.Period_Type_USR = 'Q';

 // PAR.QUARTER SALES = LCL.Billing Detail Cost Dol.
 PAR.QUARTER_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.QUARTER UNITS = LCL.Weight Billed
 PAR.QUARTER_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES QT  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857391;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.QUARTER_SALES);
 PARAMETER(PAR.QUARTER_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES QT  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857392;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
 }

 ENDIF;

 //?UPD: YTD
 CASE;

 // IF PAR.Period Type USR is Year
 IF PAR.Period_Type_USR = 'Y';

 // PAR.Y-T-D SALES = LCL.Billing Detail Cost Dol.
 PAR.Y_T_D_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.Y-T-D UNITS = LCL.Weight Billed
 PAR.Y_T_D_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1856900;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.Y_T_D_SALES);
 PARAMETER(PAR.Y_T_D_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES YTD Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1856901;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
 }

 ENDIF;

}


//?*** MONTHLY ***
// Call program Zzz Prd Beg/End Dt JB XF.
CALL PROGRAM(Zzz Prd Beg/End Dt JB XF) ('PMI2XFR');
PARAMETER(PAR.Company_Number);
PARAMETER('M');
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);

EXECUTE FUNCTION(Crt JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1856856;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER('M');
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: CON);

 // LCL.Item Code 5.0 = DB1.Item Code
 LCL.Item_Code_5_0 = DB1.Item_Code;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 // PAR.TERRITORY = CON.99
 PAR.TERRITORY = 99;

 CASE;

 // IF DB1.Item Structure Type Code is EQ 900
 IF DB1.Item_Structure_Type_Code = 900;

 CASE;

 // IF DB1.Item Code NE DB1.Seaboard Equivalent Item
 IF DB1.Item_Code <> DB1.Seaboard_Equivalent_Item;

 // AND DB1.Seaboard Equivalent Item is Entered
 AND DB1.Seaboard_Equivalent_Item <> *ZERO;

 // PAR.TERRITORY = CON.98
 PAR.TERRITORY = 98;

 // LCL.Item Code 5.0 = DB1.Seaboard Equivalent Item
 LCL.Item_Code_5_0 = DB1.Seaboard_Equivalent_Item;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Rtv Sales Summary     RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1856326;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_From_USR);
 PARAMETER(PAR.Date_To_USR);
 PARAMETER(LCL.Weight_Billed);
 PARAMETER(LCL.Billing_Detail_Cost_Dol);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date To               USR
  IF DB1.Actual_Shipped_Date > PAR.Date_To_USR;

  QUIT;

  ENDIF;

  EXECUTE FUNCTION(RTV Billing Type       RT) TYPE(RTVOBJ) FILE(OPEXREP)          AC1316455;
  PARAMETER(DB1.Order_Type_Sales);
  PARAMETER(LCL.Billing_Activity_Type);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF DB1.Affect Sales Doll Status is yes
  IF DB1.Affect_Sales_Doll_Status = 'Y';

  // PAR.Billing Detail Cost Dol. = PAR.Billing Detail Cost Dol. + DB1.Billing Detail Gross Dol.
  PAR.Billing_Detail_Cost_Dol = PAR.Billing_Detail_Cost_Dol + DB1.Billing_Detail_Gross_Dol;

  ENDIF;

  CASE;

  // IF DB1.Affect Sales Pnds Status is yes
  IF DB1.Affect_Sales_Pnds_Status = 'Y';

  CASE;

  // IF LCL.Billing Activity Type is Credit Memo
  IF LCL.Billing_Activity_Type = '2';

  // PAR.Weight Billed = PAR.Weight Billed - DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed - DB1.Weight_Billed;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Weight Billed = PAR.Weight Billed + DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed + DB1.Weight_Billed;

  ENDIF;

  ENDIF;

 }

 //?UPD: Week
 CASE;

 // IF PAR.Period Type USR is Week
 IF PAR.Period_Type_USR = 'W';

 // PAR.WEEKLY SALES = LCL.Billing Detail Cost Dol.
 PAR.WEEKLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.WEEKLY UNITS = LCL.Weight Billed
 PAR.WEEKLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES WK  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857385;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.WEEKLY_SALES);
 PARAMETER(PAR.WEEKLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES WK  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857386;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
 }

 ENDIF;

 //?UPD: Month
 CASE;

 // IF PAR.Period Type USR is Month
 IF PAR.Period_Type_USR = 'M';

 // PAR.MONTHLY SALES = LCL.Billing Detail Cost Dol.
 PAR.MONTHLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.MONTHLY UNITS = LCL.Weight Billed
 PAR.MONTHLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES MO  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857388;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.MONTHLY_SALES);
 PARAMETER(PAR.MONTHLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES MO  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857389;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
 }

 ENDIF;

 //?UPD: Quarter
 CASE;

 // IF PAR.Period Type USR is Quarter
 IF PAR.Period_Type_USR = 'Q';

 // PAR.QUARTER SALES = LCL.Billing Detail Cost Dol.
 PAR.QUARTER_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.QUARTER UNITS = LCL.Weight Billed
 PAR.QUARTER_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES QT  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857391;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.QUARTER_SALES);
 PARAMETER(PAR.QUARTER_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES QT  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857392;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
 }

 ENDIF;

 //?UPD: YTD
 CASE;

 // IF PAR.Period Type USR is Year
 IF PAR.Period_Type_USR = 'Y';

 // PAR.Y-T-D SALES = LCL.Billing Detail Cost Dol.
 PAR.Y_T_D_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.Y-T-D UNITS = LCL.Weight Billed
 PAR.Y_T_D_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1856900;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.Y_T_D_SALES);
 PARAMETER(PAR.Y_T_D_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES YTD Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1856901;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
 }

 ENDIF;

}


//?*** QUARTER ***
// Call program Zzz Prd Beg/End Dt JB XF.
CALL PROGRAM(Zzz Prd Beg/End Dt JB XF) ('PMI2XFR');
PARAMETER(PAR.Company_Number);
PARAMETER('Q');
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);

EXECUTE FUNCTION(Crt JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1856856;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER('Q');
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: CON);

 // LCL.Item Code 5.0 = DB1.Item Code
 LCL.Item_Code_5_0 = DB1.Item_Code;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 // PAR.TERRITORY = CON.99
 PAR.TERRITORY = 99;

 CASE;

 // IF DB1.Item Structure Type Code is EQ 900
 IF DB1.Item_Structure_Type_Code = 900;

 CASE;

 // IF DB1.Item Code NE DB1.Seaboard Equivalent Item
 IF DB1.Item_Code <> DB1.Seaboard_Equivalent_Item;

 // AND DB1.Seaboard Equivalent Item is Entered
 AND DB1.Seaboard_Equivalent_Item <> *ZERO;

 // PAR.TERRITORY = CON.98
 PAR.TERRITORY = 98;

 // LCL.Item Code 5.0 = DB1.Seaboard Equivalent Item
 LCL.Item_Code_5_0 = DB1.Seaboard_Equivalent_Item;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Rtv Sales Summary     RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1856326;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_From_USR);
 PARAMETER(PAR.Date_To_USR);
 PARAMETER(LCL.Weight_Billed);
 PARAMETER(LCL.Billing_Detail_Cost_Dol);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date To               USR
  IF DB1.Actual_Shipped_Date > PAR.Date_To_USR;

  QUIT;

  ENDIF;

  EXECUTE FUNCTION(RTV Billing Type       RT) TYPE(RTVOBJ) FILE(OPEXREP)          AC1316455;
  PARAMETER(DB1.Order_Type_Sales);
  PARAMETER(LCL.Billing_Activity_Type);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF DB1.Affect Sales Doll Status is yes
  IF DB1.Affect_Sales_Doll_Status = 'Y';

  // PAR.Billing Detail Cost Dol. = PAR.Billing Detail Cost Dol. + DB1.Billing Detail Gross Dol.
  PAR.Billing_Detail_Cost_Dol = PAR.Billing_Detail_Cost_Dol + DB1.Billing_Detail_Gross_Dol;

  ENDIF;

  CASE;

  // IF DB1.Affect Sales Pnds Status is yes
  IF DB1.Affect_Sales_Pnds_Status = 'Y';

  CASE;

  // IF LCL.Billing Activity Type is Credit Memo
  IF LCL.Billing_Activity_Type = '2';

  // PAR.Weight Billed = PAR.Weight Billed - DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed - DB1.Weight_Billed;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Weight Billed = PAR.Weight Billed + DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed + DB1.Weight_Billed;

  ENDIF;

  ENDIF;

 }

 //?UPD: Week
 CASE;

 // IF PAR.Period Type USR is Week
 IF PAR.Period_Type_USR = 'W';

 // PAR.WEEKLY SALES = LCL.Billing Detail Cost Dol.
 PAR.WEEKLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.WEEKLY UNITS = LCL.Weight Billed
 PAR.WEEKLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES WK  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857385;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.WEEKLY_SALES);
 PARAMETER(PAR.WEEKLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES WK  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857386;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
 }

 ENDIF;

 //?UPD: Month
 CASE;

 // IF PAR.Period Type USR is Month
 IF PAR.Period_Type_USR = 'M';

 // PAR.MONTHLY SALES = LCL.Billing Detail Cost Dol.
 PAR.MONTHLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.MONTHLY UNITS = LCL.Weight Billed
 PAR.MONTHLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES MO  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857388;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.MONTHLY_SALES);
 PARAMETER(PAR.MONTHLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES MO  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857389;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
 }

 ENDIF;

 //?UPD: Quarter
 CASE;

 // IF PAR.Period Type USR is Quarter
 IF PAR.Period_Type_USR = 'Q';

 // PAR.QUARTER SALES = LCL.Billing Detail Cost Dol.
 PAR.QUARTER_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.QUARTER UNITS = LCL.Weight Billed
 PAR.QUARTER_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES QT  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857391;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.QUARTER_SALES);
 PARAMETER(PAR.QUARTER_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES QT  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857392;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
 }

 ENDIF;

 //?UPD: YTD
 CASE;

 // IF PAR.Period Type USR is Year
 IF PAR.Period_Type_USR = 'Y';

 // PAR.Y-T-D SALES = LCL.Billing Detail Cost Dol.
 PAR.Y_T_D_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.Y-T-D UNITS = LCL.Weight Billed
 PAR.Y_T_D_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1856900;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.Y_T_D_SALES);
 PARAMETER(PAR.Y_T_D_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES YTD Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1856901;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
 }

 ENDIF;

}


//?*** YTD     ***
// Call program Zzz Prd Beg/End Dt JB XF.
CALL PROGRAM(Zzz Prd Beg/End Dt JB XF) ('PMI2XFR');
PARAMETER(PAR.Company_Number);
PARAMETER('Y');
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);

EXECUTE FUNCTION(Crt JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1856856;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER('Y');
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: CON);

 // LCL.Item Code 5.0 = DB1.Item Code
 LCL.Item_Code_5_0 = DB1.Item_Code;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 // PAR.TERRITORY = CON.99
 PAR.TERRITORY = 99;

 CASE;

 // IF DB1.Item Structure Type Code is EQ 900
 IF DB1.Item_Structure_Type_Code = 900;

 CASE;

 // IF DB1.Item Code NE DB1.Seaboard Equivalent Item
 IF DB1.Item_Code <> DB1.Seaboard_Equivalent_Item;

 // AND DB1.Seaboard Equivalent Item is Entered
 AND DB1.Seaboard_Equivalent_Item <> *ZERO;

 // PAR.TERRITORY = CON.98
 PAR.TERRITORY = 98;

 // LCL.Item Code 5.0 = DB1.Seaboard Equivalent Item
 LCL.Item_Code_5_0 = DB1.Seaboard_Equivalent_Item;

 // PAR.PRODUCT CODE = CVTVAR(LCL.Item Code 5.0)
 PAR.PRODUCT_CODE = CVTVAR(LCL.Item_Code_5_0);

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Rtv Sales Summary     RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC1856326;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Date_From_USR);
 PARAMETER(PAR.Date_To_USR);
 PARAMETER(LCL.Weight_Billed);
 PARAMETER(LCL.Billing_Detail_Cost_Dol);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Actual Shipped Date GT PAR.Date To               USR
  IF DB1.Actual_Shipped_Date > PAR.Date_To_USR;

  QUIT;

  ENDIF;

  EXECUTE FUNCTION(RTV Billing Type       RT) TYPE(RTVOBJ) FILE(OPEXREP)          AC1316455;
  PARAMETER(DB1.Order_Type_Sales);
  PARAMETER(LCL.Billing_Activity_Type);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF DB1.Affect Sales Doll Status is yes
  IF DB1.Affect_Sales_Doll_Status = 'Y';

  // PAR.Billing Detail Cost Dol. = PAR.Billing Detail Cost Dol. + DB1.Billing Detail Gross Dol.
  PAR.Billing_Detail_Cost_Dol = PAR.Billing_Detail_Cost_Dol + DB1.Billing_Detail_Gross_Dol;

  ENDIF;

  CASE;

  // IF DB1.Affect Sales Pnds Status is yes
  IF DB1.Affect_Sales_Pnds_Status = 'Y';

  CASE;

  // IF LCL.Billing Activity Type is Credit Memo
  IF LCL.Billing_Activity_Type = '2';

  // PAR.Weight Billed = PAR.Weight Billed - DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed - DB1.Weight_Billed;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Weight Billed = PAR.Weight Billed + DB1.Weight Billed
  PAR.Weight_Billed = PAR.Weight_Billed + DB1.Weight_Billed;

  ENDIF;

  ENDIF;

 }

 //?UPD: Week
 CASE;

 // IF PAR.Period Type USR is Week
 IF PAR.Period_Type_USR = 'W';

 // PAR.WEEKLY SALES = LCL.Billing Detail Cost Dol.
 PAR.WEEKLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.WEEKLY UNITS = LCL.Weight Billed
 PAR.WEEKLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES WK  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857385;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.WEEKLY_SALES);
 PARAMETER(PAR.WEEKLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES WK  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857386;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
 }

 ENDIF;

 //?UPD: Month
 CASE;

 // IF PAR.Period Type USR is Month
 IF PAR.Period_Type_USR = 'M';

 // PAR.MONTHLY SALES = LCL.Billing Detail Cost Dol.
 PAR.MONTHLY_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.MONTHLY UNITS = LCL.Weight Billed
 PAR.MONTHLY_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES MO  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857388;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.MONTHLY_SALES);
 PARAMETER(PAR.MONTHLY_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES MO  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857389;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
 }

 ENDIF;

 //?UPD: Quarter
 CASE;

 // IF PAR.Period Type USR is Quarter
 IF PAR.Period_Type_USR = 'Q';

 // PAR.QUARTER SALES = LCL.Billing Detail Cost Dol.
 PAR.QUARTER_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.QUARTER UNITS = LCL.Weight Billed
 PAR.QUARTER_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES QT  Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1857391;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.QUARTER_SALES);
 PARAMETER(PAR.QUARTER_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES QT  Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1857392;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
 }

 ENDIF;

 //?UPD: YTD
 CASE;

 // IF PAR.Period Type USR is Year
 IF PAR.Period_Type_USR = 'Y';

 // PAR.Y-T-D SALES = LCL.Billing Detail Cost Dol.
 PAR.Y_T_D_SALES = LCL.Billing_Detail_Cost_Dol;

 // PAR.Y-T-D UNITS = LCL.Weight Billed
 PAR.Y_T_D_UNITS = LCL.Weight_Billed;

 EXECUTE FUNCTION(Upd JRSALES YTD Sales RT) TYPE(RTVOBJ) FILE(JRSALES)           AC1856900;
 PARAMETER(PAR.PRODUCT_CODE);
 PARAMETER(PAR.TERRITORY);
 PARAMETER(PAR.Y_T_D_SALES);
 PARAMETER(PAR.Y_T_D_UNITS);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(Crt JRSALES Sales     CR) TYPE(CRTOBJ) FILE(JRSALES)           AC1856897;
  PARAMETER(PAR.PRODUCT_CODE);
  PARAMETER(PAR.TERRITORY);
  PARAMETER(PAR.WEEKLY_SALES);
  PARAMETER(PAR.WEEKLY_UNITS);
  PARAMETER(PAR.WEEKLY_DISCOUNTS);
  PARAMETER(PAR.WEEKLY_CREDITS);
  PARAMETER(PAR.MONTHLY_SALES);
  PARAMETER(PAR.MONTHLY_UNITS);
  PARAMETER(PAR.MONTHLY_DISCOUNTS);
  PARAMETER(PAR.MONTHLY_CREDITS);
  PARAMETER(PAR.QUARTER_SALES);
  PARAMETER(PAR.QUARTER_UNITS);
  PARAMETER(PAR.QUARTER_DISCOUNTS);
  PARAMETER(PAR.QUARTER_CREDITS);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
  PARAMETER(PAR.Y_T_D_DISCOUNTS);
  PARAMETER(PAR.Y_T_D_CREDITS);
  PARAMETER(PAR.DELETE_D);
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg JRSALES YTD Sales CH) TYPE(CHGOBJ) FILE(JRSALES)           AC1856901;
  PARAMETER(DB1.PRODUCT_CODE);
  PARAMETER(DB1.TERRITORY);
  PARAMETER(PAR.Y_T_D_SALES);
  PARAMETER(PAR.Y_T_D_UNITS);
 }

 ENDIF;

}


