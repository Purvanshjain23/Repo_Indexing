     H/TITLE Edt Enter Rcpts/Strup  PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/26/24  Time  : 12:12:12
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FICQLPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Enter Rcpts/Strup  PV Prompt & validate record
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FCAEFREL1IF  E           K        DISK
      * RTV : Reason Codes              Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAMREL3IF  E           K        DISK
      * RTV : Unit of Measure           Active Records
      *
     FCAEFREL2IF  E           K        DISK
      * RTV : Reason Codes              Rtv Active Reason Codes
      *
     FCADVREL2IF  E           K        DISK
      * RTV : Reference Number Master   Active Only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     E                    #L7         7  1
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 022  5 0A
     E                    W0END   7 022  5 0A
     E                    W0NAM   7 022 10
      * Long constants
     E                    @CN#    1  11  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WBAIC3
     I              B7HGCD                          WBHGCD
     I              B7AJCD                          WBAJCD
     I              B7W9ST                          WBW9ST
     I              B7BSST                          WBBSST
     I              B7B4DT                          WBB4DT
     I              B7C4NY                          WBC4NY
     I              B7DXNB                          WBDXNB
     I              B7ELDT                          WBELDT
     I              B7HVCD                          WBHVCD
     I              B7F1ST                          WBF1ST
     I              B7AUNA                          WBAUNA
     I              B7A5QT                          WBA5QT
     I              B7AHWG                          WBAHWG
     I              B7AKCS                          WBAKCS
     I              B7CGCD                          WBCGCD
     I              B7AYVA                          WBAYVA
     I              B7BJNA                          WBBJNA
     I              B7CKNB                          WBCKNB
     I              B7BMST                          WBBMST
     I              B7CQCD                          WBCQCD
     I              B7DTCD                          WBDTCD
     I              B7MGNA                          WBMGNA
     I              B7TRBN                          WBTRBN
     I              B7TRBS                          WBTRBS
     I              B7C4NB                          WBC4NB
     I              B7RINB                          WBRINB
     I              B7RHNB                          WBRHNB
     I              B7RGNB                          WBRGNB
     I              B7M3NA                          WBM3NA
     I              B7AWTM                          WBAWTM
     I              B7XLCD                          WBXLCD
     I              B7K7DT                          WBK7DT
     I              B7UVST                          WBUVST
     I              B7UWST                          WBUWST
     I              B7UXST                          WBUXST
     I              B7VSST                          WBVSST
     I              B7AATM                          WBAATM
     I              B7AYNA                          WBAYNA
     I              B7A0NA                          WBA0NA
     I              B7AXDT                          WBAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7C4NY                          WCC4NY
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WDAIC3
     I              B7HGCD                          WDHGCD
     I              B7AJCD                          WDAJCD
     I              B7W9ST                          WDW9ST
     I              B7BSST                          WDBSST
     I              B7B4DT                          WDB4DT
     I              B7C4NY                          WDC4NY
     I              B7DXNB                          WDDXNB
     I              B7ELDT                          WDELDT
     I              B7HVCD                          WDHVCD
     I              B7F1ST                          WDF1ST
     I              B7AUNA                          WDAUNA
     I              B7A5QT                          WDA5QT
     I              B7AHWG                          WDAHWG
     I              B7AKCS                          WDAKCS
     I              B7CGCD                          WDCGCD
     I              B7AYVA                          WDAYVA
     I              B7BJNA                          WDBJNA
     I              B7CKNB                          WDCKNB
     I              B7BMST                          WDBMST
     I              B7CQCD                          WDCQCD
     I              B7DTCD                          WDDTCD
     I              B7MGNA                          WDMGNA
     I              B7TRBN                          WDTRBN
     I              B7TRBS                          WDTRBS
     I              B7C4NB                          WDC4NB
     I              B7RINB                          WDRINB
     I              B7RHNB                          WDRHNB
     I              B7RGNB                          WDRGNB
     I              B7M3NA                          WDM3NA
     I              B7AWTM                          WDAWTM
     I              B7XLCD                          WDXLCD
     I              B7K7DT                          WDK7DT
     I              B7UVST                          WDUVST
     I              B7UWST                          WDUWST
     I              B7UXST                          WDUXST
     I              B7VSST                          WDVSST
     I              B7AATM                          WDAATM
     I              B7AYNA                          WDAYNA
     I              B7A0NA                          WDA0NA
     I              B7AXDT                          WDAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WFAIC3
     I              B0HGCD                          WFHGCD
     I              B0AJCD                          WFAJCD
     I              B0AGCS                          WFAGCS
     I              B0AECS                          WFAECS
     I              B0BACS                          WFBACS
     I              B0BBCS                          WFBBCS
     I              B0CBPR                          WFCBPR
     I              B0GUDT                          WFGUDT
     I              B0XYST                          WFXYST
     I              B0CTPR                          WFCTPR
     I              B0G4DT                          WFG4DT
     I              B0BOWG                          WFBOWG
     I              B0DDQT                          WFDDQT
     I              B0DEQT                          WFDEQT
     I              B0DFQT                          WFDFQT
     I              B0HDQT                          WFHDQT
     I              B0HEQT                          WFHEQT
     I              B0AJQT                          WFAJQT
     I              B0AQQT                          WFAQQT
     I              B0AUQT                          WFAUQT
     I              B0EMQT                          WFEMQT
     I              B0DOQT                          WFDOQT
     I              B0ATNA                          WFATNA
     I              B0AKDT                          WFAKDT
     I              B0ANDT                          WFANDT
     I              B0IDVA                          WFIDVA
     I              B0JVST                          WFJVST
     I              B0BZPC                          WFBZPC
     I              B0DGQT                          WFDGQT
     I              B0DIDT                          WFDIDT
     I              B0ALCD                          WFALCD
     I              B0BFDY                          WFBFDY
     I              B0DJDT                          WFDJDT
     I              B0BGDY                          WFBGDY
     I              B0DKDT                          WFDKDT
     I              B0J2ST                          WFJ2ST
     I              B0DJQT                          WFDJQT
     I              B0BNWG                          WFBNWG
     I              B0DLDT                          WFDLDT
     I              B0DPQT                          WFDPQT
     I              B0DQQT                          WFDQQT
     I              B0DMDT                          WFDMDT
     I              B0M0ST                          WFM0ST
     I              B0J9ST                          WFJ9ST
     I              B0KBST                          WFKBST
     I              B0AKC8                          WFAKC8
     I              B0RINB                          WFRINB
     I              B0RHNB                          WFRHNB
     I              B0RGNB                          WFRGNB
     I              B0UVST                          WFUVST
     I              B0UWST                          WFUWST
     I              B0UXST                          WFUXST
     I              B0VSST                          WFVSST
     I              B0AATM                          WFAATM
     I              B0AYNA                          WFAYNA
     I              B0A0NA                          WFA0NA
     I              B0AXDT                          WFAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WKAJCD
     I              L2YMCD                          WKYMCD
     I              L2YPCD                          WKYPCD
     I              L2LCBY                          WKLCBY
     I              L2LCCT                          WKLCCT
     I              L2WLUS                          WKWLUS
     I              L2WUSD                          WKWUSD
     I              L2WLUN                          WKWLUN
     I              L2AGSX                          WKAGSX
     I              L2UVST                          WKUVST
     I              L2UWST                          WKUWST
     I              L2UXST                          WKUXST
     I              L2VSST                          WKVSST
     I              L2AATM                          WKAATM
     I              L2AYNA                          WKAYNA
     I              L2A0NA                          WKA0NA
     I              L2AXDT                          WKAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WLDOCD
     I              DPAUNA                          WLAUNA
     I              DPI5ST                          WLI5ST
     I              DPBXTX                          WLBXTX
     I              DPM8NB                          WLM8NB
     I              DPUVST                          WLUVST
     I              DPUWST                          WLUWST
     I              DPUXST                          WLUXST
     I              DPVSST                          WLVSST
     I              DPAATM                          WLAATM
     I              DPAYNA                          WLAYNA
     I              DPA0NA                          WLA0NA
     I              DPAXDT                          WLAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WMAJVN
     I              DRAUNA                          WMAUNA
     I              DRB8NA                          WMB8NA
     I              DRAHVN                          WMAHVN
     I              DRI6ST                          WMI6ST
     I              DRI7ST                          WMI7ST
     I              DRXMST                          WMXMST
     I              DRXNST                          WMXNST
     I              DRI8ST                          WMI8ST
     I              DRNLNB                          WMNLNB
     I              DRMPNA                          WMMPNA
     I              DRBCCD                          WMBCCD
     I              DRAIC3                          WMAIC3
     I              DRDQCD                          WMDQCD
     I              DRDRCD                          WMDRCD
     I              DRAJCD                          WMAJCD
     I              DRBUVN                          WMBUVN
     I              DRUVST                          WMUVST
     I              DRUWST                          WMUWST
     I              DRUXST                          WMUXST
     I              DRAATM                          WMAATM
     I              DRAYNA                          WMAYNA
     I              DRA0NA                          WMA0NA
     I              DRAXDT                          WMAXDT
      *
     I@L1RESJ
      * User Warehouse Access     Retrieval index
      * Renamed input format fields
     I              L1AJVN                          WOAJVN
     I              L1AJCD                          WOAJCD
     I              L1UWAS                          WOUWAS
     I              L1EPSX                          WOEPSX
     I              L1EQSX                          WOEQSX
     I              L1ERSX                          WOERSX
     I              L1UWAT                          WOUWAT
     I              L1EKSX                          WOEKSX
     I              L1ECSX                          WOECSX
     I              L1EDSX                          WOEDSX
     I              L1EESX                          WOEESX
     I              L1EFSX                          WOEFSX
     I              L1EGSX                          WOEGSX
     I              L1EHSX                          WOEHSX
     I              L1EISX                          WOEISX
     I              L1EJSX                          WOEJSX
     I              L1UWAU                          WOUWAU
     I              L1ELSX                          WOELSX
     I              L1EMSX                          WOEMSX
     I              L1ENSX                          WOENSX
     I              L1EOSX                          WOEOSX
     I              L1UVST                          WOUVST
     I              L1UWST                          WOUWST
     I              L1UXST                          WOUXST
     I              L1VSST                          WOVSST
     I              L1AATM                          WOAATM
     I              L1AYNA                          WOAYNA
     I              L1A0NA                          WOA0NA
     I              L1AXDT                          WOAXDT
      *
     I@EFREV2
      * Reason Codes              Retrieval index       NV
      * Renamed input format fields
     I              EFCQCD                          WRCQCD
     I              EFAUNA                          WRAUNA
     I              EFUVST                          WRUVST
     I              EFUWST                          WRUWST
     I              EFUXST                          WRUXST
     I              EFVSST                          WRVSST
     I              EFAATM                          WRAATM
     I              EFAYNA                          WRAYNA
     I              EFA0NA                          WRA0NA
     I              EFAXDT                          WRAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WSAIC3
     I              AFBCDT                          WSBCDT
     I              AFCQNB                          WSCQNB
     I              AFESNB                          WSESNB
     I              AFETNB                          WSETNB
     I              AFBZNB                          WSBZNB
     I              AFA9ST                          WSA9ST
     I              AFEINB                          WSEINB
     I              AFC5ST                          WSC5ST
     I              AFAQNB                          WSAQNB
     I              AFCMST                          WSCMST
     I              AFV9ST                          WSV9ST
     I              AFWAST                          WSWAST
     I              AFX2ST                          WSX2ST
     I              AFOJDT                          WSOJDT
     I              AFNQNX                          WSNQNX
     I              AFNRNX                          WSNRNX
     I              AFI9SX                          WSI9SX
     I              AFJASX                          WSJASX
     I              AFOKDT                          WSOKDT
     I              AFOLDT                          WSOLDT
     I              AFUVST                          WSUVST
     I              AFUWST                          WSUWST
     I              AFUXST                          WSUXST
     I              AFAATM                          WSAATM
     I              AFAYNA                          WSAYNA
     I              AFA0NA                          WSA0NA
     I              AFAXDT                          WSAXDT
      *
     I@AMREU9
      * Unit of Measure           Active Records
      * Renamed input format fields
     I              AMHHCD                          WTHHCD
     I              AMAUNA                          WTAUNA
     I              AMUVST                          WTUVST
     I              AMUWST                          WTUWST
     I              AMUXST                          WTUXST
     I              AMVSST                          WTVSST
     I              AMAATM                          WTAATM
     I              AMAYNA                          WTAYNA
     I              AMA0NA                          WTA0NA
     I              AMAXDT                          WTAXDT
      *
     I@EFREU4
      * Reason Codes              Rtv Active Reason Codes
      * Renamed input format fields
     I              EFCQCD                          WVCQCD
     I              EFAUNA                          WVAUNA
     I              EFUVST                          WVUVST
     I              EFUWST                          WVUWST
     I              EFUXST                          WVUXST
     I              EFVSST                          WVVSST
     I              EFAATM                          WVAATM
     I              EFAYNA                          WVAYNA
     I              EFA0NA                          WVA0NA
     I              EFAXDT                          WVAXDT
      *
     I@DVREWC
      * Reference Number Master   Active Only
      * Renamed input format fields
     I              DVAIC3                          WWAIC3
     I              DVDTCD                          WWDTCD
     I              DVBZTX                          WWBZTX
     I              DVUVST                          WWUVST
     I              DVUWST                          WWUWST
     I              DVUXST                          WWUXST
     I              DVVSST                          WWVSST
     I              DVAATM                          WWAATM
     I              DVAYNA                          WWAYNA
     I              DVA0NA                          WWA0NA
     I              DVAXDT                          WWAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WXAIC3
     I              BEC4NB                          WXC4NB
     I              BEJNCD                          WXJNCD
     I              BEANC7                          WXANC7
     I              BEBKC7                          WXBKC7
     I              BEBRTX                          WXBRTX
     I              BEHMNA                          WXHMNA
     I              BEHONA                          WXHONA
     I              BEHPNA                          WXHPNA
     I              BEHNNA                          WXHNNA
     I              BEDBCD                          WXDBCD
     I              BECKTX                          WXCKTX
     I              BEB0C7                          WXB0C7
     I              BEAETX                          WXAETX
     I              BEB1NA                          WXB1NA
     I              BEB3NA                          WXB3NA
     I              BEB4NA                          WXB4NA
     I              BEB2NA                          WXB2NA
     I              BEBHCD                          WXBHCD
     I              BEC8TX                          WXC8TX
     I              BEBCNA                          WXBCNA
     I              BEA0DT                          WXA0DT
     I              BEA5DT                          WXA5DT
     I              BEGNDT                          WXGNDT
     I              BEACDT                          WXACDT
     I              BEAQCD                          WXAQCD
     I              BEB6NA                          WXB6NA
     I              BEBYNA                          WXBYNA
     I              BEBZNA                          WXBZNA
     I              BEGTST                          WXGTST
     I              BEGVST                          WXGVST
     I              BEGUST                          WXGUST
     I              BEQFST                          WXQFST
     I              BECQCD                          WXCQCD
     I              BEGJST                          WXGJST
     I              BEGWST                          WXGWST
     I              BEGXST                          WXGXST
     I              BEGYST                          WXGYST
     I              BEAODT                          WXAODT
     I              BEAIVN                          WXAIVN
     I              BECXDT                          WXCXDT
     I              BEJZVA                          WXJZVA
     I              BEA1WG                          WXA1WG
     I              BEXIST                          WXXIST
     I              BEXJST                          WXXJST
     I              BEXKST                          WXXKST
     I              BEEIDT                          WXEIDT
     I              BEAFTM                          WXAFTM
     I              BEE8CD                          WXE8CD
     I              BEE9CD                          WXE9CD
     I              BERMNB                          WXRMNB
     I              BETBNB                          WXTBNB
     I              BER1NB                          WXR1NB
     I              BEPJST                          WXPJST
     I              BEU0ST                          WXU0ST
     I              BEU1ST                          WXU1ST
     I              BEQ2CD                          WXQ2CD
     I              BEU2ST                          WXU2ST
     I              BEVEST                          WXVEST
     I              BEVFST                          WXVFST
     I              BEVGST                          WXVGST
     I              BERPCD                          WXRPCD
     I              BERNNB                          WXRNNB
     I              BEVDST                          WXVDST
     I              BEATIN                          WXATIN
     I              BEU4ST                          WXU4ST
     I              BEU5ST                          WXU5ST
     I              BERSRN                          WXRSRN
     I              BEMHNA                          WXMHNA
     I              BEMINA                          WXMINA
     I              BEWBST                          WXWBST
     I              BER4CD                          WXR4CD
     I              BEBFCD                          WXBFCD
     I              BEQ4CD                          WXQ4CD
     I              BET3NB                          WXT3NB
     I              BESICD                          WXSICD
     I              BECONB                          WXCONB
     I              BECEST                          WXCEST
     I              BEAWDT                          WXAWDT
     I              BEJPCD                          WXJPCD
     I              BEXUST                          WXXUST
     I              BEZ1ST                          WXZ1ST
     I              BEVRVA                          WXVRVA
     I              BEOBST                          WXOBST
     I              BEBCST                          WXBCST
     I              BEBDST                          WXBDST
     I              BEB7VL                          WXB7VL
     I              BEGASX                          WXGASX
     I              BEGBSX                          WXGBSX
     I              BEGCSX                          WXGCSX
     I              BEGDSX                          WXGDSX
     I              BEFNSX                          WXFNSX
     I              BEFOSX                          WXFOSX
     I              BEFPSX                          WXFPSX
     I              BEFQSX                          WXFQSX
     I              BEFRSX                          WXFRSX
     I              BEFSSX                          WXFSSX
     I              BEFTSX                          WXFTSX
     I              BEFUSX                          WXFUSX
     I              BEFVSX                          WXFVSX
     I              BEFWSX                          WXFWSX
     I              BEFXSX                          WXFXSX
     I              BEFYSX                          WXFYSX
     I              BENODT                          WXNODT
     I              BENPDT                          WXNPDT
     I              BENQDT                          WXNQDT
     I              BENRDT                          WXNRDT
     I              BENSDT                          WXNSDT
     I              BEBPTM                          WXBPTM
     I              BEBQTM                          WXBQTM
     I              BEBRTM                          WXBRTM
     I              BEBSTM                          WXBSTM
     I              BEBTTM                          WXBTTM
     I              BEH0NX                          WXH0NX
     I              BEH1NX                          WXH1NX
     I              BEH2NX                          WXH2NX
     I              BEH3NX                          WXH3NX
     I              BEH4NX                          WXH4NX
     I              BEC0C7                          WXC0C7
     I              BEUVST                          WXUVST
     I              BEUWST                          WXUWST
     I              BEUXST                          WXUXST
     I              BEAATM                          WXAATM
     I              BEAYNA                          WXAYNA
     I              BEA0NA                          WXA0NA
     I              BEAXDT                          WXAXDT
      *
     I@FAREBE
      * Item Structure Class      Retrieval index
      * Renamed input format fields
     I              FARINB                          WYRINB
     I              FARHNB                          WYRHNB
     I              FADETX                          WYDETX
     I              FAUVST                          WYUVST
     I              FAUWST                          WYUWST
     I              FAUXST                          WYUXST
     I              FAVSST                          WYVSST
     I              FAAATM                          WYAATM
     I              FAAYNA                          WYAYNA
     I              FAA0NA                          WYA0NA
     I              FAAXDT                          WYAXDT
      *
     I@E9REA8
      * Item Structure Group      Retrieval index
      * Renamed input format fields
     I              E9RHNB                          TARHNB
     I              E9RGNB                          TARGNB
     I              E9DDTX                          TADDTX
     I              E9UVST                          TAUVST
     I              E9UWST                          TAUWST
     I              E9UXST                          TAUXST
     I              E9VSST                          TAVSST
     I              E9AATM                          TAAATM
     I              E9AYNA                          TAAYNA
     I              E9A0NA                          TAA0NA
     I              E9AXDT                          TAAXDT
      *
     I@E8REBB
      * Item Structure Type       Retrieval index
      * Renamed input format fields
     I              E8RGNB                          TBRGNB
     I              E8DCTX                          TBDCTX
     I              E8UVST                          TBUVST
     I              E8UWST                          TBUWST
     I              E8UXST                          TBUXST
     I              E8VSST                          TBVSST
     I              E8AATM                          TBAATM
     I              E8AYNA                          TBAYNA
     I              E8A0NA                          TBA0NA
     I              E8AXDT                          TBAXDT
      *
     I@AMREB0
      * Unit of Measure           Retrieval index       NV
      * Renamed input format fields
     I              AMHHCD                          TCHHCD
     I              AMAUNA                          TCAUNA
     I              AMUVST                          TCUVST
     I              AMUWST                          TCUWST
     I              AMUXST                          TCUXST
     I              AMVSST                          TCVSST
     I              AMAATM                          TCAATM
     I              AMAYNA                          TCAYNA
     I              AMA0NA                          TCA0NA
     I              AMAXDT                          TCAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          TDAJCD
     I              ADF8NA                          TDF8NA
     I              ADACNA                          TDACNA
     I              ADADNA                          TDADNA
     I              ADAENA                          TDAENA
     I              ADAJNA                          TDAJNA
     I              ADBTTX                          TDBTTX
     I              ADAOCD                          TDAOCD
     I              ADBGCD                          TDBGCD
     I              ADVHST                          TDVHST
     I              ADMPNA                          TDMPNA
     I              ADWPST                          TDWPST
     I              ADXUST                          TDXUST
     I              ADT0ST                          TDT0ST
     I              ADT1ST                          TDT1ST
     I              ADDBNB                          TDDBNB
     I              ADT2ST                          TDT2ST
     I              ADT3ST                          TDT3ST
     I              ADT4ST                          TDT4ST
     I              ADT6ST                          TDT6ST
     I              ADBWC3                          TDBWC3
     I              ADBTC3                          TDBTC3
     I              ADBUC3                          TDBUC3
     I              ADBVC3                          TDBVC3
     I              ADFCAA                          TDFCAA
     I              ADRQSX                          TDRQSX
     I              ADRRSX                          TDRRSX
     I              ADRSSX                          TDRSSX
     I              ADRTSX                          TDRTSX
     I              ADT7ST                          TDT7ST
     I              ADT8ST                          TDT8ST
     I              ADRNSX                          TDRNSX
     I              ADROSX                          TDROSX
     I              ADRPSX                          TDRPSX
     I              ADUVST                          TDUVST
     I              ADUWST                          TDUWST
     I              ADUXST                          TDUXST
     I              ADVSST                          TDVSST
     I              ADAATM                          TDAATM
     I              ADAYNA                          TDAYNA
     I              ADA0NA                          TDA0NA
     I              ADAXDT                          TDAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          TEDNCD
     I              DNAUNA                          TEAUNA
     I              DNVKST                          TEVKST
     I              DNRSCD                          TERSCD
     I              DNUVST                          TEUVST
     I              DNUWST                          TEUWST
     I              DNUXST                          TEUXST
     I              DNAATM                          TEAATM
     I              DNAYNA                          TEAYNA
     I              DNA0NA                          TEA0NA
     I              DNAXDT                          TEAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          TFB3AB
     I              C6HUNZ                          TFHUNZ
     I              C6OCSC                          TFOCSC
     I              C6UNU1                          TFUNU1
     I              C6VSST                          TFVSST
     I              C6BGTS                          TFBGTS
     I              C6RUU1                          TFRUU1
     I              C6RVU1                          TFRVU1
     I              C6BHTS                          TFBHTS
     I              C6RWU1                          TFRWU1
     I              C6RXU1                          TFRXU1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7C4NY                          WCC4NY
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WFAIC3
     I              B0HGCD                          WFHGCD
     I              B0AJCD                          WFAJCD
     I              B0AGCS                          WFAGCS
     I              B0AECS                          WFAECS
     I              B0BACS                          WFBACS
     I              B0BBCS                          WFBBCS
     I              B0CBPR                          WFCBPR
     I              B0GUDT                          WFGUDT
     I              B0XYST                          WFXYST
     I              B0CTPR                          WFCTPR
     I              B0G4DT                          WFG4DT
     I              B0BOWG                          WFBOWG
     I              B0DDQT                          WFDDQT
     I              B0DEQT                          WFDEQT
     I              B0DFQT                          WFDFQT
     I              B0HDQT                          WFHDQT
     I              B0HEQT                          WFHEQT
     I              B0AJQT                          WFAJQT
     I              B0AQQT                          WFAQQT
     I              B0AUQT                          WFAUQT
     I              B0EMQT                          WFEMQT
     I              B0DOQT                          WFDOQT
     I              B0ATNA                          WFATNA
     I              B0AKDT                          WFAKDT
     I              B0ANDT                          WFANDT
     I              B0IDVA                          WFIDVA
     I              B0JVST                          WFJVST
     I              B0BZPC                          WFBZPC
     I              B0DGQT                          WFDGQT
     I              B0DIDT                          WFDIDT
     I              B0ALCD                          WFALCD
     I              B0BFDY                          WFBFDY
     I              B0DJDT                          WFDJDT
     I              B0BGDY                          WFBGDY
     I              B0DKDT                          WFDKDT
     I              B0J2ST                          WFJ2ST
     I              B0DJQT                          WFDJQT
     I              B0BNWG                          WFBNWG
     I              B0DLDT                          WFDLDT
     I              B0DPQT                          WFDPQT
     I              B0DQQT                          WFDQQT
     I              B0DMDT                          WFDMDT
     I              B0M0ST                          WFM0ST
     I              B0J9ST                          WFJ9ST
     I              B0KBST                          WFKBST
     I              B0AKC8                          WFAKC8
     I              B0RINB                          WFRINB
     I              B0RHNB                          WFRHNB
     I              B0RGNB                          WFRGNB
     I              B0UVST                          WFUVST
     I              B0UWST                          WFUWST
     I              B0UXST                          WFUXST
     I              B0VSST                          WFVSST
     I              B0AATM                          WFAATM
     I              B0AYNA                          WFAYNA
     I              B0A0NA                          WFA0NA
     I              B0AXDT                          WFAXDT
      *
     IYARDCS      DS                            245
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     IYBRDCS      DS                            163
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPBRC        DS                              9
      * KEY : Item Balance              Co/Whse/Item
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Warehouse Code
     I                                        3   5 PBAJCD
      * B : MAP Item Code
     I                                    P   6   90PBHGCD
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Warehouse Codes
      * B : MAP Warehouse Code
     I                                        1   3 P1AJCD
      * N : MAP Warehouse Description
     I                                        4  33 P1F8NA
      * N :  Trans Contol AS400_Plant
     I                                       34  34 P1XUST
      * N :  WHS Live with Carlisle
     I                                       35  35 P1RRSX
      * N :  WHS PFS Interface
     I                                       36  36 P1RSSX
     IP2PARM      DS
      * FLD: Company Item
      * N : MAP Description Line One
     I                                        1  30 P2AVNA
      * N :  Description Line Two
     I                                       31  60 P2AWNA
      * N :  UOM Primary
     I                                       61  62 P2ADCD
      * N :  Conversion Factor 1
     I                                    P  63  674P2AWPC
      * N :  Operation Factor 1
     I                                       68  68 P2LXST
      * N :  UOM Second
     I                                       69  70 P2AECD
      * N :  Conversion Factor 2
     I                                    P  71  754P2AXPC
      * N :  Operation Factor 2
     I                                       76  76 P2LYST
      * N :  UOM Third
     I                                       77  78 P2AFCD
      * N :  UOM Pricing
     I                                       79  80 P2AICD
      * N :  Unit Weight
     I                                    P  81  862P2AIWG
      * N :  Production Date Control
     I                                       87  87 P2FZST
      * N :  Catch Weight Status
     I                                       88  88 P2AVST
      * N :  Item Structure Class Code
     I                                    P  89  900P2RINB
      * N :  Item Structure Group Code
     I                                    P  91  920P2RHNB
      * N :  Item Structure Type Code
     I                                    P  93  940P2RGNB
      * N :  Default Commod Mark basis
     I                                       95  97 P2LNCD
      * N :  Price Method Default
     I                                       98 100 P2Q8CD
     IP3PARM      DS
      * FLD: Item Transaction Detail
      * I : MAP Company Number
     I                                    P   1   20P3AIC3
      * I :  Inventory Trans ID
     I                                        3   3 P3W9ST
      * I :  Inventory Trans Type
     I                                        4   5 P3BSST
      * I : MAP Transaction Date Code
     I                                    P   6   90P3B4DT
      * N :  GL Update Status
     I                                       10  10 P3BMST
     IP4PARM      DS
      * I : MAP USR Hold Description
     I                                        1  30 P4CUNA
     IP5PARM      DS
      * I : MAP Name
     I                                        1  30 P5ADTX
     IP6PARM      DS
      * FLD: Item Balance
      * N :  Revaluation Cost
     I                                    P   1   64P6CBPR
      * N :  Cost Update Pending
     I                                        7   7 P6J9ST
      * N :  Post GL Status
     I                                        8   8 P6KBST
      * N :  Vendor Item_Whse Default
     I                                    P   9  130P6AKC8
      * N :  Record Status
     I                                       14  14 P6VSST
     IP7PARM      DS
      * FLD: STR Quantity/Price Convrt
      * N :  Cost based on U/M1 S
     I                                    P   1   64P7ANCS
      * N :  Cost based on U/M2 S
     I                                    P   7  124P7AOCS
      * N :  Cost based on U/M3 S
     I                                    P  13  184P7APCS
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Last item processed'
      * @Item Code
     I                                        1   7 ZA0001
      * Message data for 'Last item not processed'
      * @Item Code
     I                                        1   7 ZA0002
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0003
      * Warehouse Code
     I                                       11  13 ZA0004
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0005
      * Condition Name USR
     I                                       11  35 ZA0006
      * Warehouse Code
     I                                       36  38 ZA0007
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0008
      * Condition Name USR
     I                                       11  35 ZA0009
      * Warehouse Code
     I                                       36  38 ZA0010
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0011
      * Condition Name USR
     I                                       11  35 ZA0012
      * Warehouse Code
     I                                       36  38 ZA0013
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0014
      * Condition Name USR
     I                                       11  35 ZA0015
      * Warehouse Code
     I                                       36  38 ZA0016
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0017
      * Condition Name USR
     I                                       11  35 ZA0018
      * Warehouse Code
     I                                       36  38 ZA0019
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0020
      * Condition Name USR
     I                                       11  35 ZA0021
      * Warehouse Code
     I                                       36  38 ZA0022
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0023
      * Condition Name USR
     I                                       11  35 ZA0024
      * Warehouse Code
     I                                       36  38 ZA0025
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0026
      * Condition Name USR
     I                                       11  35 ZA0027
      * Warehouse Code
     I                                       36  38 ZA0028
      * Message data for 'PFS ctrld can't be used'
      * Warehouse Code
     I                                        1   3 ZA0029
      * Message data for 'Warehouse not found'
      * Message data for 'Prod Date must be entered'
      * Production Date
     I                                    P   1   40ZA0030
      * Message data for 'Label Date must be enterd'
      * Label Date
     I                                    P   1   40ZA0031
      * Message data for 'Label Date < Prod Date'
      * Label Date
     I                                    P   1   40ZA0032
      * Message data for 'Date In Cannot Be < 2yrs'
      * Generic Message 80 USR
     I                                        1  80 ZA0033
      * Date In  (7,0) USR
     I                                    P  81  840ZA0034
      * Message data for 'Date In Cannot Be < 2yrs'
      * Generic Message 80 USR
     I                                        1  80 ZA0035
      * Date In  (7,0) USR
     I                                    P  81  840ZA0036
      * Message data for 'Prod Date must be blank'
      * Production Date
     I                                    P   1   40ZA0037
      * Message data for 'Label Date must be blank'
      * Label Date
     I                                    P   1   40ZA0038
      * Message data for 'Item not found'
      * Message data for 'Item blance is not active'
      * Item Code
     I                                        1   7 ZA0039
      * Warehouse Code
     I                                        8  10 ZA0040
      * Message data for 'Item Balance           NF'
      * Company Number
     I                                        1   3 ZA0041
      * Item Code
     I                                        4  10 ZA0042
      * Warehouse Code
     I                                       11  13 ZA0043
      * Message data for 'Unit measure not on item'
      * UOM Primary
     I                                        1   2 ZA0044
      * UOM Second
     I                                        3   4 ZA0045
      * UOM Third
     I                                        5   6 ZA0046
      * Message data for 'Quantity cannot be neg.'
      * Message data for 'Transaction wgt must be +'
      * Message data for 'Quantity cannot be pos.'
      * Message data for 'Transaction wgt must be -'
      * Message data for 'Transaction sign mismatch'
      * Message data for 'Transaction sign mismatch'
      * Message data for 'Incorrect Label Date ent'
      * Production Date
     I                                    P   1   40ZA0047
      * Message data for 'Lot Number Required f/Whs'
      * Lot Number
     I                                    P   1   30ZA0048
      * Warehouse Code
     I                                        4   6 ZA0049
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM P1AJCD    WP0001  3        Warehouse Code
     C           P3AIC3    PARM           WP0002  30       Company Number
     C           P3W9ST    PARM           WP0003  1        Inventory Trans
     C           P3BSST    PARM           WP0004  2        Inventory Trans
     C           P3B4DT    PARM           WP0005  70       Transaction Dat
     C           P4CUNA    PARM           WP0006 30        USR Hold Descri
     C           P5ADTX    PARM           WP0007 30        Name
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Create transaction in IC Transaction Detail file
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
     C                     EXSR SARVGN
     C           #1AKCS    MULT #1AHWG    #1AYVA    H      Extended Amount
      * 08/14/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'P'                        *OR
      * 09/27/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       YL0002           Inventory Updat
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     Z-ADD#1HGCD    WL0002           Item Code
     C                     MOVEL#1AJCD    WL0003    P      Warehouse Code
     C                     MOVELP3W9ST    WL0004    P      Inventory Trans
     C                     MOVELP3BSST    WL0005    P      Inventory Trans
     C                     Z-ADD#1B4DT    WL0006           Transaction Dat
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    #1C4NY           ITD Sequence Nu
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     Z-ADD#1HGCD    WL0009           Item Code
     C                     MOVEL#1AJCD    WL0010    P      Warehouse Code
     C                     MOVELP3W9ST    WL0011    P      Inventory Trans
     C                     MOVELP3BSST    WL0012    P      Inventory Trans
     C                     Z-ADD#1B4DT    WL0013           Transaction Dat
     C                     Z-ADD#1C4NY    WL0014           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0015           Sequence Number
     C                     Z-ADD#1ELDT    WL0016           Production Date
     C                     MOVEL#1HVCD    WL0017    P      UOM Transaction
     C                     MOVEL'IC'      WL0018    P      Item Transactio
     C                     MOVEL#1AUNA    WL0019    P      Description
     C                     Z-ADD#1A5QT    WL0020           Transaction Qua
     C                     Z-ADD#1AHWG    WL0021           Transaction Wei
     C                     Z-ADD#1AKCS    WL0022           USR Transaction
     C                     MOVEL#1HVCD    WL0023    P      UOM Cost
     C                     Z-ADD#1AYVA    WL0024           Extended Amount
     C                     MOVEL*BLANK    WL0025           Ticket Number
     C                     Z-ADD*ZERO     WL0026           GL Document Num
     C                     MOVEL*BLANK    WL0027           GL Update Statu
     C                     MOVEL#1CQCD    WL0028    P      Reason Code
     C                     MOVEL*BLANK    WL0029           Reference Numbe
     C                     MOVEL#1MGNA    WL0030    P      Lot ID
     C                     Z-ADD*ZERO     WL0031           Transfer Batch
     C                     Z-ADD*ZERO     WL0032           Transfer Batch
     C                     Z-ADD*ZERO     WL0033           Order Number
     C                     Z-ADDP2RINB    WL0034           Item Structure
     C                     Z-ADDP2RHNB    WL0035           Item Structure
     C                     Z-ADDP2RGNB    WL0036           Item Structure
     C                     MOVEL*BLANK    WL0037           Employee Badge
     C                     Z-ADD#1AWTM    WL0038           Production Time
     C                     MOVEL#1XLCD    WL0039    P      Shift Number
     C                     Z-ADD#1K7DT    WL0040           Label Date
     C                     MOVEL#1UVST    WL0041    P      EDI Status 1
     C                     MOVEL#1UWST    WL0042    P      EDI Status 2
     C                     MOVEL#1UXST    WL0043    P      EDI Status 3
     C                     MOVEL'A'       WL0044    P      Record Status
     C                     EXSR SCCRRC
      * Post transaction to IC Item Balance & IC Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0045           Company Number
     C                     Z-ADD#1HGCD    WL0046           Item Code
     C                     MOVEL#1AJCD    WL0047    P      Warehouse Code
     C                     MOVELP3W9ST    WL0048    P      Inventory Trans
     C                     MOVELP3BSST    WL0049    P      Inventory Trans
     C                     Z-ADD#1B4DT    WL0050           Transaction Dat
     C                     Z-ADD#1C4NY    WL0051           ITD Sequence Nu
     C                     Z-ADD#1DXNB    WL0052           Sequence Number
     C                     MOVEL#1XLCD    WL0053    P      Shift Number
     C                     Z-ADD#1K7DT    WL0054           Label Date
     C                     EXSR SDRVGN
      * ** Process Auto-Locate Whse inventory             FP1127
     C                     EXSR UASUBR                     ** Process Auto
     C                     END                             *FI
      * *****************************************************************
      * 08/14/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0001    OREQ 'P'                        *OR
     C                     MOVEL*BLANK    YL0009           API EccResult-M
     C                     MOVEL*BLANK    YL0010           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,001   CAT  'ry':ZQ   YL0011    P      API Name
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR SORVGN
      * Call API Wrapper Program for wim.ordershipping.inventory API
      * 1/5/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1HGCD    PAHGCD           Item Code
     C                     MOVEL#1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVELP3W9ST    PANOSC    P      WIM Inventory T
     C                     MOVELP3BSST    PANPSC    P      WIM Inventory T
     C                     Z-ADD#1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADD#1ELDT    PAELDT           Production Date
     C                     MOVEL'IC'      PAF1ST    P      Item Transactio
     C                     MOVEL#1AUNA    PAVQNA    P      Transaction Des
     C                     MOVEL#1CQCD    PAA1AB    P      Transaction Rea
     C                     Z-ADD*ZERO     PAC4NB           Order Number
     C                     MOVEL#1XLCD    PAXLCD    P      Shift Number
     C                     MOVEL*BLANK    PAL9AA    P      Ship To Warehou
     C                     Z-ADD#1AHWG    PAAHWG           Transaction Wei
     C                     Z-ADD#1A5QT    PAA5QT           Transaction Qua
     C                     MOVEL'N'       PAUSST    P      USR Unship Flag
     C                     MOVELYL0013    PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0010    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0012    WQ0061  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0009           API EccResult-M
     C                     MOVELPAVGU1    YL0014           API EccResult-M
     C                     MOVELPACKAB    YL0010           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993139*
     C                     SETON                     353837*
     C                     SETON                     403332*
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0009    IFEQ @CN,003                    *IF
     C           YL0009    OREQ @CN,004                    *OR
     C                     MOVEL'Y'       YL0002           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0009    IFEQ @CN,004                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0011    WQ0062 45        API Name
     C                     PARM YL0009    WQ0063  7        API EccResult M
     C                     PARM YL0014    WQ0064 50        API EccResult-M
     C                     PARM YL0010    WQ0065 10        API Request Key
     C                     PARM @CN,005   WQ0066 10        Called From Pro
     C                     PARM #1AIC3    WQ0067  30       Company Number
     C                     PARM #1HGCD    WQ0068  70       Item Code
     C                     PARM #1AJCD    WQ0069  3        Ship From Wareh
     C                     PARM P3W9ST    WQ0070  3        WIM Inventory T
     C                     PARM P3BSST    WQ0071  3        WIM Inventory T
     C                     PARM #1B4DT    WQ0072  70       Transaction Dat
     C                     PARM #1ELDT    WQ0073  70       Production Date
     C                     PARM 'IC'      WQ0074  2        Item Transactio
     C                     PARM #1AUNA    WQ0075 30        Transaction Des
     C                     PARM #1CQCD    WQ0076  3        Transaction Rea
     C                     PARM *ZERO     WQ0077  70       Order Number
     C                     PARM #1XLCD    WQ0078  1        Shift Number
     C                     PARM *BLANK    WQ0079  3        Ship To Warehou
     C                     PARM #1AHWG    WQ0080 112       Transaction Wei
     C                     PARM #1A5QT    WQ0081 112       Transaction Qua
     C                     PARM 'N'       WQ0082  1        Unship Flag
     C                     PARM YL0013    WQ0083  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993139*
     C                     SETON                     353837*
     C                     SETON                     403332*
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * SR07943 DN 12/21/23-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0009    IFNE *BLANK                     *IF
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0011    WQ0084 45        API Name
     C                     PARM YL0009    WQ0085  7        API EccResult M
     C                     PARM YL0014    WQ0086 50        API EccResult-M
     C                     PARM YL0010    WQ0087 10        API Request Key
     C                     PARM @CN,005   WQ0088 10        Called From Pro
     C                     PARM #1AIC3    WQ0089  30       Company Number
     C                     PARM #1HGCD    WQ0090  70       Item Code
     C                     PARM #1AJCD    WQ0091  3        Ship From Wareh
     C                     PARM P3W9ST    WQ0092  3        WIM Inventory T
     C                     PARM P3BSST    WQ0093  3        WIM Inventory T
     C                     PARM #1B4DT    WQ0094  70       Transaction Dat
     C                     PARM #1ELDT    WQ0095  70       Production Date
     C                     PARM 'IC'      WQ0096  2        Item Transactio
     C                     PARM #1AUNA    WQ0097 30        Transaction Des
     C                     PARM #1CQCD    WQ0098  3        Transaction Rea
     C                     PARM *ZERO     WQ0099  70       Order Number
     C                     PARM #1XLCD    WQ0100  1        Shift Number
     C                     PARM *BLANK    WQ0101  3        Ship To Warehou
     C                     PARM #1AHWG    WQ0102 112       Transaction Wei
     C                     PARM #1A5QT    WQ0103 112       Transaction Qua
     C                     PARM 'N'       WQ0104  1        Unship Flag
     C                     PARM YL0013    WQ0105  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993139*
     C                     SETON                     353837*
     C                     SETON                     403332*
     C                     END
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,005   WQ0106 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 09/27/23 DN WI517-Commented Out & Moved Below.
      * 09/27/23 DN WI517-Send Info Msg Based on Inventory was Updated or
      * CASE: LCL.Inventory Updated USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item processed'
     C                     MOVEL'USR0400' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Last item not processed'
     C                     MOVEL'USR0399' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * ** Clear non repeating screen fields to prepare for next item
     C                     Z-ADD*ZERO     #1HGCD           Item Code
     C                     MOVEL*BLANK    #PAVNA           Description Lin
     C                     MOVEL*BLANK    #1HVCD           UOM Transaction
     C                     Z-ADD*ZERO     #1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     #1AHWG           Transaction Wei
     C                     Z-ADD*ZERO     #1AKCS           USR Transaction
     C                     MOVELP4CUNA    #1AUNA           Description
     C                     Z-ADD*ZERO     #DLXNM           Lot Number
     C                     MOVEL*BLANK    #1MGNA           Lot ID
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Production Date
      * External date
     C                     Z-ADDV1ELDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #1ELDT
      * Validate Label Date
      * External date
     C                     Z-ADDV1K7DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #1K7DT
      * Check Shift Number is numeric
     C                     MOVEL*IN90     XG90    1
     C                     TESTN          #1XLCD     90  90*
     C   90                MOVE #1XLCD    XGX1    1
     C   90                TESTB'0123'    XGX1           90*
      * All blank is OK
     C  N90      #1XLCD    COMP *BLANKS                  90*
      * '?' is OK
     C  N90                MOVEL#1XLCD    XGX1
     C  N90      XGX1      COMP '?'                      90*
     C           *IN90     IFEQ '0'
      * Send message '*Field must be numeric'
     C                     MOVEL'Y2U0010' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
     C                     END
     C                     MOVELXG90      *IN90
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * CASE: DTL.Label Date is not entered
     C           #1K7DT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1ELDT    #1K7DT           Label Date
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0070  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0071  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0072  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0073  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0074  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0075  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0076  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0077  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0078  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0079  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0080  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0081  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0082  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0083  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0084  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0085  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0086  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0087  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0088  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0089 10        User Code Model
     C                     MOVEL*BLANK    WN0090  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SPRVGN
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0089    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0092    P      User Profile Na
     C                     MOVEL#1AJCD    WL0093    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    WN0070    P      UWA Inventory T
     C                     MOVELWL0095    WN0071    P      UWA Lot Loc Tra
     C                     MOVELWL0096    WN0072    P      UWA Shipping Tr
     C                     MOVELWL0097    WN0073    P      UWA Cross Appli
     C                     MOVELWL0098    WN0074    P      UWA Unused Stat
     C                     MOVELWL0099    WN0075    P      UWA Unused Stat
     C                     MOVELWL0100    WN0076    P      UWA Unused Sts
     C                     MOVELWL0101    WN0077    P      UWA Unused Sts
     C                     MOVELWL0102    WN0078    P      UWA Unused Sts
     C                     MOVELWL0103    WN0079    P      UWA Unused Sts
     C                     MOVELWL0104    WN0080    P      UWA Unused Sts
     C                     MOVELWL0105    WN0081    P      UWA Unused Sts
     C                     MOVELWL0106    WN0082    P      UWA Unused Sts
     C                     MOVELWL0107    WN0083    P      UWA Unused Sts
     C                     MOVELWL0108    WN0084    P      UWA Unused Sts
     C                     MOVELWL0109    WN0085    P      UWA Unused Sts
     C                     MOVELWL0110    WN0086    P      UWA Unused Sts
     C                     MOVELWL0111    WN0087    P      UWA Unused Sts
     C                     MOVELWL0112    WN0088    P      UWA Unused Sts
     C                     MOVELWL0113    WN0090    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0089    WL0092    P      User Profile Na
     C                     MOVEL#1AJCD    WL0093    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    WN0070    P      UWA Inventory T
     C                     MOVELWL0095    WN0071    P      UWA Lot Loc Tra
     C                     MOVELWL0096    WN0072    P      UWA Shipping Tr
     C                     MOVELWL0097    WN0073    P      UWA Cross Appli
     C                     MOVELWL0098    WN0074    P      UWA Unused Stat
     C                     MOVELWL0099    WN0075    P      UWA Unused Stat
     C                     MOVELWL0100    WN0076    P      UWA Unused Sts
     C                     MOVELWL0101    WN0077    P      UWA Unused Sts
     C                     MOVELWL0102    WN0078    P      UWA Unused Sts
     C                     MOVELWL0103    WN0079    P      UWA Unused Sts
     C                     MOVELWL0104    WN0080    P      UWA Unused Sts
     C                     MOVELWL0105    WN0081    P      UWA Unused Sts
     C                     MOVELWL0106    WN0082    P      UWA Unused Sts
     C                     MOVELWL0107    WN0083    P      UWA Unused Sts
     C                     MOVELWL0108    WN0084    P      UWA Unused Sts
     C                     MOVELWL0109    WN0085    P      UWA Unused Sts
     C                     MOVELWL0110    WN0086    P      UWA Unused Sts
     C                     MOVELWL0111    WN0087    P      UWA Unused Sts
     C                     MOVELWL0112    WN0088    P      UWA Unused Sts
     C                     MOVELWL0113    WN0090    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0090    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0003           User Profile Na
     C                     MOVEL#1AJCD    ZA0004           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'I'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0070    IFEQ 'N'                        *IF
     C           WN0070    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0091 10        Condition Name
     C                     MOVEL*BLANK    WN0092 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0091    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0092    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0091    ZA0005           Condition Name
     C                     MOVELWN0092    ZA0006           Condition Name
     C                     MOVEL#1AJCD    ZA0007           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0070    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0093 10        Condition Name
     C                     MOVEL*BLANK    WN0094 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0093    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0094    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0093    ZA0008           Condition Name
     C                     MOVELWN0094    ZA0009           Condition Name
     C                     MOVEL#1AJCD    ZA0010           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'I'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0071    IFEQ 'N'                        *IF
     C           WN0071    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0095 10        Condition Name
     C                     MOVEL*BLANK    WN0096 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0095    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0096    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0095    ZA0011           Condition Name
     C                     MOVELWN0096    ZA0012           Condition Name
     C                     MOVEL#1AJCD    ZA0013           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0071    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0097 10        Condition Name
     C                     MOVEL*BLANK    WN0098 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0097    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0098    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0097    ZA0014           Condition Name
     C                     MOVELWN0098    ZA0015           Condition Name
     C                     MOVEL#1AJCD    ZA0016           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'I'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0072    IFEQ 'N'                        *IF
     C           WN0072    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0099 10        Condition Name
     C                     MOVEL*BLANK    WN0100 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0099    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0100    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0099    ZA0017           Condition Name
     C                     MOVELWN0100    ZA0018           Condition Name
     C                     MOVEL#1AJCD    ZA0019           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0072    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0101 10        Condition Name
     C                     MOVEL*BLANK    WN0102 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0101    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0102    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0101    ZA0020           Condition Name
     C                     MOVELWN0102    ZA0021           Condition Name
     C                     MOVEL#1AJCD    ZA0022           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'I'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0073    IFEQ 'N'                        *IF
     C           WN0073    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0103 10        Condition Name
     C                     MOVEL*BLANK    WN0104 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0103    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0104    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0103    ZA0023           Condition Name
     C                     MOVELWN0104    ZA0024           Condition Name
     C                     MOVEL#1AJCD    ZA0025           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0073    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0105 10        Condition Name
     C                     MOVEL*BLANK    WN0106 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0105    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'I'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0106    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0105    ZA0026           Condition Name
     C                     MOVELWN0106    ZA0027           Condition Name
     C                     MOVEL#1AJCD    ZA0028           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate fields will check the major relational entries
      * Select Item or Warehouse
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Select Item
      * CASE: PGM.*Cursor field <IS> DTL.Item Code
     C           W0CFL     IFEQ 'V1HGCD'                   *IF
      * SEL Actv Item by Co    SR - Item  * 
     C                     CALL 'PDL9SRR'              90  SEL Actv Item b
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0107  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0108  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Select warehouse
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code
     C           W0CFL     IFEQ '#1AJCD'                   *IF
      * SEL Non-Prod Whse      SR - Warehouse  * 
     C                     CALL 'PDL4SRR'              90  SEL Non-Prod Wh
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0109  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL4SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Dsc/TrCtl/PFS flgs RT - Warehouse  * 
     C                     EXSR SRRVGN
      * Check return code/Carlisle/Plant and process accordingly  FP1127
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.WHS Live w/Carlisle is Yes
      *   |- c2    : PAR.Trans Contol AS400/Plant is Plant
      *   '-
     C           P1RRSX    IFEQ 'Y'                        *IF
     C           P1XUST    OREQ 'P'                        *OR
      * ** Not allowed if plant controlled or live w/Carlisle warehouse
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0029           Warehouse Code
      * Send message 'PFS ctrld can't be used'
     C                     MOVEL'USR4098' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
      * Rtv Desc,U/Ms,CWT,PrcMth - Item  * 
     C                     EXSR SSRVGN
      * Check return code and process accordingly
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If production date controlled item, date must be entered
      * CASE: PAR.Production Date Control is yes
     C           P2FZST    IFEQ 'Y'                        *IF
      * Production date not entered
      * CASE: DTL.Production Date is not entered
     C           #1ELDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Send message 'Prod Date must be entered'
     C                     MOVEL'USR1916' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * Label date not entered
      * CASE: DTL.Label Date is not entered
     C           #1K7DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0031
      * Send message 'Label Date must be enterd'
     C                     MOVEL'USR2534' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Label Date LT DTL.Production Date
     C           #1K7DT    IFLT #1ELDT                     *IF
      * Setup message data for message
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Send message 'Label Date < Prod Date'
     C                     MOVEL'USR2537' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * S13514 DN 08/06/18-Prod Dte must be >= Jan 1 (2yrs ago) & <= Curr
      * CASE: DTL.Production Date is entered
     C           #1ELDT    IFNE *ZERO                      *IF
      * Val Date In Not < 2yrs IF
      * Date In must be >= Jan 1 (2 yrs ago) and <= Current Date.
      * Initialize.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0015           Generic Message
      * Set 'Date In' Text.
      * CASE: PAR.Date In Type USR is Transaction Date
     C           'P'       IFEQ 'T'                        *IF
     C                     MOVEL@CN,007   YL0016           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Production Date
     C           'P'       IFEQ 'P'                        *IF
     C                     MOVEL@CN,008   YL0016           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Label Date
     C           'P'       IFEQ 'L'                        *IF
     C                     MOVEL*BLANK    YL0016           Text USR 15
     C                     MOVEL'Label'   YL0016           Text USR 15
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Get System Date & Set Date 2 Years Back on Jan 1.
      * CASE: *OTHERWISE
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0018           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0019    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0020    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0021    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0019    CAT  YL0020:ZQ YL0022    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0022    CAT  YL0021:ZQ YL0022    P      Date (Char-8) U
     C                     MOVE YL0022    YL0023           DATE
      *
     C                     Z-ADD*ZERO     WN0107  40       Year Code
     C                     Z-ADD*ZERO     WN0108  20       Month
     C                     Z-ADD*ZERO     WN0109  20       Day of Month US
     C                     MOVEL*BLANK    WN0110  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0111  2        Month (Char) US
     C                     MOVEL*BLANK    WN0112  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0113  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0114  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0115  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0023    DIV  10000     WN0107           Year Code
     C                     Z-ADDWN0107    WN0113           Year  NBR USR
     C                     MOVELWN0113    WN0114           Year  (Char) US
      * ** MONTH **
     C           YL0023    DIV  100       WN0108           Month
     C                     MOVELWN0108    WN0111           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0023    WN0109           Day of Month US
     C                     MOVELWN0109    WN0112           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0107    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0114:ZQ WN0115    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0114:ZQ WN0115    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0115    CAT  WN0111:ZQ WN0115    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0115    CAT  WN0112:ZQ WN0115    P      Date (Alpha) US
     C                     MOVE WN0115    YL0017           Date
      * LCL.Transaction Date D8# USR = LCL.System Date USR
     C           YL0017    IFEQ *ZERO
     C                     Z-ADD*ZERO     YL0024
     C                     ELSE
     C           YL0017    ADD  19000000  YL0024           Transaction Dat
     C                     END
      * ** YEAR ** (Go Back 2 Years)
     C           YL0024    DIV  10000     YL0025           Year Code
     C                     SUB  2         YL0025           Year Code
     C                     MOVEL*BLANK    YL0026           Year Alpha (YYY
     C                     MOVELYL0025    YL0026           Year Alpha (YYY
     C                     Z-ADDYL0025    YL0027           Year  NBR USR
     C                     MOVELYL0027    YL0028           Year  (Char) US
      * ** MONTH ** (Default to Jan)
     C                     MOVEL'01'      YL0029           Month (Char) US
      * ** DAY ** (Default to 01)
     C                     MOVEL'01'      YL0030           Day   (Char) US
      * ** Convert Date to CYYMMDD Format **
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0026    CAT  YL0029:ZQ YL0031    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0031    CAT  YL0030:ZQ YL0031    P      Date (Char-8) U
      * ** Convert Date to CYYMMDD Format **
      * CENTURY+YEAR
      * CASE: LCL.Year Code is Twentieth Century
     C           YL0025    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  YL0028:ZQ YL0032    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  YL0028:ZQ YL0032    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0032    CAT  YL0029:ZQ YL0032    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0032    CAT  YL0030:ZQ YL0032    P      Date (Alpha) US
     C                     MOVE YL0032    YL0033           Date
      * Send Error Message.
      * CASE: PAR.Date In  (7,0) USR GT LCL.System Date USR
     C           #1ELDT    IFGT YL0017                     *IF
      * Cannot be a future date.
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,010:ZQYL0015    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  'date.':ZQYL0015    P      Generic Message
     C                     ELSE
      * CASE: PAR.Date In  (7,0) USR LT LCL.Date                  USR
     C           #1ELDT    IFLT YL0033                     *IF
      * Cannot be older than last 2 years ago.
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,011:ZQYL0015    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  YL0031:ZQ YL0015    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  '.':ZQ    YL0015    P      Generic Message
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Generic Message 80 USR is Entered
     C           YL0015    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVELYL0015    ZA0033           Generic Message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0034
      * Send message 'Date In Cannot Be < 2yrs'
     C                     MOVEL'USR5086' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * S13514 DN 08/06/18-Label Dte must be >= Jan 1 (2yrs ago) & <= Cur
      * CASE: DTL.Label Date is Entered
     C           #1K7DT    IFNE *ZERO                      *IF
      * Val Date In Not < 2yrs IF
      * Date In must be >= Jan 1 (2 yrs ago) and <= Current Date.
      * Initialize.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0015           Generic Message
      * Set 'Date In' Text.
      * CASE: PAR.Date In Type USR is Transaction Date
     C           'L'       IFEQ 'T'                        *IF
     C                     MOVEL@CN,007   YL0016           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Production Date
     C           'L'       IFEQ 'P'                        *IF
     C                     MOVEL@CN,008   YL0016           Text USR 15
     C                     ELSE
      * CASE: PAR.Date In Type USR is Label Date
     C           'L'       IFEQ 'L'                        *IF
     C                     MOVEL*BLANK    YL0016           Text USR 15
     C                     MOVEL'Label'   YL0016           Text USR 15
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Get System Date & Set Date 2 Years Back on Jan 1.
      * CASE: *OTHERWISE
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0018           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0019    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0020    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0018:ZQ YL0021    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0019    CAT  YL0020:ZQ YL0022    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0022    CAT  YL0021:ZQ YL0022    P      Date (Char-8) U
     C                     MOVE YL0022    YL0023           DATE
      *
     C                     Z-ADD*ZERO     WN0116  40       Year Code
     C                     Z-ADD*ZERO     WN0117  20       Month
     C                     Z-ADD*ZERO     WN0118  20       Day of Month US
     C                     MOVEL*BLANK    WN0119  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0120  2        Month (Char) US
     C                     MOVEL*BLANK    WN0121  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0122  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0123  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0124  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0023    DIV  10000     WN0116           Year Code
     C                     Z-ADDWN0116    WN0122           Year  NBR USR
     C                     MOVELWN0122    WN0123           Year  (Char) US
      * ** MONTH **
     C           YL0023    DIV  100       WN0117           Month
     C                     MOVELWN0117    WN0120           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0023    WN0118           Day of Month US
     C                     MOVELWN0118    WN0121           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0116    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0123:ZQ WN0124    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0123:ZQ WN0124    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0124    CAT  WN0120:ZQ WN0124    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0124    CAT  WN0121:ZQ WN0124    P      Date (Alpha) US
     C                     MOVE WN0124    YL0017           Date
      * LCL.Transaction Date D8# USR = LCL.System Date USR
     C           YL0017    IFEQ *ZERO
     C                     Z-ADD*ZERO     YL0024
     C                     ELSE
     C           YL0017    ADD  19000000  YL0024           Transaction Dat
     C                     END
      * ** YEAR ** (Go Back 2 Years)
     C           YL0024    DIV  10000     YL0025           Year Code
     C                     SUB  2         YL0025           Year Code
     C                     MOVEL*BLANK    YL0026           Year Alpha (YYY
     C                     MOVELYL0025    YL0026           Year Alpha (YYY
     C                     Z-ADDYL0025    YL0027           Year  NBR USR
     C                     MOVELYL0027    YL0028           Year  (Char) US
      * ** MONTH ** (Default to Jan)
     C                     MOVEL'01'      YL0029           Month (Char) US
      * ** DAY ** (Default to 01)
     C                     MOVEL'01'      YL0030           Day   (Char) US
      * ** Convert Date to CYYMMDD Format **
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0026    CAT  YL0029:ZQ YL0031    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0031    CAT  YL0030:ZQ YL0031    P      Date (Char-8) U
      * ** Convert Date to CYYMMDD Format **
      * CENTURY+YEAR
      * CASE: LCL.Year Code is Twentieth Century
     C           YL0025    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  YL0028:ZQ YL0032    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  YL0028:ZQ YL0032    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0032    CAT  YL0029:ZQ YL0032    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0032    CAT  YL0030:ZQ YL0032    P      Date (Alpha) US
     C                     MOVE YL0032    YL0033           Date
      * Send Error Message.
      * CASE: PAR.Date In  (7,0) USR GT LCL.System Date USR
     C           #1K7DT    IFGT YL0017                     *IF
      * Cannot be a future date.
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,010:ZQYL0015    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  'date.':ZQYL0015    P      Generic Message
     C                     ELSE
      * CASE: PAR.Date In  (7,0) USR LT LCL.Date                  USR
     C           #1K7DT    IFLT YL0033                     *IF
      * Cannot be older than last 2 years ago.
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,011:ZQYL0015    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  YL0031:ZQ YL0015    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  '.':ZQ    YL0015    P      Generic Message
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Generic Message 80 USR is Entered
     C           YL0015    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVELYL0015    ZA0035           Generic Message
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Date In Cannot Be < 2yrs'
     C                     MOVEL'USR5086' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Production date entered
      * CASE: DTL.Production Date is entered
     C           #1ELDT    IFNE *ZERO                      *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0037
      * Send message 'Prod Date must be blank'
     C                     MOVEL'USR1917' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
      * Label date entered
      * CASE: DTL.Label Date is Entered
     C           #1K7DT    IFNE *ZERO                      *IF
      * Setup message data for message
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Send message 'Label Date must be blank'
     C                     MOVEL'USR2535' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Item not found'
     C                     MOVEL'USR0374' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Rtv Reason Code Desc.  RT - Reason Codes  * 
     C                     EXSR STRVGN
      * Rtv Status/Default     RT - IC Item Balance  * 
     C                     EXSR SURVGN
      * Check return code and process accordingly
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send error message if item is not active
      * CASE: PAR.Record Status is Deleted & Inactive
     C           P6VSST    IFEQ 'D'                        *IF
     C           P6VSST    OREQ 'I'
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0039           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0039           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0040           Warehouse Code
      * Send message 'Item blance is not active'
     C                     MOVEL'USR1918' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993139*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0041           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0041           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0042           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0042           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1AJCD    ZA0043           Warehouse Code
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993139*
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Item Balance
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993139*
     C                     END
      * Check reference to Calendar
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9934  *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Reason Codes
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9937  *
     C                     END
      * Check reference to Reference Number Master
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Class
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
      * CASE: DTL.Shift Number EQ WRK.BLANK
     C           #1XLCD    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       #1XLCD           Shift Number
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * If unit of measure is not entered then default to the primary
      * CASE: DTL.U/M - Transaction is Not Entered
     C           #1HVCD    IFEQ *BLANK                     *IF
     C                     MOVELP2ADCD    #1HVCD           UOM Transaction
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.U/M - Transaction NE PAR.U/M - Primary
      *   |- c2    : DTL.U/M - Transaction NE PAR.U/M - Second
      *   |- c3    : DTL.U/M - Transaction NE PAR.U/M - Third
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HVCD    IFNE P2ADCD                     *IF
     C           #1HVCD    IFNE P2AECD                     *IF
     C           #1HVCD    IFNE P2AFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELP2ADCD    ZA0044           UOM Primary
     C                     MOVELP2AECD    ZA0045           UOM Second
     C                     MOVELP2AFCD    ZA0046           UOM Third
      * Send message 'Unit measure not on item'
     C                     MOVEL'USR0392' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SVRVGN
      * If weight is zero, calculate weight
      * CASE: DTL.Transaction Weight is Equal to zero
     C           #1AHWG    IFEQ *ZERO                      *IF
      * Clc Convert Weight     XF
     C                     Z-ADD*ZERO     WUBHWG           USR Weight base
     C                     Z-ADD*ZERO     WUBIWG           USR Weight base
     C                     Z-ADD*ZERO     WUBJWG           USR Weight base
     C                     Z-ADDP2AIWG    WUBHWG           USR Weight base
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P2AIWG    DIV  P2AWPC    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P2AIWG    MULT P2AWPC    WUASWG    H      USR Weight
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUASWG    WUBIWG           USR Weight base
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WUASWG    DIV  P2AXPC    WUBJWG    H      USR Weight base
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WUASWG    MULT P2AXPC    WUBJWG    H      USR Weight base
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.U/M - Transaction EQ PAR.U/M - Primary
     C           #1HVCD    IFEQ P2ADCD                     *IF
     C           #1A5QT    MULT WUBHWG    #1AHWG    H      Transaction Wei
     C                     END                             *FI
      * CASE: DTL.U/M - Transaction EQ PAR.U/M - Second
     C           #1HVCD    IFEQ P2AECD                     *IF
     C           #1A5QT    MULT WUBIWG    #1AHWG    H      Transaction Wei
     C                     END                             *FI
      * CASE: DTL.U/M - Transaction EQ PAR.U/M - Third
     C           #1HVCD    IFEQ P2AFCD                     *IF
     C           #1A5QT    MULT WUBJWG    #1AHWG    H      Transaction Wei
     C                     END                             *FI
     C                     END                             *FI
      * Val Quantity/Weight    IF
     C                     EXSR UBSUBR
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SWRVGN
      * Validate Label Date   (if it is entered)
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If label date entered doesn't match label date on file, change it
      * CASE: DTL.Label Date NE WRK.Label Date
     C           #1K7DT    IFNE WUK7DT                     *IF
      * Setup message data for message
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0047
      * Send message 'Incorrect Label Date ent'
     C                     MOVEL'USR2536' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADDWUK7DT    #1K7DT           Label Date
     C                     END                             *FI
     C                     END                             *FI
      * If Companies no longer equal then issue Company mismatch error
      * CASE: DTL.Accounting Company Number NE PAR.Accounting Company Num
     C           #1AIC3    IFNE P3AIC3                     *IF
      * Send message 'Company must match GEN'
     C                     MOVEL'USR0916' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADDP3AIC3    #1AIC3           Company Number
     C                     END                             *FI
      * 07/19/10 PKD e884 remove unit cost validation
      * ** E13456 JJH 01/11/2019 - Validation for Lot Number
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0114    P      Warehouse Code
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0115    YN0001    P      Warehouse Descr
     C                     MOVELWL0116    YN0002    P      Address Line 1
     C                     MOVELWL0117    YN0003    P      Address Line 2
     C                     MOVELWL0118    YN0004    P      Address Line 3
     C                     MOVELWL0119    YN0005    P      City
     C                     MOVELWL0120    YN0006    P      Zip Postal Code
     C                     MOVELWL0121    YN0007    P      Production Ware
     C                     MOVELWL0122    YN0008    P      State Code
     C                     MOVELWL0123    YL0005    P      Lot Tracking Fl
     C                     MOVELWL0124    YN0009    P      Default Printer
     C                     MOVELWL0125    YN0010    P      Warehouse Type
     C                     MOVELWL0126    YN0011    P      Trans Contol AS
     C                     MOVELWL0127    YL0003    P      Warehouse Locat
     C                     MOVELWL0128    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0129    YN0013           Warehouse Chill
     C                     MOVELWL0130    YN0014    P      Include in Auto
     C                     MOVELWL0131    YN0015    P      Default Manifes
     C                     MOVELWL0132    YN0016    P      Default Load Se
     C                     MOVELWL0133    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0134    YN0018           Shipping Compan
     C                     Z-ADDWL0135    YN0019           Accounting Comp
     C                     Z-ADDWL0136    YN0020           WHS Sched Prod
     C                     Z-ADDWL0137    YN0021           WHS Inventory C
     C                     MOVELWL0138    YN0022    P      Parent Warehous
     C                     MOVELWL0139    YN0023    P      Default Shippin
     C                     MOVELWL0140    YL0004    P      WHS Live with C
     C                     MOVELWL0141    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0142    YN0025    P      WHS Req Meter R
     C                     MOVELWL0143    YN0026    P      WHS Default Loa
     C                     MOVELWL0144    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0145    YN0028    P      Default Carrier
     C                     MOVELWL0146    YN0029    P      Inventory Logic
     C                     MOVELWL0147    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0148    YN0031    P      EDI Status 1
     C                     MOVELWL0149    YN0032    P      EDI Status 2
     C                     MOVELWL0150    YN0033    P      EDI Status 3
     C                     MOVELWL0151    YN0034    P      Record Status
     C                     Z-ADDWL0152    YN0035           Job Time
     C                     MOVELWL0153    YN0036    P      User Id
     C                     MOVELWL0154    YN0037    P      Job Name
     C                     Z-ADDWL0155    YN0038           Job Date
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0005    IFEQ 'Y'                        *IF
      * CASE: DTL.Lot Number is Not Entered
     C           #DLXNM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#DLXNM    ZA0048           Lot Number
     C                     MOVEL#1AJCD    ZA0049           Warehouse Code
      * Send message 'Lot Number Required f/Whs'
     C                     MOVEL'USR5102' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     994139*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Transaction Quantity required
     C           #1A5QT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Transaction Weight required
     C           #1AHWG    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Warehouse Code required
     C           #1AJCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Shift Number required
     C           #1XLCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1DXNB           Sequence Number
     C                     MOVEL*BLANK    #1BSST           Inventory Trans
     C                     Z-ADD*ZERO     #1C4NY           ITD Sequence Nu
     C                     MOVEL*BLANK    #1F1ST           Item Transactio
     C                     MOVEL*BLANK    #1W9ST           Inventory Trans
     C                     MOVEL*BLANK    #1DTCD           Reference Numbe
     C                     Z-ADD*ZERO     #1TRBN           Transfer Batch
     C                     Z-ADD*ZERO     #1TRBS           Transfer Batch
     C                     Z-ADD*ZERO     #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1M3NA           Employee Badge
     C                     Z-ADD*ZERO     #1AWTM           Production Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #1BJNA           Ticket Number
     C                     MOVEL*BLANK    #1CGCD           UOM Cost
     C                     Z-ADD*ZERO     #1AYVA           Extended Amount
     C                     MOVEL*BLANK    #1BMST           GL Update Statu
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP3AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELP5ADTX    #PADTX           Name
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVELP4CUNA    #PCUNA           USR Hold Descri
     C                     Z-ADDP3B4DT    #1B4DT           Transaction Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1B4DT
     C                     Z-ADD*ZERO     #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVELP2AVNA    #PAVNA           Description Lin
     C                     Z-ADD*ZERO     #1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     #1AKCS           USR Transaction
     C                     Z-ADD*ZERO     #1AHWG           Transaction Wei
     C                     MOVEL*BLANK    #1HVCD           UOM Transaction
     C                     MOVEL*BLANK    #DDL01           Description. .
     C                     Z-ADD*ZERO     #1ELDT           Production Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1ELDT
     C                     Z-ADD*ZERO     #1K7DT           Label Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1K7DT
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #DM1NA           Reason Descript
     C                     MOVEL*BLANK    #1AUNA           Description
     C                     MOVELP1AJCD    #1AJCD           Warehouse Code
     C                     MOVELP1F8NA    #PF8NA           Warehouse Descr
     C                     MOVEL*BLANK    #1XLCD           Shift Number
     C                     Z-ADD*ZERO     #DLXNM           Lot Number
     C                     MOVEL*BLANK    #1MGNA           Lot ID
      * CALC: Screen function fields
      * CASE: DTL.Shift Number EQ WRK.BLANK
     C           #1XLCD    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       #1XLCD           Shift Number
     C                     END                             *FI
      * USER: Load screen
      * DTL.Condition Desc. 1  USR = Condition name of PAR.Inventory Tran
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1304090   Y2LSNO  70       List number
     C                     PARM P3W9ST    W0INVL 25        Inventory Trans
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVELP4CUNA    #1AUNA           Description
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SYRVGN
     C                     MOVEL'1'       #1XLCD           Shift Number
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Transaction Date Code to display format
      * Convert date
     C           1000000   ADD  #1B4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B4DT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  #1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1ELDT
      * Convert Label Date to display format
      * Convert date
     C           1000000   ADD  #1K7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1K7DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     Z-ADD#1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    P2RINB           Item Structure
     C                     Z-ADDWARHNB    P2RHNB           Item Structure
     C                     Z-ADDWARGNB    P2RGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
     C           *LIKE     DEFN WBAJCD    WQSB03           Warehouse Code
     C           *LIKE     DEFN WBW9ST    WQSB04           Inventory Trans
     C           *LIKE     DEFN WBBSST    WQSB05           Inventory Trans
     C           *LIKE     DEFN WBB4DT    WQSB06           Transaction Dat
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WQSB03           Warehouse Code
     C                     KFLD           WQSB04           Inventory Trans
     C                     KFLD           WQSB05           Inventory Trans
     C                     KFLD           WQSB06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WQSB02           Item Code
     C                     MOVELWL0003    WQSB03           Warehouse Code
     C                     MOVELWL0004    WQSB04           Inventory Trans
     C                     MOVELWL0005    WQSB05           Inventory Trans
     C                     Z-ADDWL0006    WQSB06           Transaction Dat
      * Establish starting position
     C           KRSSB     SETLL@B7CPZA                    *
     C           KRSSB     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0007           ITD Sequence Nu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBC4NY    ADD  1         WL0007           ITD Sequence Nu
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
     C                     Z-ADD*ZERO     WN0005  20       Production Hour
     C                     Z-ADD*ZERO     WN0006 112       Production Weig
     C                     Z-ADD*ZERO     WN0007  50       Production Quan
     C                     Z-ADD*ZERO     WN0008  70       Production Piec
     C                     MOVEL*BLANK    WN0009  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0008    WCAIC3           Company Number
     C                     Z-ADDWL0009    WCHGCD           Item Code
     C                     MOVELWL0010    WCAJCD           Warehouse Code
     C                     MOVELWL0011    WCW9ST           Inventory Trans
     C                     MOVELWL0012    WCBSST           Inventory Trans
     C                     Z-ADDWL0013    WCB4DT           Transaction Dat
     C                     Z-ADDWL0014    WCC4NY           ITD Sequence Nu
     C                     Z-ADDWL0015    WCDXNB           Sequence Number
     C                     Z-ADDWL0016    WCELDT           Production Date
     C                     MOVELWL0017    WCHVCD           UOM Transaction
     C                     MOVELWL0018    WCF1ST           Item Transactio
     C                     MOVELWL0019    WCAUNA           Description
     C                     Z-ADDWL0020    WCA5QT           Transaction Qua
     C                     Z-ADDWL0021    WCAHWG           Transaction Wei
     C                     Z-ADDWL0022    WCAKCS           USR Transaction
     C                     MOVELWL0023    WCCGCD           UOM Cost
     C                     Z-ADDWL0024    WCAYVA           Extended Amount
     C                     MOVELWL0025    WCBJNA           Ticket Number
     C                     Z-ADDWL0026    WCCKNB           GL Document Num
     C                     MOVELWL0027    WCBMST           GL Update Statu
     C                     MOVELWL0028    WCCQCD           Reason Code
     C                     MOVELWL0029    WCDTCD           Reference Numbe
     C                     MOVELWL0030    WCMGNA           Lot ID
     C                     Z-ADDWL0031    WCTRBN           Transfer Batch
     C                     Z-ADDWL0032    WCTRBS           Transfer Batch
     C                     Z-ADDWL0033    WCC4NB           Order Number
     C                     Z-ADDWL0034    WCRINB           Item Structure
     C                     Z-ADDWL0035    WCRHNB           Item Structure
     C                     Z-ADDWL0036    WCRGNB           Item Structure
     C                     MOVELWL0037    WCM3NA           Employee Badge
     C                     Z-ADDWL0038    WCAWTM           Production Time
     C                     MOVELWL0039    WCXLCD           Shift Number
     C                     Z-ADDWL0040    WCK7DT           Label Date
     C                     MOVELWL0041    WCUVST           EDI Status 1
     C                     MOVELWL0042    WCUWST           EDI Status 2
     C                     MOVELWL0043    WCUXST           EDI Status 3
     C                     MOVELWL0044    WCVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCW9ST           Inventory Trans
     C                     KFLD           WCBSST           Inventory Trans
     C                     KFLD           WCB4DT           Transaction Dat
     C                     KFLD           WCC4NY           ITD Sequence Nu
     C                     KFLD           WCDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSC    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0001  30       Company Number
     C                     PARM WCHGCD    WQ0002  70       Item Code
     C                     PARM WCAJCD    WQ0003  3        Warehouse Code
     C                     PARM WCW9ST    WQ0004  1        Inventory Trans
     C                     PARM WCBSST    WQ0005  2        Inventory Trans
     C                     PARM WCB4DT    WQ0006  70       Transaction Dat
     C                     PARM WCDXNB    WQ0007  30       Sequence Number
     C                     PARM WCELDT    WQ0008  70       Production Date
     C                     PARM WCHVCD    WQ0009  2        UOM Transaction
     C                     PARM WCF1ST    WQ0010  2        Item Transactio
     C                     PARM WCAUNA    WQ0011 30        Description
     C                     PARM WCA5QT    WQ0012 112       Transaction Qua
     C                     PARM WCAHWG    WQ0013 112       Transaction Wei
     C                     PARM WCAKCS    WQ0014 114       USR Transaction
     C                     PARM WCCGCD    WQ0015  2        UOM Cost
     C                     PARM WCAYVA    WQ0016 112       Extended Amount
     C                     PARM WCBJNA    WQ0017  6        Ticket Number
     C                     PARM WCCKNB    WQ0018  80       GL Document Num
     C                     PARM WCBMST    WQ0019  1        GL Update Statu
     C                     PARM WCCQCD    WQ0020  3        Reason Code
     C                     PARM WCDTCD    WQ0021 15        Reference Numbe
     C                     PARM WCMGNA    WQ0022 10        Lot ID
     C                     PARM WCTRBN    WQ0023  70       Transfer Batch
     C                     PARM WCTRBS    WQ0024  30       Transfer Batch
     C                     PARM WCC4NB    WQ0025  70       Order Number
     C                     PARM WCRINB    WQ0026  30       Item Structure
     C                     PARM WCRHNB    WQ0027  30       Item Structure
     C                     PARM WCRGNB    WQ0028  30       Item Structure
     C                     PARM WCM3NA    WQ0029 10        Employee Badge
     C                     PARM WCAWTM    WQ0030  60       Production Time
     C                     PARM WCXLCD    WQ0031  1        Shift Number
     C                     PARM WCK7DT    WQ0032  70       Label Date
     C                     PARM WCVSST    WQ0033  1        Record Status
     C                     PARM WCAATM    WQ0034  60       Job Time
     C                     PARM WCAXDT    WQ0035  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010  2        UOM Cost
     C                     Z-ADD*ZERO     WN0011 112       Extended Amount
     C                     MOVEL*BLANK    WN0012  1        GL Update Statu
     C                     MOVEL*BLANK    WN0013 30        Description Lin
     C                     MOVEL*BLANK    WN0014  2        UOM Primary
     C                     Z-ADD*ZERO     WN0015  94       Conversion Fact
     C                     MOVEL*BLANK    WN0016  1        Operation Facto
     C                     MOVEL*BLANK    WN0017  2        UOM Second
     C                     Z-ADD*ZERO     WN0018  94       Conversion Fact
     C                     MOVEL*BLANK    WN0019  1        Operation Facto
     C                     MOVEL*BLANK    WN0020  2        UOM Third
     C                     MOVEL*BLANK    WN0021  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0022 112       Unit Weight
     C                     MOVEL*BLANK    WN0023  1        Production Date
     C                     MOVEL*BLANK    WN0024  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0025  30       Item Structure
     C                     Z-ADD*ZERO     WN0026  30       Item Structure
     C                     Z-ADD*ZERO     WN0027  30       Item Structure
     C                     Z-ADD*ZERO     WN0028 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0029 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0030 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0031 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0032 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDW9ST           Inventory Trans
     C                     KFLD           WDBSST           Inventory Trans
     C                     KFLD           WDB4DT           Transaction Dat
     C                     KFLD           WDC4NY           ITD Sequence Nu
     C                     KFLD           WDDXNB           Sequence Number
      * Setup key
     C                     Z-ADDWL0045    WDAIC3           Company Number
     C                     Z-ADDWL0046    WDHGCD           Item Code
     C                     MOVELWL0047    WDAJCD           Warehouse Code
     C                     MOVELWL0048    WDW9ST           Inventory Trans
     C                     MOVELWL0049    WDBSST           Inventory Trans
     C                     Z-ADDWL0050    WDB4DT           Transaction Dat
     C                     Z-ADDWL0051    WDC4NY           ITD Sequence Nu
     C                     Z-ADDWL0052    WDDXNB           Sequence Number
      * Establish starting position
     C           KRSSD     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
     C                     EXSR SERVGN
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR SFRVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWDAIC3    WAAIC3           Company Number
     C                     Z-ADDWDHGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0013           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    WN0014           UOM Primary
     C                     Z-ADD*ZERO     WN0015           Conversion Fact
     C                     MOVEL*BLANK    WN0016           Operation Facto
     C                     MOVEL*BLANK    WN0017           UOM Second
     C                     Z-ADD*ZERO     WN0018           Conversion Fact
     C                     MOVEL*BLANK    WN0019           Operation Facto
     C                     MOVEL*BLANK    WN0020           UOM Third
     C                     MOVEL*BLANK    WUAICD           UOM Pricing
     C                     Z-ADD*ZERO     WN0022           Unit Weight
     C                     MOVEL*BLANK    WN0023           Production Date
     C                     MOVEL*BLANK    WN0024           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WN0013           Description Lin
     C                     MOVELWAAWNA    WUAWNA           Description Lin
     C                     MOVELWAADCD    WN0014           UOM Primary
     C                     Z-ADDWAAWPC    WN0015           Conversion Fact
     C                     MOVELWALXST    WN0016           Operation Facto
     C                     MOVELWAAECD    WN0017           UOM Second
     C                     Z-ADDWAAXPC    WN0018           Conversion Fact
     C                     MOVELWALYST    WN0019           Operation Facto
     C                     MOVELWAAFCD    WN0020           UOM Third
     C                     MOVELWAAICD    WUAICD           UOM Pricing
     C                     Z-ADDWAAIWG    WN0022           Unit Weight
     C                     MOVELWAFZST    WN0023           Production Date
     C                     MOVELWAAVST    WN0024           Catch Weight St
     C                     Z-ADDWACHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0032           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0028           On Hand Weight
     C                     Z-ADD*ZERO     WN0029           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0030           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0031           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAGCS    WN0032           Unit Cost Per P
     C                     Z-ADDWEBOWG    WN0028           On Hand Weight
     C                     Z-ADDWEDDQT    WN0029           On Hand UOM1 Su
     C                     Z-ADDWEDEQT    WN0030           On Hand UOM2 Su
     C                     Z-ADDWEDFQT    WN0031           On Hand UOM3 Su
     C                     Z-ADDWEIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0033 112       Quantity based
     C                     Z-ADD*ZERO     WN0034 112       Quantity based
     C                     Z-ADD*ZERO     WN0035 112       Quantity based
     C                     Z-ADD*ZERO     WN0036 114       Cost based on U
     C                     Z-ADD*ZERO     WN0037 114       Cost based on U
     C                     Z-ADD*ZERO     WN0038 114       Cost based on U
     C                     Z-ADD*ZERO     WN0039 112       Quantity Total
     C                     Z-ADD*ZERO     WN0040 112       Quantity Total
     C                     Z-ADD*ZERO     WN0041 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0042 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0043 114       Cost based on U
     C                     Z-ADD*ZERO     WN0044 114       Cost based on U
     C                     Z-ADD*ZERO     WN0045 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0036           Cost based on U
     C                     Z-ADD*ZERO     WN0037           Cost based on U
     C                     Z-ADD*ZERO     WN0038           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0014    IFEQ WDCGCD                     *IF
     C                     Z-ADDWN0032    WN0036           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0017    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WN0032    DIV  WN0015    WN0044    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
     C           WN0032    MULT WN0015    WN0044    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0044    WN0037           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0020    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WN0044    DIV  WN0018    WN0038    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
     C           WN0044    MULT WN0018    WN0038    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0017    IFEQ WDCGCD                     *IF
     C                     Z-ADDWN0032    WN0037           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
     C           WN0032    MULT WN0015    WN0036    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WN0032    DIV  WN0015    WN0036    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0020    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WN0032    DIV  WN0018    WN0038    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
     C           WN0032    MULT WN0018    WN0038    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0020    IFEQ WDCGCD                     *IF
     C                     Z-ADDWN0032    WN0038           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
     C           WN0032    MULT WN0018    WN0044    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WN0032    DIV  WN0018    WN0044    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0044    WN0037           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
     C           WN0044    MULT WN0015    WN0036    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WN0044    DIV  WN0015    WN0036    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0046 112       Quantity based
     C                     Z-ADD*ZERO     WN0047 112       Quantity based
     C                     Z-ADD*ZERO     WN0048 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0033           USR Qty based o
     C                     Z-ADD*ZERO     WN0034           USR Qty based o
     C                     Z-ADD*ZERO     WN0035           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0014    IFEQ WDHVCD                     *IF
     C                     Z-ADDWDA5QT    WN0033           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0017    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
     C           WDA5QT    MULT WN0015    WN0047    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WDA5QT    DIV  WN0015    WN0047    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0047    WN0034           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0020    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
     C           WN0047    MULT WN0018    WN0048    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WN0047    DIV  WN0018    WN0048    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0048    WN0035           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0017    IFEQ WDHVCD                     *IF
     C                     Z-ADDWDA5QT    WN0034           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WDA5QT    DIV  WN0015    WN0033    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
     C           WDA5QT    MULT WN0015    WN0033    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0020    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
     C           WDA5QT    MULT WN0018    WN0048    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WDA5QT    DIV  WN0018    WN0048    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0048    WN0035           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0020    IFEQ WDHVCD                     *IF
     C                     Z-ADDWDA5QT    WN0035           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0019    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0018    IFNE 0                          *IF
     C           WDA5QT    DIV  WN0018    WN0047    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0019    IFEQ 'D'                        *IF
     C           WDA5QT    MULT WN0018    WN0047    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0047    WN0034           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0016    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0015    IFNE 0                          *IF
     C           WN0047    DIV  WN0015    WN0033    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0016    IFEQ 'D'                        *IF
     C           WN0047    MULT WN0015    WN0033    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWDAIC3    WFAIC3           Company Number
     C                     Z-ADDWDHGCD    WFHGCD           Item Code
     C                     MOVELWDAJCD    WFAJCD    P      Warehouse Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C           KLCHSG    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR SHRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
     C                     EXSR SMRVGN
     C                     Z-ADD*ZERO     WFDOQT           Available Prima
      * Available Primary U/M
     C           WFDDQT    SUB  WFAJQT    WFDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WFAATM' defaulted for 'Job Time'.
      * Field '(DB1) WFAYNA' defaulted for 'User Id'.
      * Field '(DB1) WFA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WFAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0049 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0050 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0051 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0052 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0053 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0054 114       Last Cost
     C                     Z-ADD*ZERO     WN0055 112       Value of On Han
     C                     MOVEL*BLANK    WN0056  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Setup key
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWDELDT    WGELDT           Production Date
      * Establish starting position
     C           KRSSH     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0033    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0055           Company Number
     C                     Z-ADDWFHGCD    WL0056           Item Code
     C                     MOVELWFAJCD    WL0057    P      Warehouse Code
     C                     Z-ADDWDELDT    WL0058           Production Date
     C                     Z-ADD*ZERO     WL0059           Physical Count
     C                     Z-ADD*ZERO     WL0060           Physical Count
     C                     Z-ADD*ZERO     WL0061           Physical Count
     C                     Z-ADD*ZERO     WL0062           Physical Count
     C                     MOVEL*BLANK    WL0063           Physical Count
     C                     Z-ADD*ZERO     WL0064           Quantity on Han
     C                     Z-ADDWN0033    WL0065           Quantity on Han
     C                     Z-ADD*ZERO     WL0066           Quantity on Han
     C                     Z-ADD*ZERO     WL0067           Quantity on Han
     C                     Z-ADD*ZERO     WL0068           Quantity In Chi
     C                     Z-ADD*ZERO     WL0069           Weight In Chill
     C                     MOVEL'N'       WL0070    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0071           Physical Start
     C                     Z-ADD*ZERO     WL0072           Physical Start
     C                     Z-ADD*ZERO     WL0073           Physical Start
     C                     Z-ADD*ZERO     WL0074           Physical Start
     C                     Z-ADD*ZERO     WL0075           Physical Start
     C                     Z-ADD*ZERO     WL0076           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0077           Last Cost
     C                     Z-ADD*ZERO     WL0078           Value of On Han
     C                     Z-ADDWDK7DT    WL0079           Label Date
     C                     Z-ADDWFRINB    WL0080           Item Structure
     C                     Z-ADDWFRHNB    WL0081           Item Structure
     C                     Z-ADDWFRGNB    WL0082           Item Structure
     C                     MOVEL*BLANK    WL0083           EDI Status 1
     C                     MOVEL*BLANK    WL0084           EDI Status 2
     C                     MOVEL*BLANK    WL0085           EDI Status 3
     C                     MOVEL'A'       WL0086    P      Record Status
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0055           Company Number
     C                     Z-ADDWFHGCD    WL0056           Item Code
     C                     MOVELWFAJCD    WL0057    P      Warehouse Code
     C                     Z-ADDWDELDT    WL0058           Production Date
     C                     Z-ADD*ZERO     WL0059           Physical Count
     C                     Z-ADD*ZERO     WL0060           Physical Count
     C                     Z-ADD*ZERO     WL0061           Physical Count
     C                     Z-ADD*ZERO     WL0062           Physical Count
     C                     MOVEL*BLANK    WL0063           Physical Count
     C                     Z-ADDWDAHWG    WL0064           Quantity on Han
     C                     Z-ADDWN0033    WL0065           Quantity on Han
     C                     Z-ADD*ZERO     WL0066           Quantity on Han
     C                     Z-ADD*ZERO     WL0067           Quantity on Han
     C                     Z-ADD*ZERO     WL0068           Quantity In Chi
     C                     Z-ADD*ZERO     WL0069           Weight In Chill
     C                     MOVEL'N'       WL0070    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0071           Physical Start
     C                     Z-ADD*ZERO     WL0072           Physical Start
     C                     Z-ADD*ZERO     WL0073           Physical Start
     C                     Z-ADD*ZERO     WL0074           Physical Start
     C                     Z-ADD*ZERO     WL0075           Physical Start
     C                     Z-ADD*ZERO     WL0076           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0077           Last Cost
     C                     Z-ADDWDAYVA    WL0078           Value of On Han
     C                     Z-ADDWDK7DT    WL0079           Label Date
     C                     Z-ADDWFRINB    WL0080           Item Structure
     C                     Z-ADDWFRHNB    WL0081           Item Structure
     C                     Z-ADDWFRGNB    WL0082           Item Structure
     C                     MOVEL*BLANK    WL0083           EDI Status 1
     C                     MOVEL*BLANK    WL0084           EDI Status 2
     C                     MOVEL*BLANK    WL0085           EDI Status 3
     C                     MOVEL'A'       WL0086    P      Record Status
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WDBSST    IFEQ 'AC'                       *IF
     C           WGIDVA    ADD  WDAYVA    WN0055           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WDBSST    IFEQ 'R'                        *IF
     C           WDBSST    OREQ 'RP'
     C           WDBSST    OREQ 'S'
     C           WDBSST    OREQ 'TW'
     C           WDBSST    OREQ 'RW'
     C           WDBSST    OREQ 'RR'
     C           WGIDVA    ADD  WDAYVA    WN0055           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WDAHWG    ADD  WGACWG    WN0049           Quantity on Han
     C           WGARQT    ADD  WN0033    WN0050           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0050    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0038  30       Company Number
     C                     PARM WGHGCD    WQ0039  70       Item Code
     C                     PARM WGAJCD    WQ0040  3        Warehouse Code
     C                     PARM WDB4DT    WQ0041  70       Transaction Dat
     C                     PARM WGELDT    WQ0042  70       Production Date
     C                     PARM WDHVCD    WQ0043  2        UOM Transaction
     C                     PARM WN0049    WQ0044 112       Transaction Wei
     C                     PARM WN0053    WQ0045 114       USR Transaction
     C                     PARM WDCGCD    WQ0046  2        UOM Cost
     C                     PARM WGRINB    WQ0047  30       Item Structure
     C                     PARM WGRHNB    WQ0048  30       Item Structure
     C                     PARM WGRGNB    WQ0049  30       Item Structure
     C                     PARM WL0053    WQ0050  1        Shift Number
     C                     PARM WGK7DT    WQ0051  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     Z-ADD*ZERO     WN0049           Quantity on Han
     C                     Z-ADD*ZERO     WN0055           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SJRVGN
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0050    IFEQ WUW0NB                     *IF
     C           WGELDT    IFNE WUW0NB                     *IF
     C           WN0056    IFEQ *BLANK                     *IF
     C           WN0056    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
     C                     EXSR SKDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0057  60       Job Time
     C                     MOVEL*BLANK    WN0058 10        User Id
     C                     MOVEL*BLANK    WN0059 10        Job Name
     C                     Z-ADD*ZERO     WN0060  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0055    WHAIC3           Company Number
     C                     Z-ADDWL0056    WHHGCD           Item Code
     C                     MOVELWL0057    WHAJCD           Warehouse Code
     C                     Z-ADDWL0058    WHELDT           Production Date
     C                     Z-ADDWL0059    WHABWG           Physical Count
     C                     Z-ADDWL0060    WHAGQT           Physical Count
     C                     Z-ADDWL0061    WHAHQT           Physical Count
     C                     Z-ADDWL0062    WHAIQT           Physical Count
     C                     MOVELWL0063    WHCTST           Physical Count
     C                     Z-ADDWL0064    WHACWG           Quantity on Han
     C                     Z-ADDWL0065    WHARQT           Quantity on Han
     C                     Z-ADDWL0066    WHASQT           Quantity on Han
     C                     Z-ADDWL0067    WHATQT           Quantity on Han
     C                     Z-ADDWL0068    WHHDQT           Quantity In Chi
     C                     Z-ADDWL0069    WHHEQT           Weight In Chill
     C                     MOVELWL0070    WHF6ST           Update Exceptio
     C                     Z-ADDWL0071    WHBMWG           Physical Start
     C                     Z-ADDWL0072    WHDSQT           Physical Start
     C                     Z-ADDWL0073    WHDTQT           Physical Start
     C                     Z-ADDWL0074    WHDUQT           Physical Start
     C                     Z-ADDWL0075    WHDHDT           Physical Start
     C                     Z-ADDWL0076    WHAGCS           Unit Cost Per P
     C                     Z-ADDWL0077    WHAECS           Last Cost
     C                     Z-ADDWL0078    WHIDVA           Value of On Han
     C                     Z-ADDWL0079    WHK7DT           Label Date
     C                     Z-ADDWL0080    WHRINB           Item Structure
     C                     Z-ADDWL0081    WHRHNB           Item Structure
     C                     Z-ADDWL0082    WHRGNB           Item Structure
     C                     MOVELWL0083    WHUVST           EDI Status 1
     C                     MOVELWL0084    WHUWST           EDI Status 2
     C                     MOVELWL0085    WHUXST           EDI Status 3
     C                     MOVELWL0086    WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHAXDT    PARM *ZERO     WQ0036 155       Current System
     C           WHAATM    PARM *ZERO     WQ0037 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0056           Lot Tracking Fl
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIVHST    WN0056           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLDLSK    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLDLSK    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0061  70       Label Date
     C                     MOVEL*BLANK    WN0062  1        EDI Status 1
     C                     MOVEL*BLANK    WN0063  1        EDI Status 2
     C                     MOVEL*BLANK    WN0064  1        EDI Status 3
     C                     MOVEL*BLANK    WN0065  1        Record Status
     C                     Z-ADD*ZERO     WN0066  60       Job Time
     C                     MOVEL*BLANK    WN0067 10        User Id
     C                     MOVEL*BLANK    WN0068 10        Job Name
     C                     Z-ADD*ZERO     WN0069  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD    P      Warehouse Code
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSL    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWGABWG    WHABWG           Physical Count
     C                     Z-ADDWGAGQT    WHAGQT           Physical Count
     C                     Z-ADDWGAHQT    WHAHQT           Physical Count
     C                     Z-ADDWGAIQT    WHAIQT           Physical Count
     C                     MOVELWGCTST    WHCTST    P      Physical Count
     C                     Z-ADDWN0049    WHACWG           Quantity on Han
     C                     Z-ADDWN0050    WHARQT           Quantity on Han
     C                     Z-ADDWGASQT    WHASQT           Quantity on Han
     C                     Z-ADDWGATQT    WHATQT           Quantity on Han
     C                     Z-ADDWGHDQT    WHHDQT           Quantity In Chi
     C                     Z-ADDWGHEQT    WHHEQT           Weight In Chill
     C                     MOVELWGF6ST    WHF6ST    P      Update Exceptio
     C                     Z-ADDWGBMWG    WHBMWG           Physical Start
     C                     Z-ADDWGDSQT    WHDSQT           Physical Start
     C                     Z-ADDWGDTQT    WHDTQT           Physical Start
     C                     Z-ADDWGDUQT    WHDUQT           Physical Start
     C                     Z-ADDWGDHDT    WHDHDT           Physical Start
     C                     Z-ADDWGAGCS    WHAGCS           Unit Cost Per P
     C                     Z-ADDWGAECS    WHAECS           Last Cost
     C                     Z-ADDWN0055    WHIDVA           Value of On Han
     C                     Z-ADDWGRINB    WHRINB           Item Structure
     C                     Z-ADDWGRHNB    WHRHNB           Item Structure
     C                     Z-ADDWGRGNB    WHRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C                     MOVEL##PGM     WHA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WFBOWG           Quantity on Han
     C                     Z-ADD*ZERO     WFDDQT           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WFIDVA           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WJAJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDWFAIC3    WQSM01           Company Number
     C                     Z-ADDWFHGCD    WQSM02           Item Code
     C                     MOVELWFAJCD    WQSM03           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLLCAB1RL4                    *
     C           KRSSM     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WJACWG    WFBOWG           Quantity on Han
     C                     ADD  WJARQT    WFDDQT           Quantity on Han
     C                     ADD  WJASQT    WUNFNN           Quantity on Han
     C                     ADD  WJATQT    WUNFNN           Quantity on Han
     C                     ADD  WJIDVA    WFIDVA           Value of On Han
     C           KRSSM     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAJCD    WQSN01           Warehouse Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Warehouse Code
      * Setup key
     C                     MOVELWL0087    WQSN01           Warehouse Code
      * Establish starting position
     C           KRSSN     SETLL@L2RESM                    *
     C           KRSSN     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0088           Location Code
     C                     MOVEL*BLANK    WL0089           Location Aisle
     C                     Z-ADD*ZERO     WL0090           Location Bay
     C                     Z-ADD*ZERO     WL0091           Loc Unused Chil
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKYMCD    WL0088           Location Code
     C                     MOVELWKYPCD    WL0089           Location Aisle
     C                     Z-ADDWKLCBY    WL0090           Location Bay
     C                     Z-ADDWKLCCT    WL0091           Loc Unused Chil
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WLDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,002   WLDOCD           System Value Co
      * Establish starting position
     C           KRSSO     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWLM8NB    YL0012           System Value Nu
     C                     GOTO SOEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WMAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WMAJVN           User Profile Na
      * Establish starting position
     C           KRSSP     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0089           User Code Model
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBUVN    WN0089           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WOAJVN           User Profile Na
     C                     KFLD           WOAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0092    WOAJVN           User Profile Na
     C                     MOVELWL0093    WOAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0094           UWA Inventory T
     C                     MOVEL*BLANK    WL0095           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0096           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0097           UWA Cross Appli
     C                     MOVEL*BLANK    WL0098           UWA Unused Stat
     C                     MOVEL*BLANK    WL0099           UWA Unused Stat
     C                     MOVEL*BLANK    WL0100           UWA Unused Sts
     C                     MOVEL*BLANK    WL0101           UWA Unused Sts
     C                     MOVEL*BLANK    WL0102           UWA Unused Sts
     C                     MOVEL*BLANK    WL0103           UWA Unused Sts
     C                     MOVEL*BLANK    WL0104           UWA Unused Sts
     C                     MOVEL*BLANK    WL0105           UWA Unused Sts
     C                     MOVEL*BLANK    WL0106           UWA Unused Sts
     C                     MOVEL*BLANK    WL0107           UWA Unused Sts
     C                     MOVEL*BLANK    WL0108           UWA Unused Sts
     C                     MOVEL*BLANK    WL0109           UWA Unused Sts
     C                     MOVEL*BLANK    WL0110           UWA Unused Sts
     C                     MOVEL*BLANK    WL0111           UWA Unused Sts
     C                     MOVEL*BLANK    WL0112           UWA Unused Sts
     C                     MOVEL*BLANK    WL0113           Record Found US
     C                     MOVEL'N'       WL0113           Record Found US
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOUWAS    WL0094           UWA Inventory T
     C                     MOVELWOEPSX    WL0095           UWA Lot Loc Tra
     C                     MOVELWOEQSX    WL0096           UWA Shipping Tr
     C                     MOVELWOERSX    WL0097           UWA Cross Appli
     C                     MOVELWOUWAT    WL0098           UWA Unused Stat
     C                     MOVELWOEKSX    WL0099           UWA Unused Stat
     C                     MOVELWOECSX    WL0100           UWA Unused Sts
     C                     MOVELWOEDSX    WL0101           UWA Unused Sts
     C                     MOVELWOEESX    WL0102           UWA Unused Sts
     C                     MOVELWOEFSX    WL0103           UWA Unused Sts
     C                     MOVELWOEGSX    WL0104           UWA Unused Sts
     C                     MOVELWOEHSX    WL0105           UWA Unused Sts
     C                     MOVELWOEISX    WL0106           UWA Unused Sts
     C                     MOVELWOEJSX    WL0107           UWA Unused Sts
     C                     MOVELWOUWAU    WL0108           UWA Unused Sts
     C                     MOVELWOELSX    WL0109           UWA Unused Sts
     C                     MOVELWOEMSX    WL0110           UWA Unused Sts
     C                     MOVELWOENSX    WL0111           UWA Unused Sts
     C                     MOVELWOEOSX    WL0112           UWA Unused Sts
     C                     MOVEL'Y'       WL0113           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Dsc/TrCtl/PFS flgs RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PF8NA           Warehouse Descr
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1RRSX           WHS Live with C
     C                     MOVEL*BLANK    P1RSSX           WHS PFS Interfa
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIF8NA    #PF8NA           Warehouse Descr
     C                     MOVELWIXUST    P1XUST           Trans Contol AS
     C                     MOVELWIRRSX    P1RRSX           WHS Live with C
     C                     MOVELWIRSSX    P1RSSX           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Desc,U/Ms,CWT,PrcMth - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     Z-ADD#1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PAVNA           Description Lin
     C                     MOVEL*BLANK    P2AWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     MOVEL*BLANK    P2LNCD           Default Commod
     C                     MOVEL*BLANK    P2Q8CD           Price Method De
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    #PAVNA           Description Lin
     C                     MOVELWAAWNA    P2AWNA           Description Lin
     C                     MOVELWAADCD    P2ADCD           UOM Primary
     C                     Z-ADDWAAWPC    P2AWPC           Conversion Fact
     C                     MOVELWALXST    P2LXST           Operation Facto
     C                     MOVELWAAECD    P2AECD           UOM Second
     C                     Z-ADDWAAXPC    P2AXPC           Conversion Fact
     C                     MOVELWALYST    P2LYST           Operation Facto
     C                     MOVELWAAFCD    P2AFCD           UOM Third
     C                     MOVELWAAICD    P2AICD           UOM Pricing
     C                     Z-ADDWAAIWG    P2AIWG           Unit Weight
     C                     MOVELWAFZST    P2FZST           Production Date
     C                     MOVELWAAVST    P2AVST           Catch Weight St
     C                     MOVELWALNCD    P2LNCD           Default Commod
     C                     MOVELWAQ8CD    P2Q8CD           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Reason Code Desc.  RT - Reason Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WRCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    WRCQCD           Reason Code
      * Establish starting position
     C           KRSST     CHAIN@EFREV2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0858' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    #DM1NA           Description
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAUNA    #DM1NA           Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Status/Default     RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1HGCD    WEHGCD           Item Code
     C                     MOVEL#1AJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1AKCS           Unit Cost Per P
     C                     MOVEL*BLANK    P6J9ST           Cost Update Pen
     C                     MOVEL*BLANK    P6KBST           Post GL Status
     C                     Z-ADD*ZERO     P6AKC8           Vendor Item_Whs
     C                     MOVEL*BLANK    P6VSST           Record Status
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAGCS    #1AKCS           Unit Cost Per P
     C                     MOVELWEJ9ST    P6J9ST           Cost Update Pen
     C                     MOVELWEKBST    P6KBST           Post GL Status
     C                     Z-ADDWEAKC8    P6AKC8           Vendor Item_Whs
     C                     MOVELWEVSST    P6VSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           TCHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1HVCD    TCHHCD           UOM Primary Dft
      * Establish starting position
     C           KRSSV     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDL01           Description
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELTCAUNA    #DDL01           Description
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Setup key
     C                     Z-ADD#1AIC3    WGAIC3           Company Number
     C                     Z-ADD#1HGCD    WGHGCD           Item Code
     C                     MOVEL#1AJCD    WGAJCD           Warehouse Code
     C                     Z-ADD#1ELDT    WGELDT           Production Date
      * Establish starting position
     C           KRSSW     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGK7DT    WUK7DT           Label Date
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0114    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0115           Warehouse Descr
     C                     MOVEL*BLANK    WL0116           Address Line 1
     C                     MOVEL*BLANK    WL0117           Address Line 2
     C                     MOVEL*BLANK    WL0118           Address Line 3
     C                     MOVEL*BLANK    WL0119           City
     C                     MOVEL*BLANK    WL0120           Zip Postal Code
     C                     MOVEL*BLANK    WL0121           Production Ware
     C                     MOVEL*BLANK    WL0122           State Code
     C                     MOVEL*BLANK    WL0123           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0124           Default Printer
     C                     MOVEL*BLANK    WL0125           Warehouse Type
     C                     MOVEL*BLANK    WL0126           Trans Contol AS
     C                     MOVEL*BLANK    WL0127           Warehouse Locat
     C                     MOVEL*BLANK    WL0128           Warehouse Std C
     C                     Z-ADD*ZERO     WL0129           Warehouse Chill
     C                     MOVEL*BLANK    WL0130           Include in Auto
     C                     MOVEL*BLANK    WL0131           Default Manifes
     C                     MOVEL*BLANK    WL0132           Default Load Se
     C                     MOVEL*BLANK    WL0133           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0134           Shipping Compan
     C                     Z-ADD*ZERO     WL0135           Accounting Comp
     C                     Z-ADD*ZERO     WL0136           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0137           WHS Inventory C
     C                     MOVEL*BLANK    WL0138           Parent Warehous
     C                     MOVEL*BLANK    WL0139           Default Shippin
     C                     MOVEL*BLANK    WL0140           WHS Live with C
     C                     MOVEL*BLANK    WL0141           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0142           WHS Req Meter R
     C                     MOVEL*BLANK    WL0143           WHS Default Loa
     C                     MOVEL*BLANK    WL0144           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0145           Default Carrier
     C                     MOVEL*BLANK    WL0146           Inventory Logic
     C                     MOVEL*BLANK    WL0147           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0148           EDI Status 1
     C                     MOVEL*BLANK    WL0149           EDI Status 2
     C                     MOVEL*BLANK    WL0150           EDI Status 3
     C                     MOVEL*BLANK    WL0151           Record Status
     C                     Z-ADD*ZERO     WL0152           Job Time
     C                     MOVEL*BLANK    WL0153           User Id
     C                     MOVEL*BLANK    WL0154           Job Name
     C                     Z-ADD*ZERO     WL0155           Job Date
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIF8NA    WL0115           Warehouse Descr
     C                     MOVELWIACNA    WL0116           Address Line 1
     C                     MOVELWIADNA    WL0117           Address Line 2
     C                     MOVELWIAENA    WL0118           Address Line 3
     C                     MOVELWIAJNA    WL0119           City
     C                     MOVELWIBTTX    WL0120           Zip Postal Code
     C                     MOVELWIAOCD    WL0121           Production Ware
     C                     MOVELWIBGCD    WL0122           State Code
     C                     MOVELWIVHST    WL0123           Lot Tracking Fl
     C                     MOVELWIMPNA    WL0124           Default Printer
     C                     MOVELWIWPST    WL0125           Warehouse Type
     C                     MOVELWIXUST    WL0126           Trans Contol AS
     C                     MOVELWIT0ST    WL0127           Warehouse Locat
     C                     MOVELWIT1ST    WL0128           Warehouse Std C
     C                     Z-ADDWIDBNB    WL0129           Warehouse Chill
     C                     MOVELWIT2ST    WL0130           Include in Auto
     C                     MOVELWIT3ST    WL0131           Default Manifes
     C                     MOVELWIT4ST    WL0132           Default Load Se
     C                     MOVELWIT6ST    WL0133           WHS Slotting Li
     C                     Z-ADDWIBWC3    WL0134           Shipping Compan
     C                     Z-ADDWIBTC3    WL0135           Accounting Comp
     C                     Z-ADDWIBUC3    WL0136           WHS Sched Prod
     C                     Z-ADDWIBVC3    WL0137           WHS Inventory C
     C                     MOVELWIFCAA    WL0138           Parent Warehous
     C                     MOVELWIRQSX    WL0139           Default Shippin
     C                     MOVELWIRRSX    WL0140           WHS Live with C
     C                     MOVELWIRSSX    WL0141           WHS PFS Interfa
     C                     MOVELWIRTSX    WL0142           WHS Req Meter R
     C                     MOVELWIT7ST    WL0143           WHS Default Loa
     C                     MOVELWIT8ST    WL0144           WHS TMS Plannin
     C                     MOVELWIRNSX    WL0145           Default Carrier
     C                     MOVELWIROSX    WL0146           Inventory Logic
     C                     MOVELWIRPSX    WL0147           WHS Auto Inv Re
     C                     MOVELWIUVST    WL0148           EDI Status 1
     C                     MOVELWIUWST    WL0149           EDI Status 2
     C                     MOVELWIUXST    WL0150           EDI Status 3
     C                     MOVELWIVSST    WL0151           Record Status
     C                     Z-ADDWIAATM    WL0152           Job Time
     C                     MOVELWIAYNA    WL0153           User Id
     C                     MOVELWIA0NA    WL0154           Job Name
     C                     Z-ADDWIAXDT    WL0155           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           TDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    TDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSY     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #PF8NA           Warehouse Descr
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELTDF8NA    #PF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQSZ01           Application Cod
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSZ01           Application Cod
     C                     MOVEL'I/C'     WQSZ01           Application Cod
      * Establish starting position
     C           KRSSZ     SETLL@DNRESF                    *
     C           KRSSZ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           TERSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TARVGN
     C                     END                             *FI
     C           KRSSZ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQTA01           Application Cod
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Application Cod
      * Setup key
     C                     MOVELTERSCD    WQTA01           Application Cod
      * Establish starting position
     C           KRSTA     SETLL@DNRESF                    *
     C           KRSTA     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C           KRSTA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Module Release
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           TFB3AB           Module ID
     C                     KFLD           TFHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     TFB3AB           Module ID
     C                     Z-ADD1         TFHUNZ           Release Number
      * Establish starting position
     C           KRSTB     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           TFVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELTFOCSC    YL0001           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Process Auto-Locate Whse inventory             FP1127
      *================================================================
      * ** Auto-Locate if External, Lot Controlled, not Plant/Live W/Carl
      * ** E13456 JJH 01/11/2019 - Validation for Lot Number
      * Moved logic to get Warehouse info in the Validate Relation UEP
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'E'                        *IF
     C           YL0004    IFEQ *BLANK                     *IF
     C           YL0004    OREQ 'N'
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0087    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    WUYMCD    P      Location Code
     C                     MOVELWL0089    YL0006    P      Location Aisle
     C                     Z-ADDWL0090    YL0007           Location Bay
     C                     Z-ADDWL0091    YL0008           Loc Unused Chil
      * ** UPDATE Item Lot/Location
      * ** Lot number is now entered on the screen       FP1127 03/05/200
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0052  30       Company Number
     C                     PARM #1HGCD    WQ0053  70       Item Code
     C                     PARM #1AJCD    WQ0054  3        Warehouse Code
     C                     PARM #1ELDT    WQ0055  70       Production Date
     C                     PARM #DLXNM    WQ0056  50       Lot Number
     C                     PARM WUYMCD    WQ0057  4        Location Code
     C                     PARM WUYNCD    WQ0058  20       Location Level
     C                     PARM #1A5QT    WQ0059  70       Quantity Loc Tr
     C                     PARM *ZERO     WQ0060  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993139*
     C                     SETON                     354132*
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Edit for field values
      * CASE: PAR.Field Value Edit is Positive
     C           'P'       IFEQ 'P'                        *IF
      * Edit quantity
      * CASE: PAR.Transaction Quantity is Less than zero
     C           #1A5QT    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Quantity cannot be neg.'
     C                     MOVEL'USR0416' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * Edit weight
      * CASE: PAR.Transaction Weight is Less than zero
     C           #1AHWG    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction wgt must be +'
     C                     MOVEL'USR0539' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Field Value Edit is Negative
     C           'P'       IFEQ 'N'                        *IF
      * Edit quantity
      * CASE: PAR.Transaction Quantity is Greater than zero
     C           #1A5QT    IFGT 0                          *IF
      * Setup message data for message
      * Send message 'Quantity cannot be pos.'
     C                     MOVEL'USR0911' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * Edit weight
      * CASE: PAR.Transaction Weight is Greater than zero
     C           #1AHWG    IFGT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction wgt must be -'
     C                     MOVEL'USR0912' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit value mismatch
      * CASE: PAR.Transaction Quantity is Greater than zero
     C           #1A5QT    IFGT 0                          *IF
      * CASE: PAR.Transaction Weight is Less than zero
     C           #1AHWG    IFLT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction sign mismatch'
     C                     MOVEL'USR0383' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993233*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Transaction Quantity is Less than zero
     C           #1A5QT    IFLT 0                          *IF
      * CASE: PAR.Transaction Weight is Greater than zero
     C           #1AHWG    IFGT 0                          *IF
      * Setup message data for message
      * Send message 'Transaction sign mismatch'
     C                     MOVEL'USR0383' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993233*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Item Balance
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C                     MOVEL#1AJCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     C           WK1X03    OREQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
      * Field '(DTL) #1HGCD' defaulted for 'Item Code'.
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     MOVEL#1AJCD    PBAJCD    P      Warehouse Code
     C                     Z-ADD#1HGCD    PBHGCD           Item Code
      *
     C                     CALL 'PNMPSRR'              90  Sel Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Item Balan
      *
     C                     Z-ADDPBHGCD    #1HGCD           Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993931*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     Z-ADD#1HGCD    WEHGCD
     C                     MOVEL#1AJCD    WEAJCD
     C           KLVAWE    CHAIN@B0REJX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Item Balance           NF'
     C                     MOVEL'USR0328' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0328' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B4DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWS    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    WSAIC3
     C                     Z-ADD#1B4DT    WSBCDT
     C           KLVBWS    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HVCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1HVCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HVCD' defaulted for 'UOM Transaction'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1HVCD    PARM #1HVCD    WQ0110  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9934  *
     C                     END
      *
     C           #1HVCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWT    KLIST
     C                     KFLD           WTHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1HVCD    WTHHCD
     C           KLVCWT    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        UOM Primary Dft
     C           YPMTFD    OREQ '#1CGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CGCD' defaulted for 'UOM Cost'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1CGCD    PARM #1CGCD    WQ0111  2        UOM Primary Dft
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CGCD    IFNE *BLANK                     UOM Primary Dft
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CGCD    IFEQ *BLANK                     UOM Primary Dft
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWT    KLIST
     C                     KFLD           WTHHCD           UOM Primary Dft
      * Setup key
     C                     MOVEL#1CGCD    WTHHCD
     C           KLVDWT    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0112  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9937  *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWV    KLIST
     C                     KFLD           WVCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    WVCQCD
     C           KLVEWV    CHAIN@EFREU4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0858' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Reference Number Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1DTCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Reference Numbe
     C           YPMTFD    OREQ '#1DTCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1DTCD' defaulted for 'Reference Number Code'.
     C                     CALL 'PDE1SRR'              90  SEL Reference N
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0113  30       Company Number
     C           #1DTCD    PARM #1DTCD    WQ0114 15        Reference Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DTCD    IFNE *BLANK                     Reference Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DTCD    IFEQ *BLANK                     Reference Numbe
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWW    KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWDTCD           Reference Numbe
      * Setup key
     C                     Z-ADD#1AIC3    WWAIC3
     C                     MOVEL#1DTCD    WWDTCD
     C           KLVFWW    CHAIN@DVREWC              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Reference Number Maste NF'
     C                     MOVEL'USR0771' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0771' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0115  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0116  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C4NB    IFEQ *ZERO                      Order Number
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWX    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WXAIC3
     C                     Z-ADD#1C4NB    WXC4NB
     C           KLVGWX    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0117  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWY    KLIST
     C                     KFLD           WYRINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    WYRINB
     C           KLVHWY    CHAIN@FAREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0118  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVITA    KLIST
     C                     KFLD           TARHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    TARHNB
     C           KLVITA    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0119  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJTB    KLIST
     C                     KFLD           TBRGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    TBRGNB
     C           KLVJTB    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XSTMS     BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                     CALL 'Y2RTTSK'
     C                     PARM           ##TMS  26        System timestam
      *================================================================
     CSR         XSTMSE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HVCD'  YPMTFD           UOM Transaction
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1CQCD'  YPMTFD           Reason Code
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AJCD'  YPMTFD           Warehouse Code
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1F8NA           Warehouse Descr
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     MOVEL*BLANK    P1RRSX           WHS Live with C
     C                     MOVEL*BLANK    P1RSSX           WHS PFS Interfa
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AVNA           Description Lin
     C                     MOVEL*BLANK    P2AWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     Z-ADD*ZERO     P2RINB           Item Structure
     C                     Z-ADD*ZERO     P2RHNB           Item Structure
     C                     Z-ADD*ZERO     P2RGNB           Item Structure
     C                     MOVEL*BLANK    P2LNCD           Default Commod
     C                     MOVEL*BLANK    P2Q8CD           Price Method De
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3BMST           GL Update Statu
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6CBPR           Revaluation Cos
     C                     MOVEL*BLANK    P6J9ST           Cost Update Pen
     C                     MOVEL*BLANK    P6KBST           Post GL Status
     C                     Z-ADD*ZERO     P6AKC8           Vendor Item_Whs
     C                     MOVEL*BLANK    P6VSST           Record Status
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7ANCS           Cost based on U
     C                     Z-ADD*ZERO     P7AOCS           Cost based on U
     C                     Z-ADD*ZERO     P7APCS           Cost based on U
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WBAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WBAKCS           USR Transaction
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBCKNB           GL Document Num
     C                     Z-ADD*ZERO     WBTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WBTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAWTM           Production Time
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEBACS           Cost per Primar
     C                     Z-ADD*ZERO     WEBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WECBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WEGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WECTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WEG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WEBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WEDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WEDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WEDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WEAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WEEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WEDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WEAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WEDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WEDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WEBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WEDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WEBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WEDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WEDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WEBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WEDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WEDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WEDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WEDMDT           Last Physical C
     C                     Z-ADD*ZERO     WEAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKLCBY           Location Bay
     C                     Z-ADD*ZERO     WKLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLM8NB           System Value Nu
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMNLNB           Entity Number
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,009   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WSCQNB           Julian Date
     C                     Z-ADD*ZERO     WSESNB           Accounting Year
     C                     Z-ADD*ZERO     WSETNB           Accounting Peri
     C                     Z-ADD*ZERO     WSBZNB           OM Week
     C                     Z-ADD*ZERO     WSEINB           Week Number
     C                     Z-ADD*ZERO     WSAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WSOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WSNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WSNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WSOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WSOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXC4NB           Order Number
     C                     Z-ADD*ZERO     WXANC7           AR Customer Num
     C                     Z-ADD*ZERO     WXBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WXB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WXA0DT           Order Date
     C                     Z-ADD*ZERO     WXA5DT           Requested Ship
     C                     Z-ADD*ZERO     WXGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WXACDT           Cancel Date
     C                     Z-ADD*ZERO     WXAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WXCXDT           Date of Origina
     C                     Z-ADD*ZERO     WXJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WXA1WG           Order Weight To
     C                     Z-ADD*ZERO     WXEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WXAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WXRMNB           Load ID
     C                     Z-ADD*ZERO     WXTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WXR1NB           Rated Freight
     C                     Z-ADD*ZERO     WXRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WXATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WXRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WXT3NB           Attach to Order
     C                     Z-ADD*ZERO     WXCONB           Invoice Number
     C                     Z-ADD*ZERO     WXAWDT           Invoice Date
     C                     Z-ADD*ZERO     WXVRVA           A/R order Value
     C                     Z-ADD*ZERO     WXB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WXNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WXNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WXNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WXNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WXNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WXBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WXBQTM           Time of Origina
     C                     Z-ADD*ZERO     WXBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WXBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WXBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WXH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WXH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WXH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WXH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WXH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WXC0C7           Claim Number
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYRINB           Item Structure
     C                     Z-ADD*ZERO     WYRHNB           Item Structure
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TARHNB           Item Structure
     C                     Z-ADD*ZERO     TARGNB           Item Structure
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Weight based on U/M1
     C                     Z-ADD*ZERO     WUBHWG 112
      * Define work field USR Weight based on U/M2
     C                     Z-ADD*ZERO     WUBIWG 112
      * Define work field USR Weight based on U/M3
     C                     Z-ADD*ZERO     WUBJWG 112
      * Define work field USR Weight
     C                     Z-ADD*ZERO     WUASWG 112
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFHUNZ           Release Number
     C                     MOVELXDTSDL    TFBGTS           Create Date Tim
     C                     MOVELXDTSDL    TFBHTS           Update Date Tim
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  50
      * Define local variables for subroutine SCCRRC.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  2
     C                     MOVEL*BLANK    WL0018  2
     C                     MOVEL*BLANK    WL0019 30
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 114
     C                     MOVEL*BLANK    WL0023  2
     C                     Z-ADD*ZERO     WL0024 112
     C                     MOVEL*BLANK    WL0025  6
     C                     Z-ADD*ZERO     WL0026  80
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029 15
     C                     MOVEL*BLANK    WL0030 10
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  30
     C                     MOVEL*BLANK    WL0037 10
     C                     Z-ADD*ZERO     WL0038  60
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047  3
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  2
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  50
     C                     Z-ADD*ZERO     WL0052  30
     C                     MOVEL*BLANK    WL0053  1
     C                     Z-ADD*ZERO     WL0054  70
      * Define local variables for subroutine SICRRC.
     C                     Z-ADD*ZERO     WL0055  30
     C                     Z-ADD*ZERO     WL0056  70
     C                     MOVEL*BLANK    WL0057  3
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059 112
     C                     Z-ADD*ZERO     WL0060 112
     C                     Z-ADD*ZERO     WL0061 112
     C                     Z-ADD*ZERO     WL0062 112
     C                     MOVEL*BLANK    WL0063  1
     C                     Z-ADD*ZERO     WL0064 112
     C                     Z-ADD*ZERO     WL0065 112
     C                     Z-ADD*ZERO     WL0066 112
     C                     Z-ADD*ZERO     WL0067 112
     C                     Z-ADD*ZERO     WL0068 112
     C                     Z-ADD*ZERO     WL0069 112
     C                     MOVEL*BLANK    WL0070  1
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072 112
     C                     Z-ADD*ZERO     WL0073 112
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076 114
     C                     Z-ADD*ZERO     WL0077 114
     C                     Z-ADD*ZERO     WL0078 112
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080  30
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  30
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  1
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0087  3
     C                     MOVEL*BLANK    WL0088  4
     C                     MOVEL*BLANK    WL0089  2
     C                     Z-ADD*ZERO     WL0090  20
     C                     Z-ADD*ZERO     WL0091  52
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0092 10
     C                     MOVEL*BLANK    WL0093  3
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  2
     C                     MOVEL*BLANK    WL0109  2
     C                     MOVEL*BLANK    WL0110  2
     C                     MOVEL*BLANK    WL0111  2
     C                     MOVEL*BLANK    WL0112  2
     C                     MOVEL*BLANK    WL0113  1
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0114  3
     C                     MOVEL*BLANK    WL0115 30
     C                     MOVEL*BLANK    WL0116 30
     C                     MOVEL*BLANK    WL0117 30
     C                     MOVEL*BLANK    WL0118 30
     C                     MOVEL*BLANK    WL0119 20
     C                     MOVEL*BLANK    WL0120 11
     C                     MOVEL*BLANK    WL0121  3
     C                     MOVEL*BLANK    WL0122  2
     C                     MOVEL*BLANK    WL0123  1
     C                     MOVEL*BLANK    WL0124 10
     C                     MOVEL*BLANK    WL0125  2
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     Z-ADD*ZERO     WL0129  52
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131  1
     C                     MOVEL*BLANK    WL0132  1
     C                     MOVEL*BLANK    WL0133  1
     C                     Z-ADD*ZERO     WL0134  30
     C                     Z-ADD*ZERO     WL0135  30
     C                     Z-ADD*ZERO     WL0136  30
     C                     Z-ADD*ZERO     WL0137  30
     C                     MOVEL*BLANK    WL0138  3
     C                     MOVEL*BLANK    WL0139  1
     C                     MOVEL*BLANK    WL0140  1
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
     C                     MOVEL*BLANK    WL0143  2
     C                     MOVEL*BLANK    WL0144  2
     C                     MOVEL*BLANK    WL0145  3
     C                     MOVEL*BLANK    WL0146  3
     C                     MOVEL*BLANK    WL0147  3
     C                     MOVEL*BLANK    WL0148  1
     C                     MOVEL*BLANK    WL0149  1
     C                     MOVEL*BLANK    WL0150  1
     C                     MOVEL*BLANK    WL0151  1
     C                     Z-ADD*ZERO     WL0152  60
     C                     MOVEL*BLANK    WL0153 10
     C                     MOVEL*BLANK    WL0154 10
     C                     Z-ADD*ZERO     WL0155  70
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0007  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0008  52
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0011 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0014 50
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0015 80
      * Define local work field Text USR 15
     C                     MOVEL*BLANK    YL0016 15
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field *System timestamp
     C                     MOVELXDTSDL    YL0018 26
      * Define local work field Year USR
     C                     MOVEL*BLANK    YL0019  4
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0021  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0022  8
      * Define local work field DATE
     C                     Z-ADD*ZERO     YL0023  80
      * Define local work field Transaction Date D8# USR
     C                     Z-ADD*ZERO     YL0024  80
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0025  40
      * Define local work field Year Alpha (YYYY) USR
     C                     MOVEL*BLANK    YL0026  4
      * Define local work field Year  NBR USR
     C                     Z-ADD*ZERO     YL0027  20
      * Define local work field Year  (Char) USR
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field Month (Char) USR
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field Day   (Char) USR
     C                     MOVEL*BLANK    YL0030  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0031  8
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0032  7
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0033  70
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SZRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * WI517 DN 08/14/23-Get 'Live with WIM' Flag.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR TBRVGN
     C                     MOVEL'N'       YL0002           Inventory Updat
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01308013130182002076023320258802599
02844031000335603612036230386804124
04380043910463604892049030514805404
05660
** W0END
01310013420184402105023390259402628
02856031110336803613036520387504131
04382044200466504894049320514805408
05669
** W0NAM
V1AIC3    #PADTX    #DHLTX    #PCUNA    V1B4DT    V1HGCD    #PAVNA
#1A5QT    #1AKCS    #1AHWG    #1HVCD    #DDL01    V1ELDT    V1K7DT
#1CQCD    #DM1NA    #1AUNA    #1AJCD    #PF8NA    #1XLCD    #DLXNM
#1MGNA
** @CN
00001 wim.ordershipping.invento
00002 APIWAITTME
00003 ECC0000
00004 TIMEOUT
00005 ICQLPVR
00006 USR0752
00007 Transaction
00008 Production
00009 0001-01-01-00.00.00.00000
00010 Date cannot be a future
00011 Date cannot be prior to
