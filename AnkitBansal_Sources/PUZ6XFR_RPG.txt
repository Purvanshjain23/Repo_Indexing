     H/TITLE Crt Block Order Qtemp XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 04/22/24  Time  : 03:46:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL0  IF A E           K DISK
      * UPD : Order Header TRG          Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOPBF1        E DS                  EXTNAME(OPBFCPL0)
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(BEAIC3)
     D  WAC4NB       E                     EXTFLD(BEC4NB)
     D  WAJNCD       E                     EXTFLD(BEJNCD)
     D  WAANC7       E                     EXTFLD(BEANC7)
     D  WABKC7       E                     EXTFLD(BEBKC7)
     D  WABRTX       E                     EXTFLD(BEBRTX)
     D  WAHMNA       E                     EXTFLD(BEHMNA)
     D  WAHONA       E                     EXTFLD(BEHONA)
     D  WAHPNA       E                     EXTFLD(BEHPNA)
     D  WAHNNA       E                     EXTFLD(BEHNNA)
     D  WADBCD       E                     EXTFLD(BEDBCD)
     D  WACKTX       E                     EXTFLD(BECKTX)
     D  WAB0C7       E                     EXTFLD(BEB0C7)
     D  WAAETX       E                     EXTFLD(BEAETX)
     D  WAB1NA       E                     EXTFLD(BEB1NA)
     D  WAB3NA       E                     EXTFLD(BEB3NA)
     D  WAB4NA       E                     EXTFLD(BEB4NA)
     D  WAB2NA       E                     EXTFLD(BEB2NA)
     D  WABHCD       E                     EXTFLD(BEBHCD)
     D  WAC8TX       E                     EXTFLD(BEC8TX)
     D  WABCNA       E                     EXTFLD(BEBCNA)
     D  WAA0DT       E                     EXTFLD(BEA0DT)
     D  WAA5DT       E                     EXTFLD(BEA5DT)
     D  WAGNDT       E                     EXTFLD(BEGNDT)
     D  WAACDT       E                     EXTFLD(BEACDT)
     D  WAAQCD       E                     EXTFLD(BEAQCD)
     D  WAB6NA       E                     EXTFLD(BEB6NA)
     D  WABYNA       E                     EXTFLD(BEBYNA)
     D  WABZNA       E                     EXTFLD(BEBZNA)
     D  WAGTST       E                     EXTFLD(BEGTST)
     D  WAGVST       E                     EXTFLD(BEGVST)
     D  WAGUST       E                     EXTFLD(BEGUST)
     D  WAQFST       E                     EXTFLD(BEQFST)
     D  WACQCD       E                     EXTFLD(BECQCD)
     D  WAGJST       E                     EXTFLD(BEGJST)
     D  WAGWST       E                     EXTFLD(BEGWST)
     D  WAGXST       E                     EXTFLD(BEGXST)
     D  WAGYST       E                     EXTFLD(BEGYST)
     D  WAAODT       E                     EXTFLD(BEAODT)
     D  WAAIVN       E                     EXTFLD(BEAIVN)
     D  WACXDT       E                     EXTFLD(BECXDT)
     D  WAJZVA       E                     EXTFLD(BEJZVA)
     D  WAA1WG       E                     EXTFLD(BEA1WG)
     D  WAXIST       E                     EXTFLD(BEXIST)
     D  WAXJST       E                     EXTFLD(BEXJST)
     D  WAXKST       E                     EXTFLD(BEXKST)
     D  WAEIDT       E                     EXTFLD(BEEIDT)
     D  WAAFTM       E                     EXTFLD(BEAFTM)
     D  WAE8CD       E                     EXTFLD(BEE8CD)
     D  WAE9CD       E                     EXTFLD(BEE9CD)
     D  WARMNB       E                     EXTFLD(BERMNB)
     D  WATBNB       E                     EXTFLD(BETBNB)
     D  WAR1NB       E                     EXTFLD(BER1NB)
     D  WAPJST       E                     EXTFLD(BEPJST)
     D  WAU0ST       E                     EXTFLD(BEU0ST)
     D  WAU1ST       E                     EXTFLD(BEU1ST)
     D  WAQ2CD       E                     EXTFLD(BEQ2CD)
     D  WAU2ST       E                     EXTFLD(BEU2ST)
     D  WAVEST       E                     EXTFLD(BEVEST)
     D  WAVFST       E                     EXTFLD(BEVFST)
     D  WAVGST       E                     EXTFLD(BEVGST)
     D  WARPCD       E                     EXTFLD(BERPCD)
     D  WARNNB       E                     EXTFLD(BERNNB)
     D  WAVDST       E                     EXTFLD(BEVDST)
     D  WAATIN       E                     EXTFLD(BEATIN)
     D  WAU4ST       E                     EXTFLD(BEU4ST)
     D  WAU5ST       E                     EXTFLD(BEU5ST)
     D  WARSRN       E                     EXTFLD(BERSRN)
     D  WAMHNA       E                     EXTFLD(BEMHNA)
     D  WAMINA       E                     EXTFLD(BEMINA)
     D  WAWBST       E                     EXTFLD(BEWBST)
     D  WAR4CD       E                     EXTFLD(BER4CD)
     D  WABFCD       E                     EXTFLD(BEBFCD)
     D  WAQ4CD       E                     EXTFLD(BEQ4CD)
     D  WAT3NB       E                     EXTFLD(BET3NB)
     D  WASICD       E                     EXTFLD(BESICD)
     D  WACONB       E                     EXTFLD(BECONB)
     D  WACEST       E                     EXTFLD(BECEST)
     D  WAAWDT       E                     EXTFLD(BEAWDT)
     D  WAJPCD       E                     EXTFLD(BEJPCD)
     D  WAXUST       E                     EXTFLD(BEXUST)
     D  WAZ1ST       E                     EXTFLD(BEZ1ST)
     D  WAVRVA       E                     EXTFLD(BEVRVA)
     D  WAOBST       E                     EXTFLD(BEOBST)
     D  WABCST       E                     EXTFLD(BEBCST)
     D  WABDST       E                     EXTFLD(BEBDST)
     D  WAB7VL       E                     EXTFLD(BEB7VL)
     D  WAGASX       E                     EXTFLD(BEGASX)
     D  WAGBSX       E                     EXTFLD(BEGBSX)
     D  WAGCSX       E                     EXTFLD(BEGCSX)
     D  WAGDSX       E                     EXTFLD(BEGDSX)
     D  WAFNSX       E                     EXTFLD(BEFNSX)
     D  WAFOSX       E                     EXTFLD(BEFOSX)
     D  WAFPSX       E                     EXTFLD(BEFPSX)
     D  WAFQSX       E                     EXTFLD(BEFQSX)
     D  WAFRSX       E                     EXTFLD(BEFRSX)
     D  WAFSSX       E                     EXTFLD(BEFSSX)
     D  WAFTSX       E                     EXTFLD(BEFTSX)
     D  WAFUSX       E                     EXTFLD(BEFUSX)
     D  WAFVSX       E                     EXTFLD(BEFVSX)
     D  WAFWSX       E                     EXTFLD(BEFWSX)
     D  WAFXSX       E                     EXTFLD(BEFXSX)
     D  WAFYSX       E                     EXTFLD(BEFYSX)
     D  WANODT       E                     EXTFLD(BENODT)
     D  WANPDT       E                     EXTFLD(BENPDT)
     D  WANQDT       E                     EXTFLD(BENQDT)
     D  WANRDT       E                     EXTFLD(BENRDT)
     D  WANSDT       E                     EXTFLD(BENSDT)
     D  WABPTM       E                     EXTFLD(BEBPTM)
     D  WABQTM       E                     EXTFLD(BEBQTM)
     D  WABRTM       E                     EXTFLD(BEBRTM)
     D  WABSTM       E                     EXTFLD(BEBSTM)
     D  WABTTM       E                     EXTFLD(BEBTTM)
     D  WAH0NX       E                     EXTFLD(BEH0NX)
     D  WAH1NX       E                     EXTFLD(BEH1NX)
     D  WAH2NX       E                     EXTFLD(BEH2NX)
     D  WAH3NX       E                     EXTFLD(BEH3NX)
     D  WAH4NX       E                     EXTFLD(BEH4NX)
     D  WAC0C7       E                     EXTFLD(BEC0C7)
     D  WAUVST       E                     EXTFLD(BEUVST)
     D  WAUWST       E                     EXTFLD(BEUWST)
     D  WAUXST       E                     EXTFLD(BEUXST)
     D  WAAATM       E                     EXTFLD(BEAATM)
     D  WAAYNA       E                     EXTFLD(BEAYNA)
     D  WAA0NA       E                     EXTFLD(BEA0NA)
     D  WAAXDT       E                     EXTFLD(BEAXDT)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S              6  0
     D  WN0002         S             10
     D  WN0003         S             10
     D  WN0004         S              7  0
     D  WQ0001         S             15  5
     D  WQ0002         S             15  5
     D  W0CLPG         S             10
     D  ZADFMF         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           779
      * RCD: Order Header TRG          Update index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Order Type_Sales
     D  P1JNCD                 7      8
      * I :  AR Customer Number
     D  P1ANC7                 9     12P 0
      * I :  Ship To Customer
     D  P1BKC7                13     16P 0
      * I :  Ship To Name
     D  P1BRTX                17     46
      * I :  Ship To Address Line 1
     D  P1HMNA                47     76
      * I :  Ship To Address Line 2
     D  P1HONA                77    106
      * I :  Ship To Address Line 3
     D  P1HPNA               107    136
      * I :  Ship To City
     D  P1HNNA               137    156
      * I :  Ship To State Code
     D  P1DBCD               157    158
      * I :  Ship To Zip_Postal Code
     D  P1CKTX               159    169
      * I :  Bill to Customer
     D  P1B0C7               170    173P 0
      * I :  Bill to Name
     D  P1AETX               174    203
      * I :  Bill to Address Line 1
     D  P1B1NA               204    233
      * I :  Bill to Address Line 2
     D  P1B3NA               234    263
      * I :  Bill to Address Line 3
     D  P1B4NA               264    293
      * I :  Bill to City
     D  P1B2NA               294    313
      * I :  Bill to State Code
     D  P1BHCD               314    315
      * I :  Bill to Zip_Postal Code
     D  P1C8TX               316    326
      * I :  Customer Purchase Order #
     D  P1BCNA               327    341
      * I :  Order Date
     D  P1A0DT               342    345P 0
      * I :  Requested Ship Date
     D  P1A5DT               346    349P 0
      * I :  Actual Shipped Date
     D  P1GNDT               350    353P 0
      * I :  Cancel Date
     D  P1ACDT               354    357P 0
      * I :  Terms Code
     D  P1AQCD               358    359
      * I :  Special Instructions
     D  P1B6NA               360    399
      * I :  Special Instructions 2
     D  P1BYNA               400    439
      * I :  Carrier Code
     D  P1BZNA               440    442
      * I :  Comment Print Acknowledge
     D  P1GTST               443    443
      * I :  Comment Print Inv_Cr_Memo
     D  P1GVST               444    444
      * I :  Comment Print Pick Slip
     D  P1GUST               445    445
      * I :  Comment Print Ship Doc
     D  P1QFST               446    446
      * I :  Reason Code
     D  P1CQCD               447    449
      * I :  Order in Use
     D  P1GJST               450    450
      * I :  Header Status
     D  P1GWST               451    451
      * I :  Header Status Last
     D  P1GXST               452    452
      * I :  Order Type Print Status
     D  P1GYST               453    453
      * I :  Scheduled Ship Date
     D  P1AODT               454    457P 0
      * I :  User Original Entry
     D  P1AIVN               458    467
      * I :  Date of Original Entry
     D  P1CXDT               468    471P 0
      * I :  Order Value Total
     D  P1JZVA               472    477P 2
      * I :  Order Weight Total
     D  P1A1WG               478    483P 2
      * I :  Credit Hold
     D  P1XIST               484    484
      * I :  Production Hold
     D  P1XJST               485    485
      * I :  New Customer Hold
     D  P1XKST               486    486
      * I :  Requested Delivery Date
     D  P1EIDT               487    490P 0
      * I :  Requested Delivery Time
     D  P1AFTM               491    493P 0
      * I :  Accounts Receiv_Ent 1
     D  P1E8CD               494    497
      * I :  Accounts Receiv_Ent 2
     D  P1E9CD               498    509
      * I :  Load ID
     D  P1RMNB               510    513P 0
      * I :  Absorbed Freight Rate CWT
     D  P1TBNB               514    516P 2
      * I :  Rated Freight
     D  P1R1NB               517    522P 2
      * I :  LTL Flag
     D  P1PJST               523    523
      * I :  Price Audit
     D  P1U0ST               524    524
      * I :  Price Status
     D  P1U1ST               525    525
      * I :  Shipping Method
     D  P1Q2CD               526    527
      * I :  Export Status
     D  P1U2ST               528    528
      * I :  Palletize
     D  P1VEST               529    529
      * I :  Shrink Wrap
     D  P1VFST               530    530
      * I :  Slip Sheet
     D  P1VGST               531    531
      * I :  Age Code
     D  P1RPCD               532    532
      * I :  Reefer Temperature
     D  P1RNNB               533    535P 2
      * I :  Load Type
     D  P1VDST               536    536
      * I :  Attach to Invoice Number
     D  P1ATIN               537    540P 0
      * I :  Load Plan Order
     D  P1U4ST               541    541
      * I :  Print Pick Slip
     D  P1U5ST               542    542
      * I :  Resell Reference Number
     D  P1RSRN               543    546P 0
      * I :  Special Comment 1
     D  P1MHNA               547    576
      * I :  Special Comment 2
     D  P1MINA               577    606
      * I :  Affect Auto Accruals
     D  P1WBST               607    607
      * I :  Sales Route Code
     D  P1R4CD               608    610
      * I :  Manager Level Code
     D  P1BFCD               611    612
      * I :  VP Level Code
     D  P1Q4CD               613    615
      * I :  Attach to Order Number
     D  P1T3NB               616    619P 0
      * I :  Reason for Price Audit
     D  P1SICD               620    622
      * I :  Invoice Number
     D  P1CONB               623    626P 0
      * I :  Invoice Suffix
     D  P1CEST               627    628
      * I :  Invoice Date
     D  P1AWDT               629    632P 0
      * I :  Event Code
     D  P1JPCD               633    634
      * I :  Trans Contol AS400_Plant
     D  P1XUST               635    635
      * I :  Modified Flag
     D  P1Z1ST               636    636
      * I :  A_R order Value Total
     D  P1VRVA               637    642P 2
      * I :  Billing Activity Type
     D  P1OBST               643    643
      * I :  Block Order Flag
     D  P1BCST               644    644
      * I :  Order Certification Flag
     D  P1BDST               645    645
      * I :  Invoice Order Value Tot
     D  P1B7VL               646    651P 2
      * I :  Process Sts for 3C
     D  P1GASX               652    652
      * I :  Order Conf Fax Sts
     D  P1GBSX               653    653
      * I :  Manifest Fax Sts
     D  P1GCSX               654    654
      * I :  Invoice Fax Sts
     D  P1GDSX               655    655
      * I :  Transfer in Storage Ind
     D  P1FNSX               656    656
      * I :  Email Cust On Order Ship
     D  P1FOSX               657    657
      * I :  Order Emailed
     D  P1FPSX               658    658
      * I :  Export Docs Go w_Driver
     D  P1FQSX               659    659
      * I :  Shipping Temp Code C_F
     D  P1FRSX               660    660
      * I :  Broker Order Status
     D  P1FSSX               661    661
      * I :  Air Freight Order
     D  P1FTSX               662    662
      * I :  Order Requires Review
     D  P1FUSX               663    664
      * I :  OH Load Plan Ready
     D  P1FVSX               665    666
      * I :  Export USDA Approved
     D  P1FWSX               667    668
      * I :  HPB Ship to Warehouse
     D  P1FXSX               669    671
      * I :  OH TF Exempt Code
     D  P1FYSX               672    674
      * I :  OH Appt Confirmation Dt
     D  P1NODT               675    678P 0
      * I :  JPN Invoice Issuance Date
     D  P1NPDT               679    682P 0
      * I :  Load Actual Shipped Date
     D  P1NQDT               683    686P 0
      * I :  Load BOL Complete Date
     D  P1NRDT               687    690P 0
      * I :  Load Truck Departure Date
     D  P1NSDT               691    694P 0
      * I :  Maximum Gross Weight
     D  P1BPTM               695    698P 0
      * I :  Time of Original Entry
     D  P1BQTM               699    702P 0
      * I :  OH Appt Confirmation Tm
     D  P1BRTM               703    706P 0
      * I :  Load BOL Complete Time
     D  P1BSTM               707    710P 0
      * I :  Load Truck Departure Time
     D  P1BTTM               711    714P 0
      * I :  Act Frt Reference Amount
     D  P1H0NX               715    720P 2
      * I :  Act Non_Ref Frt Amount
     D  P1H1NX               721    726P 2
      * I :  OH Fuel Surcharge Amount
     D  P1H2NX               727    732P 2
      * I :  OH Total Non_Ref Frt Amt
     D  P1H3NX               733    738P 2
      * I :  OH Total Ref Frt Amt
     D  P1H4NX               739    744P 2
      * I :  Claim Number
     D  P1C0C7               745    748P 0
      * I :  EDI Status 1
     D  P1UVST               749    749
      * I :  EDI Status 2
     D  P1UWST               750    750
      * I :  EDI Status 3
     D  P1UXST               751    751
     D                 DS
     D  ZAMSDA                 1    132
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Order Head
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Crt Block Order Qtemp XF
      * Create Order Header TRG (OPBFCPP) Record in QTEMP.
      * Crt Block Order Qtemp CR - Order Header TRG  * 
     C                   EXSR      SACRRC
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt Block Order Qtemp CR - Order Header TRG  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Job Time
     C                   EVAL      WN0002 = ' '                                 User Id
     C                   EVAL      WN0003 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0004                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @BECPFJ
     C                   Z-ADD     P1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WAC4NB                         Order Number
     C                   MOVEL     P1JNCD        WAJNCD                         Order Type_Sale
     C                   Z-ADD     P1ANC7        WAANC7                         AR Customer Num
     C                   Z-ADD     P1BKC7        WABKC7                         Ship To Custome
     C                   MOVEL     P1BRTX        WABRTX                         Ship To Name
     C                   MOVEL     P1HMNA        WAHMNA                         Ship To Address
     C                   MOVEL     P1HONA        WAHONA                         Ship To Address
     C                   MOVEL     P1HPNA        WAHPNA                         Ship To Address
     C                   MOVEL     P1HNNA        WAHNNA                         Ship To City
     C                   MOVEL     P1DBCD        WADBCD                         Ship To State C
     C                   MOVEL     P1CKTX        WACKTX                         Ship To Zip_Pos
     C                   Z-ADD     P1B0C7        WAB0C7                         Bill to Custome
     C                   MOVEL     P1AETX        WAAETX                         Bill to Name
     C                   MOVEL     P1B1NA        WAB1NA                         Bill to Address
     C                   MOVEL     P1B3NA        WAB3NA                         Bill to Address
     C                   MOVEL     P1B4NA        WAB4NA                         Bill to Address
     C                   MOVEL     P1B2NA        WAB2NA                         Bill to City
     C                   MOVEL     P1BHCD        WABHCD                         Bill to State C
     C                   MOVEL     P1C8TX        WAC8TX                         Bill to Zip_Pos
     C                   MOVEL     P1BCNA        WABCNA                         Customer Purcha
     C                   Z-ADD     P1A0DT        WAA0DT                         Order Date
     C                   Z-ADD     P1A5DT        WAA5DT                         Requested Ship
     C                   Z-ADD     P1GNDT        WAGNDT                         Actual Shipped
     C                   Z-ADD     P1ACDT        WAACDT                         Cancel Date
     C                   MOVEL     P1AQCD        WAAQCD                         Terms Code
     C                   MOVEL     P1B6NA        WAB6NA                         Special Instruc
     C                   MOVEL     P1BYNA        WABYNA                         Special Instruc
     C                   MOVEL     P1BZNA        WABZNA                         Carrier Code
     C                   MOVEL     P1GTST        WAGTST                         Comment Print A
     C                   MOVEL     P1GVST        WAGVST                         Comment Print I
     C                   MOVEL     P1GUST        WAGUST                         Comment Print P
     C                   MOVEL     P1QFST        WAQFST                         Comment Print S
     C                   MOVEL     P1CQCD        WACQCD                         Reason Code
     C                   MOVEL     P1GJST        WAGJST                         Order in Use
     C                   MOVEL     P1GWST        WAGWST                         Header Status
     C                   MOVEL     P1GXST        WAGXST                         Header Status L
     C                   MOVEL     P1GYST        WAGYST                         Order Type Prin
     C                   Z-ADD     P1AODT        WAAODT                         Scheduled Ship
     C                   MOVEL     P1AIVN        WAAIVN                         User Original E
     C                   Z-ADD     P1CXDT        WACXDT                         Date of Origina
     C                   Z-ADD     P1JZVA        WAJZVA                         Order Value Tot
     C                   Z-ADD     P1A1WG        WAA1WG                         Order Weight To
     C                   MOVEL     P1XIST        WAXIST                         Credit Hold
     C                   MOVEL     P1XJST        WAXJST                         Production Hold
     C                   MOVEL     P1XKST        WAXKST                         New Customer Ho
     C                   Z-ADD     P1EIDT        WAEIDT                         Requested Deliv
     C                   Z-ADD     P1AFTM        WAAFTM                         Requested Deliv
     C                   MOVEL     P1E8CD        WAE8CD                         Accounts Receiv
     C                   MOVEL     P1E9CD        WAE9CD                         Accounts Receiv
     C                   Z-ADD     P1RMNB        WARMNB                         Load ID
     C                   Z-ADD     P1TBNB        WATBNB                         Absorbed Freigh
     C                   Z-ADD     P1R1NB        WAR1NB                         Rated Freight
     C                   MOVEL     P1PJST        WAPJST                         LTL Flag
     C                   MOVEL     P1U0ST        WAU0ST                         Price Audit
     C                   MOVEL     P1U1ST        WAU1ST                         Price Status
     C                   MOVEL     P1Q2CD        WAQ2CD                         Shipping Method
     C                   MOVEL     P1U2ST        WAU2ST                         Export Status
     C                   MOVEL     P1VEST        WAVEST                         Palletize
     C                   MOVEL     P1VFST        WAVFST                         Shrink Wrap
     C                   MOVEL     P1VGST        WAVGST                         Slip Sheet
     C                   MOVEL     P1RPCD        WARPCD                         Age Code
     C                   Z-ADD     P1RNNB        WARNNB                         Reefer Temperat
     C                   MOVEL     P1VDST        WAVDST                         Load Type
     C                   Z-ADD     P1ATIN        WAATIN                         Attach to Invoi
     C                   MOVEL     P1U4ST        WAU4ST                         Load Plan Order
     C                   MOVEL     P1U5ST        WAU5ST                         Print Pick Slip
     C                   Z-ADD     P1RSRN        WARSRN                         Resell Referenc
     C                   MOVEL     P1MHNA        WAMHNA                         Special Comment
     C                   MOVEL     P1MINA        WAMINA                         Special Comment
     C                   MOVEL     P1WBST        WAWBST                         Affect Auto Acc
     C                   MOVEL     P1R4CD        WAR4CD                         Sales Route Cod
     C                   MOVEL     P1BFCD        WABFCD                         Manager Level C
     C                   MOVEL     P1Q4CD        WAQ4CD                         VP Level Code
     C                   Z-ADD     P1T3NB        WAT3NB                         Attach to Order
     C                   MOVEL     P1SICD        WASICD                         Reason for Pric
     C                   Z-ADD     P1CONB        WACONB                         Invoice Number
     C                   MOVEL     P1CEST        WACEST                         Invoice Suffix
     C                   Z-ADD     P1AWDT        WAAWDT                         Invoice Date
     C                   MOVEL     P1JPCD        WAJPCD                         Event Code
     C                   MOVEL     P1XUST        WAXUST                         Trans Contol AS
     C                   MOVEL     P1Z1ST        WAZ1ST                         Modified Flag
     C                   Z-ADD     P1VRVA        WAVRVA                         A_R order Value
     C                   MOVEL     P1OBST        WAOBST                         Billing Activit
     C                   MOVEL     P1BCST        WABCST                         Block Order Fla
     C                   MOVEL     P1BDST        WABDST                         Order Certifica
     C                   Z-ADD     P1B7VL        WAB7VL                         Invoice Order V
     C                   MOVEL     P1GASX        WAGASX                         Process Sts for
     C                   MOVEL     P1GBSX        WAGBSX                         Order Conf Fax
     C                   MOVEL     P1GCSX        WAGCSX                         Manifest Fax St
     C                   MOVEL     P1GDSX        WAGDSX                         Invoice Fax Sts
     C                   MOVEL     P1FNSX        WAFNSX                         Transfer in Sto
     C                   MOVEL     P1FOSX        WAFOSX                         Email Cust On O
     C                   MOVEL     P1FPSX        WAFPSX                         Order Emailed
     C                   MOVEL     P1FQSX        WAFQSX                         Export Docs Go
     C                   MOVEL     P1FRSX        WAFRSX                         Shipping Temp C
     C                   MOVEL     P1FSSX        WAFSSX                         Broker Order St
     C                   MOVEL     P1FTSX        WAFTSX                         Air Freight Ord
     C                   MOVEL     P1FUSX        WAFUSX                         Order Requires
     C                   MOVEL     P1FVSX        WAFVSX                         OH Load Plan Re
     C                   MOVEL     P1FWSX        WAFWSX                         Export USDA App
     C                   MOVEL     P1FXSX        WAFXSX                         HPB Ship to War
     C                   MOVEL     P1FYSX        WAFYSX                         OH TF Exempt Co
     C                   Z-ADD     P1NODT        WANODT                         OH Appt Confirm
     C                   Z-ADD     P1NPDT        WANPDT                         JPN Invoice Iss
     C                   Z-ADD     P1NQDT        WANQDT                         Load Actual Shi
     C                   Z-ADD     P1NRDT        WANRDT                         Load BOL Comple
     C                   Z-ADD     P1NSDT        WANSDT                         Load Truck Depa
     C                   Z-ADD     P1BPTM        WABPTM                         Maximum Gross W
     C                   Z-ADD     P1BQTM        WABQTM                         Time of Origina
     C                   Z-ADD     P1BRTM        WABRTM                         OH Appt Confirm
     C                   Z-ADD     P1BSTM        WABSTM                         Load BOL Comple
     C                   Z-ADD     P1BTTM        WABTTM                         Load Truck Depa
     C                   Z-ADD     P1H0NX        WAH0NX                         Act Frt Referen
     C                   Z-ADD     P1H1NX        WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     P1H2NX        WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     P1H3NX        WAH3NX                         OH Total Non_Re
     C                   Z-ADD     P1H4NX        WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     P1C0C7        WAC0C7                         Claim Number
     C                   MOVEL     P1UVST        WAUVST                         EDI Status 1
     C                   MOVEL     P1UWST        WAUWST                         EDI Status 2
     C                   MOVEL     P1UXST        WAUXST                         EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                   Z-ADD     ##JTM         WAAATM                         Job Time
     C                   MOVEL     ##USR         WAAYNA                         User Id
     C                   MOVEL     ##PGM         WAA0NA                         Job Name
     C                   Z-ADD     ##JDT         WAAXDT                         Job Date
     C                   MOVEL     @CN(001)      WAAYNA                         User Id
     C                   MOVEL     @CN(002)      WAA0NA                         Job Name
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     WACXDT        PARM      *ZERO         WQ0001                         Current System
     C     WABQTM        PARM      *ZERO         WQ0002                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @BECPFJ                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR0177'     W0RTN
      * Send message 'Order Header TRG       EX'
     C                   MOVEL     'USR0177'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @BECPFJ                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 INFORMATIC
00002 AUTOUPLOAD
