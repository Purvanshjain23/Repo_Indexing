/***************************************************************** */
/*                                                                 */
/*       PROGRAM:    ECDINCL                                       */
/*  PROGRAM NAME:    EBI: Credit/Debit Report--Email               */
/*    PROGRAMMER:    LeAnne Ramsey                                 */
/*   CREATE DATE:    05/06/14                                      */
/*                                                                 */
/*      FUNCTION:    This CL is wrapped in a Stored Procedure      */
/*                   (ECDIN) which Extol EBI calls from the        */
/*                   server software at the end of processing of   */
/*                   an inbound credit/debit memo.                 */
/*                                                                 */
/*                   We are setting this up so that we can generate*/
/*                   the report and email it to the Credit Depart- */
/*                   ment and the EDI Support Team.                */
/*   MODIFICATIONS:                                                */
/*   03/23/17 SZ - MISSING EMAIL ADDRESS TO SEND DAILYS C/D MEMOS. */
/*                 INCREASED SIZE OF EMAIL PARM TO 100 FROM 60.    */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&SETNBR &DIV &ENV)

             DCL        VAR(&DIV)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&ENV)     TYPE(*CHAR) LEN(1)
             DCL        VAR(&SETNBR)  TYPE(*CHAR) LEN(9)
             DCL        VAR(&MSGLOG#) TYPE(*CHAR) LEN(9)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(100)

/* We declare/use &MSGLOG# because that is the variable name that  */
/* the existing Sequel Report is expecting.                        */

             DCL        VAR(&MSGLOG#) TYPE(*CHAR) LEN(9)
             CHGVAR     VAR(&MSGLOG#) VALUE(&SETNBR)

             RMVLIBLE   LIB(QGPL)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(QGPL)

             RMVLIBLE   LIB(TAATOOL)
             MONMSG     MSGID(CPF0000)
             ADDLIBLE   LIB(TAATOOL)

/* PORK--Production                                                */
             IF         COND(&DIV *EQ 'P' *AND &ENV *EQ 'P') THEN(DO)
             CHGLBLJOBD JOBD(PRKPRDSEC)
             ENDDO

/* PORK--Test                                                      */
             IF         COND(&DIV *EQ 'P' *AND &ENV *EQ 'T') THEN(DO)
             CHGLBLJOBD JOBD(PRKTSTEDI)
             ENDDO

/* Dailys--Production                                              */
             IF         COND(&DIV *EQ 'D' *AND &ENV *EQ 'P') THEN(DO)
             CHGLBLJOBD JOBD(DMMJOBD)
             ENDDO

/* Dailys--Test                                                    */
             IF         COND(&DIV *EQ 'D' *AND &ENV *EQ 'T') THEN(DO)
             CHGLBLJOBD JOBD(DLYTSTEDI)
             ENDDO

/* EMails ---------------------------------------------------------*/

/* Test Email Recipient     TEST ENVIRONMENT                       */
             IF         COND(&ENV *EQ 'T') THEN(DO)
             CHGVAR     VAR(&EMAIL) VALUE('EdiSupport@seaboardfoods.com')
             ENDDO

/* Dailys--Production  EMAIL RECIPIENTS                            */
             IF         COND(&DIV *EQ 'D' *AND &ENV *EQ 'P') THEN(DO)
             CHGVAR     VAR(&EMAIL) +
                          VALUE('Brian_Miller@dailysmeats.com,  +
                          EdiSupport@seaboardfoods.com, +
                          dusti_kempff@dailysmeats.com')
             ENDDO
/* Production Email Recipients                                     */
             IF         COND(&DIV *EQ 'P' *AND &ENV *EQ 'P') THEN(DO)
             CHGVAR     VAR(&EMAIL) +
                          VALUE('Credit_Dept@seaboardfoods.com, +
                          EdiSupport@seaboardfoods.com')
             ENDDO
/* Production Email Recipients                                   */
    /*           IF         COND(&ENV *EQ 'P') THEN(DO)          */
    /*       CHGVAR     VAR(&EMAIL) +                            */
    /*                    VALUE('Credit_Dept@seaboardfoods.com, +*/
    /*                    EdiSupport@seaboardfoods.com')         */
    /*       ENDDO                                               */
/*-----------------------------------------------------------------*/
/* Submit Job to Generate/Email Credit/Debit Memo Sequel Report    */
/*-----------------------------------------------------------------*/

             SBMJOB     CMD(REPORT REPORT(SEABOARD/CDM812RPT) +
                          SETVAR((&MSGLOG# &MSGLOG#)) PCFMT(*PDF) +
                          RECIPIENT(&EMAIL)) +
                          JOB(ECDIN) USER(*CURRENT) +
                          INLLIBL(*CURRENT) LOG(4 00 *SECLVL)

