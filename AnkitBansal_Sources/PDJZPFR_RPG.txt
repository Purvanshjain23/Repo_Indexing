     H/TITLE U1LP Upd 1st Lvl Plan PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 07/17/18  Time  : 10:11:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAQREL1IF  E           K        DISK
      * RTV : Company Defaults          Retrieval index       NV
      *
     FPDI0REL1IF  E           K        DISK
      * RTV : PS Cutout Matrix          Retrieval index
      *
     FPDI4REL1IF  E           K        DISK
      * RTV : PS Cutout Item            Retrieval index
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDIZREL4IF  E           K        DISK
      * RSQ : PS Cutout Dist Lean %     Co/Mtx/MoDy/Mn/Mx/Pop%-d
      *
     FPDI4REL3IF  E           K        DISK
      * RTV : PS Cutout Item            Retrieval index 2
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDJCCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Schedule          Update index
      *
     FPDJZPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: U1LP Upd 1st Lvl Plan PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WBAIC3
     I              I8V5ST                          WBV5ST
     I              I8ELDT                          WBELDT
     I              I8HGCD                          WBHGCD
     I              I8AJCD                          WBAJCD
     I              I8GPDT                          WBGPDT
     I              I8WTSP                          WBWTSP
     I              I8QTSP                          WBQTSP
     I              I8DJPC                          WBDJPC
     I              I8F8WG                          WBF8WG
     I              I8WTIN                          WBWTIN
     I              I8D5NB                          WBD5NB
     I              I8DXWG                          WBDXWG
     I              I8B2NB                          WBB2NB
     I              I8WTCN                          WBWTCN
     I              I8PSCV                          WBPSCV
     I              I8SAWT                          WBSAWT
     I              I8B9NB                          WBB9NB
     I              I8D1WG                          WBD1WG
     I              I8CBNB                          WBCBNB
     I              I8EZWG                          WBEZWG
     I              I8CCNB                          WBCCNB
     I              I8E0WG                          WBE0WG
     I              I8D6NB                          WBD6NB
     I              I8OAWT                          WBOAWT
     I              I8CDNB                          WBCDNB
     I              I8UNW2                          WBUNW2
     I              I8CENB                          WBCENB
     I              I8F9WG                          WBF9WG
     I              I8BPNB                          WBBPNB
     I              I8GAWG                          WBGAWG
     I              I8BQNB                          WBBQNB
     I              I8GBWG                          WBGBWG
     I              I8BRNB                          WBBRNB
     I              I8GCWG                          WBGCWG
     I              I8BSNB                          WBBSNB
     I              I8GDWG                          WBGDWG
     I              I8BWNB                          WBBWNB
     I              I8GEWG                          WBGEWG
     I              I8PS6U                          WBPS6U
     I              I8WCST                          WBWCST
     I              I8WPST                          WBWPST
     I              I8B5ST                          WBB5ST
     I              I8TFST                          WBTFST
     I              I8TEST                          WBTEST
     I              I8THST                          WBTHST
     I              I8UDST                          WBUDST
     I              I8UFST                          WBUFST
     I              I8UGST                          WBUGST
     I              I8UHST                          WBUHST
     I              I8B6ST                          WBB6ST
     I              I8B7ST                          WBB7ST
     I              I8DVWG                          WBDVWG
     I              I8D7NB                          WBD7NB
     I              I8FCAD                          WBFCAD
     I              I8D9NB                          WBD9NB
     I              I8DWWG                          WBDWWG
     I              I8EANB                          WBEANB
     I              I8SHWT                          WBSHWT
     I              I8EBNB                          WBEBNB
     I              I8AVWT                          WBAVWT
     I              I8ECNB                          WBECNB
     I              I8WTON                          WBWTON
     I              I8EDNB                          WBEDNB
     I              I8FNWT                          WBFNWT
     I              I8EENB                          WBEENB
     I              I8QTAS                          WBQTAS
     I              I8EFNB                          WBEFNB
     I              I8WAIO                          WBWAIO
     I              I8EGNB                          WBEGNB
     I              I8R3CD                          WBR3CD
     I              I8RGNB                          WBRGNB
     I              I8RHNB                          WBRHNB
     I              I8RINB                          WBRINB
     I              I8XRCD                          WBXRCD
     I              I8UVST                          WBUVST
     I              I8UWST                          WBUWST
     I              I8UXST                          WBUXST
     I              I8VSST                          WBVSST
     I              I8AATM                          WBAATM
     I              I8AYNA                          WBAYNA
     I              I8A0NA                          WBA0NA
     I              I8AXDT                          WBAXDT
      *
     I@IZREFQ
      * PS Cutout Dist Lean %     Co/Mtx/MoDy/Mn/Mx/Pop%-d
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     I@I4REFR
      * PS Cutout Item            Retrieval index 2
      * Renamed input format fields
     I              I4AIC3                          WDAIC3
     I              I4RXCD                          WDRXCD
     I              I4GHDT                          WDGHDT
     I              I4UPNB                          WDUPNB
     I              I4UQNB                          WDUQNB
     I              I4ULNB                          WDULNB
     I              I4HGCD                          WDHGCD
     I              I4UTNB                          WDUTNB
     I              I4XRCD                          WDXRCD
     I              I4UVST                          WDUVST
     I              I4UWST                          WDUWST
     I              I4UXST                          WDUXST
     I              I4VSST                          WDVSST
     I              I4AATM                          WDAATM
     I              I4AYNA                          WDAYNA
     I              I4A0NA                          WDA0NA
     I              I4AXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WBAIC3
     I              I8V5ST                          WBV5ST
     I              I8ELDT                          WBELDT
     I              I8HGCD                          WBHGCD
     I              I8AJCD                          WBAJCD
     I              I8GPDT                          WBGPDT
     I              I8WTSP                          WBWTSP
     I              I8QTSP                          WBQTSP
     I              I8DJPC                          WBDJPC
     I              I8F8WG                          WBF8WG
     I              I8WTIN                          WBWTIN
     I              I8D5NB                          WBD5NB
     I              I8DXWG                          WBDXWG
     I              I8B2NB                          WBB2NB
     I              I8WTCN                          WBWTCN
     I              I8PSCV                          WBPSCV
     I              I8SAWT                          WBSAWT
     I              I8B9NB                          WBB9NB
     I              I8D1WG                          WBD1WG
     I              I8CBNB                          WBCBNB
     I              I8EZWG                          WBEZWG
     I              I8CCNB                          WBCCNB
     I              I8E0WG                          WBE0WG
     I              I8D6NB                          WBD6NB
     I              I8OAWT                          WBOAWT
     I              I8CDNB                          WBCDNB
     I              I8UNW2                          WBUNW2
     I              I8CENB                          WBCENB
     I              I8F9WG                          WBF9WG
     I              I8BPNB                          WBBPNB
     I              I8GAWG                          WBGAWG
     I              I8BQNB                          WBBQNB
     I              I8GBWG                          WBGBWG
     I              I8BRNB                          WBBRNB
     I              I8GCWG                          WBGCWG
     I              I8BSNB                          WBBSNB
     I              I8GDWG                          WBGDWG
     I              I8BWNB                          WBBWNB
     I              I8GEWG                          WBGEWG
     I              I8PS6U                          WBPS6U
     I              I8WCST                          WBWCST
     I              I8WPST                          WBWPST
     I              I8B5ST                          WBB5ST
     I              I8TFST                          WBTFST
     I              I8TEST                          WBTEST
     I              I8THST                          WBTHST
     I              I8UDST                          WBUDST
     I              I8UFST                          WBUFST
     I              I8UGST                          WBUGST
     I              I8UHST                          WBUHST
     I              I8B6ST                          WBB6ST
     I              I8B7ST                          WBB7ST
     I              I8DVWG                          WBDVWG
     I              I8D7NB                          WBD7NB
     I              I8FCAD                          WBFCAD
     I              I8D9NB                          WBD9NB
     I              I8DWWG                          WBDWWG
     I              I8EANB                          WBEANB
     I              I8SHWT                          WBSHWT
     I              I8EBNB                          WBEBNB
     I              I8AVWT                          WBAVWT
     I              I8ECNB                          WBECNB
     I              I8WTON                          WBWTON
     I              I8EDNB                          WBEDNB
     I              I8FNWT                          WBFNWT
     I              I8EENB                          WBEENB
     I              I8QTAS                          WBQTAS
     I              I8EFNB                          WBEFNB
     I              I8WAIO                          WBWAIO
     I              I8EGNB                          WBEGNB
     I              I8R3CD                          WBR3CD
     I              I8RGNB                          WBRGNB
     I              I8RHNB                          WBRHNB
     I              I8RINB                          WBRINB
     I              I8XRCD                          WBXRCD
     I              I8UVST                          WBUVST
     I              I8UWST                          WBUWST
     I              I8UXST                          WBUXST
     I              I8VSST                          WBVSST
     I              I8AATM                          WBAATM
     I              I8AYNA                          WBAYNA
     I              I8A0NA                          WBA0NA
     I              I8AXDT                          WBAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDJC1    E DSPDJCCPL0
      * UPD : PS Prod Schedule          Update index
      *
     IYBRDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Cutout Item
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Cutout Matrix Code
     I                                        3   8 P1RXCD
      * I : RST Effective Month/Day
     I                                    P   9  110P1GHDT
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Kill Date
     I                                    P   1   40P2GGDT
      * I :  Production Date
     I                                    P   5   80P2ELDT
      * I :  Hog Volume
     I                                    P   9  110P2HVHD
     IP3PARM      DS
      * FLD: Company Item
      * N :  Description Line One
     I                                        1  30 P3AVNA
      * N :  U/M - Primary
     I                                       31  32 P3ADCD
      * N :  Unit Weight
     I                                    P  33  382P3AIWG
      * N :  Item Structure Class Code
     I                                    P  39  400P3RINB
      * N :  Item Structure Group Code
     I                                    P  41  420P3RHNB
      * N :  Item Structure Type Code
     I                                    P  43  440P3RGNB
      * N :  Item Type Code
     I                                       45  47 P3N0CD
      * N :  Default Warehouse
     I                                       48  50 P3Q1CD
      * N :  Fresh Chilling Time
     I                                    P  51  532P3CHTM
      * N :  Base/Conv/Loss Item
     I                                       54  55 P3QZCD
      * N :  Variety/Rendered/Cut
     I                                       56  56 P3XWST
      * N :  Credit Item Status
     I                                       57  57 P3VMST
      * N :  Std Weight/Head (Var/Ren)
     I                                    P  58  632P3SWGH
      * N :  Pieces Per Head
     I                                    P  64  670P3PPHE
      * N :  Department Code
     I                                       68  73 P3R3CD
      * N :  Group for Packaging
     I                                       74  74 P3SDCD
      * N :  Seconds Item
     I                                       75  75 P3X5ST
      * N :  Piece Count Item
     I                                       76  76 P3PCCT
      * N :  Pieces Per Bag
     I                                    P  77  800P3BDNB
      * N :  Bags Per Unit
     I                                    P  81  840P3BJNB
      * N :  Export/Domestic
     I                                       85  85 P3SUST
      * N :  Print On Schedule
     I                                       86  86 P3SVST
      * N :  Fresh Inv Allocation Seq
     I                                       87  87 P3SYST
      * N :  Fresh Sched As Ordered
     I                                       88  88 P3SZST
      * N :  Frozen Inv Allocation Seq
     I                                       89  89 P3S1ST
      * N :  Primal Group Code
     I                                       90  95 P3XRCD
     IP4PARM      DS
      * FLD: PS Cutout Dist Lean %
      * N :  Average Cold Wgt
     I                                    P   1   20P4UNNB
      * N :  Population Percent
     I                                    P   3   75P4UONB
      * N :  Average Lean Percent
     I                                    P   8  102P4DIPC
      * N :  Average Backfat Inches
     I                                    P  11  132P4Z0NB
      * N :  Average Loin-Eye Depth
     I                                    P  14  162P4AVLE
     IP5PARM      DS
      * FLD: PS Cutout Weight Range
      * N :  Cooler Shrink Percent
     I                                    P   1   32P5DGPC
      * N :  Std Dressing Yield %
     I                                    P   4   62P5V0NB
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Number of Carcasses
     I                                    P   1   30P6QTYX
      * N :  Population Cold Wgt USR
     I                                    P   4   82P6D9WG
      * N :  Population Live Wgt USR
     I                                    P   9  132P6EBWG
      * N :  Average Live Weight
     I                                    P  14  160P6Z6NB
      * N :  Average Backfat * Wgt USR
     I                                    P  17  212P6ZVNB
      * N :  Average BackFt WR Tot USR
     I                                    P  22  262P6ABWR
      * N :  Average Loin-I * Wgt USR
     I                                    P  27  312P6ZUNB
      * N :  Average Loin-I WR Tot USR
     I                                    P  32  362P6AIWR
      * N :  Average Lean % Total USR
     I                                    P  37  402P6DUPC
      * N :  Average Lean% WR Tot USR
     I                                    P  41  482P6ALWR
      * N :  Hot Weight Tot USR
     I                                    P  49  540P6UGNB
      * N :  Live Weight Tot USR
     I                                    P  55  580P6ZTNB
      * N :  Warehouse Type
     I                                       59  60 P6WPST
      * N :  PS Item Id
     I                                       61  63 P6WCST
      * N :  Weight Allocated USR
     I                                    P  64  682P6E1WG
      * N :  Carcasses Allocated USR
     I                                    P  69  730P6CRAL
      * N :  Average Hot Weight USR
     I                                    P  74  762P6AVHW
      * N :  Population Hot Wgt USR
     I                                    P  77  812P6E2WG
     IP7PARM      DS
      * N :  Hog Volume USR
     I                                    P   1   30P7HVUS
     IP8PARM      DS
      * FLD: PS Prod Item Schedule
      * I :  Production Type
     I                                        1   1 P8V5ST
     IP9PARM      DS
      * FLD: Warehouse
      * N :  Trans Contol AS400/Plant
     I                                        1   1 P9XUST
      * N :  Warehouse Location
     I                                        2   2 P9T0ST
      * N :  Warehouse Std Chill Time
     I                                        3   3 P9T1ST
      * N :  Warehouse Chill Time
     I                                    P   4   62P9DBNB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1RXCD    PARM           WP0002  6        Cutout Matrix C
     C           P1GHDT    PARM           WP0003  40       Effective Month
     C           P2GGDT    PARM           WP0004  70       Kill Date
     C           P2ELDT    PARM           WP0005  70       Production Date
     C           P2HVHD    PARM           WP0006  50       Hog Volume
     C           P8V5ST    PARM           WP0007  1        Production Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * U1LP Upd 1st Lvl Plan PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$MENDRPT
      * USER: On print of end of report format
      * CASE: PAR.Hot Weight Tot USR is GT Zero
     C           P6UGNB    IFGT *ZERO                      *IF
      * U1LP Upd Carc Yield   RT - PS Prod Item Schedule  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * U1LP Upd 1st Lvl Plan PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN I4AIC3    WQKA01           Company Number
     C           *LIKE     DEFN I4RXCD    WQKA02           Cutout Matrix C
     C           *LIKE     DEFN I4GHDT    WQKA03           Effective Month
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Cutout Matrix C
     C                     KFLD           WQKA03           Effective Month
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     MOVELP1RXCD    WQKA02           Cutout Matrix C
     C                     Z-ADDP1GHDT    WQKA03           Effective Month
      * Establish starting position
     C           KRSA      SETLL@I4RETX                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0AL02  1        Effective Month
     C                     MOVEL'Y'       W0AL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0AL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0AL05  1        Lean Percent
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BHVHD           Hog Volume
      * USER: Process before print of first page format
     C                     Z-ADDP2HVHD    $BHVHD           Hog Volume
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI4AIC3    $CAIC3           Company Number
     C                     Z-ADD*ZERO     $CELDT           Production Date
      * Load related totals format
     C                     Z-ADDI4AIC3    $IAIC3           Company Number
     C                     Z-ADD*ZERO     $ICRAL           Carcasses Alloc
     C                     Z-ADD*ZERO     $IZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     $IAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     $IZ0NB           Average Backfat
     C                     Z-ADD*ZERO     $IDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     $IZ6NB           Average Live We
      * USER: Process before print of Accounting Company Number format
     C                     Z-ADDP2ELDT    $CELDT           Production Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI4AIC3    $DAIC3           Company Number
     C                     MOVELI4RXCD    $DRXCD           Cutout Matrix C
     C                     MOVEL*BLANK    $DHLTX           Condition Desc.
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI4AIC3    $EAIC3           Company Number
     C                     MOVELI4RXCD    $ERXCD           Cutout Matrix C
     C                     Z-ADDI4GHDT    $EGHDT           Effective Month
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI4AIC3    $FAIC3           Company Number
     C                     MOVELI4RXCD    $FRXCD           Cutout Matrix C
     C                     Z-ADDI4GHDT    $FGHDT           Effective Month
     C                     Z-ADDI4UPNB    $FUPNB           Min Carcass Wei
     C                     Z-ADDI4UQNB    $FUQNB           Max Carcass Wei
     C                     Z-ADDI4ULNB    $FULNB           Lean Percent
     C                     Z-ADD*ZERO     $FUONB           Population Perc
     C                     Z-ADD*ZERO     $FQTYX           Number of Carca
     C                     Z-ADD*ZERO     $FUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     $FD9WG           Population Cold
     C                     Z-ADD*ZERO     $FE2WG           Population Hot
     C                     Z-ADD*ZERO     $FZ0NB           Average Backfat
     C                     Z-ADD*ZERO     $FV0NB           Std Dressing Yi
     C                     Z-ADD*ZERO     $FAVHW           Average Hot Wei
     C                     Z-ADD*ZERO     $FDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     $FDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     $FZ6NB           Average Live We
     C                     Z-ADD*ZERO     $FEBWG           Population Live
     C                     Z-ADD*ZERO     $FAVLE           Average Loin-Ey
      * Load related totals format
     C                     Z-ADDI4AIC3    $HAIC3           Company Number
     C                     MOVELI4RXCD    $HRXCD           Cutout Matrix C
     C                     Z-ADDI4GHDT    $HGHDT           Effective Month
     C                     Z-ADDI4UPNB    $HUPNB           Min Carcass Wei
     C                     Z-ADDI4UQNB    $HUQNB           Max Carcass Wei
     C                     Z-ADDI4ULNB    $HULNB           Lean Percent
     C                     Z-ADD*ZERO     $HDXPC           Percent of Carc
     C                     Z-ADD*ZERO     $HEAWG           Weight Sched Pr
     C                     Z-ADD*ZERO     $HZSNB           Pieces Sched Pr
      * USER: Process before print of Lean Percent format
      * Rtv Dist Info         RT - PS Cutout Dist Lean %  * 
     C                     EXSR SERVGN
      * CLC: Number of Carcasses
      * PAR.Number of Carcasses =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.Hog Volume
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.Population Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           P4UONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           P2HVHD    MULT W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P6QTYX           Number of Carca
     C                     ADD  P6QTYX    P6CRAL           Carcasses Alloc
     C                     Z-ADD$FUQNB    P6AVHW           Average Hot Wei
      * Average Cold Weight
      * PAR.Average Cold Wgt =
      *    *COMPUTE (x1 * (x2 - (x3 / x4)))
      * x1    : PAR.Average Hot Weight USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : CON.1
      * -     : PGM.*Synon (15,5) work field
      * x3    : PAR.Cooler Shrink Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           P5DGPC    DIV  100       W0WB02    H      *Synon (15,5) w
     C           1         SUB  W0WB02    W0WB01           *Synon (15,5) w
     C           P6AVHW    MULT W0WB01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    P4UNNB           Average Cold Wg
     C           P6QTYX    MULT P4UNNB    P6D9WG           Population Cold
     C           P6QTYX    MULT P6AVHW    P6E2WG           Population Hot
     C                     Z-ADDP6D9WG    P6E1WG           Weight Allocate
      * CUR = PAR By name
     C                     Z-ADDP1AIC3    $FAIC3           Company Number
     C                     MOVELP1RXCD    $FRXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    $FGHDT           Effective Month
     C                     Z-ADDP4UONB    $FUONB           Population Perc
     C                     Z-ADDP6QTYX    $FQTYX           Number of Carca
     C                     Z-ADDP4UNNB    $FUNNB           Average Cold Wg
     C                     Z-ADDP6D9WG    $FD9WG           Population Cold
     C                     Z-ADDP6E2WG    $FE2WG           Population Hot
     C                     Z-ADDP4Z0NB    $FZ0NB           Average Backfat
     C                     Z-ADDP5V0NB    $FV0NB           Std Dressing Yi
     C                     Z-ADDP6AVHW    $FAVHW           Average Hot Wei
     C                     Z-ADDP4DIPC    $FDIPC           Average Lean Pe
     C                     Z-ADDP5DGPC    $FDGPC           Cooler Shrink P
     C                     Z-ADDP6Z6NB    $FZ6NB           Average Live We
     C                     Z-ADDP6EBWG    $FEBWG           Population Live
     C                     Z-ADDP4AVLE    $FAVLE           Average Loin-Ey
      * SEQ: Accumulations
     C                     EXSR UASUBR                     SEQ: Accumulati
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI4AIC3    $GAIC3           Company Number
     C                     MOVELI4RXCD    $GRXCD           Cutout Matrix C
     C                     Z-ADDI4GHDT    $GGHDT           Effective Month
     C                     Z-ADDI4UPNB    $GUPNB           Min Carcass Wei
     C                     Z-ADDI4UQNB    $GUQNB           Max Carcass Wei
     C                     Z-ADDI4ULNB    $GULNB           Lean Percent
     C                     Z-ADDI4HGCD    $GHGCD           Item Code
     C                     MOVEL*BLANK    $GAVNA           Description Lin
     C                     Z-ADDI4UTNB    $GUTNB           Percent of Carc
     C                     MOVELI4XRCD    $GXRCD           Primal Group Co
     C                     Z-ADD*ZERO     $GQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     $GPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     $GSPPS           Pieces Sched Pr
     C                     Z-ADD*ZERO     $GRGNB           Item Structure
     C                     Z-ADD*ZERO     $GRHNB           Item Structure
     C                     Z-ADD*ZERO     $GRINB           Item Structure
     C                     MOVEL*BLANK    $GQ1CD           Default Warehou
     C                     MOVEL*BLANK    $GR3CD           Department Code
     C                     MOVEL*BLANK    $GSDCD           Group for Packa
     C                     MOVELI4UVST    $GUVST           EDI Status 1
     C                     MOVELI4UWST    $GUWST           EDI Status 2
     C                     MOVELI4UXST    $GUXST           EDI Status 3
     C                     MOVELI4VSST    $GVSST           Record Status
     C                     Z-ADDI4AATM    $GAATM           Job Time
     C                     MOVELI4AYNA    $GAYNA           User Id
     C                     MOVELI4A0NA    $GA0NA           Job Name
     C                     Z-ADDI4AXDT    $GAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: PAR.Population Cold Wgt USR is GT Zero
     C           P6D9WG    IFGT *ZERO                      *IF
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0003           Company Number
     C                     Z-ADD$GHGCD    WL0004           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    P3AVNA    P      Description Lin
     C                     MOVELWL0006    P3ADCD    P      U/M - Primary
     C                     Z-ADDWL0007    P3AIWG           Unit Weight
     C                     Z-ADDWL0008    P3RINB           Item Structure
     C                     Z-ADDWL0009    P3RHNB           Item Structure
     C                     Z-ADDWL0010    P3RGNB           Item Structure
     C                     MOVELWL0011    P3N0CD    P      Item Type Code
     C                     MOVELWL0012    P3Q1CD    P      Default Warehou
     C                     Z-ADDWL0013    P3CHTM           Fresh Chilling
     C                     MOVELWL0014    P3QZCD    P      Base/Conv/Loss
     C                     MOVELWL0015    P3XWST    P      Variety/Rendere
     C                     MOVELWL0016    P3VMST    P      Credit Item Sta
     C                     Z-ADDWL0017    P3SWGH           Std Weight/Head
     C                     Z-ADDWL0018    P3PPHE           Pieces Per Head
     C                     MOVELWL0019    P3R3CD    P      Department Code
     C                     MOVELWL0020    P3SDCD    P      Group for Packa
     C                     MOVELWL0021    P3X5ST    P      Seconds Item
     C                     MOVELWL0022    P3PCCT    P      Piece Count Ite
     C                     Z-ADDWL0023    P3BDNB           Pieces Per Bag
     C                     Z-ADDWL0024    P3BJNB           Bags Per Unit
     C                     MOVELWL0025    P3SUST    P      Export/Domestic
     C                     MOVELWL0026    P3SVST    P      Print On Schedu
     C                     MOVELWL0027    P3SYST    P      Fresh Inv Alloc
     C                     MOVELWL0028    P3SZST    P      Fresh Sched As
     C                     MOVELWL0029    P3S1ST    P      Frozen Inv Allo
     C                     MOVELWL0030    P3XRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3Q1CD    WL0031    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0032    P6WPST    P      Warehouse Type
     C                     MOVELWL0033    P9XUST    P      Trans Contol AS
     C                     MOVELWL0034    P9T0ST    P      Warehouse Locat
     C                     MOVELWL0035    P9T1ST    P      Warehouse Std C
     C                     Z-ADDWL0036    P9DBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           P3N0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           P3X5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           P3XWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           P3XWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           P3XWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           P3VMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           P3QZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           P3QZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           P3QZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           P3QZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     P6WCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           P3QZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           P3QZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           P3QZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     P6WCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           P3QZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     P6WCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           I4UTNB    DIV  100       WUD4PC    H      Percent 7.4 USR
     C           P6D9WG    MULT WUD4PC    $GQTAS    H      PS Weight Sched
      * Allocate Population Cold Weight
      * CASE: CUR.PS Weight Sched Prod GT PAR.Weight Allocated USR
     C           $GQTAS    IFGT P6E1WG                     *IF
     C                     Z-ADDP6E1WG    $GQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     P6E1WG           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $GQTAS    P6E1WG           Weight Allocate
     C                     END                             *FI
     C           P6QTYX    MULT P3PPHE    $GSPPS           Pieces Sched Pr
      * CUR = PAR By name
     C                     Z-ADDP1AIC3    $GAIC3           Company Number
     C                     MOVELP1RXCD    $GRXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    $GGHDT           Effective Month
     C                     MOVELP3AVNA    $GAVNA           Description Lin
     C                     MOVELP3XRCD    $GXRCD           Primal Group Co
     C                     Z-ADDP3PPHE    $GPPHE           Pieces Per Head
     C                     Z-ADDP3RGNB    $GRGNB           Item Structure
     C                     Z-ADDP3RHNB    $GRHNB           Item Structure
     C                     Z-ADDP3RINB    $GRINB           Item Structure
     C                     MOVELP3Q1CD    $GQ1CD           Default Warehou
     C                     MOVELP3R3CD    $GR3CD           Department Code
     C                     MOVELP3SDCD    $GSDCD           Group for Packa
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $GUTNB    $HDXPC           Percent of Carc
     C                     ADD  $GQTAS    $HEAWG           Weight Sched Pr
     C                     ADD  $GSPPS    $HZSNB           Pieces Sched Pr
      * CASE: CUR.PS Weight Sched Prod is Not Entered
     C           $GQTAS    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * U1LP Upd Prd Plan Dtl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0037           Company Number
     C                     MOVELP8V5ST    WL0038    P      Production Type
     C                     Z-ADDP2ELDT    WL0039           Production Date
     C                     Z-ADD$GHGCD    WL0040           Item Code
     C                     MOVELP3Q1CD    WL0041    P      Warehouse Code
     C                     Z-ADD$GQTAS    WL0042           PS Weight Plann
     C                     Z-ADD$GSPPS    WL0043           PS Pieces Plann
     C                     MOVELP6WCST    WL0044    P      PS Item Id
     C                     MOVELP6WPST    WL0045    P      Warehouse Type
     C                     MOVELP3SUST    WL0046    P      PS Export/Domes
     C                     MOVELP3SVST    WL0047    P      PS Print On Sch
     C                     MOVELP3PCCT    WL0048    P      PS Piece Count
     C                     MOVELP3R3CD    WL0049    P      Department Code
     C                     Z-ADDP3RGNB    WL0050           Item Structure
     C                     Z-ADDP3RHNB    WL0051           Item Structure
     C                     Z-ADDP3RINB    WL0052           Item Structure
     C                     MOVELP3XRCD    WL0053    P      Primal Group Co
     C                     MOVELP3VMST    WL0054    P      Credit Item Sta
     C                     MOVELP3QZCD    WL0055    P      Base/Conv/Loss
     C                     Z-ADDP3CHTM    WL0056           Fresh Chilling
     C                     MOVELP3XWST    WL0057    P      Variety/Rendere
     C                     MOVELP3X5ST    WL0058    P      Seconds Item
     C                     MOVELP9T1ST    WL0059    P      Warehouse Std C
     C                     Z-ADDP9DBNB    WL0060           Warehouse Chill
     C                     EXSR SHRVGN
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I4AIC3    WZA001           Company Number
     C                     Z-ADDI4AIC3    WZA001
     C           *LIKE     DEFN I4RXCD    WZA002           Cutout Matrix C
     C                     MOVELI4RXCD    WZA002
     C           *LIKE     DEFN I4GHDT    WZA003           Effective Month
     C                     Z-ADDI4GHDT    WZA003
     C           *LIKE     DEFN I4UPNB    WZA004           Min Carcass Wei
     C                     Z-ADDI4UPNB    WZA004
     C           *LIKE     DEFN I4UQNB    WZA005           Max Carcass Wei
     C                     Z-ADDI4UQNB    WZA005
     C           *LIKE     DEFN I4ULNB    WZA006           Lean Percent
     C                     Z-ADDI4ULNB    WZA006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@I4RETX                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Cutout Matrix C
     C                     MOVEL*BLANK    W0AL02  1        Effective Month
     C                     MOVEL*BLANK    W0AL03  1        Min Carcass Wei
     C                     MOVEL*BLANK    W0AL04  1        Max Carcass Wei
     C                     MOVEL*BLANK    W0AL05  1        Lean Percent
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0AL02  1        Effective Month
     C                     MOVEL'Y'       W0AL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0AL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0AL05  1        Lean Percent
     C                     ELSE
      * Next record - Detect level breaks
     C           I4AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           I4RXCD    IFNE WZA002                     Cutout Matrix C
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           I4GHDT    IFNE WZA003                     Effective Month
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           I4UPNB    IFNE WZA004                     Min Carcass Wei
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           I4UQNB    IFNE WZA005                     Max Carcass Wei
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           I4ULNB    IFNE WZA006                     Lean Percent
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL05    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Lean Percent format
      * CASE: PAR.Population Cold Wgt USR is LE Zero
     C           P6D9WG    IFLE *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Accounting Company Number format
     C                     Z-ADDP6CRAL    $ICRAL           Carcasses Alloc
      * Calculate Averages based on Carcasses Allocated
      * CASE: PAR.Carcasses Allocated USR GT WRK.ZERO
     C           P6CRAL    IFGT WUW0NB                     *IF
     C           P6UGNB    DIV  $ICRAL    $IZ7NB    H      Average Hot Wei
     C                     END                             *FI
      * CASE: PAR.Carcasses Allocated USR LT PAR.Hog Volume
     C           P6CRAL    IFLT P2HVHD                     *IF
     C           P2HVHD    SUB  P6CRAL    WUCC9U           Carcass Count 9
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCC9U           Carcass Count 9
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $IAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$IAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VIAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$IKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
      * PRTOBJ calls after print of Accounting Company Number format
      * Embedded PRTOBJ : U1LP Alc Carc by Pop% PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * USER: Process after print of Accounting Company Number format
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
     C                     EXSR SNCRRC
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * U1LP Alc Carc by Pop% PO: Mainline
      *================================================================
      * U1LP Alc Carc by Pop% PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WCRXCD    WQKB02           Cutout Matrix C
     C           *LIKE     DEFN WCGHDT    WQKB03           Effective Month
     C           *LIKE     DEFN WCUPNB    WQKB04           Min Carcass Wei
     C           *LIKE     DEFN WCUQNB    WQKB05           Max Carcass Wei
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Cutout Matrix C
     C                     KFLD           WQKB03           Effective Month
     C                     KFLD           WQKB04           Min Carcass Wei
     C                     KFLD           WQKB05           Max Carcass Wei
      * Setup key
     C                     Z-ADDP1AIC3    WQKB01           Company Number
     C                     MOVELP1RXCD    WQKB02           Cutout Matrix C
     C                     Z-ADDP1GHDT    WQKB03           Effective Month
     C                     Z-ADD$IZ7NB    WQKB04           Min Carcass Wei
     C                     Z-ADD$IZ7NB    WQKB05           Max Carcass Wei
      * Establish starting position
     C           KRSB      SETLL@IZREFQ                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0BL02  1        Effective Month
     C                     MOVEL'Y'       W0BL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0BL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0BL05  1        Population Perc
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $JAIC3           Company Number
     C                     MOVELWCRXCD    $JRXCD           Cutout Matrix C
     C                     Z-ADDWCGHDT    $JGHDT           Effective Month
     C                     Z-ADDWCULNB    $JULNB           Lean Percent
     C                     Z-ADD*ZERO     $JCC9U           Carcass Count 9
     C                     Z-ADDWCUPNB    $JUPNB           Min Carcass Wei
     C                     Z-ADDWCDIPC    $JDIPC           Average Lean Pe
     C                     Z-ADDWCAVLE    $JAVLE           Average Loin-Ey
     C                     Z-ADDWCQPNX    $JQPNX           Population Head
     C                     Z-ADDWCZ0NB    $JZ0NB           Average Backfat
     C                     Z-ADD*ZERO     $JD9WG           Population Cold
     C                     Z-ADDWCUQNB    $JUQNB           Max Carcass Wei
     C                     Z-ADDWCUNNB    $JUNNB           Average Cold Wg
     C                     Z-ADDWCUONB    $JUONB           Population Perc
     C                     MOVELWCUVST    $JUVST           EDI Status 1
     C                     MOVELWCUWST    $JUWST           EDI Status 2
     C                     MOVELWCUXST    $JUXST           EDI Status 3
     C                     MOVELWCVSST    $JVSST           Record Status
     C                     Z-ADDWCAATM    $JAATM           Job Time
     C                     MOVELWCAYNA    $JAYNA           User Id
     C                     MOVELWCA0NA    $JA0NA           Job Name
     C                     Z-ADDWCAXDT    $JAXDT           Job Date
      * USER: Process before print of detail format
      * CUR = PAR By name
     C                     Z-ADDP1AIC3    $JAIC3           Company Number
     C                     MOVELP1RXCD    $JRXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    $JGHDT           Effective Month
     C                     Z-ADDWUCC9U    $JCC9U           Carcass Count 9
     C                     Z-ADD$IZ7NB    $JUPNB           Min Carcass Wei
     C                     Z-ADD$IZ7NB    $JUQNB           Max Carcass Wei
     C                     Z-ADDWCUQNB    WN0146           Average Hot Wei
     C           $JCC9U    MULT WN0146    $JD9WG           Population Cold
     C           $JCC9U    MULT WN0146    WN0147           Population Hot
      * Accumulations
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
     C           WN0147    MULT $JZ0NB    WN0143    H      Average Backfat
     C                     ADD  WN0143    P6ABWR           Average BackFt
     C           WN0147    MULT $JAVLE    WN0144    H      Average Loin-I
     C                     ADD  WN0144    P6AIWR           Average Loin-I
      * CLC: Lean%
      * PAR.Average Lean % Total USR =
      *    *COMPUTE (x1 * (x2))
      * x1    : PAR.Population Hot Wgt USR
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CUR.Average Lean Percent
     C           WN0147    MULT $JDIPC    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0145           Average Lean %
     C                     ADD  WN0145    P6ALWR           Average Lean% W
     C                     ADD  WN0147    P6UGNB           Hot Weight Tot
     C                     ADD  WUEBWG    P6ZTNB           Live Weight Tot
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : U1LP Alc Carc by Pop% PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZB001           Company Number
     C                     Z-ADDWCAIC3    WZB001
     C           *LIKE     DEFN WCRXCD    WZB002           Cutout Matrix C
     C                     MOVELWCRXCD    WZB002
     C           *LIKE     DEFN WCGHDT    WZB003           Effective Month
     C                     Z-ADDWCGHDT    WZB003
     C           *LIKE     DEFN WCUPNB    WZB004           Min Carcass Wei
     C                     Z-ADDWCUPNB    WZB004
     C           *LIKE     DEFN WCUQNB    WZB005           Max Carcass Wei
     C                     Z-ADDWCUQNB    WZB005
     C           *LIKE     DEFN WCUONB    WZB006           Population Perc
     C                     Z-ADDWCUONB    WZB006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@IZREFQ                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * End of File 'B' - /UT User Source  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE 'B'
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Cutout Matrix C
     C                     MOVEL*BLANK    W0BL02  1        Effective Month
     C                     MOVEL*BLANK    W0BL03  1        Min Carcass Wei
     C                     MOVEL*BLANK    W0BL04  1        Max Carcass Wei
     C                     MOVEL*BLANK    W0BL05  1        Population Perc
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0BL02  1        Effective Month
     C                     MOVEL'Y'       W0BL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0BL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0BL05  1        Population Perc
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WCRXCD    IFNE WZB002                     Cutout Matrix C
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WCGHDT    IFNE WZB003                     Effective Month
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WCUPNB    IFNE WZB004                     Min Carcass Wei
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           WCUQNB    IFNE WZB005                     Max Carcass Wei
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           WCUONB    IFNE WZB006                     Population Perc
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * U1LP Alc Carc by Pop  PO: Mainline
      *================================================================
      * U1LP Alc Carc by Pop  PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WDRXCD    WQKC02           Cutout Matrix C
     C           *LIKE     DEFN WDGHDT    WQKC03           Effective Month
     C           *LIKE     DEFN WDUPNB    WQKC04           Min Carcass Wei
     C           *LIKE     DEFN WDUQNB    WQKC05           Max Carcass Wei
     C           *LIKE     DEFN WDULNB    WQKC06           Lean Percent
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Cutout Matrix C
     C                     KFLD           WQKC03           Effective Month
     C                     KFLD           WQKC04           Min Carcass Wei
     C                     KFLD           WQKC05           Max Carcass Wei
     C                     KFLD           WQKC06           Lean Percent
      * Setup key
     C                     Z-ADD$JAIC3    WQKC01           Company Number
     C                     MOVEL$JRXCD    WQKC02           Cutout Matrix C
     C                     Z-ADD$JGHDT    WQKC03           Effective Month
     C                     Z-ADD$JUPNB    WQKC04           Min Carcass Wei
     C                     Z-ADD$JUQNB    WQKC05           Max Carcass Wei
     C                     Z-ADD$JULNB    WQKC06           Lean Percent
      * Establish starting position
     C           KRSC      SETLL@I4REFR                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0CL02  1        Effective Month
     C                     MOVEL'Y'       W0CL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0CL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0CL05  1        Lean Percent
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWDAIC3    $LAIC3           Company Number
     C                     MOVELWDRXCD    $LRXCD           Cutout Matrix C
     C                     Z-ADDWDGHDT    $LGHDT           Effective Month
     C                     Z-ADDWDUPNB    $LUPNB           Min Carcass Wei
     C                     Z-ADDWDUQNB    $LUQNB           Max Carcass Wei
     C                     Z-ADDWDULNB    $LULNB           Lean Percent
     C                     Z-ADD*ZERO     $LDXPC           Percent of Carc
     C                     Z-ADD*ZERO     $LEAWG           Weight Sched Pr
     C                     Z-ADD*ZERO     $LZSNB           Pieces Sched Pr
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP05  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWDAIC3    $KAIC3           Company Number
     C                     MOVELWDRXCD    $KRXCD           Cutout Matrix C
     C                     Z-ADDWDGHDT    $KGHDT           Effective Month
     C                     Z-ADDWDUPNB    $KUPNB           Min Carcass Wei
     C                     Z-ADDWDUQNB    $KUQNB           Max Carcass Wei
     C                     Z-ADDWDULNB    $KULNB           Lean Percent
     C                     Z-ADDWDHGCD    $KHGCD           Item Code
     C                     MOVEL*BLANK    $KGENA           Item Descriptio
     C                     Z-ADDWDUTNB    $KUTNB           Percent of Carc
     C                     MOVELWDXRCD    $KXRCD           Primal Group Co
     C                     Z-ADD*ZERO     $KQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     $KPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     $KQTSP           PS Pieces Plann
     C                     MOVELWDUVST    $KUVST           EDI Status 1
     C                     MOVELWDUWST    $KUWST           EDI Status 2
     C                     MOVELWDUXST    $KUXST           EDI Status 3
     C                     MOVELWDVSST    $KVSST           Record Status
     C                     Z-ADDWDAATM    $KAATM           Job Time
     C                     MOVELWDAYNA    $KAYNA           User Id
     C                     MOVELWDA0NA    $KA0NA           Job Name
     C                     Z-ADDWDAXDT    $KAXDT           Job Date
      * USER: Process before print of detail format
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0181 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$KAIC3    WL0003           Company Number
     C                     Z-ADD$KHGCD    WL0004           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0149    P      Description Lin
     C                     MOVELWL0006    WN0150    P      U/M - Primary
     C                     Z-ADDWL0007    WN0151           Unit Weight
     C                     Z-ADDWL0008    WN0152           Item Structure
     C                     Z-ADDWL0009    WN0153           Item Structure
     C                     Z-ADDWL0010    WN0154           Item Structure
     C                     MOVELWL0011    WN0155    P      Item Type Code
     C                     MOVELWL0012    WN0156    P      Default Warehou
     C                     Z-ADDWL0013    WN0157           Fresh Chilling
     C                     MOVELWL0014    WN0158    P      Base/Conv/Loss
     C                     MOVELWL0015    WN0159    P      Variety/Rendere
     C                     MOVELWL0016    WN0160    P      Credit Item Sta
     C                     Z-ADDWL0017    WN0161           Std Weight/Head
     C                     Z-ADDWL0018    WN0162           Pieces Per Head
     C                     MOVELWL0019    WN0163    P      Department Code
     C                     MOVELWL0020    WN0164    P      Group for Packa
     C                     MOVELWL0021    WN0165    P      Seconds Item
     C                     MOVELWL0022    WN0166    P      Piece Count Ite
     C                     Z-ADDWL0023    WN0167           Pieces Per Bag
     C                     Z-ADDWL0024    WN0168           Bags Per Unit
     C                     MOVELWL0025    WN0169    P      Export/Domestic
     C                     MOVELWL0026    WN0170    P      Print On Schedu
     C                     MOVELWL0027    WN0171    P      Fresh Inv Alloc
     C                     MOVELWL0028    WN0172    P      Fresh Sched As
     C                     MOVELWL0029    WN0173    P      Frozen Inv Allo
     C                     MOVELWL0030    WN0174    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0156    WL0031    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0032    WN0175    P      Warehouse Type
     C                     MOVELWL0033    WN0176    P      Trans Contol AS
     C                     MOVELWL0034    WN0177    P      Warehouse Locat
     C                     MOVELWL0035    WN0178    P      Warehouse Std C
     C                     Z-ADDWL0036    WN0179           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WN0155    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WN0180           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WN0165    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WN0180           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WN0159    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WN0159    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WN0159    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WN0160    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WN0158    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0158    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0158    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0158    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WN0180           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WN0158    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WN0158    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WN0158    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WN0180           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WN0158    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WN0180           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WDUTNB    DIV  100       WUD4PC    H      Percent 7.4 USR
     C           $JD9WG    MULT WUD4PC    $KQTAS    H      PS Weight Sched
      * Allocate Cold Weight
      * CASE: CUR.PS Weight Sched Prod GT PAR.Weight Allocated USR
     C           $KQTAS    IFGT WN0148                     *IF
     C                     Z-ADDWN0148    $KQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WN0148           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  $KQTAS    WN0148           Weight Allocate
     C                     END                             *FI
     C           WN0162    MULT $JCC9U    $KQTSP           PS Pieces Plann
      * CUR = PAR By name
     C                     Z-ADD$JAIC3    $KAIC3           Company Number
     C                     MOVEL$JRXCD    $KRXCD           Cutout Matrix C
     C                     Z-ADD$JGHDT    $KGHDT           Effective Month
     C                     Z-ADD$JUPNB    $KUPNB           Min Carcass Wei
     C                     Z-ADD$JUQNB    $KUQNB           Max Carcass Wei
     C                     Z-ADD$JULNB    $KULNB           Lean Percent
     C                     MOVELWN0174    $KXRCD           Primal Group Co
     C                     Z-ADDWN0162    $KPPHE           Pieces Per Head
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $KUTNB    $LDXPC           Percent of Carc
     C                     ADD  $KQTAS    $LEAWG           Weight Sched Pr
     C                     ADD  $KQTSP    $LZSNB           Pieces Sched Pr
      * CASE: CUR.PS Weight Sched Prod EQ WRK.ZERO
     C           $KQTAS    IFEQ WUW0NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * U1LP Upd Prd Plan Dtl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$KAIC3    WL0037           Company Number
     C                     MOVELP8V5ST    WL0038    P      Production Type
     C                     Z-ADDP2ELDT    WL0039           Production Date
     C                     Z-ADD$KHGCD    WL0040           Item Code
     C                     MOVELWN0156    WL0041    P      Warehouse Code
     C                     Z-ADD$KQTAS    WL0042           PS Weight Plann
     C                     Z-ADD$KQTSP    WL0043           PS Pieces Plann
     C                     MOVELWN0180    WL0044    P      PS Item Id
     C                     MOVELWN0175    WL0045    P      Warehouse Type
     C                     MOVELWN0169    WL0046    P      PS Export/Domes
     C                     MOVELWN0170    WL0047    P      PS Print On Sch
     C                     MOVELWN0166    WL0048    P      PS Piece Count
     C                     MOVELWN0163    WL0049    P      Department Code
     C                     Z-ADDWN0154    WL0050           Item Structure
     C                     Z-ADDWN0153    WL0051           Item Structure
     C                     Z-ADDWN0152    WL0052           Item Structure
     C                     MOVELWN0174    WL0053    P      Primal Group Co
     C                     MOVELWN0160    WL0054    P      Credit Item Sta
     C                     MOVELWN0158    WL0055    P      Base/Conv/Loss
     C                     Z-ADDWN0157    WL0056           Fresh Chilling
     C                     MOVELWN0159    WL0057    P      Variety/Rendere
     C                     MOVELWN0165    WL0058    P      Seconds Item
     C                     MOVELWN0178    WL0059    P      Warehouse Std C
     C                     Z-ADDWN0179    WL0060           Warehouse Chill
     C                     EXSR SHRVGN
     C                     END                             *FI
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WDAIC3    WZC001           Company Number
     C                     Z-ADDWDAIC3    WZC001
     C           *LIKE     DEFN WDRXCD    WZC002           Cutout Matrix C
     C                     MOVELWDRXCD    WZC002
     C           *LIKE     DEFN WDGHDT    WZC003           Effective Month
     C                     Z-ADDWDGHDT    WZC003
     C           *LIKE     DEFN WDUPNB    WZC004           Min Carcass Wei
     C                     Z-ADDWDUPNB    WZC004
     C           *LIKE     DEFN WDUQNB    WZC005           Max Carcass Wei
     C                     Z-ADDWDUQNB    WZC005
     C           *LIKE     DEFN WDULNB    WZC006           Lean Percent
     C                     Z-ADDWDULNB    WZC006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@I4REFR                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Cutout Matrix C
     C                     MOVEL*BLANK    W0CL02  1        Effective Month
     C                     MOVEL*BLANK    W0CL03  1        Min Carcass Wei
     C                     MOVEL*BLANK    W0CL04  1        Max Carcass Wei
     C                     MOVEL*BLANK    W0CL05  1        Lean Percent
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Cutout Matrix C
     C                     MOVEL'Y'       W0CL02  1        Effective Month
     C                     MOVEL'Y'       W0CL03  1        Min Carcass Wei
     C                     MOVEL'Y'       W0CL04  1        Max Carcass Wei
     C                     MOVEL'Y'       W0CL05  1        Lean Percent
     C                     ELSE
      * Next record - Detect level breaks
     C           WDAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WDRXCD    IFNE WZC002                     Cutout Matrix C
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WDGHDT    IFNE WZC003                     Effective Month
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WDUPNB    IFNE WZC004                     Min Carcass Wei
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           WDUQNB    IFNE WZC005                     Max Carcass Wei
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C           WDULNB    IFNE WZC006                     Lean Percent
     C           W0CL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL05
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL05    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP05
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$B1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $CELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCELDT
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Cutout Matrix Code of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Cutout Matrix Code format
      * CUR.Condition Desc. 1  USR = Condition name of LCL.Cutout Matrix
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255678   Y2LSNO  70       List number
     C                     PARM YL0001    W0INVL 25        Cutout Matrix T
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Effective Month/Day of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Min Carcass Weight of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Max Carcass Weight of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Lean Percent of U1LP Upd 1st Lvl Plan PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Lean Percent format
      * CASE: PAR.Population Cold Wgt USR is LE Zero
     C           P6D9WG    IFLE *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$FKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print Detail line. of U1LP Upd 1st Lvl Plan PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.Population Cold Wgt USR is LE Zero
     C           P6D9WG    IFLE *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Cutout Matrix Code of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Effective Month/Day of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Min Carcass Weight of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Max Carcass Weight of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Population Percent of U1LP Alc Carc by Pop% PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Detail line. of U1LP Alc Carc by Pop% PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Cutout Matrix Code of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Effective Month/Day of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Min Carcass Weight of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Max Carcass Weight of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Lean Percent of U1LP Alc Carc by Pop  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP05
     C                     END                             FI
      * Print Detail line. of U1LP Alc Carc by Pop  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $KHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$KHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VKHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VKHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of U1LP Upd 1st Lvl Plan PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Company Number of U1LP Upd 1st Lvl Plan PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Cutout Matrix Code of U1LP Upd 1st Lvl Plan PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Effective Month/Day of U1LP Upd 1st Lvl Plan PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Min Carcass Weight of U1LP Upd 1st Lvl Plan PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Max Carcass Weight of U1LP Upd 1st Lvl Plan PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Lean Percent of U1LP Upd 1st Lvl Plan PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of U1LP Upd 1st Lvl Plan PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD2         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of U1LP Alc Carc by Pop% PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of U1LP Alc Carc by Pop% PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Cutout Matrix Code of U1LP Alc Carc by Pop% PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Effective Month/Day of U1LP Alc Carc by Pop% PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Min Carcass Weight of U1LP Alc Carc by Pop% PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Max Carcass Weight of U1LP Alc Carc by Pop% PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Population Percent of U1LP Alc Carc by Pop% PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of U1LP Alc Carc by Pop% PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of U1LP Alc Carc by Pop  PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of U1LP Alc Carc by Pop  PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Cutout Matrix Code of U1LP Alc Carc by Pop  PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Effective Month/Day of U1LP Alc Carc by Pop  PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Min Carcass Weight of U1LP Alc Carc by Pop  PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Max Carcass Weight of U1LP Alc Carc by Pop  PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Lean Percent of U1LP Alc Carc by Pop  PO
     C           W0CP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of U1LP Alc Carc by Pop  PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'P/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Cooler Shrink %    RT - Company Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           AQAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    AQAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@AQREB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0041' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Cooler Shrink P
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAQDGPC    WL0002           Cooler Shrink P
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Matrix Type       RT - PS Cutout Matrix  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           I0AIC3           Company Number
     C                     KFLD           I0RXCD           Cutout Matrix C
     C                     KFLD           I0GHDT           Effective Month
      * Setup key
     C                     Z-ADDP1AIC3    I0AIC3           Company Number
     C                     MOVELP1RXCD    I0RXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    I0GHDT           Effective Month
      * Establish starting position
     C           KRSSD     CHAIN@I0RES3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1722' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Cutout Matrix T
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELI0VTST    YL0001           Cutout Matrix T
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Dist Info         RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           IZAIC3           Company Number
     C                     KFLD           IZRXCD           Cutout Matrix C
     C                     KFLD           IZGHDT           Effective Month
     C                     KFLD           IZUPNB           Min Carcass Wei
     C                     KFLD           IZUQNB           Max Carcass Wei
     C                     KFLD           IZULNB           Lean Percent
      * Setup key
     C                     Z-ADDP1AIC3    IZAIC3           Company Number
     C                     MOVELP1RXCD    IZRXCD           Cutout Matrix C
     C                     Z-ADDP1GHDT    IZGHDT           Effective Month
     C                     Z-ADD$FUPNB    IZUPNB           Min Carcass Wei
     C                     Z-ADD$FUQNB    IZUQNB           Max Carcass Wei
     C                     Z-ADD$FULNB    IZULNB           Lean Percent
      * Establish starting position
     C           KRSSE     CHAIN@IZRETC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1720' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P4UNNB           Average Cold Wg
     C                     Z-ADD*ZERO     P4UONB           Population Perc
     C                     Z-ADD*ZERO     P4DIPC           Average Lean Pe
     C                     Z-ADD*ZERO     P4Z0NB           Average Backfat
     C                     Z-ADD*ZERO     P4AVLE           Average Loin-Ey
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDIZUNNB    P4UNNB           Average Cold Wg
     C                     Z-ADDIZUONB    P4UONB           Population Perc
     C                     Z-ADDIZDIPC    P4DIPC           Average Lean Pe
     C                     Z-ADDIZZ0NB    P4Z0NB           Average Backfat
     C                     Z-ADDIZAVLE    P4AVLE           Average Loin-Ey
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0003    BZAIC3           Company Number
     C                     Z-ADDWL0004    BZHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Description Lin
     C                     MOVEL*BLANK    WL0006           U/M - Primary
     C                     Z-ADD*ZERO     WL0007           Unit Weight
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     Z-ADD*ZERO     WL0009           Item Structure
     C                     Z-ADD*ZERO     WL0010           Item Structure
     C                     MOVEL*BLANK    WL0011           Item Type Code
     C                     MOVEL*BLANK    WL0012           Default Warehou
     C                     Z-ADD*ZERO     WL0013           Fresh Chilling
     C                     MOVEL*BLANK    WL0014           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0015           Variety/Rendere
     C                     MOVEL*BLANK    WL0016           Credit Item Sta
     C                     Z-ADD*ZERO     WL0017           Std Weight/Head
     C                     Z-ADD*ZERO     WL0018           Pieces Per Head
     C                     MOVEL*BLANK    WL0019           Department Code
     C                     MOVEL*BLANK    WL0020           Group for Packa
     C                     MOVEL*BLANK    WL0021           Seconds Item
     C                     MOVEL*BLANK    WL0022           Piece Count Ite
     C                     Z-ADD*ZERO     WL0023           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0024           Bags Per Unit
     C                     MOVEL*BLANK    WL0025           Export/Domestic
     C                     MOVEL*BLANK    WL0026           Print On Schedu
     C                     MOVEL*BLANK    WL0027           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0028           Fresh Sched As
     C                     MOVEL*BLANK    WL0029           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0030           Primal Group Co
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0005           Description Lin
     C                     MOVELBZADCD    WL0006           U/M - Primary
     C                     Z-ADDBZAIWG    WL0007           Unit Weight
     C                     Z-ADDBZRINB    WL0008           Item Structure
     C                     Z-ADDBZRHNB    WL0009           Item Structure
     C                     Z-ADDBZRGNB    WL0010           Item Structure
     C                     MOVELBZN0CD    WL0011           Item Type Code
     C                     MOVELBZQ1CD    WL0012           Default Warehou
     C                     Z-ADDBZCHTM    WL0013           Fresh Chilling
     C                     MOVELBZQZCD    WL0014           Base/Conv/Loss
     C                     MOVELBZXWST    WL0015           Variety/Rendere
     C                     MOVELBZVMST    WL0016           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0017           Std Weight/Head
     C                     Z-ADDBZPPHE    WL0018           Pieces Per Head
     C                     MOVELBZR3CD    WL0019           Department Code
     C                     MOVELBZSDCD    WL0020           Group for Packa
     C                     MOVELBZX5ST    WL0021           Seconds Item
     C                     MOVELBZPCCT    WL0022           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0023           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0024           Bags Per Unit
     C                     MOVELBZSUST    WL0025           Export/Domestic
     C                     MOVELBZSVST    WL0026           Print On Schedu
     C                     MOVELBZSYST    WL0027           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0028           Fresh Sched As
     C                     MOVELBZS1ST    WL0029           Frozen Inv Allo
     C                     MOVELBZXRCD    WL0030           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0031    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0032           Warehouse Type
     C                     MOVEL*BLANK    WL0033           Trans Contol AS
     C                     MOVEL*BLANK    WL0034           Warehouse Locat
     C                     MOVEL*BLANK    WL0035           Warehouse Std C
     C                     Z-ADD*ZERO     WL0036           Warehouse Chill
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0032           Warehouse Type
     C                     MOVELADXUST    WL0033           Trans Contol AS
     C                     MOVELADT0ST    WL0034           Warehouse Locat
     C                     MOVELADT1ST    WL0035           Warehouse Std C
     C                     Z-ADDADDBNB    WL0036           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * U1LP Upd Prd Plan Dtl RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0003  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0004  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0005  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0006  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0007  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0008  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0009  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0010  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0011  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0012  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0016  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0017  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0018  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0019  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0020  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0021  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0022  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0023 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0024  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0025 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0026  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0027 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0028  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0029 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0030  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0031 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0032  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0033 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0034  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0035  1        PS Lock Status
     C                     MOVEL*BLANK    WN0036  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0037  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0038  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0039  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0040  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0041  3        PS Production W
     C                     Z-ADD*ZERO     WN0042  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0043  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0044  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0045  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0046  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0047  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0048  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0050  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0052  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0054  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0055  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0056  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0057  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0058  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0059  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0060  1        EDI Status 1
     C                     MOVEL*BLANK    WN0061  1        EDI Status 2
     C                     MOVEL*BLANK    WN0062  1        EDI Status 3
     C                     MOVEL*BLANK    WN0063  1        Record Status
     C                     Z-ADD*ZERO     WN0064  60       Job Time
     C                     MOVEL*BLANK    WN0065 10        User Id
     C                     MOVEL*BLANK    WN0066 10        Job Name
     C                     Z-ADD*ZERO     WN0067  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUQTSP           PS Pieces Plann
     C                     Z-ADD0         WUWTSP           PS Weight Plann
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0037    I8AIC3           Company Number
     C                     MOVELWL0038    I8V5ST           Production Type
     C                     Z-ADDWL0039    I8ELDT           Production Date
     C                     Z-ADDWL0040    I8HGCD           Item Code
     C                     MOVELWL0041    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * RTV CtchWgt & Unit Wgt RT - Company/Item  * 
     C                     EXSR SIRVGN
      * Available Ship Date
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           WL0059    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0037    WL0061           Company Number
     C                     Z-ADDWL0039    WL0062           Post to G/L Dat
     C                     Z-ADDWL0060    WL0063           Fresh Chilling
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0064    WN0002           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0037    WL0061           Company Number
     C                     Z-ADDWL0039    WL0062           Post to G/L Dat
     C                     Z-ADDWL0056    WL0063           Fresh Chilling
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0064    WN0002           PS Available Sh
     C                     END                             *FI
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0043    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Planned Prod
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Pieces Planned Prod
     C           WL0042    DIV  WL0043    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           PS Avg Piece Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0004           PS Avg Piece Wg
     C                     END                             *FI
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SKRVGN
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
     C                     EXSR SLCRRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           I8QTSP    ADD  WL0043    WUQTSP           PS Pieces Plann
     C           I8WTSP    ADD  WL0042    WUWTSP           PS Weight Plann
      * CASE: WRK.PS Pieces Planned Prod is GT Zero
     C           WUQTSP    IFGT 0                          *IF
      * Average Piece Weight
      * WRK.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : WRK.PS Weight Planned Prod
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.PS Pieces Planned Prod
     C           WUWTSP    DIV  WUQTSP    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUF8WG           PS Avg Piece Wg
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * U1LP Chg Prd Plan Dtl CH - PS Prod Item Schedule  * 
     C                     EXSR SMCHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV CtchWgt & Unit Wgt RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0037    BZAIC3           Company Number
     C                     Z-ADDWL0040    BZHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELBZAICD    WUAICD           U/M - Pricing
     C                     Z-ADDBZAIWG    WN0023           Unit Weight
     C                     MOVELBZAVST    WUAVST           Catch Weight St
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSJ01           Company Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADDWL0061    WQSJ01           Company Number
     C                     Z-ADDWL0062    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSJ     SETLL@AFREBE                    *
     C           KRSSJ     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0063                     *IF
     C                     Z-ADDAFBCDT    WL0064           PS Available Sh
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           AFA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSJ     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0041    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0041           Production Ware
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAOCD    WN0041           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Dtl CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0037    WBAIC3           Company Number
     C                     MOVELWL0038    WBV5ST           Production Type
     C                     Z-ADDWL0039    WBELDT           Production Date
     C                     Z-ADDWL0040    WBHGCD           Item Code
     C                     MOVELWL0041    WBAJCD           Warehouse Code
     C                     Z-ADDWN0002    WBGPDT           PS Available Sh
     C                     Z-ADDWL0042    WBWTSP           PS Weight Plann
     C                     Z-ADDWL0043    WBQTSP           PS Pieces Plann
     C                     Z-ADDWN0003    WBDJPC           PS % of Carcass
     C                     Z-ADDWN0004    WBF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0005    WBWTIN           PS Weight Inv O
     C                     Z-ADDWN0006    WBD5NB           PS Pieces Inv O
     C                     Z-ADDWN0007    WBDXWG           PS Weight Stand
     C                     Z-ADDWN0008    WBB2NB           PS Pieces Stand
     C                     Z-ADDWN0009    WBWTCN           PS Weight Conve
     C                     Z-ADDWN0010    WBPSCV           PS Pieces Conve
     C                     Z-ADDWN0011    WBSAWT           PS Weight Shipp
     C                     Z-ADDWN0012    WBB9NB           PS Pieces Shipp
     C                     Z-ADDWN0013    WBD1WG           PS Weight Prod
     C                     Z-ADDWN0014    WBCBNB           PS Pieces Prod
     C                     Z-ADDWN0015    WBEZWG           PS Weight Inv A
     C                     Z-ADDWN0016    WBCCNB           PS Pieces Inv A
     C                     Z-ADDWN0017    WBE0WG           PS Weight Ship
     C                     Z-ADDWN0018    WBD6NB           PS Pieces Ship
     C                     Z-ADDWN0019    WBOAWT           PS Weight Prod
     C                     Z-ADDWN0020    WBCDNB           PS Pieces Prod
     C                     Z-ADDWN0021    WBUNW2           PS Weight Inv A
     C                     Z-ADDWN0022    WBCENB           PS Pieces Inv A
     C                     Z-ADDWN0023    WBF9WG           PS Unit Weight
     C                     Z-ADDWN0024    WBBPNB           PS Pieces Whse
     C                     Z-ADDWN0025    WBGAWG           PS Weight Whse
     C                     Z-ADDWN0026    WBBQNB           PS Pieces Unuse
     C                     Z-ADDWN0027    WBGBWG           PS Weight Unuse
     C                     Z-ADDWN0028    WBBRNB           PS Pieces Unuse
     C                     Z-ADDWN0029    WBGCWG           PS Weight Unuse
     C                     Z-ADDWN0030    WBBSNB           PS Pieces Unuse
     C                     Z-ADDWN0031    WBGDWG           PS Weight Unuse
     C                     Z-ADDWN0032    WBBWNB           PS Pieces Unuse
     C                     Z-ADDWN0033    WBGEWG           PS Weight Unuse
     C                     Z-ADDWN0034    WBPS6U           PS Pieces Unuse
     C                     MOVELWL0044    WBWCST           PS Item Id
     C                     MOVELWL0045    WBWPST           Warehouse Type
     C                     MOVELWN0035    WBB5ST           PS Lock Status
     C                     MOVELWL0046    WBTFST           PS Export/Domes
     C                     MOVELWL0047    WBTEST           PS Print On Sch
     C                     MOVELWL0048    WBTHST           PS Piece Count
     C                     MOVELWN0036    WBUDST           PS Unused Sts 1
     C                     MOVELWN0037    WBUFST           PS Unused Sts 2
     C                     MOVELWN0038    WBUGST           PS Unused Sts 3
     C                     MOVELWN0039    WBUHST           PS Unused Sts 4
     C                     MOVELWN0040    WBB6ST           PS Item Sched N
     C                     MOVELWN0041    WBB7ST           PS Production W
     C                     Z-ADDWN0042    WBDVWG           PS Weight Order
     C                     Z-ADDWN0043    WBD7NB           PS Pieces Order
     C                     Z-ADDWN0044    WBFCAD           PS Weight FC Ad
     C                     Z-ADDWN0045    WBD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0046    WBDWWG           PS Weight FX Ad
     C                     Z-ADDWN0047    WBEANB           PS Pieces FX Ad
     C                     Z-ADDWN0048    WBSHWT           PS Weight Sched
     C                     Z-ADDWN0049    WBEBNB           PS Pieces Sched
     C                     Z-ADDWN0050    WBAVWT           PS Weight Avail
     C                     Z-ADDWN0051    WBECNB           PS Pieces Avail
     C                     Z-ADDWN0052    WBWTON           PS Weight Produ
     C                     Z-ADDWN0053    WBEDNB           PS Pieces Produ
     C                     Z-ADDWN0054    WBFNWT           PS Weight Fab N
     C                     Z-ADDWN0055    WBEENB           PS Pieces Fab N
     C                     Z-ADDWN0056    WBQTAS           PS Weight Sched
     C                     Z-ADDWN0057    WBEFNB           PS Pieces Sched
     C                     Z-ADDWN0058    WBWAIO           PS Weight Sched
     C                     Z-ADDWN0059    WBEGNB           PS Pieces Sched
     C                     MOVELWL0049    WBR3CD           Department Code
     C                     Z-ADDWL0050    WBRGNB           Item Structure
     C                     Z-ADDWL0051    WBRHNB           Item Structure
     C                     Z-ADDWL0052    WBRINB           Item Structure
     C                     MOVELWL0053    WBXRCD           Primal Group Co
     C                     MOVELWN0060    WBUVST           EDI Status 1
     C                     MOVELWN0061    WBUWST           EDI Status 2
     C                     MOVELWN0062    WBUXST           EDI Status 3
     C                     MOVELWN0063    WBVSST           Record Status
     C                     Z-ADDWN0064    WBAATM           Job Time
     C                     MOVELWN0065    WBAYNA           User Id
     C                     MOVELWN0066    WBA0NA           Job Name
     C                     Z-ADDWN0067    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     MOVEL'N'       WBB5ST           PS Lock Status
     C           KLCRSL    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSL    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * U1LP Chg Prd Plan Dtl CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0068  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0069  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0070  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0071  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0072  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0073  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0074  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0075  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0076  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0077  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0078  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0079  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0082  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0083  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0084  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0085  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0086  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0087  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0088 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0089  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0090 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0091  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0092 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0093  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0094 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0095  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0096 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0097  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0098 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0099  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0100  3        PS Item Id
     C                     MOVEL*BLANK    WN0101  2        Warehouse Type
     C                     MOVEL*BLANK    WN0102  1        PS Lock Status
     C                     MOVEL*BLANK    WN0103  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0104  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0105  1        PS Piece Count
     C                     MOVEL*BLANK    WN0106  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0107  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0108  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0109  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0110  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0111  3        PS Production W
     C                     Z-ADD*ZERO     WN0112  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0113  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0114  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0115  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0116  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0117  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0118  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0119  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0120  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0121  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0122  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0123  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0124  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0125  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0126  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0127  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0128  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0130  6        Department Code
     C                     Z-ADD*ZERO     WN0131  30       Item Structure
     C                     Z-ADD*ZERO     WN0132  30       Item Structure
     C                     Z-ADD*ZERO     WN0133  30       Item Structure
     C                     MOVEL*BLANK    WN0134  6        Primal Group Co
     C                     MOVEL*BLANK    WN0135  1        EDI Status 1
     C                     MOVEL*BLANK    WN0136  1        EDI Status 2
     C                     MOVEL*BLANK    WN0137  1        EDI Status 3
     C                     MOVEL*BLANK    WN0138  1        Record Status
     C                     Z-ADD*ZERO     WN0139  60       Job Time
     C                     MOVEL*BLANK    WN0140 10        User Id
     C                     MOVEL*BLANK    WN0141 10        Job Name
     C                     Z-ADD*ZERO     WN0142  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WBAIC3           Company Number
     C                     MOVELI8V5ST    WBV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WBELDT           Production Date
     C                     Z-ADDI8HGCD    WBHGCD           Item Code
     C                     MOVELI8AJCD    WBAJCD    P      Warehouse Code
      *
     C           KLCHSM    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C           KLCHSM    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWUWTSP    WBWTSP           PS Weight Plann
     C                     Z-ADDWUQTSP    WBQTSP           PS Pieces Plann
     C                     Z-ADDWUF8WG    WBF8WG           PS Avg Piece Wg
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C                     MOVEL##PGM     WBA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * U1LP Crt Prd Plan Hdr CR - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JCCPVB
     C                     Z-ADDP1AIC3    JCAIC3           Company Number
     C                     MOVELP8V5ST    JCV5ST           Production Type
     C                     Z-ADDP2ELDT    JCELDT           Production Date
     C                     Z-ADDP2HVHD    JCHVHD           Hog Volume
     C                     Z-ADD$IZ6NB    JCZ6NB           Average Live We
     C                     Z-ADD$IZ7NB    JCZ7NB           Average Hot Wei
     C                     Z-ADDP5DGPC    JCDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     JCAVCW           Average Cold We
     C                     Z-ADD$IDIPC    JCDIPC           Average Lean Pe
     C                     Z-ADD$IZ0NB    JCZ0NB           Average Backfat
     C                     Z-ADD$IAVLE    JCAVLE           Average Loin-Ey
     C                     Z-ADDP6UGNB    JCECWG           Hot Weight Tota
     C                     MOVELWUGSTX    JCUVST           EDI Status 1
     C                     MOVELWUGSTX    JCUWST           EDI Status 2
     C                     MOVELWUGSTX    JCUXST           EDI Status 3
     C                     MOVELWUGSTX    JCVSST           Record Status
     C                     Z-ADD*ZERO     JCAATM           Job Time
     C                     MOVEL*BLANK    JCAYNA           User Id
     C                     MOVEL*BLANK    JCA0NA           Job Name
     C                     Z-ADD*ZERO     JCAXDT           Job Date
      *
      * USER: Processing before Data update
      * RTV Cooler Shrink %    RT - Company Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDJCAIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    JCDGPC           Cooler Shrink P
      * Cold Weight
      * DB1.Average Cold Weight =
      *    *COMPUTE (x1 - (x1 * (x2 / x3)))
      * x1    : DB1.Average Hot Weight
      * -     : PGM.*Synon (17,7) work field
      * x1    : DB1.Average Hot Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Cooler Shrink Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           JCDGPC    DIV  100       W0WD02    H      *Synon (17,7) w
     C           JCZ7NB    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           JCZ7NB    SUB  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    JCAVCW           Average Cold We
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       JCVSST           Record Status
     C                     Z-ADD##JTM     JCAATM           Job Time
     C                     MOVEL##USR     JCAYNA           User Id
     C                     MOVEL##JOB     JCA0NA           Job Name
     C                     Z-ADD##JDT     JCAXDT           Job Date
     C           KLCRSN    KLIST
     C                     KFLD           JCAIC3           Company Number
     C                     KFLD           JCV5ST           Production Type
     C                     KFLD           JCELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSN    SETLL@JCCPVB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1796' W0RTN   7
      * Send message 'PS Prod Schedule       EX'
     C                     MOVEL'USR1796' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@JCCPVB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * U1LP Upd Carc Yield   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0182  72       PS % of Carcass
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQSO01           Company Number
     C           *LIKE     DEFN I8V5ST    WQSO02           Production Type
     C           *LIKE     DEFN I8ELDT    WQSO03           Production Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Production Type
     C                     KFLD           WQSO03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSO01           Company Number
     C                     MOVELP8V5ST    WQSO02           Production Type
     C                     Z-ADDP2ELDT    WQSO03           Production Date
      * Establish starting position
     C           KRSSO     SETLL@I8CPUS                    *
     C           KRSSO     READE@I8CPUS                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Hot Weight Total is Greater than zero
     C           P6UGNB    IFGT 0                          *IF
      * Percent of Carcass Yield
      * PAR.Percent of Carcass Yield =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.PS Weight Planned Prod
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.Hot Weight Total
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           I8WTSP    DIV  P6UGNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0182           PS % of Carcass
      * U1LP Chg Carc Yield   CH - PS Prod Item Schedule  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSO     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * U1LP Chg Carc Yield   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0183  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0184  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0185  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0186  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0187  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0188  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0189  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0190  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0191  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0192  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0193  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0194  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0195  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0196  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0197  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0198  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0199  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0200  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0201  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0202  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0203 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0204  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0205 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0206  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0207 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0208  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0209 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0210  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0211 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0213 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0214  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0215  3        PS Item Id
     C                     MOVEL*BLANK    WN0216  2        Warehouse Type
     C                     MOVEL*BLANK    WN0217  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0218  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0219  1        PS Piece Count
     C                     MOVEL*BLANK    WN0220  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0221  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0222  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0223  1        PS Unused Sts 4
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0226  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0228  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0230  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0232  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0234  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0236  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0238  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0239  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0240  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0241  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0242  6        Department Code
     C                     Z-ADD*ZERO     WN0243  30       Item Structure
     C                     Z-ADD*ZERO     WN0244  30       Item Structure
     C                     Z-ADD*ZERO     WN0245  30       Item Structure
     C                     MOVEL*BLANK    WN0246  6        Primal Group Co
     C                     MOVEL*BLANK    WN0247  1        EDI Status 1
     C                     MOVEL*BLANK    WN0248  1        EDI Status 2
     C                     MOVEL*BLANK    WN0249  1        EDI Status 3
     C                     MOVEL*BLANK    WN0250  1        Record Status
     C                     Z-ADD*ZERO     WN0251  60       Job Time
     C                     MOVEL*BLANK    WN0252 10        User Id
     C                     MOVEL*BLANK    WN0253 10        Job Name
     C                     Z-ADD*ZERO     WN0254  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WBAIC3           Company Number
     C                     MOVELI8V5ST    WBV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WBELDT           Production Date
     C                     Z-ADDI8HGCD    WBHGCD           Item Code
     C                     MOVELI8AJCD    WBAJCD    P      Warehouse Code
      *
     C           KLCHSP    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C           KLCHSP    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0182    WBDJPC           PS % of Carcass
     C                     Z-ADDI8EZWG    WBEZWG           PS Weight Inv A
     C                     Z-ADDI8E0WG    WBE0WG           PS Weight Ship
     C                     MOVELI8B5ST    WBB5ST    P      PS Lock Status
     C                     MOVELI8B6ST    WBB6ST    P      PS Item Sched N
     C                     MOVELI8B7ST    WBB7ST    P      PS Production W
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C                     MOVEL##PGM     WBA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * SEQ: Accumulations
      *================================================================
     C           $FE2WG    MULT $FZ0NB    P6ZVNB    H      Average Backfat
     C                     ADD  P6ZVNB    P6ABWR           Average BackFt
     C           $FE2WG    MULT $FAVLE    P6ZUNB    H      Average Loin-I
     C                     ADD  P6ZUNB    P6AIWR           Average Loin-I
      * CLC: Hot Weight * Lean %
      * PAR.Average Lean % Total USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : CUR.Population Hot Wgt USR
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CUR.Average Lean Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $FDIPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           $FE2WG    MULT W0WD01    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    P6DUPC           Average Lean %
     C                     ADD  P6DUPC    P6ALWR           Average Lean% W
     C                     ADD  $FE2WG    P6UGNB           Hot Weight Tot
     C                     ADD  $FEBWG    P6ZTNB           Live Weight Tot
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : U1LP Alc Carc by Pop% PO
      *================================================================
      * CASE: WRK.Carcass Count 9.0 USR is eq zero
     C           WUCC9U    IFEQ *ZERO                      *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0143  92       Average Backfat
     C                     Z-ADD*ZERO     WN0144  92       Average Loin-I
     C                     Z-ADD*ZERO     WN0145  72       Average Lean %
     C                     Z-ADD*ZERO     WN0146  52       Average Hot Wei
     C                     Z-ADD*ZERO     WN0147  92       Population Hot
      *
      * U1LP Alc Carc by Pop% PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : U1LP Alc Carc by Pop% PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0148  92       Weight Allocate
     C                     MOVEL*BLANK    WN0149 30        Description Lin
     C                     MOVEL*BLANK    WN0150  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0151 112       Unit Weight
     C                     Z-ADD*ZERO     WN0152  30       Item Structure
     C                     Z-ADD*ZERO     WN0153  30       Item Structure
     C                     Z-ADD*ZERO     WN0154  30       Item Structure
     C                     MOVEL*BLANK    WN0155  3        Item Type Code
     C                     MOVEL*BLANK    WN0156  3        Default Warehou
     C                     Z-ADD*ZERO     WN0157  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0158  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0159  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0160  1        Credit Item Sta
     C                     Z-ADD*ZERO     WN0161 112       Std Weight/Head
     C                     Z-ADD*ZERO     WN0162  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0163  6        Department Code
     C                     MOVEL*BLANK    WN0164  1        Group for Packa
     C                     MOVEL*BLANK    WN0165  1        Seconds Item
     C                     MOVEL*BLANK    WN0166  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0167  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0168  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0169  1        Export/Domestic
     C                     MOVEL*BLANK    WN0170  1        Print On Schedu
     C                     MOVEL*BLANK    WN0171  1        Fresh Inv Alloc
     C                     MOVEL*BLANK    WN0172  1        Fresh Sched As
     C                     MOVEL*BLANK    WN0173  1        Frozen Inv Allo
     C                     MOVEL*BLANK    WN0174  6        Primal Group Co
     C                     MOVEL*BLANK    WN0175  2        Warehouse Type
     C                     MOVEL*BLANK    WN0176  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0177  1        Warehouse Locat
     C                     MOVEL*BLANK    WN0178  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0179  52       Warehouse Chill
     C                     MOVEL*BLANK    WN0180  3        PS Item Id
      *
      * U1LP Alc Carc by Pop  PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * U1LP Alc Carc by Pop% PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTAST           First Time Flag
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * U1LP Alc Carc by Pop  PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     Z-ADD$JD9WG    WN0148           Weight Allocate
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3AVNA           Description Lin
     C                     MOVEL*BLANK    P3ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P3AIWG           Unit Weight
     C                     Z-ADD*ZERO     P3RINB           Item Structure
     C                     Z-ADD*ZERO     P3RHNB           Item Structure
     C                     Z-ADD*ZERO     P3RGNB           Item Structure
     C                     MOVEL*BLANK    P3N0CD           Item Type Code
     C                     MOVEL*BLANK    P3Q1CD           Default Warehou
     C                     Z-ADD*ZERO     P3CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P3QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    P3XWST           Variety/Rendere
     C                     MOVEL*BLANK    P3VMST           Credit Item Sta
     C                     Z-ADD*ZERO     P3SWGH           Std Weight/Head
     C                     Z-ADD*ZERO     P3PPHE           Pieces Per Head
     C                     MOVEL*BLANK    P3R3CD           Department Code
     C                     MOVEL*BLANK    P3SDCD           Group for Packa
     C                     MOVEL*BLANK    P3X5ST           Seconds Item
     C                     MOVEL*BLANK    P3PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P3BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P3BJNB           Bags Per Unit
     C                     MOVEL*BLANK    P3SUST           Export/Domestic
     C                     MOVEL*BLANK    P3SVST           Print On Schedu
     C                     MOVEL*BLANK    P3SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    P3SZST           Fresh Sched As
     C                     MOVEL*BLANK    P3S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    P3XRCD           Primal Group Co
     C                     Z-ADD*ZERO     P4UNNB           Average Cold Wg
     C                     Z-ADD*ZERO     P4UONB           Population Perc
     C                     Z-ADD*ZERO     P4DIPC           Average Lean Pe
     C                     Z-ADD*ZERO     P4Z0NB           Average Backfat
     C                     Z-ADD*ZERO     P4AVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     P5DGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     P5V0NB           Std Dressing Yi
     C                     Z-ADD*ZERO     P6QTYX           Number of Carca
     C                     Z-ADD*ZERO     P6D9WG           Population Cold
     C                     Z-ADD*ZERO     P6EBWG           Population Live
     C                     Z-ADD*ZERO     P6Z6NB           Average Live We
     C                     Z-ADD*ZERO     P6ZVNB           Average Backfat
     C                     Z-ADD*ZERO     P6ABWR           Average BackFt
     C                     Z-ADD*ZERO     P6ZUNB           Average Loin-I
     C                     Z-ADD*ZERO     P6AIWR           Average Loin-I
     C                     Z-ADD*ZERO     P6DUPC           Average Lean %
     C                     Z-ADD*ZERO     P6ALWR           Average Lean% W
     C                     Z-ADD*ZERO     P6UGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     P6ZTNB           Live Weight Tot
     C                     MOVEL*BLANK    P6WPST           Warehouse Type
     C                     MOVEL*BLANK    P6WCST           PS Item Id
     C                     Z-ADD*ZERO     P6E1WG           Weight Allocate
     C                     Z-ADD*ZERO     P6CRAL           Carcasses Alloc
     C                     Z-ADD*ZERO     P6AVHW           Average Hot Wei
     C                     Z-ADD*ZERO     P6E2WG           Population Hot
     C                     Z-ADD*ZERO     P7HVUS           Hog Volume USR
     C                     MOVEL*BLANK    P9XUST           Trans Contol AS
     C                     MOVEL*BLANK    P9T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P9T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P9DBNB           Warehouse Chill
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Carcass Count 9.0 USR
     C                     Z-ADD*ZERO     WUCC9U  90
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I4AIC3           Company Number
     C                     MOVEL*LOVAL    I4RXCD           Cutout Matrix C
     C                     MOVEL*LOVAL    I4GHDT           Effective Month
     C                     MOVEL*LOVAL    I4UPNB           Min Carcass Wei
     C                     MOVEL*LOVAL    I4UQNB           Max Carcass Wei
     C                     MOVEL*LOVAL    I4ULNB           Lean Percent
     C                     MOVEL*LOVAL    I4HGCD           Item Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Percent 7.4 USR
     C                     Z-ADD*ZERO     WUD4PC  74
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field PS Pieces Planned Prod
     C                     Z-ADD*ZERO     WUQTSP  70
      * Define work field PS Weight Planned Prod
     C                     Z-ADD*ZERO     WUWTSP  92
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WBWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WBQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WBDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WBF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WBWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WBD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WBDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WBB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WBWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WBPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WBSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WBB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WBD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WBCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WBD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WBOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WBCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WBBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WBGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WBBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WBD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WBFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WBD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WBDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WBEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WBSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WBEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WBECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WBWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WBEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WBFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WBEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WBQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WBEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WBEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field PS Avg Piece Wgt
     C                     Z-ADD*ZERO     WUF8WG  92
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCGHDT           Effective Month
     C                     Z-ADD*ZERO     WCUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WCUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WCULNB           Lean Percent
     C                     Z-ADD*ZERO     WCUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WCUONB           Population Perc
     C                     Z-ADD*ZERO     WCDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WCZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WCAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WCQPNX           Population Head
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCRXCD           Cutout Matrix C
     C                     MOVEL*LOVAL    WCGHDT           Effective Month
     C                     MOVEL*LOVAL    WCUPNB           Min Carcass Wei
     C                     MOVEL*LOVAL    WCUQNB           Max Carcass Wei
     C                     MOVEL*HIVAL    WCUONB           Population Perc
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUZRST  1
      * Define work field Population Live Wgt USR
     C                     Z-ADD*ZERO     WUEBWG  92
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDGHDT           Effective Month
     C                     Z-ADD*ZERO     WDUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WDUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WDULNB           Lean Percent
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDUTNB           Percent of Carc
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WDAIC3           Company Number
     C                     MOVEL*LOVAL    WDRXCD           Cutout Matrix C
     C                     MOVEL*LOVAL    WDGHDT           Effective Month
     C                     MOVEL*LOVAL    WDUPNB           Min Carcass Wei
     C                     MOVEL*LOVAL    WDUQNB           Max Carcass Wei
     C                     MOVEL*LOVAL    WDULNB           Lean Percent
     C                     MOVEL*LOVAL    WDHGCD           Item Code
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  52
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006  2
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  3
     C                     Z-ADD*ZERO     WL0013  52
     C                     MOVEL*BLANK    WL0014  2
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  6
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  6
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  2
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036  52
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  1
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  3
     C                     Z-ADD*ZERO     WL0042  92
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  3
     C                     MOVEL*BLANK    WL0045  2
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  6
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  30
     C                     Z-ADD*ZERO     WL0052  30
     C                     MOVEL*BLANK    WL0053  6
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  2
     C                     Z-ADD*ZERO     WL0056  52
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     Z-ADD*ZERO     WL0060  52
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0061  30
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  52
     C                     Z-ADD*ZERO     WL0064  70
      * Define local work field Cutout Matrix Type
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * PAR = CON By name
     C                     MOVEL*BLANK    P3AVNA           Description Lin
     C                     MOVEL*BLANK    P3ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P3AIWG           Unit Weight
     C                     Z-ADD*ZERO     P3RINB           Item Structure
     C                     Z-ADD*ZERO     P3RHNB           Item Structure
     C                     Z-ADD*ZERO     P3RGNB           Item Structure
     C                     MOVEL*BLANK    P3N0CD           Item Type Code
     C                     MOVEL*BLANK    P3Q1CD           Default Warehou
     C                     Z-ADD*ZERO     P3CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P3QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    P3XWST           Variety/Rendere
     C                     MOVEL*BLANK    P3VMST           Credit Item Sta
     C                     Z-ADD*ZERO     P3SWGH           Std Weight/Head
     C                     Z-ADD*ZERO     P3PPHE           Pieces Per Head
     C                     MOVEL*BLANK    P3R3CD           Department Code
     C                     MOVEL*BLANK    P3SDCD           Group for Packa
     C                     MOVEL*BLANK    P3X5ST           Seconds Item
     C                     MOVEL*BLANK    P3PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P3BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P3BJNB           Bags Per Unit
     C                     MOVEL*BLANK    P3SUST           Export/Domestic
     C                     MOVEL*BLANK    P3SVST           Print On Schedu
     C                     MOVEL*BLANK    P3SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    P3SZST           Fresh Sched As
     C                     MOVEL*BLANK    P3S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    P3XRCD           Primal Group Co
     C                     Z-ADD*ZERO     P4UNNB           Average Cold Wg
     C                     Z-ADD*ZERO     P4UONB           Population Perc
     C                     Z-ADD*ZERO     P4DIPC           Average Lean Pe
     C                     Z-ADD*ZERO     P4Z0NB           Average Backfat
     C                     Z-ADD*ZERO     P4AVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     P5DGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     P5V0NB           Std Dressing Yi
     C                     Z-ADD*ZERO     P6QTYX           Number of Carca
     C                     Z-ADD*ZERO     P6D9WG           Population Cold
     C                     Z-ADD*ZERO     P6EBWG           Population Live
     C                     Z-ADD*ZERO     P6Z6NB           Average Live We
     C                     Z-ADD*ZERO     P6ZVNB           Average Backfat
     C                     Z-ADD*ZERO     P6ABWR           Average BackFt
     C                     Z-ADD*ZERO     P6ZUNB           Average Loin-I
     C                     Z-ADD*ZERO     P6AIWR           Average Loin-I
     C                     Z-ADD*ZERO     P6DUPC           Average Lean %
     C                     Z-ADD*ZERO     P6ALWR           Average Lean% W
     C                     Z-ADD*ZERO     P6UGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     P6ZTNB           Live Weight Tot
     C                     MOVEL*BLANK    P6WPST           Warehouse Type
     C                     MOVEL*BLANK    P6WCST           PS Item Id
     C                     Z-ADD*ZERO     P6E1WG           Weight Allocate
     C                     Z-ADD*ZERO     P6CRAL           Carcasses Alloc
     C                     Z-ADD*ZERO     P6AVHW           Average Hot Wei
     C                     Z-ADD*ZERO     P6E2WG           Population Hot
     C                     Z-ADD*ZERO     P7HVUS           Hog Volume USR
     C                     MOVEL*BLANK    P9XUST           Trans Contol AS
     C                     MOVEL*BLANK    P9T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P9T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P9DBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WUCC9U           Carcass Count 9
      * RTV Cooler Shrink %    RT - Company Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    P5DGPC           Cooler Shrink P
      * Rtv Matrix Type       RT - PS Cutout Matrix  * 
     C                     EXSR SDRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
