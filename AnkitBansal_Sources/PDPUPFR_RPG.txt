     H/TITLE PRT Ord Sts/SchedActDtsPF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:12:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPM7IF  E           K        DISK
      * RSQ : Order Header TRG          RSQ Co/SchShpDt/ActShpDt
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKNXIF  E           K        DISK
      * RTV : Order Detail              Retrieval index (Hdr Key
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIMCPL2IF  E           K        DISK
      * RSQ : Order Detail Pricing      Ord/Detail/Price Seq
      *
     FPDPUPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Ord Sts/SchedActDtsPF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1   4  6   @CN    25
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BGWKBM
      * Order Detail              Retrieval index (Hdr Key
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Ship To Customer
     I                                    P   7  100P1BKC7
      * I :  Actual Shipped Date
     I                                    P  11  140P1GNDT
      * I :  Header Status
     I                                       15  15 P1GWST
      * I :  Scheduled Ship Date
     I                                    P  16  190P1AODT
      * I :  Load ID
     I                                    P  20  230P1RMNB
      * I :  Price Audit
     I                                       24  24 P1U0ST
      * I :  Price Status
     I                                       25  25 P1U1ST
      * I :  Sales Route Code
     I                                       26  28 P1R4CD
      * I :  Modified Flag
     I                                       29  29 P1Z1ST
      * I :  Block Order Flag
     I                                       30  30 P1BCST
     IP2PARM      DS
      * I :  Load Status
     I                                        1   1 P2PKST
     IP3PARM      DS
      * I :  Warehouse Code
     I                                        1   3 P3AJCD
     IP4PARM      DS
      * I :  USR Summary/Detail or Tot
     I                                        1   1 P4S7ST
     IP5PARM      DS
      * N :  USR Flag 1
     I                                        1   1 P5D4ST
     IP6PARM      DS
      * N :  USR Flag 2
     I                                        1   1 P6UFL2
     IP7PARM      DS
      * I :  USR Detail or Summary
     I                                        1   1 P7STST
     IP8PARM      DS
      * I :  Print (Yes/No) USR
     I                                        1   1 P8DTSX
     IP9PARM      DS
      * I :  Price Method Code
     I                                        1   3 P9Q7CD
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1GNDT    PARM           WP0004  70       Actual Shipped
     C           P1GWST    PARM           WP0005  1        Header Status
     C           P1AODT    PARM           WP0006  70       Scheduled Ship
     C           P1RMNB    PARM           WP0007  70       Load ID
     C           P1U0ST    PARM           WP0008  1        Price Audit
     C           P1U1ST    PARM           WP0009  1        Price Status
     C           P1R4CD    PARM           WP0010  3        Sales Route Cod
     C           P1Z1ST    PARM           WP0011  1        Modified Flag
     C           P1BCST    PARM           WP0012  1        Block Order Fla
     C           P2PKST    PARM           WP0013  1        Load Status
     C           P3AJCD    PARM           WP0014  3        Warehouse Code
     C           P4S7ST    PARM           WP0015  1        USR Summary/Det
     C           P7STST    PARM           WP0016  1        USR Detail or S
     C           P8DTSX    PARM           WP0017  1        Print (Yes/No)
     C           P9Q7CD    PARM           WP0018  3        Price Method Co
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Ord Sts/SchedActDtsPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$OENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Ord Sts/SchedActDtsPF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@BFCPJ7                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL02  1        Actual Shipped
     C                     MOVEL'Y'       W0AL03  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CAPTX           Company Name
     C                     MOVEL*BLANK    $CPKST           Load Status
     C                     MOVEL*BLANK    $CDCTX           Item Structure
     C                     MOVEL*BLANK    $CDPNA           USR Description
     C                     MOVEL*BLANK    $CGWST           Header Status
     C                     MOVEL*BLANK    $CDDTX           Item Structure
     C                     MOVEL*BLANK    $CSTST           USR Detail or S
     C                     MOVEL*BLANK    $CESNA           USR Description
     C                     MOVEL*BLANK    $CBCST           Block Order Fla
     C                     MOVEL*BLANK    $CJNNA           USR Description
     C                     MOVEL*BLANK    $CR4CD           Sales Route Cod
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     Z-ADD*ZERO     $CBKC7           Ship To Custome
     C                     MOVEL*BLANK    $CBRTX           Ship To Name
     C                     Z-ADD*ZERO     $CC4NB           Order Number
     C                     Z-ADD*ZERO     $CAODT           Scheduled Ship
     C                     MOVEL*BLANK    $CU1ST           Price Status
     C                     MOVEL*BLANK    $CNCNA           USR Desc. 10
     C                     Z-ADD*ZERO     $CGNDT           Actual Shipped
     C                     MOVEL*BLANK    $CU0ST           Price Audit
     C                     MOVEL*BLANK    $CJUNA           USR Description
     C                     Z-ADD*ZERO     $CRMNB           Load ID
     C                     MOVEL*BLANK    $CZ1ST           Modified Flag
     C                     MOVEL*BLANK    $CAUNA           Description
     C                     MOVEL*BLANK    $CAJCD           Warehouse Code
     C                     MOVEL*BLANK    $CF8NA           Warehouse Descr
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $EAIC3           Company Number
     C                     Z-ADDBEAODT    $EAODT           Scheduled Ship
     C                     MOVELBER4CD    $ER4CD           Sales Route Cod
      * Load related totals format
     C                     Z-ADDBEAIC3    $NAIC3           Company Number
     C                     Z-ADDBEAODT    $NAODT           Scheduled Ship
     C                     MOVELBER4CD    $NR4CD           Sales Route Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $FAIC3           Company Number
     C                     Z-ADDBEGNDT    $FGNDT           Actual Shipped
     C                     Z-ADDBEAODT    $FAODT           Scheduled Ship
     C                     MOVELBER4CD    $FR4CD           Sales Route Cod
      * Load related totals format
     C                     Z-ADDBEAIC3    $MAIC3           Company Number
     C                     Z-ADDBEGNDT    $MGNDT           Actual Shipped
     C                     Z-ADDBEAODT    $MAODT           Scheduled Ship
     C                     MOVELBER4CD    $MR4CD           Sales Route Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $GAIC3           Company Number
     C                     Z-ADDBEC4NB    $GC4NB           Order Number
     C                     MOVELBEU1ST    $GU1ST           Price Status
     C                     MOVELBEU0ST    $GU0ST           Price Audit
     C                     MOVEL*BLANK    $GW2ST           USR Active Flag
     C                     MOVEL*BLANK    $GE6ST           USR Status (Y/N
     C                     MOVELBEPJST    $GPJST           LTL Flag
     C                     MOVELBEJNCD    $GJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $GANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $GBKC7           Ship To Custome
     C                     MOVELBEBRTX    $GBRTX           Ship To Name
     C                     MOVEL*BLANK    $GELTX           USR Shortened I
     C                     MOVELBEHMNA    $GHMNA           Ship To Address
     C                     MOVELBEHONA    $GHONA           Ship To Address
     C                     MOVELBEHPNA    $GHPNA           Ship To Address
     C                     MOVELBEHNNA    $GHNNA           Ship To City
     C                     MOVELBEDBCD    $GDBCD           Ship To State C
     C                     MOVELBECKTX    $GCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $GB0C7           Bill to Custome
     C                     MOVELBEAETX    $GAETX           Bill to Name
     C                     MOVELBEB1NA    $GB1NA           Bill to Address
     C                     MOVELBEB3NA    $GB3NA           Bill to Address
     C                     MOVELBEB4NA    $GB4NA           Bill to Address
     C                     MOVELBEB2NA    $GB2NA           Bill to City
     C                     MOVELBEBHCD    $GBHCD           Bill to State C
     C                     MOVELBEC8TX    $GC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $GBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $GA0DT           Order Date
     C                     Z-ADDBEA5DT    $GA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $GGNDT           Actual Shipped
     C                     Z-ADDBERMNB    $GRMNB           Load ID
     C                     Z-ADDBEACDT    $GACDT           Cancel Date
     C                     MOVELBEAQCD    $GAQCD           Terms Code
     C                     MOVELBEB6NA    $GB6NA           Special Instruc
     C                     MOVELBEBYNA    $GBYNA           Special Instruc
     C                     MOVELBEBZNA    $GBZNA           Carrier Code
     C                     MOVELBEGTST    $GGTST           Comment Print A
     C                     MOVELBEGVST    $GGVST           Comment Print I
     C                     MOVELBEGUST    $GGUST           Comment Print P
     C                     MOVELBEQFST    $GQFST           Comment Print S
     C                     MOVELBECQCD    $GCQCD           Reason Code
     C                     MOVELBEGJST    $GGJST           Order in Use
     C                     MOVELBEGWST    $GGWST           Header Status
     C                     MOVELBEGXST    $GGXST           Header Status L
     C                     MOVELBEGYST    $GGYST           Order Type Prin
     C                     Z-ADDBEAODT    $GAODT           Scheduled Ship
     C                     MOVELBEAIVN    $GAIVN           User Original E
     C                     Z-ADDBECXDT    $GCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $GJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $GA1WG           Order Weight To
     C                     Z-ADD*ZERO     $GSHWT           PS Weight Sched
     C                     MOVEL*BLANK    $GAJCD           Warehouse Code
     C                     MOVELBEXIST    $GXIST           Credit Hold
     C                     MOVELBEXJST    $GXJST           Production Hold
     C                     MOVELBEXKST    $GXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $GEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $GAFTM           Requested Deliv
     C                     MOVELBEE8CD    $GE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $GE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $GTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $GR1NB           Rated Freight
     C                     MOVELBEQ2CD    $GQ2CD           Shipping Method
     C                     MOVELBEU2ST    $GU2ST           Export Status
     C                     MOVELBEVEST    $GVEST           Palletize
     C                     MOVELBEVFST    $GVFST           Shrink Wrap
     C                     MOVELBEVGST    $GVGST           Slip Sheet
     C                     MOVELBERPCD    $GRPCD           Age Code
     C                     Z-ADDBERNNB    $GRNNB           Reefer Temperat
     C                     MOVELBEVDST    $GVDST           Load Type
     C                     Z-ADDBEATIN    $GATIN           Attach to Invoi
     C                     MOVELBEU4ST    $GU4ST           Load Plan Order
     C                     MOVELBEU5ST    $GU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $GRSRN           Resell Referenc
     C                     MOVELBEMHNA    $GMHNA           Special Comment
     C                     MOVELBEMINA    $GMINA           Special Comment
     C                     MOVELBEWBST    $GWBST           Affect Auto Acc
     C                     MOVELBER4CD    $GR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $GBFCD           Manager Level C
     C                     MOVELBEQ4CD    $GQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $GT3NB           Attach to Order
     C                     MOVELBESICD    $GSICD           Reason for Pric
     C                     Z-ADDBECONB    $GCONB           Invoice Number
     C                     MOVELBECEST    $GCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $GAWDT           Invoice Date
     C                     MOVELBEJPCD    $GJPCD           Event Code
     C                     MOVELBEXUST    $GXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $GZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $GVRVA           A/R order Value
     C                     MOVELBEOBST    $GOBST           Billing Activit
     C                     MOVELBEBCST    $GBCST           Block Order Fla
     C                     MOVELBEBDST    $GBDST           Order Certifica
     C                     Z-ADDBEB7VL    $GB7VL           Invoice Order V
     C                     MOVELBEGASX    $GGASX           Invoice Price T
     C                     MOVELBEGBSX    $GGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $GGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $GGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $GFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $GFOSX           Email Cust On O
     C                     MOVELBEFPSX    $GFPSX           Order Emailed
     C                     MOVELBEFQSX    $GFQSX           Export Docs Go
     C                     MOVELBEFRSX    $GFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $GFSSX           Broker Order St
     C                     MOVELBEFTSX    $GFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $GFUSX           Signal Demand S
     C                     MOVELBEFVSX    $GFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $GFWSX           Export USDA App
     C                     MOVELBEFXSX    $GFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $GFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $GNODT           OH Unused Date
     C                     Z-ADDBENPDT    $GNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $GNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $GNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $GNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $GBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $GBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $GBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $GBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $GBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $GH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $GH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $GH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $GH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $GH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $GC0C7           Claim Number
     C                     MOVELBEUVST    $GUVST           EDI Status 1
     C                     MOVELBEUWST    $GUWST           EDI Status 2
     C                     MOVELBEUXST    $GUXST           EDI Status 3
     C                     Z-ADDBEAATM    $GAATM           Job Time
     C                     MOVELBEAYNA    $GAYNA           User Id
     C                     MOVELBEA0NA    $GA0NA           Job Name
     C                     Z-ADDBEAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $HAIC3           Company Number
     C                     MOVELBER4CD    $HR4CD           Sales Route Cod
     C                     Z-ADDBEC4NB    $HC4NB           Order Number
     C                     MOVEL*BLANK    $HY7TX           Text USR 5
     C                     MOVELBEU1ST    $HU1ST           Price Status
     C                     MOVELBEU0ST    $HU0ST           Price Audit
     C                     MOVELBEZ1ST    $HZ1ST           Modified Flag
     C                     MOVEL*BLANK    $HPKST           Load Status
     C                     MOVELBEGWST    $HGWST           Header Status
     C                     MOVELBEBRTX    $HBRTX           Ship To Name
     C                     MOVELBEBCNA    $HBCNA           Customer Purcha
     C                     Z-ADDBEVRVA    $HVRVA           A/R order Value
     C                     MOVELBEOBST    $HOBST           Billing Activit
     C                     MOVELBEBCST    $HBCST           Block Order Fla
     C                     MOVELBEBDST    $HBDST           Order Certifica
     C                     Z-ADDBEB7VL    $HB7VL           Invoice Order V
     C                     MOVELBEGASX    $HGASX           Invoice Price T
     C                     MOVELBEGBSX    $HGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $HGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $HGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $HFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $HFOSX           Email Cust On O
     C                     MOVELBEFPSX    $HFPSX           Order Emailed
     C                     MOVELBEFQSX    $HFQSX           Export Docs Go
     C                     MOVELBEFRSX    $HFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $HFSSX           Broker Order St
     C                     MOVELBEFTSX    $HFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $HFUSX           Signal Demand S
     C                     MOVELBEFVSX    $HFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $HFWSX           Export USDA App
     C                     MOVELBEFXSX    $HFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $HFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $HNODT           OH Unused Date
     C                     Z-ADDBENPDT    $HNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $HNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $HNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $HNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $HBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $HBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $HBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    $HBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $HBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $HH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $HH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $HH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $HH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $HH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $HC0C7           Claim Number
     C                     MOVELBEJNCD    $HJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $HANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $HBKC7           Ship To Custome
     C                     Z-ADDBEAODT    $HAODT           Scheduled Ship
     C                     MOVELBEHMNA    $HHMNA           Ship To Address
     C                     MOVELBEHONA    $HHONA           Ship To Address
     C                     MOVELBEHPNA    $HHPNA           Ship To Address
     C                     MOVELBEHNNA    $HHNNA           Ship To City
     C                     MOVELBEDBCD    $HDBCD           Ship To State C
     C                     MOVELBECKTX    $HCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $HB0C7           Bill to Custome
     C                     MOVELBEAETX    $HAETX           Bill to Name
     C                     MOVELBEB1NA    $HB1NA           Bill to Address
     C                     MOVELBEB3NA    $HB3NA           Bill to Address
     C                     MOVELBEB4NA    $HB4NA           Bill to Address
     C                     MOVELBEB2NA    $HB2NA           Bill to City
     C                     MOVELBEBHCD    $HBHCD           Bill to State C
     C                     MOVELBEC8TX    $HC8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    $HA0DT           Order Date
     C                     Z-ADDBEA5DT    $HA5DT           Requested Ship
     C                     Z-ADDBEGNDT    $HGNDT           Actual Shipped
     C                     Z-ADDBEEIDT    $HEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $HAFTM           Requested Deliv
     C                     Z-ADDBERMNB    $HRMNB           Load ID
     C                     Z-ADD*ZERO     $HSHWT           PS Weight Sched
     C                     MOVEL*BLANK    $HAJCD           Warehouse Code
     C                     Z-ADD*ZERO     $HKIDT           Truck Departure
     C                     Z-ADD*ZERO     $HASTM           Truck Departure
     C                     Z-ADDBEACDT    $HACDT           Cancel Date
     C                     MOVELBEAQCD    $HAQCD           Terms Code
     C                     MOVELBEB6NA    $HB6NA           Special Instruc
     C                     MOVELBEBYNA    $HBYNA           Special Instruc
     C                     MOVELBEBZNA    $HBZNA           Carrier Code
     C                     MOVELBEGTST    $HGTST           Comment Print A
     C                     MOVELBEGVST    $HGVST           Comment Print I
     C                     MOVELBEGUST    $HGUST           Comment Print P
     C                     MOVELBEQFST    $HQFST           Comment Print S
     C                     MOVELBECQCD    $HCQCD           Reason Code
     C                     MOVELBEGJST    $HGJST           Order in Use
     C                     MOVELBEGXST    $HGXST           Header Status L
     C                     MOVELBEGYST    $HGYST           Order Type Prin
     C                     MOVELBEAIVN    $HAIVN           User Original E
     C                     Z-ADDBECXDT    $HCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $HJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $HA1WG           Order Weight To
     C                     MOVELBEXIST    $HXIST           Credit Hold
     C                     MOVELBEXJST    $HXJST           Production Hold
     C                     MOVELBEXKST    $HXKST           New Customer Ho
     C                     MOVELBEE8CD    $HE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $HE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $HTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $HR1NB           Rated Freight
     C                     MOVELBEQ2CD    $HQ2CD           Shipping Method
     C                     MOVELBEU2ST    $HU2ST           Export Status
     C                     MOVELBEVEST    $HVEST           Palletize
     C                     MOVELBEVFST    $HVFST           Shrink Wrap
     C                     MOVELBEVGST    $HVGST           Slip Sheet
     C                     MOVELBERPCD    $HRPCD           Age Code
     C                     Z-ADDBERNNB    $HRNNB           Reefer Temperat
     C                     MOVELBEVDST    $HVDST           Load Type
     C                     Z-ADDBEATIN    $HATIN           Attach to Invoi
     C                     MOVELBEU4ST    $HU4ST           Load Plan Order
     C                     MOVELBEU5ST    $HU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $HRSRN           Resell Referenc
     C                     MOVELBEMHNA    $HMHNA           Special Comment
     C                     MOVELBEMINA    $HMINA           Special Comment
     C                     MOVELBEWBST    $HWBST           Affect Auto Acc
     C                     MOVELBEBFCD    $HBFCD           Manager Level C
     C                     MOVELBEQ4CD    $HQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $HT3NB           Attach to Order
     C                     MOVELBESICD    $HSICD           Reason for Pric
     C                     Z-ADDBECONB    $HCONB           Invoice Number
     C                     MOVELBECEST    $HCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $HAWDT           Invoice Date
     C                     MOVELBEJPCD    $HJPCD           Event Code
     C                     MOVELBEXUST    $HXUST           Trans Contol AS
     C                     MOVELBEUWST    $HUWST           EDI Status 2
     C                     MOVELBEUXST    $HUXST           EDI Status 3
     C                     Z-ADDBEAATM    $HAATM           Job Time
     C                     MOVELBEAYNA    $HAYNA           User Id
     C                     MOVELBEA0NA    $HA0NA           Job Name
     C                     Z-ADDBEAXDT    $HAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Ord Status Details Px
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
     C           *LIKE     DEFN BEAODT    WZA002           Scheduled Ship
     C                     Z-ADDBEAODT    WZA002
     C           *LIKE     DEFN BEGNDT    WZA003           Actual Shipped
     C                     Z-ADDBEGNDT    WZA003
     C           *LIKE     DEFN BEC4NB    WZA004           Order Number
     C                     Z-ADDBEC4NB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @BFCPJ7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Select orders to be invoiced or Transfers
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Billing Activity Type is Invoice
      *   |- c2    : DB1.Order Type - Sales is Transfer Order
      *   '-
     C           BEOBST    IFEQ '1'                        *IF
     C           BEJNCD    OREQ 'TR'                       *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Modified flag: S=Shipped  M=Shipped Modified  ' '=Not Shipped
      * CASE: PAR.Modified Flag is Modified or Blank (*)
     C           P1Z1ST    IFEQ '*'                        *IF
      * Par.modified is *
      * CASE: DB1.Modified Flag is Modified
     C           BEZ1ST    IFEQ 'M'                        *IF
     C                     MOVELBEZ1ST    WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date is not entered
      *   |- c2    : DB1.Scheduled Ship Date LT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEGNDT    IFEQ *ZERO                      *IF
     C           BEAODT    IFLT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELBEZ1ST    WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Actual Shipped Date is entered
      *   |- c2    : DB1.Actual Shipped Date NE DB1.Scheduled Ship Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEGNDT    IFNE *ZERO                      *IF
     C           BEGNDT    IFNE BEAODT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'M'       WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Actual Quantities are not = Scheduled Quantities
      * RTV Qty&Wgt Sched&Act  RT - PD Order Detail  * 
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is Check Error
     C           W0RTN     IFEQ 'CHKERR'                   *IF
     C                     MOVEL'M'       WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR Modified Flag is blank
      * CASE: PAR.Modified Flag is Not Shipped
     C           P1Z1ST    IFEQ *BLANK                     *IF
     C                     MOVELBEZ1ST    WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * Control field is not an asterisk or blank
      * CASE: PAR.Modified Flag NE DB1.Modified Flag
     C           P1Z1ST    IFNE BEZ1ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBEZ1ST    WUZ1ST           Modified Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Block Order Flag
      * CASE: PAR.Block Order Flag NE WRK.BLANK
     C           P1BCST    IFNE WUGSTX                     *IF
      * CASE: DB1.Block Order Flag NE PAR.Block Order Flag
     C           BEBCST    IFNE P1BCST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWUZ1ST    P5D4ST           USR Flag 1
      * Select by warehouse
      * CASE: PAR.Warehouse Code is Warehouse Code Blank
     C           P3AJCD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0001           Company Number
     C                     Z-ADDBEC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUAJCD    P      Warehouse Code
      * CASE: PAR.Warehouse Code NE WRK.Warehouse Code
     C           P3AJCD    IFNE WUAJCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV Load Status        RT - OM Load Header  * 
     C                     EXSR SKRVGN
      * Select by load status
      * CASE: PAR.Load Status is *Blank
     C           P2PKST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Status NE WRK.Load Status
     C           P2PKST    IFNE WUPKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWUPKST    P6UFL2           USR Flag 2
      * Select by Actual Shipped Date
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE *ZERO                      *IF
      * If PAR.Shipped Status is not '*' then select only shipped records
      * CASE: PAR.Modified Flag is Modified or Blank (*)
     C           P1Z1ST    IFEQ '*'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Actual Shipped Date NE PAR.Actual Shipped Date
     C           BEGNDT    IFNE P1GNDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Price Method Code
      * CASE: PAR.Price Method Code is Not Blank
     C           P9Q7CD    IFNE *BLANK                     *IF
      * VAL Price Mth Exist   RT - Order Detail  * 
     C                     EXSR SLRVGN
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Scheduled Ship
     C                     MOVEL*BLANK    W0AL02  1        Actual Shipped
     C                     MOVEL*BLANK    W0AL03  1        Order Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL02  1        Actual Shipped
     C                     MOVEL'Y'       W0AL03  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BEAODT    IFNE WZA002                     Scheduled Ship
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BEGNDT    IFNE WZA003                     Actual Shipped
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           BEC4NB    IFNE WZA004                     Order Number
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$MKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$NKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Ord Status Details PO: Mainline
      *================================================================
      * PRT Ord Status Details PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQKB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQKB02           Order Number
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADD$MAIC3    WQKB01           Company Number
     C                     Z-ADD$HC4NB    WQKB02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
      * Establish starting position
     C           KPSB      SETLL@BGWKBM                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBAIC3    $LAIC3           Company Number
     C                     Z-ADDWBC4NB    $LC4NB           Order Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $IM4CD           USR Substitutio
     C                     Z-ADDWBHGCD    $IHGCD           Item Code
     C                     MOVEL*BLANK    $IGENA           Item Descriptio
     C                     Z-ADDWBCCQT    $ICCQT           Quantity Schedu
     C                     Z-ADDWBCBQT    $ICBQT           Quantity Shippe
     C                     Z-ADDWBAUWG    $IAUWG           Weight Schedule
     C                     Z-ADDWBAVQT    $IAVQT           Quantity Ordere
     C                     Z-ADDWBATWG    $IATWG           Weight Shipped
     C                     Z-ADDWBAIC3    $IAIC3           Company Number
     C                     Z-ADDWBC4NB    $IC4NB           Order Number
     C                     Z-ADDWBDPNB    $IDPNB           Order Sequence
     C                     Z-ADDWBUENB    $IUENB           Order Secondary
     C                     Z-ADDWBD0WG    $ID0WG           Weight Ordered
     C                     MOVELWBAGCD    $IAGCD           U/M - Ordered
     C                     Z-ADDWBAKPR    $IAKPR           Unit Price
     C                     Z-ADDWBAVWG    $IAVWG           Unit Weight Ord
     C                     MOVELWBAJCD    $IAJCD           Warehouse Code
     C                     Z-ADDWBR1NB    $IR1NB           Rated Freight
     C                     Z-ADD*ZERO     $IA7WG           USR Weight Conf
     C                     Z-ADDWBAUPR    $IAUPR           Unit Price Orde
     C                     MOVELWBG7NA    $IG7NA           Order Desc. Lin
     C                     MOVELWBG8NA    $IG8NA           Order Desc. Lin
     C                     Z-ADDWBAGCS    $IAGCS           Unit Cost Per P
     C                     Z-ADDWBAQCS    $IAQCS           Unit Cost Prici
     C                     MOVELWBAMST    $IAMST           Affect Inventor
     C                     MOVELWBANST    $IANST           Affect Sales Do
     C                     MOVELWBVAST    $IVAST           Affect Sales Pn
     C                     Z-ADDWBL6NB    $IL6NB           Contract Number
     C                     MOVEL*BLANK    $IF8NA           Warehouse Descr
     C                     Z-ADDWBBKC7    $IBKC7           Ship To Custome
     C                     Z-ADDWBCFC7    $ICFC7           Order Group Cod
     C                     MOVELWBFZST    $IFZST           Production Date
     C                     MOVELWBAVST    $IAVST           Catch Weight St
     C                     MOVELWBGMST    $IGMST           Detail Line Sta
     C                     MOVELWBGNST    $IGNST           Detail Line Sta
     C                     MOVELWBR4CD    $IR4CD           Sales Route Cod
     C                     MOVELWBGTST    $IGTST           Comment Print A
     C                     MOVELWBGVST    $IGVST           Comment Print I
     C                     MOVELWBGUST    $IGUST           Comment Print P
     C                     MOVELWBQFST    $IQFST           Comment Print S
     C                     MOVELWBKXCD    $IKXCD           Country Code
     C                     MOVELWBRZST    $IRZST           Work Confirm St
     C                     MOVELWBR0ST    $IR0ST           Work Over/Short
     C                     MOVELWBR1ST    $IR1ST           OD Production P
     C                     Z-ADDWBEXDT    $IEXDT           Market Pricing
     C                     Z-ADDWBBZPR    $IBZPR           Price Overage O
     C                     MOVELWBU1ST    $IU1ST           Price Status
     C                     MOVELWBU0ST    $IU0ST           Price Audit
     C                     MOVELWBRFCD    $IRFCD           Price Audit Rea
     C                     MOVELWBVEST    $IVEST           Palletize
     C                     Z-ADDWBMAVA    $IMAVA           Billing Detail
     C                     Z-ADDWBKDVA    $IKDVA           Billing Detail
     C                     MOVELWBVGST    $IVGST           Slip Sheet
     C                     Z-ADDWBL8VA    $IL8VA           Billing Detail
     C                     Z-ADDWBL9VA    $IL9VA           Quantity to Sub
     C                     Z-ADDWBA4WG    $IA4WG           Tare Weight Tot
     C                     MOVELWBRDCD    $IRDCD           Date Method Cod
     C                     MOVELWBQ7CD    $IQ7CD           Price Method Co
     C                     MOVELWBCRCD    $ICRCD           U/M - Base Pric
     C                     MOVELWBLQCD    $ILQCD           Commodity Marke
     C                     MOVELWBCQCD    $ICQCD           Reason Code
     C                     MOVELWBHICD    $IHICD           Quality Level
     C                     MOVELWBRNCD    $IRNCD           Pricing Product
     C                     MOVELWBROCD    $IROCD           Season Product
     C                     Z-ADDWBCXDT    $ICXDT           Date of Origina
     C                     MOVELWBAJVN    $IAJVN           User Profile Na
     C                     MOVELWBRBCD    $IRBCD           Item Level
     C                     Z-ADDWBRGNB    $IRGNB           Item Structure
     C                     Z-ADDWBRHNB    $IRHNB           Item Structure
     C                     Z-ADDWBRINB    $IRINB           Item Structure
     C                     Z-ADDWBGIDT    $IGIDT           Pricing Date Us
     C                     MOVELWBRPCD    $IRPCD           Age Code
     C                     MOVEL*BLANK    $IQKST           Display Flag
     C                     Z-ADDWBGNDT    $IGNDT           Actual Shipped
     C                     Z-ADDWBA5DT    $IA5DT           Requested Ship
     C                     MOVELWBJPCD    $IJPCD           Event Code
     C                     MOVELWBZ1ST    $IZ1ST           Modified Flag
     C                     Z-ADDWBAODT    $IAODT           Scheduled Ship
     C                     MOVELWBZ3ST    $IZ3ST           Substituted Fla
     C                     MOVELWBZ4ST    $IZ4ST           OD Schedule Ove
     C                     Z-ADDWBDUPR    $IDUPR           Invoice Unit Pr
     C                     Z-ADDWBB6VL    $IB6VL           Invoice Extende
     C                     Z-ADDWBA1AA    $IA1AA           Ham Group Numbe
     C                     MOVELWBFZSX    $IFZSX           OD Adj Type Ove
     C                     MOVELWBF0SX    $IF0SX           Affect Trade Fu
     C                     MOVELWBF1SX    $IF1SX           Affect Commissi
     C                     MOVELWBF2SX    $IF2SX           Affect Pricing
     C                     MOVELWBF3SX    $IF3SX           Released by Use
     C                     MOVELWBF4SX    $IF4SX           Ord TF Exempt C
     C                     MOVELWBF5SX    $IF5SX           OD Pallet Type
     C                     MOVELWBF6SX    $IF6SX           Production Ware
     C                     MOVELWBF7SX    $IF7SX           OD Price Type
     C                     Z-ADDWBNTDT    $INTDT           Warehouse Palle
     C                     Z-ADDWBNUDT    $INUDT           Consumed Item C
     C                     Z-ADDWBNVDT    $INVDT           Deadline Depart
     C                     Z-ADDWBNWDT    $INWDT           OD Price Type R
     C                     Z-ADDWBNXDT    $INXDT           OD Unused Date
     C                     Z-ADDWBBUTM    $IBUTM           Deadline Depart
     C                     Z-ADDWBBVTM    $IBVTM           Price Code
     C                     Z-ADDWBBWTM    $IBWTM           Maximum Net Wei
     C                     Z-ADDWBBXTM    $IBXTM           Substitution Li
     C                     Z-ADDWBBYTM    $IBYTM           Max Qty to sche
     C                     Z-ADDWBH5NX    $IH5NX           Warehouse Palle
     C                     Z-ADDWBH6NX    $IH6NX           Warehouse Avg P
     C                     Z-ADDWBH7NX    $IH7NX           OD Item Target
     C                     Z-ADDWBH8NX    $IH8NX           OD Minimum Unit
     C                     Z-ADDWBH9NX    $IH9NX           OD Maximum Unit
     C                     Z-ADDWBDVPR    $IDVPR           Order Gate Pric
     C                     Z-ADDWBDWPR    $IDWPR           OD Base MKT Ovr
     C                     Z-ADDWBDXPR    $IDXPR           OD Unused Prc 3
     C                     Z-ADDWBDYPR    $IDYPR           OD Unused Prc 4
     C                     Z-ADDWBDZPR    $IDZPR           OD Unused Prc 5
     C                     Z-ADDWBGSPR    $IGSPR           OD Unused Prc 6
     C                     Z-ADDWBGTPR    $IGTPR           OD Unused Prc 7
     C                     Z-ADDWBGUPR    $IGUPR           OD Unused Prc 8
     C                     MOVELWBHOST    $IHOST           OD UnUsed Price
     C                     MOVELWBHPST    $IHPST           OD UnUsed Price
     C                     MOVELWBIOST    $IIOST           OD UnUsed Price
     C                     Z-ADDWBPEWG    $IPEWG           Weight Amount E
     C                     Z-ADDWBRINY    $IRINY           Delv Ageing Day
     C                     Z-ADDWBTIDT    $ITIDT           Production Ovr
     C                     Z-ADDWBTJDT    $ITJDT           Production Ovr
     C                     MOVELWBH2ST    $IH2ST           OD UnUsed Statu
     C                     MOVELWBH0ST    $IH0ST           OD UnUsed Statu
     C                     MOVELWBH1ST    $IH1ST           OD UnUsed Statu
     C                     Z-ADDWBTKDT    $ITKDT           OD UnUsed Date
     C                     Z-ADDWBTLDT    $ITLDT           OD UnUsed Date
     C                     Z-ADDWBTMDT    $ITMDT           OD UnUsed Date
     C                     MOVELWBUVST    $IUVST           EDI Status 1
     C                     MOVELWBUWST    $IUWST           EDI Status 2
     C                     MOVELWBUXST    $IUXST           EDI Status 3
     C                     Z-ADDWBAATM    $IAATM           Job Time
     C                     MOVELWBAYNA    $IAYNA           User Id
     C                     MOVELWBA0NA    $IA0NA           Job Name
     C                     Z-ADDWBAXDT    $IAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: DB1.Order Secondary Line Seq is EQ 1
     C           WBUENB    IFEQ 1                          *IF
     C                     MOVEL*BLANK    $IM4CD           USR Substitutio
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $IM4CD           USR Substitutio
     C                     MOVEL'SUBED'   $IM4CD           USR Substitutio
     C                     END                             *FI
      * Set flag for substituted lines
      * CASE: DB1.Detail Line Status is Cancelled
     C           WBGMST    IFEQ 'X'                        *IF
      * ** Set the conditions flag to non-display fields if cancelled
     C                     MOVEL'Y'       WUPRST           Substitution Fl
     C                     MOVEL'N'       WUDTSX           Print (Yes/No)
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Set the conditions flag to display fields if okay
     C                     MOVEL'N'       WUPRST           Substitution Fl
     C                     MOVELP8DTSX    WUDTSX           Print (Yes/No)
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Order Dtl Pricing PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBAIC3    WZB001           Company Number
     C                     Z-ADDWBAIC3    WZB001
     C           *LIKE     DEFN WBC4NB    WZB002           Order Number
     C                     Z-ADDWBC4NB    WZB002
     C           *LIKE     DEFN WBDPNB    WZB003           Order Sequence
     C                     Z-ADDWBDPNB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BGWKBM                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     ELSE
      * Next record - Detect level breaks
     C           WBAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WBC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WBDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Order Dtl Pricing PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN IMAIC3    WQKC01           Company Number
     C           *LIKE     DEFN IMC4NB    WQKC02           Order Number
     C           *LIKE     DEFN IMDPNB    WQKC03           Order Sequence
     C           *LIKE     DEFN IMUENB    WQKC04           Order Secondary
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WQKC03           Order Sequence
     C                     KFLD           WQKC04           Order Secondary
      * Setup key
     C                     Z-ADD$IAIC3    WQKC01           Company Number
     C                     Z-ADD$IC4NB    WQKC02           Order Number
     C                     Z-ADD$IDPNB    WQKC03           Order Sequence
     C                     Z-ADD$IUENB    WQKC04           Order Secondary
      * Establish starting position
     C           KRSC      SETLL@IMCPZ0                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     MOVEL'Y'       W0CL04  1        Price Detail Se
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDIMAIC3    $KAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDIMAIC3    $JAIC3           Company Number
     C                     Z-ADDIMC4NB    $JC4NB           Order Number
     C                     Z-ADDIMDPNB    $JDPNB           Order Sequence
     C                     Z-ADDIMUENB    $JUENB           Order Secondary
     C                     Z-ADDIMPDSQ    $JPDSQ           Price Detail Se
     C                     Z-ADDIMBNPR    $JBNPR           Componant Price
     C                     MOVELIMQ9CD    $JQ9CD           Price Method Co
     C                     MOVELIMU6ST    $JU6ST           PD Status
     C                     MOVELIMUVST    $JUVST           EDI Status 1
     C                     MOVELIMUWST    $JUWST           EDI Status 2
     C                     MOVELIMUXST    $JUXST           EDI Status 3
     C                     Z-ADDIMAATM    $JAATM           Job Time
     C                     MOVELIMAYNA    $JAYNA           User Id
     C                     MOVELIMA0NA    $JA0NA           Job Name
     C                     Z-ADDIMAXDT    $JAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN IMAIC3    WZC001           Company Number
     C                     Z-ADDIMAIC3    WZC001
     C           *LIKE     DEFN IMC4NB    WZC002           Order Number
     C                     Z-ADDIMC4NB    WZC002
     C           *LIKE     DEFN IMDPNB    WZC003           Order Sequence
     C                     Z-ADDIMDPNB    WZC003
     C           *LIKE     DEFN IMUENB    WZC004           Order Secondary
     C                     Z-ADDIMUENB    WZC004
     C           *LIKE     DEFN IMPDSQ    WZC005           Price Detail Se
     C                     Z-ADDIMPDSQ    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@IMCPZ0                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C                     MOVEL*BLANK    W0CL04  1        Price Detail Se
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     MOVEL'Y'       W0CL04  1        Price Detail Se
     C                     ELSE
      * Next record - Detect level breaks
     C           IMAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           IMC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           IMDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           IMUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           IMPDSQ    IFNE WZC005                     Price Detail Se
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
      * Detail or Summary report
      * CASE: PAR.USR Summary/Detail or Tot is Detail
     C           P4S7ST    IFEQ 'D'                        *IF
     C                     MOVEL*BLANK    $CDPNA           USR Description
     C                     MOVEL@CN,01    $CDPNA           USR Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CDPNA           USR Description
     C                     MOVEL@CN,02    $CDPNA           USR Description
     C                     END                             *FI
      * Select Report
      * CASE: PAR.USR Detail or Summary is Report Selection 1
     C           P7STST    IFEQ '1'                        *IF
     C                     MOVEL@CN,03    $CESNA           USR Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,04    $CESNA           USR Description
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
     C                     MOVELP1R4CD    $CR4CD           Sales Route Cod
      * Sales Route description
      * CASE: PAR.Sales Route Code is not entered
     C           P1R4CD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     MOVEL'*All'    $CMZNA           Sales Route Des
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Description        RT - PD Sales Route  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     Z-ADDP1C4NB    $CC4NB           Order Number
     C                     MOVELP1U1ST    $CU1ST           Price Status
      * Price Status description
      * CASE: PAR.Price Status is Blank
     C           P1U1ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CNCNA           USR Desc. 10
     C                     MOVEL'*All'    $CNCNA           USR Desc. 10
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.USR Desc. 10 = Condition name of 1PG.Price Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250404   Y2LSNO  70       List number
     C                     PARM $CU1ST    W0INVL 25        Price Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
     C                     END                             *FI
     C                     MOVELP1U0ST    $CU0ST           Price Audit
      * Price Audit description
      * CASE: PAR.Price Audit is No Audit
     C           P1U0ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CJUNA           USR Description
     C                     MOVEL'*All'    $CJUNA           USR Description
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.USR Description - 15 = Condition name of 1PG.Price Audit
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250401   Y2LSNO  70       List number
     C                     PARM $CU0ST    W0INVL 25        Price Audit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CJUNA    PARM           W0CNNM 25        USR Description
      *
     C                     END                             *FI
     C                     MOVELP1Z1ST    $CZ1ST           Modified Flag
      * Modified Flag description
      * CASE: PAR.Modified Flag is Not Shipped
     C           P1Z1ST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CAUNA           Description
     C                     MOVEL'*All'    $CAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Description = Condition name of 1PG.Modified Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1329834   Y2LSNO  70       List number
     C                     PARM $CZ1ST    W0INVL 25        Modified Flag
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CAUNA    PARM           W0CNNM 25        Description
      *
     C                     END                             *FI
     C                     MOVELP1BCST    $CBCST           Block Order Fla
      * Block Order Flag description
      * CASE: PAR.Block Order Flag EQ WRK.BLANK
     C           P1BCST    IFEQ WUGSTX                     *IF
     C                     MOVEL*BLANK    $CJNNA           USR Description
     C                     MOVEL'*All'    $CJNNA           USR Description
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.USR Description = Condition name of 1PG.Block Order Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1447877   Y2LSNO  70       List number
     C                     PARM $CBCST    W0INVL 25        Block Order Fla
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CJNNA    PARM           W0CNNM 25        USR Description
      *
     C                     END                             *FI
     C                     MOVELP2PKST    $CPKST           Load Status
      * Load Status description
      * CASE: PAR.Load Status is *Blank
     C           P2PKST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CDCTX           Item Structure
     C                     MOVEL'*All'    $CDCTX           Item Structure
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Item Structure Type Desc = Condition name of 1PG.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM $CPKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CDCTX    PARM           W0CNNM 25        Item Structure
      *
     C                     END                             *FI
     C                     MOVELP1GWST    $CGWST           Header Status
      * Order status description
      * CASE: PAR.Header Status is *None
     C           P1GWST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CDDTX           Item Structure
     C                     MOVEL'*All'    $CDDTX           Item Structure
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Item Structure Group Desc = Condition name of 1PG.Header Stat
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1160607   Y2LSNO  70       List number
     C                     PARM $CGWST    W0INVL 25        Header Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CDDTX    PARM           W0CNNM 25        Item Structure
      *
     C                     END                             *FI
     C                     Z-ADDP1BKC7    $CBKC7           Ship To Custome
      * Ship to Customer description
      * CASE: PAR.Ship To Customer is equal to zero
     C           P1BKC7    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $CBRTX           Ship To Name
     C                     MOVEL'*All'    $CBRTX           Ship To Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     Z-ADDP1AODT    $CAODT           Scheduled Ship
     C                     Z-ADDP1GNDT    $CGNDT           Actual Shipped
     C                     Z-ADDP1RMNB    $CRMNB           Load ID
     C                     MOVELP3AJCD    $CAJCD           Warehouse Code
      * warehouse description
      * CASE: PAR.Warehouse Code is Warehouse Code Blank
     C           P3AJCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CF8NA           Warehouse Descr
     C                     MOVEL'*All'    $CF8NA           Warehouse Descr
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Warehouse Description = Condition name of 1PG.Warehouse Code
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 0000000   Y2LSNO  70       List number
     C                     PARM $CAJCD    W0INVL 25        Warehouse Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CF8NA    PARM           W0CNNM 25        Warehouse Descr
      *
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $CAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCAODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $CGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGNDT
     C                     MOVEL'0'       *IN79
     C           P1C4NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1AODT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P1GNDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           P1RMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Scheduled Ship Date of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Actual Shipped Date of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Order Number of PRT Ord Sts/SchedActDtsPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of PRT Ord Sts/SchedActDtsPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVELP5D4ST    $HZ1ST           Modified Flag
     C                     MOVELP6UFL2    $HPKST           Load Status
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0001           Company Number
     C                     Z-ADDBEC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $HAJCD    P      Warehouse Code
      * Display shipped weight if order has been shipped else weight orde
      * CASE: DB1.Event Code is Entered Thru 03 Picked
     C           BEJPCD    IFGE '01'                       *IF
     C           BEJPCD    ANDLE'03'
     C                     Z-ADDBEA1WG    $HSHWT           PS Weight Sched
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUATWG           Weight Shipped
      * RTV Actual Wgt Shipped RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$HAIC3    WL0006           Company Number
     C                     Z-ADD$HC4NB    WL0007           Order Number
     C                     Z-ADDWUATWG    WL0008           Weight Shipped
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WUATWG           Weight Shipped
     C                     Z-ADDWUATWG    $HSHWT           PS Weight Sched
     C                     END                             *FI
      * RTV Load Dispatch flds RT - Load Header  * 
     C                     EXSR SHRVGN
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVEL'BLOCK'   $HY7TX           Text USR 5
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $HY7TX           Text USR 5
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $HC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$HC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VHC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VHC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $HAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHAODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $HGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHGNDT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $HEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHEIDT
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  $HKIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHKIDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Ord Status Details PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Ord Status Details PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT Ord Status Details PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Ord Status Details PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Ord Status Details PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : CUR.Price Method Code is Deviated
      *   |- c2    : CUR.Price Method Code is Manual
      *   |- c3    : CUR.Price Method Code is Extended
      *   |- c4    : WRK.Print (Yes/No) USR is No
      *   '-
     C           $IQ7CD    IFEQ 'DEV'                      *IF
     C           $IQ7CD    OREQ 'MAN'                      *OR
     C           $IQ7CD    OREQ 'EXT'                      *OR
     C           WUDTSX    OREQ 'N'                        *OR
     C                     MOVEL'N'       $IQKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       $IQKST           Display Flag
     C                     END                             *FI
      * Rtv Descriptions      RT - Company/Item  * 
     C                     EXSR SIRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $IHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$IHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VIHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Pricing Date Used to display format
      * Convert date
     C           1000000   ADD  $IGIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIGIDT
     C                     MOVEL'0'       *IN79
     C           WUPRST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           $IQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Price Detail Sequence of Prt Order Dtl Pricing PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of Prt Order Dtl Pricing PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Component Price
      * CUR.Componant Price =
      *    *COMPUTE (x1 * x2)
      * x1    : CUR.Componant Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.1
     C           $JBNPR    MULT 1         W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $JBNPR           Componant Price
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Ord Sts/SchedActDtsPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  11        W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Ord Sts/SchedActDtsPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of PRT Ord Sts/SchedActDtsPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Actual Shipped Date of PRT Ord Sts/SchedActDtsPF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Ord Sts/SchedActDtsPF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Ord Sts/SchedActDtsPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Ord Status Details PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Ord Status Details PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Ord Status Details PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Ord Status Details PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Ord Status Details PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Order Dtl Pricing PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Order Dtl Pricing PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Order Dtl Pricing PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of Prt Order Dtl Pricing PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of Prt Order Dtl Pricing PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Price Detail Sequence of Prt Order Dtl Pricing PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Order Dtl Pricing PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CAPTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Description        RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL$CR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CMZNA           Sales Route Des
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    $CMZNA           Sales Route Des
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$CBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CBRTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $CBRTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Company Number
     C                     Z-ADDWL0002    WQSF02           Order Number
     C                     Z-ADDWL0003    OMDPNB           Order Sequence
     C                     Z-ADDWL0004    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Warehouse Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0005           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Actual Wgt Shipped RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSG01           Company Number
     C                     Z-ADDWL0007    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@BGWKAE                    *
     C           KRSSG     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WAATWG    WL0008           Weight Shipped
     C           KRSSG     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Load Dispatch flds RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$HRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WUAODT           Scheduled Ship
     C                     MOVELFJDXTX    WUDXTX           Trailer Id
     C                     MOVELFJBZNA    WUBZNA           Carrier Code
     C                     Z-ADDFJT4NB    WUT4NB           Schedule Sequen
     C                     MOVELFJQ2CD    WUQ2CD           Shipping Method
     C                     MOVELFJONTM    WUONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WUJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    WUTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WUJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    WUSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    WUJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    WULFTM           Load Finished T
     C                     Z-ADDFJJ7DT    WUJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    WUBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WUJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    WUBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $HKIDT           Truck Departure
     C                     Z-ADDFJASTM    $HASTM           Truck Departure
     C                     Z-ADDFJKADT    WUKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    WUAJCM           Adjusted Depart
     C                     MOVELFJXACD    WUXACD           Shipping Line
     C                     MOVELFJOANA    WUOANA           Port Delv Termi
     C                     Z-ADDFJKJDT    WUKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    WUATTM           Scheduled Deliv
     C                     MOVELFJOTRS    WUOTRS           LH Unused Sts
     C                     Z-ADDFJKKDT    WUKKDT           On Yard Date
     C                     Z-ADDFJAVTM    WUAVTM           On Yard Time
     C                     MOVELFJLHOS    WULHOS           Load Held Over
     C                     MOVELFJR3SX    WUR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    YL0001           LH Held Over Re
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$IAIC3    BZAIC3           Company Number
     C                     Z-ADD$IHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $IGENA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Qty&Wgt Sched&Act  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSJ01           Company Number
     C                     Z-ADDBEC4NB    WQSJ02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKL1                    *
     C           KRSSJ     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WUAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WUCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WUATWG           Weight Shipped
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDOMCCQT    WUCCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    WUAUWG           Weight Schedule
     C                     Z-ADDOMCBQT    WUCBQT           Quantity Shippe
     C                     Z-ADDOMATWG    WUATWG           Weight Shipped
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Quantity Shipped Total is Greater than zero
      *   |- c2    : DB1.Quantity Shipped Total NE DB1.Quantity Scheduled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMCBQT    IFGT *ZERO                      *IF
     C           OMCBQT    IFNE OMCCQT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'CHKERR'  W0RTN            *Return code
     C                     END                             *FI
     C           KRSSJ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * VAL Price Mth Exist   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0002           Record Found -O
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSL01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSL01           Company Number
     C                     Z-ADDBEC4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE: PAR.Price Method Code EQ DB1.Price Method Code
     C           P9Q7CD    IFEQ OMQ7CD                     *IF
     C                     MOVEL'Y'       YL0002           Record Found -O
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Ord Status Details Px
      *================================================================
      * CASE: PAR.USR Summary/Detail or Tot is Summary
     C           P4S7ST    IFEQ 'S'                        *IF
     C                     GOTO UAEXIT                     *QUIT
     C                     END                             *FI
      * PRT Ord Status Details PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Order Dtl Pricing PO
      *================================================================
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Print (Yes/No) USR is No
      *   |- c2    : CUR.Price Method Code is Manual
      *   |- c3    : CUR.Price Method Code is Deviated
      *   '-
     C           P8DTSX    IFEQ 'N'                        *IF
     C           $IQ7CD    OREQ 'MAN'                      *OR
     C           $IQ7CD    OREQ 'DEV'                      *OR
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * Prt Order Dtl Pricing PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Ord Status Details PO: Initialise
      *================================================================
      * USER: Initialize program
      * ** Set report display control
     C                     MOVELP8DTSX    WUDTSX           Print (Yes/No)
      * ***** Change Log and Comments
      * ** 10/03/2006 LJB L61002C
      * ** Added Print status flag to control display of pricing
      * ** information. This flag is passed in from the menu.
      * ** Also use to prevent printing price for cancelled lines.
      * *****
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5D4ST           USR Flag 1
     C                     MOVEL*BLANK    P6UFL2           USR Flag 2
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEAODT           Scheduled Ship
     C                     MOVEL*LOVAL    BEGNDT           Actual Shipped
     C                     MOVEL*LOVAL    BEC4NB           Order Number
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Weight Shipped Total
     C                     Z-ADD*ZERO     WUATWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WATLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WATMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Trailer Id
     C                     MOVEL*BLANK    WUDXTX 20
      * Define work field Carrier Code
     C                     MOVEL*BLANK    WUBZNA  3
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field On Time - (Y/N)
     C                     MOVEL*BLANK    WUONTM  1
      * Define work field Truck Ready Date
     C                     Z-ADD*ZERO     WUJ4DT  70
      * Define work field Truck Ready Time
     C                     Z-ADD*ZERO     WUTRTM  60
      * Define work field Spotted Date
     C                     Z-ADD*ZERO     WUJ5DT  70
      * Define work field Spotted Time
     C                     Z-ADD*ZERO     WUSPTM  60
      * Define work field Load Finished Date
     C                     Z-ADD*ZERO     WUJ6DT  70
      * Define work field Load Finished Time
     C                     Z-ADD*ZERO     WULFTM  60
      * Define work field BOL Complete Date
     C                     Z-ADD*ZERO     WUJ7DT  70
      * Define work field BOL Complete Time
     C                     Z-ADD*ZERO     WUBOTM  60
      * Define work field BOL Received Date
     C                     Z-ADD*ZERO     WUJ8DT  70
      * Define work field BOL Received Time
     C                     Z-ADD*ZERO     WUBLTM  60
      * Define work field Adjusted Departure Date
     C                     Z-ADD*ZERO     WUKADT  70
      * Define work field Adjusted Departure Time
     C                     Z-ADD*ZERO     WUAJCM  60
      * Define work field Shipping Line
     C                     MOVEL*BLANK    WUXACD  3
      * Define work field Port Delv Terminal
     C                     MOVEL*BLANK    WUOANA 20
      * Define work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     WUKJDT  70
      * Define work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     WUATTM  60
      * Define work field LH Unused Sts
     C                     MOVEL*BLANK    WUOTRS  1
      * Define work field On Yard Date
     C                     Z-ADD*ZERO     WUKKDT  70
      * Define work field On Yard Time
     C                     Z-ADD*ZERO     WUAVTM  60
      * Define work field Load Held Over
     C                     MOVEL*BLANK    WULHOS  1
      * Define work field LH On-Time Reason Code
     C                     MOVEL*BLANK    WUR3SX  3
      * Define work field Substitution Flag
     C                     MOVEL*BLANK    WUPRST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBAIC3           Company Number
     C                     MOVEL*LOVAL    WBC4NB           Order Number
     C                     MOVEL*LOVAL    WBDPNB           Order Sequence
     C                     MOVEL*LOVAL    WBUENB           Order Secondary
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    IMAIC3           Company Number
     C                     MOVEL*LOVAL    IMC4NB           Order Number
     C                     MOVEL*LOVAL    IMDPNB           Order Sequence
     C                     MOVEL*LOVAL    IMUENB           Order Secondary
     C                     MOVEL*LOVAL    IMPDSQ           Price Detail Se
      * Define work field Modified Flag
     C                     MOVEL*BLANK    WUZ1ST  1
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008 112
      * Define local work field LH Held Over Reason
     C                     MOVEL*BLANK    YL0001  3
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0004  2
      * Define local work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    YL0002  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * RMC Chg act ship date selection to select par.actual ship date 8/
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 * Detail *
00002 * Summary *
00003 by Sales Route
00004 by Scheduled Ship Date
