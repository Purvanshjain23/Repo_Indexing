     H/TITLE EDT EDI Automated Ord  DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 07/09/25  Time  : 10:19:02
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPUD3DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT EDI Automated Ord  DF Display file
      *
     FECP005L1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : EDI Purchase Order Detail Retrieval index
      *
     FECP004L1IF  E           K        DISK
      * RTV : EDI Purchase Order Header Retrieval index
      *
     FECP006L1IF  E           K        DISK
      * RTV : EDI Purchase Order Name   Retrieval index
      *
     FPDNERELBIF  E           K        DISK
      * RSQ : Customer EXT              EDI Duns/ShpTo
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCABBREL4IF  E           K        DISK
      * RSQ : Customer Master           Bill To/Ship To
      *
     FCABBRELBIF  E           K        DISK
      * RSQ : Customer Master           RSQ Bill to (A/R) Active
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPUAAREL1IF  E           K        DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPBB8REL1IF  E           K        DISK
      * RTV : Trade Partner Control     Retrieval index
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FPOBIREL2IF  E           K        DISK
      * RSQ : Customer Item Reference   Ship to, CIR Resource
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAAPREL3IF  E           K        DISK
      * RTV : Salesperson               Active records only
      *
     FPDIHREL3IF  E           K        DISK
      * RSQ : Price Method Header       System/Co/Price Method
      *
     FECP005L3IF  E           K        DISK
      * RSQ : EDI Purchase Order Detail ST02-TRANS SET Ctl/Seq
      *
     FCABZRELGIF  E           K        DISK
      * RTV : Company Item              Active Finished Goods
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FPUB6CPL2IF  E           K        DISK
      * RTV : Pallet Master             Active Records Only
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FECP005L0UF  E           K        DISK
      * UPD : EDI Purchase Order Detail Update index
      *
     FECP004L0UF  E           K        DISK
      * UPD : EDI Purchase Order Header Update index
      *
     E                    A1         07  1
     E                    A2         07  1
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 044  5 0A
     E                    W0END   7 044  5 0A
     E                    W0NAM   7 044 10
      * Long constants
     E                    @CN#    1  13  6   @CN    25
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WABKC7
     I              NEUFTX                          WAUFTX
     I              NEUGTX                          WAUGTX
     I              NEPFNA                          WAPFNA
     I              NEJ5NX                          WAJ5NX
     I              NEU5TX                          WAU5TX
     I              NEU6TX                          WAU6TX
     I              NEW0TX                          WAW0TX
     I              NEHSSX                          WAHSSX
     I              NEHUSX                          WAHUSX
     I              NEHVSX                          WAHVSX
     I              NEAAC8                          WAAAC8
     I              NEP0SX                          WAP0SX
     I              NEP1SX                          WAP1SX
     I              NEP2SX                          WAP2SX
     I              NEP3SX                          WAP3SX
     I              NEP4SX                          WAP4SX
     I              NEP5SX                          WAP5SX
     I              NEP6SX                          WAP6SX
     I              NEUVST                          WAUVST
     I              NEUWST                          WAUWST
     I              NEUXST                          WAUXST
     I              NEVSST                          WAVSST
     I              NEAATM                          WAAATM
     I              NEAYNA                          WAAYNA
     I              NEA0NA                          WAA0NA
     I              NEAXDT                          WAAXDT
      *
     I@BBREC1
      * Customer Master           Bill To/Ship To
      * Renamed input format fields
     I              BBBKC7                          WBBKC7
     I              BBAYTX                          WBAYTX
     I              BBACNA                          WBACNA
     I              BBADNA                          WBADNA
     I              BBAENA                          WBAENA
     I              BBAJNA                          WBAJNA
     I              BBBGCD                          WBBGCD
     I              BBG5CD                          WBG5CD
     I              BBBTTX                          WBBTTX
     I              BBBVTX                          WBBVTX
     I              BBBWTX                          WBBWTX
     I              BBABTX                          WBABTX
     I              BBA2NA                          WBA2NA
     I              BBCBST                          WBCBST
     I              BBB0NA                          WBB0NA
     I              BBP3NB                          WBP3NB
     I              BBAXNA                          WBAXNA
     I              BBI6DT                          WBI6DT
     I              BBAYDT                          WBAYDT
     I              BBANC7                          WBANC7
     I              BBBTC7                          WBBTC7
     I              BBK6ST                          WBK6ST
     I              BBUZST                          WBUZST
     I              BBKXCD                          WBKXCD
     I              BBLTCD                          WBLTCD
     I              BBQNST                          WBQNST
     I              BBS2NB                          WBS2NB
     I              BBVHVA                          WBVHVA
     I              BBI7DT                          WBI7DT
     I              BBRJST                          WBRJST
     I              BBRKST                          WBRKST
     I              BBQWST                          WBQWST
     I              BBQXST                          WBQXST
     I              BBQYST                          WBQYST
     I              BBUNCS                          WBUNCS
     I              BBUVST                          WBUVST
     I              BBUWST                          WBUWST
     I              BBUXST                          WBUXST
     I              BBVSST                          WBVSST
     I              BBAATM                          WBAATM
     I              BBAYNA                          WBAYNA
     I              BBA0NA                          WBA0NA
     I              BBAXDT                          WBAXDT
      *
     I@BBREXJ
      * Customer Master           RSQ Bill to (A/R) Active
      * Renamed input format fields
     I              BBBKC7                          WCBKC7
     I              BBAYTX                          WCAYTX
     I              BBACNA                          WCACNA
     I              BBADNA                          WCADNA
     I              BBAENA                          WCAENA
     I              BBAJNA                          WCAJNA
     I              BBBGCD                          WCBGCD
     I              BBG5CD                          WCG5CD
     I              BBBTTX                          WCBTTX
     I              BBBVTX                          WCBVTX
     I              BBBWTX                          WCBWTX
     I              BBABTX                          WCABTX
     I              BBA2NA                          WCA2NA
     I              BBCBST                          WCCBST
     I              BBB0NA                          WCB0NA
     I              BBP3NB                          WCP3NB
     I              BBAXNA                          WCAXNA
     I              BBI6DT                          WCI6DT
     I              BBAYDT                          WCAYDT
     I              BBANC7                          WCANC7
     I              BBBTC7                          WCBTC7
     I              BBK6ST                          WCK6ST
     I              BBUZST                          WCUZST
     I              BBKXCD                          WCKXCD
     I              BBLTCD                          WCLTCD
     I              BBQNST                          WCQNST
     I              BBS2NB                          WCS2NB
     I              BBVHVA                          WCVHVA
     I              BBI7DT                          WCI7DT
     I              BBRJST                          WCRJST
     I              BBRKST                          WCRKST
     I              BBQWST                          WCQWST
     I              BBQXST                          WCQXST
     I              BBQYST                          WCQYST
     I              BBUNCS                          WCUNCS
     I              BBUVST                          WCUVST
     I              BBUWST                          WCUWST
     I              BBUXST                          WCUXST
     I              BBVSST                          WCVSST
     I              BBAATM                          WCAATM
     I              BBAYNA                          WCAYNA
     I              BBA0NA                          WCA0NA
     I              BBAXDT                          WCAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@BIRECZ
      * Customer Item Reference   Ship to, CIR Resource
      * Renamed input format fields
     I              BIBKC7                          WEBKC7
     I              BIHGCD                          WEHGCD
     I              BICOAA                          WECOAA
     I              BICPAA                          WECPAA
     I              BIPSNA                          WEPSNA
     I              BIPTNA                          WEPTNA
     I              BIPUNA                          WEPUNA
     I              BILBSX                          WELBSX
     I              BILCSX                          WELCSX
     I              BILDSX                          WELDSX
     I              BILESX                          WELESX
     I              BILFSX                          WELFSX
     I              BIVSST                          WEVSST
     I              BIMJDT                          WEMJDT
     I              BIBETM                          WEBETM
     I              BICCVN                          WECCVN
     I              BICDVN                          WECDVN
     I              BIMKDT                          WEMKDT
     I              BIBFTM                          WEBFTM
     I              BICEVN                          WECEVN
     I              BICFVN                          WECFVN
      *
     I@P005LD
      * EDI Purchase Order Detail Update index
      * Renamed input format fields
     I              BRTSCN                          WFTSCN
     I              BRSEQX                          WFSEQX
     I              BRLEST                          WFLEST
     I              BRS2NY                          WFS2NY
     I              BRD5VL                          WFD5VL
     I              BRUNIT                          WFUNIT
     I              BRPRCX                          WFPRCX
     I              BRUPCX                          WFUPCX
     I              BRPRQL                          WFPRQL
     I              BRPRID                          WFPRID
     I              BRDESC                          WFDESC
     I              BRR2AA                          WFR2AA
     I              BRAOU1                          WFAOU1
     I              BRR4AA                          WFR4AA
     I              BRAQU1                          WFAQU1
     I              BRR3AA                          WFR3AA
     I              BRAPU1                          WFAPU1
     I              BRYCT1                          WFYCT1
     I              BRNKST                          WFNKST
     I              BRUEDT                          WFUEDT
     I              BROIAA                          WFOIAA
     I              BRMJVL                          WFMJVL
     I              BRUINY                          WFUINY
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
     I              ADQDSC                          WGQDSC
      *
     I@P005O1
      * EDI Purchase Order Detail ST02-TRANS SET Ctl/Seq
      * Renamed input format fields
     I              BRTSCN                          WHTSCN
     I              BRSEQX                          WHSEQX
     I              BRLEST                          WHLEST
     I              BRS2NY                          WHS2NY
     I              BRD5VL                          WHD5VL
     I              BRUNIT                          WHUNIT
     I              BRPRCX                          WHPRCX
     I              BRUPCX                          WHUPCX
     I              BRPRQL                          WHPRQL
     I              BRPRID                          WHPRID
     I              BRDESC                          WHDESC
     I              BRR2AA                          WHR2AA
     I              BRAOU1                          WHAOU1
     I              BRR4AA                          WHR4AA
     I              BRAQU1                          WHAQU1
     I              BRR3AA                          WHR3AA
     I              BRAPU1                          WHAPU1
     I              BRYCT1                          WHYCT1
     I              BRNKST                          WHNKST
     I              BRUEDT                          WHUEDT
     I              BROIAA                          WHOIAA
     I              BRMJVL                          WHMJVL
     I              BRUINY                          WHUINY
      *
     I@P004K9
      * EDI Purchase Order Header Update index
      * Renamed input format fields
     I              BQTSCN                          WITSCN
     I              BQL3SX                          WIL3SX
     I              BQOSDT                          WIOSDT
     I              BQPONO                          WIPONO
     I              BQDKAA                          WIDKAA
     I              BQNAME                          WINAME
     I              BQCQLF                          WICQLF
     I              BQCNUM                          WICNUM
     I              BQINRF                          WIINRF
     I              BQGNTX                          WIGNTX
     I              BQHUAA                          WIHUAA
     I              BQHUVL                          WIHUVL
     I              BQHVAA                          WIHVAA
     I              BQX8T1                          WIX8T1
     I              BQJ2AA                          WIJ2AA
     I              BQT6DT                          WIT6DT
     I              BQQLFX                          WIQLFX
     I              BQDELV                          WIDELV
     I              BQSHMT                          WISHMT
     I              BQMTTY                          WIMTTY
     I              BQPLEX                          WIPLEX
     I              BQLDOP                          WILDOP
     I              BQROUT                          WIROUT
     I              BQFOBP                          WIFOBP
     I              BQD3VL                          WID3VL
     I              BQUNIT                          WIUNIT
     I              BQD4VL                          WID4VL
     I              BQAMTX                          WIAMTX
     I              BQDSTS                          WIDSTS
     I              BQSRAA                          WISRAA
     I              BQBRU1                          WIBRU1
     I              BQSSAA                          WISSAA
     I              BQBSU1                          WIBSU1
     I              BQSTAA                          WISTAA
     I              BQBTU1                          WIBTU1
     I              BQSUAA                          WISUAA
     I              BQBUU1                          WIBUU1
     I              BQSVAA                          WISVAA
     I              BQBVU1                          WIBVU1
     I              BQSWAA                          WISWAA
     I              BQBWU1                          WIBWU1
     I              BQSXAA                          WISXAA
     I              BQBXU1                          WIBXU1
     I              BQYDT1                          WIYDT1
     I              BQNLST                          WINLST
     I              BQUFDT                          WIUFDT
     I              BQOJAA                          WIOJAA
     I              BQJ5NX                          WIJ5NX
      *
     I@BZREZG
      * Company Item              Active Items Only
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZHGCD                          WKHGCD
     I              BZAVNA                          WKAVNA
     I              BZAWNA                          WKAWNA
     I              BZL7NA                          WKL7NA
     I              BZL8NA                          WKL8NA
     I              BZL6NA                          WKL6NA
     I              BZMFNA                          WKMFNA
     I              BZADCD                          WKADCD
     I              BZAWPC                          WKAWPC
     I              BZLXST                          WKLXST
     I              BZAECD                          WKAECD
     I              BZAXPC                          WKAXPC
     I              BZLYST                          WKLYST
     I              BZAFCD                          WKAFCD
     I              BZAICD                          WKAICD
     I              BZAIWG                          WKAIWG
     I              BZHICD                          WKHICD
     I              BZRBCD                          WKRBCD
     I              BZFZST                          WKFZST
     I              BZAVST                          WKAVST
     I              BZCZWG                          WKCZWG
     I              BZC0WG                          WKC0WG
     I              BZURTN                          WKURTN
     I              BZAJC8                          WKAJC8
     I              BZRINB                          WKRINB
     I              BZRHNB                          WKRHNB
     I              BZRGNB                          WKRGNB
     I              BZLNCD                          WKLNCD
     I              BZTFNB                          WKTFNB
     I              BZN0CD                          WKN0CD
     I              BZX4ST                          WKX4ST
     I              BZTMVA                          WKTMVA
     I              BZTNVA                          WKTNVA
     I              BZBLPR                          WKBLPR
     I              BZBMPR                          WKBMPR
     I              BZLRCD                          WKLRCD
     I              BZU9ST                          WKU9ST
     I              BZCMCO                          WKCMCO
     I              BZQ1CD                          WKQ1CD
     I              BZQ8CD                          WKQ8CD
     I              BZCHTM                          WKCHTM
     I              BZQZCD                          WKQZCD
     I              BZXWST                          WKXWST
     I              BZXXST                          WKXXST
     I              BZVMST                          WKVMST
     I              BZSWGH                          WKSWGH
     I              BZPPHE                          WKPPHE
     I              BZR3CD                          WKR3CD
     I              BZSDCD                          WKSDCD
     I              BZICN1                          WKICN1
     I              BZSVCD                          WKSVCD
     I              BZICN2                          WKICN2
     I              BZSWCD                          WKSWCD
     I              BZV2NB                          WKV2NB
     I              BZSXCD                          WKSXCD
     I              BZITCN                          WKITCN
     I              BZSYCD                          WKSYCD
     I              BZITC5                          WKITC5
     I              BZSZCD                          WKSZCD
     I              BZICN6                          WKICN6
     I              BZS0CD                          WKS0CD
     I              BZICN7                          WKICN7
     I              BZS1CD                          WKS1CD
     I              BZICN8                          WKICN8
     I              BZS2CD                          WKS2CD
     I              BZICN9                          WKICN9
     I              BZS3CD                          WKS3CD
     I              BZICN0                          WKICN0
     I              BZS4CD                          WKS4CD
     I              BZSFNB                          WKSFNB
     I              BZA3WG                          WKA3WG
     I              BZSJNB                          WKSJNB
     I              BZLLCD                          WKLLCD
     I              BZLMCD                          WKLMCD
     I              BZP3ST                          WKP3ST
     I              BZSKNB                          WKSKNB
     I              BZSLNB                          WKSLNB
     I              BZSMNB                          WKSMNB
     I              BZP4ST                          WKP4ST
     I              BZCFNB                          WKCFNB
     I              BZCGNB                          WKCGNB
     I              BZILNB                          WKILNB
     I              BZCHNB                          WKCHNB
     I              BZCINB                          WKCINB
     I              BZCJNB                          WKCJNB
     I              BZCMNB                          WKCMNB
     I              BZCNNB                          WKCNNB
     I              BZCRNB                          WKCRNB
     I              BZCSNB                          WKCSNB
     I              BZCVNB                          WKCVNB
     I              BZCWNB                          WKCWNB
     I              BZCXNB                          WKCXNB
     I              BZCZNB                          WKCZNB
     I              BZC0NB                          WKC0NB
     I              BZN1CD                          WKN1CD
     I              BZB4NB                          WKB4NB
     I              BZB5NB                          WKB5NB
     I              BZX5ST                          WKX5ST
     I              BZX6ST                          WKX6ST
     I              BZX7ST                          WKX7ST
     I              BZPCCT                          WKPCCT
     I              BZBDNB                          WKBDNB
     I              BZBJNB                          WKBJNB
     I              BZSUST                          WKSUST
     I              BZSVST                          WKSVST
     I              BZSYST                          WKSYST
     I              BZSZST                          WKSZST
     I              BZS1ST                          WKS1ST
     I              BZXRCD                          WKXRCD
     I              BZXTCD                          WKXTCD
     I              BZXUCD                          WKXUCD
     I              BZF5WG                          WKF5WG
     I              BZF6WG                          WKF6WG
     I              BZF7WG                          WKF7WG
     I              BZBLNB                          WKBLNB
     I              BZBNNB                          WKBNNB
     I              BZS2ST                          WKS2ST
     I              BZS4ST                          WKS4ST
     I              BZS5ST                          WKS5ST
     I              BZS6ST                          WKS6ST
     I              BZS8ST                          WKS8ST
     I              BZS9ST                          WKS9ST
     I              BZTCST                          WKTCST
     I              BZTDST                          WKTDST
     I              BZUVST                          WKUVST
     I              BZUWST                          WKUWST
     I              BZUXST                          WKUXST
     I              BZVSST                          WKVSST
     I              BZAATM                          WKAATM
     I              BZAYNA                          WKAYNA
     I              BZA0NA                          WKA0NA
     I              BZAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQECP01    E DSECP005L0
      * UPD : EDI Purchase Order Detail Update index
      * Renamed input format fields
     I              BRTSCN                          WFTSCN
     I              BRSEQX                          WFSEQX
     I              BRLEST                          WFLEST
     I              BRS2NY                          WFS2NY
     I              BRD5VL                          WFD5VL
     I              BRUNIT                          WFUNIT
     I              BRPRCX                          WFPRCX
     I              BRUPCX                          WFUPCX
     I              BRPRQL                          WFPRQL
     I              BRPRID                          WFPRID
     I              BRDESC                          WFDESC
     I              BRR2AA                          WFR2AA
     I              BRAOU1                          WFAOU1
     I              BRR4AA                          WFR4AA
     I              BRAQU1                          WFAQU1
     I              BRR3AA                          WFR3AA
     I              BRAPU1                          WFAPU1
     I              BRYCT1                          WFYCT1
     I              BRNKST                          WFNKST
     I              BRUEDT                          WFUEDT
     I              BROIAA                          WFOIAA
     I              BRMJVL                          WFMJVL
     I              BRUINY                          WFUINY
      *
     IYARDCS      DS                            215
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQECP02    E DSECP004L0
      * UPD : EDI Purchase Order Header Update index
      * Renamed input format fields
     I              BQTSCN                          WITSCN
     I              BQL3SX                          WIL3SX
     I              BQOSDT                          WIOSDT
     I              BQPONO                          WIPONO
     I              BQDKAA                          WIDKAA
     I              BQNAME                          WINAME
     I              BQCQLF                          WICQLF
     I              BQCNUM                          WICNUM
     I              BQINRF                          WIINRF
     I              BQGNTX                          WIGNTX
     I              BQHUAA                          WIHUAA
     I              BQHUVL                          WIHUVL
     I              BQHVAA                          WIHVAA
     I              BQX8T1                          WIX8T1
     I              BQJ2AA                          WIJ2AA
     I              BQT6DT                          WIT6DT
     I              BQQLFX                          WIQLFX
     I              BQDELV                          WIDELV
     I              BQSHMT                          WISHMT
     I              BQMTTY                          WIMTTY
     I              BQPLEX                          WIPLEX
     I              BQLDOP                          WILDOP
     I              BQROUT                          WIROUT
     I              BQFOBP                          WIFOBP
     I              BQD3VL                          WID3VL
     I              BQUNIT                          WIUNIT
     I              BQD4VL                          WID4VL
     I              BQAMTX                          WIAMTX
     I              BQDSTS                          WIDSTS
     I              BQSRAA                          WISRAA
     I              BQBRU1                          WIBRU1
     I              BQSSAA                          WISSAA
     I              BQBSU1                          WIBSU1
     I              BQSTAA                          WISTAA
     I              BQBTU1                          WIBTU1
     I              BQSUAA                          WISUAA
     I              BQBUU1                          WIBUU1
     I              BQSVAA                          WISVAA
     I              BQBVU1                          WIBVU1
     I              BQSWAA                          WISWAA
     I              BQBWU1                          WIBWU1
     I              BQSXAA                          WISXAA
     I              BQBXU1                          WIBXU1
     I              BQYDT1                          WIYDT1
     I              BQNLST                          WINLST
     I              BQUFDT                          WIUFDT
     I              BQOJAA                          WIOJAA
     I              BQJ5NX                          WIJ5NX
      *
     IYBRDCS      DS                            516
     IYCRDCS      DS                            516
     IYDRDCS      DS                            215
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: EDI Purchase Order Detail
      * I : RST ST02-TRANS SET CONTROL NU
     I                                    P   1   50P1TSCN
      * N :  ITEM SEQUENCE NUMBER
     I                                    P   6   70P1SEQX
      * N :  G6801-QUANTITY ORDERED
     I                                    P   8  134P1D5VL
      * N :  G6803-ITEM LIST COST
     I                                    P  14  174P1PRCX
      * N :  G6804/P107 UPC/GTIN CODE
     I                                       18  32 P1UPCX
      * N :  G6805/P108 PROD ID QUAL
     I                                       33  34 P1PRQL
      * N :  G6806/P109 PRODUCT ID
     I                                       35  44 P1PRID
      * N :  G6807/PO110 Prod ID Qual
     I                                       45  46 P1R2AA
      * N :  G6808/PO111 Prod ID
     I                                       47  76 P1AOU1
     IP2PARM      DS
      * FLD: EDI Purchase Order Header
      * N :  G5002-ORDER DATE
     I                                    P   1   40P2OSDT
      * I :  G5003-PURCHASE ORDER NUMB
     I                                        5  26 P2PONO
      * N :  DTM01-Ship Date Qualifier
     I                                       27  29 P2J2AA
      * N :  G6202 Ship Date
     I                                    P  30  330P2T6DT
      * N :  G6201-DATE QUALIFIER
     I                                       34  36 P2QLFX
      * N :  G6202-DELIVERY DATE
     I                                    P  37  400P2DELV
      * N :  G6601-SHIPMENT METHOD
     I                                       41  42 P2SHMT
      * N :  OH Order Number
     I                                       43  72 P2BXU1
      * I :  EDI Trading Partner No
     I                                       73  78 P2J5NX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  PRT Printer Device
     I                                        1  10 P3WRST
      * N :  PRT Hold Output Sts
     I                                       11  14 P3WSST
      * N :  PRT Save Output Sts
     I                                       15  18 P3WTST
      * N :  PRT Number of Copies
     I                                       19  200P3DYNB
      * N :  PRT Night Queue Run Sts
     I                                       21  21 P3WUST
      * N :  PRT Night Queue
     I                                       22  31 P3BVVN
      * B :  Company Number Pass   USR
     I                                    P  32  395P3AJAA
      * N :  Customer Number Pass  USR
     I                                    P  40  475P3AJNC
      * B :  Date 1          PASS  USR
     I                                    P  48  555P3AJAB
      * B :  Date 2          PASS  USR
     I                                    P  56  635P3AJAC
      * B :  From Date Pass        USR
     I                                    P  64  715P3AJAD
      * N :  Thru Date Pass        USR
     I                                    P  72  795P3AJAG
      * N :  System Value Numeric
     I                                    P  80  875P3M8NB
      * N :  Warehouse Code PASS   USR
     I                                       88  90 P3T3CD
      * N :  Ship to Customer Pass USR
     I                                    P  91  985P3SHTC
      * I :  Use PO Price
     I                                       99  99 P3CESC
      * N :  Quantity Ordered Tot USR
     I                                    P 100 1052P3JXQT
      * N :  Weight Ordered Tot Usr
     I                                    P 106 1112P3PFWG
     IP4PARM      DS
      * FLD: Company Control
      * B :  Next Order Number
     I                                    P   1   40P4C5NB
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Enterprise Code 1
     I                                        1   4 P5DQCD
      * N :  Enterprise Code 2
     I                                        5  16 P5DRCD
      * N :  Salesperson Code
     I                                       17  19 P5BCCD
      * N :  System Date Format
     I                                       20  22 P5B8NA
      * N :  User Profile Name
     I                                       23  32 P5AJVN
      * N :  Allow Multi_Company
     I                                       33  33 P5I6ST
      * N :  Default Printer
     I                                       34  43 P5MPNA
      * N :  First Time Flag
     I                                       44  44 P5TAST
      * N :  Company Organization
     I                                       45  45 P5YJSX
     IP6PARM      DS
      * FLD: Order Header TRG
      * N :  Company Number
     I                                    P   1   20P6AIC3
      * N :  Order Type_Sales
     I                                        3   4 P6JNCD
      * N :  AR Customer Number
     I                                    P   5   80P6ANC7
      * N :  Ship To Customer
     I                                    P   9  120P6BKC7
      * N :  Requested Ship Date
     I                                    P  13  160P6A5DT
      * N :  Scheduled Ship Date
     I                                    P  17  200P6AODT
      * N :  Requested Delivery Date
     I                                    P  21  240P6EIDT
      * N :  Requested Delivery Time
     I                                    P  25  270P6AFTM
      * N :  Shipping Method
     I                                       28  29 P6Q2CD
      * N :  Reefer Temperature
     I                                    P  30  322P6RNNB
      * N :  Load Type
     I                                       33  33 P6VDST
      * N :  Shipping Temp Code C_F
     I                                       34  34 P6FRSX
     IP7PARM      DS
      * FLD: Order Detail
      * N :  Warehouse Code
     I                                        1   3 P7AJCD
      * N :  Market Pricing Date
     I                                    P   4   70P7EXDT
      * N :  Date Method Code
     I                                        8  10 P7RDCD
      * N :  Price Method Code
     I                                       11  13 P7Q7CD
      * N :  OD Production Plan Sts
     I                                       14  14 P7R1ST
      * N :  Palletize
     I                                       15  15 P7VEST
      * N :  Slip Sheet
     I                                       16  16 P7VGST
      * N :  Quantity Ordered
     I                                    P  17  222P7AVQT
      * N :  OD Pallet Type
     I                                       23  24 P7F5SX
      * N :  OD Price Type
     I                                       25  27 P7F7SX
      * N :  Item Age Days
     I                                    P  28  300P7RINY
     IP8PARM      DS
      * FLD: Order Header Extension
      * N :  OHE Spot Buy
     I                                        1   4 P8C3TX
      * N :  OHE Intended for ExportCC
     I                                        5  10 P8LWAA
     IP9PARM      DS
      * FLD: Company Customer
      * N :  Terms Code
     I                                        1   2 P9AQCD
      * N :  Sales Route Code
     I                                        3   5 P9R4CD
      * N :  P_O Required Flag
     I                                        6   6 P9PPST
      * N :  Type Code
     I                                        7   8 P9BOCD
      * N :  Absorbed Freight Rate CWT
     I                                    P   9  112P9TBNB
      * N :  Outside Warehouse Flag
     I                                       12  12 P9X9ST
      * N :  Commodity Market Code
     I                                       13  15 P9LQCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Date must be entered'
      * Message data for 'Req Deliv before ship dat'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Ship to Customer Flag 'N''
      * Ship To Customer
     I                                        1   7 ZA0002
      * Message data for 'Company must be entered'
      * USR Company Number
     I                                        1   3 ZA0003
      * Message data for 'Company Customer       NF'
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0004
      * Message data for 'Date must be entered'
      * Message data for 'Spot Buy S/T/P Required'
      * Spot Buy  (Y/N)
     I                                        1   1 ZA0005
      * Message data for 'Shipping temp req'
      * Shipping Temp Code C_F
     I                                        1   1 ZA0006
      * Message data for 'Temperature must be <100'
      * Reefer Temperature
     I                                    P   1   32ZA0007
      * Message data for 'Time Field GT 24 Hours'
      * Requested Delivery Time
     I                                    P   1   30ZA0008
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0009
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0010
      * Warehouse Code
     I                                       11  13 ZA0011
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0012
      * Message data for 'Load Type Must be Entered'
      * Load Type
     I                                        1   1 ZA0013
      * Message data for 'company number is requird'
      * Company Number CDE
     I                                    P   1   20ZA0014
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0015
      * Message data for 'Salesperson Required'
      * Salesperson Code
     I                                        1   3 ZA0016
      * Message data for 'Warehouse Invalid for Co'
      * Warehouse Code
     I                                        1   3 ZA0017
      * Company Number
     I                                        4   6 ZA0018
      * Message data for 'Salesperson            NF'
      * Message data for 'Price Method invalid'
      * Price Method Code
     I                                        1   3 ZA0019
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0020
      * Message data for 'Item not found'
      * Message data for 'Item Invalid-sold 100%FZ2'
      * Item Code
     I                                        1   7 ZA0021
      * Message data for 'Item Invalid-sold fresh 2'
      * Item Code
     I                                        1   7 ZA0022
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0023
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0024
      * Message data for 'PAL-Pallet Type not found'
      * PM Pallet Type
     I                                        1   2 ZA0025
      * Message data for 'Generic Message 80 ERR'
      * Generic Message 80 USR
     I                                        1  80 ZA0026
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0027
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0028
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0029
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0030
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0031
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0032
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0033
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0034
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0035
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0036
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0037
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0038
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0039
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TSCN    PARM           WP0001  90       ST02-TRANS SET
     C           P2PONO    PARM           WP0002 22        G5003-PURCHASE
     C           P2J5NX    PARM           WP0003  6        EDI Trading Par
     C           P3AJAA    PARM P3AJAA    WP0004 155       Company Number
     C           P3AJAB    PARM P3AJAB    WP0005 155       Date 1
     C           P3AJAC    PARM P3AJAC    WP0006 155       Date 2
     C           P3AJAD    PARM P3AJAD    WP0007 155       From Date Pass
     C           P3CESC    PARM           WP0008  1        Use PO Price
     C           P4C5NB    PARM P4C5NB    WP0009  70       Next Order Numb
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time
      * CASE: PAR.First Time Flag is Yes
     C           P5TAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P5TAST           First Time Flag
      * 01/06/21 DN S17031-Added Delivery PO Number Field on Screen.
      * 02/23/21 DN R17040-Added Customer Ref ID Qualifier & Customer Ref
      * Rtv All Hdr by Control RT - EDI Purchase Order Header  * 
     C                     EXSR SARVGN
      * Fill in reason description if there is a reason code
      * CASE: CTL.Don't Create Order Reason NE WRK.Blank for 3          U
     C           #CNLST    IFNE WUUAT1                     *IF
      * CTL.USR Description 22 = Condition name of CTL.Don't Create Order
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2142871   Y2LSNO  70       List number
     C                     PARM #CNLST    W0INVL 25        Don't Create Or
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CESNA    PARM           W0CNNM 25        USR Description
      *
     C                     END                             *FI
     C                     Z-ADD#CEIDT    YL0009           Requested Deliv
      * * Get Duns Number for Ship To customer
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'ST'      WL0002    P      N101-NAME TYPE
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0010    P      N102-NAME
     C                     MOVELWL0004    YL0011    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0012    P      N104-ID CODE
     C                     MOVELWL0006    YN0032    P      N201-NAME
     C                     MOVELWL0007    YN0033    P      N202-NAME
     C                     MOVELWL0008    #CDD1X    P      N301-ADD
     C                     MOVELWL0009    YN0034    P      N302-ADDRESS
     C                     MOVELWL0010    #CITYX    P      N401-CITY
     C                     MOVELWL0011    #CTATE    P      N402-STATE
     C                     MOVELWL0012    YN0035    P      N403-POSTAL COD
      * CASE: LCL.EDI Shipto Duns Number is Not Found
     C           YL0012    IFEQ *BLANK                     *IF
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'BS'      WL0002    P      N101-NAME TYPE
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0010    P      N102-NAME
     C                     MOVELWL0004    YL0011    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0012    P      N104-ID CODE
     C                     MOVELWL0006    YN0032    P      N201-NAME
     C                     MOVELWL0007    YN0033    P      N202-NAME
     C                     MOVELWL0008    #CDD1X    P      N301-ADD
     C                     MOVELWL0009    YN0034    P      N302-ADDRESS
     C                     MOVELWL0010    #CITYX    P      N401-CITY
     C                     MOVELWL0011    #CTATE    P      N402-STATE
     C                     MOVELWL0012    YN0035    P      N403-POSTAL COD
     C                     END                             *FI
      * CASE: LCL.EDI Shipto Duns Number is Not Found
     C           YL0012    IFEQ *BLANK                     *IF
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'BY'      WL0002    P      N101-NAME TYPE
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0010    P      N102-NAME
     C                     MOVELWL0004    YL0011    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0012    P      N104-ID CODE
     C                     MOVELWL0006    YN0032    P      N201-NAME
     C                     MOVELWL0007    YN0033    P      N202-NAME
     C                     MOVELWL0008    #CDD1X    P      N301-ADD
     C                     MOVELWL0009    YN0034    P      N302-ADDRESS
     C                     MOVELWL0010    #CITYX    P      N401-CITY
     C                     MOVELWL0011    #CTATE    P      N402-STATE
     C                     MOVELWL0012    YN0035    P      N403-POSTAL COD
     C                     END                             *FI
      * * Get Ship To customer for Duns Number
      * 11/14/19 DN S15503-Changed to Check for Active Customer.
      * 02/22/21 DN R17040-Changed to Check that EDI Trading Partner # ma
      *    Changed EDI Trading Partner No. Parm from output to input.
      * Rtv EDI ST by EDI Duns RT - Customer EXT  * 
     C                     EXSR SCRVGN
     C                     Z-ADD*ZERO     #CATNB           Company Number
     C                     MOVEL'OR'      #CJNCD           Order Type_Sale
     C                     MOVEL'R'       #CVDST           Load Type
      * * Default Spot Buy to N, *No for now
      * 06/11/21 DN W77844-Convert 'N' to 'T'urn.
     C                     MOVEL'T'       #CSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
     C                     MOVEL'T'       YL0016           OHE Spot Buy
     C                     MOVEL'MAN'     #CQ7CD           Price Method Co
     C                     MOVEL*BLANK    #CRDCD           Date Method Cod
     C                     MOVEL'NEG'     #CF7SX           OD Price Type
      * RTV All fields         RT - Customer  * 
     C                     EXSR SFRVGN
      * CASE: CTL.Ship To Address Line 2 is Blank
     C           #CHONA    IFEQ *BLANK                     *IF
     C                     MOVELYL0018    #CHONA           Ship To Address
     C                     END                             *FI
      * RTV Bill To Cust Name  RT - Customer  * 
     C                     EXSR SGRVGN
      * RMC dont default ship to per Alicia  10.23.17
      * 09/20/19 DN S15503-Commented Out. Added Logic When to Default STC
      * 09/20/19 DN S15503-Don't Default STC# if Multiple STC# Exist w/Sa
      * CASE: *OTHERWISE
      * Val Diff STC w/Sme DunsRT - Customer  * 
     C                     EXSR SHRVGN
      * CASE: LCL.Diff STC# w/Sme Duns Exst is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #CAJNB           Customer Number
     C                     END                             *FI
      * Populate Screen Control Fields if Ship To Customer # is Present.
      * CASE: CTL.Customer Number       NBR is not equal 0
     C           #CAJNB    IFNE *ZERO                      *IF
     C                     MOVELYL0017    #CBRTX           Ship To Name
     C                     MOVELYL0019    #CHONA           Ship To Address
     C                     MOVELYL0020    #CHNNA           Ship To City
      * Rtv Dflt Whse/Cmp/Sls RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0013           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    #CATNB           Company Number
     C                     MOVELWL0015    #CBCCD    P      Sales Route Cod
     C                     MOVELWL0016    #CAJCD    P      Warehouse Code
     C                     END                             *FI
      * 11/19/21 DN W84569-Get Customer EXT2 Info.
      * Rtv Customer More Info RT - Customer EXT2  * 
     C                     EXSR SKRVGN
     C                     MOVEL#CQRU1    #CF5SX           OD Pallet Type
      * 11/18/21 DN W84569-Override OD Price Type if Entered from Custome
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Cust Dft Price Type is *NONE
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0025    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0025    #CF7SX           OD Price Type
     C                     END                             *FI
      * RTV Deliv. Times       RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CATNB    WL0017           Company Number
     C                     Z-ADD#CAJNB    WL0018           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    P9R4CD    P      Sales Route Cod
     C                     Z-ADDWL0020    YL0026           Deliver after t
     C                     Z-ADDWL0021    YL0027           Deliver before
     C                     Z-ADDWL0022    YL0028           Mileage To Cust
      * Rtv Age Information   XF - Company Customer EXT  * 
     C                     CALL 'PNQCXFR'              90  Rtv Age Informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0001  30       Company Number
     C                     PARM #CAJNB    WQ0002  70       Ship To Custome
     C           YL0029    PARM *ZERO     WQ0003  40       Item Age Days F
     C           YL0030    PARM *ZERO     WQ0004  40       Item Age Days F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
     C                     Z-ADD0800      #CAFTM           Requested Deliv
      * 04/01/20 DN S16395-Override Requested Delivery Time If Exist.
      * CASE: *OTHERWISE
      * 11/18/21 DN W84569-Comment Out/Move Below. Cust Delv Time takes p
      * 11/18/21 DN W84569-Use Req Delvy Time f/ Cust EXT2 if Exist Else
      * CASE: LCL.Deliver after time is Entered
     C           YL0026    IFNE *ZERO                      *IF
     C                     Z-ADDYL0026    #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Rqstd Delv Tme Dft RT - Trade Partner Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CJ5NX    WL0023    P      EDI Trading Par
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    YL0031    P      Requested Delv
      * If Not Blank, Convert to Numeric Time.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Requested Delv Time Dflt is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0031    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Cvt Rqstd Delv Tme Dft IF
      * Convert Time to Numeric.
      * CASE: PAR.Requested Delv Time Dflt is Midnight
     C           YL0031    IFEQ '0'                        *IF
     C                     Z-ADD0001      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 1 AM
     C           YL0031    IFEQ '1'                        *IF
     C                     Z-ADD0100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 2 AM
     C           YL0031    IFEQ '2'                        *IF
     C                     Z-ADD0200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 3 AM
     C           YL0031    IFEQ '3'                        *IF
     C                     Z-ADD0300      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 4 AM
     C           YL0031    IFEQ '4'                        *IF
     C                     Z-ADD0400      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 5 AM
     C           YL0031    IFEQ '5'                        *IF
     C                     Z-ADD0500      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 6 AM
     C           YL0031    IFEQ '6'                        *IF
     C                     Z-ADD0600      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 7 AM
     C           YL0031    IFEQ '7'                        *IF
     C                     Z-ADD0700      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 8 AM
     C           YL0031    IFEQ '8'                        *IF
     C                     Z-ADD0800      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 9 AM
     C           YL0031    IFEQ '9'                        *IF
     C                     Z-ADD0900      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 10 AM
     C           YL0031    IFEQ '10'                       *IF
     C                     Z-ADD1000      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 11 AM
     C           YL0031    IFEQ '11'                       *IF
     C                     Z-ADD1100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 12 PM
     C           YL0031    IFEQ '12'                       *IF
     C                     Z-ADD1200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 1 PM
     C           YL0031    IFEQ '13'                       *IF
     C                     Z-ADD1300      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 2 PM
     C           YL0031    IFEQ '14'                       *IF
     C                     Z-ADD1400      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 3 PM
     C           YL0031    IFEQ '15'                       *IF
     C                     Z-ADD1500      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 4 PM
     C           YL0031    IFEQ '16'                       *IF
     C                     Z-ADD1600      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 5 PM
     C           YL0031    IFEQ '17'                       *IF
     C                     Z-ADD1700      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 6 PM
     C           YL0031    IFEQ '18'                       *IF
     C                     Z-ADD1800      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 7 PM
     C           YL0031    IFEQ '19'                       *IF
     C                     Z-ADD1900      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 8 PM
     C           YL0031    IFEQ '20'                       *IF
     C                     Z-ADD2000      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 9 PM
     C           YL0031    IFEQ '21'                       *IF
     C                     Z-ADD2100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 10 PM
     C           YL0031    IFEQ '22'                       *IF
     C                     Z-ADD2200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 11 PM
     C           YL0031    IFEQ '23'                       *IF
     C                     Z-ADD2300      #CAFTM           Requested Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Retrieve EDI Bill To information
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0001           ST02-TRANS SET
     C                     MOVEL'BT'      WL0002    P      N101-NAME TYPE
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0010    P      N102-NAME
     C                     MOVELWL0004    YN0081    P      N103-ID CODE QU
     C                     MOVELWL0005    YL0032    P      N104-ID CODE
     C                     MOVELWL0006    YN0032    P      N201-NAME
     C                     MOVELWL0007    YN0033    P      N202-NAME
     C                     MOVELWL0008    YN0082    P      N301-ADD
     C                     MOVELWL0009    YN0034    P      N302-ADDRESS
     C                     MOVELWL0010    YN0083    P      N401-CITY
     C                     MOVELWL0011    YN0084    P      N402-STATE
     C                     MOVELWL0012    YN0035    P      N403-POSTAL COD
      * 01/02/20 DN S15952-Replaced Logic to Populate Shipping Method.
      * Shipping Method
      * CASE: LCL.G6602-METHOD TYPE CODE is Customer Pickup
     C           YL0006    IFEQ 'H'                        *IF
     C                     MOVEL'CT'      #CQ2CD           Shipping Method
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'PT'      #CQ2CD           Shipping Method
     C                     END                             *FI
      * Default Requested Delivery Time if it is zeros
      * CASE: CTL.Requested Delivery Time is Zero
     C           #CAFTM    IFEQ *ZERO                      *IF
     C                     Z-ADD0800      #CAFTM           Requested Deliv
     C                     END                             *FI
      * If company is not zeros
      * CASE: CTL.Company Number CDE is not equal to zero
     C           #CATNB    IFNE *ZERO                      *IF
      * RTV Company Name       XF - Company Name and Address  * 
     C                     CALL 'PNH7XFR'              90  RTV Company Nam
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0005  30       Company Number
     C           #CAGTX    PARM *BLANK    WQ0006 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNH7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0007  30       Company Number
     C                     PARM *BLANK    WQ0008  2        Shipping Method
     C           #CVDST    PARM *BLANK    WQ0009  1        Load Type Dft
     C                     PARM *BLANK    WQ0010  1        LTL Flag Dft
     C                     PARM *BLANK    WQ0011  1        Export Status D
     C                     PARM *BLANK    WQ0012  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0013  40       Departure Time
     C                     PARM *BLANK    WQ0014  6        Export Code Dft
     C           YL0033    PARM *BLANK    WQ0015  1        Allow Mult Whse
     C                     PARM *BLANK    WQ0016  1        Allow Multi Exp
     C                     PARM *BLANK    WQ0017  1        Slip Sheet Dft
     C                     PARM *BLANK    WQ0018  1        Palletize Dft
     C           P5YJSX    PARM *BLANK    WQ0019  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * RTV Dflt Type for Co  XF - User Entry Control  * 
     C                     CALL 'POGOXFR'              90  RTV Dflt Type f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0020 10        User Profile Na
     C                     PARM 'O/P'     WQ0021  6        Application Cod
     C                     PARM #CATNB    WQ0022  30       Company Number
     C           #CJNCD    PARM *BLANK    WQ0023  2        Order Type_Sale
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POGOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0024  30       Company Number
     C                     PARM @CN,001   WQ0025 10        Company Value C
     C           YL0034    PARM *BLANK    WQ0026 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * * Default ctl.Sales Channel for Seaboard only, if blank
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Company Organization is Seaboard
      *   |- c2    : CTL.Type Code is EQ Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5YJSX    IFEQ 'S'                        *IF
     C           #CBOCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Dft Sales Channel  XF - Salesperson Electronic CM  * 
     C                     CALL 'PBHPXFR'              90  Rtv Dft Sales C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CBCCD    WQ0027  3        Salesperson Cod
     C           YL0035    PARM *BLANK    WQ0028  2        SEC Default Sal
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBHPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     MOVELYL0035    #CBOCD           Type Code
     C                     END                             *FI
      * Get Warehouse type
      * CASE: CTL.Warehouse Code NE WRK.BLANK
     C           #CAJCD    IFNE WUGSTX                     *IF
      * RTV WhsTyp/Ctrl/LdTyp XF - Warehouse  * 
     C                     CALL 'PNMRXFR'              90  RTV WhsTyp/Ctrl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CAJCD    WQ0029  3        Warehouse Code
     C           WUWPST    PARM *BLANK    WQ0030  2        Warehouse Type
     C           YL0036    PARM *BLANK    WQ0031  1        Trans Contol AS
     C                     PARM *BLANK    WQ0032  2        WHS Default Loa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
      * display inter-co or third party message
      * CASE: CTL.Type Code is Inter Company
     C           #CBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,002   #CRHNA           Customer Type D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,003   #CRHNA           Customer Type D
     C                     END                             *FI
      * 10/18/21 DN W84569-Populate Shipping Temperature.
      * CASE: CTL.Warehouse Code is Not Blanks
     C           #CAJCD    IFNE *BLANK                     *IF
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                     CALL 'PDSSXFR'              90  RTV Shipping Te
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUWPST    WQ0033  2        Warehouse Type
     C           #CRNNB    PARM *ZERO     WQ0034  52       Reefer Temperat
     C           #CFRSX    PARM *BLANK    WQ0035  1        Temperature Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993637*
     C                     END
      * Override with Customer Temperature if Entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Company Number CDE is not equal to zero
      *   |- c2    : CTL.Customer Number       NBR is not equal 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CATNB    IFNE *ZERO                      *IF
     C           #CAJNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Cust Shipping Tmp XF - Company Customer EXT  * 
     C                     CALL 'POPRXFR'              90  Rtv Cust Shippi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0036  30       Company Number
     C                     PARM #CAJNB    WQ0037  70       Ship To Custome
     C           YL0037    PARM *ZERO     WQ0038  52       Cust Shipping T
     C           YL0038    PARM *BLANK    WQ0039  1        Cust Shipping T
     C                     PARM *BLANK    WQ0040  3        Ship To Warehou
     C           YL0029    PARM *ZERO     WQ0041  40       Item Age Days F
     C           YL0030    PARM *ZERO     WQ0042  40       Item Age Days F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
      * Cust Shipping Temp
      * CASE: LCL.Cust Shipping Temp is Entered
     C           YL0037    IFNE *ZERO                      *IF
     C                     Z-ADDYL0037    #CRNNB           Reefer Temperat
     C                     MOVELYL0038    #CFRSX           Shipping Temp C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#CAJCD    YL0039           Warehouse Code
     C                     END                             *FI
      * *Set Cursor: CTL.Customer Number       NBR  (*Override=*NO)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD009       W0ROW0
     C                     Z-ADD025       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
      * 07/08/25 JM S031833-get Order Header Extension
      * CASE: CTL.OH Order Number is Not Zeros
     C           #CBXU1    IFNE @CN,004                    *IF
     C                     Z-ADD7         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00030
     C           ZQ        ORGT 00030
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST#CBXU1:ZQ YL0040    P  90  Order Number Al
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0040    YL0041           Order Number
      * RTV OHE for Ord Entry XF - Order Header Extension  * 
     C                     CALL 'PMDBXFR'              90  RTV OHE for Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0043  30       Company Number
     C                     PARM YL0041    WQ0044  70       Order Number
     C                     PARM *ZERO     WQ0045 112       OHE HPB RIN Equ
     C                     PARM *ZERO     WQ0046 112       OHE HPB RIN Pri
     C           #CC3TX    PARM *BLANK    WQ0047  4        OHE Spot Buy
     C                     PARM *BLANK    WQ0048  2        OHE Override Ty
     C           YL0042    PARM YL0042    WQ0049 38        Delivery P_O  N
     C                     PARM *BLANK    WQ0050  6        OHE Intended fo
     C                     PARM *BLANK    WQ0051 10        OHE Appt Confir
     C                     PARM *BLANK    WQ0052 30        OHE Appt Confir
     C                     PARM *BLANK    WQ0053 50        Letter of Credi
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * 07/08/25 JM S031833-Add spot/turn/promo on screen.
      * CASE: CTL.OHE Spot Buy is Spot
     C           #CC3TX    IFEQ 'S'                        *IF
     C                     MOVEL'S'       #CSPOT           Spot Buy  (Y/N)
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: CTL.OHE Spot Buy is Turn
     C           #CC3TX    IFEQ 'T'                        *IF
     C                     MOVEL'T'       #CSPOT           Spot Buy  (Y/N)
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: CTL.OHE Spot Buy is Promo
     C           #CC3TX    IFEQ 'P'                        *IF
     C                     MOVEL'P'       #CSPOT           Spot Buy  (Y/N)
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Company Organization is Seaboard
     C           P5YJSX    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'T'       #CSPOT           Spot Buy  (Y/N)
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BRTSCN           ST02-TRANS SET
     C                     KFLD           BRSEQX           ITEM SEQUENCE N
      * Setup key
     C                     Z-ADD#2TSCN    BRTSCN
     C                     Z-ADD#2SEQX    BRSEQX
     C           KPOS      SETLL@P005LE
     C           KRST      KLIST
     C                     KFLD           BRTSCN           ST02-TRANS SET
      * Setup key
     C                     Z-ADD#2TSCN    BRTSCN
     C           KRST      READE@P005LE                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2SEQX    WZSEQX
     C                     MOVEL#2SEQX    WZSEQX           ITEM SEQUENCE N
     C           *LIKE     DEFN #2TSCN    WZTSCN
     C                     MOVEL#2TSCN    WZTSCN           ST02-TRANS SET
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@P005LE                  90*
     C  N82                READ @P005LE                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  3
     C                     MOVEAWKIND0    *IN,46
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * RCD = DB1 By name
     C                     MOVELBRNKST    #1NKST           POD Added to an
     C                     Z-ADDBRD5VL    #1D5VL           G6801-QUANTITY
     C                     MOVELBRPRQL    #1PRQL           G6805/P108 PROD
     C                     MOVELBRPRID    #1PRID           G6806/P109 PROD
     C                     MOVELBRUPCX    #1UPCX           G6804/P107 UPC/
     C                     MOVELBRDESC    #1DESC           G6901-ITEM DESC
     C                     Z-ADDBRTSCN    #1TSCN           ST02-TRANS SET
     C                     Z-ADDBRSEQX    #1SEQX           ITEM SEQUENCE N
     C                     MOVELBRLEST    #1LEST           POC02-Chg/Resp
     C                     Z-ADDBRPRCX    #1PRCX           G6803-ITEM LIST
     C                     MOVELBRUNIT    #1UNIT           G6802-BASIS FOR
     C                     Z-ADDBRS2NY    #1S2NY           POD Item Age Da
     C                     MOVELBRR2AA    #1R2AA           G6807/PO110 Pro
     C                     MOVELBRAOU1    #1AOU1           G6808/PO111 Pro
     C                     MOVELBRR4AA    #1R4AA           PO112 Prod ID Q
     C                     MOVELBRAQU1    #1AQU1           PO113 Prod ID
     C                     MOVELBRR3AA    #1R3AA           P106 UPC/GTIN Q
     C                     MOVELBRAPU1    #1APU1           POD Unused GTIN
     C                     MOVELBRYCT1    #1YCT1           POD unused text
     C                     Z-ADDBRUEDT    #1UEDT           POD unused date
     C                     MOVELBROIAA    #1OIAA           POD Basis Unit
     C                     Z-ADDBRMJVL    #1MJVL           POD SBD Item Nu
     C                     Z-ADDBRUINY    #1UINY           POD Pack Qty
     C                     MOVEL*BLANK    YL0043           USR Update Flag
     C                     MOVEL*BLANK    YL0044           Item Code Exist
     C                     MOVEL*BLANK    YL0045           CIR Resource No
      * G6805 check
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.G6805/P108 PROD ID QUAL is Vendor Product
      *   |- c2    : DB1.G6805/P108 PROD ID QUAL is Vendor Product 2
      *   |- c3    : DB1.G6805/P108 PROD ID QUAL is Manufacturer Part Num
      *   '-
     C           BRPRQL    IFEQ 'VP'                       *IF
     C           BRPRQL    OREQ 'VN'                       *OR
     C           BRPRQL    OREQ 'MG'                       *OR
     C                     MOVEL#1PRID    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0046           USR Item Code 7
     C                     Z-ADDYL0046    YL0047           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0025           Ship To Custome
     C                     Z-ADDYL0047    WL0026           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    YL0045    P      CIR Resource No
      * CASE: LCL.CIR Resource No is Entered
     C           YL0045    IFNE *BLANK                     *IF
     C                     Z-ADDYL0047    #RICNM           Item Code Numbe
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0047           Item Code Numbe
     C                     END                             *FI
     C                     END                             *FI
      * G6807 check
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 1
      *   |- c2    : DB1.G6807/PO110 Prod ID Qual is Vendor Product 2
      *   |- c3    : DB1.G6807/PO110 Prod ID Qual is Manufacturer Part Nu
      *   '-
     C           BRR2AA    IFEQ 'VP'                       *IF
     C           BRR2AA    OREQ 'VN'                       *OR
     C           BRR2AA    OREQ 'MG'                       *OR
     C                     MOVELBRAOU1    WUY8TX           Text USR 7
      * RTV Right Just  7 Alph US - /UT User Source  * 
     C                     MOVEAWUY8TX    A1
     C                     MOVEA*BLANKS   A2
     C                     MOVE 07        C1      20
     C                     MOVE 07        C2      20
     C           C1        DOWGT0
     C           A1,C1     IFNE ' '
     C                     MOVE A1,C1     A2,C2
     C           C2        SUB  1         C2
     C                     END
     C           C1        SUB  1         C1
     C                     END
     C                     MOVEAA2        WUZ3TX
     C                     MOVE WUZ3TX    YL0046           USR Item Code 7
     C                     Z-ADDYL0046    YL0047           Item Code Numbe
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0025           Ship To Custome
     C                     Z-ADDYL0047    WL0026           Item Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    YL0045    P      CIR Resource No
      * CASE: LCL.CIR Resource No is Entered
     C           YL0045    IFNE *BLANK                     *IF
     C                     Z-ADDYL0047    #RICNM           Item Code Numbe
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0047           Item Code Numbe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * GTIN = UK check
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
      * CASE: DB1.P106 UPC/GTIN QUAL is GTIN/UPC Code
     C           BRR3AA    IFEQ 'UK'                       *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0028           Ship To Custome
     C                     MOVELBRUPCX    WL0030    P      CIR Resource No
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0047           Item Code
     C                     MOVELWL0031    YN0102    P      CIR UM Base Pri
      * CASE: LCL.Item Code Number 7.0  USR is Entered
     C           YL0047    IFNE *ZERO                      *IF
     C                     Z-ADDYL0047    #RICNM           Item Code Numbe
     C                     MOVELBRUPCX    YL0045           CIR Resource No
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Catchall
      * CASE: LCL.CIR Resource No is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     YL0048           Item Code
      * CASE: DB1.G6806/P109 PRODUCT ID is Not Blank
     C           BRPRID    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0028           Ship To Custome
     C                     MOVELBRPRID    WL0030    P      CIR Resource No
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0048           Item Code
     C                     MOVELWL0031    YN0102    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0048    IFNE *ZERO                      *IF
     C                     Z-ADDYL0048    #RICNM           Item Code Numbe
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Item Code is Not Entered
     C           YL0048    IFEQ *ZERO                      *IF
      * CASE: DB1.G6808/PO111 Prod ID is Entered
     C           BRAOU1    IFNE *BLANK                     *IF
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0028           Ship To Custome
     C                     MOVELBRAOU1    WL0030    P      CIR Resource No
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0048           Item Code
     C                     MOVELWL0031    YN0102    P      CIR UM Base Pri
      * CASE: LCL.Item Code is Entered
     C           YL0048    IFNE *ZERO                      *IF
     C                     Z-ADDYL0048    #RICNM           Item Code Numbe
     C                     MOVELBRAOU1    YL0045           CIR Resource No
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If no product id then zero out SBD item number
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Item Code Number 7.0  USR is Not Entered
      *   |- c2    : LCL.Item Code Exist USR is No
      *   '-
     C           #RICNM    IFEQ *ZERO                      *IF
     C           YL0044    OREQ 'N'                        *OR
     C                     Z-ADD*ZERO     #RICNM           Item Code Numbe
     C                     END                             *FI
      * 10/25/17 DN E011229-Overlay SBD Item# if Entered or Update it in
      * CASE: RCD.POD SBD Item Number is Entered
     C           #1MJVL    IFNE 0                          *IF
     C                     Z-ADD#1MJVL    #RICNM           Item Code Numbe
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PO Dtl SBD Item #  CH - EDI Purchase Order Detail  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CAJCD    WL0032    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUWPST    P      Warehouse Type
      * 11/19/21 DN W84569-Populate Item Age Days.
      * CASE: DB1.POD Item Age Days is Entered
     C           BRS2NY    IFNE *ZERO                      *IF
     C                     Z-ADDBRS2NY    #RCQNZ           POD Item Age Da
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.POD Item Age Days is Entered
      *   |- c2    : CTL.Warehouse Code EQ LCL.Warehouse Code SavUsr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1S2NY    IFNE *ZERO                      *IF
     C           #CAJCD    IFEQ YL0039                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Use item age days fresh
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Warehouse Type is Fresh
      *   |- c2    : LCL.Item Age Days Fresh is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPST    IFEQ 'FR'                       *IF
     C           YL0029    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0029    #RCQNZ           POD Item Age Da
     C                     END                             *FI
      * Use item age days frozen
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Warehouse Type is Frozen
      *   |- c2    : LCL.Item Age Days Frozen is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPST    IFEQ 'FZ'                       *IF
     C           YL0030    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0030    #RCQNZ           POD Item Age Da
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#CAJCD    YL0039           Warehouse Code
     C                     Z-ADDBRD5VL    P7AVQT           Quantity Ordere
     C                     Z-ADDBRSEQX    #1SEQX           ITEM SEQUENCE N
      * Seq #
      * CASE: RCD.ITEM SEQUENCE NUMBER is Equal zeros
     C           #1SEQX    IFEQ *ZERO                      *IF
     C           WUDPNB    ADD  1         #1SEQX           ITEM SEQUENCE N
     C                     Z-ADD#1SEQX    WUDPNB           Order Sequence
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0043           USR Update Flag
     C                     MOVEL'N'       YL0049           USR Display fie
     C                     MOVEL'N'       YL0050           USR Display 4
     C                     Z-ADD1         YL0051           Order Secondary
     C                     MOVEL#CNLST    YL0052           Don't Create Or
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@P005LE                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CQ2CD'  IFEQ YPMTFD
      * Shipping Method
     C                     MOVEL#CQ2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZFQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZFQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZFQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZFQ2CD
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD5         ZFQ2CD
     C                     ENDSL
     C                     EXFMTZEQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZFQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZFQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZFQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C           ZFQ2CD    WHEQ 5
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CQ2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Shipping Temp Code C_F
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CFRSX'  IFEQ YPMTFD
      * Shipping Temp Code C_F
     C                     MOVEL#CFRSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFFRSX
     C                     SELEC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD1         ZFFRSX
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZFFRSX
     C                     ENDSL
     C                     EXFMTZEFRSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFFRSX    WHEQ 1
     C                     MOVEL'C'       W0INVL           C
     C           ZFFRSX    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CFRSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Requested Ship Date
      * External date
     C                     Z-ADDVCA5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     Z-ADDXDINDT    #CA5DT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDVCEIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     Z-ADDXDINDT    #CEIDT
      * Validate Spot Buy  (Y/N)
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CSPOT    W0NSRQ  1        Spot Buy  (Y/N)
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CSPOT'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2197331   Y2LSNO  70
     C           #CSPOT    PARM #CSPOT    W0EXVL 25        Spot Buy  (Y/N)
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate OD Price Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CF7SX'  IFEQ YPMTFD
      * OD Price Type
     C                     MOVEL#CF7SX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFF7SX
     C                     SELEC
     C           W0INVL    WHEQ 'CON'                      CON
     C                     Z-ADD1         ZFF7SX
     C           W0INVL    WHEQ 'FRM'                      FRM
     C                     Z-ADD2         ZFF7SX
     C           W0INVL    WHEQ 'NEG'                      NEG
     C                     Z-ADD3         ZFF7SX
     C           W0INVL    WHEQ 'HDG'                      HDG
     C                     Z-ADD4         ZFF7SX
     C           W0INVL    WHEQ 'DST'                      DST
     C                     Z-ADD5         ZFF7SX
     C           W0INVL    WHEQ 'NHT'                      NHT
     C                     Z-ADD6         ZFF7SX
     C           W0INVL    WHEQ 'TNK'                      TNK
     C                     Z-ADD7         ZFF7SX
     C           W0INVL    WHEQ 'FLR'                      FLR
     C                     Z-ADD8         ZFF7SX
     C                     ENDSL
     C                     EXFMTZEF7SX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFF7SX    WHEQ 1
     C                     MOVEL'CON'     W0INVL           CON
     C           ZFF7SX    WHEQ 2
     C                     MOVEL'FRM'     W0INVL           FRM
     C           ZFF7SX    WHEQ 3
     C                     MOVEL'NEG'     W0INVL           NEG
     C           ZFF7SX    WHEQ 4
     C                     MOVEL'HDG'     W0INVL           HDG
     C           ZFF7SX    WHEQ 5
     C                     MOVEL'DST'     W0INVL           DST
     C           ZFF7SX    WHEQ 6
     C                     MOVEL'NHT'     W0INVL           NHT
     C           ZFF7SX    WHEQ 7
     C                     MOVEL'TNK'     W0INVL           TNK
     C           ZFF7SX    WHEQ 8
     C                     MOVEL'FLR'     W0INVL           FLR
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CF7SX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Don't Create Order Reason
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CNLST'  IFEQ YPMTFD
      * Don't Create Order Reason
     C                     MOVEL#CNLST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFNLST
     C                     SELEC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD1         ZFNLST
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD2         ZFNLST
     C           W0INVL    WHEQ 'V'                        V
     C                     Z-ADD3         ZFNLST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD4         ZFNLST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD5         ZFNLST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD6         ZFNLST
     C                     ENDSL
     C                     EXFMTZENLST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFNLST    WHEQ 1
     C                     MOVEL'C'       W0INVL           C
     C           ZFNLST    WHEQ 2
     C                     MOVEL'D'       W0INVL           D
     C           ZFNLST    WHEQ 3
     C                     MOVEL'V'       W0INVL           V
     C           ZFNLST    WHEQ 4
     C                     MOVEL'P'       W0INVL           P
     C           ZFNLST    WHEQ 5
     C                     MOVEL'R'       W0INVL           R
     C           ZFNLST    WHEQ 6
     C                     MOVEL'A'       W0INVL           A
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CNLST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * Prompt Control fields
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Company Number CDE
     C           W0CFL     IFEQ '#CATNB'                   *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #CATNB    PARM #CATNB    WQ0054  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Customer Number       NBR
     C           W0CFL     IFEQ '#CAJNB'                   *IF
      * CASE: CTL.A/R Customer is not equal to zero
     C           #CDUC7    IFNE *ZERO                      *IF
      * SEL Ship To by Bill To SR - Customer  * 
     C                     CALL 'PUEDSRR'              90  SEL Ship To by
     C                     PARM *BLANK    W0RTN   7
     C           #CAJNB    PARM #CAJNB    WQ0055  70       Ship To Custome
     C           #CDUC7    PARM #CDUC7    WQ0056  70       AR Customer Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * 11/08/17 DN E011229-Populate Co/Whs/Slsprsn.
      * CASE: CTL.Customer Number       NBR is not equal 0
     C           #CAJNB    IFNE *ZERO                      *IF
      * Rtv Dflt Whse/Cmp/Sls RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0013           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    #CATNB           Company Number
     C                     MOVELWL0015    #CBCCD    P      Sales Route Cod
     C                     MOVELWL0016    #CAJCD    P      Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Order Type - Sales
     C           W0CFL     IFEQ '#CJNCD'                   *IF
      * SEL Invoice Types      SR - Order Types  * 
     C                     CALL 'PDGVSRR'              90  SEL Invoice Typ
     C                     PARM *BLANK    W0RTN   7
     C           #CJNCD    PARM #CJNCD    WQ0057  2        Order Type_Sale
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse Code
     C           W0CFL     IFEQ '#CAJCD'                   *IF
      * Sel Warehouse
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0053    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0058 10        User Profile Na
     C                     PARM 'O/P'     WQ0059  6        Application Cod
     C           #CAJCD    PARM #CAJCD    WQ0060  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CAJCD    PARM #CAJCD    WQ0061  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Salesperson Code
     C           W0CFL     IFEQ '#CBCCD'                   *IF
      * SEL Active Salesperson SR - Salesperson  * 
     C                     CALL 'CABYSRR'              90  SEL Active Sale
     C                     PARM *BLANK    W0RTN   7
     C           #CBCCD    PARM #CBCCD    WQ0062  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Price Method Code
     C           W0CFL     IFEQ '#CQ7CD'                   *IF
      * SEL OMS System Only    SR - Price Method Header  * 
     C                     CALL 'PDZSSRR'              90  SEL OMS System
     C                     PARM *BLANK    W0RTN   7
     C           #CATNB    PARM #CATNB    WQ0063  30       Company Number
     C           #CQ7CD    PARM #CQ7CD    WQ0064  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993243*
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Requested Delivery date is required
      * CASE: CTL.Requested Delivery Date is not entered
     C           #CEIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Date must be entered'
     C                     MOVEL'USR0231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Requested Ship Date GT CTL.Requested Delivery Date
     C           #CA5DT    IFGT #CEIDT                     *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Req Deliv before ship dat'
     C                     MOVEL'USR3980' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 11/09/17 DN E011229-Populate Co/Whs/Slsprsn if ShipToCust Manuall
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : CTL.Customer Number       NBR is not equal 0
      *   |- c2    : CTL.Company Number CDE is Equal to zero
      *   |- c3    : CTL.Warehouse Code is Blanks
      *   |- c4    : CTL.Salesperson Code is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CAJNB    IFNE *ZERO                      *IF
     C           #CATNB    IFEQ *ZERO                      *IF
     C           #CAJCD    IFEQ *BLANK                     *IF
     C           #CBCCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Dflt Whse/Cmp/Sls RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CAJNB    WL0013           Ship To Custome
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    #CATNB           Company Number
     C                     MOVELWL0015    #CBCCD    P      Sales Route Cod
     C                     MOVELWL0016    #CAJCD    P      Warehouse Code
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * CASE: CTL.Don't Create Order Reason NE LCL.Don't Create Order Rea
     C           #CNLST    IFNE YL0052                     *IF
      * CTL.USR Description 22 = Condition name of CTL.Don't Create Order
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2142871   Y2LSNO  70       List number
     C                     PARM #CNLST    W0INVL 25        Don't Create Or
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CESNA    PARM           W0CNNM 25        USR Description
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * F4=Prompt.                                  11/23/21 DN W84569
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Pallet Type.
      * CASE: PGM.*Cursor field <IS> CTL.Pallet Type NOREF
     C           W0CFL     IFEQ '#CQRU1'                   *IF
      * Sel Pallet Master     SR - Pallet Master  * 
     C                     CALL 'PUTOSRR'              90  Sel Pallet Mast
     C                     PARM *BLANK    W0RTN   7
     C           YL0054    PARM YL0054    WQ0065  2        PM Pallet Type
     C                     PARM 'N'       WQ0066  1        Rental_Y_N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Pallet Type NOREF is Entered
     C           YL0054    IFNE *BLANK                     *IF
     C                     MOVELYL0054    #CQRU1           Pallet Type NOR
     C                     MOVEL#CQRU1    #CF5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate fields if PO Not Denied
      * CASE: CTL.Don't Create Order Reason is Not Created Reasons
     C           #CNLST    IFEQ 'C'                        *IF
     C           #CNLST    OREQ 'D'
     C           #CNLST    OREQ 'V'
     C           #CNLST    OREQ 'P'
     C           #CNLST    OREQ 'R'
     C           #CNLST    OREQ 'A'
      * CTL.USR Description 22 = Condition name of CTL.Don't Create Order
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2142871   Y2LSNO  70       List number
     C                     PARM #CNLST    W0INVL 25        Don't Create Or
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CESNA    PARM           W0CNNM 25        USR Description
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CESNA           USR Description
      * See if customer is Order Entry Hold or not a ship to customer
      * CASE: CTL.Customer Number       NBR is not equal 0
     C           #CAJNB    IFNE *ZERO                      *IF
      * RTV OE Hold/ShipTo FlagXF - Customer  * 
     C                     CALL 'PDNEXFR'              90  RTV OE Hold/Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CAJNB    WQ0067  70       Ship To Custome
     C           WUQNST    PARM *BLANK    WQ0068  1        Order Entry Hol
     C           WURJST    PARM *BLANK    WQ0069  1        Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Order Entry Hold, not a ship to customer
      * CASE: WRK.Ship To Customer Flag is No Use as Ship to Cust
     C           WURJST    IFEQ 'N'                        *IF
     C                     Z-ADD#CAJNB    YL0055           Ship To Custome
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0055    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0055    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ship to Customer Flag 'N''
     C                     MOVEL'USR2482' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: WRK.Order Entry Hold is New Order Hold
     C           WUQNST    IFEQ 'Y'                        *IF
      * Send message 'Customer hold status'
     C                     MOVEL'USR1025' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.Company Number CDE is Equal to zero
     C           #CATNB    IFEQ *ZERO                      *IF
     C                     MOVE #CATNB    YL0056           Company Number
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           YL0056    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELYL0056    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0003           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company must be entered'
     C                     MOVEL'USR2384' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * RTV Cust Ordering Dflt2XF - Company Customer  * 
     C                     CALL 'PNS9XFR'              90  RTV Cust Orderi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0070  30       Company Number
     C                     PARM #CAJNB    WQ0071  70       Ship To Custome
     C                     PARM *BLANK    WQ0072  2        Terms Code
     C           YL0057    PARM *BLANK    WQ0073  3        Sales Route Cod
     C                     PARM *BLANK    WQ0074 40        Special Instruc
     C                     PARM *BLANK    WQ0075 40        Special Instruc
     C                     PARM *BLANK    WQ0076  3        Carrier Code
     C                     PARM *BLANK    WQ0077  1        P_O Required Fl
     C                     PARM *ZERO     WQ0078  40       Deliver after t
     C           #CBOCD    PARM *BLANK    WQ0079  2        Type Code
     C                     PARM *ZERO     WQ0080  52       Absorbed Freigh
     C           WUNFNN    PARM *ZERO     WQ0081  92       Mileage To Cust
     C           WUAJCD    PARM *BLANK    WQ0082  3        Warehouse Code
     C                     PARM *BLANK    WQ0083  1        Outside Warehou
     C           WUG0TX    PARM *BLANK    WQ0084  3        Customer Group
     C           WUG0TX    PARM *BLANK    WQ0085  3        Customer Group
     C                     PARM *BLANK    WQ0086  1        Ord Ent Default
     C           WUWXST    PARM *BLANK    WQ0087  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
      * Validate Co/Cust exists
      * CASE: WRK.Record Found USR is Record Found
     C           WUWXST    IFEQ 'Y'                        *IF
      * CASE: CTL.Warehouse Code is Warehouse Code Blank
     C           #CAJCD    IFEQ *BLANK                     *IF
     C                     MOVELWUAJCD    #CAJCD           Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Don't Create Order Reason is Not Created Reasons
     C           #CNLST    IFEQ 'C'                        *IF
     C           #CNLST    OREQ 'D'
     C           #CNLST    OREQ 'V'
     C           #CNLST    OREQ 'P'
     C           #CNLST    OREQ 'R'
     C           #CNLST    OREQ 'A'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE #CATNB    YL0056           Company Number
      * Setup message data for message
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.Warehouse Code is Blanks
     C           #CAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0004           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Requested Ship date is required
      * CASE: CTL.Requested Ship Date is not entered
     C           #CA5DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Date must be entered'
     C                     MOVEL'USR0231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If company is not zeros, get company name
      * CASE: CTL.Company Number CDE is not equal to zero
     C           #CATNB    IFNE *ZERO                      *IF
      * RTV Company Name       XF - Company Name and Address  * 
     C                     CALL 'PNH7XFR'              90  RTV Company Nam
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0088  30       Company Number
     C           #CAGTX    PARM *BLANK    WQ0089 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNH7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * If Ship To Customer is not zeros, get customer name
      * CASE: CTL.Customer Number       NBR is not equal 0
     C           #CAJNB    IFNE *ZERO                      *IF
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
     C                     EXSR SRRVGN
      * CASE: CTL.Ship To Address Line 2 is Blank
     C           #CHONA    IFEQ *BLANK                     *IF
     C                     MOVELYL0018    #CHONA           Ship To Address
     C                     END                             *FI
     C                     END                             *FI
      * Reload subfile to derive item codes with new customer #
      * CASE: CTL.Customer Number       NBR NE LCL.Ship To Customer SavUs
     C           #CAJNB    IFNE YL0058                     *IF
     C                     Z-ADD#CAJNB    YL0058           Ship To Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Default Order Type if it is blank
      * CASE: CTL.Order Type - Sales is Not Entered
     C           #CJNCD    IFEQ *BLANK                     *IF
     C                     MOVEL'OR'      #CJNCD           Order Type_Sale
     C                     END                             *FI
      * W77844 DN 06/12/21-Convert Old Spot Buy Flag Value to New Val: S,
      * * Validate Spot Buy               W77844 DN 06/12/21-Use New Valu
      * CASE: CTL.Spot Buy  (Y/N) is Spot
     C           #CSPOT    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
     C                     MOVEL'S'       YL0016           OHE Spot Buy
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: CTL.Spot Buy  (Y/N) is Turn
     C           #CSPOT    IFEQ 'T'                        *IF
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
     C                     MOVEL'T'       YL0016           OHE Spot Buy
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: CTL.Spot Buy  (Y/N) is Promo
     C           #CSPOT    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
     C                     MOVEL'P'       YL0016           OHE Spot Buy
      * CTL.Spot Buy Text USR = Condition name of CTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #CSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Company Organization is Seaboard
     C           P5YJSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
      * Setup message data for message
     C                     MOVEL#CSPOT    ZA0005           Spot Buy  (Y/N)
      * Send message 'Spot Buy S/T/P Required'
     C                     MOVEL'USR4747' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0016           OHE Spot Buy
     C                     MOVEL'T'       YL0016           OHE Spot Buy
     C                     MOVEL'T'       #CSPOT           Spot Buy  (Y/N)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Default Sales Route from salesperson code
      * CASE: LCL.Sales Route Code is not entered
     C           YL0057    IFEQ *BLANK                     *IF
      * CASE: LCL.Ord Ent Default Sls Rte is Yes
     C           YL0059    IFEQ 'Y'                        *IF
     C                     MOVELYL0060    YL0057           Sales Route Cod
     C                     END                             *FI
     C                     END                             *FI
      * display inter-co or third party message
      * CASE: CTL.Type Code is Inter Company
     C           #CBOCD    IFEQ 'IC'                       *IF
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,002   #CRHNA           Customer Type D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL@CN,003   #CRHNA           Customer Type D
     C                     END                             *FI
      * Populate salesperson if blank
      * CASE: CTL.Salesperson Code is not entered
     C           #CBCCD    IFEQ *BLANK                     *IF
      * RTV Salesman Code      XF - Sales Route  * 
     C                     CALL 'PNIAXFR'              90  RTV Salesman Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0057    WQ0090  3        Sales Route Cod
     C           #CBCCD    PARM *BLANK    WQ0091  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNIAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     END                             *FI
      * RTV Sls Route by Slsp  XF - Sales Route  * 
     C                     CALL 'PNH6XFR'              90  RTV Sls Route b
     C                     PARM *BLANK    W0RTN   7
     C           YL0057    PARM *BLANK    WQ0092  3        Sales Route Cod
     C                     PARM #CBCCD    WQ0093  3        Salesperson Cod
     C           YL0061    PARM *BLANK    WQ0094  2        Manager Level C
     C           YL0062    PARM *BLANK    WQ0095  3        VP Level Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNH6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
      * Populate warehouse code if blank
      * CASE: CTL.Warehouse Code is Warehouse Code Blank
     C           #CAJCD    IFEQ *BLANK                     *IF
     C                     MOVELWUAJCD    #CAJCD           Warehouse Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0021 155       System Value Nu
      *
      * Rtv Whs Typ/FZNCHLTME IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CAJCD    WL0032    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUWPST    P      Warehouse Type
      * CASE: PAR.Warehouse Type is Frozen
     C           WUWPST    IFEQ 'FZ'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SSRVGN
     C                     Z-ADDWN0021    WUCHTM           Fresh Chilling
     C                     END                             *FI
      * CASE: CTL.Warehouse Code NE LCL.Warehouse Code SavUsr
     C           #CAJCD    IFNE YL0039                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CAJCD    YL0039           Warehouse Code
     C                     END                             *FI
      * Requested Delivery Date is retrieved from EDI PO Header
      * CASE: CTL.Requested Delivery Date is not entered
     C           #CEIDT    IFEQ *ZERO                      *IF
     C                     Z-ADDP2DELV    #CEIDT           Requested Deliv
     C                     END                             *FI
      * rtv temp - Only update CTL temp if zeros
      * CASE: CTL.Reefer Temperature is Not Entered
     C           #CRNNB    IFEQ *ZERO                      *IF
      * RTV Shipping Temp      XF - Warehouse Type-Internal  * 
     C                     CALL 'PDSSXFR'              90  RTV Shipping Te
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUWPST    WQ0096  2        Warehouse Type
     C           #CRNNB    PARM *ZERO     WQ0097  52       Reefer Temperat
     C           #CFRSX    PARM *BLANK    WQ0098  1        Temperature Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993637*
     C                     END
      * Override with Customer Temperature if Entered. W84569 DN 10/28/21
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Company Number CDE is not equal to zero
      *   |- c2    : CTL.Customer Number       NBR is not equal 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CATNB    IFNE *ZERO                      *IF
     C           #CAJNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Cust Shipping Tmp XF - Company Customer EXT  * 
     C                     CALL 'POPRXFR'              90  Rtv Cust Shippi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CATNB    WQ0099  30       Company Number
     C                     PARM #CAJNB    WQ0100  70       Ship To Custome
     C           YL0037    PARM *ZERO     WQ0101  52       Cust Shipping T
     C           YL0038    PARM *BLANK    WQ0102  1        Cust Shipping T
     C                     PARM *BLANK    WQ0103  3        Ship To Warehou
     C                     PARM *ZERO     WQ0104  40       Item Age Days F
     C                     PARM *ZERO     WQ0105  40       Item Age Days F
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
      * Cust Shipping Temp
      * CASE: LCL.Cust Shipping Temp is Entered
     C           YL0037    IFNE *ZERO                      *IF
     C                     Z-ADDYL0037    #CRNNB           Reefer Temperat
     C                     MOVELYL0038    #CFRSX           Shipping Temp C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.Shipping Temp Code C/F is *ALL values
     C           #CFRSX    IFEQ 'C'                        *IF
     C           #CFRSX    OREQ 'F'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CFRSX    ZA0006           Shipping Temp C
      * Send message 'Shipping temp req'
     C                     MOVEL'USR5058' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * Validate temperature 1.19.18
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.Reefer Temperature is LE 100-
      *   |- c2    : CTL.Reefer Temperature is GE 100
      *   '-
     C           #CRNNB    IFLE -100                       *IF
     C           #CRNNB    ORGE 100                        *OR
      * Setup message data for message
     C                     Z-ADD#CRNNB    ZA0007           Reefer Temperat
      * Send message 'Temperature must be <100'
     C                     MOVEL'USR4960' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * Populate delivery time if blank
      * CASE: CTL.Requested Delivery Time is Zero
     C           #CAFTM    IFEQ *ZERO                      *IF
      * RTV Deliv. Times       RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CATNB    WL0017           Company Number
     C                     Z-ADD#CAJNB    WL0018           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    P9R4CD    P      Sales Route Cod
     C                     Z-ADDWL0020    YL0026           Deliver after t
     C                     Z-ADDWL0021    YL0027           Deliver before
     C                     Z-ADDWL0022    YL0028           Mileage To Cust
     C                     Z-ADD0800      #CAFTM           Requested Deliv
      * CASE: LCL.Deliver after time is Entered
     C           YL0026    IFNE *ZERO                      *IF
     C                     Z-ADDYL0026    #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Rqstd Delv Tme Dft RT - Trade Partner Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CJ5NX    WL0023    P      EDI Trading Par
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    YL0031    P      Requested Delv
      * If Not Blank, Convert to Numeric Time.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Requested Delv Time Dflt is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0031    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Cvt Rqstd Delv Tme Dft IF
      * Convert Time to Numeric.
      * CASE: PAR.Requested Delv Time Dflt is Midnight
     C           YL0031    IFEQ '0'                        *IF
     C                     Z-ADD0001      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 1 AM
     C           YL0031    IFEQ '1'                        *IF
     C                     Z-ADD0100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 2 AM
     C           YL0031    IFEQ '2'                        *IF
     C                     Z-ADD0200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 3 AM
     C           YL0031    IFEQ '3'                        *IF
     C                     Z-ADD0300      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 4 AM
     C           YL0031    IFEQ '4'                        *IF
     C                     Z-ADD0400      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 5 AM
     C           YL0031    IFEQ '5'                        *IF
     C                     Z-ADD0500      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 6 AM
     C           YL0031    IFEQ '6'                        *IF
     C                     Z-ADD0600      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 7 AM
     C           YL0031    IFEQ '7'                        *IF
     C                     Z-ADD0700      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 8 AM
     C           YL0031    IFEQ '8'                        *IF
     C                     Z-ADD0800      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 9 AM
     C           YL0031    IFEQ '9'                        *IF
     C                     Z-ADD0900      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 10 AM
     C           YL0031    IFEQ '10'                       *IF
     C                     Z-ADD1000      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 11 AM
     C           YL0031    IFEQ '11'                       *IF
     C                     Z-ADD1100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 12 PM
     C           YL0031    IFEQ '12'                       *IF
     C                     Z-ADD1200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 1 PM
     C           YL0031    IFEQ '13'                       *IF
     C                     Z-ADD1300      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 2 PM
     C           YL0031    IFEQ '14'                       *IF
     C                     Z-ADD1400      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 3 PM
     C           YL0031    IFEQ '15'                       *IF
     C                     Z-ADD1500      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 4 PM
     C           YL0031    IFEQ '16'                       *IF
     C                     Z-ADD1600      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 5 PM
     C           YL0031    IFEQ '17'                       *IF
     C                     Z-ADD1700      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 6 PM
     C           YL0031    IFEQ '18'                       *IF
     C                     Z-ADD1800      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 7 PM
     C           YL0031    IFEQ '19'                       *IF
     C                     Z-ADD1900      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 8 PM
     C           YL0031    IFEQ '20'                       *IF
     C                     Z-ADD2000      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 9 PM
     C           YL0031    IFEQ '21'                       *IF
     C                     Z-ADD2100      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 10 PM
     C           YL0031    IFEQ '22'                       *IF
     C                     Z-ADD2200      #CAFTM           Requested Deliv
     C                     ELSE
      * CASE: PAR.Requested Delv Time Dflt is 11 PM
     C           YL0031    IFEQ '23'                       *IF
     C                     Z-ADD2300      #CAFTM           Requested Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Delivery Time
      * CASE: CTL.Requested Delivery Time is GT 24 Hour Day
     C           #CAFTM    IFGT 2400                       *IF
      * Setup message data for message
     C                     Z-ADD#CAFTM    ZA0008           Requested Deliv
      * Send message 'Time Field GT 24 Hours'
     C                     MOVEL'USR1712' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C           #CAFTM    DIV  100       YRWF00           *Modulo work fi
     C                     MVR            WURDNB           USR Remainder
      * CASE: WRK.USR Remainder is GT 59 Minutes
     C           WURDNB    IFGT 59                         *IF
      * Setup message data for message
     C                     Z-ADD#CAFTM    ZA0009           Requested Deliv
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0106 10        User Profile Na
     C                     PARM 'O/P'     WQ0107  6        Application Cod
     C                     PARM #CAJCD    WQ0108  3        Warehouse Code
     C                     PARM *ZERO     WQ0109  70       Item Code
     C           YL0063    PARM *BLANK    WQ0110  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
      * VAL: Warehouse Access
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0063    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0010           *USER
     C                     MOVEL#CAJCD    ZA0011           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Validate Type code  (Sales Channel)
      * CASE: PAR.Company Organization is Seaboard
     C           P5YJSX    IFEQ 'S'                        *IF
      * Validate Type code
      * CASE: CTL.Type Code is Entered
     C           #CBOCD    IFNE *BLANK                     *IF
      * Val Type Codes         XF - Type Codes  * 
     C                     CALL 'PBAKXFR'              90  Val Type Codes
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CBOCD    WQ0111  2        Type Code
     C           WUH3TX    PARM WUH3TX    WQ0112  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Return Code Usr is *Record does not exist
     C           WUH3TX    IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     MOVEL#CBOCD    ZA0012           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Sales Channel          NF'
     C                     MOVEL'USR4832' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate - load type cannot be blanks
      * CASE: CTL.Load Type is Blank
     C           #CVDST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CVDST    ZA0013           Load Type
      * Send message 'Load Type Must be Entered'
     C                     MOVEL'USR1813' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CTL.Load Type Desc = Condition name of CTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #CVDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CNONA    PARM           W0CNNM 25        Load Type Desc
      *
     C                     END                             *FI
      * 11/08/17 DN E011229-Additional Validation.
      * CASE: *OTHERWISE
      * Bypass Co/Whs/AgeDay is Required Logic if Deny PO Reason is Enter
      * CASE:
      *  - NOTc1
      *   |- c1    : CTL.Don't Create Order Reason is *Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CNLST    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Deny PO Reason originally entered then was blank out so don't val
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Don't Create Order Reason is *Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0052    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Throw Error Msg: Company Number is required.
      * CASE: CTL.Company Number CDE is Equal to zero
     C           #CATNB    IFEQ *ZERO                      *IF
     C                     MOVE #CATNB    YL0056           Company Number
      * Setup message data for message
     C                     Z-ADD#CATNB    ZA0014           Company Number
      * Send message 'company number is requird'
     C                     MOVEL'USR5033' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * Throw Error Msg: Warehouse is required.
      * CASE: CTL.Warehouse Code is Blanks
     C           #CAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0015           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Throw Error Msg: Salesperson is required.
      * CASE: CTL.Salesperson Code is not entered
     C           #CBCCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CBCCD    ZA0016           Salesperson Cod
      * Send message 'Salesperson Required'
     C                     MOVEL'USR5059' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Warehouse Code.
      * CASE: CTL.Warehouse Code is Not Blanks
     C           #CAJCD    IFNE *BLANK                     *IF
      * Val ShipCo/Whs Active RT - Warehouse  * 
     C                     EXSR STRVGN
      * 01/07/20 DN S15952-Force SFLNXTCHG to Validate Fresh/Frozen Items
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0064    IFEQ 'N'                        *IF
     C                     MOVE #CATNB    YL0056           Company Number
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0017           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           YL0056    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELYL0056    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0018           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0018           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse Invalid for Co'
     C                     MOVEL'USR3404' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     END                             *FI
     C                     END                             *FI
      * Validate Salesperson Code.
      * CASE: CTL.Salesperson Code is entered
     C           #CBCCD    IFNE *BLANK                     *IF
      * Val Salesperson Exist RT - Salesperson  * 
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Salesperson            NF'
     C                     MOVEL'USR0039' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Price Method Code.
      * CASE: CTL.Price Method Code is Not Blank
     C           #CQ7CD    IFNE *BLANK                     *IF
      * VAL Price Meth Exists  RT - Price Method Header  * 
     C                     EXSR SVRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CQ7CD    ZA0019           Price Method Co
      * Send message 'Price Method invalid'
     C                     MOVEL'USR1957' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * Validate F6=Create Auto Order.
      * CASE: CTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
      * Val EDI PO Dtl-selctd RT - EDI Purchase Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0034           ST02-TRANS SET
     C                     MOVELYL0065    WL0035    P      Status Flag 13
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0065    P      Status Flag 13
      * CASE: LCL.Status Flag 13 Y/N is No
     C           YL0065    IFEQ 'N'                        *IF
      * Send message 'Item code must be sel'
     C                     MOVEL'USR5057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate F20=Create/Edit/Post Order.          11/19/21 DN W84569
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * Val EDI PO Dtl-selctd RT - EDI Purchase Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0034           ST02-TRANS SET
     C                     MOVELYL0065    WL0035    P      Status Flag 13
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0065    P      Status Flag 13
      * New Items Selected?
      * CASE: LCL.Status Flag 13 Y/N is No
     C           YL0065    IFEQ 'N'                        *IF
      * OMS Order Number Created in Same Session?
      * CASE: LCL.Order Number Saved USR is Not equal to zeros
     C           YL0066    IFNE *ZERO                      *IF
      * Allow to only call Order Entry process PDSQXFR.
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Item code must be sel'
     C                     MOVEL'USR5057' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Allow to create Order & call Order Entry process PDSQXFR.
     C                     Z-ADD*ZERO     YL0066           Order Number Sa
     C                     END                             *FI
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: Process command keys
      * F3=Exit with or without Update
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U0016' W0RTN            *Return code
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F6/F20=Create/Post EDI Auto Order             11/11/21 DN W84569
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Item Code Exist USR is No
      *   |- c2    : CTL.Don't Create Order Reason is *Blanks
      *   |- c3    : CTL.*CMD key is CF06
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFEQ 'N'                        *IF
     C           #CNLST    IFEQ *BLANK                     *IF
     C           *IN06     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * DO NOT create the order
     C                     MOVEL'USR5036' W0RTN            *Return code
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: CTL.Don't Create Order Reason NE LCL.Don't Create Order Rea
     C           #CNLST    IFNE YL0052                     *IF
      * Do NOT create the order. Update Deny PO Reason in EDI PO Header.
      * Chg don't crt ord sts CH - EDI Purchase Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0036           ST02-TRANS SET
     C                     MOVEL#CNLST    WL0037    P      Don't Create Or
     C                     EXSR SXCHRC
     C                     MOVEL#CNLST    YL0052           Don't Create Or
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.*CMD key is CF06
      *   |- c2    : CTL.*CMD key is CF20
      *   '-
     C           *IN06     IFEQ '1'                        *IF
     C           *IN20     OREQ '1'                        *OR
      * Create Order.
      * CASE: *OTHERWISE
     C                     Z-ADD#CATNB    YL0067           Company Number
     C                     Z-ADD#CAJNB    P3AJNC           Customer Number
      * PAR.Date 1          PASS  USR = CTL.Requested Ship Date
     C                     Z-ADD#CA5DT    P3AJAB           Date 1
      * PAR.Date 2          PASS  USR = CTL.Requested Ship Date
     C                     Z-ADD#CA5DT    P3AJAC           Date 2
      * PAR.From Date Pass        USR = CTL.Requested Delivery Date
     C                     Z-ADD#CEIDT    P3AJAD           From Date Pass
      * PAR.Thru Date Pass        USR = LCL.Order Date
     C                     Z-ADDYL0001    P3AJAG           Thru Date Pass
     C                     Z-ADD#CATNB    WUAIC3           Company Number
     C                     MOVEL##USR     YL0068           User Original E
     C                     Z-ADD1         YL0069           ITEM SEQUENCE N
      * 02/23/21 DN R17040-Set Customer Ref ID if 'IA' Else Set as Blank.
      * CASE: LCL.Customer Ref ID Qualifier is IA
     C           YL0007    IFEQ 'IA'                       *IF
      * Use LCL.Customer Ref ID to populate OHE Customer Vendor f/PO.
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0008           Customer Ref ID
     C                     END                             *FI
      * 06/14/21 DN R17040-Passed in OHE Spot Buy as Input Parm.
      * 11/22/21 DN W84569-Passed in OD Pallet Type as Input Parm.
      * W84569 DN 12/01/21-If F6 or F20 & OMS Order Not Created Yet Then
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : CTL.*CMD key is CF06
      *   |- c2    : CTL.*CMD key is CF20
      *   |- c3    : LCL.Order Number Saved USR is Equal to zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN06     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           *IN20     IFEQ '1'                        *IF
     C           YL0066    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT EDI Auto Ords Only XF - EDI Purchase Order Detail  * 
     C                     CALL 'PUD0XFR'              90  CRT EDI Auto Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2TSCN    WQ0113  90       ST02-TRANS SET
     C                     PARM YL0069    WQ0114  30       ITEM SEQUENCE N
     C                     PARM P3AJAG    WQ0115  70       G5002-ORDER DAT
     C                     PARM #CPONO    WQ0116 22        G5003-PURCHASE
     C                     PARM YL0008    WQ0117 30        Customer Ref ID
     C                     PARM #CYDT1    WQ0118 25        Delivery PO Num
     C                     PARM #CJ5NX    WQ0119  6        EDI Trading Par
     C                     PARM YL0067    WQ0120 155       Company Number
     C                     PARM P3AJNC    WQ0121 155       Customer Number
     C                     PARM P3AJAB    WQ0122 155       Date 1
     C                     PARM P3AJAC    WQ0123 155       Date 2
     C                     PARM P3AJAD    WQ0124 155       From Date Pass
     C                     PARM P3AJAG    WQ0125 155       Thru Date Pass
     C           YL0070    PARM YL0070    WQ0126 155       Order Number 1
     C                     PARM #CAJCD    WQ0127  3        Warehouse Code
     C                     PARM ##USR     WQ0128 10        USR User ID Sel
     C                     PARM P3CESC    WQ0129  1        Use PO Price
     C                     PARM #CJNCD    WQ0130  2        Order Type_Sale
     C           #CDUC7    PARM #CDUC7    WQ0131  70       AR Customer Num
     C                     PARM #CPONO    WQ0132 15        Customer Purcha
     C                     PARM P9AQCD    WQ0133  2        Terms Code
     C                     PARM ##USR     WQ0134 10        User Original E
     C                     PARM #CAFTM    WQ0135  40       Requested Deliv
     C                     PARM #CQ2CD    WQ0136  2        Shipping Method
     C                     PARM #CRNNB    WQ0137  52       Reefer Temperat
     C                     PARM #CVDST    WQ0138  1        Load Type
     C                     PARM YL0071    WQ0139  1        Load Plan Order
     C                     PARM #CBCCD    WQ0140  3        Sales Route Cod
     C                     PARM #CFRSX    WQ0141  1        Shipping Temp C
     C           #CAJCD    PARM #CAJCD    WQ0142  3        Warehouse Code
     C           #CQ7CD    PARM #CQ7CD    WQ0143  3        Price Method Co
     C                     PARM ##USR     WQ0144 10        User Profile Na
     C           #CF5SX    PARM #CF5SX    WQ0145  2        OD Pallet Type
     C                     PARM #CF7SX    WQ0146  3        OD Price Type
     C           P4C5NB    PARM P4C5NB    WQ0147  70       Next Order Numb
     C                     PARM YL0016    WQ0148  4        OHE Spot Buy
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUD0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993340*
     C                     SETON                     353634*
     C                     SETON                     373343*
     C                     SETON                     44    *
     C                     END
      * * Convert order# from 7.0 to 30 alpha
     C                     Z-ADDP4C5NB    YL0041           Order Number
      * W84569 DN 12/01/21-Save Last Order Number Created.
      * CASE: *OTHERWISE
     C                     Z-ADDYL0041    YL0066           Order Number Sa
     C                     MOVEL*BLANK    YL0040           Order Number Al
     C                     MOVELYL0041    YL0040           Order Number Al
     C                     MOVEL*BLANK    YL0072           OH Order Number
     C                     MOVELYL0040    YL0072           OH Order Number
      * If 1 order already created, put a + on the line
      * CASE: CTL.OH Order Number is Not Blanks
     C           #CBXU1    IFNE *BLANK                     *IF
     C                     Z-ADD2         ZQ      50
     C           #CBXU1    CAT  '+':ZQ    YL0072    P      OH Order Number
     C                     END                             *FI
      * Chg EDI OH Order Nbr  CH - EDI Purchase Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2TSCN    WL0038           ST02-TRANS SET
     C                     MOVELYL0072    WL0039    P      OH Order Number
     C                     EXSR SYCHRC
      * 01/09/20 DN S15952-Clear CTL Qty/Wgt Ordered & Accumulators.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #CJXQT           Quantity Ordere
     C                     Z-ADD*ZERO     P3JXQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CPFWG           Weight Ordered
     C                     Z-ADD*ZERO     P3PFWG           Weight Ordered
     C                     MOVELYL0072    #CBXU1           OH Order Number
     C                     END                             *FI
      * W84569 DN 12/01/21-Call Edit Order Entry Only for Same Session.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is CF20
      *   |- c2    : LCL.Order Number Saved USR is Not equal to zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN20     IFEQ '1'                        *IF
     C           YL0066    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PDSQXFR is called from multiple Order Entry points.
     C                     MOVEL'C'       YL0073           Process Control
      * EDT Order Entry Home   XF - Order Header TRG  * 
     C                     CALL 'PDSQXFR'              90  EDT Order Entry
     C                     PARM *BLANK    W0RTN   7
     C           YL0067    PARM YL0067    WQ0149  30       Company Number
     C           YL0066    PARM YL0066    WQ0150  70       Order Number
     C           P3AJNC    PARM P3AJNC    WQ0151  70       Ship To Custome
     C           YL0073    PARM YL0073    WQ0152  1        Process Control
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'UPDOCC'  W0RTN            *Return code
      * * Return company Number to calling program for acknowledgements
     C                     Z-ADD#CATNB    P3AJAA           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,46
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Status - Y or N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#RB8ST'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * Status - Y or N
     C                     MOVEL#RB8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHB8ST
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZHB8ST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD2         ZHB8ST
     C                     ENDSL
      * Window width
     C                     Z-ADD12        YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD17        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD4         YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGB8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHB8ST    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHB8ST    WHEQ 2
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #RB8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * If Deny PO Reason is Entered, Bypass Validation Else Continue Val
      * CASE:
      *  - NOTc1
      *   |- c1    : CTL.Don't Create Order Reason is *Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CNLST    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If entered, bypass validation & do NOT allow update of ECP005.
      * Do Not Allow To 'Add to Order'.
      * CASE: RCD.Status - Y or N is Exclude
     C           #RB8ST    IFEQ 'X'                        *IF
     C                     Z-ADD0         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0074    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0074    CAT  @CN,009:ZQYL0074    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0074    ZA0020           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Allow F4 on SBD Item #.
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> RCD.Item Code Number 7.0  USR
      *   |- c3    : CTL.Company Number CDE is not equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RICNM'                   *IF
     C           #CATNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Actv Finished Good SR - Company Item  * 
     C                     CALL 'PDNHSRR'              90  SEL Actv Finish
     C                     PARM *BLANK    W0RTN   7
     C           #CATNB    PARM #CATNB    WQ0153  30       Company Number
     C           #RICNM    PARM #RICNM    WQ0154  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983247*
     C                     END
     C                     END                             *FI
      * Validate SBD Item #.
      * CASE: RCD.Item Code Number 7.0  USR is Entered
     C           #RICNM    IFNE *ZERO                      *IF
      * Rtv FG Item Exists    RT - Company Item  * 
     C                     EXSR SZRVGN
      * Item Not Found, Throw Error Message.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Do NOT update ECP005.
      * Setup message data for message
      * Send message 'Item not found'
     C                     MOVEL'USR0374' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9847  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Validate Item is Fresh/Frozen.
      * CASE: *OTHERWISE
      * RTV Sold 100% Frozen  RT - Company Item  * 
     C                     EXSR TARVGN
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CAJCD    WL0032    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    YL0076    P      Warehouse Type
     C                     Z-ADD#RICNM    YL0048           Item Code
      * Fresh item and FZ warehouse
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Warehouse Type is Fresh
      *   |- c2    : LCL.Sold 100% Frozen is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'FR'                       *IF
     C           YL0075    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 01/07/20 DN S15952-Send As Info Msg Instead. Commented out QUIT.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0048    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0048    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0021           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0021           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item Invalid-sold 100%FZ2'
     C                     MOVEL'USR5161' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * FZ    item and FR warehouse
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Warehouse Type is Frozen
      *   |- c2    : LCL.Sold 100% Frozen is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0076    IFEQ 'FZ'                       *IF
     C           YL0075    IFEQ *BLANK                     *IF
     C           YL0075    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 01/07/20 DN S15952-Send As Info Msg Instead. Commented out QUIT.
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0048    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0048    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0022           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0022           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item Invalid-sold fresh 2'
     C                     MOVEL'USR5160' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Add to Order Flag.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Status - Y or N is Exclude
      *   |- c2    : RCD.Item Code Number 7.0  USR is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RB8ST    IFEQ 'X'                        *IF
     C           #RICNM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         ZQ      50
     C           @CN,010   CAT  'ed.':ZQ  YL0074    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0074    ZA0023           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: 01/18/18 DN R12342-Val Add to Order for Age Days
      *  - c1 AND c2
      *   |- c1    : RCD.Status - Y or N is Exclude
      *   |- c2    : RCD.POD Item Age Days USR is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RB8ST    IFEQ 'X'                        *IF
     C           #RCQNZ    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         ZQ      50
     C           @CN,011   CAT  'ered.':ZQYL0074    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0074    ZA0024           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Validate Pallet Type.                         11/22/21 DN W84569
      * CASE: CTL.Pallet Type NOREF is Entered
     C           #CQRU1    IFNE *BLANK                     *IF
      * Chk Pallet Typ Exists RT - Pallet Master  * 
     C                     EXSR TBRVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0064    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#CQRU1    ZA0025           Pallet Type NOR
      * Send message 'PAL-Pallet Type not found'
     C                     MOVEL'USR5214' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#CQRU1    #CF5SX           OD Pallet Type
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - NOTc1
      *   |- c1    : RCD.POD Added to an Order is Added to Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1NKST    IFEQ 'Y'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC - validate days if not already on an order 11/9/20
      * CASE: CTL.Warehouse Code NE LCL.Warehouse Code SavUsr
     C           #CAJCD    IFNE YL0039                     *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CAJCD    WL0032    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUWPST    P      Warehouse Type
      * 11/19/21 DN W84569-Populate Item Age Days.
      * CASE: DB1.POD Item Age Days is Entered
     C           BRS2NY    IFNE *ZERO                      *IF
     C                     Z-ADDBRS2NY    #RCQNZ           POD Item Age Da
     C                     ELSE
      * CASE: *OTHERWISE
      * Use item age days fresh
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Warehouse Type is Fresh
      *   |- c2    : LCL.Item Age Days Fresh is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPST    IFEQ 'FR'                       *IF
     C           YL0029    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0029    #RCQNZ           POD Item Age Da
     C                     END                             *FI
      * Use item age days frozen
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Warehouse Type is Frozen
      *   |- c2    : LCL.Item Age Days Frozen is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPST    IFEQ 'FZ'                       *IF
     C           YL0030    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0030    #RCQNZ           POD Item Age Da
     C                     END                             *FI
     C                     END                             *FI
      * 01/18/18 DN R12342-Validate Item Age Days.
      * CASE: RCD.POD Item Age Days USR is Entered
     C           #RCQNZ    IFNE *ZERO                      *IF
      * Cannot be negative.
      * CASE: RCD.POD Item Age Days USR is LT 0
     C           #RCQNZ    IFLT *ZERO                      *IF
     C                     Z-ADD0         ZQ      50
     C           @CN,012   CAT  @CN,013:ZQYL0074    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0074    ZA0026           Generic Message
      * Send message 'Generic Message 80 ERR'
     C                     MOVEL'USR4977' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Snippet codes below copied from 'Val Age Information   IF' & modi
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RICNM    WQ0155  70       Item Code
     C                     PARM #CAJCD    WQ0156  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0157  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0158 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0159 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0160 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0161 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0162 30        Error Reason De
     C                     PARM #CATNB    WQ0163  30       Company Number
     C                     PARM #CA5DT    WQ0164  70       Scheduled Ship
     C                     PARM #CEIDT    WQ0165  70       Requested Deliv
     C                     PARM #RCQNZ    WQ0166  40       Item Age Days
     C                     PARM *ZERO     WQ0167  70       Production Ovr
     C                     PARM *ZERO     WQ0168  70       Production Ovr
     C           WUTNDT    PARM WUTNDT    WQ0169  70       Production AgeD
     C           WUTODT    PARM WUTODT    WQ0170  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     984733*
     C                     SETON                     323839*
     C                     SETON                     48    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE: WRK.Error Flag            USR is Yes
     C           WUB8SX    IFEQ 'Y'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * R12342-DN-Note that this is the only error that can potentially b
      *        Error message 2-5 will NOT happen.
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9839  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#RCQNZ    ZA0028           POD Item Age Da
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WUTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0029
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WUTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#RCQNZ    ZA0031           POD Item Age Da
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WUTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WUTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#RCQNZ    ZA0034           POD Item Age Da
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WUTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WUTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADD#RCQNZ    ZA0037           POD Item Age Da
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WUTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WUTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9848  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#CAJCD    YL0039           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
      * 01/07/20 DN S15952-Update CTL Qty/Wgt Ordered.
     C                     Z-ADDP3JXQT    #CJXQT           Quantity Ordere
     C                     Z-ADDP3PFWG    #CPFWG           Weight Ordered
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,46
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * X=Selected for Order.The PO order dtl will be chg to Y after it i
      * CASE: RCD.POD Added to an Order is Added to Order
     C           #1NKST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * 01/02/20 DN S15952-Save 'Add to Order' Value.
      * CASE: *OTHERWISE
      * 01/02/20 DN S15952-Accum CTL Qty/Wgt Ordered for Lines 'Add to Or
      * CASE: RCD.Status - Y or N NE RCD.Add to Order USR
     C           #RB8ST    IFNE #RKKSC                     *IF
      * Add.
      * CASE: RCD.Status - Y or N is Exclude
     C           #RB8ST    IFEQ 'X'                        *IF
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CATNB    WL0040           Company Number
     C                     Z-ADD#RICNM    WL0041           Item Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0042    YL0077           Unit Weight
     C                     MOVELWL0043    YN0118    P      Quality Level
     C                     ADD  #1D5VL    P3JXQT           Quantity Ordere
     C           #1D5VL    MULT YL0077    YL0078           Weight Ordered
     C                     ADD  YL0078    P3PFWG           Weight Ordered
     C                     END                             *FI
      * Subtract.
      * CASE: RCD.Status - Y or N is blank
     C           #RB8ST    IFEQ *BLANK                     *IF
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#CATNB    WL0040           Company Number
     C                     Z-ADD#RICNM    WL0041           Item Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0042    YL0077           Unit Weight
     C                     MOVELWL0043    YN0118    P      Quality Level
     C                     SUB  #1D5VL    P3JXQT           Quantity Ordere
     C           #1D5VL    MULT YL0077    YL0078           Weight Ordered
     C                     SUB  YL0078    P3PFWG           Weight Ordered
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#RB8ST    #RKKSC           Add to Order US
      * In case Item# was originally blank, set flag to allow F6=Create.
     C                     MOVEL'Y'       YL0044           Item Code Exist
      * Update Added to an Order Status, SBD Item # & Age Days.
      * 01/19/19 DN R12342-Added POD Item Age Days for update.
      * Chg AddtoOrd/Itm#/AgeD CH - EDI Purchase Order Detail  * 
     C                     EXSR TDCHRC
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #1NKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @P005LE fields to subfile
      *================================================================
     C                     Z-ADDBRTSCN    #1TSCN           ST02-TRANS SET
     C                     Z-ADDBRSEQX    #1SEQX           ITEM SEQUENCE N
     C                     MOVELBRLEST    #1LEST           POC02-Chg/Resp
     C                     Z-ADDBRS2NY    #1S2NY           POD Item Age Da
     C                     MOVELBRR2AA    #1R2AA           G6807/PO110 Pro
     C                     MOVELBRAOU1    #1AOU1           G6808/PO111 Pro
     C                     MOVELBRR4AA    #1R4AA           PO112 Prod ID Q
     C                     MOVELBRAQU1    #1AQU1           PO113 Prod ID
     C                     MOVELBRR3AA    #1R3AA           P106 UPC/GTIN Q
     C                     MOVELBRAPU1    #1APU1           POD Unused GTIN
     C                     MOVELBRYCT1    #1YCT1           POD unused text
     C                     Z-ADDBRUEDT    #1UEDT           POD unused date
     C                     MOVELBROIAA    #1OIAA           POD Basis Unit
     C                     Z-ADDBRMJVL    #1MJVL           POD SBD Item Nu
     C                     Z-ADDBRUINY    #1UINY           POD Pack Qty
     C                     MOVELBRNKST    #1NKST           POD Added to an
     C                     Z-ADDBRD5VL    #1D5VL           G6801-QUANTITY
     C                     MOVELBRPRQL    #1PRQL           G6805/P108 PROD
     C                     MOVELBRPRID    #1PRID           G6806/P109 PROD
     C                     MOVELBRUPCX    #1UPCX           G6804/P107 UPC/
     C                     MOVELBRDESC    #1DESC           G6901-ITEM DESC
     C                     Z-ADDBRPRCX    #1PRCX           G6803-ITEM LIST
     C                     MOVELBRUNIT    #1UNIT           G6802-BASIS FOR
     C                     MOVEL*BLANK    #RKKSC           Add to Order US
     C                     MOVEL*BLANK    #RHKT1           Text 2
     C                     Z-ADD*ZERO     #RDTPR           Unit Price (DSP
     C                     MOVEL*BLANK    #RD2TX           Status Flag 21
     C                     MOVEL*BLANK    #RB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #RICNM           Item Code Numbe
     C                     Z-ADD*ZERO     #RCQNZ           POD Item Age Da
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #CD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     #CD4VL           G7603-WEIGHT OR
     C                     MOVEL*BLANK    #CRHNA           Customer Type D
     C                     MOVEL*BLANK    #CBOCD           Type Code
     C                     MOVEL*BLANK    #CVDST           Load Type
     C                     MOVEL*BLANK    #CNONA           Load Type Desc
     C                     MOVEL*BLANK    #CJNCD           Order Type_Sale
     C                     MOVEL*BLANK    #CF5SX           OD Pallet Type
     C                     MOVEL*BLANK    #CLWAA           OHE Intended fo
     C                     MOVEL*BLANK    #CC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #CRDCD           Date Method Cod
     C                     Z-ADD*ZERO     #CBVTM           Price Code
     C                     MOVEL*BLANK    #CSXAA           Ref ID Qualifie
     C                     Z-ADD*ZERO     #2SEQX           ITEM SEQUENCE N
     C                     MOVEL*BLANK    #CPONO           G5003-PURCHASE
     C                     Z-ADDP1TSCN    #2TSCN           ST02-TRANS SET
     C                     MOVEL*BLANK    #CJ5NX           EDI Trading Par
     C                     MOVEL*BLANK    #CDD1X           N301-ADD
     C                     Z-ADD*ZERO     #CJXQT           Quantity Ordere
     C                     MOVEL*BLANK    #CITYX           N401-CITY
     C                     MOVEL*BLANK    #CTATE           N402-STATE
     C                     Z-ADD*ZERO     #CPFWG           Weight Ordered
     C                     MOVEL*BLANK    #CYDT1           Delivery PO Num
     C                     MOVEL*BLANK    #CBXU1           OH Order Number
     C                     Z-ADD*ZERO     #CDUC7           A_R Customer
      * Clear external version also
     C                     MOVEL*BLANK    VCDUC7
     C                     MOVEL*BLANK    #CAYTX           Customer Name
     C                     Z-ADD*ZERO     #CAJNB           Customer Number
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     MOVEL*BLANK    #CHONA           Ship To Address
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     Z-ADD*ZERO     #CATNB           Company Number
     C                     MOVEL*BLANK    #CAGTX           USR Company Nam
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     Z-ADD*ZERO     #CRNNB           Reefer Temperat
     C                     MOVEL*BLANK    #CFRSX           Shipping Temp C
     C                     Z-ADD*ZERO     #CA5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCA5DT
     C                     Z-ADD*ZERO     #CEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VCEIDT
     C                     Z-ADD*ZERO     #CAFTM           Requested Deliv
     C                     MOVEL*BLANK    #CQRU1           Pallet Type NOR
     C                     MOVEL*BLANK    #CSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    #CQIU1           Spot Buy Text U
     C                     MOVEL*BLANK    #CQ7CD           Price Method Co
     C                     MOVEL*BLANK    #CF7SX           OD Price Type
     C                     MOVEL*BLANK    #CNLST           Don't Create Or
     C                     MOVEL*BLANK    #CESNA           USR Description
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert A_R Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #CDUC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#CDUC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCDUC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCDUC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #CA5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCA5DT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCEIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv All Hdr by Control RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BQTSCN           ST02-TRANS SET
      * Setup key
     C                     Z-ADDP1TSCN    BQTSCN           ST02-TRANS SET
      * Establish starting position
     C           KRSSA     CHAIN@P004LA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           G5002-ORDER DAT
     C                     MOVEL*BLANK    #CPONO           G5003-PURCHASE
     C                     MOVEL*BLANK    YL0002           DTM01-Ship Date
     C                     Z-ADD*ZERO     YL0003           G6202 Ship Date
     C                     MOVEL*BLANK    YL0004           G6201-DATE QUAL
     C                     Z-ADD*ZERO     #CEIDT           G6202-DELIVERY
     C                     MOVEL*BLANK    YL0005           G6601-SHIPMENT
     C                     MOVEL*BLANK    YL0006           G6602-METHOD TY
     C                     Z-ADD*ZERO     #CD3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     #CD4VL           G7603-WEIGHT OR
     C                     MOVEL*BLANK    YL0007           Customer Ref ID
     C                     MOVEL*BLANK    YL0008           Customer Ref ID
     C                     MOVEL*BLANK    #CBXU1           OH Order Number
     C                     MOVEL*BLANK    #CYDT1           Delivery PO Num
     C                     MOVEL*BLANK    #CNLST           Don't Create Or
     C                     MOVEL*BLANK    #CJ5NX           EDI Trading Par
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBQOSDT    YL0001           G5002-ORDER DAT
     C                     MOVELBQPONO    #CPONO           G5003-PURCHASE
     C                     MOVELBQJ2AA    YL0002           DTM01-Ship Date
     C                     Z-ADDBQT6DT    YL0003           G6202 Ship Date
     C                     MOVELBQQLFX    YL0004           G6201-DATE QUAL
     C                     Z-ADDBQDELV    #CEIDT           G6202-DELIVERY
     C                     MOVELBQSHMT    YL0005           G6601-SHIPMENT
     C                     MOVELBQMTTY    YL0006           G6602-METHOD TY
     C                     Z-ADDBQD3VL    #CD3VL           G7601-QUANTITY
     C                     Z-ADDBQD4VL    #CD4VL           G7603-WEIGHT OR
     C                     MOVELBQSRAA    YL0007           Customer Ref ID
     C                     MOVELBQBRU1    YL0008           Customer Ref ID
     C                     MOVELBQBXU1    #CBXU1           OH Order Number
     C                     MOVELBQYDT1    #CYDT1           Delivery PO Num
     C                     MOVELBQNLST    #CNLST           Don't Create Or
     C                     MOVELBQJ5NX    #CJ5NX           EDI Trading Par
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv All info by type  RT - EDI Purchase Order Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BSTSCN           ST02-TRANS SET
     C                     KFLD           BSTYPC           N101-NAME TYPE
      * Setup key
     C                     Z-ADDWL0001    BSTSCN           ST02-TRANS SET
     C                     MOVELWL0002    BSTYPC           N101-NAME TYPE
      * Establish starting position
     C           KRSSB     CHAIN@P006LC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3107' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           N102-NAME
     C                     MOVEL*BLANK    WL0004           N103-ID CODE QU
     C                     MOVEL*BLANK    WL0005           N104-ID CODE
     C                     MOVEL*BLANK    WL0006           N201-NAME
     C                     MOVEL*BLANK    WL0007           N202-NAME
     C                     MOVEL*BLANK    WL0008           N301-ADD
     C                     MOVEL*BLANK    WL0009           N302-ADDRESS
     C                     MOVEL*BLANK    WL0010           N401-CITY
     C                     MOVEL*BLANK    WL0011           N402-STATE
     C                     MOVEL*BLANK    WL0012           N403-POSTAL COD
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBSAMEX    WL0003           N102-NAME
     C                     MOVELBSDCDQ    WL0004           N103-ID CODE QU
     C                     MOVELBSDCDE    WL0005           N104-ID CODE
     C                     MOVELBSAME1    WL0006           N201-NAME
     C                     MOVELBSAME2    WL0007           N202-NAME
     C                     MOVELBSDD1X    WL0008           N301-ADD
     C                     MOVELBSDD2X    WL0009           N302-ADDRESS
     C                     MOVELBSITYX    WL0010           N401-CITY
     C                     MOVELBSTATE    WL0011           N402-STATE
     C                     MOVELBSIPXX    WL0012           N403-POSTAL COD
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv EDI ST by EDI Duns RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CAJNB           Ship To Custome
     C                     MOVEL*BLANK    #CFRSX           Cust Shipping T
      * Declare restrictor key work fields
     C           *LIKE     DEFN NEU5TX    WQSC01           EDI Cust Duns N
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           EDI Cust Duns N
      * Setup key
     C                     MOVELYL0012    WQSC01           EDI Cust Duns N
      * Establish starting position
     C           KRSSC     SETLL@NEREA8                    *
     C           KRSSC     READE@NEREA8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CAJNB           Ship To Custome
     C                     MOVEL*BLANK    #CFRSX           Cust Shipping T
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 02/22/21 DN R17040-Old Logic. Commented Out.
      * ***NOTE: Any changes made here, should consider changes to
      *          'Rtv Sales Rte-1st ShToRT - Customer EXT',
      *          'PRT BT Cust by DUNS   PO - Customer EXT' &
      *          'PRT ST Cust by DUNS   PO - Customer EXT' functions as
      *          well. BOTH functions share the same Business Logic to ge
      *          the correct EDI Ship To Customer #. ***
      * 03/01/21 DN R17040-New Logic: Get 1st Active STC# by DUNS#/Trade
      * CASE: DB1.Record Status is Active
     C           NEVSST    IFEQ 'A'                        *IF
      * Get Ship To Cust Flag & Bill To Customer #.
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
     C                     EXSR SDRVGN
      * Must Be Use as Ship To Customer.
      * CASE: LCL.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0014    IFEQ 'Y'                        *IF
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cus
     C                     EXSR SERVGN
      * Match by Trading Partner for Bill To Customer.
      * CASE: PAR.EDI Trading Partner No. EQ LCL.EDI Trading Partner No.
     C           #CJ5NX    IFEQ YL0015                     *IF
      * PAR = DB1 By name
     C                     Z-ADDNEBKC7    #CAJNB           Ship To Custome
     C                     MOVELNEHSSX    #CFRSX           Cust Shipping T
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@NEREA8                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv ShpTo Info/AR Cst RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDNEBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    YL0013           AR Customer Num
     C                     MOVELBBRJST    YL0014           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Trading Partner   RT - Customer EXT  * Get TP for Bill To Cu
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0015           EDI Trading Par
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0013    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@NEREAT              90    *
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAJ5NX    YL0015           EDI Trading Par
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV All fields         RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#CAJNB    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    YL0017           Customer Name
     C                     MOVELBBACNA    YL0018           Address Line 1
     C                     MOVELBBADNA    YL0019           Address Line 2
     C                     MOVELBBAJNA    YL0020           City
     C                     Z-ADDBBANC7    #CDUC7           AR Customer Num
     C                     MOVELBBRJST    YL0021           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Bill To Cust Name  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBANC7    WQSG01           AR Customer Num
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           AR Customer Num
      * Setup key
     C                     Z-ADD#CDUC7    WQSG01           AR Customer Num
      * Establish starting position
     C           KRSSG     SETLL@BBREC1                    *
     C           KRSSG     READE@BBREC1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAYTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.A/R Customer Number EQ DB1.A/R Customer Number
     C           #CDUC7    IFEQ WBANC7                     *IF
      * PAR = DB1 By name
     C                     MOVELWBAYTX    #CAYTX           Customer Name
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BBREC1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Diff STC w/Sme DunsRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0023           Count USR
     C                     MOVEL'N'       YL0022           Diff STC# w/Sme
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCANC7    WQSH01           AR Customer Num
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           AR Customer Num
      * Setup key
     C                     Z-ADD#CDUC7    WQSH01           AR Customer Num
      * Establish starting position
     C           KRSSH     SETLL@BBREXJ                    *
     C           KRSSH     READE@BBREXJ                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set Diff STC# w/Sme Duns Exst=Y if Multiple Diff STC# Exists for
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.A/R Customer Number NE DB1.Ship To Customer
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CDUC7    IFNE WCBKC7                     *IF
     C           WCVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 11/06/19 DN S15503-Select Only Active Customer.
      * Rtv EDI Cust Duns Nbr2 RT - Customer EXT  * 
     C                     EXSR SIRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.EDI Cust Duns Number is NE Blank
      *   |- c2    : PAR.EDI Shipto Duns Number EQ LCL.EDI Cust Duns Numb
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFNE *BLANK                     *IF
     C           YL0012    IFEQ YL0024                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         YL0023           Count USR
      * CASE: LCL.Count USR is GT 1
     C           YL0023    IFGT 1                          *IF
     C                     MOVEL'Y'       YL0022           Diff STC# w/Sme
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BBREXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv EDI Cust Duns Nbr2 RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0024           EDI Cust Duns N
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWCBKC7    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@NEREAT              90    *
      * Data record not found
     C   90                MOVEL'USR2880' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
     C                     MOVELWAU5TX    YL0024           EDI Cust Duns N
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Dflt Whse/Cmp/Sls RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0014           Company Number
     C                     MOVEL*BLANK    WL0015           Sales Route Cod
     C                     MOVEL*BLANK    WL0016           Warehouse Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQSJ01           Ship To Custome
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0013    WQSJ01           Ship To Custome
      * Establish starting position
     C           KRSSJ     SETLL@EOREU0                    *
     C           KRSSJ     READE@EOREU0                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Default Shipping Co Sts is Yes
     C           EOQ8ST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDEOAIC3    WL0014           Company Number
     C                     MOVELEOR4CD    WL0015           Sales Route Cod
     C                     MOVELEOAJCD    WL0016           Warehouse Code
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Customer More Info RT - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #CQRU1           PM Pallet Type
     C                     MOVEL*BLANK    YL0025           Cust Dft Price
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#CAJNB    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@AAREY9              90    *
      * Data record not found
     C   90                MOVEL'USR4969' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAALWSC    #CQRU1           PM Pallet Type
     C                     MOVELAAAKAB    YL0025           Cust Dft Price
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Deliv. Times       RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0017    WDAIC3           Company Number
     C                     Z-ADDWL0018    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDR4CD    WL0019           Sales Route Cod
     C                     Z-ADDWDR5NB    WL0020           Deliver after t
     C                     Z-ADDWDR6NB    WL0021           Deliver before
     C                     Z-ADDWDMTCU    WL0022           Mileage To Cust
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Rqstd Delv Tme Dft RT - Trade Partner Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0024           Requested Delv
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           B8J5NX           EDI Trading Par
      * Setup key
     C                     MOVELWL0023    B8J5NX           EDI Trading Par
      * Establish starting position
     C           KRSSM     CHAIN@B8REVF              90    *
      * Data record not found
     C   90                MOVEL'USR4842' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB8CHSC    WL0024           Requested Delv
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv CIR Resource      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BIBKC7           Ship To Custome
     C                     KFLD           BIHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0025    BIBKC7           Ship To Custome
     C                     Z-ADDWL0026    BIHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0027           CIR Resource No
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBICOAA    WL0027           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv CIR Ref item      RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSO01           Ship To Custome
     C           *LIKE     DEFN WECOAA    WQSO02           CIR Resource No
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
     C                     KFLD           WQSO02           CIR Resource No
      * Setup key
     C                     Z-ADDWL0028    WQSO01           Ship To Custome
     C                     MOVELWL0030    WQSO02           CIR Resource No
      * Establish starting position
     C           KRSSO     SETLL@BIRECZ                    *
     C           KRSSO     READE@BIRECZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0029           Item Code
     C                     MOVEL*BLANK    WL0031           CIR UM Base Pri
     C                     GOTO SOEXIT                     *QUIT
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEHGCD    WL0029           Item Code
     C                     MOVELWELESX    WL0031           CIR UM Base Pri
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@BIRECZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg PO Dtl SBD Item #  CH - EDI Purchase Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        POC02-Chg/Resp
     C                     Z-ADD*ZERO     WN0002  90       POD Item Age Da
     C                     Z-ADD*ZERO     WN0003 114       G6801-QUANTITY
     C                     MOVEL*BLANK    WN0004  2        G6802-BASIS FOR
     C                     Z-ADD*ZERO     WN0005  74       G6803-ITEM LIST
     C                     MOVEL*BLANK    WN0006 15        G6804/P107 UPC/
     C                     MOVEL*BLANK    WN0007  2        G6805/P108 PROD
     C                     MOVEL*BLANK    WN0008 10        G6806/P109 PROD
     C                     MOVEL*BLANK    WN0009 60        G6901-ITEM DESC
     C                     MOVEL*BLANK    WN0010  2        G6807/PO110 Pro
     C                     MOVEL*BLANK    WN0011 30        G6808/PO111 Pro
     C                     MOVEL*BLANK    WN0012  2        PO112 Prod ID Q
     C                     MOVEL*BLANK    WN0013 10        PO113 Prod ID
     C                     MOVEL*BLANK    WN0014  2        P106 UPC/GTIN Q
     C                     MOVEL*BLANK    WN0015 15        POD Unused GTIN
     C                     MOVEL*BLANK    WN0016 25        POD unused text
     C                     MOVEL*BLANK    WN0017  1        POD Added to an
     C                     Z-ADD*ZERO     WN0018  70       POD unused date
     C                     MOVEL*BLANK    WN0019  2        POD Basis Unit
     C                     Z-ADD*ZERO     WN0020  50       POD Pack Qty
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @P005LD
     C                     Z-ADD#1TSCN    WFTSCN           ST02-TRANS SET
     C                     Z-ADD#1SEQX    WFSEQX           ITEM SEQUENCE N
      *
     C           KLCHSP    KLIST
     C                     KFLD           WFTSCN           ST02-TRANS SET
     C                     KFLD           WFSEQX           ITEM SEQUENCE N
     C           KLCHSP    CHAIN@P005LD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP005L0'MDACP
     C                     MOVEL'@P005LD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP01    YARDCS
      * Move non-key fields to @P005LD
     C                     Z-ADD#RICNM    WFMJVL           POD SBD Item Nu
      *
      * Set PGM.*Record Data Changed flag
     C           QECP01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@P005LD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP005L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0032    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0033           Warehouse Type
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0033           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV STNm,Add,A/R,STflgRT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#CAJNB    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSR     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #CBRTX           Customer Name
     C                     MOVELBBACNA    YL0018           Address Line 1
     C                     MOVELBBADNA    #CHONA           Address Line 2
     C                     MOVELBBAJNA    #CHNNA           City
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD#CATNB    KMAIC3           Company Number
     C                     MOVEL@CN,005   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSS     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WN0021           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Val ShipCo/Whs Active RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0064           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBWC3    WQST01           Shipping Compan
     C           *LIKE     DEFN WGAJCD    WQST02           Warehouse Code
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Shipping Compan
     C                     KFLD           WQST02           Warehouse Code
      * Setup key
     C                     Z-ADD#CATNB    WQST01           Shipping Compan
     C                     MOVEL#CAJCD    WQST02           Warehouse Code
      * Establish starting position
     C           KRSST     SETLL@ADREWA                    *
     C           KRSST     READE@ADREWA                  90*
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WGVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       YL0064           Record Found US
     C                     END                             *FI
     C           KRSST     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Val Salesperson Exist RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#CBCCD    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSU     CHAIN@APRET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YN0116           Record Found US
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YN0116           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * VAL Price Meth Exists  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IHBYST    WQSV01           System Using Pr
     C           *LIKE     DEFN IHAIC3    WQSV02           Company Number
     C           *LIKE     DEFN IHQ7CD    WQSV03           Price Method Co
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           System Using Pr
     C                     KFLD           WQSV02           Company Number
     C                     KFLD           WQSV03           Price Method Co
      * Setup key
     C                     MOVEL'O'       WQSV01           System Using Pr
     C                     Z-ADD#CATNB    WQSV02           Company Number
     C                     MOVEL#CQ7CD    WQSV03           Price Method Co
      * Establish starting position
     C           KRSSV     SETLL@IHREFI                    *
     C           KRSSV     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C           KRSSV     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val EDI PO Dtl-selctd RT - EDI Purchase Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0035           Status Flag 13
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHTSCN    WQSW01           ST02-TRANS SET
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           ST02-TRANS SET
      * Setup key
     C                     Z-ADDWL0034    WQSW01           ST02-TRANS SET
      * Establish starting position
     C           KRSSW     SETLL@P005O1                    *
     C           KRSSW     READE@P005O1                  90*
      * Data record not found
     C   90                MOVEL'USR3105' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.POD Added to an Order is Selected for Add to Ord
     C           WHNKST    IFEQ 'X'                        *IF
     C                     MOVEL'Y'       WL0035           Status Flag 13
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSW     READE@P005O1                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg don't crt ord sts CH - EDI Purchase Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0022  2        G5001-ORDER STA
     C                     Z-ADD*ZERO     WN0023  70       G5002-ORDER DAT
     C                     MOVEL*BLANK    WN0024 22        G5003-PURCHASE
     C                     MOVEL*BLANK    WN0025  2        G6101-CONTACT F
     C                     MOVEL*BLANK    WN0026 60        G6102-CONTACT N
     C                     MOVEL*BLANK    WN0027  2        G6103-COMM NUM
     C                     MOVEL*BLANK    WN0028 15        G6104-COMM NUMB
     C                     MOVEL*BLANK    WN0029 20        G6105-INQUIRY R
     C                     MOVEL*BLANK    WN0030  1        SAC01-ALLOW OR
     C                     MOVEL*BLANK    WN0031  4        SAC02-SERV PROM
     C                     Z-ADD*ZERO     WN0032 152       SAC05-$$ AMT OF
     C                     MOVEL*BLANK    WN0033  2        SAC12-ALLOW/CHG
     C                     MOVEL*BLANK    WN0034 25        SAC15-Descripti
     C                     MOVEL*BLANK    WN0035  3        DTM01-Ship Date
     C                     Z-ADD*ZERO     WN0036  70       G6202 Ship Date
     C                     MOVEL*BLANK    WN0037  3        G6201-DATE QUAL
     C                     Z-ADD*ZERO     WN0038  70       G6202-DELIVERY
     C                     MOVEL*BLANK    WN0039  2        G6601-SHIPMENT
     C                     MOVEL*BLANK    WN0040  2        G6602-METHOD TY
     C                     MOVEL*BLANK    WN0041  2        G6603-PALLET EX
     C                     MOVEL*BLANK    WN0042  2        G6604-UNIT LOAD
     C                     MOVEL*BLANK    WN0043 30        G6605-ROUTING
     C                     MOVEL*BLANK    WN0044  2        G6606-FOB POINT
     C                     Z-ADD*ZERO     WN0045 114       G7601-QUANTITY
     C                     MOVEL*BLANK    WN0046  2        G6802-BASIS FOR
     C                     Z-ADD*ZERO     WN0047 112       G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WN0048 112       G7608-ORDER AMO
     C                     MOVEL*BLANK    WN0049  1        EDI RECORD STAT
     C                     MOVEL*BLANK    WN0050  3        Customer Ref ID
     C                     MOVEL*BLANK    WN0051 30        Customer Ref ID
     C                     MOVEL*BLANK    WN0052  3        Internal Ord ID
     C                     MOVEL*BLANK    WN0053 30        Internal Order
     C                     MOVEL*BLANK    WN0054  3        Buyer ID Qualif
     C                     MOVEL*BLANK    WN0055 30        Buyer Identific
     C                     MOVEL*BLANK    WN0056  3        Reference Vs Nb
     C                     MOVEL*BLANK    WN0057 30        Ref Version Nbr
     C                     MOVEL*BLANK    WN0058  3        Revision Nbr ID
     C                     MOVEL*BLANK    WN0059 30        Revision Nbr
     C                     MOVEL*BLANK    WN0060  3        Ref ID Qualifie
     C                     MOVEL*BLANK    WN0061 30        Reference 01
     C                     MOVEL*BLANK    WN0062  3        Ref ID Qualifie
     C                     MOVEL*BLANK    WN0063 30        OH Order Number
     C                     MOVEL*BLANK    WN0064 25        Delivery PO Num
     C                     Z-ADD*ZERO     WN0065  70       POH Date Stamp
     C                     MOVEL*BLANK    WN0066  2        POH PO Purpose
     C                     MOVEL*BLANK    WN0067  6        EDI Trading Par
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @P004K9
     C                     Z-ADDWL0036    WITSCN           ST02-TRANS SET
      *
     C           KLCHSX    KLIST
     C                     KFLD           WITSCN           ST02-TRANS SET
     C           KLCHSX    CHAIN@P004K9              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP004L0'MDACP
     C                     MOVEL'@P004K9' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP02    YBRDCS
      * Move non-key fields to @P004K9
     C                     MOVELWL0037    WINLST    P      Don't Create Or
      *
      * Set PGM.*Record Data Changed flag
     C           QECP02    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@P004K9                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP004L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg EDI OH Order Nbr  CH - EDI Purchase Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0068  2        G5001-ORDER STA
     C                     Z-ADD*ZERO     WN0069  70       G5002-ORDER DAT
     C                     MOVEL*BLANK    WN0070 22        G5003-PURCHASE
     C                     MOVEL*BLANK    WN0071  2        G6101-CONTACT F
     C                     MOVEL*BLANK    WN0072 60        G6102-CONTACT N
     C                     MOVEL*BLANK    WN0073  2        G6103-COMM NUM
     C                     MOVEL*BLANK    WN0074 15        G6104-COMM NUMB
     C                     MOVEL*BLANK    WN0075 20        G6105-INQUIRY R
     C                     MOVEL*BLANK    WN0076  1        SAC01-ALLOW OR
     C                     MOVEL*BLANK    WN0077  4        SAC02-SERV PROM
     C                     Z-ADD*ZERO     WN0078 152       SAC05-$$ AMT OF
     C                     MOVEL*BLANK    WN0079  2        SAC12-ALLOW/CHG
     C                     MOVEL*BLANK    WN0080 25        SAC15-Descripti
     C                     MOVEL*BLANK    WN0081  3        DTM01-Ship Date
     C                     Z-ADD*ZERO     WN0082  70       G6202 Ship Date
     C                     MOVEL*BLANK    WN0083  3        G6201-DATE QUAL
     C                     Z-ADD*ZERO     WN0084  70       G6202-DELIVERY
     C                     MOVEL*BLANK    WN0085  2        G6601-SHIPMENT
     C                     MOVEL*BLANK    WN0086  2        G6602-METHOD TY
     C                     MOVEL*BLANK    WN0087  2        G6603-PALLET EX
     C                     MOVEL*BLANK    WN0088  2        G6604-UNIT LOAD
     C                     MOVEL*BLANK    WN0089 30        G6605-ROUTING
     C                     MOVEL*BLANK    WN0090  2        G6606-FOB POINT
     C                     Z-ADD*ZERO     WN0091 114       G7601-QUANTITY
     C                     MOVEL*BLANK    WN0092  2        G6802-BASIS FOR
     C                     Z-ADD*ZERO     WN0093 112       G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WN0094 112       G7608-ORDER AMO
     C                     MOVEL*BLANK    WN0095  1        EDI RECORD STAT
     C                     MOVEL*BLANK    WN0096  3        Customer Ref ID
     C                     MOVEL*BLANK    WN0097 30        Customer Ref ID
     C                     MOVEL*BLANK    WN0098  3        Internal Ord ID
     C                     MOVEL*BLANK    WN0099 30        Internal Order
     C                     MOVEL*BLANK    WN0100  3        Buyer ID Qualif
     C                     MOVEL*BLANK    WN0101 30        Buyer Identific
     C                     MOVEL*BLANK    WN0102  3        Reference Vs Nb
     C                     MOVEL*BLANK    WN0103 30        Ref Version Nbr
     C                     MOVEL*BLANK    WN0104  3        Revision Nbr ID
     C                     MOVEL*BLANK    WN0105 30        Revision Nbr
     C                     MOVEL*BLANK    WN0106  3        Ref ID Qualifie
     C                     MOVEL*BLANK    WN0107 30        Reference 01
     C                     MOVEL*BLANK    WN0108  3        Ref ID Qualifie
     C                     MOVEL*BLANK    WN0109 25        Delivery PO Num
     C                     MOVEL*BLANK    WN0110  1        Don't Create Or
     C                     Z-ADD*ZERO     WN0111  70       POH Date Stamp
     C                     MOVEL*BLANK    WN0112  2        POH PO Purpose
     C                     MOVEL*BLANK    WN0113  6        EDI Trading Par
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @P004K9
     C                     Z-ADDWL0038    WITSCN           ST02-TRANS SET
      *
     C           KLCHSY    KLIST
     C                     KFLD           WITSCN           ST02-TRANS SET
     C           KLCHSY    CHAIN@P004K9              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP004L0'MDACP
     C                     MOVEL'@P004K9' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP02    YCRDCS
      * Move non-key fields to @P004K9
     C                     MOVELWL0039    WIBXU1    P      OH Order Number
      *
      * Set PGM.*Record Data Changed flag
     C           QECP02    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@P004K9                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP004L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv FG Item Exists    RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#CATNB    BZAIC3           Company Number
     C                     Z-ADD#RICNM    BZHGCD           Item Code
      * Establish starting position
     C           KRSSZ     CHAIN@BZREZY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Sold 100% Frozen  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADD#CATNB    WJAIC3           Company Number
     C                     Z-ADD#RICNM    WJHGCD           Item Code
      * Establish starting position
     C           KRSTA     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0075           Sold 100 Percen
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJS4ST    YL0075           Sold 100 Percen
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Chk Pallet Typ Exists RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVEL#CQRU1    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSTB     CHAIN@B6CPIA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0064           Record Found US
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0064           Record Found US
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0040    WKAIC3           Company Number
     C                     Z-ADDWL0041    WKHGCD           Item Code
      * Establish starting position
     C           KRSTC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0042           Unit Weight
     C                     MOVEL*BLANK    WL0043           Quality Level
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIWG    WL0042           Unit Weight
     C                     MOVELWKHICD    WL0043           Quality Level
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg AddtoOrd/Itm#/AgeD CH - EDI Purchase Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0114  2        POC02-Chg/Resp
     C                     Z-ADD*ZERO     WN0115 114       G6801-QUANTITY
     C                     MOVEL*BLANK    WN0116  2        G6802-BASIS FOR
     C                     Z-ADD*ZERO     WN0117  74       G6803-ITEM LIST
     C                     MOVEL*BLANK    WN0118 15        G6804/P107 UPC/
     C                     MOVEL*BLANK    WN0119  2        G6805/P108 PROD
     C                     MOVEL*BLANK    WN0120 10        G6806/P109 PROD
     C                     MOVEL*BLANK    WN0121 60        G6901-ITEM DESC
     C                     MOVEL*BLANK    WN0122  2        G6807/PO110 Pro
     C                     MOVEL*BLANK    WN0123 30        G6808/PO111 Pro
     C                     MOVEL*BLANK    WN0124  2        PO112 Prod ID Q
     C                     MOVEL*BLANK    WN0125 10        PO113 Prod ID
     C                     MOVEL*BLANK    WN0126  2        P106 UPC/GTIN Q
     C                     MOVEL*BLANK    WN0127 15        POD Unused GTIN
     C                     MOVEL*BLANK    WN0128 25        POD unused text
     C                     Z-ADD*ZERO     WN0129  70       POD unused date
     C                     MOVEL*BLANK    WN0130  2        POD Basis Unit
     C                     Z-ADD*ZERO     WN0131  50       POD Pack Qty
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @P005LD
     C                     Z-ADD#1TSCN    WFTSCN           ST02-TRANS SET
     C                     Z-ADD#1SEQX    WFSEQX           ITEM SEQUENCE N
      *
     C           KLCHTD    KLIST
     C                     KFLD           WFTSCN           ST02-TRANS SET
     C                     KFLD           WFSEQX           ITEM SEQUENCE N
     C           KLCHTD    CHAIN@P005LD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP005L0'MDACP
     C                     MOVEL'@P005LD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QECP01    YDRDCS
      * Move non-key fields to @P005LD
     C                     Z-ADD#RCQNZ    WFS2NY           POD Item Age Da
     C                     MOVEL#RB8ST    WFNKST    P      POD Added to an
     C                     Z-ADD#RICNM    WFMJVL           POD SBD Item Nu
      *
      * Set PGM.*Record Data Changed flag
     C           QECP01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@P005LD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKECP005L0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTE01           Application Cod
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTE01           Application Cod
     C                     MOVEL'OMS'     WQTE01           Application Cod
      * Establish starting position
     C           KRSTE     SETLL@DNRESF                    *
     C           KRSTE     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C           KRSTE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTF01           Application Cod
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTF01           Application Cod
      * Establish starting position
     C           KRSTF     SETLL@DNRESF                    *
     C           KRSTF     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTF     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTG     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0053           Application WHS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0053           Application WHS
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 04352
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  17        W0CSRR  50
     C           04352     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD17        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE060
     C           ZHCSCL    ANDLE061
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CQ2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ106
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CFRSX'  YPMTFD           Shipping Temp C
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ120
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CSPOT'  YPMTFD           Spot Buy  (Y/N)
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDGE060
     C           ZHCSCL    ANDLE062
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CF7SX'  YPMTFD           OD Price Type
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDEQ098
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CNLST'  YPMTFD           Don't Create Or
     C                     END
      *
     C           ZHF4RW    IFEQ 017
     C           ZHCSCL    ANDEQ004
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#RB8ST'  YPMTFD           Status - Y or N
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1SEQX           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     P1D5VL           G6801-QUANTITY
     C                     Z-ADD*ZERO     P1PRCX           G6803-ITEM LIST
     C                     MOVEL*BLANK    P1UPCX           G6804/P107 UPC/
     C                     MOVEL*BLANK    P1PRQL           G6805/P108 PROD
     C                     MOVEL*BLANK    P1PRID           G6806/P109 PROD
     C                     MOVEL*BLANK    P1R2AA           G6807/PO110 Pro
     C                     MOVEL*BLANK    P1AOU1           G6808/PO111 Pro
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2OSDT           G5002-ORDER DAT
     C                     MOVEL*BLANK    P2J2AA           DTM01-Ship Date
     C                     Z-ADD*ZERO     P2T6DT           G6202 Ship Date
     C                     MOVEL*BLANK    P2QLFX           G6201-DATE QUAL
     C                     Z-ADD*ZERO     P2DELV           G6202-DELIVERY
     C                     MOVEL*BLANK    P2SHMT           G6601-SHIPMENT
     C                     MOVEL*BLANK    P2BXU1           OH Order Number
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P3WSST           PRT Hold Output
     C                     MOVEL*BLANK    P3WTST           PRT Save Output
     C                     Z-ADD*ZERO     P3DYNB           PRT Number of C
     C                     MOVEL*BLANK    P3WUST           PRT Night Queue
     C                     MOVEL*BLANK    P3BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P3AJNC           Customer Number
     C                     Z-ADD*ZERO     P3AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P3M8NB           System Value Nu
     C                     MOVEL*BLANK    P3T3CD           Warehouse Code
     C                     Z-ADD*ZERO     P3SHTC           Ship to Custome
     C                     Z-ADD*ZERO     P3JXQT           Quantity Ordere
     C                     Z-ADD*ZERO     P3PFWG           Weight Ordered
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5DQCD           Enterprise Code
     C                     MOVEL*BLANK    P5DRCD           Enterprise Code
     C                     MOVEL*BLANK    P5BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P5B8NA           System Date For
     C                     MOVEL*BLANK    P5AJVN           User Profile Na
     C                     MOVEL*BLANK    P5I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P5MPNA           Default Printer
     C                     MOVEL*BLANK    P5TAST           First Time Flag
     C                     MOVEL*BLANK    P5YJSX           Company Organiz
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6AIC3           Company Number
     C                     MOVEL*BLANK    P6JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P6ANC7           AR Customer Num
     C                     Z-ADD*ZERO     P6BKC7           Ship To Custome
     C                     Z-ADD*ZERO     P6A5DT           Requested Ship
     C                     Z-ADD*ZERO     P6AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P6EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P6AFTM           Requested Deliv
     C                     MOVEL*BLANK    P6Q2CD           Shipping Method
     C                     Z-ADD*ZERO     P6RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P6VDST           Load Type
     C                     MOVEL*BLANK    P6FRSX           Shipping Temp C
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P7EXDT           Market Pricing
     C                     MOVEL*BLANK    P7RDCD           Date Method Cod
     C                     MOVEL*BLANK    P7Q7CD           Price Method Co
     C                     MOVEL*BLANK    P7R1ST           OD Production P
     C                     MOVEL*BLANK    P7VEST           Palletize
     C                     MOVEL*BLANK    P7VGST           Slip Sheet
     C                     Z-ADD*ZERO     P7AVQT           Quantity Ordere
     C                     MOVEL*BLANK    P7F5SX           OD Pallet Type
     C                     MOVEL*BLANK    P7F7SX           OD Price Type
     C                     Z-ADD*ZERO     P7RINY           Item Age Days
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8C3TX           OHE Spot Buy
     C                     MOVEL*BLANK    P8LWAA           OHE Intended fo
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9AQCD           Terms Code
     C                     MOVEL*BLANK    P9R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P9PPST           P_O Required Fl
     C                     MOVEL*BLANK    P9BOCD           Type Code
     C                     Z-ADD*ZERO     P9TBNB           Absorbed Freigh
     C                     MOVEL*BLANK    P9X9ST           Outside Warehou
     C                     MOVEL*BLANK    P9LQCD           Commodity Marke
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBP3NB           D_B Number
     C                     Z-ADD*ZERO     WBI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WBAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WBVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WBI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDR5NB           Deliver after t
     C                     Z-ADD*ZERO     WDR6NB           Deliver before
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WDW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Text 7 Alpha Usr
     C                     MOVEL*BLANK    WUZ3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFTSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WFSEQX           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WFS2NY           POD Item Age Da
     C                     Z-ADD*ZERO     WFD5VL           G6801-QUANTITY
     C                     Z-ADD*ZERO     WFPRCX           G6803-ITEM LIST
     C                     Z-ADD*ZERO     WFUEDT           POD unused date
     C                     Z-ADD*ZERO     WFMJVL           POD SBD Item Nu
     C                     Z-ADD*ZERO     WFUINY           POD Pack Qty
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Order Entry Hold
     C                     MOVEL*BLANK    WUQNST  1
      * Define work field Ship To Customer Flag
     C                     MOVEL*BLANK    WURJST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field USR Remainder
     C                     Z-ADD*ZERO     WURDNB  40
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WITSCN           ST02-TRANS SET
     C                     Z-ADD*ZERO     WIOSDT           G5002-ORDER DAT
     C                     Z-ADD*ZERO     WIHUVL           SAC05-$$ AMT OF
     C                     Z-ADD*ZERO     WIT6DT           G6202 Ship Date
     C                     Z-ADD*ZERO     WIDELV           G6202-DELIVERY
     C                     Z-ADD*ZERO     WID3VL           G7601-QUANTITY
     C                     Z-ADD*ZERO     WID4VL           G7603-WEIGHT OR
     C                     Z-ADD*ZERO     WIAMTX           G7608-ORDER AMO
     C                     Z-ADD*ZERO     WIUFDT           POH Date Stamp
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Define work field Production AgeDte Fr
     C                     Z-ADD*ZERO     WUTNDT  70
      * Define work field Production AgeDte To
     C                     Z-ADD*ZERO     WUTODT  70
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     WUTIDT  70
      * Define work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     WUTJDT  70
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRWF00  40       Requested Deliv
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  90
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006 60
     C                     MOVEL*BLANK    WL0007 60
     C                     MOVEL*BLANK    WL0008 55
     C                     MOVEL*BLANK    WL0009 55
     C                     MOVEL*BLANK    WL0010 20
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012 15
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016  3
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020  40
     C                     Z-ADD*ZERO     WL0021  40
     C                     Z-ADD*ZERO     WL0022  92
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0023  6
     C                     MOVEL*BLANK    WL0024  2
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027 14
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030 14
     C                     MOVEL*BLANK    WL0031  2
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  2
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0034  90
     C                     MOVEL*BLANK    WL0035  1
      * Define local variables for subroutine SXCHRC.
     C                     Z-ADD*ZERO     WL0036  90
     C                     MOVEL*BLANK    WL0037  1
      * Define local variables for subroutine SYCHRC.
     C                     Z-ADD*ZERO     WL0038  90
     C                     MOVEL*BLANK    WL0039 30
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042 112
     C                     MOVEL*BLANK    WL0043  2
      * Define null work field G5001-ORDER STATUS CODE
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define null work field G6101-CONTACT FUNCTION CO
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field G6102-CONTACT NAME
     C                     MOVEL*BLANK    YN0003 60
      * Define null work field G6103-COMM NUM QUALIFIER
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field G6104-COMM NUMBER
     C                     MOVEL*BLANK    YN0005 15
      * Define null work field G6105-INQUIRY REFERENCE
     C                     MOVEL*BLANK    YN0006 20
      * Define null work field SAC01-ALLOW OR CHG INDICA
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field SAC02-SERV PROMO ALLO OR
     C                     MOVEL*BLANK    YN0008  4
      * Define null work field SAC05-$$ AMT OF ALLOW/CHG
     C                     Z-ADD*ZERO     YN0009 152
      * Define null work field SAC12-ALLOW/CHG CODE
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field SAC15-Description
     C                     MOVEL*BLANK    YN0011 25
      * Define local work field DTM01-Ship Date Qualifier
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field G6201-DATE QUALIFIER
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field G6601-SHIPMENT METHOD
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field G6602-METHOD TYPE CODE
     C                     MOVEL*BLANK    YL0006  2
      * Define null work field G6603-PALLET EXCHANGE COD
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field G6604-UNIT LOAD OPTION CO
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field G6605-ROUTING
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field G6606-FOB POINT CODE
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field G6802-BASIS FOR MEASUREME
     C                     MOVEL*BLANK    YN0016  2
      * Define null work field G7608-ORDER AMOUNT
     C                     Z-ADD*ZERO     YN0017 112
      * Define null work field EDI RECORD STATUS
     C                     MOVEL*BLANK    YN0018  1
      * Define local work field Customer Ref ID Qualifier
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Customer Ref ID
     C                     MOVEL*BLANK    YL0008 30
      * Define null work field Internal Ord ID Qualifier
     C                     MOVEL*BLANK    YN0019  3
      * Define null work field Internal Order number
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field Buyer ID Qualifier
     C                     MOVEL*BLANK    YN0021  3
      * Define null work field Buyer Identification
     C                     MOVEL*BLANK    YN0022 30
      * Define null work field Reference Vs Nbr ID Qual
     C                     MOVEL*BLANK    YN0023  3
      * Define null work field Ref Version Nbr
     C                     MOVEL*BLANK    YN0024 30
      * Define null work field Revision Nbr ID Qualifier
     C                     MOVEL*BLANK    YN0025  3
      * Define null work field Revision Nbr
     C                     MOVEL*BLANK    YN0026 30
      * Define null work field Ref ID Qualifier 01
     C                     MOVEL*BLANK    YN0027  3
      * Define null work field Reference 01
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field Ref ID Qualifier 02
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field POH Date Stamp received
     C                     Z-ADD*ZERO     YN0030  70
      * Define null work field POH PO Purpose cde-OO
     C                     MOVEL*BLANK    YN0031  2
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field N102-NAME
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field N103-ID CODE QUALIFIER
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field EDI Shipto Duns Number
     C                     MOVEL*BLANK    YL0012 20
      * Define null work field N201-NAME
     C                     MOVEL*BLANK    YN0032 60
      * Define null work field N202-NAME
     C                     MOVEL*BLANK    YN0033 60
      * Define null work field N302-ADDRESS
     C                     MOVEL*BLANK    YN0034 55
      * Define null work field N403-POSTAL CODE
     C                     MOVEL*BLANK    YN0035 15
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0036 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0037 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0038 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0039 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0040 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0041  2
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0042 11
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0043 25
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0013  70
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0044  1
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field EDI Trading Partner No
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0016  4
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Address Line 1
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0019 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0045 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0020 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0046  2
      * Define null work field County Code
     C                     MOVEL*BLANK    YN0047  6
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0048 11
      * Define null work field Telephone Number FF
     C                     MOVEL*BLANK    YN0049 25
      * Define null work field Fax Number FF
     C                     MOVEL*BLANK    YN0050 25
      * Define null work field Alpha Search
     C                     MOVEL*BLANK    YN0051 25
      * Define null work field Federal Tax Id
     C                     MOVEL*BLANK    YN0052 20
      * Define null work field New Customer Status
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field SIC Number
     C                     MOVEL*BLANK    YN0054  8
      * Define null work field D_B Number
     C                     Z-ADD*ZERO     YN0055  90
      * Define null work field D_B Rating
     C                     MOVEL*BLANK    YN0056  5
      * Define null work field Date of D_B Rating
     C                     Z-ADD*ZERO     YN0057  70
      * Define null work field Credit Line Expire Date
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field Parent Customer
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field Credit Check AR Customer
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Credit Check Parent Cust
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0062  6
      * Define null work field EDI Invoice Sts
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Order Entry Hold
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Parent Credit Limit
     C                     Z-ADD*ZERO     YN0065 112
      * Define null work field AR Credit Limit
     C                     Z-ADD*ZERO     YN0066 112
      * Define null work field Order Entry Hold Date
     C                     Z-ADD*ZERO     YN0067  70
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0021  1
      * Define null work field Field vs In_House flag
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Email When Order Shipped
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Print Invoice Sts
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Item Reference Status
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Statement Print Frequency
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0077  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0078 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0079 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0080  70
      * Define local work field Diff STC# w/Sme Duns Exst
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0023  50
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0024 20
      * Define local work field Cust Dft Price Type
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Deliver after time
     C                     Z-ADD*ZERO     YL0026  40
      * Define local work field Deliver before time
     C                     Z-ADD*ZERO     YL0027  40
      * Define local work field Mileage To Customer
     C                     Z-ADD*ZERO     YL0028  92
      * Define local work field Item Age Days Fresh
     C                     Z-ADD*ZERO     YL0029  40
      * Define local work field Item Age Days Frozen
     C                     Z-ADD*ZERO     YL0030  40
      * Define local work field Requested Delv Time Dflt
     C                     MOVEL*BLANK    YL0031  2
      * Define null work field N103-ID CODE QUALIFIER
     C                     MOVEL*BLANK    YN0081  2
      * Define local work field N104-ID CODE
     C                     MOVEL*BLANK    YL0032 20
      * Define null work field N301-ADD
     C                     MOVEL*BLANK    YN0082 55
      * Define null work field N401-CITY
     C                     MOVEL*BLANK    YN0083 20
      * Define null work field N402-STATE
     C                     MOVEL*BLANK    YN0084  2
      * Define null work field Shipping Method Dft
     C                     MOVEL*BLANK    YN0085  2
      * Define null work field LTL Flag Dft
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Export Status Dft
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Shrink Wrap Dft
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Export Code Dft
     C                     MOVEL*BLANK    YN0089  6
      * Define local work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    YL0033  1
      * Define null work field Allow Multi Export On Ord
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Slip Sheet Dft
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Palletize Dft
     C                     MOVEL*BLANK    YN0092  1
      * Define local work field OD Price Type Req STS USR
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field SEC Default Sales Channel
     C                     MOVEL*BLANK    YL0035  2
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0036  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0093  2
      * Define local work field Cust Shipping Temp
     C                     Z-ADD*ZERO     YL0037  52
      * Define local work field Cust Shipping Temp C_F
     C                     MOVEL*BLANK    YL0038  1
      * Define null work field Ship To Warehouse
     C                     MOVEL*BLANK    YN0094  3
      * Define local work field Warehouse Code SavUsr
     C                     MOVEL*BLANK    YL0039  3
      * Define local work field Order Number Alpha
     C                     MOVEL*BLANK    YL0040  7
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0041  70
      * Define null work field OHE HPB RIN Equiv Value
     C                     Z-ADD*ZERO     YN0095 112
      * Define null work field OHE HPB RIN Price
     C                     Z-ADD*ZERO     YN0096 112
      * Define null work field OHE Override Type Code
     C                     MOVEL*BLANK    YN0097  2
      * Define local work field Delivery P_O  Number
     C                     MOVEL*BLANK    YL0042 38
      * Define null work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YN0098  6
      * Define null work field OHE Appt Confirmation #
     C                     MOVEL*BLANK    YN0099 10
      * Define null work field OHE Appt Confirmation Nm
     C                     MOVEL*BLANK    YN0100 30
      * Define null work field Letter of Credit Number
     C                     MOVEL*BLANK    YN0101 50
      * Define local work field USR Update Flag
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field Item Code Exist USR
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field CIR Resource No
     C                     MOVEL*BLANK    YL0045 14
      * Define local work field USR Item Code 7,0 signed
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Item Code Number 7.0  USR
     C                     Z-ADD*ZERO     YL0047  70
      * Define null work field CIR UM Base Price
     C                     MOVEL*BLANK    YN0102  2
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field USR Display field
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field USR Display 4
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0051  30
      * Define local work field Don't Create Order Reason
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Pallet Type NOREF
     C                     MOVEL*BLANK    YL0054  2
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0055  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0056  30
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0103  2
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0057  3
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0104 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0105 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0106  3
      * Define null work field P_O Required Flag
     C                     MOVEL*BLANK    YN0107  1
      * Define null work field Deliver after time
     C                     Z-ADD*ZERO     YN0108  40
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0109  52
      * Define null work field Outside Warehouse Flag
     C                     MOVEL*BLANK    YN0110  1
      * Define null work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YN0111  1
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0112  70
      * Define null work field Ship To Customer Flag
     C                     MOVEL*BLANK    YN0113  1
      * Define local work field Ship To Customer SavUsr
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0060  3
      * Define local work field Manager Level Code
     C                     MOVEL*BLANK    YL0061  2
      * Define local work field VP Level Code
     C                     MOVEL*BLANK    YL0062  3
      * Define null work field Item Age Days Fresh
     C                     Z-ADD*ZERO     YN0114  40
      * Define null work field Item Age Days Frozen
     C                     Z-ADD*ZERO     YN0115  40
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0063  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0064  1
      * Define null work field Record Found USR
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field Price Method Description
     C                     MOVEL*BLANK    YN0117 30
      * Define local work field Status Flag 13 Y/N
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field Order Number Saved USR
     C                     Z-ADD*ZERO     YL0066  70
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0067 155
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0068 10
      * Define local work field ITEM SEQUENCE NUMBER
     C                     Z-ADD*ZERO     YL0069  30
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0070 155
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field OH Order Number
     C                     MOVEL*BLANK    YL0072 30
      * Define local work field Process Control
     C                     MOVEL*BLANK    YL0073  1
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0074 80
      * Define local work field Sold 100 Percent Frozen
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0076  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0077 112
      * Define null work field Quality Level
     C                     MOVEL*BLANK    YN0118  2
      * Define local work field Weight Ordered Tot Usr
     C                     Z-ADD*ZERO     YL0078 112
      * Define local work field Exit requested Y/N
     C                     MOVEL*BLANK    YL0079  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD07        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Set Inter. Access  XF - User Profile Control  * 
     C                     CALL 'PDSKXFR'              90  VAL Set Inter.
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0171  3        Warehouse Code
     C           WUAIC3    PARM *ZERO     WQ0172  30       Company Number
     C                     PARM 'OMS'     WQ0173  6        Application Cod
     C           P5BCCD    PARM *BLANK    WQ0174  3        Salesperson Cod
     C           P5I6ST    PARM *BLANK    WQ0175  1        Allow Multi_Com
     C           P5MPNA    PARM *BLANK    WQ0176 10        Default Printer
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TERVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P5TAST           First Time Flag
     C                     MOVEL'N'       YL0049           USR Display fie
     C                     MOVEL'N'       P3WUST           PRT Night Queue
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR TGRVGN
     C                     MOVEL'N'       YL0079           Exit requested
     C                     MOVEL'Y'       YL0044           Item Code Exist
     C                     Z-ADD*ZERO     YL0058           Ship To Custome
      * W84569 DN 12/01/21-Initialize Order Number Saved USR.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0066           Order Number Sa
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01048010970113101304013870156001582
01643018170189902073020840232902340
02372024040258502596028410309703132
03170031780335303388033990342603448
03452036090364403682036860435604363
04368043820438704399044160442504457
0446704471
** W0END
01069011050113601343013980157901583
01654018410190802079021130233502369
02401024230258702625028430309903133
03176031780336003395034020342703448
03456036110364603682037070435604363
04379043830439604413044220445404464
0446804473
** W0NAM
#CPONO    #2TSCN    #CJ5NX    #CDD1X    #CJXQT    #CITYX    #CTATE
#CPFWG    #CYDT1    #CBXU1    VCDUC7    #CAYTX    #CAJNB    #CBRTX
#CHONA    #CHNNA    #CATNB    #CAGTX    #CAJCD    #CBCCD    #CQ2CD
#CRNNB    #CFRSX    VCA5DT    VCEIDT    #CAFTM    #CQRU1    #CSPOT
#CQIU1    #CQ7CD    #CF7SX    #CNLST    #CESNA    #RB8ST    #1NKST
#1D5VL    #1PRQL    #1PRID    #1UPCX    #RICNM    #1DESC    #1PRCX
#1UNIT    #RCQNZ
** @CN
00001 ODPRCTYPRQ
00002 * Internal Company *
00003 * 3rd Party *
00004 *zeros
00005 FZNCHLTME
00006 Y2U0005
00007 Deny PO Reason is entered
00008 . Add to Order not
00009 allowed.
00010 Item Number must be enter
00011 Item Age Days must be ent
00012 Item Age Days cannot be n
00013 egative.
