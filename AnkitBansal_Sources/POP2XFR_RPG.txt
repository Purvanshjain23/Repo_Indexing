     H/TITLE UPS Re-Alc Inv/Prod   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/04/13  Time  : 14:45:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FOPBGWKLIIF  E           K        DISK
      * RSQ : Order Detail              Co/SSD/Ord/Sq/SSq Opn
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKNCPL9IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-d Rlc
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPOB5CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WAAIC3
     I              B5C4NB                          WAC4NB
     I              B5DPNB                          WADPNB
     I              B5UENB                          WAUENB
     I              B5JGDT                          WAJGDT
     I              B5AODT                          WAAODT
     I              B5AJCD                          WAAJCD
     I              B5HGCD                          WAHGCD
     I              B5IUQT                          WAIUQT
     I              B5F3WG                          WAF3WG
     I              B5UVST                          WAUVST
     I              B5UWST                          WAUWST
     I              B5UXST                          WAUXST
     I              B5VSST                          WAVSST
     I              B5AATM                          WAAATM
     I              B5AYNA                          WAAYNA
     I              B5A0NA                          WAA0NA
     I              B5AXDT                          WAAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WBAIC3
     I              B5C4NB                          WBC4NB
     I              B5DPNB                          WBDPNB
     I              B5UENB                          WBUENB
     I              B5JGDT                          WBJGDT
     I              B5AODT                          WBAODT
     I              B5AJCD                          WBAJCD
     I              B5HGCD                          WBHGCD
     I              B5IUQT                          WBIUQT
     I              B5F3WG                          WBF3WG
     I              B5UVST                          WBUVST
     I              B5UWST                          WBUWST
     I              B5UXST                          WBUXST
     I              B5VSST                          WBVSST
     I              B5AATM                          WBAATM
     I              B5AYNA                          WBAYNA
     I              B5A0NA                          WBA0NA
     I              B5AXDT                          WBAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WCAIC3
     I              KNC4NB                          WCC4NB
     I              KNDPNB                          WCDPNB
     I              KNUENB                          WCUENB
     I              KNJGDT                          WCJGDT
     I              KNAODT                          WCAODT
     I              KNAJCD                          WCAJCD
     I              KNAYAA                          WCAYAA
     I              KNHGCD                          WCHGCD
     I              KNIGQT                          WCIGQT
     I              KNFLWG                          WCFLWG
     I              KNIUQT                          WCIUQT
     I              KNF3WG                          WCF3WG
     I              KNIVQT                          WCIVQT
     I              KNF4WG                          WCF4WG
     I              KNP7ST                          WCP7ST
     I              KNP8ST                          WCP8ST
     I              KNQAST                          WCQAST
     I              KNUVST                          WCUVST
     I              KNUWST                          WCUWST
     I              KNUXST                          WCUXST
     I              KNVSST                          WCVSST
     I              KNAATM                          WCAATM
     I              KNAYNA                          WCAYNA
     I              KNA0NA                          WCA0NA
     I              KNAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WFAIC3
     I              B6C4NB                          WFC4NB
     I              B6DPNB                          WFDPNB
     I              B6UENB                          WFUENB
     I              B6JGDT                          WFJGDT
     I              B6OONY                          WFOONY
     I              B6AODT                          WFAODT
     I              B6AJCD                          WFAJCD
     I              B6NUDT                          WFNUDT
     I              B6HGCD                          WFHGCD
     I              B6IGQT                          WFIGQT
     I              B6FLWG                          WFFLWG
     I              B6NSQT                          WFNSQT
     I              B6JQWG                          WFJQWG
     I              B6NVDT                          WFNVDT
     I              B6BUTM                          WFBUTM
     I              B6UVST                          WFUVST
     I              B6UWST                          WFUWST
     I              B6UXST                          WFUXST
     I              B6VSST                          WFVSST
     I              B6AATM                          WFAATM
     I              B6AYNA                          WFAYNA
     I              B6A0NA                          WFA0NA
     I              B6AXDT                          WFAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     I@BGWKKJ
      * Order Detail              Co/SSD/Ord/Sq/SSq Opn
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WIAIC3
     I              BZHGCD                          WIHGCD
     I              BZAVNA                          WIAVNA
     I              BZAWNA                          WIAWNA
     I              BZL7NA                          WIL7NA
     I              BZL8NA                          WIL8NA
     I              BZL6NA                          WIL6NA
     I              BZMFNA                          WIMFNA
     I              BZADCD                          WIADCD
     I              BZAWPC                          WIAWPC
     I              BZLXST                          WILXST
     I              BZAECD                          WIAECD
     I              BZAXPC                          WIAXPC
     I              BZLYST                          WILYST
     I              BZAFCD                          WIAFCD
     I              BZAICD                          WIAICD
     I              BZAIWG                          WIAIWG
     I              BZHICD                          WIHICD
     I              BZRBCD                          WIRBCD
     I              BZFZST                          WIFZST
     I              BZAVST                          WIAVST
     I              BZCZWG                          WICZWG
     I              BZC0WG                          WIC0WG
     I              BZURTN                          WIURTN
     I              BZAJC8                          WIAJC8
     I              BZRINB                          WIRINB
     I              BZRHNB                          WIRHNB
     I              BZRGNB                          WIRGNB
     I              BZLNCD                          WILNCD
     I              BZTFNB                          WITFNB
     I              BZN0CD                          WIN0CD
     I              BZX4ST                          WIX4ST
     I              BZTMVA                          WITMVA
     I              BZTNVA                          WITNVA
     I              BZBLPR                          WIBLPR
     I              BZBMPR                          WIBMPR
     I              BZLRCD                          WILRCD
     I              BZU9ST                          WIU9ST
     I              BZCMCO                          WICMCO
     I              BZQ1CD                          WIQ1CD
     I              BZQ8CD                          WIQ8CD
     I              BZCHTM                          WICHTM
     I              BZQZCD                          WIQZCD
     I              BZXWST                          WIXWST
     I              BZXXST                          WIXXST
     I              BZVMST                          WIVMST
     I              BZSWGH                          WISWGH
     I              BZPPHE                          WIPPHE
     I              BZR3CD                          WIR3CD
     I              BZSDCD                          WISDCD
     I              BZICN1                          WIICN1
     I              BZSVCD                          WISVCD
     I              BZICN2                          WIICN2
     I              BZSWCD                          WISWCD
     I              BZV2NB                          WIV2NB
     I              BZSXCD                          WISXCD
     I              BZITCN                          WIITCN
     I              BZSYCD                          WISYCD
     I              BZITC5                          WIITC5
     I              BZSZCD                          WISZCD
     I              BZICN6                          WIICN6
     I              BZS0CD                          WIS0CD
     I              BZICN7                          WIICN7
     I              BZS1CD                          WIS1CD
     I              BZICN8                          WIICN8
     I              BZS2CD                          WIS2CD
     I              BZICN9                          WIICN9
     I              BZS3CD                          WIS3CD
     I              BZICN0                          WIICN0
     I              BZS4CD                          WIS4CD
     I              BZSFNB                          WISFNB
     I              BZA3WG                          WIA3WG
     I              BZSJNB                          WISJNB
     I              BZLLCD                          WILLCD
     I              BZLMCD                          WILMCD
     I              BZP3ST                          WIP3ST
     I              BZSKNB                          WISKNB
     I              BZSLNB                          WISLNB
     I              BZSMNB                          WISMNB
     I              BZP4ST                          WIP4ST
     I              BZCFNB                          WICFNB
     I              BZCGNB                          WICGNB
     I              BZILNB                          WIILNB
     I              BZCHNB                          WICHNB
     I              BZCINB                          WICINB
     I              BZCJNB                          WICJNB
     I              BZCMNB                          WICMNB
     I              BZCNNB                          WICNNB
     I              BZCRNB                          WICRNB
     I              BZCSNB                          WICSNB
     I              BZCVNB                          WICVNB
     I              BZCWNB                          WICWNB
     I              BZCXNB                          WICXNB
     I              BZCZNB                          WICZNB
     I              BZC0NB                          WIC0NB
     I              BZN1CD                          WIN1CD
     I              BZB4NB                          WIB4NB
     I              BZB5NB                          WIB5NB
     I              BZX5ST                          WIX5ST
     I              BZX6ST                          WIX6ST
     I              BZX7ST                          WIX7ST
     I              BZPCCT                          WIPCCT
     I              BZBDNB                          WIBDNB
     I              BZBJNB                          WIBJNB
     I              BZSUST                          WISUST
     I              BZSVST                          WISVST
     I              BZSYST                          WISYST
     I              BZSZST                          WISZST
     I              BZS1ST                          WIS1ST
     I              BZXRCD                          WIXRCD
     I              BZXTCD                          WIXTCD
     I              BZXUCD                          WIXUCD
     I              BZF5WG                          WIF5WG
     I              BZF6WG                          WIF6WG
     I              BZF7WG                          WIF7WG
     I              BZBLNB                          WIBLNB
     I              BZBNNB                          WIBNNB
     I              BZS2ST                          WIS2ST
     I              BZS4ST                          WIS4ST
     I              BZS5ST                          WIS5ST
     I              BZS6ST                          WIS6ST
     I              BZS8ST                          WIS8ST
     I              BZS9ST                          WIS9ST
     I              BZTCST                          WITCST
     I              BZTDST                          WITDST
     I              BZUVST                          WIUVST
     I              BZUWST                          WIUWST
     I              BZUXST                          WIUXST
     I              BZVSST                          WIVSST
     I              BZAATM                          WIAATM
     I              BZAYNA                          WIAYNA
     I              BZA0NA                          WIA0NA
     I              BZAXDT                          WIAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WJAJCD
     I              ADF8NA                          WJF8NA
     I              ADACNA                          WJACNA
     I              ADADNA                          WJADNA
     I              ADAENA                          WJAENA
     I              ADAJNA                          WJAJNA
     I              ADBTTX                          WJBTTX
     I              ADAOCD                          WJAOCD
     I              ADBGCD                          WJBGCD
     I              ADVHST                          WJVHST
     I              ADMPNA                          WJMPNA
     I              ADWPST                          WJWPST
     I              ADXUST                          WJXUST
     I              ADT0ST                          WJT0ST
     I              ADT1ST                          WJT1ST
     I              ADDBNB                          WJDBNB
     I              ADT2ST                          WJT2ST
     I              ADT3ST                          WJT3ST
     I              ADT4ST                          WJT4ST
     I              ADT6ST                          WJT6ST
     I              ADBWC3                          WJBWC3
     I              ADBTC3                          WJBTC3
     I              ADBUC3                          WJBUC3
     I              ADBVC3                          WJBVC3
     I              ADFCAA                          WJFCAA
     I              ADRQSX                          WJRQSX
     I              ADRRSX                          WJRRSX
     I              ADRSSX                          WJRSSX
     I              ADRTSX                          WJRTSX
     I              ADT7ST                          WJT7ST
     I              ADT8ST                          WJT8ST
     I              ADRNSX                          WJRNSX
     I              ADROSX                          WJROSX
     I              ADRPSX                          WJRPSX
     I              ADUVST                          WJUVST
     I              ADUWST                          WJUWST
     I              ADUXST                          WJUXST
     I              ADVSST                          WJVSST
     I              ADAATM                          WJAATM
     I              ADAYNA                          WJAYNA
     I              ADA0NA                          WJA0NA
     I              ADAXDT                          WJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@KNCPNF
      * Order Detail Schedule     Co/Ord/Seq/Ssq/PDt-d Rlc
      * Renamed input format fields
     I              KNAIC3                          WLAIC3
     I              KNC4NB                          WLC4NB
     I              KNDPNB                          WLDPNB
     I              KNUENB                          WLUENB
     I              KNJGDT                          WLJGDT
     I              KNAODT                          WLAODT
     I              KNAJCD                          WLAJCD
     I              KNAYAA                          WLAYAA
     I              KNHGCD                          WLHGCD
     I              KNIGQT                          WLIGQT
     I              KNFLWG                          WLFLWG
     I              KNIUQT                          WLIUQT
     I              KNF3WG                          WLF3WG
     I              KNIVQT                          WLIVQT
     I              KNF4WG                          WLF4WG
     I              KNP7ST                          WLP7ST
     I              KNP8ST                          WLP8ST
     I              KNQAST                          WLQAST
     I              KNUVST                          WLUVST
     I              KNUWST                          WLUWST
     I              KNUXST                          WLUXST
     I              KNVSST                          WLVSST
     I              KNAATM                          WLAATM
     I              KNAYNA                          WLAYNA
     I              KNA0NA                          WLA0NA
     I              KNAXDT                          WLAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WMAIC3
     I              AFBCDT                          WMBCDT
     I              AFCQNB                          WMCQNB
     I              AFESNB                          WMESNB
     I              AFETNB                          WMETNB
     I              AFBZNB                          WMBZNB
     I              AFA9ST                          WMA9ST
     I              AFEINB                          WMEINB
     I              AFC5ST                          WMC5ST
     I              AFAQNB                          WMAQNB
     I              AFCMST                          WMCMST
     I              AFV9ST                          WMV9ST
     I              AFWAST                          WMWAST
     I              AFX2ST                          WMX2ST
     I              AFOJDT                          WMOJDT
     I              AFNQNX                          WMNQNX
     I              AFNRNX                          WMNRNX
     I              AFI9SX                          WMI9SX
     I              AFJASX                          WMJASX
     I              AFOKDT                          WMOKDT
     I              AFOLDT                          WMOLDT
     I              AFUVST                          WMUVST
     I              AFUWST                          WMUWST
     I              AFUXST                          WMUXST
     I              AFAATM                          WMAATM
     I              AFAYNA                          WMAYNA
     I              AFA0NA                          WMA0NA
     I              AFAXDT                          WMAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WOAIC3
     I              CWHGCD                          WOHGCD
     I              CWAJCD                          WOAJCD
     I              CWELDT                          WOELDT
     I              CWACWG                          WOACWG
     I              CWARQT                          WOARQT
     I              CWK7DT                          WOK7DT
     I              CWUVST                          WOUVST
     I              CWUWST                          WOUWST
     I              CWUXST                          WOUXST
     I              CWVSST                          WOVSST
     I              CWAATM                          WOAATM
     I              CWAYNA                          WOAYNA
     I              CWA0NA                          WOA0NA
     I              CWAXDT                          WOAXDT
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WRAIC3
     I              B5C4NB                          WRC4NB
     I              B5DPNB                          WRDPNB
     I              B5UENB                          WRUENB
     I              B5JGDT                          WRJGDT
     I              B5AODT                          WRAODT
     I              B5AJCD                          WRAJCD
     I              B5HGCD                          WRHGCD
     I              B5IUQT                          WRIUQT
     I              B5F3WG                          WRF3WG
     I              B5UVST                          WRUVST
     I              B5UWST                          WRUWST
     I              B5UXST                          WRUXST
     I              B5VSST                          WRVSST
     I              B5AATM                          WRAATM
     I              B5AYNA                          WRAYNA
     I              B5A0NA                          WRA0NA
     I              B5AXDT                          WRAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WSAIC3
     I              I8V5ST                          WSV5ST
     I              I8ELDT                          WSELDT
     I              I8HGCD                          WSHGCD
     I              I8AJCD                          WSAJCD
     I              I8GPDT                          WSGPDT
     I              I8WTSP                          WSWTSP
     I              I8QTSP                          WSQTSP
     I              I8DJPC                          WSDJPC
     I              I8F8WG                          WSF8WG
     I              I8WTIN                          WSWTIN
     I              I8D5NB                          WSD5NB
     I              I8DXWG                          WSDXWG
     I              I8B2NB                          WSB2NB
     I              I8WTCN                          WSWTCN
     I              I8PSCV                          WSPSCV
     I              I8SAWT                          WSSAWT
     I              I8B9NB                          WSB9NB
     I              I8D1WG                          WSD1WG
     I              I8CBNB                          WSCBNB
     I              I8EZWG                          WSEZWG
     I              I8CCNB                          WSCCNB
     I              I8E0WG                          WSE0WG
     I              I8D6NB                          WSD6NB
     I              I8OAWT                          WSOAWT
     I              I8CDNB                          WSCDNB
     I              I8UNW2                          WSUNW2
     I              I8CENB                          WSCENB
     I              I8F9WG                          WSF9WG
     I              I8BPNB                          WSBPNB
     I              I8GAWG                          WSGAWG
     I              I8BQNB                          WSBQNB
     I              I8GBWG                          WSGBWG
     I              I8BRNB                          WSBRNB
     I              I8GCWG                          WSGCWG
     I              I8BSNB                          WSBSNB
     I              I8GDWG                          WSGDWG
     I              I8BWNB                          WSBWNB
     I              I8GEWG                          WSGEWG
     I              I8PS6U                          WSPS6U
     I              I8WCST                          WSWCST
     I              I8WPST                          WSWPST
     I              I8B5ST                          WSB5ST
     I              I8TFST                          WSTFST
     I              I8TEST                          WSTEST
     I              I8THST                          WSTHST
     I              I8UDST                          WSUDST
     I              I8UFST                          WSUFST
     I              I8UGST                          WSUGST
     I              I8UHST                          WSUHST
     I              I8B6ST                          WSB6ST
     I              I8B7ST                          WSB7ST
     I              I8DVWG                          WSDVWG
     I              I8D7NB                          WSD7NB
     I              I8FCAD                          WSFCAD
     I              I8D9NB                          WSD9NB
     I              I8DWWG                          WSDWWG
     I              I8EANB                          WSEANB
     I              I8SHWT                          WSSHWT
     I              I8EBNB                          WSEBNB
     I              I8AVWT                          WSAVWT
     I              I8ECNB                          WSECNB
     I              I8WTON                          WSWTON
     I              I8EDNB                          WSEDNB
     I              I8FNWT                          WSFNWT
     I              I8EENB                          WSEENB
     I              I8QTAS                          WSQTAS
     I              I8EFNB                          WSEFNB
     I              I8WAIO                          WSWAIO
     I              I8EGNB                          WSEGNB
     I              I8R3CD                          WSR3CD
     I              I8RGNB                          WSRGNB
     I              I8RHNB                          WSRHNB
     I              I8RINB                          WSRINB
     I              I8XRCD                          WSXRCD
     I              I8UVST                          WSUVST
     I              I8UWST                          WSUWST
     I              I8UXST                          WSUXST
     I              I8VSST                          WSVSST
     I              I8AATM                          WSAATM
     I              I8AYNA                          WSAYNA
     I              I8A0NA                          WSA0NA
     I              I8AXDT                          WSAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WTAIC3
     I              I8V5ST                          WTV5ST
     I              I8ELDT                          WTELDT
     I              I8HGCD                          WTHGCD
     I              I8AJCD                          WTAJCD
     I              I8GPDT                          WTGPDT
     I              I8WTSP                          WTWTSP
     I              I8QTSP                          WTQTSP
     I              I8DJPC                          WTDJPC
     I              I8F8WG                          WTF8WG
     I              I8WTIN                          WTWTIN
     I              I8D5NB                          WTD5NB
     I              I8DXWG                          WTDXWG
     I              I8B2NB                          WTB2NB
     I              I8WTCN                          WTWTCN
     I              I8PSCV                          WTPSCV
     I              I8SAWT                          WTSAWT
     I              I8B9NB                          WTB9NB
     I              I8D1WG                          WTD1WG
     I              I8CBNB                          WTCBNB
     I              I8EZWG                          WTEZWG
     I              I8CCNB                          WTCCNB
     I              I8E0WG                          WTE0WG
     I              I8D6NB                          WTD6NB
     I              I8OAWT                          WTOAWT
     I              I8CDNB                          WTCDNB
     I              I8UNW2                          WTUNW2
     I              I8CENB                          WTCENB
     I              I8F9WG                          WTF9WG
     I              I8BPNB                          WTBPNB
     I              I8GAWG                          WTGAWG
     I              I8BQNB                          WTBQNB
     I              I8GBWG                          WTGBWG
     I              I8BRNB                          WTBRNB
     I              I8GCWG                          WTGCWG
     I              I8BSNB                          WTBSNB
     I              I8GDWG                          WTGDWG
     I              I8BWNB                          WTBWNB
     I              I8GEWG                          WTGEWG
     I              I8PS6U                          WTPS6U
     I              I8WCST                          WTWCST
     I              I8WPST                          WTWPST
     I              I8B5ST                          WTB5ST
     I              I8TFST                          WTTFST
     I              I8TEST                          WTTEST
     I              I8THST                          WTTHST
     I              I8UDST                          WTUDST
     I              I8UFST                          WTUFST
     I              I8UGST                          WTUGST
     I              I8UHST                          WTUHST
     I              I8B6ST                          WTB6ST
     I              I8B7ST                          WTB7ST
     I              I8DVWG                          WTDVWG
     I              I8D7NB                          WTD7NB
     I              I8FCAD                          WTFCAD
     I              I8D9NB                          WTD9NB
     I              I8DWWG                          WTDWWG
     I              I8EANB                          WTEANB
     I              I8SHWT                          WTSHWT
     I              I8EBNB                          WTEBNB
     I              I8AVWT                          WTAVWT
     I              I8ECNB                          WTECNB
     I              I8WTON                          WTWTON
     I              I8EDNB                          WTEDNB
     I              I8FNWT                          WTFNWT
     I              I8EENB                          WTEENB
     I              I8QTAS                          WTQTAS
     I              I8EFNB                          WTEFNB
     I              I8WAIO                          WTWAIO
     I              I8EGNB                          WTEGNB
     I              I8R3CD                          WTR3CD
     I              I8RGNB                          WTRGNB
     I              I8RHNB                          WTRHNB
     I              I8RINB                          WTRINB
     I              I8XRCD                          WTXRCD
     I              I8UVST                          WTUVST
     I              I8UWST                          WTUWST
     I              I8UXST                          WTUXST
     I              I8VSST                          WTVSST
     I              I8AATM                          WTAATM
     I              I8AYNA                          WTAYNA
     I              I8A0NA                          WTA0NA
     I              I8AXDT                          WTAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WVAJCD
     I              ADF8NA                          WVF8NA
     I              ADACNA                          WVACNA
     I              ADADNA                          WVADNA
     I              ADAENA                          WVAENA
     I              ADAJNA                          WVAJNA
     I              ADBTTX                          WVBTTX
     I              ADAOCD                          WVAOCD
     I              ADBGCD                          WVBGCD
     I              ADVHST                          WVVHST
     I              ADMPNA                          WVMPNA
     I              ADWPST                          WVWPST
     I              ADXUST                          WVXUST
     I              ADT0ST                          WVT0ST
     I              ADT1ST                          WVT1ST
     I              ADDBNB                          WVDBNB
     I              ADT2ST                          WVT2ST
     I              ADT3ST                          WVT3ST
     I              ADT4ST                          WVT4ST
     I              ADT6ST                          WVT6ST
     I              ADBWC3                          WVBWC3
     I              ADBTC3                          WVBTC3
     I              ADBUC3                          WVBUC3
     I              ADBVC3                          WVBVC3
     I              ADFCAA                          WVFCAA
     I              ADRQSX                          WVRQSX
     I              ADRRSX                          WVRRSX
     I              ADRSSX                          WVRSSX
     I              ADRTSX                          WVRTSX
     I              ADT7ST                          WVT7ST
     I              ADT8ST                          WVT8ST
     I              ADRNSX                          WVRNSX
     I              ADROSX                          WVROSX
     I              ADRPSX                          WVRPSX
     I              ADUVST                          WVUVST
     I              ADUWST                          WVUWST
     I              ADUXST                          WVUXST
     I              ADVSST                          WVVSST
     I              ADAATM                          WVAATM
     I              ADAYNA                          WVAYNA
     I              ADA0NA                          WVA0NA
     I              ADAXDT                          WVAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WWAIC3
     I              FDHGCD                          WWHGCD
     I              FDD0ST                          WWD0ST
     I              FDD2ST                          WWD2ST
     I              FDD6ST                          WWD6ST
     I              FDWESP                          WWWESP
     I              FDEDST                          WWEDST
     I              FDEFST                          WWEFST
     I              FDEHST                          WWEHST
     I              FDEMST                          WWEMST
     I              FDENST                          WWENST
     I              FDEOST                          WWEOST
     I              FDEPST                          WWEPST
     I              FDEQST                          WWEQST
     I              FDOQNY                          WWOQNY
     I              FDORNY                          WWORNY
     I              FDS2DT                          WWS2DT
     I              FDUFT1                          WWUFT1
     I              FDKUAA                          WWKUAA
     I              FDVSST                          WWVSST
     I              FDMJDT                          WWMJDT
     I              FDBETM                          WWBETM
     I              FDCCVN                          WWCCVN
     I              FDCDVN                          WWCDVN
     I              FDMKDT                          WWMKDT
     I              FDBFTM                          WWBFTM
     I              FDCEVN                          WWCEVN
     I              FDCFVN                          WWCFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WXAIC3
     I              BEC4NB                          WXC4NB
     I              BEJNCD                          WXJNCD
     I              BEANC7                          WXANC7
     I              BEBKC7                          WXBKC7
     I              BEBRTX                          WXBRTX
     I              BEHMNA                          WXHMNA
     I              BEHONA                          WXHONA
     I              BEHPNA                          WXHPNA
     I              BEHNNA                          WXHNNA
     I              BEDBCD                          WXDBCD
     I              BECKTX                          WXCKTX
     I              BEB0C7                          WXB0C7
     I              BEAETX                          WXAETX
     I              BEB1NA                          WXB1NA
     I              BEB3NA                          WXB3NA
     I              BEB4NA                          WXB4NA
     I              BEB2NA                          WXB2NA
     I              BEBHCD                          WXBHCD
     I              BEC8TX                          WXC8TX
     I              BEBCNA                          WXBCNA
     I              BEA0DT                          WXA0DT
     I              BEA5DT                          WXA5DT
     I              BEGNDT                          WXGNDT
     I              BEACDT                          WXACDT
     I              BEAQCD                          WXAQCD
     I              BEB6NA                          WXB6NA
     I              BEBYNA                          WXBYNA
     I              BEBZNA                          WXBZNA
     I              BEGTST                          WXGTST
     I              BEGVST                          WXGVST
     I              BEGUST                          WXGUST
     I              BEQFST                          WXQFST
     I              BECQCD                          WXCQCD
     I              BEGJST                          WXGJST
     I              BEGWST                          WXGWST
     I              BEGXST                          WXGXST
     I              BEGYST                          WXGYST
     I              BEAODT                          WXAODT
     I              BEAIVN                          WXAIVN
     I              BECXDT                          WXCXDT
     I              BEJZVA                          WXJZVA
     I              BEA1WG                          WXA1WG
     I              BEXIST                          WXXIST
     I              BEXJST                          WXXJST
     I              BEXKST                          WXXKST
     I              BEEIDT                          WXEIDT
     I              BEAFTM                          WXAFTM
     I              BEE8CD                          WXE8CD
     I              BEE9CD                          WXE9CD
     I              BERMNB                          WXRMNB
     I              BETBNB                          WXTBNB
     I              BER1NB                          WXR1NB
     I              BEPJST                          WXPJST
     I              BEU0ST                          WXU0ST
     I              BEU1ST                          WXU1ST
     I              BEQ2CD                          WXQ2CD
     I              BEU2ST                          WXU2ST
     I              BEVEST                          WXVEST
     I              BEVFST                          WXVFST
     I              BEVGST                          WXVGST
     I              BERPCD                          WXRPCD
     I              BERNNB                          WXRNNB
     I              BEVDST                          WXVDST
     I              BEATIN                          WXATIN
     I              BEU4ST                          WXU4ST
     I              BEU5ST                          WXU5ST
     I              BERSRN                          WXRSRN
     I              BEMHNA                          WXMHNA
     I              BEMINA                          WXMINA
     I              BEWBST                          WXWBST
     I              BER4CD                          WXR4CD
     I              BEBFCD                          WXBFCD
     I              BEQ4CD                          WXQ4CD
     I              BET3NB                          WXT3NB
     I              BESICD                          WXSICD
     I              BECONB                          WXCONB
     I              BECEST                          WXCEST
     I              BEAWDT                          WXAWDT
     I              BEJPCD                          WXJPCD
     I              BEXUST                          WXXUST
     I              BEZ1ST                          WXZ1ST
     I              BEVRVA                          WXVRVA
     I              BEOBST                          WXOBST
     I              BEBCST                          WXBCST
     I              BEBDST                          WXBDST
     I              BEB7VL                          WXB7VL
     I              BEGASX                          WXGASX
     I              BEGBSX                          WXGBSX
     I              BEGCSX                          WXGCSX
     I              BEGDSX                          WXGDSX
     I              BEFNSX                          WXFNSX
     I              BEFOSX                          WXFOSX
     I              BEFPSX                          WXFPSX
     I              BEFQSX                          WXFQSX
     I              BEFRSX                          WXFRSX
     I              BEFSSX                          WXFSSX
     I              BEFTSX                          WXFTSX
     I              BEFUSX                          WXFUSX
     I              BEFVSX                          WXFVSX
     I              BEFWSX                          WXFWSX
     I              BEFXSX                          WXFXSX
     I              BEFYSX                          WXFYSX
     I              BENODT                          WXNODT
     I              BENPDT                          WXNPDT
     I              BENQDT                          WXNQDT
     I              BENRDT                          WXNRDT
     I              BENSDT                          WXNSDT
     I              BEBPTM                          WXBPTM
     I              BEBQTM                          WXBQTM
     I              BEBRTM                          WXBRTM
     I              BEBSTM                          WXBSTM
     I              BEBTTM                          WXBTTM
     I              BEH0NX                          WXH0NX
     I              BEH1NX                          WXH1NX
     I              BEH2NX                          WXH2NX
     I              BEH3NX                          WXH3NX
     I              BEH4NX                          WXH4NX
     I              BEC0C7                          WXC0C7
     I              BEUVST                          WXUVST
     I              BEUWST                          WXUWST
     I              BEUXST                          WXUXST
     I              BEAATM                          WXAATM
     I              BEAYNA                          WXAYNA
     I              BEA0NA                          WXA0NA
     I              BEAXDT                          WXAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WYAIC3
     I              AFBCDT                          WYBCDT
     I              AFCQNB                          WYCQNB
     I              AFESNB                          WYESNB
     I              AFETNB                          WYETNB
     I              AFBZNB                          WYBZNB
     I              AFA9ST                          WYA9ST
     I              AFEINB                          WYEINB
     I              AFC5ST                          WYC5ST
     I              AFAQNB                          WYAQNB
     I              AFCMST                          WYCMST
     I              AFV9ST                          WYV9ST
     I              AFWAST                          WYWAST
     I              AFX2ST                          WYX2ST
     I              AFOJDT                          WYOJDT
     I              AFNQNX                          WYNQNX
     I              AFNRNX                          WYNRNX
     I              AFI9SX                          WYI9SX
     I              AFJASX                          WYJASX
     I              AFOKDT                          WYOKDT
     I              AFOLDT                          WYOLDT
     I              AFUVST                          WYUVST
     I              AFUWST                          WYUWST
     I              AFUXST                          WYUXST
     I              AFAATM                          WYAATM
     I              AFAYNA                          WYAYNA
     I              AFA0NA                          WYA0NA
     I              AFAXDT                          WYAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          TAAIC3
     I              AFBCDT                          TABCDT
     I              AFCQNB                          TACQNB
     I              AFESNB                          TAESNB
     I              AFETNB                          TAETNB
     I              AFBZNB                          TABZNB
     I              AFA9ST                          TAA9ST
     I              AFEINB                          TAEINB
     I              AFC5ST                          TAC5ST
     I              AFAQNB                          TAAQNB
     I              AFCMST                          TACMST
     I              AFV9ST                          TAV9ST
     I              AFWAST                          TAWAST
     I              AFX2ST                          TAX2ST
     I              AFOJDT                          TAOJDT
     I              AFNQNX                          TANQNX
     I              AFNRNX                          TANRNX
     I              AFI9SX                          TAI9SX
     I              AFJASX                          TAJASX
     I              AFOKDT                          TAOKDT
     I              AFOLDT                          TAOLDT
     I              AFUVST                          TAUVST
     I              AFUWST                          TAUWST
     I              AFUXST                          TAUXST
     I              AFAATM                          TAAATM
     I              AFAYNA                          TAAYNA
     I              AFA0NA                          TAA0NA
     I              AFAXDT                          TAAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          TBAIC3
     I              JCV5ST                          TBV5ST
     I              JCELDT                          TBELDT
     I              JCHVHD                          TBHVHD
     I              JCZ6NB                          TBZ6NB
     I              JCZ7NB                          TBZ7NB
     I              JCDGPC                          TBDGPC
     I              JCAVCW                          TBAVCW
     I              JCDIPC                          TBDIPC
     I              JCZ0NB                          TBZ0NB
     I              JCAVLE                          TBAVLE
     I              JCECWG                          TBECWG
     I              JCUVST                          TBUVST
     I              JCUWST                          TBUWST
     I              JCUXST                          TBUXST
     I              JCVSST                          TBVSST
     I              JCAATM                          TBAATM
     I              JCAYNA                          TBAYNA
     I              JCA0NA                          TBA0NA
     I              JCAXDT                          TBAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          TCAIC3
     I              I8V5ST                          TCV5ST
     I              I8ELDT                          TCELDT
     I              I8HGCD                          TCHGCD
     I              I8AJCD                          TCAJCD
     I              I8GPDT                          TCGPDT
     I              I8WTSP                          TCWTSP
     I              I8QTSP                          TCQTSP
     I              I8DJPC                          TCDJPC
     I              I8F8WG                          TCF8WG
     I              I8WTIN                          TCWTIN
     I              I8D5NB                          TCD5NB
     I              I8DXWG                          TCDXWG
     I              I8B2NB                          TCB2NB
     I              I8WTCN                          TCWTCN
     I              I8PSCV                          TCPSCV
     I              I8SAWT                          TCSAWT
     I              I8B9NB                          TCB9NB
     I              I8D1WG                          TCD1WG
     I              I8CBNB                          TCCBNB
     I              I8EZWG                          TCEZWG
     I              I8CCNB                          TCCCNB
     I              I8E0WG                          TCE0WG
     I              I8D6NB                          TCD6NB
     I              I8OAWT                          TCOAWT
     I              I8CDNB                          TCCDNB
     I              I8UNW2                          TCUNW2
     I              I8CENB                          TCCENB
     I              I8F9WG                          TCF9WG
     I              I8BPNB                          TCBPNB
     I              I8GAWG                          TCGAWG
     I              I8BQNB                          TCBQNB
     I              I8GBWG                          TCGBWG
     I              I8BRNB                          TCBRNB
     I              I8GCWG                          TCGCWG
     I              I8BSNB                          TCBSNB
     I              I8GDWG                          TCGDWG
     I              I8BWNB                          TCBWNB
     I              I8GEWG                          TCGEWG
     I              I8PS6U                          TCPS6U
     I              I8WCST                          TCWCST
     I              I8WPST                          TCWPST
     I              I8B5ST                          TCB5ST
     I              I8TFST                          TCTFST
     I              I8TEST                          TCTEST
     I              I8THST                          TCTHST
     I              I8UDST                          TCUDST
     I              I8UFST                          TCUFST
     I              I8UGST                          TCUGST
     I              I8UHST                          TCUHST
     I              I8B6ST                          TCB6ST
     I              I8B7ST                          TCB7ST
     I              I8DVWG                          TCDVWG
     I              I8D7NB                          TCD7NB
     I              I8FCAD                          TCFCAD
     I              I8D9NB                          TCD9NB
     I              I8DWWG                          TCDWWG
     I              I8EANB                          TCEANB
     I              I8SHWT                          TCSHWT
     I              I8EBNB                          TCEBNB
     I              I8AVWT                          TCAVWT
     I              I8ECNB                          TCECNB
     I              I8WTON                          TCWTON
     I              I8EDNB                          TCEDNB
     I              I8FNWT                          TCFNWT
     I              I8EENB                          TCEENB
     I              I8QTAS                          TCQTAS
     I              I8EFNB                          TCEFNB
     I              I8WAIO                          TCWAIO
     I              I8EGNB                          TCEGNB
     I              I8R3CD                          TCR3CD
     I              I8RGNB                          TCRGNB
     I              I8RHNB                          TCRHNB
     I              I8RINB                          TCRINB
     I              I8XRCD                          TCXRCD
     I              I8UVST                          TCUVST
     I              I8UWST                          TCUWST
     I              I8UXST                          TCUXST
     I              I8VSST                          TCVSST
     I              I8AATM                          TCAATM
     I              I8AYNA                          TCAYNA
     I              I8A0NA                          TCA0NA
     I              I8AXDT                          TCAXDT
      *
     I@B6CPAG
      * Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          TDAIC3
     I              B6C4NB                          TDC4NB
     I              B6DPNB                          TDDPNB
     I              B6UENB                          TDUENB
     I              B6JGDT                          TDJGDT
     I              B6OONY                          TDOONY
     I              B6AODT                          TDAODT
     I              B6AJCD                          TDAJCD
     I              B6NUDT                          TDNUDT
     I              B6HGCD                          TDHGCD
     I              B6IGQT                          TDIGQT
     I              B6FLWG                          TDFLWG
     I              B6NSQT                          TDNSQT
     I              B6JQWG                          TDJQWG
     I              B6NVDT                          TDNVDT
     I              B6BUTM                          TDBUTM
     I              B6UVST                          TDUVST
     I              B6UWST                          TDUWST
     I              B6UXST                          TDUXST
     I              B6VSST                          TDVSST
     I              B6AATM                          TDAATM
     I              B6AYNA                          TDAYNA
     I              B6A0NA                          TDA0NA
     I              B6AXDT                          TDAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          TEAIC3
     I              AFBCDT                          TEBCDT
     I              AFCQNB                          TECQNB
     I              AFESNB                          TEESNB
     I              AFETNB                          TEETNB
     I              AFBZNB                          TEBZNB
     I              AFA9ST                          TEA9ST
     I              AFEINB                          TEEINB
     I              AFC5ST                          TEC5ST
     I              AFAQNB                          TEAQNB
     I              AFCMST                          TECMST
     I              AFV9ST                          TEV9ST
     I              AFWAST                          TEWAST
     I              AFX2ST                          TEX2ST
     I              AFOJDT                          TEOJDT
     I              AFNQNX                          TENQNX
     I              AFNRNX                          TENRNX
     I              AFI9SX                          TEI9SX
     I              AFJASX                          TEJASX
     I              AFOKDT                          TEOKDT
     I              AFOLDT                          TEOLDT
     I              AFUVST                          TEUVST
     I              AFUWST                          TEUWST
     I              AFUXST                          TEUXST
     I              AFAATM                          TEAATM
     I              AFAYNA                          TEAYNA
     I              AFA0NA                          TEA0NA
     I              AFAXDT                          TEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WBAIC3
     I              B5C4NB                          WBC4NB
     I              B5DPNB                          WBDPNB
     I              B5UENB                          WBUENB
     I              B5JGDT                          WBJGDT
     I              B5AODT                          WBAODT
     I              B5AJCD                          WBAJCD
     I              B5HGCD                          WBHGCD
     I              B5IUQT                          WBIUQT
     I              B5F3WG                          WBF3WG
     I              B5UVST                          WBUVST
     I              B5UWST                          WBUWST
     I              B5UXST                          WBUXST
     I              B5VSST                          WBVSST
     I              B5AATM                          WBAATM
     I              B5AYNA                          WBAYNA
     I              B5A0NA                          WBA0NA
     I              B5AXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     IYARDCS      DS                            100
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                             69
     IYDRDCS      DS                            100
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WTAIC3
     I              I8V5ST                          WTV5ST
     I              I8ELDT                          WTELDT
     I              I8HGCD                          WTHGCD
     I              I8AJCD                          WTAJCD
     I              I8GPDT                          WTGPDT
     I              I8WTSP                          WTWTSP
     I              I8QTSP                          WTQTSP
     I              I8DJPC                          WTDJPC
     I              I8F8WG                          WTF8WG
     I              I8WTIN                          WTWTIN
     I              I8D5NB                          WTD5NB
     I              I8DXWG                          WTDXWG
     I              I8B2NB                          WTB2NB
     I              I8WTCN                          WTWTCN
     I              I8PSCV                          WTPSCV
     I              I8SAWT                          WTSAWT
     I              I8B9NB                          WTB9NB
     I              I8D1WG                          WTD1WG
     I              I8CBNB                          WTCBNB
     I              I8EZWG                          WTEZWG
     I              I8CCNB                          WTCCNB
     I              I8E0WG                          WTE0WG
     I              I8D6NB                          WTD6NB
     I              I8OAWT                          WTOAWT
     I              I8CDNB                          WTCDNB
     I              I8UNW2                          WTUNW2
     I              I8CENB                          WTCENB
     I              I8F9WG                          WTF9WG
     I              I8BPNB                          WTBPNB
     I              I8GAWG                          WTGAWG
     I              I8BQNB                          WTBQNB
     I              I8GBWG                          WTGBWG
     I              I8BRNB                          WTBRNB
     I              I8GCWG                          WTGCWG
     I              I8BSNB                          WTBSNB
     I              I8GDWG                          WTGDWG
     I              I8BWNB                          WTBWNB
     I              I8GEWG                          WTGEWG
     I              I8PS6U                          WTPS6U
     I              I8WCST                          WTWCST
     I              I8WPST                          WTWPST
     I              I8B5ST                          WTB5ST
     I              I8TFST                          WTTFST
     I              I8TEST                          WTTEST
     I              I8THST                          WTTHST
     I              I8UDST                          WTUDST
     I              I8UFST                          WTUFST
     I              I8UGST                          WTUGST
     I              I8UHST                          WTUHST
     I              I8B6ST                          WTB6ST
     I              I8B7ST                          WTB7ST
     I              I8DVWG                          WTDVWG
     I              I8D7NB                          WTD7NB
     I              I8FCAD                          WTFCAD
     I              I8D9NB                          WTD9NB
     I              I8DWWG                          WTDWWG
     I              I8EANB                          WTEANB
     I              I8SHWT                          WTSHWT
     I              I8EBNB                          WTEBNB
     I              I8AVWT                          WTAVWT
     I              I8ECNB                          WTECNB
     I              I8WTON                          WTWTON
     I              I8EDNB                          WTEDNB
     I              I8FNWT                          WTFNWT
     I              I8EENB                          WTEENB
     I              I8QTAS                          WTQTAS
     I              I8EFNB                          WTEFNB
     I              I8WAIO                          WTWAIO
     I              I8EGNB                          WTEGNB
     I              I8R3CD                          WTR3CD
     I              I8RGNB                          WTRGNB
     I              I8RHNB                          WTRHNB
     I              I8RINB                          WTRINB
     I              I8XRCD                          WTXRCD
     I              I8UVST                          WTUVST
     I              I8UWST                          WTUWST
     I              I8UXST                          WTUXST
     I              I8VSST                          WTVSST
     I              I8AATM                          WTAATM
     I              I8AYNA                          WTAYNA
     I              I8A0NA                          WTA0NA
     I              I8AXDT                          WTAXDT
      *
     IYERDCS      DS                            326
     IYFRDCS      DS                            100
     IYGRDCS      DS                            326
     IYHRDCS      DS                            326
     IYIRDCS      DS                             91
     IYJRDCS      DS                            326
     IYKRDCS      DS                            525
     IYLRDCS      DS                            100
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  PPS Process STS
     I                                        1   1 P2MWSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2MWSX    PARM           WP0002  1        PPS Process STS
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Re-Alc Inv/Prod   XF
      * CASE: PAR.PPS Process STS is Realc by SDte Mid Day
     C           P2MWSX    IFEQ '2'                        *IF
      * UPS Realc Ord Init    XF - PS Prod Schedule  * 
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Del OrdDtl SchInv ALL RT - Order Detail Sched-Inv  * 
     C                     EXSR SARVGN
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
     C                     EXSR SCRVGN
      * UPS Re-Alc Inv/Prod   RT - Order Detail  * 
     C                     EXSR SJRVGN
      * Initialize Added today flag.
      * Upd Added to Sch Tdy  RT - Order Detail Schedule  * 
     C                     EXSR NFRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0739  1        EDI Status 1
     C                     MOVEL*BLANK    WN0740  1        EDI Status 2
     C                     MOVEL*BLANK    WN0741  1        EDI Status 3
     C                     MOVEL*BLANK    WN0742  1        Record Status
     C                     Z-ADD*ZERO     WN0743  60       Job Time
     C                     MOVEL*BLANK    WN0744 10        User Id
     C                     MOVEL*BLANK    WN0745 10        Job Name
     C                     Z-ADD*ZERO     WN0746  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLCHNA    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLCHNA    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YIRDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADDWL0278    WGAODT           Scheduled Ship
     C                     MOVELWL0279    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0280    WGNUDT           Consumed Item C
     C                     Z-ADDWL0281    WGHGCD           Item Code
     C                     Z-ADDYL0060    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0059    WGFLWG           OD Weight Sched
     C                     Z-ADDWFNSQT    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWFJQWG    WGJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0747  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0748  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0749  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0750  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0751  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0752  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0753  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0754  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0755  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0756  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0757  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0758  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0759  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0760  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0761  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0762  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0763  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0764  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0765  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0766  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0767 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0768  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0769 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0770  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0771 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0772  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0773 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0774  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0775 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0776  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0777 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0778  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0779  3        PS Item Id
     C                     MOVEL*BLANK    WN0780  2        Warehouse Type
     C                     MOVEL*BLANK    WN0781  1        PS Lock Status
     C                     MOVEL*BLANK    WN0782  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0783  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0784  1        PS Piece Count
     C                     MOVEL*BLANK    WN0785  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0786  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0787  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0788  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0789  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0790  3        PS Production W
     C                     Z-ADD*ZERO     WN0791  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0792  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0793  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0794  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0795  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0796  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0797  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0798  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0799  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0800  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0801  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0802  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0803  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0804  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0805  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0806  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0807  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0808  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0809  6        Department Code
     C                     Z-ADD*ZERO     WN0810  30       Item Structure
     C                     Z-ADD*ZERO     WN0811  30       Item Structure
     C                     Z-ADD*ZERO     WN0812  30       Item Structure
     C                     MOVEL*BLANK    WN0813  6        Primal Group Co
     C                     MOVEL*BLANK    WN0814  1        EDI Status 1
     C                     MOVEL*BLANK    WN0815  1        EDI Status 2
     C                     MOVEL*BLANK    WN0816  1        EDI Status 3
     C                     MOVEL*BLANK    WN0817  1        Record Status
     C                     Z-ADD*ZERO     WN0818  60       Job Time
     C                     MOVEL*BLANK    WN0819 10        User Id
     C                     MOVEL*BLANK    WN0820 10        Job Name
     C                     Z-ADD*ZERO     WN0821  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHNB    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHNB    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YJRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWSF8WG    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0672    WTOAWT           PS Weight Prod
     C                     Z-ADDWN0673    WTCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQNC01           Company Number
      * Define keylist
     C           KPSNC     KLIST
     C                     KFLD           WQNC01           Company Number
     C                     KFLD           TEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Company Number
      * Setup key
     C                     Z-ADDWL0288    WQNC01           Company Number
     C                     Z-ADDWL0289    TEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSNC     SETLL@AFREPU                    *
     C           KRSNC     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0289    IFEQ TEBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0292                     *IF
     C                     Z-ADDTEBCDT    WL0290           *Date1 (ending)
     C                     GOTO NCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNC     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQND01           Company Number
      * Define keylist
     C           KPSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           TABCDT           Post to G/L Dat
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
      * Setup key
     C                     Z-ADDWL0293    WQND01           Company Number
     C                     Z-ADDWL0294    TABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSND     SETLL@AFREYY                    *
     C           KRSND     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0294    IFEQ TABCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0297                     *IF
     C                     Z-ADDTABCDT    WL0295           *Date1 (ending)
     C                     GOTO NDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSND     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECHRC    BEGSR
      *================================================================
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0822  70       Item Code
     C                     MOVEL*BLANK    WN0823  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0824  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0825  70       Order Group Cod
     C                     MOVEL*BLANK    WN0826  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0827  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0828 112       Billing Detail
     C                     Z-ADD*ZERO     WN0829 112       Billing Detail
     C                     Z-ADD*ZERO     WN0830 112       Billing Detail
     C                     Z-ADD*ZERO     WN0831 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0832  1        Comment Print A
     C                     MOVEL*BLANK    WN0833  1        Comment Print I
     C                     MOVEL*BLANK    WN0834  1        Comment Print P
     C                     MOVEL*BLANK    WN0835  1        Comment Print S
     C                     Z-ADD*ZERO     WN0836 112       Extended Amount
     C                     Z-ADD*ZERO     WN0837  70       Market Pricing
     C                     MOVEL*BLANK    WN0838  3        Commodity Marke
     C                     MOVEL*BLANK    WN0839  3        Date Method Cod
     C                     MOVEL*BLANK    WN0840  3        Price Method Co
     C                     Z-ADD*ZERO     WN0841 114       Price Overage O
     C                     Z-ADD*ZERO     WN0842  70       Contract Number
     C                     MOVEL*BLANK    WN0843  1        Price Status
     C                     Z-ADD*ZERO     WN0844  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0845  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0846  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0847  1        Work Confirm St
     C                     MOVEL*BLANK    WN0848  1        Work Over/Short
     C                     MOVEL*BLANK    WN0849  1        OD Production P
     C                     MOVEL*BLANK    WN0850 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0851 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0852  1        Age Code
     C                     MOVEL*BLANK    WN0853  1        Palletize
     C                     MOVEL*BLANK    WN0854  1        Slip Sheet
     C                     MOVEL*BLANK    WN0855  1        Catch Weight St
     C                     MOVEL*BLANK    WN0856  1        Price Audit
     C                     MOVEL*BLANK    WN0857  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0858  1        Production Date
     C                     Z-ADD*ZERO     WN0859 112       Rated Freight
     C                     Z-ADD*ZERO     WN0860 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0861 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0862 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0863 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0864 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0865 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0866 114       Unit Price
     C                     Z-ADD*ZERO     WN0867 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0868 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0869 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0870 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0871  70       Requested Ship
     C                     Z-ADD*ZERO     WN0872  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0873  70       Actual Shipped
     C                     MOVEL*BLANK    WN0874  1        Affect Inventor
     C                     MOVEL*BLANK    WN0875  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0876  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0877  30       Item Structure
     C                     Z-ADD*ZERO     WN0878  30       Item Structure
     C                     Z-ADD*ZERO     WN0879  30       Item Structure
     C                     MOVEL*BLANK    WN0880  2        Item Level
     C                     MOVEL*BLANK    WN0881  2        Quality Level
     C                     MOVEL*BLANK    WN0882  2        Pricing Product
     C                     MOVEL*BLANK    WN0883  2        Season Product
     C                     Z-ADD*ZERO     WN0884  70       Date of Origina
     C                     MOVEL*BLANK    WN0885 10        User Profile Na
     C                     MOVEL*BLANK    WN0886  6        Country Code
     C                     MOVEL*BLANK    WN0887  2        Event Code
     C                     MOVEL*BLANK    WN0888  3        Reason Code
     C                     MOVEL*BLANK    WN0889  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0890  1        Modified Flag
     C                     MOVEL*BLANK    WN0891  1        Substituted Fla
     C                     MOVEL*BLANK    WN0892  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0893 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0894 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0895  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0896  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0897  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0898  1        Affect Commissi
     C                     MOVEL*BLANK    WN0899  1        Affect Pricing
     C                     MOVEL*BLANK    WN0900  1        Released by Use
     C                     MOVEL*BLANK    WN0901  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0902  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0903  3        Production Ware
     C                     MOVEL*BLANK    WN0904  3        OD Price Type
     C                     Z-ADD*ZERO     WN0905  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0906  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0907  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0908  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0909  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0910  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0911  60       Price Code
     C                     Z-ADD*ZERO     WN0912  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0913  60       Substitution Li
     C                     Z-ADD*ZERO     WN0914  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0915 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0916 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0917 112       OD Item Target
     C                     Z-ADD*ZERO     WN0918 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0919 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0920 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0921 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0922 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0923 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0924 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0925 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0926 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0927 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0928  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0929  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0930  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0931 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0932  40       Item Age Days
     C                     Z-ADD*ZERO     WN0933  70       Production Ovr
     C                     Z-ADD*ZERO     WN0934  70       Production Ovr
     C                     MOVEL*BLANK    WN0935  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0936  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0937  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0938  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0939  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0940  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0941  1        EDI Status 1
     C                     MOVEL*BLANK    WN0942  1        EDI Status 2
     C                     MOVEL*BLANK    WN0943  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0944  60       Job Time
     C                     MOVEL*BLANK    WN0945 10        User Id
     C                     MOVEL*BLANK    WN0946 10        Job Name
     C                     Z-ADD*ZERO     WN0947  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWHAIC3    WKAIC3           Company Number
     C                     Z-ADDWHC4NB    WKC4NB           Order Number
     C                     Z-ADDWHDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWHUENB    WKUENB           Order Secondary
      *
     C           KLCHNE    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHNE    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YKRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0022    WKCCQT           Quantity Schedu
     C                     Z-ADDYL0023    WKAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Upd Added to Sch Tdy  RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQNF01           Company Number
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQNF01           Company Number
      * Establish starting position
     C           KRSNF     SETLL@KNCPHO                    *
     C           KRSNF     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Added to Sch Tdy  CH - Order Detail Schedule  * 
     C                     EXSR NGCHRC
     C           KRSNF     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * Chg Added to Sch Tdy  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0948  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0949  3        Warehouse Code
     C                     MOVEL*BLANK    WN0950  3        Order From Ware
     C                     Z-ADD*ZERO     WN0951  70       Item Code
     C                     Z-ADD*ZERO     WN0952 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0953 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0954 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0955 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0956 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0957 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0958  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0959  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0960  1        EDI Status 1
     C                     MOVEL*BLANK    WN0961  1        EDI Status 2
     C                     MOVEL*BLANK    WN0962  1        EDI Status 3
     C                     MOVEL*BLANK    WN0963  1        Record Status
     C                     Z-ADD*ZERO     WN0964  60       Job Time
     C                     MOVEL*BLANK    WN0965 10        User Id
     C                     MOVEL*BLANK    WN0966 10        Job Name
     C                     Z-ADD*ZERO     WN0967  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLCHNG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHNG    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YLRDCS
      * Move non-key fields to @KNCPHN
     C                     MOVEL*BLANK    WEP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del OrdDtl SchInv ALL RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@B5CPM2                    *
     C           KRSSA     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     Z-ADDWAJGDT    WL0005           OD Production D
     C                     EXSR SBDLRC
     C           KRSSA     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
     C                     Z-ADDWL0003    WBDPNB           Order Sequence
     C                     Z-ADDWL0004    WBUENB           Order Secondary
     C                     Z-ADDWL0005    WBJGDT           OD Production D
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBJGDT           OD Production D
     C           KLDLSB    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
      * Establish starting position
     C           KRSSC     SETLL@KNCPHO                    *
     C           KRSSC     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0001    IFNE WCC4NB                     *IF
     C                     Z-ADDWCC4NB    YL0001           Order Number
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * CASE: LCL.Header Status is Avail/Alloc/Enter/Hold
     C           YL0002    IFEQ 'L'                        *IF
     C           YL0002    OREQ 'A'
     C           YL0002    OREQ 'E'
     C           YL0002    OREQ 'H'
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADDWCDPNB    WL0008           Order Sequence
     C                     Z-ADDWCUENB    WL0009           Order Secondary
     C                     Z-ADDWCJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
     C                     EXSR SGRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0017           Company Number
     C                     Z-ADDWCC4NB    WL0018           Order Number
     C                     Z-ADDWCDPNB    WL0019           Order Sequence
     C                     Z-ADDWCUENB    WL0020           Order Secondary
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSC     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDGWST    YL0002           Header Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0002  3        Warehouse Code
     C                     MOVEL*BLANK    WN0003  3        Order From Ware
     C                     Z-ADD*ZERO     WN0004  70       Item Code
     C                     Z-ADD*ZERO     WN0005 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0006 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0007 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0008 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0009 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0010 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0011  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0012  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0013  1        EDI Status 1
     C                     MOVEL*BLANK    WN0014  1        EDI Status 2
     C                     MOVEL*BLANK    WN0015  1        EDI Status 3
     C                     MOVEL*BLANK    WN0016  1        Record Status
     C                     Z-ADD*ZERO     WN0017  60       Job Time
     C                     MOVEL*BLANK    WN0018 10        User Id
     C                     MOVEL*BLANK    WN0019 10        Job Name
     C                     Z-ADD*ZERO     WN0020  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHSE    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YARDCS
      * Move non-key fields to @KNCPHN
     C                     MOVEL'Y'       WEP8ST    P      OD Reallocate S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0006    WEAIC3           Company Number
     C                     Z-ADDWL0007    WEC4NB           Order Number
     C                     Z-ADDWL0008    WEDPNB           Order Sequence
     C                     Z-ADDWL0009    WEUENB           Order Secondary
     C                     Z-ADDWL0010    WEJGDT           OD Production D
      *
     C           KLDLSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLDLSF    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSG03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSG04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSG05           OD Production D
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Order Sequence
     C                     KFLD           WQSG04           Order Secondary
     C                     KFLD           WQSG05           OD Production D
      * Setup key
     C                     Z-ADDWCAIC3    WQSG01           Company Number
     C                     Z-ADDWCC4NB    WQSG02           Order Number
     C                     Z-ADDWCDPNB    WQSG03           Order Sequence
     C                     Z-ADDWCUENB    WQSG04           Order Secondary
     C                     Z-ADDWCJGDT    WQSG05           OD Production D
      * Establish starting position
     C           KRSSG     SETLL@B6CPNB                    *
     C           KRSSG     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0011           Company Number
     C                     Z-ADDWFC4NB    WL0012           Order Number
     C                     Z-ADDWFDPNB    WL0013           Order Sequence
     C                     Z-ADDWFUENB    WL0014           Order Secondary
     C                     Z-ADDWFJGDT    WL0015           OD Production D
     C                     Z-ADDWFOONY    WL0016           ODS Sequence Nu
     C                     EXSR SHDLRC
     C           KRSSG     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWL0011    WGAIC3           Company Number
     C                     Z-ADDWL0012    WGC4NB           Order Number
     C                     Z-ADDWL0013    WGDPNB           Order Sequence
     C                     Z-ADDWL0014    WGUENB           Order Secondary
     C                     Z-ADDWL0015    WGJGDT           OD Production D
     C                     Z-ADDWL0016    WGOONY           ODS Sequence Nu
      *
     C           KLDLSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLDLSH    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WADPNB    WQSI03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSI04           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Order Sequence
     C                     KFLD           WQSI04           Order Secondary
      * Setup key
     C                     Z-ADDWL0017    WQSI01           Company Number
     C                     Z-ADDWL0018    WQSI02           Order Number
     C                     Z-ADDWL0019    WQSI03           Order Sequence
     C                     Z-ADDWL0020    WQSI04           Order Secondary
      * Establish starting position
     C           KRSSI     SETLL@B5CPM2                    *
     C           KRSSI     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     Z-ADDWAJGDT    WL0005           OD Production D
     C                     EXSR SBDLRC
     C           KRSSI     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prod   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0003           Company Number
     C                     Z-ADD*ZERO     YL0004           Order Number
     C                     MOVEL'Y'       YL0005           First Time Flag
     C                     Z-ADD*ZERO     YL0006           Ship To Custome
      * LCL.Ship Date USR = JOB.*Job date + CON.5 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD5         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL@CN,002   XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0007
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0007
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
      * Establish starting position
     C           KRSSJ     SETLL@BGWKKJ                    *
     C           KRSSJ     READE@BGWKKJ                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time Processing
      * CASE: LCL.First Time Flag is Yes
     C           YL0005    IFEQ 'Y'                        *IF
     C                     Z-ADDWHAIC3    YL0003           Company Number
     C                     Z-ADDWHC4NB    YL0004           Order Number
     C                     Z-ADDWHBKC7    YL0006           Ship To Custome
     C                     MOVEL'SC'      YL0008           ATS Adj Type US
     C                     MOVEL'N'       YL0005           First Time Flag
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0021           Company Number
     C                     Z-ADDWHC4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    YL0009    P      Order Type - Sa
     C                     END                             *FI
      * CHG:  Order Number
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0004    IFNE WHC4NB                     *IF
      * CASE: LCL.Order Type - Sales is Regular Order
     C           YL0009    IFEQ 'OR'                       *IF
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0002  30       Company Number
     C                     PARM YL0004    WQ0003  70       Order Number
     C                     PARM YL0006    WQ0004  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0005 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0006 112       Order Weight To
     C                     PARM 'PS'      WQ0007  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADDWHAIC3    YL0003           Company Number
     C                     Z-ADDWHC4NB    YL0004           Order Number
     C                     Z-ADDWHBKC7    YL0006           Ship To Custome
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0021           Company Number
     C                     Z-ADDWHC4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    YL0009    P      Order Type - Sa
     C                     END                             *FI
      * Process Record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Order Type - Sales is Regular Order
      *   |- c2    : LCL.Order Type - Sales is Transfer Order
      *   '-
     C           YL0009    IFEQ 'OR'                       *IF
     C           YL0009    OREQ 'TR'                       *OR
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           WHGMST    IFEQ 'X'                        *IF
     C           WHGMST    OREQ 'C'
     C           WHGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0021 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0024           Company Number
     C                     Z-ADDWHHGCD    WL0025           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WUAVNA    P      Description Lin
     C                     MOVELWL0027    YL0010    P      U/M - Primary
     C                     Z-ADDWL0028    YL0011           Unit Weight
     C                     Z-ADDWL0029    WURINB           Item Structure
     C                     Z-ADDWL0030    WURHNB           Item Structure
     C                     Z-ADDWL0031    WURGNB           Item Structure
     C                     MOVELWL0032    WUN0CD    P      Item Type Code
     C                     MOVELWL0033    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0034    YL0012           Fresh Chilling
     C                     MOVELWL0035    YL0013    P      Base/Conv/Loss
     C                     MOVELWL0036    WUXWST    P      Variety/Rendere
     C                     MOVELWL0037    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0038    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0039    YL0014           Pieces Per Head
     C                     MOVELWL0040    WUR3CD    P      Department Code
     C                     MOVELWL0041    WUSDCD    P      Group for Packa
     C                     MOVELWL0042    WUX5ST    P      Seconds Item
     C                     MOVELWL0043    YL0015    P      Piece Count Ite
     C                     Z-ADDWL0044    YL0016           Pieces Per Bag
     C                     Z-ADDWL0045    YL0017           Bags Per Unit
     C                     MOVELWL0046    WUSUST    P      Export/Domestic
     C                     MOVELWL0047    WUSVST    P      Print On Schedu
     C                     MOVELWL0048    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0049    WUSZST    P      Fresh Sched As
     C                     MOVELWL0050    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0051    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWHAJCD    WL0052    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0053    YL0018    P      Warehouse Type
     C                     MOVELWL0054    WUXUST    P      Trans Contol AS
     C                     MOVELWL0055    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0056    YL0019    P      Warehouse Std C
     C                     Z-ADDWL0057    YL0020           Warehouse Chill
      * RTV Warehous Inv ChillRT - Warehouse  * 
     C                     EXSR SNRVGN
      * Reallocate Item
      * CASE: 5 days in the future or Not Fresh Warehouse
      *  - c1 OR c2
      *   |- c1    : DB1.Scheduled Ship Date GT LCL.Ship Date USR
      *   |- c2    : DB1.Warehouse Code is Not Guymon Fresh
      *   '-
     C           WHAODT    IFGT YL0007                     *IF
     C           WHAJCD    ORNE 'GP1'                      *OR
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
     C                     EXSR SORVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDWHC4NB    WL0018           Order Number
     C                     Z-ADDWHDPNB    WL0019           Order Sequence
     C                     Z-ADDWHUENB    WL0020           Order Secondary
     C                     EXSR SIRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0058           Company Number
     C                     Z-ADDWHC4NB    WL0059           Order Number
     C                     Z-ADDWHDPNB    WL0060           Order Sequence
     C                     Z-ADDWHUENB    WL0061           Order Secondary
     C                     EXSR SPRVGN
     C                     Z-ADD*ZERO     YL0022           Quantity Schedu
     C                     Z-ADD*ZERO     YL0023           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0008  30       Company Number
     C                     PARM WHC4NB    WQ0009  70       Order Number
     C                     PARM WHDPNB    WQ0010  30       Order Sequence
     C                     PARM WHUENB    WQ0011  30       Order Secondary
     C                     PARM WHHGCD    WQ0012  70       Item Code
     C                     PARM WHAJCD    WQ0013  3        Warehouse Code
     C                     PARM WHAODT    WQ0014  70       Ship Date USR
     C                     PARM WHAVQT    WQ0015 112       Quantity Ordere
     C                     PARM WHD0WG    WQ0016 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0017 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0018 112       Weight Schedule
     C                     PARM 'OA'      WQ0019  2        ATS Adj Type US
     C                     PARM 'REALC'   WQ0020 10        PSAA Program Na
     C                     PARM WHRINY    WQ0021  40       Item Age Days
     C                     PARM WHTIDT    WQ0022  70       Production Ovr
     C                     PARM WHTJDT    WQ0023  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Short
      * CASE: LCL.Quantity Scheduled NE DB1.Quantity Ordered
     C           YL0022    IFNE WHAVQT                     *IF
      * CASE: DB1.Scheduled Ship Date LE JOB.*Job date
     C           WHAODT    IFLE ##JDT                      *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHRINY' defaulted for 'Item Age Days'.
      * Field '(DB1) WHTIDT' defaulted for 'Production Ovr AgeDte Fr'.
      * Field '(DB1) WHTJDT' defaulted for 'Production Ovr AgeDte To'.
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0024  30       Company Number
     C                     PARM WHC4NB    WQ0025  70       Order Number
     C                     PARM WHDPNB    WQ0026  30       Order Sequence
     C                     PARM WHUENB    WQ0027  30       Order Secondary
     C                     PARM WHHGCD    WQ0028  70       Item Code
     C                     PARM WHAJCD    WQ0029  3        Warehouse Code
     C                     PARM WHAODT    WQ0030  70       Ship Date USR
     C                     PARM WHAVQT    WQ0031 112       Quantity Ordere
     C                     PARM WHD0WG    WQ0032 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0033 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0034 112       Weight Schedule
     C                     PARM 'SC'      WQ0035  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0036 10        PSAA Program Na
     C                     PARM WHRINY    WQ0037  40       Item Age Days
     C                     PARM WHTIDT    WQ0038  70       Production Ovr
     C                     PARM WHTJDT    WQ0039  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHRINY' defaulted for 'Item Age Days'.
      * Field '(DB1) WHTIDT' defaulted for 'Production Ovr AgeDte Fr'.
      * Field '(DB1) WHTJDT' defaulted for 'Production Ovr AgeDte To'.
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0040  30       Company Number
     C                     PARM WHC4NB    WQ0041  70       Order Number
     C                     PARM WHDPNB    WQ0042  30       Order Sequence
     C                     PARM WHUENB    WQ0043  30       Order Secondary
     C                     PARM WHHGCD    WQ0044  70       Item Code
     C                     PARM WHAJCD    WQ0045  3        Warehouse Code
     C                     PARM WHAODT    WQ0046  70       Ship Date USR
     C                     PARM WHCCQT    WQ0047 112       Quantity Ordere
     C                     PARM WHAUWG    WQ0048 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0049 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0050 112       Weight Schedule
     C                     PARM 'AO'      WQ0051  2        ATS Adj Type US
     C                     PARM @CN,004   WQ0052 10        PSAA Program Na
     C                     PARM WHRINY    WQ0053  40       Item Age Days
     C                     PARM WHTIDT    WQ0054  70       Production Ovr
     C                     PARM WHTJDT    WQ0055  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
     C                     EXSR SQCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Re-Alc Inv/Prod   RT - Order Detail Schedule  * 
     C                     EXSR SRRVGN
      * CASE: DB1.Quantity Ordered GT LCL.Quantity Scheduled
     C           WHAVQT    IFGT YL0022                     *IF
      * CASE: DB1.Scheduled Ship Date LE JOB.*Job date
     C           WHAODT    IFLE ##JDT                      *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0120  30       Company Number
     C                     PARM WHC4NB    WQ0121  70       Order Number
     C                     PARM WHDPNB    WQ0122  30       Order Sequence
     C                     PARM WHUENB    WQ0123  30       Order Secondary
     C                     PARM WHHGCD    WQ0124  70       Item Code
     C                     PARM WHAJCD    WQ0125  3        Warehouse Code
     C                     PARM WHAODT    WQ0126  70       Ship Date USR
     C                     PARM WHAVQT    WQ0127 112       Quantity Ordere
     C                     PARM WHD0WG    WQ0128 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0129 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0130 112       Weight Schedule
     C                     PARM 'SC'      WQ0131  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0132 10        PSAA Program Na
     C                     PARM WHRINY    WQ0133  40       Item Age Days
     C                     PARM WHTIDT    WQ0134  70       Production Ovr
     C                     PARM WHTJDT    WQ0135  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0136  30       Company Number
     C                     PARM WHC4NB    WQ0137  70       Order Number
     C                     PARM WHDPNB    WQ0138  30       Order Sequence
     C                     PARM WHUENB    WQ0139  30       Order Secondary
     C                     PARM WHHGCD    WQ0140  70       Item Code
     C                     PARM WHAJCD    WQ0141  3        Warehouse Code
     C                     PARM WHAODT    WQ0142  70       Ship Date USR
     C                     PARM WHAVQT    WQ0143 112       Quantity Ordere
     C                     PARM WHD0WG    WQ0144 112       Weight Ordered
     C           YL0022    PARM YL0022    WQ0145 112       Quantity Schedu
     C           YL0023    PARM YL0023    WQ0146 112       Weight Schedule
     C                     PARM 'AO'      WQ0147  2        ATS Adj Type US
     C                     PARM @CN,004   WQ0148 10        PSAA Program Na
     C                     PARM WHRINY    WQ0149  40       Item Age Days
     C                     PARM WHTIDT    WQ0150  70       Production Ovr
     C                     PARM WHTJDT    WQ0151  70       Production Ovr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Chg Qty/WgtSch & Shrt CH - Order Detail  * 
     C                     EXSR NECHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@BGWKKJ                  90*
     C                     ENDDO
      * USER: Exit processing
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0152  30       Company Number
     C                     PARM YL0004    WQ0153  70       Order Number
     C                     PARM YL0006    WQ0154  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0155 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0156 112       Order Weight To
     C                     PARM 'PS'      WQ0157  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Order Type         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0021    WDAIC3           Company Number
     C                     Z-ADDWL0022    WDC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDJNCD    WL0023           Order Type - Sa
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0024    WIAIC3           Company Number
     C                     Z-ADDWL0025    WIHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0026           Description Lin
     C                     MOVEL*BLANK    WL0027           U/M - Primary
     C                     Z-ADD*ZERO     WL0028           Unit Weight
     C                     Z-ADD*ZERO     WL0029           Item Structure
     C                     Z-ADD*ZERO     WL0030           Item Structure
     C                     Z-ADD*ZERO     WL0031           Item Structure
     C                     MOVEL*BLANK    WL0032           Item Type Code
     C                     MOVEL*BLANK    WL0033           Default Warehou
     C                     Z-ADD*ZERO     WL0034           Fresh Chilling
     C                     MOVEL*BLANK    WL0035           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0036           Variety/Rendere
     C                     MOVEL*BLANK    WL0037           Credit Item Sta
     C                     Z-ADD*ZERO     WL0038           Std Weight/Head
     C                     Z-ADD*ZERO     WL0039           Pieces Per Head
     C                     MOVEL*BLANK    WL0040           Department Code
     C                     MOVEL*BLANK    WL0041           Group for Packa
     C                     MOVEL*BLANK    WL0042           Seconds Item
     C                     MOVEL*BLANK    WL0043           Piece Count Ite
     C                     Z-ADD*ZERO     WL0044           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0045           Bags Per Unit
     C                     MOVEL*BLANK    WL0046           Export/Domestic
     C                     MOVEL*BLANK    WL0047           Print On Schedu
     C                     MOVEL*BLANK    WL0048           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0049           Fresh Sched As
     C                     MOVEL*BLANK    WL0050           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0051           Primal Group Co
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIAVNA    WL0026           Description Lin
     C                     MOVELWIADCD    WL0027           U/M - Primary
     C                     Z-ADDWIAIWG    WL0028           Unit Weight
     C                     Z-ADDWIRINB    WL0029           Item Structure
     C                     Z-ADDWIRHNB    WL0030           Item Structure
     C                     Z-ADDWIRGNB    WL0031           Item Structure
     C                     MOVELWIN0CD    WL0032           Item Type Code
     C                     MOVELWIQ1CD    WL0033           Default Warehou
     C                     Z-ADDWICHTM    WL0034           Fresh Chilling
     C                     MOVELWIQZCD    WL0035           Base/Conv/Loss
     C                     MOVELWIXWST    WL0036           Variety/Rendere
     C                     MOVELWIVMST    WL0037           Credit Item Sta
     C                     Z-ADDWISWGH    WL0038           Std Weight/Head
     C                     Z-ADDWIPPHE    WL0039           Pieces Per Head
     C                     MOVELWIR3CD    WL0040           Department Code
     C                     MOVELWISDCD    WL0041           Group for Packa
     C                     MOVELWIX5ST    WL0042           Seconds Item
     C                     MOVELWIPCCT    WL0043           Piece Count Ite
     C                     Z-ADDWIBDNB    WL0044           Pieces Per Bag
     C                     Z-ADDWIBJNB    WL0045           Bags Per Unit
     C                     MOVELWISUST    WL0046           Export/Domestic
     C                     MOVELWISVST    WL0047           Print On Schedu
     C                     MOVELWISYST    WL0048           Fresh Inv Alloc
     C                     MOVELWISZST    WL0049           Fresh Sched As
     C                     MOVELWIS1ST    WL0050           Frozen Inv Allo
     C                     MOVELWIXRCD    WL0051           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WJAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0052    WJAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0053           Warehouse Type
     C                     MOVEL*BLANK    WL0054           Trans Contol AS
     C                     MOVEL*BLANK    WL0055           Warehouse Locat
     C                     MOVEL*BLANK    WL0056           Warehouse Std C
     C                     Z-ADD*ZERO     WL0057           Warehouse Chill
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJWPST    WL0053           Warehouse Type
     C                     MOVELWJXUST    WL0054           Trans Contol AS
     C                     MOVELWJT0ST    WL0055           Warehouse Locat
     C                     MOVELWJT1ST    WL0056           Warehouse Std C
     C                     Z-ADDWJDBNB    WL0057           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehous Inv ChillRT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAJCD           Warehouse Code
      * Setup key
     C                     MOVELWHAJCD    WJAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0021           WHS Inventory C
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJBVC3    YL0021           WHS Inventory C
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSO02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSO03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSO04           Order Secondary
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Order Sequence
     C                     KFLD           WQSO04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSO01           Company Number
     C                     Z-ADDWHC4NB    WQSO02           Order Number
     C                     Z-ADDWHDPNB    WQSO03           Order Sequence
     C                     Z-ADDWHUENB    WQSO04           Order Secondary
      * Establish starting position
     C           KRSSO     SETLL@KNCPHO                    *
     C           KRSSO     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADDWCDPNB    WL0008           Order Sequence
     C                     Z-ADDWCUENB    WL0009           Order Secondary
     C                     Z-ADDWCJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
     C           KRSSO     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSP02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSP03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSP04           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           WQSP03           Order Sequence
     C                     KFLD           WQSP04           Order Secondary
      * Setup key
     C                     Z-ADDWL0058    WQSP01           Company Number
     C                     Z-ADDWL0059    WQSP02           Order Number
     C                     Z-ADDWL0060    WQSP03           Order Sequence
     C                     Z-ADDWL0061    WQSP04           Order Secondary
      * Establish starting position
     C           KRSSP     SETLL@B6CPNB                    *
     C           KRSSP     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0011           Company Number
     C                     Z-ADDWFC4NB    WL0012           Order Number
     C                     Z-ADDWFDPNB    WL0013           Order Sequence
     C                     Z-ADDWFUENB    WL0014           Order Secondary
     C                     Z-ADDWFJGDT    WL0015           OD Production D
     C                     Z-ADDWFOONY    WL0016           ODS Sequence Nu
     C                     EXSR SHDLRC
     C           KRSSP     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0022  70       Item Code
     C                     MOVEL*BLANK    WN0023  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0024  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0025  70       Order Group Cod
     C                     MOVEL*BLANK    WN0026  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0027  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0028 112       Billing Detail
     C                     Z-ADD*ZERO     WN0029 112       Billing Detail
     C                     Z-ADD*ZERO     WN0030 112       Billing Detail
     C                     Z-ADD*ZERO     WN0031 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0032  1        Comment Print A
     C                     MOVEL*BLANK    WN0033  1        Comment Print I
     C                     MOVEL*BLANK    WN0034  1        Comment Print P
     C                     MOVEL*BLANK    WN0035  1        Comment Print S
     C                     Z-ADD*ZERO     WN0036 112       Extended Amount
     C                     Z-ADD*ZERO     WN0037  70       Market Pricing
     C                     MOVEL*BLANK    WN0038  3        Commodity Marke
     C                     MOVEL*BLANK    WN0039  3        Date Method Cod
     C                     MOVEL*BLANK    WN0040  3        Price Method Co
     C                     Z-ADD*ZERO     WN0041 114       Price Overage O
     C                     Z-ADD*ZERO     WN0042  70       Contract Number
     C                     MOVEL*BLANK    WN0043  1        Price Status
     C                     Z-ADD*ZERO     WN0044  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0045  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0046  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0047  1        Work Confirm St
     C                     MOVEL*BLANK    WN0048  1        Work Over/Short
     C                     MOVEL*BLANK    WN0049  1        OD Production P
     C                     MOVEL*BLANK    WN0050 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0051 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0052  1        Age Code
     C                     MOVEL*BLANK    WN0053  1        Palletize
     C                     MOVEL*BLANK    WN0054  1        Slip Sheet
     C                     MOVEL*BLANK    WN0055  1        Catch Weight St
     C                     MOVEL*BLANK    WN0056  1        Price Audit
     C                     MOVEL*BLANK    WN0057  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0058  1        Production Date
     C                     Z-ADD*ZERO     WN0059 112       Rated Freight
     C                     Z-ADD*ZERO     WN0060 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0061 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0062 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0063 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0064 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0065 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0066 114       Unit Price
     C                     Z-ADD*ZERO     WN0067 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0068 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0069 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0070 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0071  70       Requested Ship
     C                     Z-ADD*ZERO     WN0072  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0073  70       Actual Shipped
     C                     MOVEL*BLANK    WN0074  1        Affect Inventor
     C                     MOVEL*BLANK    WN0075  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0076  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0077  30       Item Structure
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     MOVEL*BLANK    WN0080  2        Item Level
     C                     MOVEL*BLANK    WN0081  2        Quality Level
     C                     MOVEL*BLANK    WN0082  2        Pricing Product
     C                     MOVEL*BLANK    WN0083  2        Season Product
     C                     Z-ADD*ZERO     WN0084  70       Date of Origina
     C                     MOVEL*BLANK    WN0085 10        User Profile Na
     C                     MOVEL*BLANK    WN0086  6        Country Code
     C                     MOVEL*BLANK    WN0087  2        Event Code
     C                     MOVEL*BLANK    WN0088  3        Reason Code
     C                     MOVEL*BLANK    WN0089  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0090  1        Modified Flag
     C                     MOVEL*BLANK    WN0091  1        Substituted Fla
     C                     MOVEL*BLANK    WN0092  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0093 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0094 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0095  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0096  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0097  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0098  1        Affect Commissi
     C                     MOVEL*BLANK    WN0099  1        Affect Pricing
     C                     MOVEL*BLANK    WN0100  1        Released by Use
     C                     MOVEL*BLANK    WN0101  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0102  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0103  3        Production Ware
     C                     MOVEL*BLANK    WN0104  3        OD Price Type
     C                     Z-ADD*ZERO     WN0105  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0106  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0107  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0108  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0109  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0110  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0111  60       Price Code
     C                     Z-ADD*ZERO     WN0112  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0113  60       Substitution Li
     C                     Z-ADD*ZERO     WN0114  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0115 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0116 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0117 112       OD Item Target
     C                     Z-ADD*ZERO     WN0118 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0119 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0120 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0121 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0122 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0123 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0124 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0125 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0126 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0127 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0128  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0129  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0130  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0131 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0132  40       Item Age Days
     C                     Z-ADD*ZERO     WN0133  70       Production Ovr
     C                     Z-ADD*ZERO     WN0134  70       Production Ovr
     C                     MOVEL*BLANK    WN0135  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0136  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0137  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0138  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0139  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0140  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0141  1        EDI Status 1
     C                     MOVEL*BLANK    WN0142  1        EDI Status 2
     C                     MOVEL*BLANK    WN0143  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0144  60       Job Time
     C                     MOVEL*BLANK    WN0145 10        User Id
     C                     MOVEL*BLANK    WN0146 10        Job Name
     C                     Z-ADD*ZERO     WN0147  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWHAIC3    WKAIC3           Company Number
     C                     Z-ADDWHC4NB    WKC4NB           Order Number
     C                     Z-ADDWHDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWHUENB    WKUENB           Order Secondary
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHSQ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0022    WKCCQT           Quantity Schedu
     C                     Z-ADDYL0023    WKAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * UPS Re-Alc Inv/Prod   RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Del OrdDtl Sch-Shortg RT - Order Detail Sched-Shortg  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0058           Company Number
     C                     Z-ADDWHC4NB    WL0059           Order Number
     C                     Z-ADDWHDPNB    WL0060           Order Sequence
     C                     Z-ADDWHUENB    WL0061           Order Secondary
     C                     EXSR SPRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0017           Company Number
     C                     Z-ADDWHC4NB    WL0018           Order Number
     C                     Z-ADDWHDPNB    WL0019           Order Sequence
     C                     Z-ADDWHUENB    WL0020           Order Secondary
     C                     EXSR SIRVGN
     C                     MOVEL*BLANK    YL0024           OD Adj Type Ove
     C                     Z-ADD*ZERO     YL0022           Quantity Schedu
     C                     Z-ADD*ZERO     YL0023           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WLC4NB    WQSR02           Order Number
     C           *LIKE     DEFN WLDPNB    WQSR03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQSR04           Order Secondary
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Order Sequence
     C                     KFLD           WQSR04           Order Secondary
      * Setup key
     C                     Z-ADDWHAIC3    WQSR01           Company Number
     C                     Z-ADDWHC4NB    WQSR02           Order Number
     C                     Z-ADDWHDPNB    WQSR03           Order Sequence
     C                     Z-ADDWHUENB    WQSR04           Order Secondary
      * Establish starting position
     C           KRSSR     SETLL@KNCPNF                    *
     C           KRSSR     READE@KNCPNF                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0062           Company Number
     C                     Z-ADDWLJGDT    WL0063           Post to G/L Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0064    YL0025    P      Production Day
      * S0538 RMC Always alloc orders 3/16/2010
     C                     MOVEL'Y'       YL0025           Production Day
      * FP1309 - Get order header info needed:   date and type Requested
      * RTV Avail-To-Sell RqShpRT - Order Header TRG  * 
     C                     EXSR STRVGN
      * Allocate Inventory/Production
      * CASE: LCL.Production Day Status is yes
     C           YL0025    IFEQ 'Y'                        *IF
      * Production Date < Job Date, Allocate Inventory
      * CASE: DB1.OD Production Date LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
      * Age Limit - us item age code or from and to date
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0019    IFEQ 'Y'                        *IF
      * CASE: PAR.WHS Inventory Chill Time is greater than zero
     C           YL0021    IFGT *ZERO                      *IF
     C                     Z-ADDYL0021    YL0027           Chill Time USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0020    YL0027           Chill Time USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0012    YL0027           Chill Time USR
     C                     END                             *FI
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0056  30       Company Number
     C                     PARM YL0028    WQ0057  52       Chilling Time U
     C                     PARM WLAODT    WQ0058  70       Scheduled Ship
     C                     PARM YL0026    WQ0059  70       Requested Deliv
     C                     PARM WHRINY    WQ0060  40       Item Age Days
     C                     PARM WHTIDT    WQ0061  70       Production Ovr
     C                     PARM WHTJDT    WQ0062  70       Production Ovr
     C           YL0029    PARM YL0029    WQ0063  70       Production AgeD
     C           YL0030    PARM YL0030    WQ0064  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Quantity Ordered
      * LCL.Quantity Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Qty/Cnsmd Pieces Sched
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.OD Quantity Inv Sched
     C           WLIGQT    ADD  WLIUQT    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0031           Quantity Ordere
      * Weight Ordered
      * LCL.Weight Ordered =
      *    *COMPUTE (x1 + x2)
      * x1    : DB1.OD Weight Scheduled
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.OD Weight Inv Sched
     C           WLFLWG    ADD  WLF3WG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0032           Weight Ordered
      * Delete old record with Prod Date < Job Date
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0006           Company Number
     C                     Z-ADDWLC4NB    WL0007           Order Number
     C                     Z-ADDWLDPNB    WL0008           Order Sequence
     C                     Z-ADDWLUENB    WL0009           Order Secondary
     C                     Z-ADDWLJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
      * Quantity Ordered > 0
      * CASE: LCL.Quantity Ordered is Greater than zero
     C           YL0031    IFGT *ZERO                      *IF
     C                     Z-ADD##JDT     YL0033           Production Date
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
     C                     Z-ADDYL0031    YL0036           ATS Quantity Ne
     C                     Z-ADDYL0032    YL0037           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0148 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0149 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0150 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0151  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * FP1054 4/14/09 Changed to pass par.to date usr to RTV
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFLT ##JDT                      *IF
     C           YL0036    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0065           Company Number
     C                     Z-ADDWLHGCD    WL0066           Item Code
     C                     MOVELWLAJCD    WL0067    P      Warehouse Code
     C                     Z-ADDYL0038    WL0068           Production Date
     C                     Z-ADDYL0011    WL0069           Unit Weight
     C                     MOVELYL0015    WL0070    P      Piece Count Ite
     C                     Z-ADDYL0016    WL0071           Pieces Per Bag
     C                     Z-ADDYL0017    WL0072           Bags Per Unit
     C                     Z-ADDWLC4NB    WL0073           Order Number
     C                     Z-ADDWLDPNB    WL0074           Order Sequence
     C                     Z-ADDWLUENB    WL0075           Order Secondary
     C                     Z-ADDYL0031    WL0076           Quantity Ordere
     C                     Z-ADDYL0032    WL0077           Weight Ordered
     C                     Z-ADDYL0034    WL0078           Quantity Schedu
     C                     Z-ADDYL0035    WL0079           Weight Schedule
     C                     Z-ADDYL0036    WL0080           ATS Quantity Ne
     C                     Z-ADDYL0037    WL0081           ATS Weight Need
     C                     Z-ADDWLAODT    WL0082           Ship Date USR
     C                     Z-ADD##JDT     WL0083           To Date
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    YL0034           Quantity Schedu
     C                     Z-ADDWL0079    YL0035           Weight Schedule
     C                     Z-ADDWL0080    YL0036           ATS Quantity Ne
     C                     Z-ADDWL0081    YL0037           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0034    YL0022           Quantity Schedu
     C                     ADD  YL0035    YL0023           Weight Schedule
     C                     END                             *FI
      * Production Date > or = Job Date, Allocate Inv, Prod, or Std
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WLJGDT    IFGE ##JDT                      *IF
     C                     Z-ADDWLJGDT    YL0033           Production Date
     C                     Z-ADDWLIUQT    YL0043           OD Quantity Inv
     C                     Z-ADDWLF3WG    YL0044           OD Weight Inv S
     C                     Z-ADDWLIGQT    YL0045           OD Qty/Cnsmd Pi
     C                     Z-ADDWLFLWG    YL0046           OD Weight Sched
      * Delete old record with Prod Date < Job Date
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0006           Company Number
     C                     Z-ADDWLC4NB    WL0007           Order Number
     C                     Z-ADDWLDPNB    WL0008           Order Sequence
     C                     Z-ADDWLUENB    WL0009           Order Secondary
     C                     Z-ADDWLJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
      * Allocate Inventory
      * CASE: LCL.OD Quantity Inv Sched is GT Zero
     C           YL0043    IFGT *ZERO                      *IF
      * Age Limit  use item age days or from / to date
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0019    IFEQ 'Y'                        *IF
      * CASE: PAR.WHS Inventory Chill Time is greater than zero
     C           YL0021    IFGT *ZERO                      *IF
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0065  30       Company Number
     C                     PARM YL0021    WQ0066  52       Chilling Time U
     C                     PARM WLAODT    WQ0067  70       Scheduled Ship
     C                     PARM YL0026    WQ0068  70       Requested Deliv
     C                     PARM WHRINY    WQ0069  40       Item Age Days
     C                     PARM WHTIDT    WQ0070  70       Production Ovr
     C                     PARM WHTJDT    WQ0071  70       Production Ovr
     C           YL0029    PARM YL0029    WQ0072  70       Production AgeD
     C           YL0030    PARM YL0030    WQ0073  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0074  30       Company Number
     C                     PARM YL0020    WQ0075  52       Chilling Time U
     C                     PARM WLAODT    WQ0076  70       Scheduled Ship
     C                     PARM YL0026    WQ0077  70       Requested Deliv
     C                     PARM WHRINY    WQ0078  40       Item Age Days
     C                     PARM WHTIDT    WQ0079  70       Production Ovr
     C                     PARM WHTJDT    WQ0080  70       Production Ovr
     C           YL0029    PARM YL0029    WQ0081  70       Production AgeD
     C           YL0030    PARM YL0030    WQ0082  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0083  30       Company Number
     C                     PARM YL0012    WQ0084  52       Chilling Time U
     C                     PARM WLAODT    WQ0085  70       Scheduled Ship
     C                     PARM YL0026    WQ0086  70       Requested Deliv
     C                     PARM WHRINY    WQ0087  40       Item Age Days
     C                     PARM WHTIDT    WQ0088  70       Production Ovr
     C                     PARM WHTJDT    WQ0089  70       Production Ovr
     C           YL0029    PARM YL0029    WQ0090  70       Production AgeD
     C           YL0030    PARM YL0030    WQ0091  70       Production AgeD
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADDYL0043    YL0031           Quantity Ordere
     C                     Z-ADDYL0044    YL0032           Weight Ordered
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
     C                     Z-ADDYL0031    YL0036           ATS Quantity Ne
     C                     Z-ADDYL0032    YL0037           ATS Weight Need
      * ** This will create the new order detail schedule record **
      *    for the current date.
      *
     C                     Z-ADD*ZERO     WN0287 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0288 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0289 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0290  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * FP1054 4/14/09 Changed to pass par.to date usr to RTV
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0038    IFLT ##JDT                      *IF
     C           YL0036    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0065           Company Number
     C                     Z-ADDWLHGCD    WL0066           Item Code
     C                     MOVELWLAJCD    WL0067    P      Warehouse Code
     C                     Z-ADDYL0038    WL0068           Production Date
     C                     Z-ADDYL0011    WL0069           Unit Weight
     C                     MOVELYL0015    WL0070    P      Piece Count Ite
     C                     Z-ADDYL0016    WL0071           Pieces Per Bag
     C                     Z-ADDYL0017    WL0072           Bags Per Unit
     C                     Z-ADDWLC4NB    WL0073           Order Number
     C                     Z-ADDWLDPNB    WL0074           Order Sequence
     C                     Z-ADDWLUENB    WL0075           Order Secondary
     C                     Z-ADDYL0031    WL0076           Quantity Ordere
     C                     Z-ADDYL0032    WL0077           Weight Ordered
     C                     Z-ADDYL0034    WL0078           Quantity Schedu
     C                     Z-ADDYL0035    WL0079           Weight Schedule
     C                     Z-ADDYL0036    WL0080           ATS Quantity Ne
     C                     Z-ADDYL0037    WL0081           ATS Weight Need
     C                     Z-ADDWLAODT    WL0082           Ship Date USR
     C                     Z-ADD##JDT     WL0083           To Date
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    YL0034           Quantity Schedu
     C                     Z-ADDWL0079    YL0035           Weight Schedule
     C                     Z-ADDWL0080    YL0036           ATS Quantity Ne
     C                     Z-ADDWL0081    YL0037           ATS Weight Need
     C                     END                             *FI
     C                     ADD  YL0034    YL0022           Quantity Schedu
     C                     ADD  YL0035    YL0023           Weight Schedule
     C                     END                             *FI
      * Allocate Production Or Standard
      * CASE: LCL.OD Quantity Scheduled is Greater than zero
     C           YL0045    IFGT *ZERO                      *IF
     C                     Z-ADDYL0045    YL0031           Quantity Ordere
     C                     Z-ADDYL0046    YL0032           Weight Ordered
     C                     Z-ADDYL0045    YL0036           ATS Quantity Ne
     C                     Z-ADDYL0046    YL0037           ATS Weight Need
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
      * If Base, allocated Production. If Converted, allocate Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0013    IFEQ 'B'                        *IF
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLAJCD    WL0110    P      Warehouse Code
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0111    YL0047    P      Production Ware
     C                     Z-ADDWL0112    YL0048           Accounting Comp
      *
     C                     MOVEL*BLANK    WN0291  1        Production Type
     C                     Z-ADD*ZERO     WN0292 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0293 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0294  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0295 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0296  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0297  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0298  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0299  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0300  52       Production Yiel
     C                     Z-ADD*ZERO     WN0301  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0302 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UASUBR                     documentation
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           YL0018    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
     C                     EXSR TFRVGN
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0019    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0020    WN0298           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0012    WN0298           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWLJGDT    YL0052           Production Date
      * DOC:  Allocation
     C                     EXSR UBSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0049    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0033           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWLJGDT    YL0052           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLJGDT    YL0033           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0033    IFLE YL0052                     *IF
     C           YL0036    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0062           Company Number
     C                     Z-ADDYL0033    WL0063           Post to G/L Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0064    YL0053    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0113           Company Number
     C                     Z-ADDWLHGCD    WL0114           Item Code
     C                     Z-ADDYL0033    WL0115           Production Date
     C                     MOVELYL0054    WL0116    P      Production Day
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0116    YL0054    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0053    IFEQ 'Y'                        *IF
     C           YL0054    IFEQ *BLANK                     *IF
     C           YL0054    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0033    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0291           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0117           Company Number
     C                     MOVELWN0291    WL0118    P      Production Type
     C                     Z-ADDYL0033    WL0119           Production Date
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0120    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0033    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0121           Company Number
     C                     MOVELWN0291    WL0122    P      Production Type
     C                     Z-ADDYL0033    WL0123           Production Date
     C                     Z-ADDWLHGCD    WL0124           Item Code
     C                     MOVELWLAJCD    WL0125    P      Warehouse Code
     C                     Z-ADDWN0293    WL0127           ATS Weight Avai
     C                     Z-ADDWN0294    WL0128           ATS Pieces Avai
     C                     Z-ADDWN0298    WL0129           Chilling Time U
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    WN0299           PS Avg Piece Wg
     C                     Z-ADDWL0127    WN0293           ATS Weight Avai
     C                     Z-ADDWL0128    WN0294           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFGT *ZERO                      *IF
     C           YL0017    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0016    MULT YL0017    W0WJ01           *Synon (15,0) w
     C           WN0294    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ *BLANK                     *IF
     C           YL0015    OREQ 'N'
     C           YL0011    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0293    DIV  YL0011    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0292    IFLT YL0036                     *IF
     C                     Z-ADDYL0036    WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0292    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0036    IFGT WN0292                     *IF
     C                     ADD  WN0292    YL0034           Quantity Schedu
     C           WN0292    MULT YL0011    WN0293           ATS Weight Avai
     C                     ADD  WN0293    YL0035           Weight Schedule
     C                     Z-ADDWN0293    WN0296           Weight Allocate
     C                     Z-ADDWN0292    WN0295           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0036    IFLE WN0292                     *IF
     C                     ADD  YL0036    YL0034           Quantity Schedu
     C           YL0036    MULT YL0011    YL0037           ATS Weight Need
     C                     ADD  YL0037    YL0035           Weight Schedule
     C                     Z-ADDYL0037    WN0296           Weight Allocate
     C                     Z-ADDYL0036    WN0295           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0295    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0015    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0295    MULT YL0016    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0297           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0297    MULT WN0299    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0296           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFEQ WLAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0130           Company Number
     C                     Z-ADDWLC4NB    WL0131           Order Number
     C                     Z-ADDWLDPNB    WL0132           Order Sequence
     C                     Z-ADDWLUENB    WL0133           Order Secondary
     C                     Z-ADDYL0033    WL0134           OD Production D
     C                     Z-ADDWLAODT    WL0135           Scheduled Ship
     C                     MOVELWLAJCD    WL0136    P      Warehouse Code
     C                     MOVELWLAJCD    WL0137    P      Order From Ware
     C                     Z-ADDWLHGCD    WL0138           Item Code
     C                     Z-ADDWN0296    WL0139           Weight Allocate
     C                     Z-ADDWN0295    WL0140           Quantity Alloca
     C                     MOVELYL0013    WL0141    P      Base/Conv/Loss
     C                     EXSR TNRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFNE WLAJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0013    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0142           Company Number
     C                     MOVELWN0291    WL0143    P      Production Type
     C                     Z-ADDYL0033    WL0144           Production Date
     C                     Z-ADDWLHGCD    WL0145           Item Code
     C                     MOVELWLAJCD    WL0146    P      Warehouse Code
     C                     Z-ADDWN0296    WL0147           Weight Allocate
     C                     Z-ADDWN0297    WL0148           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0149           Order Number
     C                     Z-ADDWLDPNB    WL0150           Order Sequence
     C                     Z-ADDWLUENB    WL0151           Order Secondary
     C                     MOVEL'N'       WL0152    P      Status Flag 19
     C                     EXSR TPRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0240           Company Number
     C                     MOVELWN0291    WL0241    P      Production Type
     C                     Z-ADDYL0033    WL0242           Production Date
     C                     Z-ADDWLHGCD    WL0243           Item Code
     C                     MOVELWLAJCD    WL0244    P      Warehouse Code
     C                     Z-ADDWN0297    WL0245           Pieces Schedule
     C                     Z-ADDWN0296    WL0246           Weight Schedule
     C                     EXSR TTRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0247           Company Number
     C                     MOVELWN0291    WL0248    P      Production Type
     C                     Z-ADDYL0033    WL0249           Production Date
     C                     Z-ADDWLHGCD    WL0250           Item Code
     C                     MOVELWLAJCD    WL0251    P      Warehouse Code
     C                     Z-ADDWN0296    WL0252           Weight Allocate
     C                     Z-ADDWN0297    WL0253           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0254           Order Number
     C                     Z-ADDWLDPNB    WL0255           Order Sequence
     C                     Z-ADDWLUENB    WL0256           Order Secondary
     C                     MOVEL'N'       WL0257    P      Status Flag 19
     C                     EXSR TVRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0295           Quantity Alloca
     C                     Z-ADD*ZERO     WN0296           Weight Allocate
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0034           Quantity Schedu
     C                     ADD  *ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0288           Company Number
     C                     Z-ADDYL0033    WL0289           Post to G/L Dat
     C                     Z-ADDYL0033    WL0291           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0292           *Duration (fact
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0290    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0293           Company Number
     C                     Z-ADDYL0033    WL0294           Post to G/L Dat
     C                     Z-ADDYL0033    WL0296           *Date2 (beginni
     C                     Z-ADD1         WL0297           *Duration (fact
     C                     EXSR NDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0295    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDYL0033    YL0033           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0031    SUB  YL0034    YL0036           ATS Quantity Ne
     C           YL0032    SUB  YL0035    YL0037           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0049    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWLJGDT    YL0061           Production Date
     C                     Z-ADDWLJGDT    YL0033           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0061           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWLJGDT    YL0052           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLJGDT    YL0033           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0033    IFGE YL0061                     *IF
     C           YL0036    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0062           Company Number
     C                     Z-ADDYL0033    WL0063           Post to G/L Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0064    YL0053    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0113           Company Number
     C                     Z-ADDWLHGCD    WL0114           Item Code
     C                     Z-ADDYL0033    WL0115           Production Date
     C                     MOVELYL0054    WL0116    P      Production Day
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0116    YL0054    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0053    IFEQ 'Y'                        *IF
     C           YL0054    IFEQ *BLANK                     *IF
     C           YL0054    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0033    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0291           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0117           Company Number
     C                     MOVELWN0291    WL0118    P      Production Type
     C                     Z-ADDYL0033    WL0119           Production Date
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0120    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0033    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0121           Company Number
     C                     MOVELWN0291    WL0122    P      Production Type
     C                     Z-ADDYL0033    WL0123           Production Date
     C                     Z-ADDWLHGCD    WL0124           Item Code
     C                     MOVELWLAJCD    WL0125    P      Warehouse Code
     C                     Z-ADDWN0293    WL0127           ATS Weight Avai
     C                     Z-ADDWN0294    WL0128           ATS Pieces Avai
     C                     Z-ADDWN0298    WL0129           Chilling Time U
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    WN0299           PS Avg Piece Wg
     C                     Z-ADDWL0127    WN0293           ATS Weight Avai
     C                     Z-ADDWL0128    WN0294           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFGT *ZERO                      *IF
     C           YL0017    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0016    MULT YL0017    W0WJ01           *Synon (15,0) w
     C           WN0294    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ *BLANK                     *IF
     C           YL0015    OREQ 'N'
     C           YL0011    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0293    DIV  YL0011    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0292    IFLT YL0036                     *IF
     C                     Z-ADDYL0036    WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0292    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0036    IFGT WN0292                     *IF
     C                     ADD  WN0292    YL0034           Quantity Schedu
     C           WN0292    MULT YL0011    WN0293           ATS Weight Avai
     C                     ADD  WN0293    YL0035           Weight Schedule
     C                     Z-ADDWN0293    WN0296           Weight Allocate
     C                     Z-ADDWN0292    WN0295           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0036    IFLE WN0292                     *IF
     C                     ADD  YL0036    YL0034           Quantity Schedu
     C           YL0036    MULT YL0011    YL0037           ATS Weight Need
     C                     ADD  YL0037    YL0035           Weight Schedule
     C                     Z-ADDYL0037    WN0296           Weight Allocate
     C                     Z-ADDYL0036    WN0295           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0295    IFGT *ZERO                      *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           YL0015    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0295    MULT YL0016    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0297           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0297    MULT WN0299    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0296           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFEQ WLAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0130           Company Number
     C                     Z-ADDWLC4NB    WL0131           Order Number
     C                     Z-ADDWLDPNB    WL0132           Order Sequence
     C                     Z-ADDWLUENB    WL0133           Order Secondary
     C                     Z-ADDYL0033    WL0134           OD Production D
     C                     Z-ADDWLAODT    WL0135           Scheduled Ship
     C                     MOVELWLAJCD    WL0136    P      Warehouse Code
     C                     MOVELWLAJCD    WL0137    P      Order From Ware
     C                     Z-ADDWLHGCD    WL0138           Item Code
     C                     Z-ADDWN0296    WL0139           Weight Allocate
     C                     Z-ADDWN0295    WL0140           Quantity Alloca
     C                     MOVELYL0013    WL0141    P      Base/Conv/Loss
     C                     EXSR TNRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFNE WLAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           YL0013    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0142           Company Number
     C                     MOVELWN0291    WL0143    P      Production Type
     C                     Z-ADDYL0033    WL0144           Production Date
     C                     Z-ADDWLHGCD    WL0145           Item Code
     C                     MOVELWLAJCD    WL0146    P      Warehouse Code
     C                     Z-ADDWN0296    WL0147           Weight Allocate
     C                     Z-ADDWN0297    WL0148           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0149           Order Number
     C                     Z-ADDWLDPNB    WL0150           Order Sequence
     C                     Z-ADDWLUENB    WL0151           Order Secondary
     C                     MOVEL'N'       WL0152    P      Status Flag 19
     C                     EXSR TPRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0240           Company Number
     C                     MOVELWN0291    WL0241    P      Production Type
     C                     Z-ADDYL0033    WL0242           Production Date
     C                     Z-ADDWLHGCD    WL0243           Item Code
     C                     MOVELWLAJCD    WL0244    P      Warehouse Code
     C                     Z-ADDWN0297    WL0245           Pieces Schedule
     C                     Z-ADDWN0296    WL0246           Weight Schedule
     C                     EXSR TTRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0247           Company Number
     C                     MOVELWN0291    WL0248    P      Production Type
     C                     Z-ADDYL0033    WL0249           Production Date
     C                     Z-ADDWLHGCD    WL0250           Item Code
     C                     MOVELWLAJCD    WL0251    P      Warehouse Code
     C                     Z-ADDWN0296    WL0252           Weight Allocate
     C                     Z-ADDWN0297    WL0253           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0254           Order Number
     C                     Z-ADDWLDPNB    WL0255           Order Sequence
     C                     Z-ADDWLUENB    WL0256           Order Secondary
     C                     MOVEL'N'       WL0257    P      Status Flag 19
     C                     EXSR TVRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0295           Quantity Alloca
     C                     Z-ADD*ZERO     WN0296           Weight Allocate
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0034           Quantity Schedu
     C                     ADD  *ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0288           Company Number
     C                     Z-ADDYL0033    WL0289           Post to G/L Dat
     C                     Z-ADDYL0033    WL0291           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0292           *Duration (fact
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0290    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0293           Company Number
     C                     Z-ADDYL0033    WL0294           Post to G/L Dat
     C                     Z-ADDYL0033    WL0296           *Date2 (beginni
     C                     Z-ADD-1        WL0297           *Duration (fact
     C                     EXSR NDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0295    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0033    YL0033           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0031    SUB  YL0034    YL0036           ATS Quantity Ne
     C           YL0032    SUB  YL0035    YL0037           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0031    SUB  YL0034    YL0036           ATS Quantity Ne
     C           YL0032    SUB  YL0035    YL0037           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           YL0018    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0062           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           YL0019    IFEQ 'Y'                        *IF
     C                     Z-ADDYL0020    WN0298           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0012    WN0298           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDWLJGDT    YL0052           Production Date
      * DOC:  Allocation
     C                     EXSR UCSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0062    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDWLJGDT    YL0061           Production Date
     C                     Z-ADDWLJGDT    YL0033           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0061           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           WLJGDT    IFLT ##JDT                      *IF
     C                     Z-ADDWLJGDT    YL0052           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLJGDT    YL0033           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0033    IFGE YL0061                     *IF
     C           YL0036    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0062           Company Number
     C                     Z-ADDYL0033    WL0063           Post to G/L Dat
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0064    YL0053    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0113           Company Number
     C                     Z-ADDWLHGCD    WL0114           Item Code
     C                     Z-ADDYL0033    WL0115           Production Date
     C                     MOVELYL0054    WL0116    P      Production Day
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0116    YL0054    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0053    IFEQ 'Y'                        *IF
     C           YL0054    IFEQ *BLANK                     *IF
     C           YL0054    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0033    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0291           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0117           Company Number
     C                     MOVELWN0291    WL0118    P      Production Type
     C                     Z-ADDYL0033    WL0119           Production Date
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0120    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0033    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0291           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0121           Company Number
     C                     MOVELWN0291    WL0122    P      Production Type
     C                     Z-ADDYL0033    WL0123           Production Date
     C                     Z-ADDWLHGCD    WL0124           Item Code
     C                     MOVELWLAJCD    WL0125    P      Warehouse Code
     C                     Z-ADDWN0293    WL0127           ATS Weight Avai
     C                     Z-ADDWN0294    WL0128           ATS Pieces Avai
     C                     Z-ADDWN0298    WL0129           Chilling Time U
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    WN0299           PS Avg Piece Wg
     C                     Z-ADDWL0127    WN0293           ATS Weight Avai
     C                     Z-ADDWL0128    WN0294           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFGT *ZERO                      *IF
     C           YL0017    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           YL0016    MULT YL0017    W0WJ01           *Synon (15,0) w
     C           WN0294    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ *BLANK                     *IF
     C           YL0015    OREQ 'N'
     C           YL0011    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0293    DIV  YL0011    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0292           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           'AO'      IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0292    IFLT YL0036                     *IF
     C                     Z-ADDYL0036    WN0292           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0292    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           YL0036    IFGT WN0292                     *IF
     C                     ADD  WN0292    YL0034           Quantity Schedu
     C           WN0292    MULT YL0011    WN0293           ATS Weight Avai
     C                     ADD  WN0293    YL0035           Weight Schedule
     C                     Z-ADDWN0293    WN0296           Weight Allocate
     C                     Z-ADDWN0292    WN0295           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           YL0036    IFLE WN0292                     *IF
     C                     ADD  YL0036    YL0034           Quantity Schedu
     C           YL0036    MULT YL0011    YL0037           ATS Weight Need
     C                     ADD  YL0037    YL0035           Weight Schedule
     C                     Z-ADDYL0037    WN0296           Weight Allocate
     C                     Z-ADDYL0036    WN0295           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0295    IFGT *ZERO                      *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           YL0015    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0295    MULT YL0016    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0297           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0297    MULT WN0299    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0296           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFEQ WLAJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0130           Company Number
     C                     Z-ADDWLC4NB    WL0131           Order Number
     C                     Z-ADDWLDPNB    WL0132           Order Sequence
     C                     Z-ADDWLUENB    WL0133           Order Secondary
     C                     Z-ADDYL0033    WL0134           OD Production D
     C                     Z-ADDWLAODT    WL0135           Scheduled Ship
     C                     MOVELWLAJCD    WL0136    P      Warehouse Code
     C                     MOVELWLAJCD    WL0137    P      Order From Ware
     C                     Z-ADDWLHGCD    WL0138           Item Code
     C                     Z-ADDWN0296    WL0139           Weight Allocate
     C                     Z-ADDWN0295    WL0140           Quantity Alloca
     C                     MOVELYL0013    WL0141    P      Base/Conv/Loss
     C                     EXSR TNRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           WLAJCD    IFNE WLAJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0142           Company Number
     C                     MOVELWN0291    WL0143    P      Production Type
     C                     Z-ADDYL0033    WL0144           Production Date
     C                     Z-ADDWLHGCD    WL0145           Item Code
     C                     MOVELWLAJCD    WL0146    P      Warehouse Code
     C                     Z-ADDWN0296    WL0147           Weight Allocate
     C                     Z-ADDWN0297    WL0148           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0149           Order Number
     C                     Z-ADDWLDPNB    WL0150           Order Sequence
     C                     Z-ADDWLUENB    WL0151           Order Secondary
     C                     MOVEL'N'       WL0152    P      Status Flag 19
     C                     EXSR TPRVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0240           Company Number
     C                     MOVELWN0291    WL0241    P      Production Type
     C                     Z-ADDYL0033    WL0242           Production Date
     C                     Z-ADDWLHGCD    WL0243           Item Code
     C                     MOVELWLAJCD    WL0244    P      Warehouse Code
     C                     Z-ADDWN0297    WL0245           Pieces Schedule
     C                     Z-ADDWN0296    WL0246           Weight Schedule
     C                     EXSR TTRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0247           Company Number
     C                     MOVELWN0291    WL0248    P      Production Type
     C                     Z-ADDYL0033    WL0249           Production Date
     C                     Z-ADDWLHGCD    WL0250           Item Code
     C                     MOVELWLAJCD    WL0251    P      Warehouse Code
     C                     Z-ADDWN0296    WL0252           Weight Allocate
     C                     Z-ADDWN0297    WL0253           Pieces Allocate
     C                     Z-ADDWLC4NB    WL0254           Order Number
     C                     Z-ADDWLDPNB    WL0255           Order Sequence
     C                     Z-ADDWLUENB    WL0256           Order Secondary
     C                     MOVEL'N'       WL0257    P      Status Flag 19
     C                     EXSR TVRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0295           Quantity Alloca
     C                     Z-ADD*ZERO     WN0296           Weight Allocate
     C                     Z-ADD*ZERO     YL0034           Quantity Schedu
     C                     Z-ADD*ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     YL0034           Quantity Schedu
     C                     ADD  *ZERO     YL0035           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0288           Company Number
     C                     Z-ADDYL0033    WL0289           Post to G/L Dat
     C                     Z-ADDYL0033    WL0291           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0292           *Duration (fact
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0290    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0293           Company Number
     C                     Z-ADDYL0033    WL0294           Post to G/L Dat
     C                     Z-ADDYL0033    WL0296           *Date2 (beginni
     C                     Z-ADD-1        WL0297           *Duration (fact
     C                     EXSR NDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0295    YL0033           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0033    YL0033           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           YL0031    SUB  YL0034    YL0036           ATS Quantity Ne
     C           YL0032    SUB  YL0035    YL0037           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           YL0031    SUB  YL0034    YL0036           ATS Quantity Ne
     C           YL0032    SUB  YL0035    YL0037           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           YL0013    IFEQ 'C'                        *IF
     C           YL0013    OREQ 'F'
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAJCD    WQ0092  3        Warehouse Code
     C                     PARM WLAIC3    WQ0093  30       Company Number
     C                     PARM WLHGCD    WQ0094  70       Item Code
     C           YL0033    PARM YL0033    WQ0095  70       Production Date
     C                     PARM YL0010    WQ0096  2        U/M - Primary
     C                     PARM YL0011    WQ0097 112       Unit Weight
     C                     PARM YL0012    WQ0098  52       Fresh Chilling
     C                     PARM YL0015    WQ0099  1        Piece Count Ite
     C                     PARM YL0016    WQ0100  70       Pieces Per Bag
     C                     PARM YL0017    WQ0101  70       Bags Per Unit
     C                     PARM YL0018    WQ0102  2        Warehouse Type
     C                     PARM YL0019    WQ0103  1        Warehouse Std C
     C                     PARM YL0020    WQ0104  52       Warehouse Chill
     C                     PARM WLC4NB    WQ0105  70       Order Number
     C                     PARM WLDPNB    WQ0106  30       Order Sequence
     C                     PARM WLUENB    WQ0107  30       Order Secondary
     C                     PARM WLJGDT    WQ0108  70       Production Date
     C                     PARM WLJGDT    WQ0109  70       Production Date
     C                     PARM YL0031    WQ0110 112       Quantity Ordere
     C                     PARM YL0032    WQ0111 112       Weight Ordered
     C           YL0034    PARM YL0034    WQ0112 112       Quantity Schedu
     C           YL0035    PARM YL0035    WQ0113 112       Weight Schedule
     C           YL0036    PARM YL0036    WQ0114 112       ATS Quantity Ne
     C           YL0037    PARM YL0037    WQ0115 112       ATS Weight Need
     C                     PARM WLAODT    WQ0116  70       Ship Date USR
     C                     PARM 'AO'      WQ0117  2        ATS Adj Type US
     C                     PARM @CN,006   WQ0118 10        PSAA Program Na
     C                     PARM WLAYAA    WQ0119  3        Order From Ware
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0034    YL0022           Quantity Schedu
     C                     ADD  YL0035    YL0023           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * The date the production was scheduled for is no longer a
      *   production day.
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0006           Company Number
     C                     Z-ADDWLC4NB    WL0007           Order Number
     C                     Z-ADDWLDPNB    WL0008           Order Sequence
     C                     Z-ADDWLUENB    WL0009           Order Secondary
     C                     Z-ADDWLJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0017           Company Number
     C                     Z-ADDWLC4NB    WL0018           Order Number
     C                     Z-ADDWLDPNB    WL0019           Order Sequence
     C                     Z-ADDWLUENB    WL0020           Order Secondary
     C                     EXSR SIRVGN
      * Del OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0058           Company Number
     C                     Z-ADDWLC4NB    WL0059           Order Number
     C                     Z-ADDWLDPNB    WL0060           Order Sequence
     C                     Z-ADDWLUENB    WL0061           Order Secondary
     C                     EXSR SPRVGN
     C                     END                             *FI
     C           KRSSR     READE@KNCPNF                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0062    WMAIC3           Company Number
     C                     Z-ADDWL0063    WMBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSS     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0064           Production Day
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMWAST    WL0064           Production Day
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Avail-To-Sell RqShpRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWLAIC3    WDAIC3           Company Number
     C                     Z-ADDWLC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDEIDT    YL0026           Requested Deliv
     C                     GOTO STEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0152 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0153 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0154  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0155 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0156  92       Weight Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0155           Quantity Alloca
     C                     Z-ADD*ZERO     WN0156           Weight Allocate
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WOHGCD    WQSU02           Item Code
     C           *LIKE     DEFN WOAJCD    WQSU03           Warehouse Code
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Item Code
     C                     KFLD           WQSU03           Warehouse Code
     C                     KFLD           WOELDT           Production Date
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Item Code
     C                     KFLD           WQSU03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0065    WQSU01           Company Number
     C                     Z-ADDWL0066    WQSU02           Item Code
     C                     MOVELWL0067    WQSU03           Warehouse Code
     C                     Z-ADDWL0068    WOELDT           Production Date
      * Establish starting position
     C           KPSSU     SETLL@CWCPQW                    *
     C           KRSSU     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * FP1054 this used to quit when the job date was reached.
      *   now it quits when par.to date is reached. for the freezer it wi
      *   be the freeze time number of days before the sched ship.
      *   For Fresh, it will be the job date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Production Date GE PAR.To Date               USR
      *   |- c2    : PAR.ATS Quantity Need USR is Less than or equal zero
      *   '-
     C           WOELDT    IFGE WL0083                     *IF
     C           WL0080    ORLE *ZERO                      *OR
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SVRVGN
     C           WOARQT    SUB  YL0039    WN0152           ATS Quantity Av
     C           WOACWG    SUB  YL0040    WN0153           ATS Weight Avai
      * Allocate Available Inventory
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0152    IFGT *ZERO                      *IF
      * Allocate
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WL0080    IFGT WN0152                     *IF
     C                     ADD  WN0152    WL0078           Quantity Schedu
     C           WN0152    MULT WL0069    WN0153           ATS Weight Avai
     C                     ADD  WN0153    WL0079           Weight Schedule
     C                     Z-ADDWN0152    WN0155           Quantity Alloca
     C                     Z-ADDWN0153    WN0156           Weight Allocate
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WL0080    IFLE WN0152                     *IF
     C                     ADD  WL0080    WL0078           Quantity Schedu
     C                     ADD  WL0081    WL0079           Weight Schedule
     C                     Z-ADDWL0080    WN0155           Quantity Alloca
     C           WN0155    MULT WL0069    WN0156           Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     WL0078           Quantity Schedu
     C                     ADD  *ZERO     WL0079           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SWRVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
     C                     EXSR SZRVGN
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C           WL0076    SUB  WL0078    WL0080           ATS Quantity Ne
     C           WL0077    SUB  WL0079    WL0081           ATS Weight Need
     C           KRSSU     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0039           OD Quantity Inv
     C                     Z-ADD*ZERO     YL0040           OD Weight Inv S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WRHGCD    WQSV02           Item Code
     C           *LIKE     DEFN WRAJCD    WQSV03           Warehouse Code
     C           *LIKE     DEFN WRJGDT    WQSV04           OD Production D
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Item Code
     C                     KFLD           WQSV03           Warehouse Code
     C                     KFLD           WQSV04           OD Production D
      * Setup key
     C                     Z-ADDWOAIC3    WQSV01           Company Number
     C                     Z-ADDWOHGCD    WQSV02           Item Code
     C                     MOVELWOAJCD    WQSV03           Warehouse Code
     C                     Z-ADDWOELDT    WQSV04           OD Production D
      * Establish starting position
     C           KRSSV     SETLL@B5CPM4                    *
     C           KRSSV     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WRIUQT    YL0039           OD Quantity Inv
     C                     ADD  WRF3WG    YL0040           OD Weight Inv S
     C           KRSSV     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0157  1        EDI Status 1
     C                     MOVEL*BLANK    WN0158  1        EDI Status 2
     C                     MOVEL*BLANK    WN0159  1        EDI Status 3
     C                     MOVEL*BLANK    WN0160  1        Record Status
     C                     Z-ADD*ZERO     WN0161  60       Job Time
     C                     MOVEL*BLANK    WN0162 10        User Id
     C                     MOVEL*BLANK    WN0163 10        Job Name
     C                     Z-ADD*ZERO     WN0164  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C                     KFLD           WAJGDT           OD Production D
      * Setup key
     C                     Z-ADDWOAIC3    WAAIC3           Company Number
     C                     Z-ADDWL0073    WAC4NB           Order Number
     C                     Z-ADDWL0074    WADPNB           Order Sequence
     C                     Z-ADDWL0075    WAUENB           Order Secondary
     C                     Z-ADDWOELDT    WAJGDT           OD Production D
      * Establish starting position
     C           KRSSW     CHAIN@B5CPM2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
     C                     EXSR SXCRRC
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WAIUQT    ADD  WN0155    YL0041           OD Quantity Inv
     C           WAF3WG    ADD  WN0156    YL0042           OD Weight Inv S
      * CASE: LCL.OD Quantity Inv Sched is LE Zero
     C           YL0041    IFLE *ZERO                      *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     Z-ADDWAJGDT    WL0005           OD Production D
     C                     EXSR SBDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
     C                     EXSR SYCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B5CPM1
     C                     Z-ADDWOAIC3    WBAIC3           Company Number
     C                     Z-ADDWL0073    WBC4NB           Order Number
     C                     Z-ADDWL0074    WBDPNB           Order Sequence
     C                     Z-ADDWL0075    WBUENB           Order Secondary
     C                     Z-ADDWOELDT    WBJGDT           OD Production D
     C                     Z-ADDWL0082    WBAODT           Scheduled Ship
     C                     MOVELWOAJCD    WBAJCD           Warehouse Code
     C                     Z-ADDWOHGCD    WBHGCD           Item Code
     C                     Z-ADDWN0155    WBIUQT           OD Quantity Inv
     C                     Z-ADDWN0156    WBF3WG           OD Weight Inv S
     C                     MOVELWN0157    WBUVST           EDI Status 1
     C                     MOVELWN0158    WBUWST           EDI Status 2
     C                     MOVELWN0159    WBUXST           EDI Status 3
     C                     MOVELWN0160    WBVSST           Record Status
     C                     Z-ADDWN0161    WBAATM           Job Time
     C                     MOVELWN0162    WBAYNA           User Id
     C                     MOVELWN0163    WBA0NA           Job Name
     C                     Z-ADDWN0164    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSX    SETLL@B5CPM1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3151' W0RTN   7
      * Send message 'Order Detail Sched-Inv EX'
     C                     MOVEL'USR3151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@B5CPM1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0165  1        EDI Status 1
     C                     MOVEL*BLANK    WN0166  1        EDI Status 2
     C                     MOVEL*BLANK    WN0167  1        EDI Status 3
     C                     MOVEL*BLANK    WN0168  1        Record Status
     C                     Z-ADD*ZERO     WN0169  60       Job Time
     C                     MOVEL*BLANK    WN0170 10        User Id
     C                     MOVEL*BLANK    WN0171 10        Job Name
     C                     Z-ADD*ZERO     WN0172  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     Z-ADDWADPNB    WBDPNB           Order Sequence
     C                     Z-ADDWAUENB    WBUENB           Order Secondary
     C                     Z-ADDWAJGDT    WBJGDT           OD Production D
      *
     C           KLCHSY    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBJGDT           OD Production D
     C           KLCHSY    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YCRDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWAAODT    WBAODT           Scheduled Ship
     C                     MOVELWOAJCD    WBAJCD    P      Warehouse Code
     C                     Z-ADDWOHGCD    WBHGCD           Item Code
     C                     Z-ADDYL0041    WBIUQT           OD Quantity Inv
     C                     Z-ADDYL0042    WBF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0173 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0174 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0175 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0176 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0177 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0178 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0179  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0180  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0181  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0182  1        EDI Status 1
     C                     MOVEL*BLANK    WN0183  1        EDI Status 2
     C                     MOVEL*BLANK    WN0184  1        EDI Status 3
     C                     MOVEL*BLANK    WN0185  1        Record Status
     C                     Z-ADD*ZERO     WN0186  60       Job Time
     C                     MOVEL*BLANK    WN0187 10        User Id
     C                     MOVEL*BLANK    WN0188 10        Job Name
     C                     Z-ADD*ZERO     WN0189  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0065    WCAIC3           Company Number
     C                     Z-ADDWL0073    WCC4NB           Order Number
     C                     Z-ADDWL0074    WCDPNB           Order Sequence
     C                     Z-ADDWL0075    WCUENB           Order Secondary
     C                     Z-ADD##JDT     WCJGDT           OD Production D
      * Establish starting position
     C           KRSSZ     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0065    WL0084           Company Number
     C                     Z-ADDWL0073    WL0085           Order Number
     C                     Z-ADDWL0074    WL0086           Order Sequence
     C                     Z-ADDWL0075    WL0087           Order Secondary
     C                     Z-ADD##JDT     WL0088           OD Production D
     C                     Z-ADDWL0082    WL0089           Scheduled Ship
     C                     MOVELWL0067    WL0090    P      Warehouse Code
     C                     MOVELWL0067    WL0091    P      Order From Ware
     C                     Z-ADDWL0066    WL0092           Item Code
     C                     Z-ADDWN0173    WL0093           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0174    WL0094           OD Weight Sched
     C                     Z-ADDWN0155    WL0095           OD Quantity Inv
     C                     Z-ADDWN0156    WL0096           OD Weight Inv S
     C                     Z-ADDWN0177    WL0097           OD Quantity Unu
     C                     Z-ADDWN0178    WL0098           OD Unused weigh
     C                     MOVELWN0179    WL0099    P      OD Added to Sch
     C                     MOVELWN0180    WL0100    P      OD Reallocate S
     C                     MOVELWN0181    WL0101    P      OD Status Unuse
     C                     MOVELWN0182    WL0102    P      EDI Status 1
     C                     MOVELWN0183    WL0103    P      EDI Status 2
     C                     MOVELWN0184    WL0104    P      EDI Status 3
     C                     MOVELWN0185    WL0105    P      Record Status
     C                     Z-ADDWN0186    WL0106           Job Time
     C                     MOVELWN0187    WL0107    P      User Id
     C                     MOVELWN0188    WL0108    P      Job Name
     C                     Z-ADDWN0189    WL0109           Job Date
     C                     EXSR TACRRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCIUQT    ADD  WN0155    WN0175           OD Quantity Inv
     C           WCF3WG    ADD  WN0156    WN0176           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0175    IFLE *ZERO                      *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADDWCDPNB    WL0008           Order Sequence
     C                     Z-ADDWCUENB    WL0009           Order Secondary
     C                     Z-ADDWCJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR TBCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0084    WEAIC3           Company Number
     C                     Z-ADDWL0085    WEC4NB           Order Number
     C                     Z-ADDWL0086    WEDPNB           Order Sequence
     C                     Z-ADDWL0087    WEUENB           Order Secondary
     C                     Z-ADDWL0088    WEJGDT           OD Production D
     C                     Z-ADDWL0089    WEAODT           Scheduled Ship
     C                     MOVELWL0090    WEAJCD           Warehouse Code
     C                     MOVELWL0091    WEAYAA           Order From Ware
     C                     Z-ADDWL0092    WEHGCD           Item Code
     C                     Z-ADDWL0093    WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0094    WEFLWG           OD Weight Sched
     C                     Z-ADDWL0095    WEIUQT           OD Quantity Inv
     C                     Z-ADDWL0096    WEF3WG           OD Weight Inv S
     C                     Z-ADDWL0097    WEIVQT           OD Quantity Unu
     C                     Z-ADDWL0098    WEF4WG           OD Unused weigh
     C                     MOVELWL0099    WEP7ST           OD Added to Sch
     C                     MOVELWL0100    WEP8ST           OD Reallocate S
     C                     MOVELWL0101    WEQAST           OD Status Unuse
     C                     MOVELWL0102    WEUVST           EDI Status 1
     C                     MOVELWL0103    WEUWST           EDI Status 2
     C                     MOVELWL0104    WEUXST           EDI Status 3
     C                     MOVELWL0105    WEVSST           Record Status
     C                     Z-ADDWL0106    WEAATM           Job Time
     C                     MOVELWL0107    WEAYNA           User Id
     C                     MOVELWL0108    WEA0NA           Job Name
     C                     Z-ADDWL0109    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRTA    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTA    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0190  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0191  3        Warehouse Code
     C                     MOVEL*BLANK    WN0192  3        Order From Ware
     C                     Z-ADD*ZERO     WN0193  70       Item Code
     C                     Z-ADD*ZERO     WN0194 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0195 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0196 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0197 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0198  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0199  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0200  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0201  1        EDI Status 1
     C                     MOVEL*BLANK    WN0202  1        EDI Status 2
     C                     MOVEL*BLANK    WN0203  1        EDI Status 3
     C                     MOVEL*BLANK    WN0204  1        Record Status
     C                     Z-ADD*ZERO     WN0205  60       Job Time
     C                     MOVEL*BLANK    WN0206 10        User Id
     C                     MOVEL*BLANK    WN0207 10        Job Name
     C                     Z-ADD*ZERO     WN0208  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0065    WEAIC3           Company Number
     C                     Z-ADDWL0073    WEC4NB           Order Number
     C                     Z-ADDWL0074    WEDPNB           Order Sequence
     C                     Z-ADDWL0075    WEUENB           Order Secondary
     C                     Z-ADD##JDT     WEJGDT           OD Production D
      *
     C           KLCHTB    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTB    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YDRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0175    WEIUQT           OD Quantity Inv
     C                     Z-ADDWN0176    WEF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0209  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0210  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0065    WSAIC3           Company Number
     C                     MOVEL'S'       WSV5ST           Production Type
     C                     Z-ADD##JDT     WSELDT           Production Date
     C                     Z-ADDWL0066    WSHGCD           Item Code
     C                     MOVELWL0067    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSUNW2    ADD  WN0156    WN0209           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           WL0070    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           WL0071    MULT WL0072    W0WJ02           *Synon (15,0) w
     C           WN0155    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WSCENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0210           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0210           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR TDCHRC
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0211  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0212  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0213  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0214  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0215  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0216  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0217  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0218  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0219  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0220  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0221  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0222  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0226  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0228  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0230  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0232 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0234 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0236 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0238 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0239  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0240 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0241  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0242 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0243  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0244  3        PS Item Id
     C                     MOVEL*BLANK    WN0245  2        Warehouse Type
     C                     MOVEL*BLANK    WN0246  1        PS Lock Status
     C                     MOVEL*BLANK    WN0247  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0248  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0249  1        PS Piece Count
     C                     MOVEL*BLANK    WN0250  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0251  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0252  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0253  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0254  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0255  3        PS Production W
     C                     Z-ADD*ZERO     WN0256  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0257  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0258  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0259  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0260  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0261  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0262  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0263  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0264  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0265  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0266  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0267  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0268  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0269  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0270  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0271  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0272  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0273  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0274  6        Department Code
     C                     Z-ADD*ZERO     WN0275  30       Item Structure
     C                     Z-ADD*ZERO     WN0276  30       Item Structure
     C                     Z-ADD*ZERO     WN0277  30       Item Structure
     C                     MOVEL*BLANK    WN0278  6        Primal Group Co
     C                     MOVEL*BLANK    WN0279  1        EDI Status 1
     C                     MOVEL*BLANK    WN0280  1        EDI Status 2
     C                     MOVEL*BLANK    WN0281  1        EDI Status 3
     C                     MOVEL*BLANK    WN0282  1        Record Status
     C                     Z-ADD*ZERO     WN0283  60       Job Time
     C                     MOVEL*BLANK    WN0284 10        User Id
     C                     MOVEL*BLANK    WN0285 10        Job Name
     C                     Z-ADD*ZERO     WN0286  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTD    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTD    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0209    WTUNW2           PS Weight Inv A
     C                     Z-ADDWN0210    WTCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WVAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0110    WVAJCD           Warehouse Code
      * Establish starting position
     C           KRSTE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0111           Production Ware
     C                     Z-ADD*ZERO     WL0112           Accounting Comp
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVAOCD    WL0111           Production Ware
     C                     Z-ADDWVBTC3    WL0112           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTF01           Company Number
     C           *LIKE     DEFN WWHGCD    WQTF02           Item Code
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Item Code
      * Setup key
     C                     Z-ADDWLAIC3    WQTF01           Company Number
     C                     Z-ADDWLHGCD    WQTF02           Item Code
      * Establish starting position
     C           KRSTF     SETLL@FDREAW                    *
     C           KRSTF     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0049           Allocation Meth
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR TGRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           WWENST    IFEQ *BLANK                     *IF
     C           WWENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR THRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0050    IFLE YL0051                     *IF
     C                     MOVEL'F'       YL0049           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0049           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWWENST    YL0049           Allocation Meth
     C                     END                             *FI
     C           KRSTF     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXC4NB    WQTG01           Order Number
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Order Number
      * Setup key
     C                     Z-ADDWLC4NB    WQTG01           Order Number
      * Establish starting position
     C           KRSTG     SETLL@BFCPY2                    *
     C           KRSTG     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0050           Scheduled Ship
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWXAODT    YL0050           Scheduled Ship
     C           KRSTG     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTH01           Company Number
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WYBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
      * Setup key
     C                     Z-ADDWWAIC3    WQTH01           Company Number
     C                     Z-ADD##JDT     WYBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTH     SETLL@AFREY1                    *
     C           KRSTH     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWYBCDT    YL0051           *DATE
     C                     GOTO THEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTH     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WWHGCD    WQTI02           Item Code
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Item Code
      * Setup key
     C                     Z-ADDWL0113    WQTI01           Company Number
     C                     Z-ADDWL0114    WQTI02           Item Code
      * Establish starting position
     C           KRSTI     SETLL@FDREAW                    *
     C           KRSTI     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * default to "Y"es if rcd not found. user isnt overriding it to No
     C                     MOVEL*BLANK    WL0116           Production Day
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR TJRVGN
      * CASE: LCL.Day of Week is Sunday
     C           YL0055    IFEQ '1'                        *IF
     C                     MOVELWWD0ST    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Monday
     C           YL0055    IFEQ '2'                        *IF
     C                     MOVELWWD2ST    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Tuesday
     C           YL0055    IFEQ '3'                        *IF
     C                     MOVELWWD6ST    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Wednesday
     C           YL0055    IFEQ '4'                        *IF
     C                     MOVELWWWESP    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Thursday
     C           YL0055    IFEQ '5'                        *IF
     C                     MOVELWWEDST    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Friday
     C           YL0055    IFEQ '6'                        *IF
     C                     MOVELWWEFST    WL0116           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Saturday
     C           YL0055    IFEQ '7'                        *IF
     C                     MOVELWWEHST    WL0116           Production Day
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTI     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN TABCDT    WQTJ02           Post to G/L Dat
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0113    WQTJ01           Company Number
     C                     Z-ADDWL0115    WQTJ02           Post to G/L Dat
      * Establish starting position
     C           KRSTJ     SETLL@AFREYY                    *
     C           KRSTJ     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELTAA9ST    YL0055           Day of Week
     C           KRSTJ     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBV5ST           Production Type
     C                     KFLD           TBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0117    TBAIC3           Company Number
     C                     MOVELWL0118    TBV5ST           Production Type
     C                     Z-ADDWL0119    TBELDT           Production Date
      * Establish starting position
     C           KRSTK     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0120           Record Found US
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0120           Record Found US
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0303  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0304  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0305  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0306  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0307  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0308  92       Weight Producti
     C                     Z-ADD*ZERO     WN0309  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0310 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0311 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0312  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0126           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0303           PS Weight Ship
     C                     Z-ADD*ZERO     WN0304           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0127           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0128           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0305           Piece Count Ite
     C                     Z-ADD*ZERO     WN0306           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0307           Bags Per Unit
     C                     Z-ADD*ZERO     WN0308           Weight Producti
     C                     Z-ADD*ZERO     WN0309           Pieces Producti
     C                     Z-ADD*ZERO     WN0310           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0311           OD Weight Sched
     C                     Z-ADD*ZERO     WN0312           Pieces Allocate
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0121    WSAIC3           Company Number
     C                     MOVELWL0122    WSV5ST           Production Type
     C                     Z-ADDWL0123    WSELDT           Production Date
     C                     Z-ADDWL0124    WSHGCD           Item Code
     C                     MOVELWL0125    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTL     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WSB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0129    IFGT *ZERO                      *IF
     C           WSELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR TMRVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WSWTSP    ADD  WSDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WSD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WSGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0308           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WSQTSP    ADD  WSB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WSCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WSPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WSBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0309           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0308    ADD  WN0303    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WSSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WSOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0127           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0309    ADD  WN0304    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WSB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WSCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0128           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0127    IFLT *ZERO                      *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WL0128    IFLE *ZERO                      *IF
     C                     Z-ADD*ZERO     WL0127           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0128           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWSF8WG    WL0126           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTM01           Company Number
     C           *LIKE     DEFN TCHGCD    WQTM02           Item Code
     C           *LIKE     DEFN TCAJCD    WQTM03           Warehouse Code
     C           *LIKE     DEFN TCELDT    WQTM04           Production Date
     C           *LIKE     DEFN TCV5ST    WQTM05           Production Type
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Item Code
     C                     KFLD           WQTM03           Warehouse Code
     C                     KFLD           WQTM04           Production Date
     C                     KFLD           WQTM05           Production Type
      * Setup key
     C                     Z-ADDWSAIC3    WQTM01           Company Number
     C                     Z-ADDWSHGCD    WQTM02           Item Code
     C                     MOVELWSAJCD    WQTM03           Warehouse Code
     C                     Z-ADDWSGPDT    WQTM04           Production Date
     C                     MOVEL'P'       WQTM05           Production Type
      * Establish starting position
     C           KRSTM     SETLL@I8CPXP                    *
     C           KRSTM     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0303           PS Weight Ship
     C                     Z-ADD*ZERO     WN0304           PS Pieces Ship
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTCE0WG    WN0303           PS Weight Ship
     C                     Z-ADDTCD6NB    WN0304           PS Pieces Ship
     C           KRSTM     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0313 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0314 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0315 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0316 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0317 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0318 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0319  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0320  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0321  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0322  1        EDI Status 1
     C                     MOVEL*BLANK    WN0323  1        EDI Status 2
     C                     MOVEL*BLANK    WN0324  1        EDI Status 3
     C                     MOVEL*BLANK    WN0325  1        Record Status
     C                     Z-ADD*ZERO     WN0326  60       Job Time
     C                     MOVEL*BLANK    WN0327 10        User Id
     C                     MOVEL*BLANK    WN0328 10        Job Name
     C                     Z-ADD*ZERO     WN0329  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0130    WCAIC3           Company Number
     C                     Z-ADDWL0131    WCC4NB           Order Number
     C                     Z-ADDWL0132    WCDPNB           Order Sequence
     C                     Z-ADDWL0133    WCUENB           Order Secondary
     C                     Z-ADDWL0134    WCJGDT           OD Production D
      * Establish starting position
     C           KRSTN     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0130    WL0084           Company Number
     C                     Z-ADDWL0131    WL0085           Order Number
     C                     Z-ADDWL0132    WL0086           Order Sequence
     C                     Z-ADDWL0133    WL0087           Order Secondary
     C                     Z-ADDWL0134    WL0088           OD Production D
     C                     Z-ADDWL0135    WL0089           Scheduled Ship
     C                     MOVELWL0136    WL0090    P      Warehouse Code
     C                     MOVELWL0137    WL0091    P      Order From Ware
     C                     Z-ADDWL0138    WL0092           Item Code
     C                     Z-ADDWL0140    WL0093           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0139    WL0094           OD Weight Sched
     C                     Z-ADDWN0315    WL0095           OD Quantity Inv
     C                     Z-ADDWN0316    WL0096           OD Weight Inv S
     C                     Z-ADDWN0317    WL0097           OD Quantity Unu
     C                     Z-ADDWN0318    WL0098           OD Unused weigh
     C                     MOVELWN0319    WL0099    P      OD Added to Sch
     C                     MOVELWN0320    WL0100    P      OD Reallocate S
     C                     MOVELWN0321    WL0101    P      OD Status Unuse
     C                     MOVELWN0322    WL0102    P      EDI Status 1
     C                     MOVELWN0323    WL0103    P      EDI Status 2
     C                     MOVELWN0324    WL0104    P      EDI Status 3
     C                     MOVELWN0325    WL0105    P      Record Status
     C                     Z-ADDWN0326    WL0106           Job Time
     C                     MOVELWN0327    WL0107    P      User Id
     C                     MOVELWN0328    WL0108    P      Job Name
     C                     Z-ADDWN0329    WL0109           Job Date
     C                     EXSR TACRRC
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCIGQT    ADD  WL0140    WN0313           OD Qty/Cnsmd Pi
     C           WCFLWG    ADD  WL0139    WN0314           OD Weight Sched
     C                     MOVELWCP7ST    YL0056           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0141    IFEQ 'C'                        *IF
     C           WL0141    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0134    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0056           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0313    IFGT *ZERO                      *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
     C                     EXSR TOCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADDWCDPNB    WL0008           Order Sequence
     C                     Z-ADDWCUENB    WL0009           Order Secondary
     C                     Z-ADDWCJGDT    WL0010           OD Production D
     C                     EXSR SFDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0330  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0331  3        Warehouse Code
     C                     MOVEL*BLANK    WN0332  3        Order From Ware
     C                     Z-ADD*ZERO     WN0333  70       Item Code
     C                     Z-ADD*ZERO     WN0334 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0335 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0336  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0337  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0338  1        EDI Status 1
     C                     MOVEL*BLANK    WN0339  1        EDI Status 2
     C                     MOVEL*BLANK    WN0340  1        EDI Status 3
     C                     MOVEL*BLANK    WN0341  1        Record Status
     C                     Z-ADD*ZERO     WN0342  60       Job Time
     C                     MOVEL*BLANK    WN0343 10        User Id
     C                     MOVEL*BLANK    WN0344 10        Job Name
     C                     Z-ADD*ZERO     WN0345  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLCHTO    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTO    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YFRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0313    WEIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0314    WEFLWG           OD Weight Sched
     C                     Z-ADDWCIUQT    WEIUQT           OD Quantity Inv
     C                     Z-ADDWCF3WG    WEF3WG           OD Weight Inv S
     C                     MOVELYL0056    WEP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0346  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0347  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0348  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0349  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0350  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0351  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0352  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0353  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0354  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0355  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0356  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0357  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0358  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0359  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0360  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0361  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0362  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0363  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0364  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0365  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0366  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0367  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0368  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0369 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0370  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0371 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0372  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0373 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0374  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0375 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0376  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0377 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0378  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0379 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0380  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0381  3        PS Item Id
     C                     MOVEL*BLANK    WN0382  2        Warehouse Type
     C                     MOVEL*BLANK    WN0383  1        PS Lock Status
     C                     MOVEL*BLANK    WN0384  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0385  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0386  1        PS Piece Count
     C                     MOVEL*BLANK    WN0387  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0388  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0389  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0390  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0391  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0392  3        PS Production W
     C                     Z-ADD*ZERO     WN0393  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0394  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0395  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0396  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0397  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0398  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0399  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0400  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0401  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0402  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0403  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0404  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0405  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0406  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0407  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0408  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0409  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0410  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0411  6        Department Code
     C                     Z-ADD*ZERO     WN0412  30       Item Structure
     C                     Z-ADD*ZERO     WN0413  30       Item Structure
     C                     Z-ADD*ZERO     WN0414  30       Item Structure
     C                     MOVEL*BLANK    WN0415  6        Primal Group Co
     C                     MOVEL*BLANK    WN0416  1        EDI Status 1
     C                     MOVEL*BLANK    WN0417  1        EDI Status 2
     C                     MOVEL*BLANK    WN0418  1        EDI Status 3
     C                     MOVEL*BLANK    WN0419  1        Record Status
     C                     Z-ADD*ZERO     WN0420  60       Job Time
     C                     MOVEL*BLANK    WN0421 10        User Id
     C                     MOVEL*BLANK    WN0422 10        Job Name
     C                     Z-ADD*ZERO     WN0423  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0142    WSAIC3           Company Number
     C                     MOVELWL0143    WSV5ST           Production Type
     C                     Z-ADDWL0144    WSELDT           Production Date
     C                     Z-ADDWL0145    WSHGCD           Item Code
     C                     MOVELWL0146    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTP     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0147    WN0371           PS Weight Whse
     C                     Z-ADDWL0148    WN0370           PS Pieces Whse
      * CASE: PAR.PS Pieces Whse Tfr Adj is GT Zero
     C           WN0370    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Whse Tfr Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Whse Tfr Adj
     C           WN0371    DIV  WN0370    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0350           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0142    WL0153           Company Number
     C                     MOVELWL0143    WL0154    P      Production Type
     C                     Z-ADDWL0144    WL0155           Production Date
     C                     Z-ADDWL0145    WL0156           Item Code
     C                     MOVELWL0146    WL0157    P      Warehouse Code
     C                     Z-ADDWN0346    WL0158           PS Available Sh
     C                     Z-ADDWN0347    WL0159           PS Weight Plann
     C                     Z-ADDWN0348    WL0160           PS Pieces Plann
     C                     Z-ADDWN0349    WL0161           PS % of Carcass
     C                     Z-ADDWN0350    WL0162           PS Avg Piece Wg
     C                     Z-ADDWN0351    WL0163           PS Weight Inv O
     C                     Z-ADDWN0352    WL0164           PS Pieces Inv O
     C                     Z-ADDWN0353    WL0165           PS Weight Stand
     C                     Z-ADDWN0354    WL0166           PS Pieces Stand
     C                     Z-ADDWN0355    WL0167           PS Weight Conve
     C                     Z-ADDWN0356    WL0168           PS Pieces Conve
     C                     Z-ADDWN0357    WL0169           PS Weight Shipp
     C                     Z-ADDWN0358    WL0170           PS Pieces Shipp
     C                     Z-ADDWN0359    WL0171           PS Weight Prod
     C                     Z-ADDWN0360    WL0172           PS Pieces Prod
     C                     Z-ADDWN0361    WL0173           PS Weight Inv A
     C                     Z-ADDWN0362    WL0174           PS Pieces Inv A
     C                     Z-ADDWN0363    WL0175           PS Weight Ship
     C                     Z-ADDWN0364    WL0176           PS Pieces Ship
     C                     Z-ADDWN0365    WL0177           PS Weight Prod
     C                     Z-ADDWN0366    WL0178           PS Pieces Prod
     C                     Z-ADDWN0367    WL0179           PS Weight Inv A
     C                     Z-ADDWN0368    WL0180           PS Pieces Inv A
     C                     Z-ADDWN0369    WL0181           PS Unit Weight
     C                     Z-ADDWN0370    WL0182           PS Pieces Whse
     C                     Z-ADDWN0371    WL0183           PS Weight Whse
     C                     Z-ADDWN0372    WL0184           PS Pieces Unuse
     C                     Z-ADDWN0373    WL0185           PS Weight Unuse
     C                     Z-ADDWN0374    WL0186           PS Pieces Unuse
     C                     Z-ADDWN0375    WL0187           PS Weight Unuse
     C                     Z-ADDWN0376    WL0188           PS Pieces Unuse
     C                     Z-ADDWN0377    WL0189           PS Weight Unuse
     C                     Z-ADDWN0378    WL0190           PS Pieces Unuse
     C                     Z-ADDWN0379    WL0191           PS Weight Unuse
     C                     Z-ADDWN0380    WL0192           PS Pieces Unuse
     C                     MOVELWN0381    WL0193    P      PS Item Id
     C                     MOVELWN0382    WL0194    P      Warehouse Type
     C                     MOVELWN0383    WL0195    P      PS Lock Status
     C                     MOVELWN0384    WL0196    P      PS Export/Domes
     C                     MOVELWN0385    WL0197    P      PS Print On Sch
     C                     MOVELWN0386    WL0198    P      PS Piece Count
     C                     MOVELWN0387    WL0199    P      PS Unused Sts 1
     C                     MOVELWN0388    WL0200    P      PS Unused Sts 2
     C                     MOVELWN0389    WL0201    P      PS Unused Sts 3
     C                     MOVELWN0390    WL0202    P      PS Unused Sts 4
     C                     MOVELWN0391    WL0203    P      PS Item Sched N
     C                     MOVELWN0392    WL0204    P      PS Production W
     C                     Z-ADDWN0393    WL0205           PS Weight Order
     C                     Z-ADDWN0394    WL0206           PS Pieces Order
     C                     Z-ADDWN0395    WL0207           PS Weight FC Ad
     C                     Z-ADDWN0396    WL0208           PS Pieces FC Ad
     C                     Z-ADDWN0397    WL0209           PS Weight FX Ad
     C                     Z-ADDWN0398    WL0210           PS Pieces FX Ad
     C                     Z-ADDWN0399    WL0211           PS Weight Sched
     C                     Z-ADDWN0400    WL0212           PS Pieces Sched
     C                     Z-ADDWN0401    WL0213           PS Weight Avail
     C                     Z-ADDWN0402    WL0214           PS Pieces Avail
     C                     Z-ADDWN0403    WL0215           PS Weight Produ
     C                     Z-ADDWN0404    WL0216           PS Pieces Produ
     C                     Z-ADDWN0405    WL0217           PS Weight Fab N
     C                     Z-ADDWN0406    WL0218           PS Pieces Fab N
     C                     Z-ADDWN0407    WL0219           PS Weight Sched
     C                     Z-ADDWN0408    WL0220           PS Pieces Sched
     C                     Z-ADDWN0409    WL0221           PS Weight Sched
     C                     Z-ADDWN0410    WL0222           PS Pieces Sched
     C                     MOVELWN0411    WL0223    P      Department Code
     C                     Z-ADDWN0412    WL0224           Item Structure
     C                     Z-ADDWN0413    WL0225           Item Structure
     C                     Z-ADDWN0414    WL0226           Item Structure
     C                     MOVELWN0415    WL0227    P      Primal Group Co
     C                     MOVELWN0416    WL0228    P      EDI Status 1
     C                     MOVELWN0417    WL0229    P      EDI Status 2
     C                     MOVELWN0418    WL0230    P      EDI Status 3
     C                     MOVELWN0419    WL0231    P      Record Status
     C                     Z-ADDWN0420    WL0232           Job Time
     C                     MOVELWN0421    WL0233    P      User Id
     C                     MOVELWN0422    WL0234    P      Job Name
     C                     Z-ADDWN0423    WL0235           Job Date
     C                     EXSR TQCRRC
      *  not necessary here ...
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSGAWG    ADD  WL0147    WN0371           PS Weight Whse
     C           WSBPNB    ADD  WL0148    WN0370           PS Pieces Whse
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
     C                     EXSR TSCHRC
      *  not necessary here ...
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0153    WTAIC3           Company Number
     C                     MOVELWL0154    WTV5ST           Production Type
     C                     Z-ADDWL0155    WTELDT           Production Date
     C                     Z-ADDWL0156    WTHGCD           Item Code
     C                     MOVELWL0157    WTAJCD           Warehouse Code
     C                     Z-ADDWL0158    WTGPDT           PS Available Sh
     C                     Z-ADDWL0159    WTWTSP           PS Weight Plann
     C                     Z-ADDWL0160    WTQTSP           PS Pieces Plann
     C                     Z-ADDWL0161    WTDJPC           PS % of Carcass
     C                     Z-ADDWL0162    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0163    WTWTIN           PS Weight Inv O
     C                     Z-ADDWL0164    WTD5NB           PS Pieces Inv O
     C                     Z-ADDWL0165    WTDXWG           PS Weight Stand
     C                     Z-ADDWL0166    WTB2NB           PS Pieces Stand
     C                     Z-ADDWL0167    WTWTCN           PS Weight Conve
     C                     Z-ADDWL0168    WTPSCV           PS Pieces Conve
     C                     Z-ADDWL0169    WTSAWT           PS Weight Shipp
     C                     Z-ADDWL0170    WTB9NB           PS Pieces Shipp
     C                     Z-ADDWL0171    WTD1WG           PS Weight Prod
     C                     Z-ADDWL0172    WTCBNB           PS Pieces Prod
     C                     Z-ADDWL0173    WTEZWG           PS Weight Inv A
     C                     Z-ADDWL0174    WTCCNB           PS Pieces Inv A
     C                     Z-ADDWL0175    WTE0WG           PS Weight Ship
     C                     Z-ADDWL0176    WTD6NB           PS Pieces Ship
     C                     Z-ADDWL0177    WTOAWT           PS Weight Prod
     C                     Z-ADDWL0178    WTCDNB           PS Pieces Prod
     C                     Z-ADDWL0179    WTUNW2           PS Weight Inv A
     C                     Z-ADDWL0180    WTCENB           PS Pieces Inv A
     C                     Z-ADDWL0181    WTF9WG           PS Unit Weight
     C                     Z-ADDWL0182    WTBPNB           PS Pieces Whse
     C                     Z-ADDWL0183    WTGAWG           PS Weight Whse
     C                     Z-ADDWL0184    WTBQNB           PS Pieces Unuse
     C                     Z-ADDWL0185    WTGBWG           PS Weight Unuse
     C                     Z-ADDWL0186    WTBRNB           PS Pieces Unuse
     C                     Z-ADDWL0187    WTGCWG           PS Weight Unuse
     C                     Z-ADDWL0188    WTBSNB           PS Pieces Unuse
     C                     Z-ADDWL0189    WTGDWG           PS Weight Unuse
     C                     Z-ADDWL0190    WTBWNB           PS Pieces Unuse
     C                     Z-ADDWL0191    WTGEWG           PS Weight Unuse
     C                     Z-ADDWL0192    WTPS6U           PS Pieces Unuse
     C                     MOVELWL0193    WTWCST           PS Item Id
     C                     MOVELWL0194    WTWPST           Warehouse Type
     C                     MOVELWL0195    WTB5ST           PS Lock Status
     C                     MOVELWL0196    WTTFST           PS Export/Domes
     C                     MOVELWL0197    WTTEST           PS Print On Sch
     C                     MOVELWL0198    WTTHST           PS Piece Count
     C                     MOVELWL0199    WTUDST           PS Unused Sts 1
     C                     MOVELWL0200    WTUFST           PS Unused Sts 2
     C                     MOVELWL0201    WTUGST           PS Unused Sts 3
     C                     MOVELWL0202    WTUHST           PS Unused Sts 4
     C                     MOVELWL0203    WTB6ST           PS Item Sched N
     C                     MOVELWL0204    WTB7ST           PS Production W
     C                     Z-ADDWL0205    WTDVWG           PS Weight Order
     C                     Z-ADDWL0206    WTD7NB           PS Pieces Order
     C                     Z-ADDWL0207    WTFCAD           PS Weight FC Ad
     C                     Z-ADDWL0208    WTD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0209    WTDWWG           PS Weight FX Ad
     C                     Z-ADDWL0210    WTEANB           PS Pieces FX Ad
     C                     Z-ADDWL0211    WTSHWT           PS Weight Sched
     C                     Z-ADDWL0212    WTEBNB           PS Pieces Sched
     C                     Z-ADDWL0213    WTAVWT           PS Weight Avail
     C                     Z-ADDWL0214    WTECNB           PS Pieces Avail
     C                     Z-ADDWL0215    WTWTON           PS Weight Produ
     C                     Z-ADDWL0216    WTEDNB           PS Pieces Produ
     C                     Z-ADDWL0217    WTFNWT           PS Weight Fab N
     C                     Z-ADDWL0218    WTEENB           PS Pieces Fab N
     C                     Z-ADDWL0219    WTQTAS           PS Weight Sched
     C                     Z-ADDWL0220    WTEFNB           PS Pieces Sched
     C                     Z-ADDWL0221    WTWAIO           PS Weight Sched
     C                     Z-ADDWL0222    WTEGNB           PS Pieces Sched
     C                     MOVELWL0223    WTR3CD           Department Code
     C                     Z-ADDWL0224    WTRGNB           Item Structure
     C                     Z-ADDWL0225    WTRHNB           Item Structure
     C                     Z-ADDWL0226    WTRINB           Item Structure
     C                     MOVELWL0227    WTXRCD           Primal Group Co
     C                     MOVELWL0228    WTUVST           EDI Status 1
     C                     MOVELWL0229    WTUWST           EDI Status 2
     C                     MOVELWL0230    WTUXST           EDI Status 3
     C                     MOVELWL0231    WTVSST           Record Status
     C                     Z-ADDWL0232    WTAATM           Job Time
     C                     MOVELWL0233    WTAYNA           User Id
     C                     MOVELWL0234    WTA0NA           Job Name
     C                     Z-ADDWL0235    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0424 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0024           Company Number
     C                     Z-ADDWTHGCD    WL0025           Item Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WUAVNA    P      Description Lin
     C                     MOVELWL0027    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0028    WUAIWG           Unit Weight
     C                     Z-ADDWL0029    WTRINB           Item Structure
     C                     Z-ADDWL0030    WTRHNB           Item Structure
     C                     Z-ADDWL0031    WTRGNB           Item Structure
     C                     MOVELWL0032    WUN0CD    P      Item Type Code
     C                     MOVELWL0033    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0034    WUCHTM           Fresh Chilling
     C                     MOVELWL0035    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0036    WUXWST    P      Variety/Rendere
     C                     MOVELWL0037    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0038    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0039    WUPPHE           Pieces Per Head
     C                     MOVELWL0040    WTR3CD    P      Department Code
     C                     MOVELWL0041    WUSDCD    P      Group for Packa
     C                     MOVELWL0042    WUX5ST    P      Seconds Item
     C                     MOVELWL0043    WTTHST    P      Piece Count Ite
     C                     Z-ADDWL0044    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0045    WUBJNB           Bags Per Unit
     C                     MOVELWL0046    WTTFST    P      Export/Domestic
     C                     MOVELWL0047    WTTEST    P      Print On Schedu
     C                     MOVELWL0048    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0049    WUSZST    P      Fresh Sched As
     C                     MOVELWL0050    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0051    WTXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWTAJCD    WL0052    P      Warehouse Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0053    WTWPST    P      Warehouse Type
     C                     MOVELWL0054    WUXUST    P      Trans Contol AS
     C                     MOVELWL0055    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0056    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0057    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WTWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WTWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WTWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWTAJCD    WL0110    P      Warehouse Code
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0111    WTB7ST    P      Production Ware
     C                     Z-ADDWL0112    YL0057           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0236           Company Number
     C                     Z-ADDWL0155    WL0237           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0238           Fresh Chilling
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0239    WTGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0236           Company Number
     C                     Z-ADDWL0155    WL0237           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0238           Fresh Chilling
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0239    WTGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0160    IFGT *ZERO                      *IF
     C           WL0159    DIV  WL0160    WTF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C                     MOVEL'N'       WTB5ST           PS Lock Status
     C           KLCRTQ    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQTR01           Company Number
      * Define keylist
     C           KPSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WMBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
      * Setup key
     C                     Z-ADDWL0236    WQTR01           Company Number
     C                     Z-ADDWL0237    WMBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTR     SETLL@AFREBE                    *
     C           KRSTR     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0238                     *IF
     C                     Z-ADDWMBCDT    WL0239           PS Available Sh
     C                     GOTO TREXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WMA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTR     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCHRC    BEGSR
      *================================================================
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0425  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0426  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0427  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0428  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0429  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0430  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0431  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0432  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0433  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0434  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0435  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0436  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0437  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0438  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0439  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0440  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0441  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0442  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0443  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0444  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0445  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0446  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0447 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0448  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0449 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0450  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0451 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0452  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0453 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0454  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0455 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0456  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0457  3        PS Item Id
     C                     MOVEL*BLANK    WN0458  2        Warehouse Type
     C                     MOVEL*BLANK    WN0459  1        PS Lock Status
     C                     MOVEL*BLANK    WN0460  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0461  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0462  1        PS Piece Count
     C                     MOVEL*BLANK    WN0463  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0464  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0465  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0466  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0467  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0468  3        PS Production W
     C                     Z-ADD*ZERO     WN0469  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0470  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0471  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0472  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0473  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0474  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0475  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0476  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0477  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0478  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0479  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0480  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0481  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0482  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0483  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0484  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0485  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0486  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0487  6        Department Code
     C                     Z-ADD*ZERO     WN0488  30       Item Structure
     C                     Z-ADD*ZERO     WN0489  30       Item Structure
     C                     Z-ADD*ZERO     WN0490  30       Item Structure
     C                     MOVEL*BLANK    WN0491  6        Primal Group Co
     C                     MOVEL*BLANK    WN0492  1        EDI Status 1
     C                     MOVEL*BLANK    WN0493  1        EDI Status 2
     C                     MOVEL*BLANK    WN0494  1        EDI Status 3
     C                     MOVEL*BLANK    WN0495  1        Record Status
     C                     Z-ADD*ZERO     WN0496  60       Job Time
     C                     MOVEL*BLANK    WN0497 10        User Id
     C                     MOVEL*BLANK    WN0498 10        Job Name
     C                     Z-ADD*ZERO     WN0499  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTS    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTS    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YGRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWSF8WG    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0370    WTBPNB           PS Pieces Whse
     C                     Z-ADDWN0371    WTGAWG           PS Weight Whse
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0500  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0501  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0502  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0503  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0504  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0505  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0506  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0507  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0508  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0509  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0510  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0511  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0512  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0513  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0514  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0515  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0516  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0517  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0518  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0519  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0520  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0521  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0522  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0523 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0524  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0525 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0526  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0527 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0528  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0529 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0530  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0531 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0532  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0533 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0534  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0535  3        PS Item Id
     C                     MOVEL*BLANK    WN0536  2        Warehouse Type
     C                     MOVEL*BLANK    WN0537  1        PS Lock Status
     C                     MOVEL*BLANK    WN0538  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0539  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0540  1        PS Piece Count
     C                     MOVEL*BLANK    WN0541  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0542  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0543  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0544  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0545  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0546  3        PS Production W
     C                     Z-ADD*ZERO     WN0547  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0548  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0549  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0550  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0551  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0552  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0553  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0554  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0555  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0556  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0557  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0558  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0559  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0560  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0561  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0562  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0563  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0564  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0565  6        Department Code
     C                     Z-ADD*ZERO     WN0566  30       Item Structure
     C                     Z-ADD*ZERO     WN0567  30       Item Structure
     C                     Z-ADD*ZERO     WN0568  30       Item Structure
     C                     MOVEL*BLANK    WN0569  6        Primal Group Co
     C                     MOVEL*BLANK    WN0570  1        EDI Status 1
     C                     MOVEL*BLANK    WN0571  1        EDI Status 2
     C                     MOVEL*BLANK    WN0572  1        EDI Status 3
     C                     MOVEL*BLANK    WN0573  1        Record Status
     C                     Z-ADD*ZERO     WN0574  60       Job Time
     C                     MOVEL*BLANK    WN0575 10        User Id
     C                     MOVEL*BLANK    WN0576 10        Job Name
     C                     Z-ADD*ZERO     WN0577  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0240    WSAIC3           Company Number
     C                     MOVELWL0241    WSV5ST           Production Type
     C                     Z-ADDWL0242    WSELDT           Production Date
     C                     Z-ADDWL0243    WSHGCD           Item Code
     C                     MOVELWL0244    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTT     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0246    WN0507           PS Weight Stand
     C                     Z-ADDWL0245    WN0508           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0508    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0507    DIV  WN0508    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0504           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0504    IFLT *ZERO                      *IF
     C                     MULT -1        WN0504           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0507    IFNE *ZERO                      *IF
     C           WN0508    ORNE *ZERO                      *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0240    WL0153           Company Number
     C                     MOVELWL0241    WL0154    P      Production Type
     C                     Z-ADDWL0242    WL0155           Production Date
     C                     Z-ADDWL0243    WL0156           Item Code
     C                     MOVELWL0244    WL0157    P      Warehouse Code
     C                     Z-ADDWN0500    WL0158           PS Available Sh
     C                     Z-ADDWN0501    WL0159           PS Weight Plann
     C                     Z-ADDWN0502    WL0160           PS Pieces Plann
     C                     Z-ADDWN0503    WL0161           PS % of Carcass
     C                     Z-ADDWN0504    WL0162           PS Avg Piece Wg
     C                     Z-ADDWN0505    WL0163           PS Weight Inv O
     C                     Z-ADDWN0506    WL0164           PS Pieces Inv O
     C                     Z-ADDWN0507    WL0165           PS Weight Stand
     C                     Z-ADDWN0508    WL0166           PS Pieces Stand
     C                     Z-ADDWN0509    WL0167           PS Weight Conve
     C                     Z-ADDWN0510    WL0168           PS Pieces Conve
     C                     Z-ADDWN0511    WL0169           PS Weight Shipp
     C                     Z-ADDWN0512    WL0170           PS Pieces Shipp
     C                     Z-ADDWN0513    WL0171           PS Weight Prod
     C                     Z-ADDWN0514    WL0172           PS Pieces Prod
     C                     Z-ADDWN0515    WL0173           PS Weight Inv A
     C                     Z-ADDWN0516    WL0174           PS Pieces Inv A
     C                     Z-ADDWN0517    WL0175           PS Weight Ship
     C                     Z-ADDWN0518    WL0176           PS Pieces Ship
     C                     Z-ADDWN0519    WL0177           PS Weight Prod
     C                     Z-ADDWN0520    WL0178           PS Pieces Prod
     C                     Z-ADDWN0521    WL0179           PS Weight Inv A
     C                     Z-ADDWN0522    WL0180           PS Pieces Inv A
     C                     Z-ADDWN0523    WL0181           PS Unit Weight
     C                     Z-ADDWN0524    WL0182           PS Pieces Whse
     C                     Z-ADDWN0525    WL0183           PS Weight Whse
     C                     Z-ADDWN0526    WL0184           PS Pieces Unuse
     C                     Z-ADDWN0527    WL0185           PS Weight Unuse
     C                     Z-ADDWN0528    WL0186           PS Pieces Unuse
     C                     Z-ADDWN0529    WL0187           PS Weight Unuse
     C                     Z-ADDWN0530    WL0188           PS Pieces Unuse
     C                     Z-ADDWN0531    WL0189           PS Weight Unuse
     C                     Z-ADDWN0532    WL0190           PS Pieces Unuse
     C                     Z-ADDWN0533    WL0191           PS Weight Unuse
     C                     Z-ADDWN0534    WL0192           PS Pieces Unuse
     C                     MOVELWN0535    WL0193    P      PS Item Id
     C                     MOVELWN0536    WL0194    P      Warehouse Type
     C                     MOVELWN0537    WL0195    P      PS Lock Status
     C                     MOVELWN0538    WL0196    P      PS Export/Domes
     C                     MOVELWN0539    WL0197    P      PS Print On Sch
     C                     MOVELWN0540    WL0198    P      PS Piece Count
     C                     MOVELWN0541    WL0199    P      PS Unused Sts 1
     C                     MOVELWN0542    WL0200    P      PS Unused Sts 2
     C                     MOVELWN0543    WL0201    P      PS Unused Sts 3
     C                     MOVELWN0544    WL0202    P      PS Unused Sts 4
     C                     MOVELWN0545    WL0203    P      PS Item Sched N
     C                     MOVELWN0546    WL0204    P      PS Production W
     C                     Z-ADDWN0547    WL0205           PS Weight Order
     C                     Z-ADDWN0548    WL0206           PS Pieces Order
     C                     Z-ADDWN0549    WL0207           PS Weight FC Ad
     C                     Z-ADDWN0550    WL0208           PS Pieces FC Ad
     C                     Z-ADDWN0551    WL0209           PS Weight FX Ad
     C                     Z-ADDWN0552    WL0210           PS Pieces FX Ad
     C                     Z-ADDWN0553    WL0211           PS Weight Sched
     C                     Z-ADDWN0554    WL0212           PS Pieces Sched
     C                     Z-ADDWN0555    WL0213           PS Weight Avail
     C                     Z-ADDWN0556    WL0214           PS Pieces Avail
     C                     Z-ADDWN0557    WL0215           PS Weight Produ
     C                     Z-ADDWN0558    WL0216           PS Pieces Produ
     C                     Z-ADDWN0559    WL0217           PS Weight Fab N
     C                     Z-ADDWN0560    WL0218           PS Pieces Fab N
     C                     Z-ADDWN0561    WL0219           PS Weight Sched
     C                     Z-ADDWN0562    WL0220           PS Pieces Sched
     C                     Z-ADDWN0563    WL0221           PS Weight Sched
     C                     Z-ADDWN0564    WL0222           PS Pieces Sched
     C                     MOVELWN0565    WL0223    P      Department Code
     C                     Z-ADDWN0566    WL0224           Item Structure
     C                     Z-ADDWN0567    WL0225           Item Structure
     C                     Z-ADDWN0568    WL0226           Item Structure
     C                     MOVELWN0569    WL0227    P      Primal Group Co
     C                     MOVELWN0570    WL0228    P      EDI Status 1
     C                     MOVELWN0571    WL0229    P      EDI Status 2
     C                     MOVELWN0572    WL0230    P      EDI Status 3
     C                     MOVELWN0573    WL0231    P      Record Status
     C                     Z-ADDWN0574    WL0232           Job Time
     C                     MOVELWN0575    WL0233    P      User Id
     C                     MOVELWN0576    WL0234    P      Job Name
     C                     Z-ADDWN0577    WL0235           Job Date
     C                     EXSR TQCRRC
     C                     END                             *FI
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSDXWG    ADD  WL0246    WN0507           PS Weight Stand
     C           WSB2NB    ADD  WL0245    WN0508           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0508    IFNE *ZERO                      *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0507    DIV  WN0508    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0504           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0504    IFLT *ZERO                      *IF
     C                     MULT -1        WN0504           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR TUCHRC
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0578  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0579  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0580  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0581  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0582  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0583  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0584  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0585  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0586  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0587  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0588  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0589  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0590  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0591  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0592  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0593  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0594  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0595  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0596  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0597  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0598 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0599  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0600 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0601  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0602 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0603  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0604 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0605  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0606 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0607  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0608 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0609  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0610  3        PS Item Id
     C                     MOVEL*BLANK    WN0611  2        Warehouse Type
     C                     MOVEL*BLANK    WN0612  1        PS Lock Status
     C                     MOVEL*BLANK    WN0613  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0614  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0615  1        PS Piece Count
     C                     MOVEL*BLANK    WN0616  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0617  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0618  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0619  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0620  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0621  3        PS Production W
     C                     Z-ADD*ZERO     WN0622  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0623  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0624  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0625  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0626  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0627  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0628  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0629  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0630  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0631  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0632  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0633  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0634  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0635  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0636  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0637  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0638  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0639  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0640  6        Department Code
     C                     Z-ADD*ZERO     WN0641  30       Item Structure
     C                     Z-ADD*ZERO     WN0642  30       Item Structure
     C                     Z-ADD*ZERO     WN0643  30       Item Structure
     C                     MOVEL*BLANK    WN0644  6        Primal Group Co
     C                     MOVEL*BLANK    WN0645  1        EDI Status 1
     C                     MOVEL*BLANK    WN0646  1        EDI Status 2
     C                     MOVEL*BLANK    WN0647  1        EDI Status 3
     C                     MOVEL*BLANK    WN0648  1        Record Status
     C                     Z-ADD*ZERO     WN0649  60       Job Time
     C                     MOVEL*BLANK    WN0650 10        User Id
     C                     MOVEL*BLANK    WN0651 10        Job Name
     C                     Z-ADD*ZERO     WN0652  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWSAIC3    WTAIC3           Company Number
     C                     MOVELWSV5ST    WTV5ST    P      Production Type
     C                     Z-ADDWSELDT    WTELDT           Production Date
     C                     Z-ADDWSHGCD    WTHGCD           Item Code
     C                     MOVELWSAJCD    WTAJCD    P      Warehouse Code
      *
     C           KLCHTU    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTV5ST           Production Type
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C           KLCHTU    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YHRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0504    WTF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0507    WTDXWG           PS Weight Stand
     C                     Z-ADDWN0508    WTB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0653  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0654  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0655  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0656  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0657  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0658  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0659  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0660  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0661  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0662  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0663  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0664  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0665  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0666  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0667  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0668  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0669  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0670  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0671  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0672  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0673  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0674  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0675  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0676 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0677  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0678 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0679  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0680 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0681  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0682 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0683  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0684 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0685  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0686 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0687  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0688  3        PS Item Id
     C                     MOVEL*BLANK    WN0689  2        Warehouse Type
     C                     MOVEL*BLANK    WN0690  1        PS Lock Status
     C                     MOVEL*BLANK    WN0691  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0692  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0693  1        PS Piece Count
     C                     MOVEL*BLANK    WN0694  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0695  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0696  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0697  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0698  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0699  3        PS Production W
     C                     Z-ADD*ZERO     WN0700  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0701  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0702  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0703  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0704  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0705  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0706  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0707  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0708  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0709  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0710  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0711  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0712  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0713  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0714  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0715  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0716  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0717  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0718  6        Department Code
     C                     Z-ADD*ZERO     WN0719  30       Item Structure
     C                     Z-ADD*ZERO     WN0720  30       Item Structure
     C                     Z-ADD*ZERO     WN0721  30       Item Structure
     C                     MOVEL*BLANK    WN0722  6        Primal Group Co
     C                     MOVEL*BLANK    WN0723  1        EDI Status 1
     C                     MOVEL*BLANK    WN0724  1        EDI Status 2
     C                     MOVEL*BLANK    WN0725  1        EDI Status 3
     C                     MOVEL*BLANK    WN0726  1        Record Status
     C                     Z-ADD*ZERO     WN0727  60       Job Time
     C                     MOVEL*BLANK    WN0728 10        User Id
     C                     MOVEL*BLANK    WN0729 10        Job Name
     C                     Z-ADD*ZERO     WN0730  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSV5ST           Production Type
     C                     KFLD           WSELDT           Production Date
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0247    WSAIC3           Company Number
     C                     MOVELWL0248    WSV5ST           Production Type
     C                     Z-ADDWL0249    WSELDT           Production Date
     C                     Z-ADDWL0250    WSHGCD           Item Code
     C                     MOVELWL0251    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSTV     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0252    WN0672           PS Weight Prod
     C                     Z-ADDWL0253    WN0673           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0673    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0672    DIV  WN0673    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0657           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0153           Company Number
     C                     MOVELWL0248    WL0154    P      Production Type
     C                     Z-ADDWL0249    WL0155           Production Date
     C                     Z-ADDWL0250    WL0156           Item Code
     C                     MOVELWL0251    WL0157    P      Warehouse Code
     C                     Z-ADDWN0653    WL0158           PS Available Sh
     C                     Z-ADDWN0654    WL0159           PS Weight Plann
     C                     Z-ADDWN0655    WL0160           PS Pieces Plann
     C                     Z-ADDWN0656    WL0161           PS % of Carcass
     C                     Z-ADDWN0657    WL0162           PS Avg Piece Wg
     C                     Z-ADDWN0658    WL0163           PS Weight Inv O
     C                     Z-ADDWN0659    WL0164           PS Pieces Inv O
     C                     Z-ADDWN0660    WL0165           PS Weight Stand
     C                     Z-ADDWN0661    WL0166           PS Pieces Stand
     C                     Z-ADDWN0662    WL0167           PS Weight Conve
     C                     Z-ADDWN0663    WL0168           PS Pieces Conve
     C                     Z-ADDWN0664    WL0169           PS Weight Shipp
     C                     Z-ADDWN0665    WL0170           PS Pieces Shipp
     C                     Z-ADDWN0666    WL0171           PS Weight Prod
     C                     Z-ADDWN0667    WL0172           PS Pieces Prod
     C                     Z-ADDWN0668    WL0173           PS Weight Inv A
     C                     Z-ADDWN0669    WL0174           PS Pieces Inv A
     C                     Z-ADDWN0670    WL0175           PS Weight Ship
     C                     Z-ADDWN0671    WL0176           PS Pieces Ship
     C                     Z-ADDWN0672    WL0177           PS Weight Prod
     C                     Z-ADDWN0673    WL0178           PS Pieces Prod
     C                     Z-ADDWN0674    WL0179           PS Weight Inv A
     C                     Z-ADDWN0675    WL0180           PS Pieces Inv A
     C                     Z-ADDWN0676    WL0181           PS Unit Weight
     C                     Z-ADDWN0677    WL0182           PS Pieces Whse
     C                     Z-ADDWN0678    WL0183           PS Weight Whse
     C                     Z-ADDWN0679    WL0184           PS Pieces Unuse
     C                     Z-ADDWN0680    WL0185           PS Weight Unuse
     C                     Z-ADDWN0681    WL0186           PS Pieces Unuse
     C                     Z-ADDWN0682    WL0187           PS Weight Unuse
     C                     Z-ADDWN0683    WL0188           PS Pieces Unuse
     C                     Z-ADDWN0684    WL0189           PS Weight Unuse
     C                     Z-ADDWN0685    WL0190           PS Pieces Unuse
     C                     Z-ADDWN0686    WL0191           PS Weight Unuse
     C                     Z-ADDWN0687    WL0192           PS Pieces Unuse
     C                     MOVELWN0688    WL0193    P      PS Item Id
     C                     MOVELWN0689    WL0194    P      Warehouse Type
     C                     MOVELWN0690    WL0195    P      PS Lock Status
     C                     MOVELWN0691    WL0196    P      PS Export/Domes
     C                     MOVELWN0692    WL0197    P      PS Print On Sch
     C                     MOVELWN0693    WL0198    P      PS Piece Count
     C                     MOVELWN0694    WL0199    P      PS Unused Sts 1
     C                     MOVELWN0695    WL0200    P      PS Unused Sts 2
     C                     MOVELWN0696    WL0201    P      PS Unused Sts 3
     C                     MOVELWN0697    WL0202    P      PS Unused Sts 4
     C                     MOVELWN0698    WL0203    P      PS Item Sched N
     C                     MOVELWN0699    WL0204    P      PS Production W
     C                     Z-ADDWN0700    WL0205           PS Weight Order
     C                     Z-ADDWN0701    WL0206           PS Pieces Order
     C                     Z-ADDWN0702    WL0207           PS Weight FC Ad
     C                     Z-ADDWN0703    WL0208           PS Pieces FC Ad
     C                     Z-ADDWN0704    WL0209           PS Weight FX Ad
     C                     Z-ADDWN0705    WL0210           PS Pieces FX Ad
     C                     Z-ADDWN0706    WL0211           PS Weight Sched
     C                     Z-ADDWN0707    WL0212           PS Pieces Sched
     C                     Z-ADDWN0708    WL0213           PS Weight Avail
     C                     Z-ADDWN0709    WL0214           PS Pieces Avail
     C                     Z-ADDWN0710    WL0215           PS Weight Produ
     C                     Z-ADDWN0711    WL0216           PS Pieces Produ
     C                     Z-ADDWN0712    WL0217           PS Weight Fab N
     C                     Z-ADDWN0713    WL0218           PS Pieces Fab N
     C                     Z-ADDWN0714    WL0219           PS Weight Sched
     C                     Z-ADDWN0715    WL0220           PS Pieces Sched
     C                     Z-ADDWN0716    WL0221           PS Weight Sched
     C                     Z-ADDWN0717    WL0222           PS Pieces Sched
     C                     MOVELWN0718    WL0223    P      Department Code
     C                     Z-ADDWN0719    WL0224           Item Structure
     C                     Z-ADDWN0720    WL0225           Item Structure
     C                     Z-ADDWN0721    WL0226           Item Structure
     C                     MOVELWN0722    WL0227    P      Primal Group Co
     C                     MOVELWN0723    WL0228    P      EDI Status 1
     C                     MOVELWN0724    WL0229    P      EDI Status 2
     C                     MOVELWN0725    WL0230    P      EDI Status 3
     C                     MOVELWN0726    WL0231    P      Record Status
     C                     Z-ADDWN0727    WL0232           Job Time
     C                     MOVELWN0728    WL0233    P      User Id
     C                     MOVELWN0729    WL0234    P      Job Name
     C                     Z-ADDWN0730    WL0235           Job Date
     C                     EXSR TQCRRC
      * FP1054 create consumed records
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0254    IFGT *ZERO                      *IF
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0258           Company Number
     C                     Z-ADDWL0254    WL0259           Order Number
     C                     Z-ADDWL0255    WL0260           Order Sequence
     C                     Z-ADDWL0256    WL0261           Order Secondary
     C                     Z-ADDWL0249    WL0262           OD Production D
     C                     Z-ADDYL0058    WL0263           ODS Sequence Nu
     C                     Z-ADDWL0250    WL0264           Consumed Item C
     C                     Z-ADDWL0250    WL0265           Item Code
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0263    YL0058           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0058    IFEQ *ZERO                      *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0266           Company Number
     C                     Z-ADDWL0254    WL0267           Order Number
     C                     Z-ADDWL0255    WL0268           Order Sequence
     C                     Z-ADDWL0256    WL0269           Order Secondary
     C                     Z-ADDWL0249    WL0270           OD Production D
     C                     Z-ADDYL0058    WL0271           ODS Sequence Nu
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0271    YL0058           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0272           Company Number
     C                     Z-ADDWL0254    WL0273           Order Number
     C                     Z-ADDWL0255    WL0274           Order Sequence
     C                     Z-ADDWL0256    WL0275           Order Secondary
     C                     Z-ADDWL0249    WL0276           OD Production D
     C                     Z-ADDYL0058    WL0277           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0278           Scheduled Ship
     C                     MOVELWL0251    WL0279    P      Warehouse Code
     C                     Z-ADDWL0250    WL0280           Consumed Item C
     C                     Z-ADDWL0250    WL0281           Item Code
     C                     Z-ADDWL0253    WL0282           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0252    WL0283           OD Weight Sched
     C                     Z-ADD*ZERO     WL0284           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0285           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0286           Deadline Depart
     C                     Z-ADD*ZERO     WL0287           Deadline Depart
     C                     EXSR TYRVGN
     C                     END                             *FI
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSOAWT    ADD  WL0252    WN0672           PS Weight Prod
     C           WSCDNB    ADD  WL0253    WN0673           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR NBCHRC
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
      * CASE: PAR.Status Flag 19 Y/N is Yes
     C           WL0257    IFEQ 'Y'                        *IF
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0254    IFGT *ZERO                      *IF
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0258           Company Number
     C                     Z-ADDWL0254    WL0259           Order Number
     C                     Z-ADDWL0255    WL0260           Order Sequence
     C                     Z-ADDWL0256    WL0261           Order Secondary
     C                     Z-ADDWL0249    WL0262           OD Production D
     C                     Z-ADDYL0058    WL0263           ODS Sequence Nu
     C                     Z-ADDWL0250    WL0264           Consumed Item C
     C                     Z-ADDWL0250    WL0265           Item Code
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0263    YL0058           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0058    IFEQ *ZERO                      *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0266           Company Number
     C                     Z-ADDWL0254    WL0267           Order Number
     C                     Z-ADDWL0255    WL0268           Order Sequence
     C                     Z-ADDWL0256    WL0269           Order Secondary
     C                     Z-ADDWL0249    WL0270           OD Production D
     C                     Z-ADDYL0058    WL0271           ODS Sequence Nu
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0271    YL0058           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0247    WL0272           Company Number
     C                     Z-ADDWL0254    WL0273           Order Number
     C                     Z-ADDWL0255    WL0274           Order Sequence
     C                     Z-ADDWL0256    WL0275           Order Secondary
     C                     Z-ADDWL0249    WL0276           OD Production D
     C                     Z-ADDYL0058    WL0277           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0278           Scheduled Ship
     C                     MOVELWL0251    WL0279    P      Warehouse Code
     C                     Z-ADDWL0250    WL0280           Consumed Item C
     C                     Z-ADDWL0250    WL0281           Item Code
     C                     Z-ADDWL0253    WL0282           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0252    WL0283           OD Weight Sched
     C                     Z-ADD*ZERO     WL0284           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0285           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0286           Deadline Depart
     C                     Z-ADD*ZERO     WL0287           Deadline Depart
     C                     EXSR TYRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0263           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTW01           Company Number
     C           *LIKE     DEFN TDC4NB    WQTW02           Order Number
     C           *LIKE     DEFN TDDPNB    WQTW03           Order Sequence
     C           *LIKE     DEFN TDUENB    WQTW04           Order Secondary
     C           *LIKE     DEFN TDJGDT    WQTW05           OD Production D
     C           *LIKE     DEFN TDNUDT    WQTW06           Consumed Item C
     C           *LIKE     DEFN TDHGCD    WQTW07           Item Code
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW01           Company Number
     C                     KFLD           WQTW02           Order Number
     C                     KFLD           WQTW03           Order Sequence
     C                     KFLD           WQTW04           Order Secondary
     C                     KFLD           WQTW05           OD Production D
     C                     KFLD           WQTW06           Consumed Item C
     C                     KFLD           WQTW07           Item Code
      * Setup key
     C                     Z-ADDWL0258    WQTW01           Company Number
     C                     Z-ADDWL0259    WQTW02           Order Number
     C                     Z-ADDWL0260    WQTW03           Order Sequence
     C                     Z-ADDWL0261    WQTW04           Order Secondary
     C                     Z-ADDWL0262    WQTW05           OD Production D
     C                     Z-ADDWL0264    WQTW06           Consumed Item C
     C                     Z-ADDWL0265    WQTW07           Item Code
      * Establish starting position
     C           KRSTW     SETLL@B6CPAG                    *
     C           KRSTW     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTDOONY    WL0263           ODS Sequence Nu
     C           KRSTW     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0271           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTX01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTX02           Order Number
     C           *LIKE     DEFN WFDPNB    WQTX03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQTX04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQTX05           OD Production D
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Company Number
     C                     KFLD           WQTX02           Order Number
     C                     KFLD           WQTX03           Order Sequence
     C                     KFLD           WQTX04           Order Secondary
     C                     KFLD           WQTX05           OD Production D
      * Setup key
     C                     Z-ADDWL0266    WQTX01           Company Number
     C                     Z-ADDWL0267    WQTX02           Order Number
     C                     Z-ADDWL0268    WQTX03           Order Sequence
     C                     Z-ADDWL0269    WQTX04           Order Secondary
     C                     Z-ADDWL0270    WQTX05           OD Production D
      * Establish starting position
     C           KRSTX     SETLL@B6CPNB                    *
     C           KRSTX     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWFOONY    WL0271           ODS Sequence Nu
     C           KRSTX     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0271           ODS Sequence Nu
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0731  1        EDI Status 1
     C                     MOVEL*BLANK    WN0732  1        EDI Status 2
     C                     MOVEL*BLANK    WN0733  1        EDI Status 3
     C                     MOVEL*BLANK    WN0734  1        Record Status
     C                     Z-ADD*ZERO     WN0735  60       Job Time
     C                     MOVEL*BLANK    WN0736 10        User Id
     C                     MOVEL*BLANK    WN0737 10        Job Name
     C                     Z-ADD*ZERO     WN0738  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C                     KFLD           WFOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDWL0272    WFAIC3           Company Number
     C                     Z-ADDWL0273    WFC4NB           Order Number
     C                     Z-ADDWL0274    WFDPNB           Order Sequence
     C                     Z-ADDWL0275    WFUENB           Order Secondary
     C                     Z-ADDWL0276    WFJGDT           OD Production D
     C                     Z-ADDWL0277    WFOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSTY     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0282    IFGT *ZERO                      *IF
     C           WL0283    ORGT *ZERO                      *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR TZCRRC
     C                     END                             *FI
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFFLWG    ADD  WL0283    YL0059           OD Weight Sched
     C           WFIGQT    ADD  WL0282    YL0060           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFLE *ZERO                      *IF
     C           YL0059    IFLE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0011           Company Number
     C                     Z-ADDWFC4NB    WL0012           Order Number
     C                     Z-ADDWFDPNB    WL0013           Order Sequence
     C                     Z-ADDWFUENB    WL0014           Order Secondary
     C                     Z-ADDWFJGDT    WL0015           OD Production D
     C                     Z-ADDWFOONY    WL0016           ODS Sequence Nu
     C                     EXSR SHDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR NACHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDWL0272    WGAIC3           Company Number
     C                     Z-ADDWL0273    WGC4NB           Order Number
     C                     Z-ADDWL0274    WGDPNB           Order Sequence
     C                     Z-ADDWL0275    WGUENB           Order Secondary
     C                     Z-ADDWL0276    WGJGDT           OD Production D
     C                     Z-ADDWL0277    WGOONY           ODS Sequence Nu
     C                     Z-ADDWL0278    WGAODT           Scheduled Ship
     C                     MOVELWL0279    WGAJCD           Warehouse Code
     C                     Z-ADDWL0280    WGNUDT           Consumed Item C
     C                     Z-ADDWL0281    WGHGCD           Item Code
     C                     Z-ADDWL0282    WGIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0283    WGFLWG           OD Weight Sched
     C                     Z-ADDWL0284    WGNSQT           ODS Quantity Sh
     C                     Z-ADDWL0285    WGJQWG           ODS Weight Shor
     C                     Z-ADDWL0286    WGNVDT           Deadline Depart
     C                     Z-ADDWL0287    WGBUTM           Deadline Depart
     C                     MOVELWN0731    WGUVST           EDI Status 1
     C                     MOVELWN0732    WGUWST           EDI Status 2
     C                     MOVELWN0733    WGUXST           EDI Status 3
     C                     MOVELWN0734    WGVSST           Record Status
     C                     Z-ADDWN0735    WGAATM           Job Time
     C                     MOVELWN0736    WGAYNA           User Id
     C                     MOVELWN0737    WGA0NA           Job Name
     C                     Z-ADDWN0738    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRTZ    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAJGDT           OD Production D
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WAF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCJGDT           OD Production D
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WCFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WCIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WCF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WCIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WCF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WFFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WFNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WFJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WHMAVA           Billing Detail
     C                     Z-ADD*ZERO     WHKDVA           Billing Detail
     C                     Z-ADD*ZERO     WHL8VA           Billing Detail
     C                     Z-ADD*ZERO     WHL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WHAYVA           Extended Amount
     C                     Z-ADD*ZERO     WHEXDT           Market Pricing
     C                     Z-ADD*ZERO     WHBZPR           Price Overage O
     C                     Z-ADD*ZERO     WHL6NB           Contract Number
     C                     Z-ADD*ZERO     WHGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WHD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WHCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WHCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WHATWG           Weight Shipped
     C                     Z-ADD*ZERO     WHAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAKPR           Unit Price
     C                     Z-ADD*ZERO     WHALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WHAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WHAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WHA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WHB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WHA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WHNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WHNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WHNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WHNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WHNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WHBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHBVTM           Price Code
     C                     Z-ADD*ZERO     WHBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WHBXTM           Substitution Li
     C                     Z-ADD*ZERO     WHBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WHH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WHH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WHH7NX           OD Item Target
     C                     Z-ADD*ZERO     WHH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WHH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WHDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WHDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WHDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WHDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WHDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WHGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WHGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WHGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WHPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WHRINY           Item Age Days
     C                     Z-ADD*ZERO     WHTIDT           Production Ovr
     C                     Z-ADD*ZERO     WHTJDT           Production Ovr
     C                     Z-ADD*ZERO     WHTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WHTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WHTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WIAIWG           Unit Weight
     C                     Z-ADD*ZERO     WICZWG           Minimum Weight
     C                     Z-ADD*ZERO     WIC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WIURTN           Number Cases On
     C                     Z-ADD*ZERO     WIAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WITFNB           Transportation
     C                     Z-ADD*ZERO     WITMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WITNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WIBLPR           Market Overage
     C                     Z-ADD*ZERO     WIBMPR           Standard Overag
     C                     Z-ADD*ZERO     WICMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WICHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WISWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WIPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WIICN1           Item Category N
     C                     Z-ADD*ZERO     WIICN2           Item Category N
     C                     Z-ADD*ZERO     WIV2NB           Item Category N
     C                     Z-ADD*ZERO     WIITCN           Item Category N
     C                     Z-ADD*ZERO     WIITC5           Item Category N
     C                     Z-ADD*ZERO     WIICN6           Item Category N
     C                     Z-ADD*ZERO     WIICN7           Item Category N
     C                     Z-ADD*ZERO     WIICN8           Item Category N
     C                     Z-ADD*ZERO     WIICN9           Item Category N
     C                     Z-ADD*ZERO     WIICN0           Item Category N
     C                     Z-ADD*ZERO     WISFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WIA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WISJNB           Production Lead
     C                     Z-ADD*ZERO     WISKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WISLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WISMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WICFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WICGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WIILNB           Packages per ca
     C                     Z-ADD*ZERO     WICHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WICINB           PM Batch Size
     C                     Z-ADD*ZERO     WICJNB           Package Level s
     C                     Z-ADD*ZERO     WICMNB           Partial Item Co
     C                     Z-ADD*ZERO     WICNNB           WIP Item Code
     C                     Z-ADD*ZERO     WICRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WICSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WICVNB           FP Std Green We
     C                     Z-ADD*ZERO     WICWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WICXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WICZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WIC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WIB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WIB5NB           PM Line Number
     C                     Z-ADD*ZERO     WIBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WIBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WIF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WIF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WIF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WIBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WIBNNB           Production Qty
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WJBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WJBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WJBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WJBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WMCQNB           Julian Date
     C                     Z-ADD*ZERO     WMESNB           Accounting Year
     C                     Z-ADD*ZERO     WMETNB           Accounting Peri
     C                     Z-ADD*ZERO     WMBZNB           OM Week
     C                     Z-ADD*ZERO     WMEINB           Week Number
     C                     Z-ADD*ZERO     WMAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WMOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WMNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WMNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WMOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WMOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOACWG           Quantity on Han
     C                     Z-ADD*ZERO     WOARQT           Quantity on Han
     C                     Z-ADD*ZERO     WOK7DT           Label Date
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSELDT           Production Date
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WSWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WSQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WSDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WSF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WSWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WSD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WSDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WSB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WSWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WSPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WSSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WSB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WSD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WSCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WSEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WSCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WSE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WSD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WSOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WSCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WSUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WSCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WSF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WSBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WSGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WSBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WSPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WSDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WSD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WSFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WSD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WSDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WSEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WSSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WSEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WSECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WSWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WSEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WSFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WSEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WSQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WSEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WSEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WSRGNB           Item Structure
     C                     Z-ADD*ZERO     WSRHNB           Item Structure
     C                     Z-ADD*ZERO     WSRINB           Item Structure
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWHGCD           Item Code
     C                     Z-ADD*ZERO     WWOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WWORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WWS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WWMJDT           Create Date
     C                     Z-ADD*ZERO     WWBETM           Create Time
     C                     Z-ADD*ZERO     WWMKDT           Change Date
     C                     Z-ADD*ZERO     WWBFTM           Change Time
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBELDT           Production Date
     C                     Z-ADD*ZERO     TBHVHD           Hog Volume
     C                     Z-ADD*ZERO     TBZ6NB           Average Live We
     C                     Z-ADD*ZERO     TBZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     TBDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     TBAVCW           Average Cold We
     C                     Z-ADD*ZERO     TBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     TBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     TBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     TBECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBDLRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SFDLRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
      * Define local variables for subroutine SHDLRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  30
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  30
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  2
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026 30
     C                     MOVEL*BLANK    WL0027  2
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  30
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  3
     C                     Z-ADD*ZERO     WL0034  52
     C                     MOVEL*BLANK    WL0035  2
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     Z-ADD*ZERO     WL0038 112
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  6
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  6
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0052  3
     C                     MOVEL*BLANK    WL0053  2
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
     C                     Z-ADD*ZERO     WL0057  52
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0058  30
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  30
     C                     Z-ADD*ZERO     WL0061  30
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0062  30
     C                     Z-ADD*ZERO     WL0063  70
     C                     MOVEL*BLANK    WL0064  1
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0065  30
     C                     Z-ADD*ZERO     WL0066  70
     C                     MOVEL*BLANK    WL0067  3
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069 112
     C                     MOVEL*BLANK    WL0070  1
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  30
     C                     Z-ADD*ZERO     WL0075  30
     C                     Z-ADD*ZERO     WL0076 112
     C                     Z-ADD*ZERO     WL0077 112
     C                     Z-ADD*ZERO     WL0078 112
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083  70
      * Define local variables for subroutine TACRRC.
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  70
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  30
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
     C                     MOVEL*BLANK    WL0090  3
     C                     MOVEL*BLANK    WL0091  3
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093 112
     C                     Z-ADD*ZERO     WL0094 112
     C                     Z-ADD*ZERO     WL0095 112
     C                     Z-ADD*ZERO     WL0096 112
     C                     Z-ADD*ZERO     WL0097 112
     C                     Z-ADD*ZERO     WL0098 112
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  2
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     Z-ADD*ZERO     WL0106  60
     C                     MOVEL*BLANK    WL0107 10
     C                     MOVEL*BLANK    WL0108 10
     C                     Z-ADD*ZERO     WL0109  70
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0110  3
     C                     MOVEL*BLANK    WL0111  3
     C                     Z-ADD*ZERO     WL0112  30
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0113  30
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  70
     C                     MOVEL*BLANK    WL0116  1
      * Define local variables for subroutine TKRVGN.
     C                     Z-ADD*ZERO     WL0117  30
     C                     MOVEL*BLANK    WL0118  1
     C                     Z-ADD*ZERO     WL0119  70
     C                     MOVEL*BLANK    WL0120  1
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0121  30
     C                     MOVEL*BLANK    WL0122  1
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  70
     C                     MOVEL*BLANK    WL0125  3
     C                     Z-ADD*ZERO     WL0126  92
     C                     Z-ADD*ZERO     WL0127 112
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  52
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  70
     C                     Z-ADD*ZERO     WL0132  30
     C                     Z-ADD*ZERO     WL0133  30
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  70
     C                     MOVEL*BLANK    WL0136  3
     C                     MOVEL*BLANK    WL0137  3
     C                     Z-ADD*ZERO     WL0138  70
     C                     Z-ADD*ZERO     WL0139  92
     C                     Z-ADD*ZERO     WL0140 112
     C                     MOVEL*BLANK    WL0141  2
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0142  30
     C                     MOVEL*BLANK    WL0143  1
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  70
     C                     MOVEL*BLANK    WL0146  3
     C                     Z-ADD*ZERO     WL0147  92
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  70
     C                     Z-ADD*ZERO     WL0150  30
     C                     Z-ADD*ZERO     WL0151  30
     C                     MOVEL*BLANK    WL0152  1
      * Define local variables for subroutine TQCRRC.
     C                     Z-ADD*ZERO     WL0153  30
     C                     MOVEL*BLANK    WL0154  1
     C                     Z-ADD*ZERO     WL0155  70
     C                     Z-ADD*ZERO     WL0156  70
     C                     MOVEL*BLANK    WL0157  3
     C                     Z-ADD*ZERO     WL0158  70
     C                     Z-ADD*ZERO     WL0159  92
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  72
     C                     Z-ADD*ZERO     WL0162  92
     C                     Z-ADD*ZERO     WL0163  92
     C                     Z-ADD*ZERO     WL0164  70
     C                     Z-ADD*ZERO     WL0165  92
     C                     Z-ADD*ZERO     WL0166  70
     C                     Z-ADD*ZERO     WL0167  92
     C                     Z-ADD*ZERO     WL0168  70
     C                     Z-ADD*ZERO     WL0169  92
     C                     Z-ADD*ZERO     WL0170  70
     C                     Z-ADD*ZERO     WL0171  92
     C                     Z-ADD*ZERO     WL0172  70
     C                     Z-ADD*ZERO     WL0173  92
     C                     Z-ADD*ZERO     WL0174  70
     C                     Z-ADD*ZERO     WL0175  92
     C                     Z-ADD*ZERO     WL0176  70
     C                     Z-ADD*ZERO     WL0177  92
     C                     Z-ADD*ZERO     WL0178  70
     C                     Z-ADD*ZERO     WL0179  92
     C                     Z-ADD*ZERO     WL0180  70
     C                     Z-ADD*ZERO     WL0181 112
     C                     Z-ADD*ZERO     WL0182  70
     C                     Z-ADD*ZERO     WL0183 112
     C                     Z-ADD*ZERO     WL0184  70
     C                     Z-ADD*ZERO     WL0185 112
     C                     Z-ADD*ZERO     WL0186  70
     C                     Z-ADD*ZERO     WL0187 112
     C                     Z-ADD*ZERO     WL0188  70
     C                     Z-ADD*ZERO     WL0189 112
     C                     Z-ADD*ZERO     WL0190  70
     C                     Z-ADD*ZERO     WL0191 112
     C                     Z-ADD*ZERO     WL0192  70
     C                     MOVEL*BLANK    WL0193  3
     C                     MOVEL*BLANK    WL0194  2
     C                     MOVEL*BLANK    WL0195  1
     C                     MOVEL*BLANK    WL0196  1
     C                     MOVEL*BLANK    WL0197  1
     C                     MOVEL*BLANK    WL0198  1
     C                     MOVEL*BLANK    WL0199  1
     C                     MOVEL*BLANK    WL0200  1
     C                     MOVEL*BLANK    WL0201  1
     C                     MOVEL*BLANK    WL0202  1
     C                     MOVEL*BLANK    WL0203  2
     C                     MOVEL*BLANK    WL0204  3
     C                     Z-ADD*ZERO     WL0205  92
     C                     Z-ADD*ZERO     WL0206  70
     C                     Z-ADD*ZERO     WL0207  92
     C                     Z-ADD*ZERO     WL0208  70
     C                     Z-ADD*ZERO     WL0209  92
     C                     Z-ADD*ZERO     WL0210  70
     C                     Z-ADD*ZERO     WL0211  92
     C                     Z-ADD*ZERO     WL0212  70
     C                     Z-ADD*ZERO     WL0213  92
     C                     Z-ADD*ZERO     WL0214  70
     C                     Z-ADD*ZERO     WL0215  92
     C                     Z-ADD*ZERO     WL0216  70
     C                     Z-ADD*ZERO     WL0217  92
     C                     Z-ADD*ZERO     WL0218  70
     C                     Z-ADD*ZERO     WL0219  92
     C                     Z-ADD*ZERO     WL0220  70
     C                     Z-ADD*ZERO     WL0221  92
     C                     Z-ADD*ZERO     WL0222  70
     C                     MOVEL*BLANK    WL0223  6
     C                     Z-ADD*ZERO     WL0224  30
     C                     Z-ADD*ZERO     WL0225  30
     C                     Z-ADD*ZERO     WL0226  30
     C                     MOVEL*BLANK    WL0227  6
     C                     MOVEL*BLANK    WL0228  1
     C                     MOVEL*BLANK    WL0229  1
     C                     MOVEL*BLANK    WL0230  1
     C                     MOVEL*BLANK    WL0231  1
     C                     Z-ADD*ZERO     WL0232  60
     C                     MOVEL*BLANK    WL0233 10
     C                     MOVEL*BLANK    WL0234 10
     C                     Z-ADD*ZERO     WL0235  70
      * Define local variables for subroutine TRRVGN.
     C                     Z-ADD*ZERO     WL0236  30
     C                     Z-ADD*ZERO     WL0237  70
     C                     Z-ADD*ZERO     WL0238  52
     C                     Z-ADD*ZERO     WL0239  70
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0240  30
     C                     MOVEL*BLANK    WL0241  1
     C                     Z-ADD*ZERO     WL0242  70
     C                     Z-ADD*ZERO     WL0243  70
     C                     MOVEL*BLANK    WL0244  3
     C                     Z-ADD*ZERO     WL0245  70
     C                     Z-ADD*ZERO     WL0246 112
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0247  30
     C                     MOVEL*BLANK    WL0248  1
     C                     Z-ADD*ZERO     WL0249  70
     C                     Z-ADD*ZERO     WL0250  70
     C                     MOVEL*BLANK    WL0251  3
     C                     Z-ADD*ZERO     WL0252  92
     C                     Z-ADD*ZERO     WL0253  70
     C                     Z-ADD*ZERO     WL0254  70
     C                     Z-ADD*ZERO     WL0255  30
     C                     Z-ADD*ZERO     WL0256  30
     C                     MOVEL*BLANK    WL0257  1
      * Define local variables for subroutine TWRVGN.
     C                     Z-ADD*ZERO     WL0258  30
     C                     Z-ADD*ZERO     WL0259  70
     C                     Z-ADD*ZERO     WL0260  30
     C                     Z-ADD*ZERO     WL0261  30
     C                     Z-ADD*ZERO     WL0262  70
     C                     Z-ADD*ZERO     WL0263  30
     C                     Z-ADD*ZERO     WL0264  70
     C                     Z-ADD*ZERO     WL0265  70
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0266  30
     C                     Z-ADD*ZERO     WL0267  70
     C                     Z-ADD*ZERO     WL0268  30
     C                     Z-ADD*ZERO     WL0269  30
     C                     Z-ADD*ZERO     WL0270  70
     C                     Z-ADD*ZERO     WL0271  30
      * Define local variables for subroutine TYRVGN.
     C                     Z-ADD*ZERO     WL0272  30
     C                     Z-ADD*ZERO     WL0273  70
     C                     Z-ADD*ZERO     WL0274  30
     C                     Z-ADD*ZERO     WL0275  30
     C                     Z-ADD*ZERO     WL0276  70
     C                     Z-ADD*ZERO     WL0277  30
     C                     Z-ADD*ZERO     WL0278  70
     C                     MOVEL*BLANK    WL0279  3
     C                     Z-ADD*ZERO     WL0280  70
     C                     Z-ADD*ZERO     WL0281  70
     C                     Z-ADD*ZERO     WL0282 112
     C                     Z-ADD*ZERO     WL0283 112
     C                     Z-ADD*ZERO     WL0284  50
     C                     Z-ADD*ZERO     WL0285  92
     C                     Z-ADD*ZERO     WL0286  70
     C                     Z-ADD*ZERO     WL0287  60
      * Define local variables for subroutine NCRVGN.
     C                     Z-ADD*ZERO     WL0288  30
     C                     Z-ADD*ZERO     WL0289  70
     C                     Z-ADD*ZERO     WL0290  70
     C                     Z-ADD*ZERO     WL0291  70
     C                     Z-ADD*ZERO     WL0292  80
      * Define local variables for subroutine NDRVGN.
     C                     Z-ADD*ZERO     WL0293  30
     C                     Z-ADD*ZERO     WL0294  70
     C                     Z-ADD*ZERO     WL0295  70
     C                     Z-ADD*ZERO     WL0296  70
     C                     Z-ADD*ZERO     WL0297  80
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Ship Date USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field ATS Adj Type USR 2
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0020  52
      * Define local work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field OD Adj Type Override
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0025  1
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Chill Time USR
     C                     Z-ADD*ZERO     YL0027  30
      * Define local work field Chilling Time USR
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0031 112
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0032 112
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0034 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     YL0036 112
      * Define local work field ATS Weight Need USR
     C                     Z-ADD*ZERO     YL0037 112
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0039 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0040 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0041 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0042 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0043 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0044 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0045 112
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0046 112
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0047  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0048  30
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0050  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0051  70
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0052  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Production Day Status USR
     C                     MOVEL*BLANK    YL0054  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0003  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0055  1
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0004  20
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0057  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0058  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0059 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0060 112
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0061  70
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0062  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 1111110
00003 SHIPOFFCUT
00004 SCHEDASORD
00005 ORDREALC
00006 SCHASORD
