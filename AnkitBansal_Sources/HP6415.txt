      *These two lines here to aid in debugging when needed***************
     H debug(*yes)
     H option(*srcstmt:*nodebugio)
      *****************  RPG PROGRAM HEADING  ************************
      * SYSTEM:      Hog Production System
      * PROGRAM:     HP6415
      * TITLE:       Listing of BGF Targets
      * PROGRAMMER:  Sharon Zurn
      * CREATED:     10/18/06
      *
      *            This listing is submitted from HP4415-Specify BGF Target
      *            Listing Options.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      * 09/26/07  LeAnne Ramsey
      *           Clean up code. Changed program name from HP6002 to HP6415.
      *
      * 11/06/08  LeAnne Ramsey
      *           Added the 3 new fields in HSP096-BGF Yearly Targets to this listing:
      *            1) open gilt pool eligible
      *            2) litters farrowed/mated female/year
      *            3) pigs weaned/mated female/year
      *
      * 05/28/09  LeAnne Ramsey
      *           Added 1 new field to HSP096-BGF Yearly Targets and Report:
      *            1) farrowing crates
      *
      * 10/16/13  LeAnne Ramsey (E2831)
      *           Recompile only. Added field 'MTech Reference'.
      /EJECT
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Fhsp018    if   e           k disk
      *    Farm site
      *
      *
     Fhsp095    if   e           k disk
      *    BGF target tables
      *
      *
     Fhsp096    if   e           k disk
      *   BGF yearly targets (records selected by open query)
      *
      *
     Fhsl097c   if   e           k disk
      *    BGF target table/farm links
      *
      *
     Fprint198  o    f  198        printer oflind(*inof)
      *
      /EJECT
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      ****************************************************************
      * CONSTANTS
      ****************************************************************
      *
     D yes             c                   'Y'
     D no              c                   'N'
      *
      *
      ****************************************************************
      * STANDALONE FIELDS
      ****************************************************************
      *
      * Control fields
      *
     D first           s              1
     D gotfl           s              1
      *
      *
      * Print fields
      *
     D dash            s            198    inz(*all'-')
     D rtime           s              6  0
      *
      *
      * Work fields for date manipulation
      *
     D wkcymdiso       s               D   datfmt(*iso)
     D wksysdt         s              8  0
      *
      *
      * Workfields
      *
     d wkfarm          s              6
     d wklength        s              5  0
     d wkused          s              2  0
      *
     D wkrt            s              7  4
     D wkamt           s             10  4
      *
      *
      * Print fields
      *
     D h1ttbds         s                   like(btttbds)
     D h1targetfl      s              3a
     D h1farmfl        s              3a
      *
     D q1fwinhd        s                   like(byfwinhd)
     D q2fwinhd        s                   like(byfwinhd)
     D q3fwinhd        s                   like(byfwinhd)
     D q4fwinhd        s                   like(byfwinhd)
     D q1opglhd        s                   like(byopglhd)
     D q2opglhd        s                   like(byopglhd)
     D q3opglhd        s                   like(byopglhd)
     D q4opglhd        s                   like(byopglhd)
     D q1glsv          s                   like(byglsv)
     D q2glsv          s                   like(byglsv)
     D q3glsv          s                   like(byglsv)
     D q4glsv          s                   like(byglsv)
     D q1tosv          s                   like(bytosv)
     D q2tosv          s                   like(bytosv)
     D q3tosv          s                   like(bytosv)
     D q4tosv          s                   like(bytosv)
     D q1crpr          s                   like(bycrpr)
     D q2crpr          s                   like(bycrpr)
     D q3crpr          s                   like(bycrpr)
     D q4crpr          s                   like(bycrpr)
     D q1prhd          s                   like(byprhd)
     D q2prhd          s                   like(byprhd)
     D q3prhd          s                   like(byprhd)
     D q4prhd          s                   like(byprhd)
     D q1fopr          s                   like(byfopr)
     D q2fopr          s                   like(byfopr)
     D q3fopr          s                   like(byfopr)
     D q4fopr          s                   like(byfopr)
     D q1frpr          s                   like(byfrpr)
     D q2frpr          s                   like(byfrpr)
     D q3frpr          s                   like(byfrpr)
     D q4frpr          s                   like(byfrpr)
     D q1glfart        s                   like(byglfart)
     D q2glfart        s                   like(byglfart)
     D q3glfart        s                   like(byglfart)
     D q4glfart        s                   like(byglfart)
     D q1tolt          s                   like(bytolt)
     D q2tolt          s                   like(bytolt)
     D q3tolt          s                   like(bytolt)
     D q4tolt          s                   like(bytolt)
     D q1gllt          s                   like(bygllt)
     D q2gllt          s                   like(bygllt)
     D q3gllt          s                   like(bygllt)
     D q4gllt          s                   like(bygllt)
     D q1lttbhd        s                   like(bylttbhd)
     D q2lttbhd        s                   like(bylttbhd)
     D q3lttbhd        s                   like(bylttbhd)
     D q4lttbhd        s                   like(bylttbhd)
     D q1lttbghd       s                   like(bylttbghd)
     D q2lttbghd       s                   like(bylttbghd)
     D q3lttbghd       s                   like(bylttbghd)
     D q4lttbghd       s                   like(bylttbghd)
     D q1tbhd          s                   like(bytbhd)
     D q2tbhd          s                   like(bytbhd)
     D q3tbhd          s                   like(bytbhd)
     D q4tbhd          s                   like(bytbhd)
     D q1tbglhd        s                   like(bytbglhd)
     D q2tbglhd        s                   like(bytbglhd)
     D q3tbglhd        s                   like(bytbglhd)
     D q4tbglhd        s                   like(bytbglhd)
     D q1sbpr          s                   like(bysbpr)
     D q2sbpr          s                   like(bysbpr)
     D q3sbpr          s                   like(bysbpr)
     D q4sbpr          s                   like(bysbpr)
     D q1ltbahd        s                   like(byltbahd)
     D q2ltbahd        s                   like(byltbahd)
     D q3ltbahd        s                   like(byltbahd)
     D q4ltbahd        s                   like(byltbahd)
     D q1ltbaghd       s                   like(byltbaghd)
     D q2ltbaghd       s                   like(byltbaghd)
     D q3ltbaghd       s                   like(byltbaghd)
     D q4ltbaghd       s                   like(byltbaghd)
     D q1bahd          s                   like(bybahd)
     D q2bahd          s                   like(bybahd)
     D q3bahd          s                   like(bybahd)
     D q4bahd          s                   like(bybahd)
     D q1tolspr        s                   like(bytolspr)
     D q2tolspr        s                   like(bytolspr)
     D q3tolspr        s                   like(bytolspr)
     D q4tolspr        s                   like(bytolspr)
     D q1ltwnhd        s                   like(byltwnhd)
     D q2ltwnhd        s                   like(byltwnhd)
     D q3ltwnhd        s                   like(byltwnhd)
     D q4ltwnhd        s                   like(byltwnhd)
     D q1townhd        s                   like(bytownhd)
     D q2townhd        s                   like(bytownhd)
     D q3townhd        s                   like(bytownhd)
     D q4townhd        s                   like(bytownhd)
     D q1varpr         s                   like(byvarpr)
     D q2varpr         s                   like(byvarpr)
     D q3varpr         s                   like(byvarpr)
     D q4varpr         s                   like(byvarpr)
     D q1nurrchd       s                   like(bynurrchd)
     D q2nurrchd       s                   like(bynurrchd)
     D q3nurrchd       s                   like(bynurrchd)
     D q4nurrchd       s                   like(bynurrchd)
     D q1avsv          s                   like(byavsv)
     D q2avsv          s                   like(byavsv)
     D q3avsv          s                   like(byavsv)
     D q4avsv          s                   like(byavsv)
     D q1avlt          s                   like(byavlt)
     D q2avlt          s                   like(byavlt)
     D q3avlt          s                   like(byavlt)
     D q4avlt          s                   like(byavlt)
     D q1avltmt        s                   like(byavltmt)
     D q2avltmt        s                   like(byavltmt)
     D q3avltmt        s                   like(byavltmt)
     D q4avltmt        s                   like(byavltmt)
     D q1avwn          s                   like(byavwn)
     D q2avwn          s                   like(byavwn)
     D q3avwn          s                   like(byavwn)
     D q4avwn          s                   like(byavwn)
     D q1avwnmt        s                   like(byavwnmt)
     D q2avwnmt        s                   like(byavwnmt)
     D q3avwnmt        s                   like(byavwnmt)
     D q4avwnmt        s                   like(byavwnmt)
     D q1fmddpr        s                   like(byfmddpr)
     D q2fmddpr        s                   like(byfmddpr)
     D q3fmddpr        s                   like(byfmddpr)
     D q4fmddpr        s                   like(byfmddpr)
     D q1aborpr        s                   like(byaborpr)
     D q2aborpr        s                   like(byaborpr)
     D q3aborpr        s                   like(byaborpr)
     D q4aborpr        s                   like(byaborpr)
     D q1crates        s                   like(bycrates)
     D q2crates        s                   like(bycrates)
     D q3crates        s                   like(bycrates)
     D q4crates        s                   like(bycrates)
      *
     D t1fwinhd        s              7  0
     D t1opglhd        s              7  0
     D t1glsv          s                   like(byglsv)
     D t1tosv          s                   like(bytosv)
     D t1crpr          s                   like(bycrpr)
     D t1prhd          s              7  0
     D t1fopr          s                   like(byfopr)
     D t1frpr          s                   like(byfrpr)
     D t1glfart        s                   like(byglfart)
     D t1tolt          s                   like(bytolt)
     D t1gllt          s                   like(bygllt)
     D t1lttbhd        s              7  0
     D t1lttbghd       s              7  0
     D t1tbhd          s              7  0
     D t1tbglhd        s              7  0
     D t1sbpr          s                   like(bysbpr)
     D t1ltbahd        s              7  0
     D t1ltbaghd       s              7  0
     D t1bahd          s              7  0
     D t1tolspr        s                   like(bytolspr)
     D t1ltwnhd        s              7  0
     D t1townhd        s              7  0
     D t1varpr         s                   like(byvarpr)
     D t1nurrchd       s              7  0
     D t1avsv          s                   like(byavsv)
     D t1avlt          s                   like(byavlt)
     D t1avltmt        s                   like(byavltmt)
     D t1avwn          s              6  2
     D t1avwnmt        s              6  2
     D t1fmddpr        s                   like(byfmddpr)
     D t1aborpr        s                   like(byaborpr)
     D t1crates        s              5  0
      *
     d t1curfarms      s            105
      *
      ****************************************************************
      * DATA STRUCTURES
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      *---------------------------------------------------------------
      * Local data area.
      *---------------------------------------------------------------
      *
     Dlda             uds                  dtaara(*lda)
     D  ldttbcd                2      6
     D  ldtargetfl             7      7
     D  ldcdyr                 8     11  0
     D  ldfarmfl              12     12
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ******************************************************************************************
      * MAINLINE
      ******************************************************************************************
      *
      * Set on overflow so that printings will print the first time thru regardless
      * of what you are printing.
      *
     C                   seton                                        of
      *
      * Read all records in the BGF Target Tables file.
      * Process records if they meet the user's selection criteria.
      *
     C     *loval        setll     hsp095
     C                   dou       *in90 = *on                                  Main do
     C                   read      hsp095                                 90
     C                   if        *in90 = *off and                             If not EOF
     C                             (ldttbcd = *blank or ldttbcd = btttbcd)
      *
     C                   move      no            first
      *
      * If user has elected to print the farms currently tied to this table,
      * then retrieve farms and concatenate into a print field.
      *
     C                   if        ldfarmfl = yes
     C                   exsr      $current
     C                   endif
      *
      * The user may be printing:
      *     1) just a listing of Target Table codes
      *     2) Target Tables along with their yearly targets for a specified year
      *
     C                   if        ldtargetfl = no
     C                   exsr      $l2dtl
     C                   else
     C                   exsr      $targets
     C                   endif
      *
     C                   endif                                                  If not EOF
     C                   enddo                                                  Main do
      *
      *---------------
      * EOF processing
      *---------------
      * If the file was empty, print the standard 'no data...' message.
      *
     C                   if        first = yes
     C                   except    nodata
     C                   endif
      *
     C                   seton                                        lr
      /eject
      *---------------------------------------------------------------
      * Retrieve all 4 records (quarters) for this Target Table/Year
      *---------------------------------------------------------------
      *
     C     $targets      begsr
      *
     C                   move      no            gotfl
     C                   seton                                        of
      *
     C     btttbcd       setll     hsp096                                 91
      *
     C                   dou       *in91 = *on                                  Do loop
     C     btttbcd       reade     hsp096                                 91
     C                   if        *in91 = *off
     C                   move      yes           gotfl
     C                   exsr      $quarters
     C                   endif
     C                   enddo                                                  Do loop
      *
      * Calculate the column for yearly averages/totals
      *
     C                   if        gotfl = yes
     C                   exsr      $calc
     C                   exsr      $l1dtl
     C                   endif
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Set up all print fields for "quarters"
      *---------------------------------------------------------------
      *
     C     $quarters     begsr
      *
     C                   select
     C                   when      bycdqr = 1
     C                   z-add     bytosv        q1tosv
     C                   z-add     bycrpr        q1crpr
     C                   z-add     byfrpr        q1frpr
     C                   z-add     byltbahd      q1ltbahd
     C                   z-add     bysbpr        q1sbpr
     C                   z-add     bytolspr      q1tolspr
     C                   z-add     bytownhd      q1townhd
     C                   z-add     byfmddpr      q1fmddpr
     C                   z-add     byaborpr      q1aborpr
     C                   z-add     byfopr        q1fopr
     C                   z-add     byfwinhd      q1fwinhd
     C                   z-add     byopglhd      q1opglhd
     C                   z-add     byglsv        q1glsv
     C                   z-add     byprhd        q1prhd
     C                   z-add     byglfart      q1glfart
     C                   z-add     bytolt        q1tolt
     C                   z-add     bygllt        q1gllt
     C                   z-add     bylttbhd      q1lttbhd
     C                   z-add     bylttbghd     q1lttbghd
     C                   z-add     bytbhd        q1tbhd
     C                   z-add     bytbglhd      q1tbglhd
     C                   z-add     byltbaghd     q1ltbaghd
     C                   z-add     bybahd        q1bahd
     C                   z-add     byltwnhd      q1ltwnhd
     C                   z-add     byvarpr       q1varpr
     C                   z-add     bynurrchd     q1nurrchd
     C                   z-add     byavsv        q1avsv
     C                   z-add     byavlt        q1avlt
     C                   z-add     byavltmt      q1avltmt
     C                   z-add     byavwn        q1avwn
     C                   z-add     byavwnmt      q1avwnmt
     C                   z-add     bycrates      q1crates
      *
     C                   when      bycdqr = 2
     C                   z-add     bytosv        q2tosv
     C                   z-add     bycrpr        q2crpr
     C                   z-add     byfrpr        q2frpr
     C                   z-add     byltbahd      q2ltbahd
     C                   z-add     bysbpr        q2sbpr
     C                   z-add     bytolspr      q2tolspr
     C                   z-add     bytownhd      q2townhd
     C                   z-add     byfmddpr      q2fmddpr
     C                   z-add     byaborpr      q2aborpr
     C                   z-add     byfopr        q2fopr
     C                   z-add     byfwinhd      q2fwinhd
     C                   z-add     byopglhd      q2opglhd
     C                   z-add     byglsv        q2glsv
     C                   z-add     byprhd        q2prhd
     C                   z-add     byglfart      q2glfart
     C                   z-add     bytolt        q2tolt
     C                   z-add     bygllt        q2gllt
     C                   z-add     bylttbhd      q2lttbhd
     C                   z-add     bylttbghd     q2lttbghd
     C                   z-add     bytbhd        q2tbhd
     C                   z-add     bytbglhd      q2tbglhd
     C                   z-add     byltbaghd     q2ltbaghd
     C                   z-add     bybahd        q2bahd
     C                   z-add     byltwnhd      q2ltwnhd
     C                   z-add     byvarpr       q2varpr
     C                   z-add     bynurrchd     q2nurrchd
     C                   z-add     byavsv        q2avsv
     C                   z-add     byavlt        q2avlt
     C                   z-add     byavltmt      q2avltmt
     C                   z-add     byavwn        q2avwn
     C                   z-add     byavwnmt      q2avwnmt
     C                   z-add     bycrates      q2crates
      *
     C                   when      bycdqr = 3
     C                   z-add     bytosv        q3tosv
     C                   z-add     bycrpr        q3crpr
     C                   z-add     byfrpr        q3frpr
     C                   z-add     byltbahd      q3ltbahd
     C                   z-add     bysbpr        q3sbpr
     C                   z-add     bytolspr      q3tolspr
     C                   z-add     bytownhd      q3townhd
     C                   z-add     byfmddpr      q3fmddpr
     C                   z-add     byaborpr      q3aborpr
     C                   z-add     byfopr        q3fopr
     C                   z-add     byfwinhd      q3fwinhd
     C                   z-add     byopglhd      q3opglhd
     C                   z-add     byglsv        q3glsv
     C                   z-add     byprhd        q3prhd
     C                   z-add     byglfart      q3glfart
     C                   z-add     bytolt        q3tolt
     C                   z-add     bygllt        q3gllt
     C                   z-add     bylttbhd      q3lttbhd
     C                   z-add     bylttbghd     q3lttbghd
     C                   z-add     bytbhd        q3tbhd
     C                   z-add     bytbglhd      q3tbglhd
     C                   z-add     byltbaghd     q3ltbaghd
     C                   z-add     bybahd        q3bahd
     C                   z-add     byltwnhd      q3ltwnhd
     C                   z-add     byvarpr       q3varpr
     C                   z-add     bynurrchd     q3nurrchd
     C                   z-add     byavsv        q3avsv
     C                   z-add     byavlt        q3avlt
     C                   z-add     byavltmt      q3avltmt
     C                   z-add     byavwn        q3avwn
     C                   z-add     byavwnmt      q3avwnmt
     C                   z-add     bycrates      q3crates
      *
     C                   when      bycdqr = 4
     C                   z-add     bytosv        q4tosv
     C                   z-add     bycrpr        q4crpr
     C                   z-add     byfrpr        q4frpr
     C                   z-add     byltbahd      q4ltbahd
     C                   z-add     bysbpr        q4sbpr
     C                   z-add     bytolspr      q4tolspr
     C                   z-add     bytownhd      q4townhd
     C                   z-add     byfmddpr      q4fmddpr
     C                   z-add     byaborpr      q4aborpr
     C                   z-add     byfopr        q4fopr
     C                   z-add     byfwinhd      q4fwinhd
     C                   z-add     byopglhd      q4opglhd
     C                   z-add     byglsv        q4glsv
     C                   z-add     byprhd        q4prhd
     C                   z-add     byglfart      q4glfart
     C                   z-add     bytolt        q4tolt
     C                   z-add     bygllt        q4gllt
     C                   z-add     bylttbhd      q4lttbhd
     C                   z-add     bylttbghd     q4lttbghd
     C                   z-add     bytbhd        q4tbhd
     C                   z-add     bytbglhd      q4tbglhd
     C                   z-add     byltbaghd     q4ltbaghd
     C                   z-add     bybahd        q4bahd
     C                   z-add     byltwnhd      q4ltwnhd
     C                   z-add     byvarpr       q4varpr
     C                   z-add     bynurrchd     q4nurrchd
     C                   z-add     byavsv        q4avsv
     C                   z-add     byavlt        q4avlt
     C                   z-add     byavltmt      q4avltmt
     C                   z-add     byavwn        q4avwn
     C                   z-add     byavwnmt      q4avwnmt
     C                   z-add     bycrates      q4crates
     C                   endsl
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Retrieve farms currently set up to use this target table
      *---------------------------------------------------------------
      *
     C     $current      begsr
      *
      * Read all BGF farms from the farm master
      *
     C     *loval        setll     hsp018
      *
     C                   dou       *in93 = *on                                  Do farm loop
     C                   read      hsp018                                 93
     C                   if        *in93 = *off and fsppcd = 'BGF  '            If not EOF
      *
      * Find the 'target table' that is currently in effect for the
      * farm. If it matches the target table code that is being
      * processed, then concatenate the "farm" onto the field that
      * holds all the farms.
      *
     C     key01         chain     hsl097c                            92
     C                   if        *in92 = *on
     C     key01         setll     hsl097c
     C     fsfscd        readpe    hsl097c                                92
     C                   endif
      *
     C                   if        *in92 = *off and                             If match
     C                             bfttbcd = btttbcd
      *
     C                   eval      wkfarm = ' ' + %trim(%editc(fsfscd:'Z'))
     C                   eval      wklength =
     C                                %len(' ' + %trim(%editc(fsfscd:'Z')))
      *
     C     ' '           checkr    t1curfarms    wkused
     C                   if        wklength <= 105 - wkused
     C                   cat       wkfarm:0      t1curfarms
     C                   endif
      *
     C                   endif                                                  If match
      *
     C                   endif                                                  If not EOF
     C                   enddo                                                  Do farm loop
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Calculate values/totals for "year" column
      *---------------------------------------------------------------
      *
     C     $calc         begsr
      *
      * Female Weekly Inventory Head
     C                   eval(h)   t1fwinhd = (q1fwinhd + q2fwinhd +
     C                                          q3fwinhd + q4fwinhd) / 4
      *
      * Open Gilt Pool Eligible
     C                   eval(h)   t1opglhd = (q1opglhd + q2opglhd +
     C                                        q3opglhd + q4opglhd) / 4
      *
      * Gilt Services
     C                   eval      t1glsv = (q1glsv + q2glsv + q3glsv + q4glsv)
      *
      * Total Services
     C                   eval      t1tosv = (q1tosv + q2tosv + q3tosv + q4tosv)
      *
      * Preg Check Positive Head
     C                   eval      t1prhd = (q1prhd + q2prhd + q3prhd + q4prhd)
      *
      * Conception Rate
     C                   if        t1tosv <> 0
     C                   eval      wkrt =  t1prhd / t1tosv
     C     wkrt          mult(h)   100           t1crpr
     C                   endif
      *
      * Litters Farrowed
     C                   eval      t1tolt = (q1tolt + q2tolt+ q3tolt + q4tolt)
      *
      * Fallout Rate
     C                   if        t1prhd <> 0
     C                   eval(h)   wkrt = (t1prhd - t1tolt) / t1prhd
     C     wkrt          mult      100           t1fopr
     C                   endif
      *
      * %Aborts
     C                   eval(h)   t1aborpr = (q1aborpr + q2aborpr + q3aborpr
     C                                      + q4aborpr) / 4
      *
      * Farrowing rate
     C                   if        t1tosv <> 0
     C                   eval(h)   wkrt = t1tolt/t1tosv
     C     wkrt          mult      100           t1frpr
     C                   endif
      *
      * Gilt Litters Farrowed
      *
     C                   eval      t1gllt = (q1gllt + q2gllt + q3gllt + q4gllt)
      *
      * Gilt Farrowing rate
     C                   if        t1glsv <> 0
     C                   eval(h)   wkrt = t1gllt / t1glsv
     C     wkrt          mult      100           t1glfart
     C                   endif
      *
      * Total born
     C                   eval      t1tbhd =(q1tbhd + q2tbhd + q3tbhd + q4tbhd)
      *
      * Total born per litter
     C                   if        t1tolt <> 0
     C                   eval(h)   t1lttbhd = t1tbhd / t1tolt
     C                   endif
      *
      * Gilt Total born
     C                   eval      t1tbglhd =(q1tbglhd + q2tbglhd +
     C                                        q3tbglhd + q4tbglhd)
      *
      * Gilt Total born per litter
     C                   if        t1gllt <> 0
     C                   eval(h)   t1lttbghd = t1tbglhd / t1gllt
     C                   endif
      *
      * Total born alive
     C                   eval      t1bahd =(q1bahd + q2bahd + q3bahd + q4bahd)
      *
      * %Stillborns & Mummies per litter
     C                   if        t1tbhd <> 0
     C                   eval(h)   wkrt = (1-(t1bahd / t1tbhd))
     C     wkrt          mult      100           t1sbpr
     C                   endif
      *
      * Born Alive per litter
     C                   if        t1tolt <> 0
     C                   eval(h)   t1ltbahd = t1bahd / t1tolt
     C                   endif
      *
      * Gilt Born Alive per litter
     C                   if        t1gllt <> 0
     C                   eval(h)   t1ltbaghd = (t1tbglhd * (1-(t1sbpr/100)))
     C                             /t1gllt
     C                   endif
      *
      * Pigs Weaned From Sow Farm
     C                   eval      t1townhd =(q1townhd + q2townhd +
     C                                        q3townhd + q4townhd)
      *
      * %pre-Wean Mortality
     C                   if        t1bahd <> 0
     C                   eval      wkrt = 1-(t1townhd / t1bahd)
     C     wkrt          mult(h)   100           t1tolspr
     C                   endif
      *
      * Pigs Weaned per litter Farrowed
     C                   if        t1tolt <> 0
     C                   eval      t1ltwnhd = (t1townhd / t1tolt)
     C                   endif
      *
      * DOA/EOA/Wean Pig Variance
     C                   eval(h)   t1varpr = (q1varpr + q2varpr + q3varpr
     C                                      + q4varpr) / 4
      *
      * Total Pigs Received at Nursery
     C                   eval      wkamt     = ((t1townhd * t1varpr) / 100)
     C                   eval(h)   t1nurrchd = t1townhd - wkamt
      *
      * Breeds per Female per year.
     C                   if        t1fwinhd <> 0
     C                   eval(h)   t1avsv = t1tosv / t1fwinhd
     C                   endif
      *
      * Litters per Female per Year
     C                   if        t1fwinhd <> 0
     C                   eval(h)   t1avlt = t1tolt / t1fwinhd
     C                   endif
      *
      * Litters Farrowed/Mated Female/Year
      * (Note: Per Sami Wilson, they will not be entering Mated Females.
      *  So, I will calc the value for the TOTAL column as an average of the
      *  quarters.)
      *
     C                   eval(h)   t1avltmt =
     C                             (q1avltmt + q2avltmt + q3avltmt + q4avltmt) /
     C                             4
      *
      * Pigs weaned per Female per Year
      *
     C                   if        t1fwinhd <> 0
     C                   eval(h)   t1avwn = t1nurrchd / t1fwinhd
     C                   endif
      *
      * Pigs weaned/Mated Female/Year
      * (Note: Per Sami Wilson, they will not be entering Mated Females.
      *  So, I will calc the value for the TOTAL column as an average of the
      *  quarters.)
     C                   eval(h)   t1avwnmt =
     C                             (q1avwnmt + q2avwnmt + q3avwnmt + q4avwnmt) /
     C                             4
      *
      * %Female Mortality
     C                   eval(h)   t1fmddpr = (q1fmddpr+ q2fmddpr+ q3fmddpr
     C                                      + q4fmddpr) / 4
      *
      * Farrowing Crates
     C                   eval(h)   t1crates = (q1crates + q2crates +
     C                                        q3crates + q4crates) / 4
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Print report headings
      *---------------------------------------------------------------
      *
     C     $h1hdr        begsr
      *
     C                   except    h1hdr
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Print Detail Line when user is printing yearly targets
      *---------------------------------------------------------------
      *
     C     $l1dtl        begsr
      *
     C                   if        *inof = *on
     C                   exsr      $h1hdr
     C                   endif
      *
     C                   except    l1dtl
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Print Detail Line when user is not printing yearly targets
      *---------------------------------------------------------------
      *
     C     $l2dtl        begsr
      *
     C                   if        *inof = *on
     C                   exsr      $h1hdr
     C                   endif
      *
     C                   except    l2dtl
      *
     C                   endsr
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Key lists
      *
     C     key01         klist
     C                   kfld                    fsfscd
     C                   kfld                    wksysdt
      *
      * Set up a line of underscores and retrieve time for report heading.
      *
     C                   time                    rtime
      *
      *
      * Get the system date into CCYYMMDD format.
      *
     C                   move      *date         wkcymdiso
     C                   move      wkcymdiso     wksysdt
      *
      *  Setup the user selections in the headings.
      *
      * Target table
     C                   if        ldttbcd = *blank
     C                   seton                                        89
     C                   else
     C     ldttbcd       chain     hsp095                             92
     C                   if        *in92 = *off
     C                   movel(p)  btttbds       h1ttbds
     C                   else
     C                   movel(p)  'UNKNOWN'     h1ttbds
     C                   endif
     C                   endif
      *
      * Include targets flag
      *
     C                   select
     C                   when      ldtargetfl = yes
     C                   movel     'Yes'         h1targetfl
     C                   seton                                        87
     C                   when      ldtargetfl = no
     C                   movel     'No '         h1targetfl
     C                   endsl
      *
      * Years selection
     C                   select
     C                   when      ldcdyr = 0 and ldtargetfl = yes
     C                   seton                                        88
     C                   when      ldcdyr = 0 and ldtargetfl = no
     C                   seton                                        86
     C                   endsl
      *
      * Show current farms flag
      *
     C                   select
     C                   when      ldfarmfl = yes
     C                   movel     'Yes'         h1farmfl
     C                   seton                                        85
     C                   when      ldfarmfl = no
     C                   movel     'No '         h1farmfl
     C                   endsl
      *
      * Get the system date into CCYYMMDD format.
      *
     C                   move      *date         wkcymdiso
     C                   move      wkcymdiso     wksysdt
      *
     C                   endsr
      /EJECT
      *-------------------------------------------------------------
      * Report heading lines
      *-------------------------------------------------------------
      *
     Oprint198  e            h1hdr          1 01
     O                       sdpgm               10
     O                                           97 'HOG PRODUCTION SYSTEM'
     O                                          188 'DATE'
     O                       udate         y    198
      *
     O          e            h1hdr          1
     O                       sdusr               10
     O                                           94 'LISTING OF BGF TARGET '
     O                                          100 'TABLES'
     O                                          188 'TIME'
     O                       rtime              198 '  :  :  '
      *
     O          e            h1hdr          2
     O                                          188 'PAGE'
     O                       page          z    198
      *
     O          e            h1hdr          1
     O                                           23 'Target table .........:'
     O              N89      ldttbcd             30
     O              N89      h1ttbds             57
     O               89                          28 'All'
      *
     O          e            h1hdr          1
     O                                           23 'Include yearly targets:'
     O                       h1targetfl          28
      *
     O          e            h1hdr          1
     O                                           23 'Target year ..........:'
     O              N88N86   ldcdyr        z     29
     O               88                          28 'All'
     O               86                          29 'None'
      *
     O          e            h1hdr          2
     O                                           23 'Show current farms ...:'
     O                       h1farmfl            28
      *
      *-------------------------------------------------------------
      * Column headings
      *-------------------------------------------------------------
      *
     O          e   n87      h1hdr          1
     O                                            6 'TARGET'
      *
     O          e   n87      h1hdr          1
     O                                            5 'TABLE'
      *
     O          e   n87      h1hdr          1
     O                                            5 'CODE'
     O                                           21 'DESCRIPTION'
     O               85                          54 'CURRENT FARMS'
      *
     O          e    87      h1hdr          1
     O
     O                                           13 'TARGET TABLE:'
     O                       byttbcd             20
     O                                           49 'QTR1'
     O                                           59 'QTR2'
     O                                           69 'QTR3'
     O                                           79 'QTR4'
     O                                           89 'TOTAL'
     O               85                         107 'CURRENT FARMS'
      *
     O          e            h1hdr          1
     O                       dash               198
      *
      *-------------------------------------------------------------
      * Detail lines
      *-------------------------------------------------------------
      *
     O          e            l1dtl       1  2
     O                                           32 'Female Weekly Inventory '
     O                                           36 'Head'
     O                       q1fwinhd      kb    50
     O                       q2fwinhd      kb    60
     O                       q3fwinhd      kb    70
     O                       q4fwinhd      kb    80
     O                       t1fwinhd      kb    90
     O                       t1curfarms     b   198
      *
     O          e            l1dtl          2
     O                                           36 'Open Gilt Pool Eligible'
     O                       q1opglhd      kb    50
     O                       q2opglhd      kb    60
     O                       q3opglhd      kb    70
     O                       q4opglhd      kb    80
     O                       t1opglhd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Services'
     O                       q1glsv        kb    50
     O                       q2glsv        kb    60
     O                       q3glsv        kb    70
     O                       q4glsv        kb    80
     O                       t1glsv        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Total Services'
     O                       q1tosv        kb    50
     O                       q2tosv        kb    60
     O                       q3tosv        kb    70
     O                       q4tosv        kb    80
     O                       t1tosv        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Conception Rate'
     O                       q1crpr        kb    50
     O                       q2crpr        kb    60
     O                       q3crpr        kb    70
     O                       q4crpr        kb    80
     O                       t1crpr        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Preg Check Positive Head'
     O                       q1prhd        kb    50
     O                       q2prhd        kb    60
     O                       q3prhd        kb    70
     O                       q4prhd        kb    80
     O                       t1prhd        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Fallout Rate'
     O                       q1fopr        kb    50
     O                       q2fopr        kb    60
     O                       q3fopr        kb    70
     O                       q4fopr        kb    80
     O                       t1fopr        kb    90
      *
     O          e            l1dtl          2
     O                                           36 '% Aborts'
     O                       q1aborpr      kb    50
     O                       q2aborpr      kb    60
     O                       q3aborpr      kb    70
     O                       q4aborpr      kb    80
     O                       t1aborpr      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Farrow Rate'
     O                       q1frpr        kb    50
     O                       q2frpr        kb    60
     O                       q3frpr        kb    70
     O                       q4frpr        kb    80
     O                       t1frpr        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Farrowing Rate'
     O                       q1glfart      kb    50
     O                       q2glfart      kb    60
     O                       q3glfart      kb    70
     O                       q4glfart      kb    80
     O                       t1glfart      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Litters Farrowed'
     O                       q1tolt        kb    50
     O                       q2tolt        kb    60
     O                       q3tolt        kb    70
     O                       q4tolt        kb    80
     O                       t1tolt        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Litters Farrowed'
     O                       q1gllt        kb    50
     O                       q2gllt        kb    60
     O                       q3gllt        kb    70
     O                       q4gllt        kb    80
     O                       t1gllt        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Total Born per Litter'
     O                       q1lttbhd      kb    50
     O                       q2lttbhd      kb    60
     O                       q3lttbhd      kb    70
     O                       q4lttbhd      kb    80
     O                       t1lttbhd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Total Born per Litter'
     O                       q1lttbghd     kb    50
     O                       q2lttbghd     kb    60
     O                       q3lttbghd     kb    70
     O                       q4lttbghd     kb    80
     O                       t1lttbghd     kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Total Born'
     O                       q1tbhd        kb    50
     O                       q2tbhd        kb    60
     O                       q3tbhd        kb    70
     O                       q4tbhd        kb    80
     O                       t1tbhd        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Total Born'
     O                       q1tbglhd      kb    50
     O                       q2tbglhd      kb    60
     O                       q3tbglhd      kb    70
     O                       q4tbglhd      kb    80
     O                       t1tbglhd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 '% Stillborn'
     O                       q1sbpr        kb    50
     O                       q2sbpr        kb    60
     O                       q3sbpr        kb    70
     O                       q4sbpr        kb    80
     O                       t1sbpr        kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Born Alive per Litter'
     O                       q1ltbahd      kb    50
     O                       q2ltbahd      kb    60
     O                       q3ltbahd      kb    70
     O                       q4ltbahd      kb    80
     O                       t1ltbahd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Gilt Born Alive per Litter'
     O                       q1ltbaghd     kb    50
     O                       q2ltbaghd     kb    60
     O                       q3ltbaghd     kb    70
     O                       q4ltbaghd     kb    80
     O                       t1ltbaghd     kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Total Born Alive'
     O                       q1bahd        kb    50
     O                       q2bahd        kb    60
     O                       q3bahd        kb    70
     O                       q4bahd        kb    80
     O                       t1bahd        kb    90
      *
     O          e            l1dtl          2
     O                                           36 '% Pre-Wean Mortality'
     O                       q1tolspr      kb    50
     O                       q2tolspr      kb    60
     O                       q3tolspr      kb    70
     O                       q4tolspr      kb    80
     O                       t1tolspr      kb    90
      *
     O          e            l1dtl          2
     O                                           28 'Pigs Weaned per Litter '
     O                                           36 'Farrowed'
     O                       q1ltwnhd      kb    50
     O                       q2ltwnhd      kb    60
     O                       q3ltwnhd      kb    70
     O                       q4ltwnhd      kb    80
     O                       t1ltwnhd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Total Pigs Weaned'
     O                       q1townhd      kb    50
     O                       q2townhd      kb    60
     O                       q3townhd      kb    70
     O                       q4townhd      kb    80
     O                       t1townhd      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'DOA/EOA/Wean Pig Variance'
     O                       q1varpr       kb    50
     O                       q2varpr       kb    60
     O                       q3varpr       kb    70
     O                       q4varpr       kb    80
     O                       t1varpr       kb    90
      *
     O          e            l1dtl          2
     O                                           29 'Total Pigs Received at '
     O                                           36 'Nursery'
     O                       q1nurrchd     kb    50
     O                       q2nurrchd     kb    60
     O                       q3nurrchd     kb    70
     O                       q4nurrchd     kb    80
     O                       t1nurrchd     kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Breeds per Female per Year'
     O                       q1avsv        kb    50
     O                       q2avsv        kb    60
     O                       q3avsv        kb    70
     O                       q4avsv        kb    80
     O                       t1avsv        kb    90
      *
     O          e            l1dtl          2
     O                                           32 'Litters per Female per '
     O                                           36 'Year'
     O                       q1avlt        kb    50
     O                       q2avlt        kb    60
     O                       q3avlt        kb    70
     O                       q4avlt        kb    80
     O                       t1avlt        kb    90
      *
     O          e            l1dtl          2
     O                                           25 'Litters Farrowed/Mated '
     O                                           36 'Female/Year'
     O                       q1avltmt      kb    50
     O                       q2avltmt      kb    60
     O                       q3avltmt      kb    70
     O                       q4avltmt      kb    80
     O                       t1avltmt      kb    90
      *
     O          e            l1dtl          2
     O                                           28 'Pigs Weaned per Female '
     O                                           36 'per Year'
     O                       q1avwn        kb    50
     O                       q2avwn        kb    60
     O                       q3avwn        kb    70
     O                       q4avwn        kb    80
     O                       t1avwn        kb    90
      *
     O          e            l1dtl          2
     O                                           32 'Pigs Weaned/Mated Female/'
     O                                           36 'Year'
     O                       q1avwnmt      kb    50
     O                       q2avwnmt      kb    60
     O                       q3avwnmt      kb    70
     O                       q4avwnmt      kb    80
     O                       t1avwnmt      kb    90
      *
     O          e            l1dtl          2
     O                                           36 '% Female Mortality'
     O                       q1fmddpr      kb    50
     O                       q2fmddpr      kb    60
     O                       q3fmddpr      kb    70
     O                       q4fmddpr      kb    80
     O                       t1fmddpr      kb    90
      *
     O          e            l1dtl          2
     O                                           36 'Farrowing Crates'
     O                       q1crates      kb    50
     O                       q2crates      kb    60
     O                       q3crates      kb    70
     O                       q4crates      kb    80
     O                       t1crates      kb    90
      *
      *---------------------------------------------------------------------------------
      * Detail line when user is only printing the table code/descriptions--no targets
      *---------------------------------------------------------------------------------
      *
     O          e            l2dtl          1
     O                       btttbcd              5
     O                       btttbds             35
     O                       t1curfarms     b   155
      *
      *-------------------------------------------------------------
      * No data message line
      *-------------------------------------------------------------
      *
     O          e            nodata      1
     O                                           19 'NO DATA MEETS YOUR'
     O                                           38 'SELECTION CRITERIA'
