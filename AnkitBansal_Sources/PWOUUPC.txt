/*********************************************************************/
/* PROGRAM : PWOUUPC                                                 */
/* DESC    : CNV PURGE KILLDTE<2023ACL EXECUTE USER PROGRAM          */
/* DATE    : 06/24/2024                                              */
/* PROJECT : WI 568.13 DDS TO DDL EFFORTS; SR # 3014587              */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Create one time conversion process to move all Kill Date*/
/*           records that are in year 2022 & prior into library      */
/*           PRKFHST.                                                */
/*           This is required so to help speed up the deployment of  */
/*           PKCPCPP table to PROD via Implementer.                  */
/*                                                                   */
/*           ***MANUALLY SUBMIT PWOUUPC TO BATCH.                    */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY                                                          */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LIB3) TYPE(*CHAR) LEN(10)


/*-------------------------------------------------------------------*/
/* PROD OR TEST ENVIRONMENT?                                         */
/*-------------------------------------------------------------------*/
             CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)

/*-------------------------------------------------------------------*/
/* Copy PKCPCPP TO PRKFHST LIBRARY FOR EACH PLANT.                   */
/*-------------------------------------------------------------------*/
  /***********************************/
  /*ˆPROD Environment Processing     */
  /***********************************/
    /*AT THE TIME OF CPYF, PROD FILES WILL STILL BE DDS SO LEAVE CPYF AS IS */
             IF         COND(&DATA *EQ 'PRKFLIB') THEN(DO)
             CHGVAR     VAR(&LIB3) VALUE('PRKFTFP')     /* 960 */

    /* Move Inactive Records with Kill Date <= 1221231 to Backup Library */
      /* For 960 - *ADD */
             CPYF       FROMFILE(&LIB3/PKCPCPP) +
                          TOFILE(PRKFHST/PKCPCPP960) MBROPT(*ADD) +
                          FROMRCD(1) INCREL((*IF CPB7DT *LE 1221231))

    /* Now Delete the Inactive Records with Kill Date <= 1221231 */
      /* Override to Co 960 File Library JOBD for PROD */
          /* CHGLBLJOBD JOBD(PRKPRDTFP)  ***No TF JOBD for PROD! */
             RMVLIBLE   LIB(PRKFGUP) /* Remove Co 360 Library */
             MONMSG     MSGID(CPF2110 CPF2104) /* Lib Not Found */

             ADDLIBLE   LIB(PRKFTFP) /* Add Co 960 Library */
             MONMSG     MSGID(CPF2103) /* Already Exist */

             OVRDBF     FILE(PKCPCPP) TOFILE(&LIB3/PKCPCPP)
             OVRDBF     FILE(PKCPCPL3) TOFILE(&LIB3/PKCPCPL3)
             OVRDBF     FILE(PKCPCPL0) TOFILE(&LIB3/PKCPCPL0)

             CALL       PGM(PWOSXFR) PARM((' '))

             RGZPFM     FILE(&LIB3/PKCPCPP)

             DLTOVR     FILE(*ALL)

             ENDDO


 ENDPGM:     ENDPGM
