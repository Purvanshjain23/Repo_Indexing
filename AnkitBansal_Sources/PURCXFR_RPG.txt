     H/TITLE Exc TRG OMFLCPP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/01/20  Time  : 10:04:43
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUB3CPL0  IF A E           K DISK
      * UPD : Load Detail TRG           Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUB31        E DS                  EXTNAME(PUB3CPL0)
      * UPD : Load Detail TRG           Update index
      * Renamed input format fields
     D  WARMNB       E                     EXTFLD(B3RMNB)
     D  WARUNB       E                     EXTFLD(B3RUNB)
     D  WAA9TS       E                     EXTFLD(B3A9TS)
     D  WALBSC       E                     EXTFLD(B3LBSC)
     D  WALCSC       E                     EXTFLD(B3LCSC)
     D  WABQDX       E                     EXTFLD(B3BQDX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              7  0
     D  WL0002         S              5  0
     D  WL0003         S              1
     D  WL0004         S              2
     D  WL0005         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           367
      * RCD: Load Detail               Retrieval index
      * I :  Load ID
     D  P1RMNB                 1      4P 0
      * I :  Stop/Drop Sequence Number
     D  P1RUNB                 5      7P 0
      * I :  Stop/Drop
     D  P1RVNB                 8     10P 0
      * I :  Comments for Pickup
     D  P1DQTX                11     40
      * I :  Miles to next stop
     D  P1RWNB                41     43P 0
      * I :  Freight Charge
     D  P1RXNB                44     47P 2
      * I :  Ld Hdr/Ld Dtl Unused
     D  P1SQNB                48     51P 0
      * I :  Freight Misc. Charge
     D  P1T0NB                52     57P 2
      * I :  Freight Stop Charge
     D  P1T1NB                58     61P 2
      * I :  Rated Freight
     D  P1R1NB                62     67P 2
      * I :  Company Number
     D  P1AIC3                68     69P 0
      * I :  Order Number
     D  P1C4NB                70     73P 0
      * I :  Ship Status
     D  P1VCST                74     74
      * I :  Estimated Arrival Date
     D  P1KEDT                75     78P 0
      * I :  Estimated Arrival Time
     D  P1SXNB                79     82P 0
      * I :  Appointment Confirm Date
     D  P1KFDT                83     86P 0
      * I :  Appointment Confirm Time
     D  P1ACTM                87     90P 0
      * I :  Confirmation Made With
     D  P1K5TX                91    120
      * I :  Confirmation Number
     D  P1W5CD               121    130
      * I :  Actual Delivery Date
     D  P1EJDT               131    134P 0
      * I :  Actual Delivery time
     D  P1AGTM               135    138P 0
      * I :  Scheduled Delivery Date
     D  P1KJDT               139    142P 0
      * I :  Scheduled Delivery Time
     D  P1ATTM               143    146P 0
      * I :  Deadline Depart DT    HDR
     D  P1HDDT               147    150P 0
      * I :  Deadline Depart Time  HDR
     D  P1AUTM               151    154P 0
      * I :  On Yard Date
     D  P1KKDT               155    158P 0
      * I :  On Yard Time
     D  P1AVTM               159    162P 0
      * I :  MPC Number
     D  P1Z4NB               163    166P 0
      * I :  Load Dtl On Time Flag
     D  P1Y7ST               167    167
      * I :  On Time Add'l Rsn Unused
     D  P1Y2ST               168    168
      * I :  Seal Nbr 1
     D  P1WHTX               169    183
      * I :  Seal Nbr 2
     D  P1WITX               184    198
      * I :  Seal Nbr 3
     D  P1WJTX               199    213
      * I :  Seal Nbr 4
     D  P1WKTX               214    228
      * I :  Seal Nbr 5
     D  P1WLTX               229    243
      * I :  LD Carrier Appt Date
     D  P1N7DT               244    247P 0
      * I :  LD Unused Date 2
     D  P1N8DT               248    251P 0
      * I :  LD Unused Date 3
     D  P1N9DT               252    255P 0
      * I :  LD Carrier Appt Time
     D  P1B3TM               256    259P 0
      * I :  LD Unused Time 2
     D  P1B4TM               260    263P 0
      * I :  LD Unused Time 3
     D  P1B5TM               264    267P 0
      * I :  Miles Error Sts
     D  P1IASX               268    268
      * I :  LD Unused Sts 2
     D  P1IBSX               269    269
      * I :  HPB Transload Station
     D  P1ICSX               270    271
      * I :  LD Cst Svc Tracer Cmmnt
     D  P1WVTX               272    286
      * I :  LD Unused Txt 2
     D  P1WWTX               287    311
      * I :  LD Unused Txt 3
     D  P1WXTX               312    336
      * I :  EDI Status 1
     D  P1UVST               337    337
      * I :  EDI Status 2
     D  P1UWST               338    338
      * I :  EDI Status 3
     D  P1UXST               339    339
      * I :  Job Time
     D  P1AATM               340    343P 0
      * I :  User Id
     D  P1AYNA               344    353
      * I :  Job Name
     D  P1A0NA               354    363
      * I :  Job Date
     D  P1AXDT               364    367P 0
     D P2PARM          DS           367
      * RCD: Load Detail               Retrieval index
      * I :  Load ID
     D  P2RMNB                 1      4P 0
      * I :  Stop/Drop Sequence Number
     D  P2RUNB                 5      7P 0
      * I :  Stop/Drop
     D  P2RVNB                 8     10P 0
      * I :  Comments for Pickup
     D  P2DQTX                11     40
      * I :  Miles to next stop
     D  P2RWNB                41     43P 0
      * I :  Freight Charge
     D  P2RXNB                44     47P 2
      * I :  Ld Hdr/Ld Dtl Unused
     D  P2SQNB                48     51P 0
      * I :  Freight Misc. Charge
     D  P2T0NB                52     57P 2
      * I :  Freight Stop Charge
     D  P2T1NB                58     61P 2
      * I :  Rated Freight
     D  P2R1NB                62     67P 2
      * I :  Company Number
     D  P2AIC3                68     69P 0
      * I :  Order Number
     D  P2C4NB                70     73P 0
      * I :  Ship Status
     D  P2VCST                74     74
      * I :  Estimated Arrival Date
     D  P2KEDT                75     78P 0
      * I :  Estimated Arrival Time
     D  P2SXNB                79     82P 0
      * I :  Appointment Confirm Date
     D  P2KFDT                83     86P 0
      * I :  Appointment Confirm Time
     D  P2ACTM                87     90P 0
      * I :  Confirmation Made With
     D  P2K5TX                91    120
      * I :  Confirmation Number
     D  P2W5CD               121    130
      * I :  Actual Delivery Date
     D  P2EJDT               131    134P 0
      * I :  Actual Delivery time
     D  P2AGTM               135    138P 0
      * I :  Scheduled Delivery Date
     D  P2KJDT               139    142P 0
      * I :  Scheduled Delivery Time
     D  P2ATTM               143    146P 0
      * I :  Deadline Depart DT    HDR
     D  P2HDDT               147    150P 0
      * I :  Deadline Depart Time  HDR
     D  P2AUTM               151    154P 0
      * I :  On Yard Date
     D  P2KKDT               155    158P 0
      * I :  On Yard Time
     D  P2AVTM               159    162P 0
      * I :  MPC Number
     D  P2Z4NB               163    166P 0
      * I :  Load Dtl On Time Flag
     D  P2Y7ST               167    167
      * I :  On Time Add'l Rsn Unused
     D  P2Y2ST               168    168
      * I :  Seal Nbr 1
     D  P2WHTX               169    183
      * I :  Seal Nbr 2
     D  P2WITX               184    198
      * I :  Seal Nbr 3
     D  P2WJTX               199    213
      * I :  Seal Nbr 4
     D  P2WKTX               214    228
      * I :  Seal Nbr 5
     D  P2WLTX               229    243
      * I :  LD Carrier Appt Date
     D  P2N7DT               244    247P 0
      * I :  LD Unused Date 2
     D  P2N8DT               248    251P 0
      * I :  LD Unused Date 3
     D  P2N9DT               252    255P 0
      * I :  LD Carrier Appt Time
     D  P2B3TM               256    259P 0
      * I :  LD Unused Time 2
     D  P2B4TM               260    263P 0
      * I :  LD Unused Time 3
     D  P2B5TM               264    267P 0
      * I :  Miles Error Sts
     D  P2IASX               268    268
      * I :  LD Unused Sts 2
     D  P2IBSX               269    269
      * I :  HPB Transload Station
     D  P2ICSX               270    271
      * I :  LD Cst Svc Tracer Cmmnt
     D  P2WVTX               272    286
      * I :  LD Unused Txt 2
     D  P2WWTX               287    311
      * I :  LD Unused Txt 3
     D  P2WXTX               312    336
      * I :  EDI Status 1
     D  P2UVST               337    337
      * I :  EDI Status 2
     D  P2UWST               338    338
      * I :  EDI Status 3
     D  P2UXST               339    339
      * I :  Job Time
     D  P2AATM               340    343P 0
      * I :  User Id
     D  P2AYNA               344    353
      * I :  Job Name
     D  P2A0NA               354    363
      * I :  Job Date
     D  P2AXDT               364    367P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@B3CPHR
      * Load Detail TRG           Update index
      * Renamed input format fields
     I              B3RMNB                      WARMNB
     I              B3RUNB                      WARUNB
     I              B3A9TS                      WAA9TS
     I              B3LBSC                      WALBSC
     I              B3LCSC                      WALCSC
     I              B3BQDX                      WABQDX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Load Detai
     C                   PARM                    P2PARM                         RCD: Load Detai
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG OMFLCPP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Crt Load Detail TRG   CR - Load Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2RMNB        WL0001                         Load ID
     C                   Z-ADD     P2RUNB        WL0002                         Stop/Drop Seque
     C                   MOVEL(P)  P3D8SC        WL0003                         LDT TRG Databas
     C                   MOVEL(P)  '0'           WL0004                         LDT Process Sta
     C                   Z-ADD     0             WL0005                         LDT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
      * Update If Any Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48
      *   |- c1    : PR1.Stop/Drop NE PR2.Stop/Drop
      *   |- c2    : PR1.Comments for Pickup NE PR2.Comments for Pickup
      *   |- c3    : PR1.Miles to next stop NE PR2.Miles to next stop
      *   |- c4    : PR1.Freight Charge NE PR2.Freight Charge
      *   |- c5    : PR1.Ld Hdr/Ld Dtl Unused NE PR2.Ld Hdr/Ld Dtl Unused
      *   |- c6    : PR1.Freight Misc. Charge NE PR2.Freight Misc. Charge
      *   |- c7    : PR1.Freight Stop Charge NE PR2.Freight Stop Charge
      *   |- c8    : PR1.Rated Freight NE PR2.Rated Freight
      *   |- c9    : PR1.Company Number NE PR2.Company Number
      *   |- c10   : PR1.Order Number NE PR2.Order Number
      *   |- c11   : PR1.Ship Status NE PR2.Ship Status
      *   |- c12   : PR1.Estimated Arrival Date NE PR2.Estimated Arrival
      *   |- c13   : PR1.Estimated Arrival Time NE PR2.Estimated Arrival
      *   |- c14   : PR1.Appointment Confirm Date NE PR2.Appointment Conf
      *   |- c15   : PR1.Appointment Confirm Time NE PR2.Appointment Conf
      *   |- c16   : PR1.Confirmation Made With NE PR2.Confirmation Made
      *   |- c17   : PR1.Confirmation Number NE PR2.Confirmation Number
      *   |- c18   : PR1.Actual Delivery Date NE PR2.Actual Delivery Date
      *   |- c19   : PR1.Actual Delivery time NE PR2.Actual Delivery time
      *   |- c20   : PR1.Scheduled Delivery Date NE PR2.Scheduled Deliver
      *   |- c21   : PR1.Scheduled Delivery Time NE PR2.Scheduled Deliver
      *   |- c22   : PR1.Deadline Depart DT    HDR NE PR2.Deadline Depart
      *   |- c23   : PR1.Deadline Depart Time  HDR NE PR2.Deadline Depart
      *   |- c24   : PR1.On Yard Date NE PR2.On Yard Date
      *   |- c25   : PR1.On Yard Time NE PR2.On Yard Time
      *   |- c26   : PR1.MPC Number NE PR2.MPC Number
      *   |- c27   : PR1.Load Dtl On Time Flag NE PR2.Load Dtl On Time Fl
      *   |- c28   : PR1.On Time Add'l Rsn Unused NE PR2.On Time Add'l Rs
      *   |- c29   : PR1.Seal Nbr 1 NE PR2.Seal Nbr 1
      *   |- c30   : PR1.Seal Nbr 2 NE PR2.Seal Nbr 2
      *   |- c31   : PR1.Seal Nbr 3 NE PR2.Seal Nbr 3
      *   |- c32   : PR1.Seal Nbr 4 NE PR2.Seal Nbr 4
      *   |- c33   : PR1.Seal Nbr 5 NE PR2.Seal Nbr 5
      *   |- c34   : PR1.LD Carrier Appt Date NE PR2.LD Carrier Appt Date
      *   |- c35   : PR1.LD Unused Date 2 NE PR2.LD Unused Date 2
      *   |- c36   : PR1.LD Unused Date 3 NE PR2.LD Unused Date 3
      *   |- c37   : PR1.LD Carrier Appt Time NE PR2.LD Carrier Appt Time
      *   |- c38   : PR1.LD Unused Time 2 NE PR2.LD Unused Time 2
      *   |- c39   : PR1.LD Unused Time 3 NE PR2.LD Unused Time 3
      *   |- c40   : PR1.Miles Error Sts NE PR2.Miles Error Sts
      *   |- c41   : PR1.LD Unused Sts 2 NE PR2.LD Unused Sts 2
      *   |- c42   : PR1.HPB Transload Station NE PR2.HPB Transload Stati
      *   |- c43   : PR1.LD Cst Svc Tracer Cmmnt NE PR2.LD Cst Svc Tracer
      *   |- c44   : PR1.LD Unused Txt 2 NE PR2.LD Unused Txt 2
      *   |- c45   : PR1.LD Unused Txt 3 NE PR2.LD Unused Txt 3
      *   |- c46   : PR1.EDI Status 1 NE PR2.EDI Status 1
      *   |- c47   : PR1.EDI Status 2 NE PR2.EDI Status 2
      *   |- c48   : PR1.EDI Status 3 NE PR2.EDI Status 3
      *   '-
     C                   IF        P3D8SC = '3'
      * Crt Load Detail TRG   CR - Load Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P1RVNB <> P2RVNB OR
     C                             P1DQTX <> P2DQTX OR
     C                             P1RWNB <> P2RWNB OR
     C                             P1RXNB <> P2RXNB OR
     C                             P1SQNB <> P2SQNB OR
     C                             P1T0NB <> P2T0NB OR
     C                             P1T1NB <> P2T1NB OR
     C                             P1R1NB <> P2R1NB OR
     C                             P1AIC3 <> P2AIC3 OR
     C                             P1C4NB <> P2C4NB OR
     C                             P1VCST <> P2VCST OR
     C                             P1KEDT <> P2KEDT OR
     C                             P1SXNB <> P2SXNB OR
     C                             P1KFDT <> P2KFDT OR
     C                             P1ACTM <> P2ACTM OR
     C                             P1K5TX <> P2K5TX OR
     C                             P1W5CD <> P2W5CD OR
     C                             P1EJDT <> P2EJDT OR
     C                             P1AGTM <> P2AGTM OR
     C                             P1KJDT <> P2KJDT OR
     C                             P1ATTM <> P2ATTM OR
     C                             P1HDDT <> P2HDDT OR
     C                             P1AUTM <> P2AUTM OR
     C                             P1KKDT <> P2KKDT OR
     C                             P1AVTM <> P2AVTM OR
     C                             P1Z4NB <> P2Z4NB OR
     C                             P1Y7ST <> P2Y7ST OR
     C                             P1Y2ST <> P2Y2ST OR
     C                             P1WHTX <> P2WHTX OR
     C                             P1WITX <> P2WITX OR
     C                             P1WJTX <> P2WJTX OR
     C                             P1WKTX <> P2WKTX OR
     C                             P1WLTX <> P2WLTX OR
     C                             P1N7DT <> P2N7DT OR
     C                             P1N8DT <> P2N8DT OR
     C                             P1N9DT <> P2N9DT OR
     C                             P1B3TM <> P2B3TM OR
     C                             P1B4TM <> P2B4TM OR
     C                             P1B5TM <> P2B5TM OR
     C                             P1IASX <> P2IASX OR
     C                             P1IBSX <> P2IBSX OR
     C                             P1ICSX <> P2ICSX OR
     C                             P1WVTX <> P2WVTX OR
     C                             P1WWTX <> P2WWTX OR
     C                             P1WXTX <> P2WXTX OR
     C                             P1UVST <> P2UVST OR
     C                             P1UWST <> P2UWST OR
     C                             P1UXST <> P2UXST
     C                   Z-ADD     P2RMNB        WL0001                         Load ID
     C                   Z-ADD     P2RUNB        WL0002                         Stop/Drop Seque
     C                   MOVEL(P)  P3D8SC        WL0003                         LDT TRG Databas
     C                   MOVEL(P)  '0'           WL0004                         LDT Process Sta
     C                   Z-ADD     0             WL0005                         LDT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Crt Load Detail TRG   CR - Load Detail TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1RMNB        WL0001                         Load ID
     C                   Z-ADD     P1RUNB        WL0002                         Stop/Drop Seque
     C                   MOVEL(P)  P3D8SC        WL0003                         LDT TRG Databas
     C                   MOVEL(P)  '0'           WL0004                         LDT Process Sta
     C                   Z-ADD     0             WL0005                         LDT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt Load Detail TRG   CR - Load Detail TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         LDT Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B3CPHR
     C                   Z-ADD     WL0001        WARMNB                         Load ID
     C                   Z-ADD     WL0002        WARUNB                         Stop/Drop Seque
     C                   MOVEL     WL0003        WALBSC                         LDT TRG Databas
     C                   MOVEL     WL0004        WALCSC                         LDT Process Sta
     C                   Z-ADD     WL0005        WABQDX                         LDT Process Dat
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WAA9TS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WARMNB                         Load ID
     C                   KFLD                    WARUNB                         Stop/Drop Seque
     C                   KFLD                    WAA9TS                         LDT Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @B3CPHR                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5193'     W0RTN
      * Send message 'Load Detail TRG        EX'
     C                   MOVEL     'USR5193'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @B3CPHR                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WARUNB                         Stop/Drop Seque
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAA9TS                         LDT Timestamp
     C                   Z-ADD     *ZERO         WABQDX                         LDT Process Dat
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   Z-ADD     *ZERO         WL0005
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
