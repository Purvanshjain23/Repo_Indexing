     H/TITLE PMT Transfer Trans    PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 07/29/21  Time  : 09:42:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPLJPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PMT Transfer Trans    PV  Prompt & validate record
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FARBECPL1IF  E           K        DISK
      * RTV : A/R Detail                Retrieval index       V
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FPPA4CPL1IF  E           K        DISK
      * RTV : A/R Header OA             Retrieval index
      *
     FCABBRELBIF  E           K        DISK
      * RSQ : Customer                  RSQ Bill to (A/R) Active
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FCAECREL1IF  E           K        DISK
      * RTV : County Master             Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FARBECPL0IF  E           K        DISK                      A
      * UPD : A/R Detail                Update index
      *
     FARBDCPL0UF  E           K        DISK                      A
      * UPD : A/R Header                Update index
      *
     FPPA4CPL0UF  E           K        DISK                      A
      * UPD : A/R Header OA             Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WBAIC3
     I              ABADTX                          WBADTX
     I              ABACNA                          WBACNA
     I              ABADNA                          WBADNA
     I              ABAENA                          WBAENA
     I              ABAJNA                          WBAJNA
     I              ABBTTX                          WBBTTX
     I              ABBVTX                          WBBVTX
     I              ABBWTX                          WBBWTX
     I              ABA2NA                          WBA2NA
     I              ABABTX                          WBABTX
     I              ABBGCD                          WBBGCD
     I              ABKXCD                          WBKXCD
     I              ABUVST                          WBUVST
     I              ABUWST                          WBUWST
     I              ABUXST                          WBUXST
     I              ABVSST                          WBVSST
     I              ABAATM                          WBAATM
     I              ABAYNA                          WBAYNA
     I              ABA0NA                          WBA0NA
     I              ABAXDT                          WBAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WCBKC7
     I              NEUFTX                          WCUFTX
     I              NEUGTX                          WCUGTX
     I              NEPFNA                          WCPFNA
     I              NEJ5NX                          WCJ5NX
     I              NEU5TX                          WCU5TX
     I              NEU6TX                          WCU6TX
     I              NEW0TX                          WCW0TX
     I              NEHSSX                          WCHSSX
     I              NEHUSX                          WCHUSX
     I              NEHVSX                          WCHVSX
     I              NEAAC8                          WCAAC8
     I              NEP0SX                          WCP0SX
     I              NEP1SX                          WCP1SX
     I              NEP2SX                          WCP2SX
     I              NEP3SX                          WCP3SX
     I              NEP4SX                          WCP4SX
     I              NEP5SX                          WCP5SX
     I              NEP6SX                          WCP6SX
     I              NEUVST                          WCUVST
     I              NEUWST                          WCUWST
     I              NEUXST                          WCUXST
     I              NEVSST                          WCVSST
     I              NEAATM                          WCAATM
     I              NEAYNA                          WCAYNA
     I              NEA0NA                          WCA0NA
     I              NEAXDT                          WCAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@BFCPFO
      * A/R Detail                Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WEAIC3
     I              BFCONB                          WECONB
     I              BFCEST                          WECEST
     I              BFDXNB                          WEDXNB
     I              BFUHCD                          WEUHCD
     I              BFBSVA                          WEBSVA
     I              BFCPTX                          WECPTX
     I              BFNGNA                          WENGNA
     I              BFB4DT                          WEB4DT
     I              BFDVDT                          WEDVDT
     I              BFYXNX                          WEYXNX
     I              BFHYDT                          WEHYDT
     I              BFG4CD                          WEG4CD
     I              BFCKNB                          WECKNB
     I              BFA5ST                          WEA5ST
     I              BFAJST                          WEAJST
     I              BFB1VN                          WEB1VN
     I              BFEAZT                          WEEAZT
     I              BFC1NY                          WEC1NY
     I              BFIZTX                          WEIZTX
     I              BFETSX                          WEETSX
     I              BFW3SX                          WEW3SX
     I              BFW4SX                          WEW4SX
     I              BFW5SX                          WEW5SX
     I              BFW6SX                          WEW6SX
     I              BFW7SX                          WEW7SX
     I              BFW8SX                          WEW8SX
     I              BFQHDT                          WEQHDT
     I              BFQIDT                          WEQIDT
     I              BFQJDT                          WEQJDT
     I              BFQKDT                          WEQKDT
     I              BFQLDT                          WEQLDT
     I              BFGLVL                          WEGLVL
     I              BFGMVL                          WEGMVL
     I              BFGNVL                          WEGNVL
     I              BFGOVL                          WEGOVL
     I              BFGPVL                          WEGPVL
     I              BFUVST                          WEUVST
     I              BFUWST                          WEUWST
     I              BFUXST                          WEUXST
     I              BFAATM                          WEAATM
     I              BFAYNA                          WEAYNA
     I              BFA0NA                          WEA0NA
     I              BFAXDT                          WEAXDT
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WFAIC3
     I              BFCONB                          WFCONB
     I              BFCEST                          WFCEST
     I              BFDXNB                          WFDXNB
     I              BFUHCD                          WFUHCD
     I              BFBSVA                          WFBSVA
     I              BFCPTX                          WFCPTX
     I              BFNGNA                          WFNGNA
     I              BFB4DT                          WFB4DT
     I              BFDVDT                          WFDVDT
     I              BFYXNX                          WFYXNX
     I              BFHYDT                          WFHYDT
     I              BFG4CD                          WFG4CD
     I              BFCKNB                          WFCKNB
     I              BFA5ST                          WFA5ST
     I              BFAJST                          WFAJST
     I              BFB1VN                          WFB1VN
     I              BFEAZT                          WFEAZT
     I              BFC1NY                          WFC1NY
     I              BFIZTX                          WFIZTX
     I              BFETSX                          WFETSX
     I              BFW3SX                          WFW3SX
     I              BFW4SX                          WFW4SX
     I              BFW5SX                          WFW5SX
     I              BFW6SX                          WFW6SX
     I              BFW7SX                          WFW7SX
     I              BFW8SX                          WFW8SX
     I              BFQHDT                          WFQHDT
     I              BFQIDT                          WFQIDT
     I              BFQJDT                          WFQJDT
     I              BFQKDT                          WFQKDT
     I              BFQLDT                          WFQLDT
     I              BFGLVL                          WFGLVL
     I              BFGMVL                          WFGMVL
     I              BFGNVL                          WFGNVL
     I              BFGOVL                          WFGOVL
     I              BFGPVL                          WFGPVL
     I              BFUVST                          WFUVST
     I              BFUWST                          WFUWST
     I              BFUXST                          WFUXST
     I              BFAATM                          WFAATM
     I              BFAYNA                          WFAYNA
     I              BFA0NA                          WFA0NA
     I              BFAXDT                          WFAXDT
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WGAIC3
     I              BDCONB                          WGCONB
     I              BDCEST                          WGCEST
     I              BDUHCD                          WGUHCD
     I              BDBSVA                          WGBSVA
     I              BDAIVA                          WGAIVA
     I              BDAOVA                          WGAOVA
     I              BDBGVA                          WGBGVA
     I              BDAJST                          WGAJST
     I              BDE3ST                          WGE3ST
     I              BDG4CD                          WGG4CD
     I              BDCKNB                          WGCKNB
     I              BDCAC7                          WGCAC7
     I              BDBKC7                          WGBKC7
     I              BDBCCD                          WGBCCD
     I              BDR4CD                          WGR4CD
     I              BDB4DT                          WGB4DT
     I              BDATDT                          WGATDT
     I              BDH0DT                          WGH0DT
     I              BDH3DT                          WGH3DT
     I              BDH4DT                          WGH4DT
     I              BDH5DT                          WGH5DT
     I              BDANC7                          WGANC7
     I              BDCPTX                          WGCPTX
     I              BDBSDY                          WGBSDY
     I              BDUVST                          WGUVST
     I              BDUWST                          WGUWST
     I              BDUXST                          WGUXST
     I              BDAATM                          WGAATM
     I              BDAYNA                          WGAYNA
     I              BDA0NA                          WGA0NA
     I              BDAXDT                          WGAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WHAIC3
     I              BDCONB                          WHCONB
     I              BDCEST                          WHCEST
     I              BDUHCD                          WHUHCD
     I              BDBSVA                          WHBSVA
     I              BDAIVA                          WHAIVA
     I              BDAOVA                          WHAOVA
     I              BDBGVA                          WHBGVA
     I              BDAJST                          WHAJST
     I              BDE3ST                          WHE3ST
     I              BDG4CD                          WHG4CD
     I              BDCKNB                          WHCKNB
     I              BDCAC7                          WHCAC7
     I              BDBKC7                          WHBKC7
     I              BDBCCD                          WHBCCD
     I              BDR4CD                          WHR4CD
     I              BDB4DT                          WHB4DT
     I              BDATDT                          WHATDT
     I              BDH0DT                          WHH0DT
     I              BDH3DT                          WHH3DT
     I              BDH4DT                          WHH4DT
     I              BDH5DT                          WHH5DT
     I              BDANC7                          WHANC7
     I              BDCPTX                          WHCPTX
     I              BDBSDY                          WHBSDY
     I              BDUVST                          WHUVST
     I              BDUWST                          WHUWST
     I              BDUXST                          WHUXST
     I              BDAATM                          WHAATM
     I              BDAYNA                          WHAYNA
     I              BDA0NA                          WHA0NA
     I              BDAXDT                          WHAXDT
      *
     I@A4CPX7
      * A/R Header OA             Retrieval index
      * Renamed input format fields
     I              A4AIC3                          WIAIC3
     I              A4CONB                          WICONB
     I              A4CEST                          WICEST
     I              A4G4CD                          WIG4CD
     I              A4HXDT                          WIHXDT
     I              A4YXNX                          WIYXNX
     I              A4UTSX                          WIUTSX
      *
     I@A4CPX6
      * A/R Header OA             Update index
      * Renamed input format fields
     I              A4AIC3                          WJAIC3
     I              A4CONB                          WJCONB
     I              A4CEST                          WJCEST
     I              A4G4CD                          WJG4CD
     I              A4HXDT                          WJHXDT
     I              A4YXNX                          WJYXNX
     I              A4UTSX                          WJUTSX
      *
     I@BBREXJ
      * Customer                  RSQ Bill to (A/R) Active
      * Renamed input format fields
     I              BBBKC7                          WKBKC7
     I              BBAYTX                          WKAYTX
     I              BBACNA                          WKACNA
     I              BBADNA                          WKADNA
     I              BBAENA                          WKAENA
     I              BBAJNA                          WKAJNA
     I              BBBGCD                          WKBGCD
     I              BBG5CD                          WKG5CD
     I              BBBTTX                          WKBTTX
     I              BBBVTX                          WKBVTX
     I              BBBWTX                          WKBWTX
     I              BBABTX                          WKABTX
     I              BBA2NA                          WKA2NA
     I              BBCBST                          WKCBST
     I              BBB0NA                          WKB0NA
     I              BBP3NB                          WKP3NB
     I              BBAXNA                          WKAXNA
     I              BBI6DT                          WKI6DT
     I              BBAYDT                          WKAYDT
     I              BBANC7                          WKANC7
     I              BBBTC7                          WKBTC7
     I              BBK6ST                          WKK6ST
     I              BBUZST                          WKUZST
     I              BBKXCD                          WKKXCD
     I              BBLTCD                          WKLTCD
     I              BBQNST                          WKQNST
     I              BBS2NB                          WKS2NB
     I              BBVHVA                          WKVHVA
     I              BBI7DT                          WKI7DT
     I              BBRJST                          WKRJST
     I              BBRKST                          WKRKST
     I              BBQWST                          WKQWST
     I              BBQXST                          WKQXST
     I              BBQYST                          WKQYST
     I              BBUNCS                          WKUNCS
     I              BBUVST                          WKUVST
     I              BBUWST                          WKUWST
     I              BBUXST                          WKUXST
     I              BBVSST                          WKVSST
     I              BBAATM                          WKAATM
     I              BBAYNA                          WKAYNA
     I              BBA0NA                          WKA0NA
     I              BBAXDT                          WKAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WLAIC3
     I              JYZ9ST                          WLZ9ST
     I              JYCSST                          WLCSST
     I              JYZ8ST                          WLZ8ST
     I              JYCXST                          WLCXST
     I              JYSWST                          WLSWST
     I              JYXXTM                          WLXXTM
     I              JYUECD                          WLUECD
     I              JYHSST                          WLHSST
     I              JYAMEO                          WLAMEO
     I              JYSSDF                          WLSSDF
     I              JYPDFT                          WLPDFT
     I              JYYISX                          WLYISX
     I              JYYJSX                          WLYJSX
     I              JYYKSX                          WLYKSX
     I              JYYLSX                          WLYLSX
     I              JYYMSX                          WLYMSX
     I              JYYNSX                          WLYNSX
     I              JYUVST                          WLUVST
     I              JYUWST                          WLUWST
     I              JYUXST                          WLUXST
     I              JYVSST                          WLVSST
     I              JYAATM                          WLAATM
     I              JYAYNA                          WLAYNA
     I              JYA0NA                          WLA0NA
     I              JYAXDT                          WLAXDT
      *
     I@ACREAH
      * State                     Retrieval index       NV
      * Renamed input format fields
     I              ACBGCD                          WMBGCD
     I              ACAUNA                          WMAUNA
     I              ACUVST                          WMUVST
     I              ACUWST                          WMUWST
     I              ACUXST                          WMUXST
     I              ACVSST                          WMVSST
     I              ACAATM                          WMAATM
     I              ACAYNA                          WMAYNA
     I              ACA0NA                          WMA0NA
     I              ACAXDT                          WMAXDT
      *
     I@ECREVS
      * County Master             Retrieval index       NV
      * Renamed input format fields
     I              ECBGCD                          WOBGCD
     I              ECG5CD                          WOG5CD
     I              ECAUNA                          WOAUNA
     I              ECUVST                          WOUVST
     I              ECUWST                          WOUWST
     I              ECUXST                          WOUXST
     I              ECVSST                          WOVSST
     I              ECAATM                          WOAATM
     I              ECAYNA                          WOAYNA
     I              ECA0NA                          WOA0NA
     I              ECAXDT                          WOAXDT
      *
     I@E5REB8
      * Country                   Retrieval index
      * Renamed input format fields
     I              E5KXCD                          WRKXCD
     I              E5DATX                          WRDATX
     I              E5UVST                          WRUVST
     I              E5UWST                          WRUWST
     I              E5UXST                          WRUXST
     I              E5VSST                          WRVSST
     I              E5AATM                          WRAATM
     I              E5AYNA                          WRAYNA
     I              E5A0NA                          WRA0NA
     I              E5AXDT                          WRAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WSAJVN
     I              DRAUNA                          WSAUNA
     I              DRB8NA                          WSB8NA
     I              DRAHVN                          WSAHVN
     I              DRI6ST                          WSI6ST
     I              DRI7ST                          WSI7ST
     I              DRXMST                          WSXMST
     I              DRXNST                          WSXNST
     I              DRI8ST                          WSI8ST
     I              DRNLNB                          WSNLNB
     I              DRMPNA                          WSMPNA
     I              DRBCCD                          WSBCCD
     I              DRAIC3                          WSAIC3
     I              DRDQCD                          WSDQCD
     I              DRDRCD                          WSDRCD
     I              DRAJCD                          WSAJCD
     I              DRBUVN                          WSBUVN
     I              DRUVST                          WSUVST
     I              DRUWST                          WSUWST
     I              DRUXST                          WSUXST
     I              DRAATM                          WSAATM
     I              DRAYNA                          WSAYNA
     I              DRA0NA                          WSA0NA
     I              DRAXDT                          WSAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WTAJVN
     I              DTDNCD                          WTDNCD
     I              DTAIC3                          WTAIC3
     I              DTDQCD                          WTDQCD
     I              DTDRCD                          WTDRCD
     I              DTAJCD                          WTAJCD
     I              DTJFST                          WTJFST
     I              DTUVST                          WTUVST
     I              DTUWST                          WTUWST
     I              DTUXST                          WTUXST
     I              DTAATM                          WTAATM
     I              DTAYNA                          WTAYNA
     I              DTA0NA                          WTA0NA
     I              DTAXDT                          WTAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WVDNCD
     I              DNAUNA                          WVAUNA
     I              DNVKST                          WVVKST
     I              DNRSCD                          WVRSCD
     I              DNUVST                          WVUVST
     I              DNUWST                          WVUWST
     I              DNUXST                          WVUXST
     I              DNAATM                          WVAATM
     I              DNAYNA                          WVAYNA
     I              DNA0NA                          WVA0NA
     I              DNAXDT                          WVAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQARBE1    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WFAIC3
     I              BFCONB                          WFCONB
     I              BFCEST                          WFCEST
     I              BFDXNB                          WFDXNB
     I              BFUHCD                          WFUHCD
     I              BFBSVA                          WFBSVA
     I              BFCPTX                          WFCPTX
     I              BFNGNA                          WFNGNA
     I              BFB4DT                          WFB4DT
     I              BFDVDT                          WFDVDT
     I              BFYXNX                          WFYXNX
     I              BFHYDT                          WFHYDT
     I              BFG4CD                          WFG4CD
     I              BFCKNB                          WFCKNB
     I              BFA5ST                          WFA5ST
     I              BFAJST                          WFAJST
     I              BFB1VN                          WFB1VN
     I              BFEAZT                          WFEAZT
     I              BFC1NY                          WFC1NY
     I              BFIZTX                          WFIZTX
     I              BFETSX                          WFETSX
     I              BFW3SX                          WFW3SX
     I              BFW4SX                          WFW4SX
     I              BFW5SX                          WFW5SX
     I              BFW6SX                          WFW6SX
     I              BFW7SX                          WFW7SX
     I              BFW8SX                          WFW8SX
     I              BFQHDT                          WFQHDT
     I              BFQIDT                          WFQIDT
     I              BFQJDT                          WFQJDT
     I              BFQKDT                          WFQKDT
     I              BFQLDT                          WFQLDT
     I              BFGLVL                          WFGLVL
     I              BFGMVL                          WFGMVL
     I              BFGNVL                          WFGNVL
     I              BFGOVL                          WFGOVL
     I              BFGPVL                          WFGPVL
     I              BFUVST                          WFUVST
     I              BFUWST                          WFUWST
     I              BFUXST                          WFUXST
     I              BFAATM                          WFAATM
     I              BFAYNA                          WFAYNA
     I              BFA0NA                          WFA0NA
     I              BFAXDT                          WFAXDT
      *
     IQARBD1    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WHAIC3
     I              BDCONB                          WHCONB
     I              BDCEST                          WHCEST
     I              BDUHCD                          WHUHCD
     I              BDBSVA                          WHBSVA
     I              BDAIVA                          WHAIVA
     I              BDAOVA                          WHAOVA
     I              BDBGVA                          WHBGVA
     I              BDAJST                          WHAJST
     I              BDE3ST                          WHE3ST
     I              BDG4CD                          WHG4CD
     I              BDCKNB                          WHCKNB
     I              BDCAC7                          WHCAC7
     I              BDBKC7                          WHBKC7
     I              BDBCCD                          WHBCCD
     I              BDR4CD                          WHR4CD
     I              BDB4DT                          WHB4DT
     I              BDATDT                          WHATDT
     I              BDH0DT                          WHH0DT
     I              BDH3DT                          WHH3DT
     I              BDH4DT                          WHH4DT
     I              BDH5DT                          WHH5DT
     I              BDANC7                          WHANC7
     I              BDCPTX                          WHCPTX
     I              BDBSDY                          WHBSDY
     I              BDUVST                          WHUVST
     I              BDUWST                          WHUWST
     I              BDUXST                          WHUXST
     I              BDAATM                          WHAATM
     I              BDAYNA                          WHAYNA
     I              BDA0NA                          WHA0NA
     I              BDAXDT                          WHAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPA41    E DSPPA4CPL0
      * UPD : A/R Header OA             Update index
      * Renamed input format fields
     I              A4AIC3                          WJAIC3
     I              A4CONB                          WJCONB
     I              A4CEST                          WJCEST
     I              A4G4CD                          WJG4CD
     I              A4HXDT                          WJHXDT
     I              A4YXNX                          WJYXNX
     I              A4UTSX                          WJUTSX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Header
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP Invoice Number
     I                                    P   3   60P1CONB
      * I : MAP Invoice Suffix
     I                                        7   8 P1CEST
      * I : MAP Transaction Amount
     I                                    P   9  142P1BSVA
      * I :  A/R Customer Number
     I                                    P  15  180P1ANC7
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'A/R Customer invalid'
      * A/R Customer Number
     I                                        1   7 ZA0001
      * Message data for 'Invalid Company Number'
      * Company Number
     I                                        1   3 ZA0002
      * Message data for 'Invalid Company Number'
      * Company Number
     I                                        1   3 ZA0003
      * Message data for 'Customer TF Exempt Error'
      * A/R Customer Number
     I                                        1   7 ZA0004
      * Message data for 'Customer TF Exempt Error'
      * A/R Customer Number
     I                                        1   7 ZA0005
      * Message data for 'Invalid Company Number'
      * Company Number
     I                                        1   3 ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0009
      * Application Code
     I                                       11  16 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1CONB    PARM           WP0002  70       Invoice Number
     C           P1CEST    PARM           WP0003  2        Invoice Suffix
     C           P1BSVA    PARM           WP0004 112       Transaction Amo
     C           P1ANC7    PARM           WP0005  70       A/R Customer Nu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * RTV Cust Name/Addr/Ph  RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0001           Ship To Custome
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #1AYTX    P      Customer Name
     C                     MOVELWL0003    #1ACNA    P      Address Line 1
     C                     MOVELWL0004    #1ADNA    P      Address Line 2
     C                     MOVELWL0005    #1AENA    P      Address Line 3
     C                     MOVELWL0006    #1AJNA    P      City
     C                     MOVELWL0007    #1BGCD    P      State Code
     C                     MOVELWL0008    #1BTTX    P      Zip/Postal Code
     C                     MOVELWL0009    #1BVTX    P      Telephone Numbe
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#PAIC3    WL0010           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #DADTX    P      Name
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * slm 04/09/2008 ONLY allow Intr Company if org is Seaboard
      * Inter Company transaction
      * Daily nor High Plans will not perform this at this time.
     C                     Z-ADDP1AIC3    YL0001           Company Number
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0001  30       Company Number
     C                     PARM *BLANK    WQ0002  2        Shipping Method
     C                     PARM *BLANK    WQ0003  1        Load Type Dft
     C                     PARM *BLANK    WQ0004  1        LTL Flag Dft
     C                     PARM *BLANK    WQ0005  1        Export Status D
     C                     PARM *BLANK    WQ0006  1        Shrink Wrap Dft
     C                     PARM *ZERO     WQ0007  40       Departure Time
     C                     PARM *BLANK    WQ0008  6        Export Code Dft
     C                     PARM *BLANK    WQ0009  1        Allow Mult Whse
     C                     PARM *BLANK    WQ0010  1        Allow Multi Exp
     C                     PARM *BLANK    WQ0011  1        Slip Sheet Dft
     C                     PARM *BLANK    WQ0012  1        Palletize Dft
     C           YL0002    PARM *BLANK    WQ0013  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Do this for company change only.
      *   A customer chg within company has a net 0 affect on the G/L
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Company Number NE DTL.Company Number     041405
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFNE #DBQC3                     *IF
     C           YL0002    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ***************************************************
      * ****  Create Trans for Old company/customer    ****
      * slm 04/09/2008
      * use function that brings back ne if not valid
      * Rtv Customer ExemptFN/NE - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0012           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WUW3SX    P      Customer TF Exe
     C                     MOVELWUW3SX    YL0003           A/R TF Exempt C
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0014           Company Number
     C                     Z-ADDP1ANC7    WL0015           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WUISTX    P      G/L Code
      * If Co/Customer does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    WUISTX           G/L Code
     C                     MOVEL'*blanks' WUISTX           G/L Code
     C                     END                             *FI
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0014  30       Company Number
     C                     PARM WUISTX    WQ0015  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0016 25        G/L Code Desc U
     C           WUIZTX    PARM *BLANK    WQ0017  8        G/L Account Id
     C                     PARM WUAT1U    WQ0018  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0019  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0020  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WUIZTX    WQ0021  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0022 12        Cost Center. .
     C                     PARM *BLANK    WQ0023  6        Object Account
     C                     PARM *BLANK    WQ0024  8        Subsidiary . .
     C                     PARM *BLANK    WQ0025 30        Description
     C           WUC1NY    PARM *ZERO     WQ0026  30       G/L Posting Com
     C                     PARM *BLANK    WQ0027  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0028  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDP1CONB    WL0018           Invoice Number
     C                     MOVELP1CEST    WL0019    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0020           Sequence Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUDXNB           Sequence Number
      * Inter company
      * #1
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1CONB    WL0022           Invoice Number
     C                     MOVELP1CEST    WL0023    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0024           Sequence Number
     C                     MOVEL'ITC'     WL0025    P      Adjustment Type
     C                     Z-ADD#PBSVA    WL0026           Transaction Amo
     C                     MOVEL*BLANK    WL0027           A/R Check Numbe
     C                     MOVEL@CN,002   WL0028    P      Explanation
     C                     Z-ADD##JDT     WL0029           Transaction Dat
     C                     Z-ADD##JDT     WL0030           Payment/Deposit
     C                     Z-ADD*ZERO     WL0031           Deposit Time
     C                     Z-ADD*ZERO     WL0032           G/L Post Date
     C                     MOVEL*BLANK    WL0033           Bank Code
     C                     Z-ADD*ZERO     WL0034           G/L Document Nu
     C                     MOVEL'ADJ'     WL0035    P      Cash/Adj
     C                     MOVEL'E'       WL0036    P      A/R Processing
     C                     MOVEL##PGM     WL0037    P      Originating Pro
     C                     MOVEL*BLANK    WL0038           Effect on Accou
     C                     Z-ADDWUC1NY    WL0039           G/L Posting Com
     C                     MOVELWUIZTX    WL0040    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0041    P      Post Adjustment
     C                     MOVELYL0003    WL0042    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0043           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0044           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0045           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0046           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0049           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0051           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0052           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0053           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0054           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0055           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0056           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0057           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0058    P      EDI Status 1
     C                     MOVELWUUWST    WL0059    P      EDI Status 2
     C                     MOVELWUUXST    WL0060    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0061           Job Time
     C                     MOVEL*BLANK    WL0062           User Id
     C                     MOVEL*BLANK    WL0063           Job Name
     C                     Z-ADD*ZERO     WL0064           Job Date
     C                     EXSR SFCRRC
      *        Create Reversing entry for CM A/R account
     C           *ZERO     SUB  #PBSVA    WUBSVA           Transaction Amo
      * RMC SDN440 7/28/21 change 362 to 320
      * If 360 chg to 960:  Credit 320.3830.101     -> actually OFFAR320
      * If 960 chg to 360:  Credit 960.1830.101     -> Actually OFFAR960
      * If 360 chg to 440:  Credit 320.3830.101 ->    new 440-> OFFAR440
      * CASE: DTL.Company Number is Guymon
     C           #PAIC3    IFEQ 360                        *IF
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 320       WQ0029  30       Company Number
     C                     PARM 'OFFAR320'WQ0030  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0031  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: DTL.Company Number is St. Joseph
     C           #PAIC3    IFEQ 960                        *IF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PAIC3    WQ0032  30       Company Number
     C                     PARM 'OFFAR960'WQ0033  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0034  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: DTL.Company Number is Seaboard Triumph Foods
     C           #PAIC3    IFEQ 440                        *IF
     C                     Z-ADD440       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PAIC3    WQ0035  30       Company Number
     C                     PARM 'OFFAR440'WQ0036  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0037  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDP1CONB    WL0018           Invoice Number
     C                     MOVELP1CEST    WL0019    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0020           Sequence Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUDXNB           Sequence Number
      * Inter company
      * #2
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1CONB    WL0022           Invoice Number
     C                     MOVELP1CEST    WL0023    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0024           Sequence Number
     C                     MOVEL'ITC'     WL0025    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0026           Transaction Amo
     C                     MOVEL*BLANK    WL0027           A/R Check Numbe
     C                     MOVEL@CN,003   WL0028    P      Explanation
     C                     Z-ADD##JDT     WL0029           Transaction Dat
     C                     Z-ADD##JDT     WL0030           Payment/Deposit
     C                     Z-ADD*ZERO     WL0031           Deposit Time
     C                     Z-ADD*ZERO     WL0032           G/L Post Date
     C                     MOVEL*BLANK    WL0033           Bank Code
     C                     Z-ADD*ZERO     WL0034           G/L Document Nu
     C                     MOVEL'ADJ'     WL0035    P      Cash/Adj
     C                     MOVEL'E'       WL0036    P      A/R Processing
     C                     MOVEL##PGM     WL0037    P      Originating Pro
     C                     MOVEL*BLANK    WL0038           Effect on Accou
     C                     Z-ADDWUC1NY    WL0039           G/L Posting Com
     C                     MOVELWUIZTX    WL0040    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0041    P      Post Adjustment
     C                     MOVELYL0003    WL0042    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0043           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0044           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0045           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0046           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0049           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0051           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0052           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0053           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0054           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0055           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0056           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0057           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0058    P      EDI Status 1
     C                     MOVELWUUWST    WL0059    P      EDI Status 2
     C                     MOVELWUUXST    WL0060    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0061           Job Time
     C                     MOVEL*BLANK    WL0062           User Id
     C                     MOVEL*BLANK    WL0063           Job Name
     C                     Z-ADD*ZERO     WL0064           Job Date
     C                     EXSR SFCRRC
      * ***************************************************
      * ***************************************************
      * ****  Create Trans for New company/customer    ****
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * use function that brings back ne if not valid
      * Rtv Customer ExemptFN/NE - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0012           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WUW3SX    P      Customer TF Exe
     C                     MOVELWUW3SX    YL0003           A/R TF Exempt C
      * If 360 chg to 960:  Debit  320.3830.101  Actually 960.OFFAR320
      * If 960 chg to 360:  Debit  960.1830.101  Actually 960.OFFAR960
      * If 360 chg to 440:  Debit  320.3830.101     NEW:  440.OFFAR440
      * CASE: DTL.Company Number     041405 is Guymon
     C           #DBQC3    IFEQ 360                        *IF
     C                     Z-ADD320       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 320       WQ0038  30       Company Number
     C                     PARM 'OFFAR320'WQ0039  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0040  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: DTL.Company Number     041405 is St. Joseph
     C           #DBQC3    IFEQ 960                        *IF
     C                     Z-ADD960       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBQC3    WQ0041  30       Company Number
     C                     PARM 'OFFAR960'WQ0042  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0043  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     ELSE
      * CASE: DTL.Company Number     041405 is Seaboard Triumph Foods
     C           #DBQC3    IFEQ 440                        *IF
     C                     Z-ADD440       WUC1NY           G/L Posting Com
      * Exc Rtv M3 Dim f/CGL   XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PWBYXFR'              90  Exc Rtv M3 Dim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBQC3    WQ0044  30       Company Number
     C                     PARM 'OFFAR440'WQ0045  8        MCR CGL Code
     C           YL0004    PARM *BLANK    WQ0046  8        MCR GL Acct ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWBYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVELYL0004    WUIZTX           G/L ID Code JDE
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0017           Company Number
     C                     Z-ADDP1CONB    WL0018           Invoice Number
     C                     MOVELP1CEST    WL0019    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0020           Sequence Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUDXNB           Sequence Number
      * Inter company
      * #3
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0021           Company Number
     C                     Z-ADDP1CONB    WL0022           Invoice Number
     C                     MOVELP1CEST    WL0023    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0024           Sequence Number
     C                     MOVEL'ITC'     WL0025    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0026           Transaction Amo
     C                     MOVEL*BLANK    WL0027           A/R Check Numbe
     C                     MOVEL@CN,004   WL0028    P      Explanation
     C                     Z-ADD##JDT     WL0029           Transaction Dat
     C                     Z-ADD##JDT     WL0030           Payment/Deposit
     C                     Z-ADD*ZERO     WL0031           Deposit Time
     C                     Z-ADD*ZERO     WL0032           G/L Post Date
     C                     MOVEL*BLANK    WL0033           Bank Code
     C                     Z-ADD*ZERO     WL0034           G/L Document Nu
     C                     MOVEL'ADJ'     WL0035    P      Cash/Adj
     C                     MOVEL'E'       WL0036    P      A/R Processing
     C                     MOVEL##PGM     WL0037    P      Originating Pro
     C                     MOVEL*BLANK    WL0038           Effect on Accou
     C                     Z-ADDWUC1NY    WL0039           G/L Posting Com
     C                     MOVELWUIZTX    WL0040    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0041    P      Post Adjustment
     C                     MOVELYL0003    WL0042    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0043           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0044           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0045           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0046           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0049           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0051           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0052           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0053           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0054           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0055           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0056           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0057           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0058    P      EDI Status 1
     C                     MOVELWUUWST    WL0059    P      EDI Status 2
     C                     MOVELWUUXST    WL0060    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0061           Job Time
     C                     MOVEL*BLANK    WL0062           User Id
     C                     MOVEL*BLANK    WL0063           Job Name
     C                     Z-ADD*ZERO     WL0064           Job Date
     C                     EXSR SFCRRC
      *        Create Reversing entry for CM A/R account
     C           *ZERO     SUB  WUBSVA    WUBSVA           Transaction Amo
      * RTV G/L Code           RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0014           Company Number
     C                     Z-ADD#1ANC7    WL0015           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WUISTX    P      G/L Code
      * If Co/Customer does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    WUISTX           G/L Code
     C                     MOVEL'*blanks' WUISTX           G/L Code
     C                     END                             *FI
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DBQC3    WQ0047  30       Company Number
     C                     PARM WUISTX    WQ0048  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0049 25        G/L Code Desc U
     C           WUIZTX    PARM *BLANK    WQ0050  8        G/L Account Id
     C                     PARM WUAT1U    WQ0051  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0052  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0053  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WUIZTX    WQ0054  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0055 12        Cost Center. .
     C                     PARM *BLANK    WQ0056  6        Object Account
     C                     PARM *BLANK    WQ0057  8        Subsidiary . .
     C                     PARM *BLANK    WQ0058 30        Description
     C           WUC1NY    PARM *ZERO     WQ0059  30       G/L Posting Com
     C                     PARM *BLANK    WQ0060  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0061  7        Error Return te
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         WUDXNB           Sequence Number
      * RTV Next Seq. No.      RT - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0017           Company Number
     C                     Z-ADDP1CONB    WL0018           Invoice Number
     C                     MOVELP1CEST    WL0019    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0020           Sequence Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUDXNB           Sequence Number
      * Inter company
      * #4
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0021           Company Number
     C                     Z-ADDP1CONB    WL0022           Invoice Number
     C                     MOVELP1CEST    WL0023    P      Invoice Suffix
     C                     Z-ADDWUDXNB    WL0024           Sequence Number
     C                     MOVEL'ITC'     WL0025    P      Adjustment Type
     C                     Z-ADDWUBSVA    WL0026           Transaction Amo
     C                     MOVEL*BLANK    WL0027           A/R Check Numbe
     C                     MOVEL@CN,005   WL0028    P      Explanation
     C                     Z-ADD##JDT     WL0029           Transaction Dat
     C                     Z-ADD##JDT     WL0030           Payment/Deposit
     C                     Z-ADD*ZERO     WL0031           Deposit Time
     C                     Z-ADD*ZERO     WL0032           G/L Post Date
     C                     MOVEL*BLANK    WL0033           Bank Code
     C                     Z-ADD*ZERO     WL0034           G/L Document Nu
     C                     MOVEL'ADJ'     WL0035    P      Cash/Adj
     C                     MOVEL'E'       WL0036    P      A/R Processing
     C                     MOVEL##PGM     WL0037    P      Originating Pro
     C                     MOVEL*BLANK    WL0038           Effect on Accou
     C                     Z-ADDWUC1NY    WL0039           G/L Posting Com
     C                     MOVELWUIZTX    WL0040    P      G/L ID Code JDE
     C                     MOVEL'Y'       WL0041    P      Post Adjustment
     C                     MOVELYL0003    WL0042    P      A/R TF Exempt C
     C                     MOVEL*BLANK    WL0043           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0044           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0045           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0046           A/R Dtl UnUsed
     C                     MOVEL*BLANK    WL0047           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0048           TFS Adj Week-En
     C                     Z-ADD*ZERO     WL0049           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WL0050           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0051           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0052           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0053           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WL0054           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0055           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0056           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WL0057           A/R Dtl UnUsed
     C                     MOVELWUUVST    WL0058    P      EDI Status 1
     C                     MOVELWUUWST    WL0059    P      EDI Status 2
     C                     MOVELWUUXST    WL0060    P      EDI Status 3
     C                     Z-ADD*ZERO     WL0061           Job Time
     C                     MOVEL*BLANK    WL0062           User Id
     C                     MOVEL*BLANK    WL0063           Job Name
     C                     Z-ADD*ZERO     WL0064           Job Date
     C                     EXSR SFCRRC
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Company Number NE DTL.Company Number     041405
      *   |- c2    : PAR.A/R Customer Number NE DTL.A/R Customer Number
      *   '-
     C           P1AIC3    IFNE #DBQC3                     *IF
     C           P1ANC7    ORNE #1ANC7                     *OR
      * *****************************************************************
      * ****  Change Existing a/r header to New company/customer    ****
      * RMC 4/27/06 delete orig rcd before creating new. comp may not be
      * RTV Chg Co/cust f/OA  RT - A/R Header  * 
     C                     EXSR SGRVGN
      * Rtv Chg Co            RT - A/R Header OA  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Company Number     041405 and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVDBQC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDBQC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #DBQC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #DBQC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate A/R Customer Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1ANC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1ANC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1ANC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * VAL A/R Customer       RT - Customer  * 
     C                     EXSR SMRVGN
      * Customer error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Customer invalid'
     C                     MOVEL'USR2110' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Cust Name/Addr/Ph  RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0001           Ship To Custome
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #1AYTX    P      Customer Name
     C                     MOVELWL0003    #1ACNA    P      Address Line 1
     C                     MOVELWL0004    #1ADNA    P      Address Line 2
     C                     MOVELWL0005    #1AENA    P      Address Line 3
     C                     MOVELWL0006    #1AJNA    P      City
     C                     MOVELWL0007    #1BGCD    P      State Code
     C                     MOVELWL0008    #1BTTX    P      Zip/Postal Code
     C                     MOVELWL0009    #1BVTX    P      Telephone Numbe
     C                     END                             *FI
      * Cant transfer to 960
      * CASE: DTL.Company Number     041405 is St. Joseph
     C           #DBQC3    IFEQ 960                        *IF
      * Setup message data for message
      * Convert Company Number     041405 to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DBQC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DBQC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0002           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid Company Number'
     C                     MOVEL'USR1783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Cant transfer a 440 OA to any other company
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Company Number is Sioux City
      *   |- c2    : DTL.Company Number     041405 is NE Seaboard Triumph
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PAIC3    IFEQ 440                        *IF
     C           #DBQC3    IFNE 440                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Company Number     041405 to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DBQC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DBQC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0003           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid Company Number'
     C                     MOVEL'USR1783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * 04/29/2008 SLM Add additional validation for TF Exempt per Alice
      * A/R TF Exempt Code usr1 is performed in the init of the pgm
      * this is based on PAR A/R customer
      * A/R TF Exempt Code usr2 is based from the dtl A/R customer
      * Rtv Customer ExemptFN/NE - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0012           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WUWTF2    P      Customer TF Exe
     C                     MOVELWUWTF2    #DWTF2           A/R TF Exempt C
      * CASE: WRK.A/R TF Exempt Code Usr1 EQ WRK.A/R TF Exempt Code Usr2
     C           WUWTF1    IFEQ WUWTF2                     *IF
     C                     ELSE
      * CASE: WRK.A/R TF Exempt Code Usr2 is Exempt Customer
     C           WUWTF2    IFEQ 'EC'                       *IF
      * CASE: WRK.A/R TF Exempt Code Usr1 is Exempt Product
     C           WUWTF1    IFEQ 'EP'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer TF Exempt Error'
     C                     MOVEL'USR3937' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Customer TF Exempt Error'
     C                     MOVEL'USR3937' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 05/14/07 JRB Removed hard coded companies
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
     C                     EXSR SNRVGN
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0005    IFEQ 'P'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0010           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #DADTX    P      Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DADTX           Name
      * Setup message data for message
      * Convert Company Number     041405 to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DBQC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DBQC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0006           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid Company Number'
     C                     MOVEL'USR1783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to State
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to County Master
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9932  *
     C                     END
      * Check reference to Customer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Country
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#PAIC3    WL0010           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #DSQTX    P      Name
     C                     END
      * Company Number     041405 required
     C           #DBQC3    IFEQ *ZERO                      IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * A/R Customer Number required
     C           #1ANC7    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #PAIC3    IFEQ 440                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
     C                     MOVEL*BLANK    #1ABTX           Alpha Search
     C                     MOVEL*BLANK    #1A2NA           Federal Tax Id.
     C                     MOVEL*BLANK    #1CBST           New Customer St
     C                     MOVEL*BLANK    #1B0NA           SIC Number
     C                     Z-ADD*ZERO     #1P3NB           D & B Number
     C                     MOVEL*BLANK    #1AXNA           D & B Rating
     C                     Z-ADD*ZERO     #1I6DT           Date of D & B R
     C                     Z-ADD*ZERO     #1AYDT           Credit Line Exp
     C                     Z-ADD*ZERO     #1BTC7           Parent Customer
     C                     MOVEL*BLANK    #1K6ST           Credit Check A/
     C                     MOVEL*BLANK    #1UZST           Credit Check Pa
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     MOVEL*BLANK    #1LTCD           EDI Invoice Sts
     C                     Z-ADD*ZERO     #1S2NB           Parent Credit L
     C                     Z-ADD*ZERO     #1VHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     #1I7DT           Order Entry Hol
     C                     MOVEL*BLANK    #1RJST           Ship To Custome
     C                     MOVEL*BLANK    #1RKST           Field vs. In-Ho
     C                     MOVEL*BLANK    #1QWST           Email When Orde
     C                     MOVEL*BLANK    #1QXST           Print Invoice S
     C                     MOVEL*BLANK    #1QYST           Item Reference
     C                     MOVEL*BLANK    #1UNCS           Statement Print
     C                     MOVEL*BLANK    #1QNST           Order Entry Hol
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP1AIC3    #PAIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    VPAIC3
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     MOVEL*BLANK    #DWTF1           A/R TF Exempt C
     C                     Z-ADDP1CONB    #PCONB           Invoice Number
     C                     MOVELP1CEST    #PCEST           Invoice Suffix
     C                     Z-ADDP1BSVA    #PBSVA           Transaction Amo
     C                     Z-ADD*ZERO     #DBQC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    VDBQC3
     C                     MOVEL*BLANK    #DADTX           Name
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
      * Clear external version also
     C                     MOVEL*BLANK    V1ANC7
     C                     MOVEL*BLANK    #DWTF2           A/R TF Exempt C
     C                     MOVEL*BLANK    #1AYTX           Customer Name
     C                     MOVEL*BLANK    #1ACNA           Address Line 1
     C                     MOVEL*BLANK    #1ADNA           Address Line 2
     C                     MOVEL*BLANK    #1AENA           Address Line 3
     C                     MOVEL*BLANK    #1AJNA           City
     C                     MOVEL*BLANK    #1BGCD           State Code
     C                     MOVEL*BLANK    #1G5CD           County Code
     C                     MOVEL*BLANK    #1BTTX           Zip/Postal Code
     C                     MOVEL*BLANK    #1BVTX           Telephone Numbe
     C                     MOVEL*BLANK    #1BWTX           Fax Number FF
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#PAIC3    WL0010           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #DSQTX    P      Name
      * USER: Load screen
     C                     Z-ADDP1AIC3    #DBQC3           Company Number
     C                     Z-ADDP1BSVA    #PBSVA           Transaction Amo
     C                     Z-ADDP1ANC7    #1ANC7           A/R Customer Nu
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBQC3    WL0010           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #DADTX    P      Name
     C                     MOVELWUWTF1    #DWTF1           A/R TF Exempt C
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #PAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#PAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VPAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Company Number     041405 to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #DBQC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#DBQC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDBQC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBQC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1ANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1ANC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr/Ph  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSA     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAYTX    WL0002           Customer Name
     C                     MOVELWAACNA    WL0003           Address Line 1
     C                     MOVELWAADNA    WL0004           Address Line 2
     C                     MOVELWAAENA    WL0005           Address Line 3
     C                     MOVELWAAJNA    WL0006           City
     C                     MOVELWABGCD    WL0007           State Code
     C                     MOVELWABTTX    WL0008           Zip/Postal Code
     C                     MOVELWABVTX    WL0009           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0010    WBAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Name
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBADTX    WL0011           Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Customer ExemptFN/NE - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'NE'      WL0013           Customer TF Exe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0012    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'NE'      WL0013           Customer TF Exe
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Customer TF Exempt Code is *ALL values
     C           WCP3SX    IFEQ 'NE'                       *IF
     C           WCP3SX    OREQ 'PC'
     C           WCP3SX    OREQ 'EC'
     C           WCP3SX    OREQ 'EP'
     C                     MOVELWCP3SX    WL0013           Customer TF Exe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'NE'      WL0013           Customer TF Exe
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV G/L Code           RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0014    WDAIC3           Company Number
     C                     Z-ADDWL0015    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDISTX    WL0016           G/L Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Next Seq. No.      RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WECONB    WQSE02           Invoice Number
     C           *LIKE     DEFN WECEST    WQSE03           Invoice Suffix
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Invoice Number
     C                     KFLD           WQSE03           Invoice Suffix
     C                     KFLD           WEDXNB           Sequence Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Invoice Number
     C                     KFLD           WQSE03           Invoice Suffix
      * Setup key
     C                     Z-ADDWL0017    WQSE01           Company Number
     C                     Z-ADDWL0018    WQSE02           Invoice Number
     C                     MOVELWL0019    WQSE03           Invoice Suffix
     C                     Z-ADDWL0020    WEDXNB           Sequence Number
      * Establish starting position
     C           KPSSE     SETLL@BFCPFO                    *
     C           KRSSE     READE@BFCPFO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0020           Sequence Number
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWEDXNB    WL0020           Sequence Number
     C           KRSSE     READE@BFCPFO                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0020           Sequence Number
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Reverse Entry Dtl  CR - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BFCPFN
     C                     Z-ADDWL0021    WFAIC3           Company Number
     C                     Z-ADDWL0022    WFCONB           Invoice Number
     C                     MOVELWL0023    WFCEST           Invoice Suffix
     C                     Z-ADDWL0024    WFDXNB           Sequence Number
     C                     MOVELWL0025    WFUHCD           Adjustment Type
     C                     Z-ADDWL0026    WFBSVA           Transaction Amo
     C                     MOVELWL0027    WFCPTX           A/R Check Numbe
     C                     MOVELWL0028    WFNGNA           Explanation
     C                     Z-ADDWL0029    WFB4DT           Transaction Dat
     C                     Z-ADDWL0030    WFDVDT           Payment/Deposit
     C                     Z-ADDWL0031    WFYXNX           Deposit Time
     C                     Z-ADDWL0032    WFHYDT           G/L Post Date
     C                     MOVELWL0033    WFG4CD           Bank Code
     C                     Z-ADDWL0034    WFCKNB           G/L Document Nu
     C                     MOVELWL0035    WFA5ST           Cash/Adj
     C                     MOVELWL0036    WFAJST           A/R Processing
     C                     MOVELWL0037    WFB1VN           Originating Pro
     C                     MOVELWL0038    WFEAZT           Effect on Accou
     C                     Z-ADDWL0039    WFC1NY           G/L Posting Com
     C                     MOVELWL0040    WFIZTX           G/L ID Code JDE
     C                     MOVELWL0041    WFETSX           Post Adjustment
     C                     MOVELWL0042    WFW3SX           A/R TF Exempt C
     C                     MOVELWL0043    WFW4SX           A/R Dtl UnUsed
     C                     MOVELWL0044    WFW5SX           A/R Dtl UnUsed
     C                     MOVELWL0045    WFW6SX           A/R Dtl UnUsed
     C                     MOVELWL0046    WFW7SX           A/R Dtl UnUsed
     C                     MOVELWL0047    WFW8SX           A/R Dtl UnUsed
     C                     Z-ADDWL0048    WFQHDT           TFS Adj Week-En
     C                     Z-ADDWL0049    WFQIDT           A/R Orig Inv fo
     C                     Z-ADDWL0050    WFQJDT           A/R Dtl UnUsed
     C                     Z-ADDWL0051    WFQKDT           A/R Dtl UnUsed
     C                     Z-ADDWL0052    WFQLDT           A/R Dtl UnUsed
     C                     Z-ADDWL0053    WFGLVL           G/L Sub-Ledger
     C                     Z-ADDWL0054    WFGMVL           A/R Dtl UnUsed
     C                     Z-ADDWL0055    WFGNVL           A/R Dtl UnUsed
     C                     Z-ADDWL0056    WFGOVL           A/R Dtl UnUsed
     C                     Z-ADDWL0057    WFGPVL           A/R Dtl UnUsed
     C                     MOVELWL0058    WFUVST           EDI Status 1
     C                     MOVELWL0059    WFUWST           EDI Status 2
     C                     MOVELWL0060    WFUXST           EDI Status 3
     C                     Z-ADDWL0061    WFAATM           Job Time
     C                     MOVELWL0062    WFAYNA           User Id
     C                     MOVELWL0063    WFA0NA           Job Name
     C                     Z-ADDWL0064    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFCONB           Invoice Number
     C                     KFLD           WFCEST           Invoice Suffix
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BFCPFN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0179' W0RTN   7
      * Send message 'A/R Detail             EX'
     C                     MOVEL'USR0179' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BFCPFN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Chg Co/cust f/OA  RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1CONB    WGCONB           Invoice Number
     C                     MOVELP1CEST    WGCEST           Invoice Suffix
      * Establish starting position
     C           KRSSG     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * DLT A/R Header         DL - A/R Header  * 
     C                     EXSR SHDLRC
      * CRT A/R Header         CR - A/R Header  * 
     C                     EXSR SICRRC
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * DLT A/R Header         DL - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BDCPFG
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGCONB    WHCONB           Invoice Number
     C                     MOVELWGCEST    WHCEST           Invoice Suffix
      *
     C           KLDLSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHCONB           Invoice Number
     C                     KFLD           WHCEST           Invoice Suffix
     C           KLDLSH    CHAIN@BDCPFG              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BDCPFG                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * CRT A/R Header         CR - A/R Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPFG
     C                     Z-ADD#DBQC3    WHAIC3           Company Number
     C                     Z-ADDWGCONB    WHCONB           Invoice Number
     C                     MOVELWGCEST    WHCEST           Invoice Suffix
     C                     MOVELWGUHCD    WHUHCD           Adjustment Type
     C                     Z-ADDWGBSVA    WHBSVA           Transaction Amo
     C                     Z-ADDWGAIVA    WHAIVA           Adjustment Amou
     C                     Z-ADDWGAOVA    WHAOVA           Amount Paid
     C                     Z-ADDWGBGVA    WHBGVA           Remaining Balan
     C                     MOVELWGAJST    WHAJST           A/R Processing
     C                     MOVELWGE3ST    WHE3ST           Purge Status
     C                     MOVELWGG4CD    WHG4CD           Bank Code
     C                     Z-ADDWGCKNB    WHCKNB           G/L Document Nu
     C                     Z-ADDWGCAC7    WHCAC7           Order Number Re
     C                     Z-ADDWGBKC7    WHBKC7           Ship To Custome
     C                     MOVELWGBCCD    WHBCCD           Salesperson Cod
     C                     MOVELWGR4CD    WHR4CD           Sales Route Cod
     C                     Z-ADDWGB4DT    WHB4DT           Transaction Dat
     C                     Z-ADDWGATDT    WHATDT           Due Date
     C                     Z-ADDWGH0DT    WHH0DT           Last Payment Da
     C                     Z-ADDWGH3DT    WHH3DT           Original Inv fo
     C                     Z-ADDWGH4DT    WHH4DT           Paid in Full Da
     C                     Z-ADDWGH5DT    WHH5DT           Last G/L Post D
     C                     Z-ADD#1ANC7    WHANC7           A/R Customer Nu
     C                     MOVELWGCPTX    WHCPTX           A/R Check Numbe
     C                     Z-ADDWGBSDY    WHBSDY           Days to Pay
     C                     MOVELWGUVST    WHUVST           EDI Status 1
     C                     MOVELWGUWST    WHUWST           EDI Status 2
     C                     MOVELWGUXST    WHUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHCONB           Invoice Number
     C                     KFLD           WHCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSI    SETLL@BDCPFG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0175' W0RTN   7
      * Send message 'A/R Header             EX'
     C                     MOVEL'USR0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPFG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * Crt A/R Header Ext    XF - A/R Header Ext  * 
     C                     CALL 'PBX3XFR'              90  Crt A/R Header
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0062  30       Company Number
     C                     PARM WHCONB    WQ0063  70       Invoice Number
     C                     PARM WHCEST    WQ0064  2        Invoice Suffix
     C                     PARM WHBGVA    WQ0065 112       Remaining Balan
     C                     PARM WHCAC7    WQ0066  70       Order Number Re
     C                     PARM WHH3DT    WQ0067  70       Original Inv fo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Chg Co            RT - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WICONB           Invoice Number
     C                     KFLD           WICEST           Invoice Suffix
      * Setup key
     C                     Z-ADDP1AIC3    WIAIC3           Company Number
     C                     Z-ADDP1CONB    WICONB           Invoice Number
     C                     MOVELP1CEST    WICEST           Invoice Suffix
      * Establish starting position
     C           KRSSJ     CHAIN@A4CPX7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3460' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Dlt A/R Header OA     DL - A/R Header OA  * 
     C                     EXSR SKDLRC
      * Crt A/R Header OA     CR - A/R Header OA  * 
     C                     EXSR SLCRRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * Dlt A/R Header OA     DL - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @A4CPX6
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWICONB    WJCONB           Invoice Number
     C                     MOVELWICEST    WJCEST           Invoice Suffix
      *
     C           KLDLSK    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJCONB           Invoice Number
     C                     KFLD           WJCEST           Invoice Suffix
     C           KLDLSK    CHAIN@A4CPX6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPA4CPL0'MDACP
     C                     MOVEL'@A4CPX6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@A4CPX6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt A/R Header OA     CR - A/R Header OA  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A4CPX6
     C                     Z-ADD#DBQC3    WJAIC3           Company Number
     C                     Z-ADDWICONB    WJCONB           Invoice Number
     C                     MOVELWICEST    WJCEST           Invoice Suffix
     C                     MOVELWIG4CD    WJG4CD           Bank Code
     C                     Z-ADDWIHXDT    WJHXDT           Deposit Date
     C                     Z-ADDWIYXNX    WJYXNX           Deposit Time
     C                     MOVELWIUTSX    WJUTSX           OA Unused Sts
      *
     C           KLCRSL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJCONB           Invoice Number
     C                     KFLD           WJCEST           Invoice Suffix
      * Check for duplicate primary key
     C           KLCRSL    SETLL@A4CPX6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3461' W0RTN   7
      * Send message 'A/R Header OA          EX'
     C                     MOVEL'USR3461' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@A4CPX6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * VAL A/R Customer       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKANC7    WQSM01           A/R Customer Nu
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           A/R Customer Nu
      * Setup key
     C                     Z-ADD#1ANC7    WQSM01           A/R Customer Nu
      * Establish starting position
     C           KRSSM     SETLL@BBREXJ                    *
     C           KRSSM     READE@BBREXJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BBREXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WLAIC3           Company Number
      * Setup key
     C                     Z-ADD#DBQC3    WLAIC3           Company Number
      * Establish starting position
     C           KRSSN     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Plant Company S
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLYISX    YL0005           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WSAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0005    WSAJVN           User Profile Na
      * Establish starting position
     C           KRSSO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELWSMPNA    WUMPNA           Default Printer
     C                     MOVELWSBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDWSAIC3    YL0007           Company Number
     C                     MOVELWSBUVN    WN0006           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WTAJVN           User Profile Na
     C                     KFLD           WTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0065    WTAJVN           User Profile Na
     C                     MOVELWL0066    WTDNCD           Application Cod
      * Establish starting position
     C           KRSSP     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTAIC3    WL0067           Company Number
     C                     MOVELWTAJCD    WL0068           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSQ01           Application Cod
     C                     MOVEL'A/R'     WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WVRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQSR01           Application Cod
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Application Cod
      * Setup key
     C                     MOVELWVRSCD    WQSR01           Application Cod
      * Establish starting position
     C           KRSSR     SETLL@DNRESF                    *
     C           KRSSR     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C           KRSSR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * RMC 07/28/21 SDN440 - FOR E1LIVE
      *    Changed company 362 to 320
      * E9064 RMC 04/20/17 - do allow OA transfer to 440 company, get gl
      *     from HPE M3 GL M3 Cross Ref file; dont allow OA to 960; dont
      *     allow 440 OA to 360.
      * E6933 DN  08/12/16 - Create A/R Header Ext record.
      * - Modified CRT A/R Header         CO - A/R Header.
      * SLM 4/09/08  E00193 Inter Company only for Organization of SBD
      * SLM 4/09/08  TFS040 Also change to the rtv on customer ext
      *              will be pass these in at the same move to production
      * SLM 4/09/08  TFS040 Addition validation on exempt - per Alice
      *              IF The pass in customer = to customer then no valida
      *              Going from a customer of NE can only go to NE
      *              ER can to to a EC
      *              EP can to to a EC
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1ANC7    WK1X01  1
     C           WK1X01    IFEQ '?'                        A/R Customer Nu
     C           YPMTFD    OREQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0006' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ANC7    WQ0068  70       A/R Customer Nu
     C           YL0006    PARM *ZERO     WQ0069  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      A/R Customer Nu
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BGCD' defaulted for 'State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BGCD    PARM #1BGCD    WQ0070  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BGCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BGCD    IFEQ *BLANK                     State Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWM    KLIST
     C                     KFLD           WMBGCD           State Code
      * Setup key
     C                     MOVEL#1BGCD    WMBGCD
     C           KLVBWM    CHAIN@ACREAH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to County Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BGCD    WK1X01  1
     C                     MOVEL#1G5CD    WK1X02  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BGCD'
     C           WK1X02    OREQ '?'                        County Code
     C           YPMTFD    OREQ '#1G5CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BGCD' defaulted for 'State Code'.
      * Field '(DTL) #1G5CD' defaulted for 'County Code'.
     C                     CALL 'CAMDSRR'              90  SEL County Mast
     C                     PARM *BLANK    W0RTN   7
     C           #1BGCD    PARM #1BGCD    WQ0071  2        State Code
     C           #1G5CD    PARM #1G5CD    WQ0072  6        County Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BGCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1G5CD    IFNE *BLANK                     County Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1G5CD    IFEQ *BLANK                     County Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWO    KLIST
     C                     KFLD           WOBGCD           State Code
     C                     KFLD           WOG5CD           County Code
      * Setup key
     C                     MOVEL#1BGCD    WOBGCD
     C                     MOVEL#1G5CD    WOG5CD
     C           KLVCWO    CHAIN@ECREVS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'County Master          NF'
     C                     MOVEL'USR0852' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0852' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1ANC7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0073  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWA    KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    WABKC7
     C           KLVDWA    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BTC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0006' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ANC7    WQ0074  70       A/R Customer Nu
     C           YL0006    PARM *ZERO     WQ0075  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9932  *
     C                     END
      *
     C           #1BTC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BTC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWA    KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BTC7    WABKC7
     C           KLVEWA    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Country
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1KXCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'OMZASRR'              90  SEL Select Coun
     C                     PARM *BLANK    W0RTN   7
     C           #1KXCD    PARM #1KXCD    WQ0076  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMZASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1KXCD    IFEQ *BLANK                     Country Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWR    KLIST
     C                     KFLD           WRKXCD           Country Code
      * Setup key
     C                     MOVEL#1KXCD    WRKXCD
     C           KLVFWR    CHAIN@E5REB8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Country                NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1158' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE038
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1ANC7'  YPMTFD           A/R Customer Nu
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field A/R TF Exempt Code
     C                     MOVEL*BLANK    WUW3SX  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field G/L Code
     C                     MOVEL*BLANK    WUISTX  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDR5NB           Deliver after t
     C                     Z-ADD*ZERO     WDR6NB           Deliver before
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WDW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field G/L ID Code JDE
     C                     MOVEL*BLANK    WUIZTX  8
      * Define work field G/L Account Type 1 USR
     C                     MOVEL*BLANK    WUAT1U  3
      * Define work field G/L Account Type 2 USR
     C                     MOVEL*BLANK    WUAT2U  3
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field G/L Posting Company
     C                     Z-ADD*ZERO     WUC1NY  30
      * Define work field Sequence Number
     C                     Z-ADD*ZERO     WUDXNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WEYXNX           Deposit Time
     C                     Z-ADD*ZERO     WEHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WEC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WEQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WEQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WEQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WEGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Transaction Amount
     C                     Z-ADD*ZERO     WUBSVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WGAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WGAOVA           Amount Paid
     C                     Z-ADD*ZERO     WGBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WGCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WGCAC7           Order Number Re
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WGATDT           Due Date
     C                     Z-ADD*ZERO     WGH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WGH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WGH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WGH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGBSDY           Days to Pay
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Clear all neither parameters
      * CRT A/R Header         CR - A/R Header  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WICONB           Invoice Number
     C                     Z-ADD*ZERO     WIHXDT           Deposit Date
     C                     Z-ADD*ZERO     WIYXNX           Deposit Time
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field A/R TF Exempt Code Usr2
     C                     MOVEL*BLANK    WUWTF2  2
      * Define work field A/R TF Exempt Code Usr1
     C                     MOVEL*BLANK    WUWTF1  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLXXTM           Departure Time
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSNLNB           Entity Number
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008 11
     C                     MOVEL*BLANK    WL0009 25
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011 30
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  2
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  8
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  2
     C                     Z-ADD*ZERO     WL0020  30
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  2
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025  3
     C                     Z-ADD*ZERO     WL0026 112
     C                     MOVEL*BLANK    WL0027 10
     C                     MOVEL*BLANK    WL0028 30
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  40
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  6
     C                     Z-ADD*ZERO     WL0034  80
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038  1
     C                     Z-ADD*ZERO     WL0039  30
     C                     MOVEL*BLANK    WL0040  8
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  2
     C                     MOVEL*BLANK    WL0047  2
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053 112
     C                     Z-ADD*ZERO     WL0054 112
     C                     Z-ADD*ZERO     WL0055 112
     C                     Z-ADD*ZERO     WL0056 112
     C                     Z-ADD*ZERO     WL0057 112
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     Z-ADD*ZERO     WL0061  60
     C                     MOVEL*BLANK    WL0062 10
     C                     MOVEL*BLANK    WL0063 10
     C                     Z-ADD*ZERO     WL0064  70
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0065 10
     C                     MOVEL*BLANK    WL0066  6
     C                     Z-ADD*ZERO     WL0067  30
     C                     MOVEL*BLANK    WL0068  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define null work field Shipping Method Dft
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Load Type Dft
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field LTL Flag Dft
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Export Status Dft
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Shrink Wrap Dft
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Departure Time DFT
     C                     Z-ADD*ZERO     YN0006  40
      * Define null work field Export Code Dft
     C                     MOVEL*BLANK    YN0007  6
      * Define null work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field Allow Multi Export On Ord
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field Slip Sheet Dft
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Palletize Dft
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field A/R TF Exempt Code
     C                     MOVEL*BLANK    YL0003  2
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0012 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0013  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0014  8
      * Define null work field Description
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Error Return text
     C                     MOVEL*BLANK    YN0017  7
      * Define local work field MCR GL Acct ID
     C                     MOVEL*BLANK    YL0004  8
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0006  80
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modification History
     C                     EXSR UASUBR                     Modification Hi
      *
     C                     MOVEL*BLANK    WN0005 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0005           User Profile Na
      *
     C                     MOVEL*BLANK    WN0006 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SORVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0005    ZA0007           User Profile Na
     C                     MOVEL'A/R'     ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0006    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0005    WL0065    P      User Profile Na
     C                     MOVEL'A/R'     WL0066    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0067    WUAIC3           Company Number
     C                     MOVELWL0068    YL0008    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0006    WL0065    P      User Profile Na
     C                     MOVEL'A/R'     WL0066    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0067    WUAIC3           Company Number
     C                     MOVELWL0068    YL0008    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0008    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0005    ZA0009           User Profile Na
     C                     MOVEL'A/R'     ZA0010           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0007    IFNE 0                          *IF
     C                     Z-ADDYL0007    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0008    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0077  3        Warehouse Code
     C                     PARM YL0007    WQ0078  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SQRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Customer ExemptFN/NE - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0012           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WUWTF1    P      Customer TF Exe
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Debit A/R Account
00003 Credit Inter Co
00004 Debit Inter Co
00005 Credit A/R Account
00006 USR0752
