// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUCXXFR
// ?Date: 14.08.2025 Time: 03:49:59
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC T10474 6/2/17
//?Roll most current week to new week in Inventory Valuation post
EXECUTE FUNCTION(Rtv Most Current Date RT) TYPE(RTVOBJ) FILE(PUACCPP)           AC2137145;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Effective_Date);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


//?if no records found, then create them from the BOM
CASE;

// IF LCL.Effective Date is not entered
IF LCL.Effective_Date = *ZERO;

//?create rcds for new company
EXECUTE FUNCTION(Rtv Crt ItmStdCost    RT) TYPE(RTVOBJ) FILE(PDIOREP)           AC2137507;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Week_End_Date);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Item Code EQ DB1.Component Item Code
 IF DB1.Item_Code = DB1.Component_Item_Code;

 EXECUTE FUNCTION(Rtv Item Type Code     RT) TYPE(RTVOBJ) FILE(OMBYREP)          AC1704065;
 PARAMETER(DB1.Item_Code);
 PARAMETER(LCL.Item_Type_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

 CASE;

 // IF LCL.Item Type Code is Finished Good
 IF LCL.Item_Type_Code = 'FG';

 // LCL.Yield = DB1.Sales Yield / CON.100 *
 LCL.Yield = DB1.Sales_Yield / 100;

 // LCL.Pump Yield = DB1.BOM Pumped Percent / CON.100 *
 LCL.Pump_Yield = DB1.BOM_Pumped_Percent / 100;

 EXECUTE FUNCTION(Crt Item Standard Cost CR) TYPE(CRTOBJ) FILE(PUACCPP)          AC2136921;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Week_End_Date);
 PARAMETER(LCL.Yield);
 PARAMETER(LCL.Pump_Yield);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(SET Record Stamp CRTOB IF) TYPE(EXCINTFUN)                     AC1282865;
  PARAMETER(DB1.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Record Status = CND.Active
   PAR.Record_Status = 'A';

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 ENDIF;

 ENDIF;

}


// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Rtv Roll to Current WkRT) TYPE(RTVOBJ) FILE(PUACCPP)           AC2137505;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Effective_Date);
PARAMETER(PAR.Week_End_Date);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Yld, Pump for ISC RT) TYPE(RTVOBJ) FILE(PDIOREP)           AC2137506;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Item_Code);
 PARAMETER(LCL.Sales_Yield);
 PARAMETER(LCL.BOM_Pumped_Percent);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.Yield = LCL.Sales Yield / CON.100 *
 LCL.Yield = LCL.Sales_Yield / 100;

 // LCL.Pump Yield = LCL.BOM Pumped Percent / CON.100 *
 LCL.Pump_Yield = LCL.BOM_Pumped_Percent / 100;

 EXECUTE FUNCTION(Crt Item Standard Cost CR) TYPE(CRTOBJ) FILE(PUACCPP)          AC2136921;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.Week_End_Date);
 PARAMETER(LCL.Yield);
 PARAMETER(LCL.Pump_Yield);
 PARAMETER(DB1.Std_Packaging_Cost_CWT);
 PARAMETER(DB1.Std_Other_Cost_CWT);
 PARAMETER(DB1.Std_Inc_Labor_Cost_CWT);
 PARAMETER(DB1.Std_Ingredient_Cost_CWT);
 PARAMETER(DB1.Std_Meat_Cost_CWT);
 PARAMETER(DB1.UnUsed_Cost_Field_1);
 PARAMETER(DB1.UnUsed_Cost_field_2);
 PARAMETER(DB1.Std_Total_Labor_Cost_CWT);
 PARAMETER(DB1.UnUsed_Cost_field_3);
 PARAMETER(DB1.Item_Std_Green_Weight);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(SET Record Stamp CRTOB IF) TYPE(EXCINTFUN)                     AC1282865;
  PARAMETER(DB1.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Record Status = CND.Active
   PAR.Record_Status = 'A';

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

}


ENDIF;

