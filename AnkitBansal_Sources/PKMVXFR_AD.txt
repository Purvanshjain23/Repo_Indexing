// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKMVXFR
// ?Date: 14.08.2025 Time: 02:52:12
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// WRK.Error Type Found = CND.No
WRK.Error_Type_Found = 'N';

//?** Remove the printer parms. These are now being retrieved from
//?** a file in the CLP.                      DLY029 LJB 05/22/2007
//?Send fax if error type is No, that means no errors
CASE;

// IF WRK.Error Type Found is No
IF WRK.Error_Type_Found = 'N';

// PAR.Spool File Selection = CON.PLEMPFR$
PAR.Spool_File_Selection = 'PLEMPFR$';

//?************************
//?5/25/2007  Faxing Verification routine
DO;

//?041107 SLM Add the Faxing Verfication routines.
//?       Fax Verify/Co Usr     -- If this is a Y, then faxing
//?                                verification will be selected
//?       Get the Fax phones numbers for verification
//?       Fax Verify/Phone 1 Usr
// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER('HPEFAXVRY');
PARAMETER(LCL.Fax_Verify_Co_Usr);

CASE;

// IF LCL.Fax Verify/Co Usr is No
IF LCL.Fax_Verify_Co_Usr = 'N';

// LCL.Fax Verify/Phone 1 Usr = CON.*BLANK
LCL.Fax_Verify_Phone_1_Usr = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

//?       HPE Faxing Verf Fax   = HPEFAXVRYF
// Call program Rtv Company Values    XF.
CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER('HPEFAXVRYF');
PARAMETER(LCL.Fax_Verify_Phone_1_Usr);

ENDIF;

ENDDO;

//?************************
// PAR.Printer Name or Outq = CON.FAXQ
PAR.Printer_Name_or_Outq = 'FAXQ';

// PAR.Outq Library = CON.*LIBL
PAR.Outq_Library = *LIBL;

// PAR.Country Description = CON.Fax Cover Sheet w/Overlay
PAR.Country_Description = 'Fax Cover Sheet w/Overlay';

// LCL.Company Number Alpha Usr = PAR.BOH Company Number
LCL.Company_Number_Alpha_Usr = PAR.BOH_Company_Number;

//?9/26/2007 SLM Size of fax number is to small need 20 due to the
//?size of the faxing data base size make it the same
//?PASS IN ANOTHER FIELD FOR FAX NUMBER THE DATA BASE IS 20 IN SIZE
// Call program CLP Faxing Routine     UP.
CALL PROGRAM(CLP Faxing Routine     UP) ('PKUQUPR');
PARAMETER(PAR.Spool_File_Selection);
PARAMETER(PAR.Printer_Name_or_Outq);
PARAMETER(PAR.Outq_Library);
PARAMETER(PAR.Fax_Recipient);
PARAMETER(PAR.Company_Recipient_Name);
PARAMETER(PAR.Fax_Area_Code);
PARAMETER(PAR.Fax_Phone_Number);
PARAMETER(PAR.Country_Description);
PARAMETER(LCL.Company_Number_Alpha_Usr);
PARAMETER(LCL.Fax_Verify_Co_Usr);
PARAMETER(LCL.Fax_Verify_Phone_1_Usr);

ENDIF;

//?***** Change Log and Comments
DO;

//?*****
//?** 05/22/2007 LJB DLY029
//?** Commented out the fields that are not being used.
//?** Removed the printer parms that were being passed to the Fax
//?** Cover Sheet program. This program will call a new program to
//?** retrieve the parms from the Company Document Defaults file
//?** in the OMS System.
//?**
//?** 6/20/07 SLM DLY029 Pass in the Company number as alpha
//?**
//?*****
//?** 6/20/07 SLM
//?** 05/22/2007 SLM * out enhancement on the Faxing to allow
//?** Lara have this option to enter in what is needed for new
//?** faxing routine.
//?** Company value of Faxing Verification Routine
//?** is being reinstalled and tested
ENDDO;

