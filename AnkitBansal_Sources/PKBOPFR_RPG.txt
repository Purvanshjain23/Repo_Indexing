     H/TITLE Prt Receiving Rpt     PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 11/08/21  Time  : 14:09:46
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPN8IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KllDt/Shft/ClsTyp/Tt,
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPLAJCPL1IF  E           K        DISK
      * RTV : Delivery Tracking Split   Retrieval index
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKB3CPL1IF  E           K        DISK
      * RTV : Tattoo Scale Ticket       Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA1CPN0IF  E           K        DISK
      * RSQ : Tattoo Header             Co/bol/Ttt/SelHeldOver
      *
     FPKA1CPN7IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KllDt/Shft/ClsTp/S su
      *
     FPKA1CPO3IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KllDt/Shft/ClsTp/S sh
      *
     FPLAACPL1IF  E           K        DISK
      * RTV : Head Killed & Cut Summary Retrieval index
      *
     FPLAACPL0UF  E           K        DISK                      A
      * UPD : Head Killed & Cut Summary Update index
      *
     FPKBOPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Receiving Rpt     PF  Print file
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@A1CPVF
      * Tattoo Header             Co/bol/Ttt/SelHeldOver
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPXQ
      * Tattoo Header             Co/KllDt/Shft/ClsTp/S su
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@A1CPX9
      * Tattoo Header             Co/KllDt/Shft/ClsTp/S sh
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@AACPH7
      * Head Killed & Cut Summary Retrieval index
      * Renamed input format fields
     I              AAHONB                          WDHONB
     I              AANKNB                          WDNKNB
     I              AAHVA1                          WDHVA1
     I              AAB0DT                          WDB0DT
     I              AAWTST                          WDWTST
     I              AAFPDT                          WDFPDT
     I              AAKDHD                          WDKDHD
     I              AAHUA1                          WDHUA1
     I              AAAAVN                          WDAAVN
     I              AAAADT                          WDAADT
     I              AAAMTM                          WDAMTM
     I              AAAJST                          WDAJST
     I              AAAHVN                          WDAHVN
     I              AAAGVN                          WDAGVN
     I              AAABVN                          WDABVN
     I              AAABDT                          WDABDT
     I              AAABTM                          WDABTM
      *
     I@AACPH6
      * Head Killed & Cut Summary Update index
      * Renamed input format fields
     I              AAHONB                          WEHONB
     I              AANKNB                          WENKNB
     I              AAHVA1                          WEHVA1
     I              AAB0DT                          WEB0DT
     I              AAWTST                          WEWTST
     I              AAFPDT                          WEFPDT
     I              AAKDHD                          WEKDHD
     I              AAHUA1                          WEHUA1
     I              AAAAVN                          WEAAVN
     I              AAAADT                          WEAADT
     I              AAAMTM                          WEAMTM
     I              AAAJST                          WEAJST
     I              AAAHVN                          WEAHVN
     I              AAAGVN                          WEAGVN
     I              AAABVN                          WEABVN
     I              AAABDT                          WEABDT
     I              AAABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPLAA1    E DSPLAACPL0
      * UPD : Head Killed & Cut Summary Update index
      * Renamed input format fields
     I              AAHONB                          WEHONB
     I              AANKNB                          WENKNB
     I              AAHVA1                          WEHVA1
     I              AAB0DT                          WEB0DT
     I              AAWTST                          WEWTST
     I              AAFPDT                          WEFPDT
     I              AAKDHD                          WEKDHD
     I              AAHUA1                          WEHUA1
     I              AAAAVN                          WEAAVN
     I              AAAADT                          WEAADT
     I              AAAMTM                          WEAMTM
     I              AAAJST                          WEAJST
     I              AAAHVN                          WEAHVN
     I              AAAGVN                          WEAGVN
     I              AAABVN                          WEABVN
     I              AAABDT                          WEABDT
     I              AAABTM                          WEABTM
      *
     IYARDCS      DS                             81
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : POS TH Kill Date
     I                                    P   3   60P1B0DT
      * I :  TH Source Type
     I                                        7   7 P1KAST
      * I :  TH Hog Class Type
     I                                        8   8 P1LLST
      * I :  TH Schedule Kill Shift
     I                                        9   9 P1LIST
      * I :  TH HPS Farm Site
     I                                    P  10  120P1THHD
      * I :  PD Producer Code
     I                                       13  18 P1ABCD
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I :  Date From USR
     I                                    P   1   40P3B3DT
     IP4PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P4B4DT
     IP5PARM      DS
      * N :  Usr Display 1
     I                                        1   1 P5MFST
     IP6PARM      DS
      * I :  Status 1
     I                                        1   1 P6P4ST
     IP7PARM      DS
      * FLD: *Arrays
      * N :  Week Ending Date
     I                                    P   1   40P7FPDT
      * N :  Week Number
     I                                    P   5   60P7HVA1
      * N :  Calendar Year
     I                                    P   7   90P7NKNB
     IP8PARM      DS
      * I :  SR Source Code
     I                                        1   3 P8AACD
     IP9PARM      DS
      * I :  DT Load Type
     I                                        1   2 P9XHST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1B0DT    PARM           WP0002  70       TH Kill Date
     C           P1KAST    PARM           WP0003  1        TH Source Type
     C           P1LLST    PARM           WP0004  1        TH Hog Class Ty
     C           P1LIST    PARM           WP0005  1        TH Schedule Kil
     C           P1THHD    PARM           WP0006  50       TH HPS Farm Sit
     C           P1ABCD    PARM           WP0007  6        PD Producer Cod
     C           P2EVTX    PARM           WP0008 40        Oms System Valu
     C           P3B3DT    PARM           WP0009  70       Date From USR
     C           P4B4DT    PARM           WP0010  70       Date To   USR
     C           P6P4ST    PARM           WP0011  1        Status 1
     C           P8AACD    PARM           WP0012  3        SR Source Code
     C           P9XHST    PARM           WP0013  2        DT Load Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Receiving Rpt     PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$ZENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Receiving Rpt     PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSA      SETLL@A1CPXP                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt  US - STR User Source Functions  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'N'       P5MFST           Usr Display 1
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0AL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CHMNB           BOH Company Num
     C                     MOVEL*BLANK    $CBSTX           Name USR
     C                     Z-ADD*ZERO     $CB3DT           Date From USR
     C                     Z-ADD*ZERO     $CB4DT           Date To   USR
     C                     MOVEL*BLANK    $CAACD           SR Source Code
     C                     MOVEL*BLANK    $CAFTX           SR Description
     C                     MOVEL*BLANK    $CXHST           DT Load Type
     C                     MOVEL*BLANK    $CEVT1           Load Type Descr
     C                     MOVEL*BLANK    $CLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    $CKKTX           Description 30
     C                     MOVEL*BLANK    $CIXST           SR Type
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
     C                     MOVEL*BLANK    $CLIST           TH Schedule Kil
     C                     MOVEL*BLANK    $CFSTX           Shift Descripti
     C                     Z-ADD*ZERO     $CTHHD           TH HPS Farm Sit
     C                     MOVEL*BLANK    $CKQTX           Farm site Name
     C                     MOVEL*BLANK    $CABCD           PD Producer Cod
     C                     MOVEL*BLANK    $CA4TX           Producer Name
      * Load related totals format
     C                     Z-ADD*ZERO     $YSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $YSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $YHDWT           Head Received w
     C                     Z-ADD*ZERO     $YHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $YWWNB           Head Received 1
     C                     Z-ADD*ZERO     $YX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $YQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $YB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $YTKNB           CKR Held Over
     C                     Z-ADD*ZERO     $YOONB           Live Weight
     C                     Z-ADD*ZERO     $YXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $YXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $YZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $YB5NB           Head Total USR
     C                     Z-ADD*ZERO     $YZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $YZ8NB           Avg Live Wgt Us
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $DNGST           @Status (Held o
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1CVNB    $DCVNB           TH Tattoo Numbe
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
     C                     Z-ADDA1CWNB    $DCWNB           TH Head Receive
     C                     Z-ADDA1T2HD    $DT2HD           TH Shift Held O
     C                     Z-ADDA1GHNB    $DGHNB           TH Commission A
     C                     Z-ADDA1CYNB    $DCYNB           TH Live Wgt
     C                     Z-ADDA1F7NB    $DF7NB           TH Avg Live Wgt
     C                     Z-ADDA1ECDT    $DECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $DEDDT           TH Head EUT/KOA
     C                     Z-ADDA1CXNB    $DCXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $DFCNB           TH Yard Deads
     C                     Z-ADDA1OXNB    $DOXNB           TH HPS Movement
     C                     MOVELA1AGCD    $DAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $DKQTX           Farm site Name
     C                     MOVELA1BDCD    $DBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $DLJNB           TDF Head Defect
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $EB0DT           TH Kill Date
     C                     MOVELA1LLST    $ELLST           TH Hog Class Ty
      * Load related totals format
     C                     Z-ADD*ZERO     $XSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $XSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $XHDWT           Head Received w
     C                     Z-ADD*ZERO     $XHD5U           DOA Head Total
     C                     Z-ADDA1HMNB    $XHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $XB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $XWWNB           Head Received 1
     C                     Z-ADD*ZERO     $XX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $XQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $XB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $XTKNB           CKR Held Over
     C                     Z-ADD*ZERO     $XOONB           Live Weight
     C                     Z-ADD*ZERO     $XXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $XXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $XZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $XB5NB           Head Total USR
     C                     Z-ADD*ZERO     $XZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $XZ8NB           Avg Live Wgt Us
     C                     MOVELA1LLST    $XLLST           TH Hog Class Ty
      * USER: Process before print of TH Kill Date format
      * CASE: PAR.PD Producer Code is Blank
     C           P1ABCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $FB0DT           TH Kill Date
     C                     MOVELA1LIST    $FLIST           TH Schedule Kil
     C                     MOVEL*BLANK    $FFSTX           Shift Descripti
      * Load related totals format
     C                     Z-ADD*ZERO     $WSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $WSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $WHDWT           Head Received w
     C                     Z-ADD*ZERO     $WHD5U           DOA Head Total
     C                     Z-ADDA1HMNB    $WHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $WB0DT           TH Kill Date
     C                     MOVELA1LIST    $WLIST           TH Schedule Kil
     C                     MOVEL*BLANK    $WFSTX           Shift Descripti
     C                     Z-ADD*ZERO     $WWWNB           Head Received 1
     C                     Z-ADD*ZERO     $WX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $WQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $WB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $WCDNB           Head held over
     C                     Z-ADD*ZERO     $WQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $WXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $WXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $WZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $WB5NB           Head Total USR
     C                     Z-ADD*ZERO     $WZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $WZ8NB           Avg Live Wgt Us
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $GHMNB           BOH Company Num
     C                     MOVELA1LLST    $GLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    $GKKTX           Description 30
      * Load related totals format
     C                     Z-ADD*ZERO     $VHSHD           Head Shift w/wg
     C                     Z-ADD*ZERO     $VHWHD           Head held over
     C                     Z-ADD*ZERO     $VHDWT           Head Received w
     C                     MOVEL*BLANK    $VKKTX           Description 30
     C                     Z-ADDA1HMNB    $VHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $VB0DT           TH Kill Date
     C                     MOVELA1LLST    $VLLST           TH Hog Class Ty
     C                     Z-ADD*ZERO     $VWWNB           Head Received 1
     C                     Z-ADD*ZERO     $VX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $VQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $VSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $VSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $VHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $VCDNB           Head held over
     C                     Z-ADD*ZERO     $VQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $VXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $VDXNB           Shift Held Over
     C                     Z-ADD*ZERO     $VMONB           Shift Held over
     C                     Z-ADD*ZERO     $VDYNB           Shift hld avg l
     C                     Z-ADD*ZERO     $VXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $VZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $VB5NB           Head Total USR
     C                     Z-ADD*ZERO     $VZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $VZ8NB           Avg Live Wgt Us
     C                     MOVELA1LIST    $VLIST           TH Schedule Kil
      * USER: Process before print of TH Hog Class Type format
      * CASE: PAR.PD Producer Code is Blank
     C           P1ABCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $HMFTX           Defect Desc Usr
     C                     Z-ADD*ZERO     $HVMNB           Shift held over
     C                     Z-ADDA1HMNB    $HHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $HBONB           BOL Load Number
     C                     MOVEL*BLANK    $HNGST           @Status (Held o
     C                     Z-ADDA1CVNB    $HCVNB           TH Tattoo Numbe
     C                     MOVELA1ABCD    $HABCD           PD Producer Cod
     C                     Z-ADDA1B0DT    $HB0DT           TH Kill Date
     C                     Z-ADDA1AWDT    $HAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $HBICD           TH Group Refere
     C                     MOVELA1CPST    $HCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $HACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $HB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $HCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $HC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $HAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $HA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $HC2ST           TH Resale Sprea
     C                     Z-ADDA1CWNB    $HCWNB           TH Head Receive
     C                     Z-ADDA1GHNB    $HGHNB           TH Commission A
     C                     Z-ADDA1T2HD    $HT2HD           TH Shift Held O
     C                     Z-ADDA1CYNB    $HCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     $HOVNB           Avg Live Wgt Us
     C                     Z-ADDA1ECDT    $HECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $HEDDT           TH Head EUT/KOA
     C                     Z-ADDA1F7NB    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDA1CXNB    $HCXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $HFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     $HCCNB           Yard dead weigh
     C                     Z-ADDA1OXNB    $HOXNB           TH HPS Movement
     C                     Z-ADDA1H9NB    $HH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $HFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $HFENB           TH Head Killed
     C                     Z-ADDA1HENB    $HHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $HHFNB           TH Head Accepte
     C                     Z-ADDA1LRNB    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $HE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $HFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $HA4PC           TH Tot Light Re
     C                     Z-ADDA1HDNB    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $HF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    $HF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $HF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $HF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $HAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    $HAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $HCWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $HA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $HA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $HB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $HAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $HANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $HAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $HAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $HAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $HAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $HASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $HA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $HATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $HA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $HCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    $HCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $HLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $HCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $HA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $HA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $HJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $HCWST           TH Payment Sts
     C                     MOVELA1D7ST    $HD7ST           TH Header Error
     C                     MOVELA1D8ST    $HD8ST           TH Detail Error
     C                     MOVELA1DWST    $HDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $HD6ST           TH Bal to Kill
     C                     Z-ADDA1BYDT    $HBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $HE0ST           TH User Error O
     C                     MOVELA1E1ST    $HE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $HE2ST           TH Sex
     C                     Z-ADDA1BSDT    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $HBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $HBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $HHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $HHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $HHINB           TH FFLI
     C                     Z-ADDA1A3PR    $HA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $HA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $HA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $HJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $HEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $HECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $HEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $HEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $HEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $HEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $HEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $HKAST           TH Source Type
     C                     MOVELA1J7ST    $HJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $HJ9ST           TH Payment Type
     C                     MOVELA1LKST    $HLKST           TH Source Code
     C                     MOVELA1LLST    $HLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $HJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $HLIST           TH Schedule Kil
     C                     MOVELA1LJST    $HLJST           TH Shift Held O
     C                     MOVELA1NZTX    $HNZTX           TH State
     C                     MOVELA1HJCD    $HHJCD           TH Unused Code
     C                     MOVELA1R4ST    $HR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $HR5ST           TH Commission S
     C                     MOVELA1R6ST    $HR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $HR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $HTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $HT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $HTHHD           TH HPS Farm Sit
     C                     Z-ADDA1OBPR    $HOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $HKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $HOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $HOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $HIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $HOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $HOQET           TH PHA Add Type
     C                     MOVELA1URST    $HURST           TH PHA Average
     C                     MOVELA1USST    $HUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $HS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $HTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $HTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $HJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $HKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $HKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $HKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $HKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $HOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $HIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $HIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $HIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $HKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $HOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $HKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $HORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $HOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $HMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $HMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $HNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $HNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $HIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $HKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $HEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $HEBDT           TH Cold Scl Upl
     C                     Z-ADDA1EEDT    $HEEDT           TH Unused Date
     C                     MOVELA1U4ST    $HU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $HU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $HU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $HU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $HU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $HU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $HVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $HVBST           TH Unused Sts 8
     C                     MOVELA1AGCD    $HAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVEL*BLANK    $HNYCD           PS Site ID
     C                     MOVEL*BLANK    $HKTTX           Defect Desc 15
     C                     MOVELA1BECD    $HBECD           HC Class Code
     C                     MOVELA1BDCD    $HBDCD           DF Defect Code
     C                     MOVELA1CSCD    $HCSCD           THP Process Cod
     C                     MOVELA1AECD    $HAECD           PL Location Cod
     C                     MOVELA1ACCD    $HACCD           HB Buyer Code
     C                     MOVELA1AAVN    $HAAVN           RS User Changed
     C                     Z-ADDA1AADT    $HAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $HAMTM           RS Time Changed
     C                     MOVELA1AJST    $HAJST           RS Record Statu
     C                     MOVELA1AHVN    $HAHVN           RS Job
     C                     MOVELA1AGVN    $HAGVN           RS Program
     C                     MOVELA1ABVN    $HABVN           RS User Added
     C                     Z-ADDA1ABDT    $HABDT           RS Date Added
     C                     Z-ADDA1ABTM    $HABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Receiving for Hld PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * Accum DOA, yard dead head, and yard dead wgt, head received
     C                     ADD  $HCXNB    $VHD5U           DOA Head Total
     C                     ADD  $HECDT    $VSRA1           LFT Head Total
     C                     ADD  $HEDDT    $VSSA1           EUT/KOA Head To
     C                     ADD  $HFCNB    $VXRNB           Head Total Sum2
     C                     ADD  $HCCNB    $VZ9NB           Live Weight 3 S
     C                     ADD  $HCYNB    $VX5NB           Live Weight SUM
     C                     ADD  $HCWNB    $VWWNB           Head Received 1
     C                     ADD  $HT2HD    $VDXNB           Shift Held Over
     C                     ADD  $HVMNB    $VMONB           Shift Held over
      * Accum head with live wgt for avg live wgt calc.
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $HCYNB    IFGT *ZERO                      *IF
     C                     ADD  $HCWNB    $VHDWT           Head Received w
     C                     ADD  $HT2HD    $VHSHD           Head Shift w/wg
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1B0DT    WZA002           TH Kill Date
     C                     Z-ADDA1B0DT    WZA002
     C           *LIKE     DEFN A1LIST    WZA003           TH Schedule Kil
     C                     MOVELA1LIST    WZA003
     C           *LIKE     DEFN A1LLST    WZA004           TH Hog Class Ty
     C                     MOVELA1LLST    WZA004
     C           *LIKE     DEFN A1CVNB    WZA005           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPXP                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: DB1.TH Source Type is Internal
     C           A1KAST    IFEQ 'I'                        *IF
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0071  7        *Return code
     C                     PARM A1OXNB    WQ0072  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0073 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0074  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0075  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0076  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * Read by Farm site from the Tattoo Header
     C                     Z-ADDA1THHD    WUETNB           Farm Site USR
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUETNB           Farm Site USR
     C                     END                             *FI
      * If PAR.Load Type is entered, get Load Type from Delivery Tracking
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.DT Load Type is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P9XHST    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * LCL.Kill Date Usr = DB1.TH Kill Date + CON.-5 *DAYS
     C           A1B0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0011
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0011
     C                     END
      * Rtv Load Type for HO  RT - Delivery Tracking  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Kill Date GE PAR.Date From USR
      *   |- c2    : DB1.TH Kill Date LE PAR.Date To   USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1B0DT    IFGE P3B3DT                     *IF
     C           A1B0DT    IFLE P4B4DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH Schedule Kill Shift EQ WRK.Blank USR
      *   |- c2    : PAR.TH Schedule Kill Shift EQ DB1.TH Schedule Kill S
      *   '-
     C           P1LIST    IFEQ WUCRTX                     *IF
     C           P1LIST    OREQ A1LIST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Hog Class Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Hog Class Type EQ PAR.TH Hog Class Type
      *   '-
     C           P1LLST    IFEQ WUCRTX                     *IF
     C           A1LLST    OREQ P1LLST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           A1KAST    OREQ P1KAST                     *OR
      * CASE: Match on farm site
      *  - c1 OR c2
      *   |- c1    : PAR.TH HPS Farm Site EQ WRK.Zero USR
      *   |- c2    : WRK.Farm Site USR EQ PAR.TH HPS Farm Site
      *   '-
     C           P1THHD    IFEQ WUE9NB                     *IF
     C           WUETNB    OREQ P1THHD                     *OR
      * Match on Producer Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PD Producer Code is Blank
      *   |- c2    : PAR.PD Producer Code EQ DB1.PD Producer Code
      *   '-
     C           P1ABCD    IFEQ *BLANK                     *IF
     C           P1ABCD    OREQ A1ABCD                     *OR
      * E11245 JJH 07/21/17 - Add Selection by SR Source Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.SR Source Code is EQ Blank
      *   |- c2    : PAR.SR Source Code EQ DB1.TH Source Code
      *   '-
     C           P8AACD    IFEQ *BLANK                     *IF
     C           P8AACD    OREQ A1LKST                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.DT Load Type is Not Entered
      *   |- c2    : PAR.DT Load Type EQ LCL.DT Load Type
      *   '-
     C           P9XHST    IFEQ *BLANK                     *IF
     C           P9XHST    OREQ YL0012                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL02  1        TH Schedule Kil
     C                     MOVEL*BLANK    W0AL03  1        TH Hog Class Ty
     C                     MOVEL*BLANK    W0AL04  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0AL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1B0DT    IFNE WZA002                     TH Kill Date
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1LIST    IFNE WZA003                     TH Schedule Kil
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1LLST    IFNE WZA004                     TH Hog Class Ty
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           A1CVNB    IFNE WZA005                     TH Tattoo Numbe
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * PRTOBJ calls before print of TH Hog Class Type format
      * Embedded PRTOBJ : Prt Receiving for Sbj PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Receiv f/Shft H/o PO
     C                     EXSR UJSUBR                     Embedded PRTOBJ
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Hog Class Type format
     C                     MOVELWUKKTX    $VKKTX           Description 30
      * CASE: CUR.Head Received w/wgt   SUM is Not 0
     C           $VHDWT    IFNE *ZERO                      *IF
     C           $VX5NB    DIV  $VHDWT    $VQMNB           Avg Live Wgt 2
     C                     END                             *FI
      * If shift 1-- reverse shift held over sign to Negative
      * CASE: WRK.TH Schedule Kill Shift is Shift 1
     C           WULIST    IFEQ '1'                        *IF
     C                     MULT -1        $VDXNB           Shift Held Over
     C                     MULT -1        $VMONB           Shift Held over
     C                     MULT -1        $VHSHD           Head Shift w/wg
     C                     END                             *FI
      * Total Head to Kill
      * CUR.Head Total USR =
      *    *COMPUTE ((x1 + x2) - x3 + x4)
      * x1    : CUR.Head Received 1 SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Head held over        SUM
      * -     : PGM.*Synon (17,7) work field
      * x3    : CUR.Head Total Sum2
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Shift Held Over Head  SUM
     C           $VWWNB    ADD  $VCDNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  $VXRNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $VDXNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $VB5NB           Head Total USR
      * Total Head to Kill w/wgt
      * WRK.Head to Kill w/wgt    USR =
      *    *COMPUTE ((x1 - x2) - x3 + x4)
      * x1    : CUR.Head Received w/wgt   SUM
      * -     : PGM.*Synon (17,7) work field
      * x2    : CUR.Head held over w/wgt  SUM
      * -     : PGM.*Synon (17,7) work field
      * x3    : CUR.Head Total Sum2
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Head Shift w/wgt      SUM
     C           $VHDWT    SUB  $VHWHD    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  $VXRNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $VHSHD    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUKLHD           Head to Kill w/
      * Calc tot_head_to_kill wgt
      * CUR.Live wgt total 11.1   USR =
      *    *COMPUTE (x1 + x2 - x3 + x4)
      * x1    : CUR.Live Weight SUM
      * +     : CUR.Live wgt total 11.1   USR
      * x2    : CUR.Live Weight 2 SUM
      * -     : PGM.*Synon (17,7) work field
      * x3    : CUR.Live Weight 3 SUM
      * +     : PGM.*Synon (17,7) work field
      * x4    : CUR.Shift Held over lv wt SUM
     C           $VX5NB    ADD  $VQLNB    $VZ7NB           Live wgt total
     C           $VZ7NB    SUB  $VZ9NB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  $VMONB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $VZ7NB           Live wgt total
      * Calc Held over avg weight
      * CASE: CUR.Head held over w/wgt  SUM is Not 0
     C           $VHWHD    IFNE *ZERO                      *IF
     C           $VQLNB    DIV  $VHWHD    $VXHNB           Avg Live Wgt Us
     C                     END                             *FI
      * Calc Total_head_to_kill avg wgt
      * CASE: WRK.Head to Kill w/wgt    USR NE WRK.Zero USR
     C           WUKLHD    IFNE WUE9NB                     *IF
     C           $VZ7NB    DIV  WUKLHD    $VZ8NB           Avg Live Wgt Us
     C                     END                             *FI
      * Reverse the sign for Yard deads to print as < - >
     C                     MULT -1        $VXRNB           Head Total Sum2
     C                     MULT -1        $VZ9NB           Live Weight 3 S
      * Calc Shift Held over avg weight
      * CASE: CUR.Head Shift w/wgt      SUM NE WRK.Zero USR
     C           $VHSHD    IFNE WUE9NB                     *IF
     C           $VMONB    DIV  $VHSHD    $VDYNB           Shift hld avg l
     C                     END                             *FI
      * 1/09/03  Create PLAACPP if Market and input parm is Yes
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Status 1 is Yes
      *   |- c2    : CUR.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6P4ST    IFEQ 'Y'                        *IF
     C           $VLLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: CUR.TH Schedule Kill Shift is Shift 1
     C           $VLIST    IFEQ '1'                        *IF
     C                     MOVEL'A'       YL0017           Text Usr 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0017           Text Usr 1
     C                     END                             *FI
      * Rtv Crt Head Kill Sum RT - Head Killed & Cut Summary  * 
     C                     EXSR NBRVGN
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 12
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WULLST    IFEQ 'R'                        *IF
     C           WULLST    OREQ 'S'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$VKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
      * USER: Process after print of TH Hog Class Type format
      * Accum totals for head received that are to be killed
      * CASE: CUR.TH Hog Class Type is Not Resale
     C           $VLLST    IFEQ 'M'                        *IF
     C           $VLLST    OREQ 'S'
     C                     ADD  $VWWNB    $WWWNB           Head Received 1
     C                     ADD  $VX5NB    $WX5NB           Live Weight SUM
     C                     ADD  $VHD5U    $WHD5U           DOA Head Total
     C                     ADD  $VSRA1    $WSRA1           LFT Head Total
     C                     ADD  $VSSA1    $WSSA1           EUT/KOA Head To
     C                     ADD  $VXRNB    $WXRNB           Head Total Sum2
     C                     ADD  $VZ9NB    $WZ9NB           Live Weight 3 S
     C                     ADD  $VHDWT    $WHDWT           Head Received w
     C                     END                             *FI
     C                     ADD  $VCDNB    $WCDNB           Head held over
     C                     ADD  $VQLNB    $WQLNB           Live Weight 2 S
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * USER: On print of TH Schedule Kill Shift format
     C                     MOVELWUFSTX    $WFSTX           Shift Descripti
      * Mention hidden format
     C   99N99             WRITE$WKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * USER: Process after print of TH Schedule Kill Shift format
     C                     ADD  $WHD5U    $XHD5U           DOA Head Total
     C                     ADD  $WHDWT    $XHDWT           Head Received w
     C                     ADD  $WSRA1    $XSRA1           LFT Head Total
     C                     ADD  $WSSA1    $XSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$XKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of TH Kill Date format
     C                     ADD  $XWWNB    $YWWNB           Head Received 1
     C                     ADD  $XX5NB    $YX5NB           Live Weight SUM
     C                     ADD  $XXRNB    $YXRNB           Head Total Sum2
     C                     ADD  $XZ9NB    $YZ9NB           Live Weight 3 S
      * was next susan thinks this should be cur
     C                     ADD  $XHD5U    $YHD5U           DOA Head Total
     C                     ADD  $XHDWT    $YHDWT           Head Received w
     C                     ADD  $XSRA1    $YSRA1           LFT Head Total
     C                     ADD  $XSSA1    $YSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
      * USER: Process after print of BOH Company Number format
     C                     ADD  WUWWNB    $YWWNB           Head Received 1
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * USER: On print of final totals format
      * Mention hidden format
     C   99N99             WRITE$YFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKB04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKB05           TH Kill Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
     C                     KFLD           WQKB05           TH Kill Date
      * Setup key
     C                     Z-ADD$HHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$HBNNB    WQKB02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQKB03           BOL Load Number
     C                     Z-ADD$HCVNB    WQKB04           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    WQKB05           TH Kill Date
      * Establish starting position
     C           KRSB      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $IHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $IBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $IBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $ICVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $IB0DT           TH Kill Date
     C                     MOVELDZBDCD    $IBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $IB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $IANTM           TST Wgt Time
     C                     MOVEL*BLANK    $IJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $ILJNB           TDF Head Defect
     C                     MOVELDZBECD    $IBECD           HC Class Code
     C                     MOVELDZB7SS    $IB7SS           TDF Classificat
     C                     MOVELDZB8SS    $IB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $IB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $ICASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $INXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $INYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $INZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $IAAVN           RS User Changed
     C                     Z-ADDDZAADT    $IAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $IAMTM           RS Time Changed
     C                     MOVELDZAJST    $IAJST           RS Record Statu
     C                     MOVELDZAHVN    $IAHVN           RS Job
     C                     MOVELDZAGVN    $IAGVN           RS Program
     C                     MOVELDZABVN    $IABVN           RS User Added
     C                     Z-ADDDZABDT    $IABDT           RS Date Added
     C                     Z-ADDDZABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZB001           BOH Company Num
     C                     Z-ADDDZHMNB    WZB001
     C           *LIKE     DEFN DZBNNB    WZB002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZB002
     C           *LIKE     DEFN DZBONB    WZB003           BOL Load Number
     C                     Z-ADDDZBONB    WZB003
     C           *LIKE     DEFN DZCVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZB004
     C           *LIKE     DEFN DZB0DT    WZB005           TH Kill Date
     C                     Z-ADDDZB0DT    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR SLRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        TH Kill Date
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           DZBNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           DZBONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           DZCVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           DZB0DT    IFNE WZB005                     TH Kill Date
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Receiving for Hld PO: Mainline
      *================================================================
      * Prt Receiving for Hld PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQKC04           TH Tattoo Numbe
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$HHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$HBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQKC03           BOL Load Number
     C                     Z-ADD$HCVNB    WQKC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSC      SETLL@A1CPVF                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $LSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $LSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $LHWHD           Head held over
     C                     Z-ADD*ZERO     $LHDWT           Head Received w
     C                     Z-ADD*ZERO     $LHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $LQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $LCDNB           Head held over
     C                     Z-ADDWAHMNB    $LHMNB           BOH Company Num
     C                     Z-ADDWACVNB    $LCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     $LWWNB           Head Received 1
     C                     Z-ADD*ZERO     $LX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $LB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $LXRNB           Head Total Sum2
     C                     Z-ADDWAB0DT    $LB0DT           TH Kill Date
     C                     MOVELWALLST    $LLLST           TH Hog Class Ty
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAHMNB    $JHMNB           BOH Company Num
     C                     Z-ADDWABNNB    $JBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    $JBONB           BOL Load Number
     C                     MOVEL*BLANK    $JNGST           @Status (Held o
     C                     Z-ADDWACVNB    $JCVNB           TH Tattoo Numbe
     C                     MOVELWAABCD    $JABCD           PD Producer Cod
     C                     Z-ADDWACWNB    $JCWNB           TH Head Receive
     C                     Z-ADDWAT2HD    $JT2HD           TH Shift Held O
     C                     Z-ADDWAGHNB    $JGHNB           TH Commission A
     C                     Z-ADDWACYNB    $JCYNB           TH Live Wgt
     C                     Z-ADDWAF7NB    $JF7NB           TH Avg Live Wgt
     C                     Z-ADDWAECDT    $JECDT           TH Head LFT
     C                     Z-ADDWAEDDT    $JEDDT           TH Head EUT/KOA
     C                     Z-ADDWACXNB    $JCXNB           TH Dead On Arri
     C                     Z-ADDWAFCNB    $JFCNB           TH Yard Deads
     C                     Z-ADDWAOXNB    $JOXNB           TH HPS Movement
     C                     MOVELWAAGCD    $JAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $JKQTX           Farm site Name
     C                     MOVEL*BLANK    $JNYCD           PS Site ID
     C                     MOVEL*BLANK    $JKTTX           Defect Desc 15
     C                     Z-ADD*ZERO     $JCCNB           Yard dead weigh
     C                     Z-ADDWAB0DT    $JB0DT           TH Kill Date
     C                     Z-ADDWAAWDT    $JAWDT           TH Purchase Dat
     C                     MOVELWABICD    $JBICD           TH Group Refere
     C                     MOVELWACPST    $JCPST           TH Live Purchas
     C                     Z-ADDWAACPR    $JACPR           TH Live Purchas
     C                     Z-ADDWAB9PR    $JB9PR           TH Live Gross A
     C                     Z-ADDWACAPR    $JCAPR           TH LIve Net Amt
     C                     MOVELWAC4ST    $JC4ST           TH Resale UOM
     C                     Z-ADDWAAIPR    $JAIPR           TH Recalc Live
     C                     Z-ADDWAA6DT    $JA6DT           TH Pricing Date
     C                     MOVELWAC2ST    $JC2ST           TH Resale Sprea
     C                     Z-ADDWAH9NB    $JH9NB           TH Held Over
     C                     Z-ADDWAFDNB    $JFDNB           TH Head Condemn
     C                     Z-ADDWAFENB    $JFENB           TH Head Killed
     C                     Z-ADDWAHENB    $JHENB           TH Head Adds
     C                     Z-ADDWAHFNB    $JHFNB           TH Head Accepte
     C                     Z-ADDWALRNB    $JLRNB           TH Adj Live Wgt
     C                     Z-ADDWAE0NB    $JE0NB           TH Hot Wgt
     C                     Z-ADDWAA5PC    $JA5PC           TH Tot Loin Eye
     C                     Z-ADDWAFBNB    $JFBNB           TH Tot Backfat
     C                     Z-ADDWAA4PC    $JA4PC           TH Tot Light Re
     C                     Z-ADDWAHDNB    $JHDNB           TH Avg Hot Wgt
     C                     Z-ADDWAF5NB    $JF5NB           TH Avg Light Re
     C                     Z-ADDWAF4NB    $JF4NB           TH Avg Lean Per
     C                     Z-ADDWAF3NB    $JF3NB           TH Avg Loin Eye
     C                     Z-ADDWAF2NB    $JF2NB           TH Avg Backfat
     C                     Z-ADDWAAVPC    $JAVPC           TH Std Yield Pe
     C                     Z-ADDWAAWPC    $JAWPC           TH Actual Yield
     C                     Z-ADDWACWPC    $JCWPC           TH Adj Actual Y
     C                     Z-ADDWAA8PC    $JA8PC           TH Yield Differ
     C                     Z-ADDWAA7PC    $JA7PC           TH Recalc Live
     C                     Z-ADDWAB8PR    $JB8PR           TH CM Market Pr
     C                     Z-ADDWAAMPR    $JAMPR           TH CM Base Mkt
     C                     Z-ADDWAANPR    $JANPR           TH CM Base Mkt
     C                     Z-ADDWAAYVA    $JAYVA           TH CM Sort Disc
     C                     Z-ADDWAAWVA    $JAWVA           TH CM Yield Gai
     C                     Z-ADDWAAOPR    $JAOPR           TH CM Base Carc
     C                     Z-ADDWAAXVA    $JAXVA           TH CM LN AddOn/
     C                     Z-ADDWAAPPR    $JAPPR           TH CM Carcass G
     C                     Z-ADDWAASPR    $JASPR           TH Deduction Am
     C                     Z-ADDWAA4VA    $JA4VA           TH Total Net WO
     C                     Z-ADDWAATPR    $JATPR           TH Carcass Net
     C                     Z-ADDWAA5VA    $JA5VA           TH Additions Am
     C                     Z-ADDWACBPR    $JCBPR           TH Payment Gros
     C                     Z-ADDWACCPR    $JCCPR           Th Payment Net
     C                     Z-ADDWALPNB    $JLPNB           TH AP Voucher/D
     C                     Z-ADDWACDPR    $JCDPR           TH Freight Amou
     C                     Z-ADDWAA7VA    $JA7VA           TH Accrual Amou
     C                     Z-ADDWAA2PR    $JA2PR           TH Fixed Cost A
     C                     MOVELWAJWST    $JJWST           TH Calc Net Sts
     C                     MOVELWACWST    $JCWST           TH Payment Sts
     C                     MOVELWAD7ST    $JD7ST           TH Header Error
     C                     MOVELWAD8ST    $JD8ST           TH Detail Error
     C                     MOVELWADWST    $JDWST           TH Kill Balanci
     C                     MOVELWAD6ST    $JD6ST           TH Bal to Kill
     C                     Z-ADDWABYDT    $JBYDT           TH Voucher Paym
     C                     MOVELWAE0ST    $JE0ST           TH User Error O
     C                     MOVELWAE1ST    $JE1ST           TH Held Over Re
     C                     MOVELWAE2ST    $JE2ST           TH Sex
     C                     Z-ADDWABSDT    $JBSDT           TH Held/Ovr Com
     C                     Z-ADDWABTDT    $JBTDT           TH Commission P
     C                     Z-ADDWABUDT    $JBUDT           TH Actual Check
     C                     Z-ADDWAHGNB    $JHGNB           TH Shipped Weig
     C                     Z-ADDWAHHNB    $JHHNB           TH Avg Hot Wgt
     C                     Z-ADDWAHINB    $JHINB           TH FFLI
     C                     Z-ADDWAA3PR    $JA3PR           TH Kill Product
     C                     Z-ADDWAA4PR    $JA4PR           TH Cut Product
     C                     Z-ADDWAA6PR    $JA6PR           TH Render Produ
     C                     Z-ADDWAJ9NB    $JJ9NB           TH Head Exclude
     C                     Z-ADDWAD6PR    $JD6PR           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    $JD7PR           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    $JD8PR           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    $JD9PR           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    $JEAPR           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    $JEBPR           TH CM Yld G/L C
     C                     Z-ADDWAECPR    $JECPR           TH CM Crc Val L
     C                     Z-ADDWAEDPR    $JEDPR           TH CM Crc Val C
     C                     Z-ADDWAEEPR    $JEEPR           TH CM Lean Prem
     C                     Z-ADDWAEFPR    $JEFPR           TH CM Lean Prem
     C                     Z-ADDWAEGPR    $JEGPR           TH CM Gross Liv
     C                     Z-ADDWAEHPR    $JEHPR           TH CM Gross Car
     C                     MOVELWAKAST    $JKAST           TH Source Type
     C                     MOVELWAJ7ST    $JJ7ST           TH Scale Ticket
     C                     MOVELWAJ9ST    $JJ9ST           TH Payment Type
     C                     MOVELWALKST    $JLKST           TH Source Code
     C                     MOVELWALLST    $JLLST           TH Hog Class Ty
     C                     MOVELWAJ8ST    $JJ8ST           TH Posted to HP
     C                     MOVELWALIST    $JLIST           TH Schedule Kil
     C                     MOVELWALJST    $JLJST           TH Shift Held O
     C                     MOVELWANZTX    $JNZTX           TH State
     C                     MOVELWAHJCD    $JHJCD           TH Unused Code
     C                     MOVELWAR4ST    $JR4ST           TH Unused Sts 2
     C                     MOVELWAR5ST    $JR5ST           TH Commission S
     C                     MOVELWAR6ST    $JR6ST           TH Paid 2 Week
     C                     MOVELWAR7ST    $JR7ST           TH Unused Sts 1
     C                     Z-ADDWATHWT    $JTHWT           TH DOA Weight
     C                     Z-ADDWAT2WT    $JT2WT           TH Avg Lean % E
     C                     Z-ADDWATHHD    $JTHHD           TH HPS Farm Sit
     C                     Z-ADDWAOBPR    $JOBPR           TH Sorting Amou
     C                     Z-ADDWAKOER    $JKOER           TH Head Identif
     C                     Z-ADDWAOPIR    $JOPIR           TH Percent Iden
     C                     Z-ADDWAOPEM    $JOPEM           TH Percent Acce
     C                     Z-ADDWAIORP    $JIORP           TH Head Adjuste
     C                     Z-ADDWAOWEO    $JOWEO           TH PHA Head Add
     C                     MOVELWAOQET    $JOQET           TH PHA Add Type
     C                     MOVELWAURST    $JURST           TH PHA Average
     C                     MOVELWAUSST    $JUSST           TH PHA Add Reas
     C                     Z-ADDWAHHPC    $JHHPC           TH PHA Yield Pe
     C                     Z-ADDWAS9PR    $JS9PR           TH PHA Lean Prm
     C                     Z-ADDWATAPR    $JTAPR           TH VC Gross Val
     C                     Z-ADDWATBPR    $JTBPR           TH Excluded Gro
     C                     Z-ADDWAJFUR    $JJFUR           TH Avg Lean %
     C                     Z-ADDWAKRIF    $JKRIF           TH Broken Back
     C                     Z-ADDWAKORF    $JKORF           TH Hot Scl Uplo
     C                     Z-ADDWAKAPR    $JKAPR           TH Unused Nbr 4
     C                     Z-ADDWAKROT    $JKROT           TH Excluded Car
     C                     Z-ADDWAOTJG    $JOTJG           TH Excluded Pre
     C                     Z-ADDWAIRJG    $JIRJG           TH Unused Nbr 7
     C                     Z-ADDWAIMJF    $JIMJF           TH Unused Nbr 8
     C                     Z-ADDWAIRGF    $JIRGF           TH Unused Nbr 9
     C                     Z-ADDWAKRJF    $JKRJF           TH Unused Nbr 1
     C                     Z-ADDWAOJRF    $JOJRF           TH Break Even P
     C                     Z-ADDWAKFOR    $JKFOR           TH Meat Value F
     C                     Z-ADDWAORJK    $JORJK           TH Yld Parm Adj
     C                     Z-ADDWAOMVJ    $JOMVJ           TH PHA Sort Dis
     C                     Z-ADDWAMVNF    $JMVNF           TH Avg Loin Eye
     C                     Z-ADDWAMCNF    $JMCNF           TH Avg Backfat
     C                     Z-ADDWANCNF    $JNCNF           TH HITCH Old Pa
     C                     Z-ADDWANCHF    $JNCHF           TH MPR Sort Los
     C                     Z-ADDWAIGIR    $JIGIR           TH Unused Nbr 1
     C                     Z-ADDWAKFJR    $JKFJR           TH Unused Nbr 2
     C                     Z-ADDWAEADT    $JEADT           TH Cold Scl Upl
     C                     Z-ADDWAEBDT    $JEBDT           TH Cold Scl Upl
     C                     Z-ADDWAEEDT    $JEEDT           TH Unused Date
     C                     MOVELWAU4ST    $JU4ST           TH Unused Sts 1
     C                     MOVELWAU5ST    $JU5ST           TH Unused Sts 2
     C                     MOVELWAU6ST    $JU6ST           TH Unused Sts 3
     C                     MOVELWAU7ST    $JU7ST           TH Unused Sts 4
     C                     MOVELWAU8ST    $JU8ST           TH Unused Sts 5
     C                     MOVELWAU9ST    $JU9ST           TH Unused Sts 6
     C                     MOVELWAVAST    $JVAST           TH Unused Sts 7
     C                     MOVELWAVBST    $JVBST           TH Unused Sts 8
     C                     MOVELWABECD    $JBECD           HC Class Code
     C                     MOVELWABDCD    $JBDCD           DF Defect Code
     C                     MOVELWACSCD    $JCSCD           THP Process Cod
     C                     MOVELWAAECD    $JAECD           PL Location Cod
     C                     MOVELWAACCD    $JACCD           HB Buyer Code
     C                     MOVELWAAAVN    $JAAVN           RS User Changed
     C                     Z-ADDWAAADT    $JAADT           RS Date Changed
     C                     Z-ADDWAAMTM    $JAMTM           RS Time Changed
     C                     MOVELWAAJST    $JAJST           RS Record Statu
     C                     MOVELWAAHVN    $JAHVN           RS Job
     C                     MOVELWAAGVN    $JAGVN           RS Program
     C                     MOVELWAABVN    $JABVN           RS User Added
     C                     Z-ADDWAABDT    $JABDT           RS Date Added
     C                     Z-ADDWAABTM    $JABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $JCWNB    $LWWNB           Head Received 1
     C                     ADD  $JCYNB    $LX5NB           Live Weight SUM
     C                     ADD  $JFCNB    $LXRNB           Head Total Sum2
     C                     ADD  $JCWNB    $LCDNB           Head held over
     C                     ADD  $JCYNB    $LQLNB           Live Weight 2 S
     C                     ADD  $JCXNB    $LHD5U           DOA Head Total
      * Accum head with live wgt for avg live wgt calc.
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $JCYNB    IFGT *ZERO                      *IF
     C                     ADD  $JCWNB    $LHDWT           Head Received w
     C                     ADD  $JCWNB    $LHWHD           Head held over
     C                     END                             *FI
     C                     ADD  $JECDT    $LSRA1           LFT Head Total
     C                     ADD  $JEDDT    $LSSA1           EUT/KOA Head To
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAHMNB    WZC001           BOH Company Num
     C                     Z-ADDWAHMNB    WZC001
     C           *LIKE     DEFN WABNNB    WZC002           BOH Buy Order N
     C                     Z-ADDWABNNB    WZC002
     C           *LIKE     DEFN WABONB    WZC003           BOL Load Number
     C                     Z-ADDWABONB    WZC003
     C           *LIKE     DEFN WACVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDWACVNB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@A1CPVF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WAHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WABNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WABONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WACVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
      * USER: Process after print of TH Tattoo Number format
      * Accums for Received Head  totals
     C                     ADD  $LWWNB    $VWWNB           Head Received 1
     C                     ADD  $LX5NB    $VX5NB           Live Weight SUM
     C                     ADD  $LHD5U    $VHD5U           DOA Head Total
     C                     ADD  $LXRNB    $VXRNB           Head Total Sum2
     C                     ADD  $LHDWT    $VHDWT           Head Received w
     C                     ADD  $LHWHD    $VHWHD           Head held over
      * Subtract from Accums for Less/Add Held Over totals
     C                     SUB  $LWWNB    $VCDNB           Head held over
     C                     SUB  $LX5NB    $VQLNB           Live Weight 2 S
     C                     ADD  $LSRA1    $VSRA1           LFT Head Total
     C                     ADD  $LSSA1    $VSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKD01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKD02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKD03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKD04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKD05           TH Kill Date
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           BOH Buy Order N
     C                     KFLD           WQKD03           BOL Load Number
     C                     KFLD           WQKD04           TH Tattoo Numbe
     C                     KFLD           WQKD05           TH Kill Date
      * Setup key
     C                     Z-ADD$JHMNB    WQKD01           BOH Company Num
     C                     Z-ADD$JBNNB    WQKD02           BOH Buy Order N
     C                     Z-ADD$JBONB    WQKD03           BOL Load Number
     C                     Z-ADD$JCVNB    WQKD04           TH Tattoo Numbe
     C                     Z-ADD$JB0DT    WQKD05           TH Kill Date
      * Establish starting position
     C           KRSD      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $KHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $KBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $KBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $KCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $KB0DT           TH Kill Date
     C                     MOVELDZBDCD    $KBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $KB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $KANTM           TST Wgt Time
     C                     MOVEL*BLANK    $KJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $KLJNB           TDF Head Defect
     C                     MOVELDZBECD    $KBECD           HC Class Code
     C                     MOVELDZB7SS    $KB7SS           TDF Classificat
     C                     MOVELDZB8SS    $KB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $KB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $KCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $KNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $KNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $KNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $KAAVN           RS User Changed
     C                     Z-ADDDZAADT    $KAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $KAMTM           RS Time Changed
     C                     MOVELDZAJST    $KAJST           RS Record Statu
     C                     MOVELDZAHVN    $KAHVN           RS Job
     C                     MOVELDZAGVN    $KAGVN           RS Program
     C                     MOVELDZABVN    $KABVN           RS User Added
     C                     Z-ADDDZABDT    $KABDT           RS Date Added
     C                     Z-ADDDZABTM    $KABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZD001           BOH Company Num
     C                     Z-ADDDZHMNB    WZD001
     C           *LIKE     DEFN DZBNNB    WZD002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZD002
     C           *LIKE     DEFN DZBONB    WZD003           BOL Load Number
     C                     Z-ADDDZBONB    WZD003
     C           *LIKE     DEFN DZCVNB    WZD004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZD004
     C           *LIKE     DEFN DZB0DT    WZD005           TH Kill Date
     C                     Z-ADDDZB0DT    WZD005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR SVRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0DL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0DL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0DL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0DL04  1        TH Kill Date
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZD001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           DZBNNB    IFNE WZD002                     BOH Buy Order N
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           DZBONB    IFNE WZD003                     BOL Load Number
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           DZCVNB    IFNE WZD004                     TH Tattoo Numbe
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           DZB0DT    IFNE WZD005                     TH Kill Date
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt Receiving for Sbj PO: Mainline
      *================================================================
      * Prt Receiving for Sbj PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKE01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQKE02           TH Kill Date
     C           *LIKE     DEFN WBLIST    WQKE03           TH Schedule Kil
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           BOH Company Num
     C                     KFLD           WQKE02           TH Kill Date
     C                     KFLD           WQKE03           TH Schedule Kil
      * Setup key
     C                     Z-ADDP1HMNB    WQKE01           BOH Company Num
     C                     Z-ADDWUB0DT    WQKE02           TH Kill Date
     C                     MOVELWULIST    WQKE03           TH Schedule Kil
      * Establish starting position
     C           KRSE      SETLL@A1CPXQ                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        TH Kill Date
     C                     MOVEL'Y'       W0EL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0EL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0EL04  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $OSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $OSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $OHDWT           Head Received w
     C                     Z-ADD*ZERO     $OHD5U           DOA Head Total
     C                     Z-ADDWBHMNB    $OHMNB           BOH Company Num
     C                     Z-ADDWBB0DT    $OB0DT           TH Kill Date
     C                     MOVELWBLLST    $OLLST           TH Hog Class Ty
     C                     Z-ADD*ZERO     $OWWNB           Head Received 1
     C                     Z-ADD*ZERO     $OX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $OB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $OXRNB           Head Total Sum2
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
     C           W0EL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP04  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $MHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $MBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $MBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $MCVNB           TH Tattoo Numbe
     C                     MOVELWBABCD    $MABCD           PD Producer Cod
     C                     Z-ADDWBCWNB    $MCWNB           TH Head Receive
     C                     Z-ADDWBT2HD    $MT2HD           TH Shift Held O
     C                     Z-ADDWBGHNB    $MGHNB           TH Commission A
     C                     Z-ADDWBCYNB    $MCYNB           TH Live Wgt
     C                     Z-ADDWBF7NB    $MF7NB           TH Avg Live Wgt
     C                     Z-ADDWBECDT    $MECDT           TH Head LFT
     C                     Z-ADDWBEDDT    $MEDDT           TH Head EUT/KOA
     C                     Z-ADDWBCXNB    $MCXNB           TH Dead On Arri
     C                     Z-ADDWBFCNB    $MFCNB           TH Yard Deads
     C                     Z-ADDWBOXNB    $MOXNB           TH HPS Movement
     C                     MOVELWBAGCD    $MAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $MKQTX           Farm site Name
     C                     MOVEL*BLANK    $MNYCD           PS Site ID
     C                     MOVEL*BLANK    $MKTTX           Defect Desc 15
     C                     Z-ADD*ZERO     $MCCNB           Yard dead weigh
     C                     Z-ADDWBB0DT    $MB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    $MAWDT           TH Purchase Dat
     C                     MOVELWBBICD    $MBICD           TH Group Refere
     C                     MOVELWBCPST    $MCPST           TH Live Purchas
     C                     Z-ADDWBACPR    $MACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $MB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $MCAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    $MC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $MAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    $MA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $MC2ST           TH Resale Sprea
     C                     Z-ADDWBH9NB    $MH9NB           TH Held Over
     C                     Z-ADDWBFDNB    $MFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    $MFENB           TH Head Killed
     C                     Z-ADDWBHENB    $MHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $MHFNB           TH Head Accepte
     C                     Z-ADDWBLRNB    $MLRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    $ME0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $MA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $MFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $MA4PC           TH Tot Light Re
     C                     Z-ADDWBHDNB    $MHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $MF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $MF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $MF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $MF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $MAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $MAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    $MCWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $MA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $MA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $MB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $MAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $MANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $MAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $MAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $MAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $MAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $MAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $MASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $MA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $MATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $MA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    $MCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    $MCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    $MLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    $MCDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    $MA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $MA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $MJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $MCWST           TH Payment Sts
     C                     MOVELWBD7ST    $MD7ST           TH Header Error
     C                     MOVELWBD8ST    $MD8ST           TH Detail Error
     C                     MOVELWBDWST    $MDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $MD6ST           TH Bal to Kill
     C                     Z-ADDWBBYDT    $MBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $ME0ST           TH User Error O
     C                     MOVELWBE1ST    $ME1ST           TH Held Over Re
     C                     MOVELWBE2ST    $ME2ST           TH Sex
     C                     Z-ADDWBBSDT    $MBSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    $MBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $MBUDT           TH Actual Check
     C                     Z-ADDWBHGNB    $MHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    $MHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $MHINB           TH FFLI
     C                     Z-ADDWBA3PR    $MA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $MA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $MA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $MJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $MD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $MD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $MD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $MD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $MEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $MEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $MECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $MEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $MEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $MEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $MEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $MEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $MKAST           TH Source Type
     C                     MOVELWBJ7ST    $MJ7ST           TH Scale Ticket
     C                     MOVELWBJ9ST    $MJ9ST           TH Payment Type
     C                     MOVELWBLKST    $MLKST           TH Source Code
     C                     MOVELWBLLST    $MLLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    $MJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $MLIST           TH Schedule Kil
     C                     MOVELWBLJST    $MLJST           TH Shift Held O
     C                     MOVELWBNZTX    $MNZTX           TH State
     C                     MOVELWBHJCD    $MHJCD           TH Unused Code
     C                     MOVELWBR4ST    $MR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $MR5ST           TH Commission S
     C                     MOVELWBR6ST    $MR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $MR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $MTHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $MT2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $MTHHD           TH HPS Farm Sit
     C                     Z-ADDWBOBPR    $MOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $MKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $MOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $MOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $MIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $MOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $MOQET           TH PHA Add Type
     C                     MOVELWBURST    $MURST           TH PHA Average
     C                     MOVELWBUSST    $MUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $MHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $MS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $MTAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $MTBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $MJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $MKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $MKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $MKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $MKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $MOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $MIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $MIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $MIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $MKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $MOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $MKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $MORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $MOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $MMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $MMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $MNCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $MNCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $MIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $MKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $MEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $MEBDT           TH Cold Scl Upl
     C                     Z-ADDWBEEDT    $MEEDT           TH Unused Date
     C                     MOVELWBU4ST    $MU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $MU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $MU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $MU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $MU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $MU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $MVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $MVBST           TH Unused Sts 8
     C                     MOVELWBBECD    $MBECD           HC Class Code
     C                     MOVELWBBDCD    $MBDCD           DF Defect Code
     C                     MOVELWBCSCD    $MCSCD           THP Process Cod
     C                     MOVELWBAECD    $MAECD           PL Location Cod
     C                     MOVELWBACCD    $MACCD           HB Buyer Code
     C                     MOVELWBAAVN    $MAAVN           RS User Changed
     C                     Z-ADDWBAADT    $MAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $MAMTM           RS Time Changed
     C                     MOVELWBAJST    $MAJST           RS Record Statu
     C                     MOVELWBAHVN    $MAHVN           RS Job
     C                     MOVELWBAGVN    $MAGVN           RS Program
     C                     MOVELWBABVN    $MABVN           RS User Added
     C                     Z-ADDWBABDT    $MABDT           RS Date Added
     C                     Z-ADDWBABTM    $MABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $MCWNB    $OWWNB           Head Received 1
     C                     ADD  $MCYNB    $OX5NB           Live Weight SUM
     C                     ADD  $MFCNB    $OXRNB           Head Total Sum2
     C                     ADD  $MCXNB    $OHD5U           DOA Head Total
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $MCYNB    IFGT *ZERO                      *IF
     C                     ADD  $MCWNB    $OHDWT           Head Received w
     C                     END                             *FI
     C                     ADD  $OSRA1    $OSRA1           LFT Head Total
     C                     ADD  $OSSA1    $OSSA1           EUT/KOA Head To
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZE001           BOH Company Num
     C                     Z-ADDWBHMNB    WZE001
     C           *LIKE     DEFN WBB0DT    WZE002           TH Kill Date
     C                     Z-ADDWBB0DT    WZE002
     C           *LIKE     DEFN WBLIST    WZE003           TH Schedule Kil
     C                     MOVELWBLIST    WZE003
     C           *LIKE     DEFN WBLLST    WZE004           TH Hog Class Ty
     C                     MOVELWBLLST    WZE004
     C           *LIKE     DEFN WBCVNB    WZE005           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZE005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@A1CPXQ                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Hog Class Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Hog Class Type EQ PAR.TH Hog Class Type
      *   '-
     C           P1LLST    IFEQ WUCRTX                     *IF
     C           WBLLST    OREQ P1LLST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           WBKAST    OREQ P1KAST                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH HPS Farm Site EQ WRK.Zero USR
      *   |- c2    : DB1.TH HPS Farm Site EQ PAR.TH HPS Farm Site
      *   '-
     C           P1THHD    IFEQ WUE9NB                     *IF
     C           WBTHHD    OREQ P1THHD                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PD Producer Code is Blank
      *   |- c2    : PAR.PD Producer Code EQ DB1.PD Producer Code
      *   '-
     C           P1ABCD    IFEQ *BLANK                     *IF
     C           P1ABCD    OREQ WBABCD                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0EL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0EL02  1        TH Schedule Kil
     C                     MOVEL*BLANK    W0EL03  1        TH Hog Class Ty
     C                     MOVEL*BLANK    W0EL04  1        TH Tattoo Numbe
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        TH Kill Date
     C                     MOVEL'Y'       W0EL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0EL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0EL04  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZE001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           WBB0DT    IFNE WZE002                     TH Kill Date
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           WBLIST    IFNE WZE003                     TH Schedule Kil
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           WBLLST    IFNE WZE004                     TH Hog Class Ty
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C           WBCVNB    IFNE WZE005                     TH Tattoo Numbe
     C           W0EL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL04
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP04
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$OKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
      * USER: Process after print of TH Hog Class Type format
     C                     ADD  $OWWNB    $VWWNB           Head Received 1
     C                     ADD  $OX5NB    $VX5NB           Live Weight SUM
     C                     ADD  $OHD5U    $VHD5U           DOA Head Total
     C                     ADD  $OXRNB    $VXRNB           Head Total Sum2
     C                     ADD  $OHDWT    $VHDWT           Head Received w
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKF01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKF02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKF03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKF04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKF05           TH Kill Date
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           BOH Company Num
     C                     KFLD           WQKF02           BOH Buy Order N
     C                     KFLD           WQKF03           BOL Load Number
     C                     KFLD           WQKF04           TH Tattoo Numbe
     C                     KFLD           WQKF05           TH Kill Date
      * Setup key
     C                     Z-ADD$MHMNB    WQKF01           BOH Company Num
     C                     Z-ADD$MBNNB    WQKF02           BOH Buy Order N
     C                     Z-ADD$MBONB    WQKF03           BOL Load Number
     C                     Z-ADD$MCVNB    WQKF04           TH Tattoo Numbe
     C                     Z-ADD$OB0DT    WQKF05           TH Kill Date
      * Establish starting position
     C           KRSF      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        BOH Company Num
     C                     MOVEL'Y'       W0FL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0FL02  1        BOL Load Number
     C                     MOVEL'Y'       W0FL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0FL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP02  1
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP03  1
     C                     END
      *
     C           W0FL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP04  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $NHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $NBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $NBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $NCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $NB0DT           TH Kill Date
     C                     MOVELDZBDCD    $NBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $NB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $NANTM           TST Wgt Time
     C                     MOVEL*BLANK    $NJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $NLJNB           TDF Head Defect
     C                     MOVELDZBECD    $NBECD           HC Class Code
     C                     MOVELDZB7SS    $NB7SS           TDF Classificat
     C                     MOVELDZB8SS    $NB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $NB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $NCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $NNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $NNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $NNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $NAAVN           RS User Changed
     C                     Z-ADDDZAADT    $NAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $NAMTM           RS Time Changed
     C                     MOVELDZAJST    $NAJST           RS Record Statu
     C                     MOVELDZAHVN    $NAHVN           RS Job
     C                     MOVELDZAGVN    $NAGVN           RS Program
     C                     MOVELDZABVN    $NABVN           RS User Added
     C                     Z-ADDDZABDT    $NABDT           RS Date Added
     C                     Z-ADDDZABTM    $NABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZF001           BOH Company Num
     C                     Z-ADDDZHMNB    WZF001
     C           *LIKE     DEFN DZBNNB    WZF002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZF002
     C           *LIKE     DEFN DZBONB    WZF003           BOL Load Number
     C                     Z-ADDDZBONB    WZF003
     C           *LIKE     DEFN DZCVNB    WZF004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZF004
     C           *LIKE     DEFN DZB0DT    WZF005           TH Kill Date
     C                     Z-ADDDZB0DT    WZF005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR TGRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0FL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0FL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0FL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0FL04  1        TH Kill Date
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        BOH Company Num
     C                     MOVEL'Y'       W0FL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0FL02  1        BOL Load Number
     C                     MOVEL'Y'       W0FL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0FL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZF001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           DZBNNB    IFNE WZF002                     BOH Buy Order N
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C           DZBONB    IFNE WZF003                     BOL Load Number
     C           W0FL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL02
     C                     END
     C           DZCVNB    IFNE WZF004                     TH Tattoo Numbe
     C           W0FL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL03
     C                     END
     C           DZB0DT    IFNE WZF005                     TH Kill Date
     C           W0FL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL04
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP04
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP03
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP02
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * Prt Receiv f/Shft H/o PO: Mainline
      *================================================================
      * Prt Receiv f/Shft H/o PO: Initialise
     C                     EXSR ZGINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQKG01           BOH Company Num
     C           *LIKE     DEFN WCB0DT    WQKG02           TH Kill Date
     C           *LIKE     DEFN WCLIST    WQKG03           TH Schedule Kil
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           BOH Company Num
     C                     KFLD           WQKG02           TH Kill Date
     C                     KFLD           WQKG03           TH Schedule Kil
      * Setup key
     C                     Z-ADDP1HMNB    WQKG01           BOH Company Num
     C                     Z-ADDWUB0DT    WQKG02           TH Kill Date
     C                     MOVEL'1'       WQKG03           TH Schedule Kil
      * Establish starting position
     C           KRSG      SETLL@A1CPX9                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        BOH Company Num
     C                     MOVEL'Y'       W0GL01  1        TH Kill Date
     C                     MOVEL'Y'       W0GL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0GL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0GL04  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP02  1
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $UHDWT           Head Received w
     C                     Z-ADD*ZERO     $UHWHD           Head held over
     C                     Z-ADD*ZERO     $UHSHD           Head Shift w/wg
     C                     Z-ADD*ZERO     $UQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $UCDNB           Head held over
     C                     Z-ADD*ZERO     $UMONB           Shift Held over
     C                     Z-ADD*ZERO     $UDXNB           Shift Held Over
     C                     Z-ADD*ZERO     $UHD5U           DOA Head Total
     C                     Z-ADDWCHMNB    $UHMNB           BOH Company Num
     C                     Z-ADDWCB0DT    $UB0DT           TH Kill Date
     C                     MOVELWCLLST    $ULLST           TH Hog Class Ty
     C                     Z-ADD*ZERO     $UWWNB           Head Received 1
     C                     Z-ADD*ZERO     $UX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $UB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $UXRNB           Head Total Sum2
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP03  1
     C                     END
      *
     C           W0GL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP04  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCHMNB    $PHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    $PBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    $PBONB           BOL Load Number
     C                     MOVEL*BLANK    $PNGST           @Status (Held o
     C                     Z-ADDWCCVNB    $PCVNB           TH Tattoo Numbe
     C                     MOVELWCABCD    $PABCD           PD Producer Cod
     C                     Z-ADDWCCWNB    $PCWNB           TH Head Receive
     C                     Z-ADDWCT2HD    $PT2HD           TH Shift Held O
     C                     Z-ADDWCGHNB    $PGHNB           TH Commission A
     C                     Z-ADD*ZERO     $PVMNB           Shift held over
     C                     Z-ADDWCCYNB    $PCYNB           TH Live Wgt
     C                     Z-ADDWCF7NB    $PF7NB           TH Avg Live Wgt
     C                     Z-ADDWCECDT    $PECDT           TH Head LFT
     C                     Z-ADDWCEDDT    $PEDDT           TH Head EUT/KOA
     C                     Z-ADDWCCXNB    $PCXNB           TH Dead On Arri
     C                     Z-ADDWCFCNB    $PFCNB           TH Yard Deads
     C                     Z-ADDWCOXNB    $POXNB           TH HPS Movement
     C                     MOVELWCAGCD    $PAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $PKQTX           Farm site Name
     C                     MOVEL*BLANK    $PNYCD           PS Site ID
     C                     MOVEL*BLANK    $PKTTX           Defect Desc 15
     C                     Z-ADD*ZERO     $PCCNB           Yard dead weigh
     C                     Z-ADDWCB0DT    $PB0DT           TH Kill Date
     C                     Z-ADDWCAWDT    $PAWDT           TH Purchase Dat
     C                     MOVELWCBICD    $PBICD           TH Group Refere
     C                     MOVELWCCPST    $PCPST           TH Live Purchas
     C                     Z-ADDWCACPR    $PACPR           TH Live Purchas
     C                     Z-ADDWCB9PR    $PB9PR           TH Live Gross A
     C                     Z-ADDWCCAPR    $PCAPR           TH LIve Net Amt
     C                     MOVELWCC4ST    $PC4ST           TH Resale UOM
     C                     Z-ADDWCAIPR    $PAIPR           TH Recalc Live
     C                     Z-ADDWCA6DT    $PA6DT           TH Pricing Date
     C                     MOVELWCC2ST    $PC2ST           TH Resale Sprea
     C                     Z-ADDWCH9NB    $PH9NB           TH Held Over
     C                     Z-ADDWCFDNB    $PFDNB           TH Head Condemn
     C                     Z-ADDWCFENB    $PFENB           TH Head Killed
     C                     Z-ADDWCHENB    $PHENB           TH Head Adds
     C                     Z-ADDWCHFNB    $PHFNB           TH Head Accepte
     C                     Z-ADDWCLRNB    $PLRNB           TH Adj Live Wgt
     C                     Z-ADDWCE0NB    $PE0NB           TH Hot Wgt
     C                     Z-ADDWCA5PC    $PA5PC           TH Tot Loin Eye
     C                     Z-ADDWCFBNB    $PFBNB           TH Tot Backfat
     C                     Z-ADDWCA4PC    $PA4PC           TH Tot Light Re
     C                     Z-ADDWCHDNB    $PHDNB           TH Avg Hot Wgt
     C                     Z-ADDWCF5NB    $PF5NB           TH Avg Light Re
     C                     Z-ADDWCF4NB    $PF4NB           TH Avg Lean Per
     C                     Z-ADDWCF3NB    $PF3NB           TH Avg Loin Eye
     C                     Z-ADDWCF2NB    $PF2NB           TH Avg Backfat
     C                     Z-ADDWCAVPC    $PAVPC           TH Std Yield Pe
     C                     Z-ADDWCAWPC    $PAWPC           TH Actual Yield
     C                     Z-ADDWCCWPC    $PCWPC           TH Adj Actual Y
     C                     Z-ADDWCA8PC    $PA8PC           TH Yield Differ
     C                     Z-ADDWCA7PC    $PA7PC           TH Recalc Live
     C                     Z-ADDWCB8PR    $PB8PR           TH CM Market Pr
     C                     Z-ADDWCAMPR    $PAMPR           TH CM Base Mkt
     C                     Z-ADDWCANPR    $PANPR           TH CM Base Mkt
     C                     Z-ADDWCAYVA    $PAYVA           TH CM Sort Disc
     C                     Z-ADDWCAWVA    $PAWVA           TH CM Yield Gai
     C                     Z-ADDWCAOPR    $PAOPR           TH CM Base Carc
     C                     Z-ADDWCAXVA    $PAXVA           TH CM LN AddOn/
     C                     Z-ADDWCAPPR    $PAPPR           TH CM Carcass G
     C                     Z-ADDWCASPR    $PASPR           TH Deduction Am
     C                     Z-ADDWCA4VA    $PA4VA           TH Total Net WO
     C                     Z-ADDWCATPR    $PATPR           TH Carcass Net
     C                     Z-ADDWCA5VA    $PA5VA           TH Additions Am
     C                     Z-ADDWCCBPR    $PCBPR           TH Payment Gros
     C                     Z-ADDWCCCPR    $PCCPR           Th Payment Net
     C                     Z-ADDWCLPNB    $PLPNB           TH AP Voucher/D
     C                     Z-ADDWCCDPR    $PCDPR           TH Freight Amou
     C                     Z-ADDWCA7VA    $PA7VA           TH Accrual Amou
     C                     Z-ADDWCA2PR    $PA2PR           TH Fixed Cost A
     C                     MOVELWCJWST    $PJWST           TH Calc Net Sts
     C                     MOVELWCCWST    $PCWST           TH Payment Sts
     C                     MOVELWCD7ST    $PD7ST           TH Header Error
     C                     MOVELWCD8ST    $PD8ST           TH Detail Error
     C                     MOVELWCDWST    $PDWST           TH Kill Balanci
     C                     MOVELWCD6ST    $PD6ST           TH Bal to Kill
     C                     Z-ADDWCBYDT    $PBYDT           TH Voucher Paym
     C                     MOVELWCE0ST    $PE0ST           TH User Error O
     C                     MOVELWCE1ST    $PE1ST           TH Held Over Re
     C                     MOVELWCE2ST    $PE2ST           TH Sex
     C                     Z-ADDWCBSDT    $PBSDT           TH Held/Ovr Com
     C                     Z-ADDWCBTDT    $PBTDT           TH Commission P
     C                     Z-ADDWCBUDT    $PBUDT           TH Actual Check
     C                     Z-ADDWCHGNB    $PHGNB           TH Shipped Weig
     C                     Z-ADDWCHHNB    $PHHNB           TH Avg Hot Wgt
     C                     Z-ADDWCHINB    $PHINB           TH FFLI
     C                     Z-ADDWCA3PR    $PA3PR           TH Kill Product
     C                     Z-ADDWCA4PR    $PA4PR           TH Cut Product
     C                     Z-ADDWCA6PR    $PA6PR           TH Render Produ
     C                     Z-ADDWCJ9NB    $PJ9NB           TH Head Exclude
     C                     Z-ADDWCD6PR    $PD6PR           TH CM Bse Mkt L
     C                     Z-ADDWCD7PR    $PD7PR           TH CM Bse Mkt C
     C                     Z-ADDWCD8PR    $PD8PR           TH CM Srt Dsc L
     C                     Z-ADDWCD9PR    $PD9PR           TH CM Srt Dsc C
     C                     Z-ADDWCEAPR    $PEAPR           TH CM Yld G/L L
     C                     Z-ADDWCEBPR    $PEBPR           TH CM Yld G/L C
     C                     Z-ADDWCECPR    $PECPR           TH CM Crc Val L
     C                     Z-ADDWCEDPR    $PEDPR           TH CM Crc Val C
     C                     Z-ADDWCEEPR    $PEEPR           TH CM Lean Prem
     C                     Z-ADDWCEFPR    $PEFPR           TH CM Lean Prem
     C                     Z-ADDWCEGPR    $PEGPR           TH CM Gross Liv
     C                     Z-ADDWCEHPR    $PEHPR           TH CM Gross Car
     C                     MOVELWCKAST    $PKAST           TH Source Type
     C                     MOVELWCJ7ST    $PJ7ST           TH Scale Ticket
     C                     MOVELWCJ9ST    $PJ9ST           TH Payment Type
     C                     MOVELWCLKST    $PLKST           TH Source Code
     C                     MOVELWCLLST    $PLLST           TH Hog Class Ty
     C                     MOVELWCJ8ST    $PJ8ST           TH Posted to HP
     C                     MOVELWCLIST    $PLIST           TH Schedule Kil
     C                     MOVELWCLJST    $PLJST           TH Shift Held O
     C                     MOVELWCNZTX    $PNZTX           TH State
     C                     MOVELWCHJCD    $PHJCD           TH Unused Code
     C                     MOVELWCR4ST    $PR4ST           TH Unused Sts 2
     C                     MOVELWCR5ST    $PR5ST           TH Commission S
     C                     MOVELWCR6ST    $PR6ST           TH Paid 2 Week
     C                     MOVELWCR7ST    $PR7ST           TH Unused Sts 1
     C                     Z-ADDWCTHWT    $PTHWT           TH DOA Weight
     C                     Z-ADDWCT2WT    $PT2WT           TH Avg Lean % E
     C                     Z-ADDWCTHHD    $PTHHD           TH HPS Farm Sit
     C                     Z-ADDWCOBPR    $POBPR           TH Sorting Amou
     C                     Z-ADDWCKOER    $PKOER           TH Head Identif
     C                     Z-ADDWCOPIR    $POPIR           TH Percent Iden
     C                     Z-ADDWCOPEM    $POPEM           TH Percent Acce
     C                     Z-ADDWCIORP    $PIORP           TH Head Adjuste
     C                     Z-ADDWCOWEO    $POWEO           TH PHA Head Add
     C                     MOVELWCOQET    $POQET           TH PHA Add Type
     C                     MOVELWCURST    $PURST           TH PHA Average
     C                     MOVELWCUSST    $PUSST           TH PHA Add Reas
     C                     Z-ADDWCHHPC    $PHHPC           TH PHA Yield Pe
     C                     Z-ADDWCS9PR    $PS9PR           TH PHA Lean Prm
     C                     Z-ADDWCTAPR    $PTAPR           TH VC Gross Val
     C                     Z-ADDWCTBPR    $PTBPR           TH Excluded Gro
     C                     Z-ADDWCJFUR    $PJFUR           TH Avg Lean %
     C                     Z-ADDWCKRIF    $PKRIF           TH Broken Back
     C                     Z-ADDWCKORF    $PKORF           TH Hot Scl Uplo
     C                     Z-ADDWCKAPR    $PKAPR           TH Unused Nbr 4
     C                     Z-ADDWCKROT    $PKROT           TH Excluded Car
     C                     Z-ADDWCOTJG    $POTJG           TH Excluded Pre
     C                     Z-ADDWCIRJG    $PIRJG           TH Unused Nbr 7
     C                     Z-ADDWCIMJF    $PIMJF           TH Unused Nbr 8
     C                     Z-ADDWCIRGF    $PIRGF           TH Unused Nbr 9
     C                     Z-ADDWCKRJF    $PKRJF           TH Unused Nbr 1
     C                     Z-ADDWCOJRF    $POJRF           TH Break Even P
     C                     Z-ADDWCKFOR    $PKFOR           TH Meat Value F
     C                     Z-ADDWCORJK    $PORJK           TH Yld Parm Adj
     C                     Z-ADDWCOMVJ    $POMVJ           TH PHA Sort Dis
     C                     Z-ADDWCMVNF    $PMVNF           TH Avg Loin Eye
     C                     Z-ADDWCMCNF    $PMCNF           TH Avg Backfat
     C                     Z-ADDWCNCNF    $PNCNF           TH HITCH Old Pa
     C                     Z-ADDWCNCHF    $PNCHF           TH MPR Sort Los
     C                     Z-ADDWCIGIR    $PIGIR           TH Unused Nbr 1
     C                     Z-ADDWCKFJR    $PKFJR           TH Unused Nbr 2
     C                     Z-ADDWCEADT    $PEADT           TH Cold Scl Upl
     C                     Z-ADDWCEBDT    $PEBDT           TH Cold Scl Upl
     C                     Z-ADDWCEEDT    $PEEDT           TH Unused Date
     C                     MOVELWCU4ST    $PU4ST           TH Unused Sts 1
     C                     MOVELWCU5ST    $PU5ST           TH Unused Sts 2
     C                     MOVELWCU6ST    $PU6ST           TH Unused Sts 3
     C                     MOVELWCU7ST    $PU7ST           TH Unused Sts 4
     C                     MOVELWCU8ST    $PU8ST           TH Unused Sts 5
     C                     MOVELWCU9ST    $PU9ST           TH Unused Sts 6
     C                     MOVELWCVAST    $PVAST           TH Unused Sts 7
     C                     MOVELWCVBST    $PVBST           TH Unused Sts 8
     C                     MOVELWCBECD    $PBECD           HC Class Code
     C                     MOVELWCBDCD    $PBDCD           DF Defect Code
     C                     MOVELWCCSCD    $PCSCD           THP Process Cod
     C                     MOVELWCAECD    $PAECD           PL Location Cod
     C                     MOVELWCACCD    $PACCD           HB Buyer Code
     C                     MOVELWCAAVN    $PAAVN           RS User Changed
     C                     Z-ADDWCAADT    $PAADT           RS Date Changed
     C                     Z-ADDWCAMTM    $PAMTM           RS Time Changed
     C                     MOVELWCAJST    $PAJST           RS Record Statu
     C                     MOVELWCAHVN    $PAHVN           RS Job
     C                     MOVELWCAGVN    $PAGVN           RS Program
     C                     MOVELWCABVN    $PABVN           RS User Added
     C                     Z-ADDWCABDT    $PABDT           RS Date Added
     C                     Z-ADDWCABTM    $PABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR ULSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Receiving for Hld PO
     C                     EXSR UMSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * C4677:  Yard deads and DOAs should be subtracted from s+
     C           *ZERO     SUB  $PFCNB    $PFCNB           TH Yard Deads
     C           *ZERO     SUB  $PCXNB    $PCXNB           TH Dead On Arri
     C                     ADD  $PCWNB    $UWWNB           Head Received 1
     C                     ADD  $PCYNB    $UX5NB           Live Weight SUM
     C                     ADD  $PFCNB    $UXRNB           Head Total Sum2
     C                     ADD  $PCXNB    $UHD5U           DOA Head Total
     C                     ADD  $PT2HD    $UDXNB           Shift Held Over
     C                     ADD  $PVMNB    $UMONB           Shift Held over
     C                     ADD  WUH9NB    $UCDNB           Head held over
     C                     ADD  $PCCNB    $UQLNB           Live Weight 2 S
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $PCYNB    IFGT *ZERO                      *IF
     C                     ADD  $PT2HD    $UHSHD           Head Shift w/wg
     C                     ADD  WUH9NB    $UHWHD           Head held over
     C                     ADD  $PCWNB    $UHDWT           Head Received w
     C                     END                             *FI
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCHMNB    WZG001           BOH Company Num
     C                     Z-ADDWCHMNB    WZG001
     C           *LIKE     DEFN WCB0DT    WZG002           TH Kill Date
     C                     Z-ADDWCB0DT    WZG002
     C           *LIKE     DEFN WCLIST    WZG003           TH Schedule Kil
     C                     MOVELWCLIST    WZG003
     C           *LIKE     DEFN WCLLST    WZG004           TH Hog Class Ty
     C                     MOVELWCLLST    WZG004
     C           *LIKE     DEFN WCCVNB    WZG005           TH Tattoo Numbe
     C                     Z-ADDWCCVNB    WZG005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@A1CPX9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Hog Class Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Hog Class Type EQ PAR.TH Hog Class Type
      *   '-
     C           P1LLST    IFEQ WUCRTX                     *IF
     C           WCLLST    OREQ P1LLST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           WCKAST    OREQ P1KAST                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.TH HPS Farm Site EQ WRK.Zero USR
      *   |- c2    : DB1.TH HPS Farm Site EQ PAR.TH HPS Farm Site
      *   '-
     C           P1THHD    IFEQ WUE9NB                     *IF
     C           WCTHHD    OREQ P1THHD                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PD Producer Code is Blank
      *   |- c2    : PAR.PD Producer Code EQ DB1.PD Producer Code
      *   '-
     C           P1ABCD    IFEQ *BLANK                     *IF
     C           P1ABCD    OREQ WCABCD                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0GL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0GL02  1        TH Schedule Kil
     C                     MOVEL*BLANK    W0GL03  1        TH Hog Class Ty
     C                     MOVEL*BLANK    W0GL04  1        TH Tattoo Numbe
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        BOH Company Num
     C                     MOVEL'Y'       W0GL01  1        TH Kill Date
     C                     MOVEL'Y'       W0GL02  1        TH Schedule Kil
     C                     MOVEL'Y'       W0GL03  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0GL04  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WCHMNB    IFNE WZG001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           WCB0DT    IFNE WZG002                     TH Kill Date
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C           WCLIST    IFNE WZG003                     TH Schedule Kil
     C           W0GL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL02
     C                     END
     C           WCLLST    IFNE WZG004                     TH Hog Class Ty
     C           W0GL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL03
     C                     END
     C           WCCVNB    IFNE WZG005                     TH Tattoo Numbe
     C           W0GL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL04
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP04
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$UKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP03
      * USER: Process after print of TH Hog Class Type format
     C                     ADD  $UDXNB    $VDXNB           Shift Held Over
     C                     ADD  $UMONB    $VMONB           Shift Held over
     C                     ADD  $UQLNB    WUQLNB           Live Weight 2 S
     C                     ADD  $UCDNB    WUCDNB           Head held over
     C                     ADD  $UHSHD    WUHSHD           Head Shift w/wg
     C                     ADD  $UHDWT    WUHDWT           Head Received w
     C                     ADD  $UHWHD    WUHWHD           Head held over
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP02
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKH01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKH02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKH03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKH04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKH05           TH Kill Date
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           BOH Company Num
     C                     KFLD           WQKH02           BOH Buy Order N
     C                     KFLD           WQKH03           BOL Load Number
     C                     KFLD           WQKH04           TH Tattoo Numbe
     C                     KFLD           WQKH05           TH Kill Date
      * Setup key
     C                     Z-ADD$PHMNB    WQKH01           BOH Company Num
     C                     Z-ADD$PBNNB    WQKH02           BOH Buy Order N
     C                     Z-ADD$PBONB    WQKH03           BOL Load Number
     C                     Z-ADD$PCVNB    WQKH04           TH Tattoo Numbe
     C                     Z-ADD$UB0DT    WQKH05           TH Kill Date
      * Establish starting position
     C           KRSH      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        BOH Company Num
     C                     MOVEL'Y'       W0HL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0HL02  1        BOL Load Number
     C                     MOVEL'Y'       W0HL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0HL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP02  1
     C                     END
      *
     C           W0HL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP03  1
     C                     END
      *
     C           W0HL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP04  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $QHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $QBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $QBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $QCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $QB0DT           TH Kill Date
     C                     MOVELDZBDCD    $QBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $QB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $QANTM           TST Wgt Time
     C                     MOVEL*BLANK    $QJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $QLJNB           TDF Head Defect
     C                     MOVELDZBECD    $QBECD           HC Class Code
     C                     MOVELDZB7SS    $QB7SS           TDF Classificat
     C                     MOVELDZB8SS    $QB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $QB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $QCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $QNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $QNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $QNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $QAAVN           RS User Changed
     C                     Z-ADDDZAADT    $QAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $QAMTM           RS Time Changed
     C                     MOVELDZAJST    $QAJST           RS Record Statu
     C                     MOVELDZAHVN    $QAHVN           RS Job
     C                     MOVELDZAGVN    $QAGVN           RS Program
     C                     MOVELDZABVN    $QABVN           RS User Added
     C                     Z-ADDDZABDT    $QABDT           RS Date Added
     C                     Z-ADDDZABTM    $QABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZH001           BOH Company Num
     C                     Z-ADDDZHMNB    WZH001
     C           *LIKE     DEFN DZBNNB    WZH002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZH002
     C           *LIKE     DEFN DZBONB    WZH003           BOL Load Number
     C                     Z-ADDDZBONB    WZH003
     C           *LIKE     DEFN DZCVNB    WZH004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZH004
     C           *LIKE     DEFN DZB0DT    WZH005           TH Kill Date
     C                     Z-ADDDZB0DT    WZH005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR TQRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0HL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0HL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0HL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0HL04  1        TH Kill Date
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        BOH Company Num
     C                     MOVEL'Y'       W0HL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0HL02  1        BOL Load Number
     C                     MOVEL'Y'       W0HL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0HL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZH001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           DZBNNB    IFNE WZH002                     BOH Buy Order N
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C           DZBONB    IFNE WZH003                     BOL Load Number
     C           W0HL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL02
     C                     END
     C           DZCVNB    IFNE WZH004                     TH Tattoo Numbe
     C           W0HL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL03
     C                     END
     C           DZB0DT    IFNE WZH005                     TH Kill Date
     C           W0HL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL04
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP04
     C                     END
      *
     C           W0HL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP03
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP02
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         I0MAIN    BEGSR
      *================================================================
      * Prt Receiving for Hld PO: Mainline
      *================================================================
      * Prt Receiving for Hld PO: Initialise
     C                     EXSR ZIINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQKI01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQKI02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQKI03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQKI04           TH Tattoo Numbe
      * Define keylist
     C           KRSI      KLIST
     C                     KFLD           WQKI01           BOH Company Num
     C                     KFLD           WQKI02           BOH Buy Order N
     C                     KFLD           WQKI03           BOL Load Number
     C                     KFLD           WQKI04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$PHMNB    WQKI01           BOH Company Num
     C                     Z-ADD$PBNNB    WQKI02           BOH Buy Order N
     C                     Z-ADD$PBONB    WQKI03           BOL Load Number
     C                     Z-ADD$PCVNB    WQKI04           TH Tattoo Numbe
      * Establish starting position
     C           KRSI      SETLL@A1CPVF                    *
      * Read first record with user selection
     C                     EXSR I3READ
     C           W0EOFI    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0IL1P  1        First page
     C                     MOVEL'Y'       W0IL00  1        BOH Company Num
     C                     MOVEL'Y'       W0IL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0IL02  1        BOL Load Number
     C                     MOVEL'Y'       W0IL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ICDT
      * Print report body
     C           W0EOFI    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR I1PHDR
      * Print report detail line
     C                     EXSR I2PDTL
      * Read next record with user selection
     C                     EXSR I3READ
      * Print totals
     C                     EXSR I4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         I0EXIT    ENDSR
      /EJECT
     CSR         I1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0IL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP1P  1
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP00  1
     C                     END
      *
     C           W0IL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP01  1
     C                     END
      *
     C           W0IL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP02  1
     C                     END
      *
     C           W0IL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $TSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $TSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $THWHD           Head held over
     C                     Z-ADD*ZERO     $THDWT           Head Received w
     C                     Z-ADD*ZERO     $THD5U           DOA Head Total
     C                     Z-ADD*ZERO     $TQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $TCDNB           Head held over
     C                     Z-ADDWAHMNB    $THMNB           BOH Company Num
     C                     Z-ADDWACVNB    $TCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     $TWWNB           Head Received 1
     C                     Z-ADD*ZERO     $TX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $TB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $TXRNB           Head Total Sum2
     C                     Z-ADDWAB0DT    $TB0DT           TH Kill Date
     C                     MOVELWALLST    $TLLST           TH Hog Class Ty
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IP03  1
     C                     END
      *
      *================================================================
     CSR         I1EXIT    ENDSR
      /EJECT
     CSR         I2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAHMNB    $RHMNB           BOH Company Num
     C                     Z-ADDWABNNB    $RBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    $RBONB           BOL Load Number
     C                     MOVEL*BLANK    $RNGST           @Status (Held o
     C                     Z-ADDWACVNB    $RCVNB           TH Tattoo Numbe
     C                     MOVELWAABCD    $RABCD           PD Producer Cod
     C                     Z-ADDWACWNB    $RCWNB           TH Head Receive
     C                     Z-ADDWAT2HD    $RT2HD           TH Shift Held O
     C                     Z-ADDWAGHNB    $RGHNB           TH Commission A
     C                     Z-ADDWACYNB    $RCYNB           TH Live Wgt
     C                     Z-ADDWAF7NB    $RF7NB           TH Avg Live Wgt
     C                     Z-ADDWAECDT    $RECDT           TH Head LFT
     C                     Z-ADDWAEDDT    $REDDT           TH Head EUT/KOA
     C                     Z-ADDWACXNB    $RCXNB           TH Dead On Arri
     C                     Z-ADDWAFCNB    $RFCNB           TH Yard Deads
     C                     Z-ADDWAOXNB    $ROXNB           TH HPS Movement
     C                     MOVELWAAGCD    $RAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $RKQTX           Farm site Name
     C                     MOVEL*BLANK    $RNYCD           PS Site ID
     C                     MOVEL*BLANK    $RKTTX           Defect Desc 15
     C                     Z-ADD*ZERO     $RCCNB           Yard dead weigh
     C                     Z-ADDWAB0DT    $RB0DT           TH Kill Date
     C                     Z-ADDWAAWDT    $RAWDT           TH Purchase Dat
     C                     MOVELWABICD    $RBICD           TH Group Refere
     C                     MOVELWACPST    $RCPST           TH Live Purchas
     C                     Z-ADDWAACPR    $RACPR           TH Live Purchas
     C                     Z-ADDWAB9PR    $RB9PR           TH Live Gross A
     C                     Z-ADDWACAPR    $RCAPR           TH LIve Net Amt
     C                     MOVELWAC4ST    $RC4ST           TH Resale UOM
     C                     Z-ADDWAAIPR    $RAIPR           TH Recalc Live
     C                     Z-ADDWAA6DT    $RA6DT           TH Pricing Date
     C                     MOVELWAC2ST    $RC2ST           TH Resale Sprea
     C                     Z-ADDWAH9NB    $RH9NB           TH Held Over
     C                     Z-ADDWAFDNB    $RFDNB           TH Head Condemn
     C                     Z-ADDWAFENB    $RFENB           TH Head Killed
     C                     Z-ADDWAHENB    $RHENB           TH Head Adds
     C                     Z-ADDWAHFNB    $RHFNB           TH Head Accepte
     C                     Z-ADDWALRNB    $RLRNB           TH Adj Live Wgt
     C                     Z-ADDWAE0NB    $RE0NB           TH Hot Wgt
     C                     Z-ADDWAA5PC    $RA5PC           TH Tot Loin Eye
     C                     Z-ADDWAFBNB    $RFBNB           TH Tot Backfat
     C                     Z-ADDWAA4PC    $RA4PC           TH Tot Light Re
     C                     Z-ADDWAHDNB    $RHDNB           TH Avg Hot Wgt
     C                     Z-ADDWAF5NB    $RF5NB           TH Avg Light Re
     C                     Z-ADDWAF4NB    $RF4NB           TH Avg Lean Per
     C                     Z-ADDWAF3NB    $RF3NB           TH Avg Loin Eye
     C                     Z-ADDWAF2NB    $RF2NB           TH Avg Backfat
     C                     Z-ADDWAAVPC    $RAVPC           TH Std Yield Pe
     C                     Z-ADDWAAWPC    $RAWPC           TH Actual Yield
     C                     Z-ADDWACWPC    $RCWPC           TH Adj Actual Y
     C                     Z-ADDWAA8PC    $RA8PC           TH Yield Differ
     C                     Z-ADDWAA7PC    $RA7PC           TH Recalc Live
     C                     Z-ADDWAB8PR    $RB8PR           TH CM Market Pr
     C                     Z-ADDWAAMPR    $RAMPR           TH CM Base Mkt
     C                     Z-ADDWAANPR    $RANPR           TH CM Base Mkt
     C                     Z-ADDWAAYVA    $RAYVA           TH CM Sort Disc
     C                     Z-ADDWAAWVA    $RAWVA           TH CM Yield Gai
     C                     Z-ADDWAAOPR    $RAOPR           TH CM Base Carc
     C                     Z-ADDWAAXVA    $RAXVA           TH CM LN AddOn/
     C                     Z-ADDWAAPPR    $RAPPR           TH CM Carcass G
     C                     Z-ADDWAASPR    $RASPR           TH Deduction Am
     C                     Z-ADDWAA4VA    $RA4VA           TH Total Net WO
     C                     Z-ADDWAATPR    $RATPR           TH Carcass Net
     C                     Z-ADDWAA5VA    $RA5VA           TH Additions Am
     C                     Z-ADDWACBPR    $RCBPR           TH Payment Gros
     C                     Z-ADDWACCPR    $RCCPR           Th Payment Net
     C                     Z-ADDWALPNB    $RLPNB           TH AP Voucher/D
     C                     Z-ADDWACDPR    $RCDPR           TH Freight Amou
     C                     Z-ADDWAA7VA    $RA7VA           TH Accrual Amou
     C                     Z-ADDWAA2PR    $RA2PR           TH Fixed Cost A
     C                     MOVELWAJWST    $RJWST           TH Calc Net Sts
     C                     MOVELWACWST    $RCWST           TH Payment Sts
     C                     MOVELWAD7ST    $RD7ST           TH Header Error
     C                     MOVELWAD8ST    $RD8ST           TH Detail Error
     C                     MOVELWADWST    $RDWST           TH Kill Balanci
     C                     MOVELWAD6ST    $RD6ST           TH Bal to Kill
     C                     Z-ADDWABYDT    $RBYDT           TH Voucher Paym
     C                     MOVELWAE0ST    $RE0ST           TH User Error O
     C                     MOVELWAE1ST    $RE1ST           TH Held Over Re
     C                     MOVELWAE2ST    $RE2ST           TH Sex
     C                     Z-ADDWABSDT    $RBSDT           TH Held/Ovr Com
     C                     Z-ADDWABTDT    $RBTDT           TH Commission P
     C                     Z-ADDWABUDT    $RBUDT           TH Actual Check
     C                     Z-ADDWAHGNB    $RHGNB           TH Shipped Weig
     C                     Z-ADDWAHHNB    $RHHNB           TH Avg Hot Wgt
     C                     Z-ADDWAHINB    $RHINB           TH FFLI
     C                     Z-ADDWAA3PR    $RA3PR           TH Kill Product
     C                     Z-ADDWAA4PR    $RA4PR           TH Cut Product
     C                     Z-ADDWAA6PR    $RA6PR           TH Render Produ
     C                     Z-ADDWAJ9NB    $RJ9NB           TH Head Exclude
     C                     Z-ADDWAD6PR    $RD6PR           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    $RD7PR           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    $RD8PR           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    $RD9PR           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    $REAPR           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    $REBPR           TH CM Yld G/L C
     C                     Z-ADDWAECPR    $RECPR           TH CM Crc Val L
     C                     Z-ADDWAEDPR    $REDPR           TH CM Crc Val C
     C                     Z-ADDWAEEPR    $REEPR           TH CM Lean Prem
     C                     Z-ADDWAEFPR    $REFPR           TH CM Lean Prem
     C                     Z-ADDWAEGPR    $REGPR           TH CM Gross Liv
     C                     Z-ADDWAEHPR    $REHPR           TH CM Gross Car
     C                     MOVELWAKAST    $RKAST           TH Source Type
     C                     MOVELWAJ7ST    $RJ7ST           TH Scale Ticket
     C                     MOVELWAJ9ST    $RJ9ST           TH Payment Type
     C                     MOVELWALKST    $RLKST           TH Source Code
     C                     MOVELWALLST    $RLLST           TH Hog Class Ty
     C                     MOVELWAJ8ST    $RJ8ST           TH Posted to HP
     C                     MOVELWALIST    $RLIST           TH Schedule Kil
     C                     MOVELWALJST    $RLJST           TH Shift Held O
     C                     MOVELWANZTX    $RNZTX           TH State
     C                     MOVELWAHJCD    $RHJCD           TH Unused Code
     C                     MOVELWAR4ST    $RR4ST           TH Unused Sts 2
     C                     MOVELWAR5ST    $RR5ST           TH Commission S
     C                     MOVELWAR6ST    $RR6ST           TH Paid 2 Week
     C                     MOVELWAR7ST    $RR7ST           TH Unused Sts 1
     C                     Z-ADDWATHWT    $RTHWT           TH DOA Weight
     C                     Z-ADDWAT2WT    $RT2WT           TH Avg Lean % E
     C                     Z-ADDWATHHD    $RTHHD           TH HPS Farm Sit
     C                     Z-ADDWAOBPR    $ROBPR           TH Sorting Amou
     C                     Z-ADDWAKOER    $RKOER           TH Head Identif
     C                     Z-ADDWAOPIR    $ROPIR           TH Percent Iden
     C                     Z-ADDWAOPEM    $ROPEM           TH Percent Acce
     C                     Z-ADDWAIORP    $RIORP           TH Head Adjuste
     C                     Z-ADDWAOWEO    $ROWEO           TH PHA Head Add
     C                     MOVELWAOQET    $ROQET           TH PHA Add Type
     C                     MOVELWAURST    $RURST           TH PHA Average
     C                     MOVELWAUSST    $RUSST           TH PHA Add Reas
     C                     Z-ADDWAHHPC    $RHHPC           TH PHA Yield Pe
     C                     Z-ADDWAS9PR    $RS9PR           TH PHA Lean Prm
     C                     Z-ADDWATAPR    $RTAPR           TH VC Gross Val
     C                     Z-ADDWATBPR    $RTBPR           TH Excluded Gro
     C                     Z-ADDWAJFUR    $RJFUR           TH Avg Lean %
     C                     Z-ADDWAKRIF    $RKRIF           TH Broken Back
     C                     Z-ADDWAKORF    $RKORF           TH Hot Scl Uplo
     C                     Z-ADDWAKAPR    $RKAPR           TH Unused Nbr 4
     C                     Z-ADDWAKROT    $RKROT           TH Excluded Car
     C                     Z-ADDWAOTJG    $ROTJG           TH Excluded Pre
     C                     Z-ADDWAIRJG    $RIRJG           TH Unused Nbr 7
     C                     Z-ADDWAIMJF    $RIMJF           TH Unused Nbr 8
     C                     Z-ADDWAIRGF    $RIRGF           TH Unused Nbr 9
     C                     Z-ADDWAKRJF    $RKRJF           TH Unused Nbr 1
     C                     Z-ADDWAOJRF    $ROJRF           TH Break Even P
     C                     Z-ADDWAKFOR    $RKFOR           TH Meat Value F
     C                     Z-ADDWAORJK    $RORJK           TH Yld Parm Adj
     C                     Z-ADDWAOMVJ    $ROMVJ           TH PHA Sort Dis
     C                     Z-ADDWAMVNF    $RMVNF           TH Avg Loin Eye
     C                     Z-ADDWAMCNF    $RMCNF           TH Avg Backfat
     C                     Z-ADDWANCNF    $RNCNF           TH HITCH Old Pa
     C                     Z-ADDWANCHF    $RNCHF           TH MPR Sort Los
     C                     Z-ADDWAIGIR    $RIGIR           TH Unused Nbr 1
     C                     Z-ADDWAKFJR    $RKFJR           TH Unused Nbr 2
     C                     Z-ADDWAEADT    $READT           TH Cold Scl Upl
     C                     Z-ADDWAEBDT    $REBDT           TH Cold Scl Upl
     C                     Z-ADDWAEEDT    $REEDT           TH Unused Date
     C                     MOVELWAU4ST    $RU4ST           TH Unused Sts 1
     C                     MOVELWAU5ST    $RU5ST           TH Unused Sts 2
     C                     MOVELWAU6ST    $RU6ST           TH Unused Sts 3
     C                     MOVELWAU7ST    $RU7ST           TH Unused Sts 4
     C                     MOVELWAU8ST    $RU8ST           TH Unused Sts 5
     C                     MOVELWAU9ST    $RU9ST           TH Unused Sts 6
     C                     MOVELWAVAST    $RVAST           TH Unused Sts 7
     C                     MOVELWAVBST    $RVBST           TH Unused Sts 8
     C                     MOVELWABECD    $RBECD           HC Class Code
     C                     MOVELWABDCD    $RBDCD           DF Defect Code
     C                     MOVELWACSCD    $RCSCD           THP Process Cod
     C                     MOVELWAAECD    $RAECD           PL Location Cod
     C                     MOVELWAACCD    $RACCD           HB Buyer Code
     C                     MOVELWAAAVN    $RAAVN           RS User Changed
     C                     Z-ADDWAAADT    $RAADT           RS Date Changed
     C                     Z-ADDWAAMTM    $RAMTM           RS Time Changed
     C                     MOVELWAAJST    $RAJST           RS Record Statu
     C                     MOVELWAAHVN    $RAHVN           RS Job
     C                     MOVELWAAGVN    $RAGVN           RS Program
     C                     MOVELWAABVN    $RABVN           RS User Added
     C                     Z-ADDWAABDT    $RABDT           RS Date Added
     C                     Z-ADDWAABTM    $RABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0IPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UOSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $RCWNB    $TWWNB           Head Received 1
     C                     ADD  $RCYNB    $TX5NB           Live Weight SUM
     C                     ADD  $RFCNB    $TXRNB           Head Total Sum2
     C                     ADD  $RCWNB    $TCDNB           Head held over
     C                     ADD  $RCYNB    $TQLNB           Live Weight 2 S
     C                     ADD  $RCXNB    $THD5U           DOA Head Total
      * Accum head with live wgt for avg live wgt calc.
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $RCYNB    IFGT *ZERO                      *IF
     C                     ADD  $RCWNB    $THDWT           Head Received w
     C                     ADD  $RCWNB    $THWHD           Head held over
     C                     END                             *FI
     C                     ADD  $RECDT    $TSRA1           LFT Head Total
     C                     ADD  $REDDT    $TSSA1           EUT/KOA Head To
      *
      *================================================================
     CSR         I2EXIT    ENDSR
      /EJECT
     CSR         I3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAHMNB    WZI001           BOH Company Num
     C                     Z-ADDWAHMNB    WZI001
     C           *LIKE     DEFN WABNNB    WZI002           BOH Buy Order N
     C                     Z-ADDWABNNB    WZI002
     C           *LIKE     DEFN WABONB    WZI003           BOL Load Number
     C                     Z-ADDWABONB    WZI003
     C           *LIKE     DEFN WACVNB    WZI004           TH Tattoo Numbe
     C                     Z-ADDWACVNB    WZI004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFI    OREQ '1'
     C           KRSI      READE@A1CPVF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFI  1
      * Quit if no record read
     C           W0EOFI    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0IL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0IL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0IL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0IL03  1        TH Tattoo Numbe
     C           W0EOFI    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0IL00  1        BOH Company Num
     C                     MOVEL'Y'       W0IL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0IL02  1        BOL Load Number
     C                     MOVEL'Y'       W0IL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WAHMNB    IFNE WZI001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL00
     C                     END
     C           WABNNB    IFNE WZI002                     BOH Buy Order N
     C           W0IL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL01
     C                     END
     C           WABONB    IFNE WZI003                     BOL Load Number
     C           W0IL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL02
     C                     END
     C           WACVNB    IFNE WZI004                     TH Tattoo Numbe
     C           W0IL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0IL03
     C                     END
     C                     END
      *================================================================
     CSR         I3EXIT    ENDSR
      /EJECT
     CSR         I4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0IL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$TKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP03
      * USER: Process after print of TH Tattoo Number format
      * Accums for Received Head  totals
     C                     ADD  $TWWNB    $UWWNB           Head Received 1
     C                     ADD  $TX5NB    $UX5NB           Live Weight SUM
     C                     ADD  $THD5U    $UHD5U           DOA Head Total
     C                     ADD  $TXRNB    $UXRNB           Head Total Sum2
     C                     ADD  $THDWT    $UHDWT           Head Received w
     C                     ADD  $THWHD    $UHWHD           Head held over
      * Subtract from Accums for Less/Add Held Over totals
     C                     SUB  $TWWNB    $UCDNB           Head held over
     C                     SUB  $TX5NB    $UQLNB           Live Weight 2 S
     C                     ADD  $TSRA1    WUSRA1           LFT Head Total
     C                     ADD  $TSSA1    WUSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0IL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP02
     C                     END
      *
     C           W0IL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP01
     C                     END
      *
     C           W0IL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0IP00
     C                     END
      *
     C           W0EOFI    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         I4EXIT    ENDSR
      /EJECT
     CSR         J0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKJ01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKJ02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKJ03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKJ04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKJ05           TH Kill Date
      * Define keylist
     C           KRSJ      KLIST
     C                     KFLD           WQKJ01           BOH Company Num
     C                     KFLD           WQKJ02           BOH Buy Order N
     C                     KFLD           WQKJ03           BOL Load Number
     C                     KFLD           WQKJ04           TH Tattoo Numbe
     C                     KFLD           WQKJ05           TH Kill Date
      * Setup key
     C                     Z-ADD$RHMNB    WQKJ01           BOH Company Num
     C                     Z-ADD$RBNNB    WQKJ02           BOH Buy Order N
     C                     Z-ADD$RBONB    WQKJ03           BOL Load Number
     C                     Z-ADD$RCVNB    WQKJ04           TH Tattoo Numbe
     C                     Z-ADD$RB0DT    WQKJ05           TH Kill Date
      * Establish starting position
     C           KRSJ      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR J3READ
     C           W0EOFJ    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0JL1P  1        First page
     C                     MOVEL'Y'       W0JL00  1        BOH Company Num
     C                     MOVEL'Y'       W0JL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0JL02  1        BOL Load Number
     C                     MOVEL'Y'       W0JL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0JL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0JCDT
      * Print report body
     C           W0EOFJ    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR J1PHDR
      * Print report detail line
     C                     EXSR J2PDTL
      * Read next record with user selection
     C                     EXSR J3READ
      * Print totals
     C                     EXSR J4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         J0EXIT    ENDSR
      /EJECT
     CSR         J1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0JL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP1P  1
     C                     END
      *
     C           W0JL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP00  1
     C                     END
      *
     C           W0JL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP01  1
     C                     END
      *
     C           W0JL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP02  1
     C                     END
      *
     C           W0JL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP03  1
     C                     END
      *
     C           W0JL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JP04  1
     C                     END
      *
      *================================================================
     CSR         J1EXIT    ENDSR
      /EJECT
     CSR         J2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $SHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $SBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $SBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $SCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $SB0DT           TH Kill Date
     C                     MOVELDZBDCD    $SBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $SB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $SANTM           TST Wgt Time
     C                     MOVEL*BLANK    $SJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $SLJNB           TDF Head Defect
     C                     MOVELDZBECD    $SBECD           HC Class Code
     C                     MOVELDZB7SS    $SB7SS           TDF Classificat
     C                     MOVELDZB8SS    $SB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $SB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $SCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $SNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $SNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $SNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $SAAVN           RS User Changed
     C                     Z-ADDDZAADT    $SAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $SAMTM           RS Time Changed
     C                     MOVELDZAJST    $SAJST           RS Record Statu
     C                     MOVELDZAHVN    $SAHVN           RS Job
     C                     MOVELDZAGVN    $SAGVN           RS Program
     C                     MOVELDZABVN    $SABVN           RS User Added
     C                     Z-ADDDZABDT    $SABDT           RS Date Added
     C                     Z-ADDDZABTM    $SABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0JPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         J2EXIT    ENDSR
      /EJECT
     CSR         J3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZJ001           BOH Company Num
     C                     Z-ADDDZHMNB    WZJ001
     C           *LIKE     DEFN DZBNNB    WZJ002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZJ002
     C           *LIKE     DEFN DZBONB    WZJ003           BOL Load Number
     C                     Z-ADDDZBONB    WZJ003
     C           *LIKE     DEFN DZCVNB    WZJ004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZJ004
     C           *LIKE     DEFN DZB0DT    WZJ005           TH Kill Date
     C                     Z-ADDDZB0DT    WZJ005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFJ    OREQ '1'
     C           KRSJ      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFJ  1
      * Quit if no record read
     C           W0EOFJ    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR NARVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0JL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0JL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0JL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0JL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0JL04  1        TH Kill Date
     C           W0EOFJ    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0JL00  1        BOH Company Num
     C                     MOVEL'Y'       W0JL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0JL02  1        BOL Load Number
     C                     MOVEL'Y'       W0JL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0JL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZJ001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL00
     C                     END
     C           DZBNNB    IFNE WZJ002                     BOH Buy Order N
     C           W0JL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL01
     C                     END
     C           DZBONB    IFNE WZJ003                     BOL Load Number
     C           W0JL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL02
     C                     END
     C           DZCVNB    IFNE WZJ004                     TH Tattoo Numbe
     C           W0JL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL03
     C                     END
     C           DZB0DT    IFNE WZJ005                     TH Kill Date
     C           W0JL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0JL04
     C                     END
     C                     END
      *================================================================
     CSR         J3EXIT    ENDSR
      /EJECT
     CSR         J4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0JL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP04
     C                     END
      *
     C           W0JL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP03
     C                     END
      *
     C           W0JL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP02
     C                     END
      *
     C           W0JL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP01
     C                     END
      *
     C           W0JL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0JP00
     C                     END
      *
     C           W0EOFJ    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         J4EXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSNA     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO NAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv Crt Head Kill Sum RT - Head Killed & Cut Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDNKNB           Calendar Year
     C                     KFLD           WDHVA1           Week Number
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDWTST           Schedule Kill S
      * Setup key
     C                     Z-ADDP1HMNB    WDHONB           CC Company Numb
     C                     Z-ADDP7NKNB    WDNKNB           Calendar Year
     C                     Z-ADDP7HVA1    WDHVA1           Week Number
     C                     Z-ADD$VB0DT    WDB0DT           TH Kill Date
     C                     MOVELYL0017    WDWTST           Schedule Kill S
      * Establish starting position
     C           KRSNB     CHAIN@AACPH7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1020' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Head Killed & Cut CR - Head Killed & Cut Summary  * 
     C                     EXSR NCCRRC
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Head Killed & Cut - Head Killed & Cut Summary  * 
     C                     EXSR NDCHRC
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCRRC    BEGSR
      *================================================================
      * Crt Head Killed & Cut CR - Head Killed & Cut Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AACPH6
     C                     Z-ADDP1HMNB    WEHONB           CC Company Numb
     C                     Z-ADDP7NKNB    WENKNB           Calendar Year
     C                     Z-ADDP7HVA1    WEHVA1           Week Number
     C                     Z-ADD$VB0DT    WEB0DT           TH Kill Date
     C                     MOVELYL0017    WEWTST           Schedule Kill S
     C                     Z-ADDP7FPDT    WEFPDT           Week Ending Dat
     C                     Z-ADD$VB5NB    WEKDHD           Head Killed
     C                     Z-ADD*ZERO     WEHUA1           Head Cut
     C                     MOVEL*BLANK    WEAAVN           RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL*BLANK    WEAHVN           RS Job
     C                     MOVEL*BLANK    WEAGVN           RS Program
     C                     MOVEL*BLANK    WEABVN           RS User Added
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEABDT    PARM *ZERO     WQ0113  70       *DATE
     C           WEABTM    PARM *ZERO     WQ0114  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRNC    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WENKNB           Calendar Year
     C                     KFLD           WEHVA1           Week Number
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEWTST           Schedule Kill S
      * Check for duplicate primary key
     C           KLCRNC    SETLL@AACPH6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1021' W0RTN   7
      * Send message 'Head Killed & Cut Summ EX'
     C                     MOVEL'PRK1021' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C                     WRITE@AACPH6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * Change Head Killed & Cut - Head Killed & Cut Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AACPH6
     C                     Z-ADDP1HMNB    WEHONB           CC Company Numb
     C                     Z-ADDP7NKNB    WENKNB           Calendar Year
     C                     Z-ADDP7HVA1    WEHVA1           Week Number
     C                     Z-ADD$VB0DT    WEB0DT           TH Kill Date
     C                     MOVELYL0017    WEWTST    P      Schedule Kill S
      *
     C           KLCHND    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WENKNB           Calendar Year
     C                     KFLD           WEHVA1           Week Number
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEWTST           Schedule Kill S
     C           KLCHND    CHAIN@AACPH6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAACPL0'MDACP
     C                     MOVEL'@AACPH6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAA1    YARDCS
      * Move non-key fields to @AACPH6
     C                     Z-ADDP7FPDT    WEFPDT           Week Ending Dat
     C                     Z-ADD$VB5NB    WEKDHD           Head Killed
     C                     Z-ADDWDHUA1    WEHUA1           Head Cut
     C                     MOVEL*BLANK    WEAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     MOVEL'A'       WEAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WEAHVN    P      RS Job
     C                     MOVEL*BLANK    WEAGVN    P      RS Program
     C                     MOVEL*BLANK    WEABVN    P      RS User Added
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AACPH6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1HMNB    $CHMNB           BOH Company Num
     C                     Z-ADDP3B3DT    $CB3DT           Date From USR
     C                     Z-ADDP4B4DT    $CB4DT           Date To   USR
     C                     MOVELP8AACD    $CAACD           SR Source Code
     C                     MOVELP9XHST    $CXHST           DT Load Type
     C                     MOVELP1LLST    $CLLST           TH Hog Class Ty
     C                     MOVELP1LIST    $CLIST           TH Schedule Kil
     C                     Z-ADDP1THHD    $CTHHD           TH HPS Farm Sit
     C                     MOVELP1ABCD    $CABCD           PD Producer Cod
     C                     MOVELP1KAST    $CIXST           SR Type
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CHMNB    WQ0031  30       CC Company Numb
     C           $CBSTX    PARM *BLANK    WQ0032 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0033  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD$CHMNB    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      * E11245 JJH 07/21/17 - Display SR Source Code and SR Source Desc
      * Source Description
      * CASE: PAR.SR Source Code is EQ Blank
     C           P8AACD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CAFTX           SR Description
     C                     MOVEL'ALL'     $CAFTX           SR Description
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Source Desc       RT - Source  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * Source type description
      * CASE: 1PG.SR Type NE WRK.Blank USR
     C           $CIXST    IFNE WUCRTX                     *IF
      * 1PG.SR Type Desc = Condition name of 1PG.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM $CIXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CISTX    PARM           W0CNNM 25        SR Type Desc
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
     C                     MOVEL'ALL'     $CISTX           SR Type Desc
     C                     END                             *FI
      * Load type description
      * CASE: 1PG.DT Load Type is Not Entered
     C           $CXHST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CEVT1           Load Type Descr
     C                     MOVEL'ALL'     $CEVT1           Load Type Descr
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Load Type Description USR = Condition name of 1PG.DT Load Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1309802   Y2LSNO  70       List number
     C                     PARM $CXHST    W0INVL 25        DT Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CEVT1    PARM           W0CNNM 25        Load Type Descr
      *
     C                     END                             *FI
      * Hog Class Type description
      * CASE: 1PG.TH Hog Class Type NE WRK.Blank USR
     C           $CLLST    IFNE WUCRTX                     *IF
      * 1PG.Description 30 USR = Condition name of 1PG.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $CLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CKKTX           Description 30
     C                     MOVEL'ALL'     $CKKTX           Description 30
     C                     END                             *FI
      * Kill Shift description
      * CASE: 1PG.TH Schedule Kill Shift NE WRK.Blank USR
     C           $CLIST    IFNE WUCRTX                     *IF
      * 1PG.Shift Description USR = Condition name of 1PG.TH Schedule Kil
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100059   Y2LSNO  70       List number
     C                     PARM $CLIST    W0INVL 25        TH Schedule Kil
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CFSTX    PARM           W0CNNM 25        Shift Descripti
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CFSTX           Shift Descripti
     C                     MOVEL'ALL'     $CFSTX           Shift Descripti
     C                     END                             *FI
      * Farm Site description
      * CASE: 1PG.TH HPS Farm Site NE WRK.Zero USR
     C           $CTHHD    IFNE WUE9NB                     *IF
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Val HPS Farm Site     UP - STR HPS Interface  * 
     C                     CALL 'HP256'                90  Val HPS Farm Si
     C           WULMST    PARM WULMST    WQ0034  7        Return Code USR
     C                     PARM $CTHHD    WQ0035  50       HRH Farm Site
     C                     PARM WUOCTX    WQ0036  5        Farm Site Prod
     C           $CKQTX    PARM *BLANK    WQ0037 25        Farm site Name
     C                     PARM *BLANK    WQ0038 20        MTech Farm Site
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP256'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0039  7        *Return code
     C           $CKQTX    PARM *BLANK    WQ0040 25        Farm site Name
     C                     PARM $CTHHD    WQ0041  50       Farm Site USR
     C                     PARM *BLANK    WQ0042  5        HPS FS Comp Rel
     C                     PARM *BLANK    WQ0043  3        State
     C                     PARM *BLANK    WQ0044 25        HPS Farm County
     C                     PARM *BLANK    WQ0045  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0046 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0047 20        MTech Farm Site
     C                     PARM *BLANK    WQ0048 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CKQTX           Farm site Name
     C                     MOVEL'ALL'     $CKQTX           Farm site Name
     C                     END                             *FI
      * Producer Code Desc
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $CA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CA4TX           Producer Name
     C                     MOVEL'*ALL'    $CA4TX           Producer Name
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  $CB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB3DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $CB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB4DT
     C                     MOVEL'0'       *IN79
     C           P5MFST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           WULLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print TH Kill Date of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
     C                     Z-ADD$EB0DT    WUB0DT           TH Kill Date
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $EB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEB0DT
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print TH Schedule Kill Shift of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Schedule Kill Shift format
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0NEWP           *Print New Page
     C                     END                             *FI
      * CUR.Shift Description USR = Condition name of DB1.TH Schedule Kil
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100059   Y2LSNO  70       List number
     C                     PARM A1LIST    W0INVL 25        TH Schedule Kil
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $FFSTX    PARM           W0CNNM 25        Shift Descripti
      *
     C                     MOVEL$FFSTX    WUFSTX           Shift Descripti
     C                     MOVELA1LIST    WULIST           TH Schedule Kil
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$FKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Hog Class Type of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Hog Class Type format
      * CUR.Description 30 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $GLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $GKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVEL$GKKTX    WUKKTX           Description 30
     C                     MOVEL$GLLST    WULLST           TH Hog Class Ty
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$GKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiving Rpt     PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt Receiving Rpt     PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SCRVGN
      * 10242011 slm correction to print of eut/koa
      * Suppress line if tattoo is completely held over
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6
      *   |- c1    : CUR.TH Head Received is *Zeros
      *   |- c2    : CUR.TH Yard Deads is Zero
      *   |- c3    : CUR.TH Dead On Arrival is *Zeros
      *   |- c4    : CUR.TH Shift Held Over is Not Yes
      *   |- c5    : CUR.TH Head LFT is *ZEROS
      *   |- c6    : CUR.TH Head EUT/KOA is *ZEROS
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HCWNB    IFEQ *ZERO                      *IF
     C           $HFCNB    IFEQ *ZERO                      *IF
     C           $HCXNB    IFEQ *ZERO                      *IF
     C           $HLJST    IFEQ *BLANK                     *IF
     C           $HLJST    OREQ 'N'
     C           $HECDT    IFEQ 0                          *IF
     C           $HEDDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ADD CHECK ON LFT AND EUT/KOA
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * If Tattoo WAS held over from previous day, or until next shift
      * CASE: CUR.TH Held Over Record is Yes
     C           $HE1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'H+'      $HNGST           @Status (Held o
     C                     ELSE
      * CASE: CUR.TH Shift Held Over is Yes
     C           $HLJST    IFEQ 'Y'                        *IF
     C                     MOVEL'S-'      $HNGST           @Status (Held o
     C                     END                             *FI
     C                     END                             *FI
      * Calc avg live wgt -- we want this to exclude the held over hogs
      * CASE: CUR.TH Head Received is Not Zero
     C           $HCWNB    IFNE *ZERO                      *IF
     C           $HCYNB    DIV  $HCWNB    $HOVNB           Avg Live Wgt Us
     C                     END                             *FI
      * Tattoo Reference
      * CASE: CUR.TH Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0049  7        *Return code
     C                     PARM A1OXNB    WQ0050  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0051 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0052  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0053  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0054  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 11/4/2021 take care of using 3.0 farm number
     C                     Z-ADDWUETNB    YL0004           Farm Site 5.0 U
     C                     MOVELYL0004    $HKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0001  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0002  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0003  5        Building 1 USR
     C                     MOVEL*BLANK    WN0004  5        Room 1 USR
     C                     MOVEL*BLANK    WN0005  5        Building 2 USR
     C                     MOVEL*BLANK    WN0006  5        Room 2 USR
     C                     MOVEL*BLANK    WN0007  5        Building 3 USR
     C                     MOVEL*BLANK    WN0008  5        Room 3 USR
     C                     MOVEL*BLANK    WN0009  1        Status 1
     C                     MOVEL*BLANK    WN0010  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0011  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0012  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SDRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0003    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0003:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0004:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0010    CAT  WN0003:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0004:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0005    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0005:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0006:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0011:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0005:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0006:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0007    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0007:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0008:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0009    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
      * since this will be in the tattoo header will not need
     C                     Z-ADDA1THHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM A1THHD    WQ0055  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0056  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVELWUWWTX    $HKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0013  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0014  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0015  5        Building 1 USR
     C                     MOVEL*BLANK    WN0016  5        Room 1 USR
     C                     MOVEL*BLANK    WN0017  5        Building 2 USR
     C                     MOVEL*BLANK    WN0018  5        Room 2 USR
     C                     MOVEL*BLANK    WN0019  5        Building 3 USR
     C                     MOVEL*BLANK    WN0020  5        Room 3 USR
     C                     MOVEL*BLANK    WN0021  1        Status 1
     C                     MOVEL*BLANK    WN0022  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0023  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0024  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SFRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0015    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0015:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0016:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0022    CAT  WN0015:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0016:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0017    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0017:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0018:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0023:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0017:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0018:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0019    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0019:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0020:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0021    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 03/02/04 RMC If External, prt group ref if entered, else get farm
      * CASE: CUR.TH Group Reference is Entered
     C           $HBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVEL$HBICD    $HKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0025  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0026  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0027  5        Building 1 USR
     C                     MOVEL*BLANK    WN0028  5        Room 1 USR
     C                     MOVEL*BLANK    WN0029  5        Building 2 USR
     C                     MOVEL*BLANK    WN0030  5        Room 2 USR
     C                     MOVEL*BLANK    WN0031  5        Building 3 USR
     C                     MOVEL*BLANK    WN0032  5        Room 3 USR
     C                     MOVEL*BLANK    WN0033  1        Status 1
     C                     MOVEL*BLANK    WN0034  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0035  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0036  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SHRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0027    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0027:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0028:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0034    CAT  WN0027:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0028:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0029    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0029:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0030:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0035:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0029:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0030:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0031    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0031:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0032:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0033    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * C4677:  changed yd weight so uses printed/calc'd avg wgt,not wgt
     C           $HFCNB    MULT $HOVNB    $HCCNB           Yard dead weigh
     C           $HT2HD    MULT $HF7NB    $HVMNB           Shift held over
      * If Shift Held Over AND Next day held over
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CUR.TH Held Over is greater than 0
      *   |- c2    : CUR.TH Shift Held Over is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HH9NB    IFGT *ZERO                      *IF
     C           $HLJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Combine the hd held over with hd rcvd here, we want the hd to be
      * accounted for in this shift, because the H- appears on Shift 2
      *  And calc. the live wgt and avg live wgt.
     C                     ADD  $HH9NB    $HCWNB           TH Head Receive
     C           $HCWNB    MULT $HF7NB    $HCYNB           TH Live Wgt
     C           $HCYNB    DIV  $HCWNB    $HOVNB           Avg Live Wgt Us
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $HNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR SJRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SKRVGN
     C                     MOVELWUBCTX    $IJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $IB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIB6DT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of Prt Receiving for Hld PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'H-'      $JNGST           @Status (Held o
      * CASE: CUR.TH Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0009    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0063  7        *Return code
     C                     PARM WAOXNB    WQ0064  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0065 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0066  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0067  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0068  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0010           Farm Site 3.0 U
     C                     MOVELYL0010    $JKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0037  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0038  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0039  5        Building 1 USR
     C                     MOVEL*BLANK    WN0040  5        Room 1 USR
     C                     MOVEL*BLANK    WN0041  5        Building 2 USR
     C                     MOVEL*BLANK    WN0042  5        Room 2 USR
     C                     MOVEL*BLANK    WN0043  5        Building 3 USR
     C                     MOVEL*BLANK    WN0044  5        Room 3 USR
     C                     MOVEL*BLANK    WN0045  1        Status 1
     C                     MOVEL*BLANK    WN0046  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0047  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0048  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SMRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0039    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ':':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0039:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0040:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0046    CAT  WN0039:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0040:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0041    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0041:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0042:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0047:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0041:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0042:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0043    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0043:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0044:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $JKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0045    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  '+':ZQ    $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0009    IFEQ 'Y'                        *IF
     C                     Z-ADDWATHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WATHHD    WQ0069  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0070  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $JKQTX           Farm site Name
     C                     MOVELWUWWTX    $JKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0049  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0050  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0051  5        Building 1 USR
     C                     MOVEL*BLANK    WN0052  5        Room 1 USR
     C                     MOVEL*BLANK    WN0053  5        Building 2 USR
     C                     MOVEL*BLANK    WN0054  5        Room 2 USR
     C                     MOVEL*BLANK    WN0055  5        Building 3 USR
     C                     MOVEL*BLANK    WN0056  5        Room 3 USR
     C                     MOVEL*BLANK    WN0057  1        Status 1
     C                     MOVEL*BLANK    WN0058  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0059  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0060  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SORVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0051    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ':':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0051:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0052:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0058    CAT  WN0051:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0052:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0053    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0053:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0054:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0059:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0053:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0054:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0055    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0055:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0056:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $JKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0057    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  '+':ZQ    $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 03/02/04 RMC If External, prt group ref if entered, else get farm
      * CASE: CUR.TH Group Reference is Entered
     C           $JBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $JKQTX           Farm site Name
     C                     MOVEL$JBICD    $JKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0061  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0062  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0063  5        Building 1 USR
     C                     MOVEL*BLANK    WN0064  5        Room 1 USR
     C                     MOVEL*BLANK    WN0065  5        Building 2 USR
     C                     MOVEL*BLANK    WN0066  5        Room 2 USR
     C                     MOVEL*BLANK    WN0067  5        Building 3 USR
     C                     MOVEL*BLANK    WN0068  5        Room 3 USR
     C                     MOVEL*BLANK    WN0069  1        Status 1
     C                     MOVEL*BLANK    WN0070  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0071  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0072  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SQRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0063    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ':':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0063:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0064:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0070    CAT  WN0063:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0064:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0065    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0065:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0066:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0071:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0065:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0066:ZQ $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0067    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  ';':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  WN0067:ZQ $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  '/':ZQ    $JKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $JKQTX    CAT  WN0068:ZQ $JKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $JKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0069    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $JKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $JKQTX    CAT  '+':ZQ    $JKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SSRVGN
      * 10/31/01  Dont print Yard Deads on (H-) rcd because they are prin
      *  and counted on the (H+) record.
     C                     Z-ADD*ZERO     $JFCNB           TH Yard Deads
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $JNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR STRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SURVGN
     C                     MOVELWUBCTX    $KJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $KB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKB6DT
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print TH Kill Date of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print TH Schedule Kill Shift of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print TH Hog Class Type of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiving for Sbj PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP04
     C                     END                             FI
      * Print Detail line. of Prt Receiving for Sbj PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: CUR.TH Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0013    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0080  7        *Return code
     C                     PARM WBOXNB    WQ0081  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0082 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0083  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0084  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0085  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0014           Farm Site 3.0 U
     C                     MOVELYL0014    $MKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0073  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0074  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0075  5        Building 1 USR
     C                     MOVEL*BLANK    WN0076  5        Room 1 USR
     C                     MOVEL*BLANK    WN0077  5        Building 2 USR
     C                     MOVEL*BLANK    WN0078  5        Room 2 USR
     C                     MOVEL*BLANK    WN0079  5        Building 3 USR
     C                     MOVEL*BLANK    WN0080  5        Room 3 USR
     C                     MOVEL*BLANK    WN0081  1        Status 1
     C                     MOVEL*BLANK    WN0082  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0083  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0084  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SXRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0075    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ':':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0075:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0076:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0082    CAT  WN0075:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0076:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0077    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0077:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0078:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0083:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0077:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0078:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0079    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0079:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0080:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $MKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0081    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  '+':ZQ    $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBTHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WBTHHD    WQ0086  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0087  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $MKQTX           Farm site Name
     C                     MOVELWUWWTX    $MKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0085  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0086  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0087  5        Building 1 USR
     C                     MOVEL*BLANK    WN0088  5        Room 1 USR
     C                     MOVEL*BLANK    WN0089  5        Building 2 USR
     C                     MOVEL*BLANK    WN0090  5        Room 2 USR
     C                     MOVEL*BLANK    WN0091  5        Building 3 USR
     C                     MOVEL*BLANK    WN0092  5        Room 3 USR
     C                     MOVEL*BLANK    WN0093  1        Status 1
     C                     MOVEL*BLANK    WN0094  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0095  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0096  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SZRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0087    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ':':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0087:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0088:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0094    CAT  WN0087:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0088:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0089    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0089:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0090:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0095:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0089:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0090:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0091    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0091:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0092:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $MKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0093    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  '+':ZQ    $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 3/02/04 RMC use group ref if entered, else split farm/blg/room
      * CASE: CUR.TH Group Reference is Entered
     C           $MBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $MKQTX           Farm site Name
     C                     MOVEL$MBICD    $MKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0097  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0098  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0099  5        Building 1 USR
     C                     MOVEL*BLANK    WN0100  5        Room 1 USR
     C                     MOVEL*BLANK    WN0101  5        Building 2 USR
     C                     MOVEL*BLANK    WN0102  5        Room 2 USR
     C                     MOVEL*BLANK    WN0103  5        Building 3 USR
     C                     MOVEL*BLANK    WN0104  5        Room 3 USR
     C                     MOVEL*BLANK    WN0105  1        Status 1
     C                     MOVEL*BLANK    WN0106  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0107  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0108  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TBRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0099    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ':':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0099:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0100:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0106    CAT  WN0099:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0100:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0101    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0101:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0102:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0107:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0101:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0102:ZQ $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0103    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  ';':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  WN0103:ZQ $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  '/':ZQ    $MKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $MKQTX    CAT  WN0104:ZQ $MKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $MKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0105    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $MKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $MKQTX    CAT  '+':ZQ    $MKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           $MFCNB    MULT $MF7NB    $MCCNB           Yard dead weigh
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR TDRVGN
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           $MNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR TERVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TFRVGN
     C                     MOVELWUBCTX    $NJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $NB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VNB6DT
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$NCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$NDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print TH Kill Date of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print TH Schedule Kill Shift of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP02
     C                     END                             FI
      * Print TH Hog Class Type of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiv f/Shft H/o PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP04
     C                     END                             FI
      * Print Detail line. of Prt Receiv f/Shft H/o PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: CUR.TH Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0015    IFEQ 'N'                        *IF
      * E2423 FARM information by movement will not be used if live with
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0091  7        *Return code
     C                     PARM WCOXNB    WQ0092  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0093 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0094  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0095  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0096  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0016           Farm Site 3.0 U
     C                     MOVELYL0016    $PKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0109  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0110  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0111  5        Building 1 USR
     C                     MOVEL*BLANK    WN0112  5        Room 1 USR
     C                     MOVEL*BLANK    WN0113  5        Building 2 USR
     C                     MOVEL*BLANK    WN0114  5        Room 2 USR
     C                     MOVEL*BLANK    WN0115  5        Building 3 USR
     C                     MOVEL*BLANK    WN0116  5        Room 3 USR
     C                     MOVEL*BLANK    WN0117  1        Status 1
     C                     MOVEL*BLANK    WN0118  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0119  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0120  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR THRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0111    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ':':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0111:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0112:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0118    CAT  WN0111:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0112:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0113    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0113:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0114:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0119:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0113:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0114:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0115    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0115:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0116:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $PKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0117    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  '+':ZQ    $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0015    IFEQ 'Y'                        *IF
      * E2423 FARM information will start with the Tattoo Header
     C                     Z-ADDWCTHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WCTHHD    WQ0097  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0098  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $PKQTX           Farm site Name
     C                     MOVELWUWWTX    $PKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0121  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0122  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0123  5        Building 1 USR
     C                     MOVEL*BLANK    WN0124  5        Room 1 USR
     C                     MOVEL*BLANK    WN0125  5        Building 2 USR
     C                     MOVEL*BLANK    WN0126  5        Room 2 USR
     C                     MOVEL*BLANK    WN0127  5        Building 3 USR
     C                     MOVEL*BLANK    WN0128  5        Room 3 USR
     C                     MOVEL*BLANK    WN0129  1        Status 1
     C                     MOVEL*BLANK    WN0130  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0131  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0132  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TJRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0123    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ':':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0123:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0124:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0130    CAT  WN0123:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0124:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0125    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0125:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0126:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0131:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0125:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0126:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0127    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0127:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0128:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $PKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0129    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  '+':ZQ    $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 3/04/04 RMC Use group ref if entered, else split farm/bldng/room
      * CASE: CUR.TH Group Reference is Entered
     C           $PBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $PKQTX           Farm site Name
     C                     MOVEL$PBICD    $PKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0133  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0134  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0135  5        Building 1 USR
     C                     MOVEL*BLANK    WN0136  5        Room 1 USR
     C                     MOVEL*BLANK    WN0137  5        Building 2 USR
     C                     MOVEL*BLANK    WN0138  5        Room 2 USR
     C                     MOVEL*BLANK    WN0139  5        Building 3 USR
     C                     MOVEL*BLANK    WN0140  5        Room 3 USR
     C                     MOVEL*BLANK    WN0141  1        Status 1
     C                     MOVEL*BLANK    WN0142  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0143  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0144  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TLRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0135    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ':':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0135:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0136:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0142    CAT  WN0135:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0136:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0137    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0137:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0138:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0143:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0137:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0138:ZQ $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0139    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  ';':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  WN0139:ZQ $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  '/':ZQ    $PKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $PKQTX    CAT  WN0140:ZQ $PKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $PKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0141    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $PKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $PKQTX    CAT  '+':ZQ    $PKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * print producer site 2013/01/08
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR TNRVGN
      * Calc th live wgt from nbr of head held over; zero out hd rcvd
     C                     MOVEL'S+'      $PNGST           @Status (Held o
     C           $PT2HD    MULT $PF7NB    $PCYNB           TH Live Wgt
     C                     Z-ADD$PCYNB    $PVMNB           Shift held over
     C                     Z-ADD*ZERO     $PCWNB           TH Head Receive
      * 10/31/01 Dont print YardDead here, YD are printed/counted on (S-)
     C                     Z-ADD*ZERO     $PFCNB           TH Yard Deads
      * 10/24/11 Dont print EUL/KOA/LFT SINCE are printed/counted on (S-)
     C                     Z-ADD*ZERO     $PECDT           TH Head LFT
     C                     Z-ADD*ZERO     $PEDDT           TH Head EUT/KOA
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $PNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$PCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$PDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR TORVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TPRVGN
     C                     MOVELWUBCTX    $QJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $QB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VQB6DT
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE$QCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE$QDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Print First Page Format of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0IL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP01
     C                     END                             FI
      * Print BOL Load Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiving for Hld PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0IP03
     C                     END                             FI
      * Print Detail line. of Prt Receiving for Hld PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ICDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0IPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0IPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'H-'      $RNGST           @Status (Held o
      * CASE: CUR.TH Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0009    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0105  7        *Return code
     C                     PARM WAOXNB    WQ0106  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0107 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0108  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0109  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0110  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0010           Farm Site 3.0 U
     C                     MOVELYL0010    $RKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0145  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0146  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0147  5        Building 1 USR
     C                     MOVEL*BLANK    WN0148  5        Room 1 USR
     C                     MOVEL*BLANK    WN0149  5        Building 2 USR
     C                     MOVEL*BLANK    WN0150  5        Room 2 USR
     C                     MOVEL*BLANK    WN0151  5        Building 3 USR
     C                     MOVEL*BLANK    WN0152  5        Room 3 USR
     C                     MOVEL*BLANK    WN0153  1        Status 1
     C                     MOVEL*BLANK    WN0154  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0155  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0156  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TRRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0147    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ':':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0147:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0148:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0154    CAT  WN0147:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0148:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0149    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0149:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0150:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0155:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0149:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0150:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0151    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0151:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0152:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $RKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0153    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  '+':ZQ    $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0009    IFEQ 'Y'                        *IF
     C                     Z-ADDWATHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WATHHD    WQ0111  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0112  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $RKQTX           Farm site Name
     C                     MOVELWUWWTX    $RKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0157  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0158  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0159  5        Building 1 USR
     C                     MOVEL*BLANK    WN0160  5        Room 1 USR
     C                     MOVEL*BLANK    WN0161  5        Building 2 USR
     C                     MOVEL*BLANK    WN0162  5        Room 2 USR
     C                     MOVEL*BLANK    WN0163  5        Building 3 USR
     C                     MOVEL*BLANK    WN0164  5        Room 3 USR
     C                     MOVEL*BLANK    WN0165  1        Status 1
     C                     MOVEL*BLANK    WN0166  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0167  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0168  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TTRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0159    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ':':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0159:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0160:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0166    CAT  WN0159:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0160:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0161    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0161:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0162:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0167:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0161:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0162:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0163    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0163:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0164:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $RKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0165    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  '+':ZQ    $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 03/02/04 RMC If External, prt group ref if entered, else get farm
      * CASE: CUR.TH Group Reference is Entered
     C           $RBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $RKQTX           Farm site Name
     C                     MOVEL$RBICD    $RKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0169  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0170  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0171  5        Building 1 USR
     C                     MOVEL*BLANK    WN0172  5        Room 1 USR
     C                     MOVEL*BLANK    WN0173  5        Building 2 USR
     C                     MOVEL*BLANK    WN0174  5        Room 2 USR
     C                     MOVEL*BLANK    WN0175  5        Building 3 USR
     C                     MOVEL*BLANK    WN0176  5        Room 3 USR
     C                     MOVEL*BLANK    WN0177  1        Status 1
     C                     MOVEL*BLANK    WN0178  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0179  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0180  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TVRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0171    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ':':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0171:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0172:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0178    CAT  WN0171:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0172:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0173    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0173:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0174:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0179:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0173:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0174:ZQ $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0175    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  ';':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  WN0175:ZQ $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  '/':ZQ    $RKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $RKQTX    CAT  WN0176:ZQ $RKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $RKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0177    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $RKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $RKQTX    CAT  '+':ZQ    $RKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR TXRVGN
      * 10/31/01  Dont print Yard Deads on (H-) rcd because they are prin
      *  and counted on the (H+) record.
     C                     Z-ADD*ZERO     $RFCNB           TH Yard Deads
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $RNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ICDT    IFEQ 'Y'
     C                     WRITE$RCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ICDT
     C                     END                             FI
      * Print format
     C                     WRITE$RDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0IPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0JL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0JP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0JCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0JPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0JPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR TYRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TZRVGN
     C                     MOVELWUBCTX    $SJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $SB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VSB6DT
      * Print column headings if required
     C           W0JCDT    IFEQ 'Y'
     C                     WRITE$SCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0JCDT
     C                     END                             FI
      * Print format
     C                     WRITE$SDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0JPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Receiving Rpt     PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  10        W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiving Rpt     PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Receiving Rpt     PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * TH Schedule Kill Shift of Prt Receiving Rpt     PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * TH Hog Class Type of Prt Receiving Rpt     PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiving Rpt     PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiving Rpt     PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Receiving for Hld PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiving for Hld PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Receiving for Hld PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Receiving for Hld PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiving for Hld PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiving for Hld PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Receiving for Sbj PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiving for Sbj PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Receiving for Sbj PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Schedule Kill Shift of Prt Receiving for Sbj PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Hog Class Type of Prt Receiving for Sbj PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiving for Sbj PO
     C           W0EP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiving for Sbj PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0FP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0FP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0FP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Receiv f/Shft H/o PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiv f/Shft H/o PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Receiv f/Shft H/o PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Schedule Kill Shift of Prt Receiv f/Shft H/o PO
     C           W0GP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Hog Class Type of Prt Receiv f/Shft H/o PO
     C           W0GP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiv f/Shft H/o PO
     C           W0GP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiv f/Shft H/o PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0HP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0HP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0HP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Receiving for Hld PO
     C           W0IP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiving for Hld PO
     C           W0IP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Receiving for Hld PO
     C           W0IP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Receiving for Hld PO
     C           W0IP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiving for Hld PO
     C           W0IP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiving for Hld PO
     C           W0IPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ICDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0JP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0JP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0JP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0JP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0JP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0JP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0JPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0JCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Source Desc       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVEL$CAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSA     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAAFTX    $CAFTX           SR Description
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$CABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $CA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$HHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$HBONB    DNBONB           BOL Load Number
     C                     Z-ADD$HCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSC     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HNYCD           PS Site ID
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $HNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           DT Farm Site Co
     C                     MOVEL*BLANK    WN0002           DT Full/Split L
     C                     MOVEL*BLANK    WN0003           Building 1 USR
     C                     MOVEL*BLANK    WN0004           Room 1 USR
     C                     MOVEL*BLANK    WN0005           Building 2 USR
     C                     MOVEL*BLANK    WN0006           Room 2 USR
     C                     MOVEL*BLANK    WN0007           Building 3 USR
     C                     MOVEL*BLANK    WN0008           Room 3 USR
     C                     MOVEL*BLANK    WN0009           Status 1
     C                     MOVEL*BLANK    WN0010           Farm 1 USR
     C                     MOVEL*BLANK    WN0011           Farm 2 USR
     C                     MOVEL*BLANK    WN0012           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSD03           BOL Load Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSD01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSD03           BOL Load Number
      * Establish starting position
     C           KRSSD     SETLL@AFCPI4                    *
     C           KRSSD     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0001           DT Farm Site Co
     C                     MOVELAFXIST    WN0002           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0003           Building 1 USR
     C                     MOVELAFK1CD    WN0004           Room 1 USR
     C                     MOVEL'N'       WN0009           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0009           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSE01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSE02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSE03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSE04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSE05           DT Delivery Tim
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
     C                     KFLD           WQSE02           DSH Kill Date
     C                     KFLD           WQSE03           DT Delivery Dat
     C                     KFLD           WQSE04           DT Delivery Tim
     C                     KFLD           WQSE05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSE01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSE02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSE03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSE04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSE05           DT Delivery Tim
      * Establish starting position
     C           KRSSE     SETLL@AJCPIY                    *
     C           KRSSE     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0003           Building 1 USR
     C                     MOVELAJK5CD    WN0004           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0010           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0005           Building 2 USR
     C                     MOVELAJK5CD    WN0006           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0011           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0007           Building 3 USR
     C                     MOVELAJK5CD    WN0008           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0012           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0009           Status 1
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSE     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0013           DT Farm Site Co
     C                     MOVEL*BLANK    WN0014           DT Full/Split L
     C                     MOVEL*BLANK    WN0015           Building 1 USR
     C                     MOVEL*BLANK    WN0016           Room 1 USR
     C                     MOVEL*BLANK    WN0017           Building 2 USR
     C                     MOVEL*BLANK    WN0018           Room 2 USR
     C                     MOVEL*BLANK    WN0019           Building 3 USR
     C                     MOVEL*BLANK    WN0020           Room 3 USR
     C                     MOVEL*BLANK    WN0021           Status 1
     C                     MOVEL*BLANK    WN0022           Farm 1 USR
     C                     MOVEL*BLANK    WN0023           Farm 2 USR
     C                     MOVEL*BLANK    WN0024           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSF03           BOL Load Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSF03           BOL Load Number
      * Establish starting position
     C           KRSSF     SETLL@AFCPI4                    *
     C           KRSSF     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0013           DT Farm Site Co
     C                     MOVELAFXIST    WN0014           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0015           Building 1 USR
     C                     MOVELAFK1CD    WN0016           Room 1 USR
     C                     MOVEL'N'       WN0021           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0021           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSG01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSG02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSG03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSG04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSG05           DT Delivery Tim
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CC Company Numb
     C                     KFLD           WQSG02           DSH Kill Date
     C                     KFLD           WQSG03           DT Delivery Dat
     C                     KFLD           WQSG04           DT Delivery Tim
     C                     KFLD           WQSG05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSG01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSG02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSG03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSG04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSG05           DT Delivery Tim
      * Establish starting position
     C           KRSSG     SETLL@AJCPIY                    *
     C           KRSSG     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0015           Building 1 USR
     C                     MOVELAJK5CD    WN0016           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0022           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0017           Building 2 USR
     C                     MOVELAJK5CD    WN0018           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0023           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0019           Building 3 USR
     C                     MOVELAJK5CD    WN0020           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0024           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0021           Status 1
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSG     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0025           DT Farm Site Co
     C                     MOVEL*BLANK    WN0026           DT Full/Split L
     C                     MOVEL*BLANK    WN0027           Building 1 USR
     C                     MOVEL*BLANK    WN0028           Room 1 USR
     C                     MOVEL*BLANK    WN0029           Building 2 USR
     C                     MOVEL*BLANK    WN0030           Room 2 USR
     C                     MOVEL*BLANK    WN0031           Building 3 USR
     C                     MOVEL*BLANK    WN0032           Room 3 USR
     C                     MOVEL*BLANK    WN0033           Status 1
     C                     MOVEL*BLANK    WN0034           Farm 1 USR
     C                     MOVEL*BLANK    WN0035           Farm 2 USR
     C                     MOVEL*BLANK    WN0036           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSH03           BOL Load Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSH01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSH03           BOL Load Number
      * Establish starting position
     C           KRSSH     SETLL@AFCPI4                    *
     C           KRSSH     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0025           DT Farm Site Co
     C                     MOVELAFXIST    WN0026           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0027           Building 1 USR
     C                     MOVELAFK1CD    WN0028           Room 1 USR
     C                     MOVEL'N'       WN0033           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0033           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSI01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSI02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSI03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSI04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSI05           DT Delivery Tim
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CC Company Numb
     C                     KFLD           WQSI02           DSH Kill Date
     C                     KFLD           WQSI03           DT Delivery Dat
     C                     KFLD           WQSI04           DT Delivery Tim
     C                     KFLD           WQSI05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSI01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSI02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSI03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSI04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSI05           DT Delivery Tim
      * Establish starting position
     C           KRSSI     SETLL@AJCPIY                    *
     C           KRSSI     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0027           Building 1 USR
     C                     MOVELAJK5CD    WN0028           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0034           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0029           Building 2 USR
     C                     MOVELAJK5CD    WN0030           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0035           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0031           Building 3 USR
     C                     MOVELAJK5CD    WN0032           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0036           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0033           Status 1
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSI     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQSJ04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQSJ05           TH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
     C                     KFLD           WQSJ05           TH Kill Date
      * Setup key
     C                     Z-ADD$IHMNB    WQSJ01           BOH Company Num
     C                     Z-ADD$IBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQSJ03           BOL Load Number
     C                     Z-ADD$ICVNB    WQSJ04           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    WQSJ05           TH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@B3CPHL                    *
     C           KRSSJ     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $IB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $IANTM           TST Wgt Time
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $IB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $IANTM           TST Wgt Time
     C           KRSSJ     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$IBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSL     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0037           DT Farm Site Co
     C                     MOVEL*BLANK    WN0038           DT Full/Split L
     C                     MOVEL*BLANK    WN0039           Building 1 USR
     C                     MOVEL*BLANK    WN0040           Room 1 USR
     C                     MOVEL*BLANK    WN0041           Building 2 USR
     C                     MOVEL*BLANK    WN0042           Room 2 USR
     C                     MOVEL*BLANK    WN0043           Building 3 USR
     C                     MOVEL*BLANK    WN0044           Room 3 USR
     C                     MOVEL*BLANK    WN0045           Status 1
     C                     MOVEL*BLANK    WN0046           Farm 1 USR
     C                     MOVEL*BLANK    WN0047           Farm 2 USR
     C                     MOVEL*BLANK    WN0048           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSM03           BOL Load Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
      * Setup key
     C                     Z-ADD$JHMNB    WQSM01           BOH Company Num
     C                     Z-ADD$JBNNB    WQSM02           BOH Buy Order N
     C                     Z-ADD$JBONB    WQSM03           BOL Load Number
      * Establish starting position
     C           KRSSM     SETLL@AFCPI4                    *
     C           KRSSM     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0037           DT Farm Site Co
     C                     MOVELAFXIST    WN0038           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SNRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0039           Building 1 USR
     C                     MOVELAFK1CD    WN0040           Room 1 USR
     C                     MOVEL'N'       WN0045           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0045           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSN01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSN02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSN03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSN04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSN05           DT Delivery Tim
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CC Company Numb
     C                     KFLD           WQSN02           DSH Kill Date
     C                     KFLD           WQSN03           DT Delivery Dat
     C                     KFLD           WQSN04           DT Delivery Tim
     C                     KFLD           WQSN05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSN01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSN02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSN03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSN04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSN05           DT Delivery Tim
      * Establish starting position
     C           KRSSN     SETLL@AJCPIY                    *
     C           KRSSN     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0039           Building 1 USR
     C                     MOVELAJK5CD    WN0040           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0046           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0041           Building 2 USR
     C                     MOVELAJK5CD    WN0042           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0047           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0043           Building 3 USR
     C                     MOVELAJK5CD    WN0044           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0048           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0045           Status 1
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSN     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0049           DT Farm Site Co
     C                     MOVEL*BLANK    WN0050           DT Full/Split L
     C                     MOVEL*BLANK    WN0051           Building 1 USR
     C                     MOVEL*BLANK    WN0052           Room 1 USR
     C                     MOVEL*BLANK    WN0053           Building 2 USR
     C                     MOVEL*BLANK    WN0054           Room 2 USR
     C                     MOVEL*BLANK    WN0055           Building 3 USR
     C                     MOVEL*BLANK    WN0056           Room 3 USR
     C                     MOVEL*BLANK    WN0057           Status 1
     C                     MOVEL*BLANK    WN0058           Farm 1 USR
     C                     MOVEL*BLANK    WN0059           Farm 2 USR
     C                     MOVEL*BLANK    WN0060           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSO03           BOL Load Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
      * Setup key
     C                     Z-ADD$JHMNB    WQSO01           BOH Company Num
     C                     Z-ADD$JBNNB    WQSO02           BOH Buy Order N
     C                     Z-ADD$JBONB    WQSO03           BOL Load Number
      * Establish starting position
     C           KRSSO     SETLL@AFCPI4                    *
     C           KRSSO     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0049           DT Farm Site Co
     C                     MOVELAFXIST    WN0050           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SPRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0051           Building 1 USR
     C                     MOVELAFK1CD    WN0052           Room 1 USR
     C                     MOVEL'N'       WN0057           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0057           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSP01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSP02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSP03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSP04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSP05           DT Delivery Tim
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           CC Company Numb
     C                     KFLD           WQSP02           DSH Kill Date
     C                     KFLD           WQSP03           DT Delivery Dat
     C                     KFLD           WQSP04           DT Delivery Tim
     C                     KFLD           WQSP05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSP01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSP02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSP03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSP04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSP05           DT Delivery Tim
      * Establish starting position
     C           KRSSP     SETLL@AJCPIY                    *
     C           KRSSP     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0051           Building 1 USR
     C                     MOVELAJK5CD    WN0052           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0058           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0053           Building 2 USR
     C                     MOVELAJK5CD    WN0054           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0059           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0055           Building 3 USR
     C                     MOVELAJK5CD    WN0056           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0060           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0057           Status 1
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSP     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0061           DT Farm Site Co
     C                     MOVEL*BLANK    WN0062           DT Full/Split L
     C                     MOVEL*BLANK    WN0063           Building 1 USR
     C                     MOVEL*BLANK    WN0064           Room 1 USR
     C                     MOVEL*BLANK    WN0065           Building 2 USR
     C                     MOVEL*BLANK    WN0066           Room 2 USR
     C                     MOVEL*BLANK    WN0067           Building 3 USR
     C                     MOVEL*BLANK    WN0068           Room 3 USR
     C                     MOVEL*BLANK    WN0069           Status 1
     C                     MOVEL*BLANK    WN0070           Farm 1 USR
     C                     MOVEL*BLANK    WN0071           Farm 2 USR
     C                     MOVEL*BLANK    WN0072           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSQ03           BOL Load Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
      * Setup key
     C                     Z-ADD$JHMNB    WQSQ01           BOH Company Num
     C                     Z-ADD$JBNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADD$JBONB    WQSQ03           BOL Load Number
      * Establish starting position
     C           KRSSQ     SETLL@AFCPI4                    *
     C           KRSSQ     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0061           DT Farm Site Co
     C                     MOVELAFXIST    WN0062           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SRRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0063           Building 1 USR
     C                     MOVELAFK1CD    WN0064           Room 1 USR
     C                     MOVEL'N'       WN0069           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0069           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSR01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSR02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSR03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSR04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSR05           DT Delivery Tim
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           CC Company Numb
     C                     KFLD           WQSR02           DSH Kill Date
     C                     KFLD           WQSR03           DT Delivery Dat
     C                     KFLD           WQSR04           DT Delivery Tim
     C                     KFLD           WQSR05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSR01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSR02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSR03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSR04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSR05           DT Delivery Tim
      * Establish starting position
     C           KRSSR     SETLL@AJCPIY                    *
     C           KRSSR     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0063           Building 1 USR
     C                     MOVELAJK5CD    WN0064           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0070           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0065           Building 2 USR
     C                     MOVELAJK5CD    WN0066           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0071           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0067           Building 3 USR
     C                     MOVELAJK5CD    WN0068           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0072           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0069           Status 1
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSR     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$JHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$JBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$JBONB    DNBONB           BOL Load Number
     C                     Z-ADD$JCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$JB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSS     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $JNYCD           PS Site ID
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $JNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQST03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQST04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQST05           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Tattoo Numbe
     C                     KFLD           WQST05           TH Kill Date
      * Setup key
     C                     Z-ADD$KHMNB    WQST01           BOH Company Num
     C                     Z-ADD$KBNNB    WQST02           BOH Buy Order N
     C                     Z-ADD$KBONB    WQST03           BOL Load Number
     C                     Z-ADD$KCVNB    WQST04           TH Tattoo Numbe
     C                     Z-ADD$KB0DT    WQST05           TH Kill Date
      * Establish starting position
     C           KRSST     SETLL@B3CPHL                    *
     C           KRSST     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $KB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $KANTM           TST Wgt Time
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $KB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $KANTM           TST Wgt Time
     C           KRSST     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$KBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSU     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSV     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO SVEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Load Type for HO  RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSW03           BOL Load Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
     C                     KFLD           AFE0DT           DSH Kill Date
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
      * Setup key
     C                     Z-ADDA1HMNB    WQSW01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSW02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSW03           BOL Load Number
     C                     Z-ADDYL0011    AFE0DT           DSH Kill Date
      * Establish starting position
     C           KPSSW     SETLL@AFCPI4                    *
     C           KRSSW     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0012           DT Load Type
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFXHST    YL0012           DT Load Type
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0073           DT Farm Site Co
     C                     MOVEL*BLANK    WN0074           DT Full/Split L
     C                     MOVEL*BLANK    WN0075           Building 1 USR
     C                     MOVEL*BLANK    WN0076           Room 1 USR
     C                     MOVEL*BLANK    WN0077           Building 2 USR
     C                     MOVEL*BLANK    WN0078           Room 2 USR
     C                     MOVEL*BLANK    WN0079           Building 3 USR
     C                     MOVEL*BLANK    WN0080           Room 3 USR
     C                     MOVEL*BLANK    WN0081           Status 1
     C                     MOVEL*BLANK    WN0082           Farm 1 USR
     C                     MOVEL*BLANK    WN0083           Farm 2 USR
     C                     MOVEL*BLANK    WN0084           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSX01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSX02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSX03           BOL Load Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           BOH Company Num
     C                     KFLD           WQSX02           BOH Buy Order N
     C                     KFLD           WQSX03           BOL Load Number
      * Setup key
     C                     Z-ADD$MHMNB    WQSX01           BOH Company Num
     C                     Z-ADD$MBNNB    WQSX02           BOH Buy Order N
     C                     Z-ADD$MBONB    WQSX03           BOL Load Number
      * Establish starting position
     C           KRSSX     SETLL@AFCPI4                    *
     C           KRSSX     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0073           DT Farm Site Co
     C                     MOVELAFXIST    WN0074           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SYRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0075           Building 1 USR
     C                     MOVELAFK1CD    WN0076           Room 1 USR
     C                     MOVEL'N'       WN0081           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSX     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0081           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSY01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSY02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSY03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSY04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSY05           DT Delivery Tim
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           CC Company Numb
     C                     KFLD           WQSY02           DSH Kill Date
     C                     KFLD           WQSY03           DT Delivery Dat
     C                     KFLD           WQSY04           DT Delivery Tim
     C                     KFLD           WQSY05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSY01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSY02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSY03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSY04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSY05           DT Delivery Tim
      * Establish starting position
     C           KRSSY     SETLL@AJCPIY                    *
     C           KRSSY     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0075           Building 1 USR
     C                     MOVELAJK5CD    WN0076           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0082           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0077           Building 2 USR
     C                     MOVELAJK5CD    WN0078           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0083           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0079           Building 3 USR
     C                     MOVELAJK5CD    WN0080           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0084           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0081           Status 1
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSY     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0085           DT Farm Site Co
     C                     MOVEL*BLANK    WN0086           DT Full/Split L
     C                     MOVEL*BLANK    WN0087           Building 1 USR
     C                     MOVEL*BLANK    WN0088           Room 1 USR
     C                     MOVEL*BLANK    WN0089           Building 2 USR
     C                     MOVEL*BLANK    WN0090           Room 2 USR
     C                     MOVEL*BLANK    WN0091           Building 3 USR
     C                     MOVEL*BLANK    WN0092           Room 3 USR
     C                     MOVEL*BLANK    WN0093           Status 1
     C                     MOVEL*BLANK    WN0094           Farm 1 USR
     C                     MOVEL*BLANK    WN0095           Farm 2 USR
     C                     MOVEL*BLANK    WN0096           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSZ01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSZ02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSZ03           BOL Load Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           BOH Company Num
     C                     KFLD           WQSZ02           BOH Buy Order N
     C                     KFLD           WQSZ03           BOL Load Number
      * Setup key
     C                     Z-ADD$MHMNB    WQSZ01           BOH Company Num
     C                     Z-ADD$MBNNB    WQSZ02           BOH Buy Order N
     C                     Z-ADD$MBONB    WQSZ03           BOL Load Number
      * Establish starting position
     C           KRSSZ     SETLL@AFCPI4                    *
     C           KRSSZ     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0085           DT Farm Site Co
     C                     MOVELAFXIST    WN0086           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TARVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0087           Building 1 USR
     C                     MOVELAFK1CD    WN0088           Room 1 USR
     C                     MOVEL'N'       WN0093           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSZ     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0093           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTA01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTA02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTA03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTA04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTA05           DT Delivery Tim
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           CC Company Numb
     C                     KFLD           WQTA02           DSH Kill Date
     C                     KFLD           WQTA03           DT Delivery Dat
     C                     KFLD           WQTA04           DT Delivery Tim
     C                     KFLD           WQTA05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTA01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTA02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTA03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTA04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTA05           DT Delivery Tim
      * Establish starting position
     C           KRSTA     SETLL@AJCPIY                    *
     C           KRSTA     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0087           Building 1 USR
     C                     MOVELAJK5CD    WN0088           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0094           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0089           Building 2 USR
     C                     MOVELAJK5CD    WN0090           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0095           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0091           Building 3 USR
     C                     MOVELAJK5CD    WN0092           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0096           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0093           Status 1
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTA     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0097           DT Farm Site Co
     C                     MOVEL*BLANK    WN0098           DT Full/Split L
     C                     MOVEL*BLANK    WN0099           Building 1 USR
     C                     MOVEL*BLANK    WN0100           Room 1 USR
     C                     MOVEL*BLANK    WN0101           Building 2 USR
     C                     MOVEL*BLANK    WN0102           Room 2 USR
     C                     MOVEL*BLANK    WN0103           Building 3 USR
     C                     MOVEL*BLANK    WN0104           Room 3 USR
     C                     MOVEL*BLANK    WN0105           Status 1
     C                     MOVEL*BLANK    WN0106           Farm 1 USR
     C                     MOVEL*BLANK    WN0107           Farm 2 USR
     C                     MOVEL*BLANK    WN0108           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTB01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTB02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTB03           BOL Load Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           BOH Company Num
     C                     KFLD           WQTB02           BOH Buy Order N
     C                     KFLD           WQTB03           BOL Load Number
      * Setup key
     C                     Z-ADD$MHMNB    WQTB01           BOH Company Num
     C                     Z-ADD$MBNNB    WQTB02           BOH Buy Order N
     C                     Z-ADD$MBONB    WQTB03           BOL Load Number
      * Establish starting position
     C           KRSTB     SETLL@AFCPI4                    *
     C           KRSTB     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0097           DT Farm Site Co
     C                     MOVELAFXIST    WN0098           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0099           Building 1 USR
     C                     MOVELAFK1CD    WN0100           Room 1 USR
     C                     MOVEL'N'       WN0105           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTB     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0105           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTC01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTC02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTC03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTC04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTC05           DT Delivery Tim
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           CC Company Numb
     C                     KFLD           WQTC02           DSH Kill Date
     C                     KFLD           WQTC03           DT Delivery Dat
     C                     KFLD           WQTC04           DT Delivery Tim
     C                     KFLD           WQTC05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTC01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTC02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTC03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTC04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTC05           DT Delivery Tim
      * Establish starting position
     C           KRSTC     SETLL@AJCPIY                    *
     C           KRSTC     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0099           Building 1 USR
     C                     MOVELAJK5CD    WN0100           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0106           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0101           Building 2 USR
     C                     MOVELAJK5CD    WN0102           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0107           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0103           Building 3 USR
     C                     MOVELAJK5CD    WN0104           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0108           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0105           Status 1
     C                     GOTO TCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTC     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$MHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$MBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$MBONB    DNBONB           BOL Load Number
     C                     Z-ADD$MCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$MB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSTD     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $MNYCD           PS Site ID
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $MNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQTE01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQTE02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQTE03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQTE04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQTE05           TH Kill Date
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           BOH Company Num
     C                     KFLD           WQTE02           BOH Buy Order N
     C                     KFLD           WQTE03           BOL Load Number
     C                     KFLD           WQTE04           TH Tattoo Numbe
     C                     KFLD           WQTE05           TH Kill Date
      * Setup key
     C                     Z-ADD$NHMNB    WQTE01           BOH Company Num
     C                     Z-ADD$NBNNB    WQTE02           BOH Buy Order N
     C                     Z-ADD$NBONB    WQTE03           BOL Load Number
     C                     Z-ADD$NCVNB    WQTE04           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    WQTE05           TH Kill Date
      * Establish starting position
     C           KRSTE     SETLL@B3CPHL                    *
     C           KRSTE     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $NB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $NANTM           TST Wgt Time
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $NB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $NANTM           TST Wgt Time
     C           KRSTE     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$NBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTF     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSTG     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO TGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0109           DT Farm Site Co
     C                     MOVEL*BLANK    WN0110           DT Full/Split L
     C                     MOVEL*BLANK    WN0111           Building 1 USR
     C                     MOVEL*BLANK    WN0112           Room 1 USR
     C                     MOVEL*BLANK    WN0113           Building 2 USR
     C                     MOVEL*BLANK    WN0114           Room 2 USR
     C                     MOVEL*BLANK    WN0115           Building 3 USR
     C                     MOVEL*BLANK    WN0116           Room 3 USR
     C                     MOVEL*BLANK    WN0117           Status 1
     C                     MOVEL*BLANK    WN0118           Farm 1 USR
     C                     MOVEL*BLANK    WN0119           Farm 2 USR
     C                     MOVEL*BLANK    WN0120           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTH01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTH02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTH03           BOL Load Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           BOH Company Num
     C                     KFLD           WQTH02           BOH Buy Order N
     C                     KFLD           WQTH03           BOL Load Number
      * Setup key
     C                     Z-ADD$PHMNB    WQTH01           BOH Company Num
     C                     Z-ADD$PBNNB    WQTH02           BOH Buy Order N
     C                     Z-ADD$PBONB    WQTH03           BOL Load Number
      * Establish starting position
     C           KRSTH     SETLL@AFCPI4                    *
     C           KRSTH     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0109           DT Farm Site Co
     C                     MOVELAFXIST    WN0110           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TIRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0111           Building 1 USR
     C                     MOVELAFK1CD    WN0112           Room 1 USR
     C                     MOVEL'N'       WN0117           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTH     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0117           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTI01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTI02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTI03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTI04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTI05           DT Delivery Tim
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           CC Company Numb
     C                     KFLD           WQTI02           DSH Kill Date
     C                     KFLD           WQTI03           DT Delivery Dat
     C                     KFLD           WQTI04           DT Delivery Tim
     C                     KFLD           WQTI05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTI01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTI02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTI03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTI04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTI05           DT Delivery Tim
      * Establish starting position
     C           KRSTI     SETLL@AJCPIY                    *
     C           KRSTI     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0111           Building 1 USR
     C                     MOVELAJK5CD    WN0112           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0118           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0113           Building 2 USR
     C                     MOVELAJK5CD    WN0114           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0119           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0115           Building 3 USR
     C                     MOVELAJK5CD    WN0116           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0120           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0117           Status 1
     C                     GOTO TIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTI     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0121           DT Farm Site Co
     C                     MOVEL*BLANK    WN0122           DT Full/Split L
     C                     MOVEL*BLANK    WN0123           Building 1 USR
     C                     MOVEL*BLANK    WN0124           Room 1 USR
     C                     MOVEL*BLANK    WN0125           Building 2 USR
     C                     MOVEL*BLANK    WN0126           Room 2 USR
     C                     MOVEL*BLANK    WN0127           Building 3 USR
     C                     MOVEL*BLANK    WN0128           Room 3 USR
     C                     MOVEL*BLANK    WN0129           Status 1
     C                     MOVEL*BLANK    WN0130           Farm 1 USR
     C                     MOVEL*BLANK    WN0131           Farm 2 USR
     C                     MOVEL*BLANK    WN0132           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTJ01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTJ02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTJ03           BOL Load Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           BOH Company Num
     C                     KFLD           WQTJ02           BOH Buy Order N
     C                     KFLD           WQTJ03           BOL Load Number
      * Setup key
     C                     Z-ADD$PHMNB    WQTJ01           BOH Company Num
     C                     Z-ADD$PBNNB    WQTJ02           BOH Buy Order N
     C                     Z-ADD$PBONB    WQTJ03           BOL Load Number
      * Establish starting position
     C           KRSTJ     SETLL@AFCPI4                    *
     C           KRSTJ     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0121           DT Farm Site Co
     C                     MOVELAFXIST    WN0122           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TKRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0123           Building 1 USR
     C                     MOVELAFK1CD    WN0124           Room 1 USR
     C                     MOVEL'N'       WN0129           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTJ     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0129           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTK01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTK02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTK03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTK04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTK05           DT Delivery Tim
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           CC Company Numb
     C                     KFLD           WQTK02           DSH Kill Date
     C                     KFLD           WQTK03           DT Delivery Dat
     C                     KFLD           WQTK04           DT Delivery Tim
     C                     KFLD           WQTK05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTK01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTK02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTK03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTK04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTK05           DT Delivery Tim
      * Establish starting position
     C           KRSTK     SETLL@AJCPIY                    *
     C           KRSTK     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0123           Building 1 USR
     C                     MOVELAJK5CD    WN0124           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0130           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0125           Building 2 USR
     C                     MOVELAJK5CD    WN0126           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0131           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0127           Building 3 USR
     C                     MOVELAJK5CD    WN0128           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0132           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0129           Status 1
     C                     GOTO TKEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTK     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0133           DT Farm Site Co
     C                     MOVEL*BLANK    WN0134           DT Full/Split L
     C                     MOVEL*BLANK    WN0135           Building 1 USR
     C                     MOVEL*BLANK    WN0136           Room 1 USR
     C                     MOVEL*BLANK    WN0137           Building 2 USR
     C                     MOVEL*BLANK    WN0138           Room 2 USR
     C                     MOVEL*BLANK    WN0139           Building 3 USR
     C                     MOVEL*BLANK    WN0140           Room 3 USR
     C                     MOVEL*BLANK    WN0141           Status 1
     C                     MOVEL*BLANK    WN0142           Farm 1 USR
     C                     MOVEL*BLANK    WN0143           Farm 2 USR
     C                     MOVEL*BLANK    WN0144           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTL01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTL02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTL03           BOL Load Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           BOH Company Num
     C                     KFLD           WQTL02           BOH Buy Order N
     C                     KFLD           WQTL03           BOL Load Number
      * Setup key
     C                     Z-ADD$PHMNB    WQTL01           BOH Company Num
     C                     Z-ADD$PBNNB    WQTL02           BOH Buy Order N
     C                     Z-ADD$PBONB    WQTL03           BOL Load Number
      * Establish starting position
     C           KRSTL     SETLL@AFCPI4                    *
     C           KRSTL     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0133           DT Farm Site Co
     C                     MOVELAFXIST    WN0134           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TMRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0135           Building 1 USR
     C                     MOVELAFK1CD    WN0136           Room 1 USR
     C                     MOVEL'N'       WN0141           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTL     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0141           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTM01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTM02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTM03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTM04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTM05           DT Delivery Tim
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           CC Company Numb
     C                     KFLD           WQTM02           DSH Kill Date
     C                     KFLD           WQTM03           DT Delivery Dat
     C                     KFLD           WQTM04           DT Delivery Tim
     C                     KFLD           WQTM05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTM01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTM02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTM03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTM04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTM05           DT Delivery Tim
      * Establish starting position
     C           KRSTM     SETLL@AJCPIY                    *
     C           KRSTM     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0135           Building 1 USR
     C                     MOVELAJK5CD    WN0136           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0142           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0137           Building 2 USR
     C                     MOVELAJK5CD    WN0138           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0143           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0139           Building 3 USR
     C                     MOVELAJK5CD    WN0140           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0144           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0141           Status 1
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTM     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$PHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$PBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$PBONB    DNBONB           BOL Load Number
     C                     Z-ADD$PCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$PB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSTN     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $PNYCD           PS Site ID
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $PNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQTO01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQTO02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQTO03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQTO04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQTO05           TH Kill Date
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           BOH Company Num
     C                     KFLD           WQTO02           BOH Buy Order N
     C                     KFLD           WQTO03           BOL Load Number
     C                     KFLD           WQTO04           TH Tattoo Numbe
     C                     KFLD           WQTO05           TH Kill Date
      * Setup key
     C                     Z-ADD$QHMNB    WQTO01           BOH Company Num
     C                     Z-ADD$QBNNB    WQTO02           BOH Buy Order N
     C                     Z-ADD$QBONB    WQTO03           BOL Load Number
     C                     Z-ADD$QCVNB    WQTO04           TH Tattoo Numbe
     C                     Z-ADD$QB0DT    WQTO05           TH Kill Date
      * Establish starting position
     C           KRSTO     SETLL@B3CPHL                    *
     C           KRSTO     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $QB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $QANTM           TST Wgt Time
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $QB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $QANTM           TST Wgt Time
     C           KRSTO     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$QBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTP     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSTQ     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO TQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0145           DT Farm Site Co
     C                     MOVEL*BLANK    WN0146           DT Full/Split L
     C                     MOVEL*BLANK    WN0147           Building 1 USR
     C                     MOVEL*BLANK    WN0148           Room 1 USR
     C                     MOVEL*BLANK    WN0149           Building 2 USR
     C                     MOVEL*BLANK    WN0150           Room 2 USR
     C                     MOVEL*BLANK    WN0151           Building 3 USR
     C                     MOVEL*BLANK    WN0152           Room 3 USR
     C                     MOVEL*BLANK    WN0153           Status 1
     C                     MOVEL*BLANK    WN0154           Farm 1 USR
     C                     MOVEL*BLANK    WN0155           Farm 2 USR
     C                     MOVEL*BLANK    WN0156           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTR01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTR02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTR03           BOL Load Number
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           BOH Company Num
     C                     KFLD           WQTR02           BOH Buy Order N
     C                     KFLD           WQTR03           BOL Load Number
      * Setup key
     C                     Z-ADD$RHMNB    WQTR01           BOH Company Num
     C                     Z-ADD$RBNNB    WQTR02           BOH Buy Order N
     C                     Z-ADD$RBONB    WQTR03           BOL Load Number
      * Establish starting position
     C           KRSTR     SETLL@AFCPI4                    *
     C           KRSTR     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0145           DT Farm Site Co
     C                     MOVELAFXIST    WN0146           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TSRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0147           Building 1 USR
     C                     MOVELAFK1CD    WN0148           Room 1 USR
     C                     MOVEL'N'       WN0153           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTR     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0153           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTS01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTS02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTS03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTS04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTS05           DT Delivery Tim
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           CC Company Numb
     C                     KFLD           WQTS02           DSH Kill Date
     C                     KFLD           WQTS03           DT Delivery Dat
     C                     KFLD           WQTS04           DT Delivery Tim
     C                     KFLD           WQTS05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTS01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTS02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTS03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTS04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTS05           DT Delivery Tim
      * Establish starting position
     C           KRSTS     SETLL@AJCPIY                    *
     C           KRSTS     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0147           Building 1 USR
     C                     MOVELAJK5CD    WN0148           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0154           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0149           Building 2 USR
     C                     MOVELAJK5CD    WN0150           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0155           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0151           Building 3 USR
     C                     MOVELAJK5CD    WN0152           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0156           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0153           Status 1
     C                     GOTO TSEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTS     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0157           DT Farm Site Co
     C                     MOVEL*BLANK    WN0158           DT Full/Split L
     C                     MOVEL*BLANK    WN0159           Building 1 USR
     C                     MOVEL*BLANK    WN0160           Room 1 USR
     C                     MOVEL*BLANK    WN0161           Building 2 USR
     C                     MOVEL*BLANK    WN0162           Room 2 USR
     C                     MOVEL*BLANK    WN0163           Building 3 USR
     C                     MOVEL*BLANK    WN0164           Room 3 USR
     C                     MOVEL*BLANK    WN0165           Status 1
     C                     MOVEL*BLANK    WN0166           Farm 1 USR
     C                     MOVEL*BLANK    WN0167           Farm 2 USR
     C                     MOVEL*BLANK    WN0168           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTT01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTT02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTT03           BOL Load Number
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           BOH Company Num
     C                     KFLD           WQTT02           BOH Buy Order N
     C                     KFLD           WQTT03           BOL Load Number
      * Setup key
     C                     Z-ADD$RHMNB    WQTT01           BOH Company Num
     C                     Z-ADD$RBNNB    WQTT02           BOH Buy Order N
     C                     Z-ADD$RBONB    WQTT03           BOL Load Number
      * Establish starting position
     C           KRSTT     SETLL@AFCPI4                    *
     C           KRSTT     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0157           DT Farm Site Co
     C                     MOVELAFXIST    WN0158           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TURVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0159           Building 1 USR
     C                     MOVELAFK1CD    WN0160           Room 1 USR
     C                     MOVEL'N'       WN0165           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTT     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0165           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTU01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTU02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTU03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTU04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTU05           DT Delivery Tim
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           CC Company Numb
     C                     KFLD           WQTU02           DSH Kill Date
     C                     KFLD           WQTU03           DT Delivery Dat
     C                     KFLD           WQTU04           DT Delivery Tim
     C                     KFLD           WQTU05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTU01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTU02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTU03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTU04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTU05           DT Delivery Tim
      * Establish starting position
     C           KRSTU     SETLL@AJCPIY                    *
     C           KRSTU     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0159           Building 1 USR
     C                     MOVELAJK5CD    WN0160           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0166           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0161           Building 2 USR
     C                     MOVELAJK5CD    WN0162           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0167           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0163           Building 3 USR
     C                     MOVELAJK5CD    WN0164           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0168           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0165           Status 1
     C                     GOTO TUEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTU     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0169           DT Farm Site Co
     C                     MOVEL*BLANK    WN0170           DT Full/Split L
     C                     MOVEL*BLANK    WN0171           Building 1 USR
     C                     MOVEL*BLANK    WN0172           Room 1 USR
     C                     MOVEL*BLANK    WN0173           Building 2 USR
     C                     MOVEL*BLANK    WN0174           Room 2 USR
     C                     MOVEL*BLANK    WN0175           Building 3 USR
     C                     MOVEL*BLANK    WN0176           Room 3 USR
     C                     MOVEL*BLANK    WN0177           Status 1
     C                     MOVEL*BLANK    WN0178           Farm 1 USR
     C                     MOVEL*BLANK    WN0179           Farm 2 USR
     C                     MOVEL*BLANK    WN0180           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTV01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTV02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTV03           BOL Load Number
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           BOH Company Num
     C                     KFLD           WQTV02           BOH Buy Order N
     C                     KFLD           WQTV03           BOL Load Number
      * Setup key
     C                     Z-ADD$RHMNB    WQTV01           BOH Company Num
     C                     Z-ADD$RBNNB    WQTV02           BOH Buy Order N
     C                     Z-ADD$RBONB    WQTV03           BOL Load Number
      * Establish starting position
     C           KRSTV     SETLL@AFCPI4                    *
     C           KRSTV     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0169           DT Farm Site Co
     C                     MOVELAFXIST    WN0170           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TWRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0171           Building 1 USR
     C                     MOVELAFK1CD    WN0172           Room 1 USR
     C                     MOVEL'N'       WN0177           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTV     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0177           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTW01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTW02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTW03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTW04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTW05           DT Delivery Tim
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW01           CC Company Numb
     C                     KFLD           WQTW02           DSH Kill Date
     C                     KFLD           WQTW03           DT Delivery Dat
     C                     KFLD           WQTW04           DT Delivery Tim
     C                     KFLD           WQTW05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTW01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTW02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTW03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTW04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTW05           DT Delivery Tim
      * Establish starting position
     C           KRSTW     SETLL@AJCPIY                    *
     C           KRSTW     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0171           Building 1 USR
     C                     MOVELAJK5CD    WN0172           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0178           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0173           Building 2 USR
     C                     MOVELAJK5CD    WN0174           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0179           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0175           Building 3 USR
     C                     MOVELAJK5CD    WN0176           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0180           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0177           Status 1
     C                     GOTO TWEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTW     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$RHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$RBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$RBONB    DNBONB           BOL Load Number
     C                     Z-ADD$RCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$RB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSTX     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $RNYCD           PS Site ID
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $RNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQTY01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQTY02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQTY03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQTY04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQTY05           TH Kill Date
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WQTY01           BOH Company Num
     C                     KFLD           WQTY02           BOH Buy Order N
     C                     KFLD           WQTY03           BOL Load Number
     C                     KFLD           WQTY04           TH Tattoo Numbe
     C                     KFLD           WQTY05           TH Kill Date
      * Setup key
     C                     Z-ADD$SHMNB    WQTY01           BOH Company Num
     C                     Z-ADD$SBNNB    WQTY02           BOH Buy Order N
     C                     Z-ADD$SBONB    WQTY03           BOL Load Number
     C                     Z-ADD$SCVNB    WQTY04           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    WQTY05           TH Kill Date
      * Establish starting position
     C           KRSTY     SETLL@B3CPHL                    *
     C           KRSTY     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $SB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $SANTM           TST Wgt Time
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $SB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $SANTM           TST Wgt Time
     C           KRSTY     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$SBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTZ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * HD85970 BB 10/14/21 - Check prior record for Load Type
      *                       For the Receiving Report, position on the
      *                       Kill Date prior to the report selected date
      * E11245 JJH 07/17/17 - Add record selection by Source Code
      * E3814  JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * ELDTYPE JBB 10/26/17 - Add selection for  Load Type
      *   Add Load Type input parm and selection to this report.  Retriev
      *   Load Type from Deleivery Tracking.
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0028  30       BOH Company Num
     C                     PARM @CN,002   WQ0029 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0030 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Receiving for Hld PO
      *================================================================
      * If TATTOO is Held over until tomorrow's kill
      * CASE: CUR.TH Held Over is *Zeros
     C           $HH9NB    IFEQ *ZERO                      *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * if Shift held over too dont print the H- here, do it in the shift
      * CASE: CUR.TH Shift Held Over is Yes
     C           $HLJST    IFEQ 'Y'                        *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Prt Receiving for Hld PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $HHMNB    WQ0060  30       BOH Company Num
     C                     PARM @CN,002   WQ0061 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0062 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0009           MTech Live Yes
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Receiving for Sbj PO
      *================================================================
      * CASE: CUR.TH Hog Class Type is Resale
     C           $VLLST    IFEQ 'R'                        *IF
     C                     GOTO UGEXIT                     *QUIT
     C                     END                             *FI
      * Prt Receiving for Sbj PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0077  30       BOH Company Num
     C                     PARM @CN,002   WQ0078 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0079 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0013           MTech Live Yes
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) $OB0DT' defaulted for 'TH Kill Date'.
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Receiv f/Shft H/o PO
      *================================================================
      * If kill shift is 1, fall out, else
      * if kill shift is 2, go get shift held overs from shift 1
      * Skip shift 1
      * CASE: WRK.TH Schedule Kill Shift is Shift 1
     C           WULIST    IFEQ '1'                        *IF
     C                     GOTO UJEXIT                     *QUIT
     C                     END                             *FI
      * Skip resale
      * CASE: CUR.TH Hog Class Type is Resale
     C           $VLLST    IFEQ 'R'                        *IF
     C                     GOTO UJEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     WUCDNB           Head held over
     C                     Z-ADD*ZERO     WUHWHD           Head held over
     C                     Z-ADD*ZERO     WUHDWT           Head Received w
     C                     Z-ADD*ZERO     WUHSHD           Head Shift w/wg
      * C4677:  Shift Held over DOA and Yard Deads shouldn't be counted
     C                     Z-ADD*ZERO     WUHD5U           DOA Head Total
     C                     Z-ADD*ZERO     WUSRA1           LFT Head Total
     C                     Z-ADD*ZERO     WUSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     WUXRNB           Head Total Sum2
      * Prt Receiv f/Shft H/o PO: Mainline
     C                     EXSR G0MAIN
     C                     ADD  WUCDNB    $VCDNB           Head held over
     C                     ADD  WUQLNB    $VQLNB           Live Weight 2 S
     C                     ADD  WUHWHD    $VHWHD           Head held over
     C                     ADD  WUHDWT    $VHDWT           Head Received w
     C                     ADD  WUHSHD    $VHSHD           Head Shift w/wg
     C                     ADD  WUXRNB    $VXRNB           Head Total Sum2
     C                     ADD  WUHD5U    $VHD5U           DOA Head Total
     C                     ADD  WUSRA1    $VSRA1           LFT Head Total
     C                     ADD  WUSSA1    $VSSA1           EUT/KOA Head To
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0088  30       BOH Company Num
     C                     PARM @CN,002   WQ0089 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0090 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0015           MTech Live Yes
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) $UB0DT' defaulted for 'TH Kill Date'.
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Receiving for Hld PO
      *================================================================
      * CASE: DB1.TH Held Over is *Zeros
     C           WCH9NB    IFEQ *ZERO                      *IF
     C                     GOTO UMEXIT                     *QUIT
     C                     END                             *FI
      * If Shift Held Over was held over til the next day, print the H-
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) $UX5NB' defaulted for 'Live Weight SUM'.
      * Field '(NXT) $UHD5U' defaulted for 'DOA Head Total        SUM'.
      * Field '(NXT) $UXRNB' defaulted for 'Head Total Sum2'.
      * Field '(NXT) $UCDNB' defaulted for 'Head held over        SUM'.
      * Field '(NXT) $UQLNB' defaulted for 'Live Weight 2 SUM'.
      * Field '(NXT) $UHDWT' defaulted for 'Head Received w/wgt   SUM'.
      * Field '(NXT) $UHWHD' defaulted for 'Head held over w/wgt  SUM'.
      * Field '(PAR) WUSRA1' defaulted for 'LFT Head Total        SUM'.
      * Field '(PAR) WUSSA1' defaulted for 'EUT/KOA Head Total    SUM'.
      * Prt Receiving for Hld PO: Mainline
     C                     EXSR I0MAIN
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $PHMNB    WQ0102  30       BOH Company Num
     C                     PARM @CN,002   WQ0103 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0104 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0009           MTech Live Yes
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR J0MAIN
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt Receiving for Hld PO: Initialise
      *================================================================
      * USER: Initialize program
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
     C                     MOVEL@CN,001   YL0007           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $HHMNB    WQ0057  30       BOH Company Num
     C                     PARM YL0007    WQ0058 10        Company Value C
     C           YL0008    PARM *BLANK    WQ0059 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0008    WUD3SS           Co Uses HPE & H
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UESUBR                     Get the MTech L
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * Prt Receiving for Sbj PO: Initialise
      *================================================================
      * USER: Initialize program
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UHSUBR                     Get the MTech L
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZGINIT    BEGSR
      *================================================================
      * Prt Receiv f/Shft H/o PO: Initialise
      *================================================================
      * USER: Initialize program
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UKSUBR                     Get the MTech L
      *================================================================
     CSR         ZGEXIT    ENDSR
      /EJECT
     CSR         ZIINIT    BEGSR
      *================================================================
      * Prt Receiving for Hld PO: Initialise
      *================================================================
      * USER: Initialize program
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
     C                     MOVEL@CN,001   YL0007           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $PHMNB    WQ0099  30       BOH Company Num
     C                     PARM YL0007    WQ0100 10        Company Value C
     C           YL0008    PARM *BLANK    WQ0101 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0008    WUD3SS           Co Uses HPE & H
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UNSUBR                     Get the MTech L
      *================================================================
     CSR         ZIEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5MFST           Usr Display 1
     C                     Z-ADD*ZERO     P7FPDT           Week Ending Dat
     C                     Z-ADD*ZERO     P7HVA1           Week Number
     C                     Z-ADD*ZERO     P7NKNB           Calendar Year
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Date From USR
     C                     Z-ADD*ZERO     WUB3DT  70
      * Define work field Date Beg USR
     C                     Z-ADD*ZERO     WUERDT  70
      * Define work field Co Uses HPE & HPS usr
     C                     MOVEL*BLANK    WUD3SS  1
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1LIST           TH Schedule Kil
     C                     MOVEL*LOVAL    A1LLST           TH Hog Class Ty
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Txt Field Not Needed
     C                     MOVEL*BLANK    WUOCTX 25
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field TH Kill Date
     C                     Z-ADD*ZERO     WUB0DT  70
      * Define work field Shift Description USR
     C                     MOVEL*BLANK    WUFSTX 30
      * Define work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    WULIST  1
      * Define work field Description 30 USR
     C                     MOVEL*BLANK    WUKKTX 30
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field TH HPS Farm Site Alpha
     C                     MOVEL*BLANK    WUWWTX  5
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Define work field DF Description
     C                     MOVEL*BLANK    WUBCTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WABNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WABONB           BOL Load Number
     C                     MOVEL*LOVAL    WACVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WBLIST           TH Schedule Kil
     C                     MOVEL*LOVAL    WBLLST           TH Hog Class Ty
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Define work field Live Weight 2 SUM
     C                     Z-ADD*ZERO     WUQLNB 111
      * Define work field Head held over        SUM
     C                     Z-ADD*ZERO     WUCDNB  70
      * Define work field Head held over w/wgt  SUM
     C                     Z-ADD*ZERO     WUHWHD  70
      * Define work field Head Received w/wgt   SUM
     C                     Z-ADD*ZERO     WUHDWT  70
      * Define work field Head Shift w/wgt      SUM
     C                     Z-ADD*ZERO     WUHSHD  70
      * Define work field DOA Head Total        SUM
     C                     Z-ADD*ZERO     WUHD5U  50
      * Define work field LFT Head Total        SUM
     C                     Z-ADD*ZERO     WUSRA1  70
      * Define work field EUT/KOA Head Total    SUM
     C                     Z-ADD*ZERO     WUSSA1  70
      * Define work field Head Total Sum2
     C                     Z-ADD*ZERO     WUXRNB  70
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WCB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WCLIST           TH Schedule Kil
     C                     MOVEL*LOVAL    WCLLST           TH Hog Class Ty
     C                     MOVEL*LOVAL    WCCVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WABNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WABONB           BOL Load Number
     C                     MOVEL*LOVAL    WACVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Define work field TH Held Over
     C                     Z-ADD*ZERO     WUH9NB  50
      * Define work field Head to Kill w/wgt    USR
     C                     Z-ADD*ZERO     WUKLHD  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDNKNB           Calendar Year
     C                     Z-ADD*ZERO     WDHVA1           Week Number
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDFPDT           Week Ending Dat
     C                     Z-ADD*ZERO     WDKDHD           Head Killed
     C                     Z-ADD*ZERO     WDHUA1           Head Cut
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Head Received 1 SUM
     C                     Z-ADD*ZERO     WUWWNB  70
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0002 40
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0001 20
      * Define null work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    YN0002  5
      * Define null work field State
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0004 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0005  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0006 25
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0007 20
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0008  6
      * Define local work field Farm Site 5.0 USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0005  30
      * Define null work field HC Description
     C                     MOVEL*BLANK    YN0009 25
      * Define local work field HC Class Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0007 10
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0008 40
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Farm Site 3.0 USR
     C                     Z-ADD*ZERO     YL0010  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0010  6
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field DT Load Type
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Farm Site 3.0 USR
     C                     Z-ADD*ZERO     YL0014  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0011  6
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Farm Site 3.0 USR
     C                     Z-ADD*ZERO     YL0016  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0012  6
      * Define local work field Text Usr 1
     C                     MOVEL*BLANK    YL0017  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE085
      * Hog Pop by farm site
      *   RTV Farm Site ------- added parm for farm site nbr
      * HPE034
      * Create a Trucker edit. - Dwight Shepard
      * Purpose:
      * Clone the Trucker report that post and remove
      * all update of vouchers.  Producer the report
      * for the user to sight review before continue on.
      * Modification History
      * Date        Person   Description
      * E00282 SLM 11/14/2008 ADD LFT AND EUT/KOA
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    $ACMP
     C                     MOVEL'N'       P5MFST           Usr Display 1
      * 1/9/03  Output PLACCPP when Status 1 input parm is Y.
      *         It is submitted from the Payment Post Prompt to output
      *         Total Head to Kill per Kill date/shift.
      * Get Week ending Date/Calendar Year/Week Number
      * CASE: PAR.Status 1 is Yes
     C           P6P4ST    IFEQ 'Y'                        *IF
      * Rtv Week Number       XF - STR Order Management Sys  * 
     C                     CALL 'POEPXFR'              90  Rtv Week Number
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       Company Number
     C                     PARM P1B0DT    WQ0002  70       Date USR
     C           P7NKNB    PARM *ZERO     WQ0003  40       Year USR
     C           P7HVA1    PARM *ZERO     WQ0004  20       Week Number USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POEPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Week Number is Zero
     C           P7HVA1    IFEQ 0                          *IF
     C                     Z-ADD53        P7HVA1           Week Number
     C                     SUB  1         P7NKNB           Calendar Year
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1B0DT    WQ0005  30       CC Company Numb
     C                     PARM P7NKNB    WQ0006  40       CSD Year
     C                     PARM P7HVA1    WQ0007  20       CSD Week
     C           WUB3DT    PARM *ZERO     WQ0008  70       Date From USR
     C           P7FPDT    PARM *ZERO     WQ0009  70       Date To   USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Date From USR is Zero
     C           WUB3DT    IFEQ 0                          *IF
     C                     Z-ADD52        P7HVA1           Week Number
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0010  30       CC Company Numb
     C                     PARM P7NKNB    WQ0011  40       CSD Year
     C                     PARM P7HVA1    WQ0012  20       CSD Week
     C           WUB3DT    PARM *ZERO     WQ0013  70       Date From USR
     C           P7FPDT    PARM *ZERO     WQ0014  70       Date To   USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * If the week didnt have an ending Saturday date
      * CASE: PAR.Week Ending Date is Not Found Kill Date
     C           P7FPDT    IFEQ *ZERO                      *IF
     C                     Z-ADDWUB3DT    WUERDT           Date Beg USR
     C                     ADD  1         P7NKNB           Calendar Year
     C                     Z-ADD01        P7HVA1           Week Number
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0015  30       CC Company Numb
     C                     PARM P7NKNB    WQ0016  40       CSD Year
     C                     PARM P7HVA1    WQ0017  20       CSD Week
     C           WUB3DT    PARM *ZERO     WQ0018  70       Date From USR
     C           P7FPDT    PARM *ZERO     WQ0019  70       Date To   USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUERDT    WUB3DT           Date From USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Wk Start/End      RT - STR Order Management Sys  * 
     C                     CALL 'POENXFR'              90  RTV Wk Start/En
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0020  30       CC Company Numb
     C                     PARM P7NKNB    WQ0021  40       CSD Year
     C                     PARM P7HVA1    WQ0022  20       CSD Week
     C           WUB3DT    PARM *ZERO     WQ0023  70       Date From USR
     C           P7FPDT    PARM *ZERO     WQ0024  70       Date To   USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POENXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
     C                     MOVEL@CN,001   YL0001           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0025  30       BOH Company Num
     C                     PARM YL0001    WQ0026 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0027 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    WUD3SS           Co Uses HPE & H
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DLVTRKRULE
00002 MTECHLIVE
