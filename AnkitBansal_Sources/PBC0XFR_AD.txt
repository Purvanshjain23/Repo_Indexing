// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBC0XFR
// ?Date: 14.08.2025 Time: 03:47:28
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Cannot inactivate customer if any of the following exist:
//?History, A/R Header, Order Header, Order Detail,
//?A/R Summary, Item Contract, Customer/Item Price Overage, Order Events
//?or other customer dependencies
// WRK.USR Count = CND.EQ 0
WRK.USR_Count = *ZERO;

// PAR.USR Return Code = CND.Does Not Exist
PAR.USR_Return_Code = 'N';

EXECUTE FUNCTION(VAL A/R Cust B4 Delete RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1463210;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(WRK.USR_Count);
{
 //?USER: Initialize routine

 // PAR.USR Count = CND.EQ 0
 PAR.USR_Count = *ZERO;

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PAR.USR Count = PAR.USR Count + CON.1
 PAR.USR_Count = PAR.USR_Count + 1;

 CASE;

 // IF PAR.USR Count is GT 1
 IF PAR.USR_Count > 1;

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 QUIT;

 ENDIF;

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.USR Return Code = CND.A/R Customer
PAR.USR_Return_Code = 'A';

QUIT;

ENDIF;

// WRK.USR Count = CND.EQ 0
WRK.USR_Count = *ZERO;

EXECUTE FUNCTION(VAL Parent B4 Delete   RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1463214;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(WRK.USR_Count);
{
 //?USER: Initialize routine

 // PAR.USR Count = CND.EQ 0
 PAR.USR_Count = *ZERO;

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PAR.USR Count = PAR.USR Count + CON.1
 PAR.USR_Count = PAR.USR_Count + 1;

 CASE;

 // IF PAR.USR Count is GT 1
 IF PAR.USR_Count > 1;

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 QUIT;

 ENDIF;

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.USR Return Code = CND.Parent Customer
PAR.USR_Return_Code = 'P';

QUIT;

ENDIF;

//?File 2
EXECUTE FUNCTION(VAL Customer in A/R HdrRT) TYPE(RTVOBJ) FILE(ARBDCPP)          AC1462763;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Ship_To_Customer);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.USR Return Code = CND.A/R Header
PAR.USR_Return_Code = 'H';

QUIT;

ENDIF;

//?File 3
EXECUTE FUNCTION(VAL Customer Order Hdr RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1462968;
PARAMETER(PAR.Ship_To_Customer);
{
 //?USER: Initialize routine

 //?RMC 6/28/2011 use lf not keyed by company, so all will be chked.
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.USR Return Code = CND.Order Header
PAR.USR_Return_Code = 'O';

QUIT;

ENDIF;

//?File 4
EXECUTE FUNCTION(VAL Open Ord Dtl-Cust  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2041658;
PARAMETER(PAR.Ship_To_Customer);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PAR.USR Return Code = CND.Order Detail
PAR.USR_Return_Code = 'D';

QUIT;

ENDIF;

//?File 5
EXECUTE FUNCTION(Rtv Open Order Value  RT) TYPE(RTVOBJ) FILE(ARBCREP)           AC1901957;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(WRK.Value_of_Open_Orders);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 // PAR.Value of Open Orders = PAR.Value of Open Orders + DB1.Value of Open Orders
 PAR.Value_of_Open_Orders = PAR.Value_of_Open_Orders + DB1.Value_of_Open_Orders;

}


CASE;

// IF WRK.Value of Open Orders is greater than zero
IF WRK.Value_of_Open_Orders > *ZERO;

// PAR.USR Return Code = CND.A/R Summary
PAR.USR_Return_Code = 'U';

QUIT;

ENDIF;

//?Tests that are not currently being done but may be added later.
DO;

ENDDO;

