// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDZLXFR
// ?Date: 14.08.2025 Time: 03:33:42
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv PA Grp Inv/Sales  RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1469361;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_To_USR);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Post to G/L Date GT PAR.Date To               USR
 IF DB1.Post_to_G_L_Date > PAR.Date_To_USR;

 QUIT;

 ENDIF;

 //?DOC: 04/11/07 Change Log
 DO;

 //?04/10/07 Effective 04/23/07 representation of Age Code changes
 //?         will be such that Age Code A will be 0 day for boxes
 //?         and combos.  The labels on the cartons will not print
 //?         a date that is offset by Sunday or Holiday.  Instead of
 //?         Code Date, it will be the Pack Date.
 ENDDO;

 EXECUTE FUNCTION(Rtv PA Grp Inv/Sls    RT) TYPE(RTVOBJ) FILE(PDKLREP)           AC1469384;
 PARAMETER(DB1.Company_Number);
 PARAMETER('PAG');
 PARAMETER(DB1.Post_to_G_L_Date);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: CON);

  EXECUTE FUNCTION(Rtv PA Grp Inv/Sls    RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1469395;
  PARAMETER(DB1.Company_Number);
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(DB1.Item_Code);
  PARAMETER(PAR.PA_Sales);
  PARAMETER(PAR.PA_Inventory_on_Hand);
  {
   //?USER: Process Data record

   CASE;

   // IF DB1.Warehouse Code is Guymon Fresh
   IF DB1.Warehouse_Code = 'GP1';

   // OR DB1.Warehouse Code is Guymon Frozen
   OR DB1.Warehouse_Code = 'GF1';

   // OR DB1.Warehouse Code is Amarillo Fresh
   OR DB1.Warehouse_Code = 'AM1';

   //?Get inventory qty for current ship date only.
   CASE;

   // IF PAR.Post to G/L Date EQ JOB.*Job date
   IF PAR.Post_to_G_L_Date = JOB.*Job_date;

   EXECUTE FUNCTION(RTV Unit Weight        RT) TYPE(RTVOBJ) FILE(CABZREP)          AC1298772;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.Unit_Weight);
   PARAMETER(WRK.Quality_Level);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   EXECUTE FUNCTION(Rtv PA Grp Item Inv   RT) TYPE(RTVOBJ) FILE(PDI8CPP)           AC1469388;
   PARAMETER(PAR.Company_Number);
   PARAMETER('S');
   PARAMETER(PAR.Post_to_G_L_Date);
   PARAMETER(PAR.Item_Code);
   PARAMETER(DB1.Warehouse_Code);
   PARAMETER(PAR.Unit_Weight);
   PARAMETER(PAR.PA_Inventory_on_Hand);
   {
    //?USER: Process Data record

    // Accum inv on hand
    PAR.PA_Inventory_on_Hand = PAR.PA_Inventory_on_Hand + ( ( DB1.PS_Weight_Inv_On_Hand
    + DB1.PS_Weight_Inv_Adj ) / PAR.Unit_Weight 'H' );

   }

   ENDIF;

   EXECUTE FUNCTION(Rtv PA Grp Item Sls   RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC1469406;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Item_Code);
   PARAMETER(DB1.Warehouse_Code);
   PARAMETER(PAR.Post_to_G_L_Date);
   PARAMETER(PAR.PA_Sales);
   {
    //?USER: Process Data record

    CASE;

    // IF DB1.Detail Line Status is Complete
    IF DB1.Detail_Line_Status = 'C';

    // IF *OTHERWISE
    IF *OTHERWISE;

    // PAR.PA Sales = PAR.PA Sales + DB1.Quantity Scheduled
    PAR.PA_Sales = PAR.PA_Sales + DB1.Quantity_Scheduled;

    ENDIF;

   }

   ENDIF;

  }

  EXECUTE FUNCTION(Create PS PA Download) TYPE(CRTOBJ) FILE(PDLKCPP)              AC1469324;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(PAR.Post_to_G_L_Date);
  PARAMETER(PAR.PA_Inventory_on_Hand);
  PARAMETER(PAR.PA_Sales);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER('A');
  PARAMETER(*ZERO);
  PARAMETER(*BLANK);
  PARAMETER(*BLANK);
  PARAMETER(*ZERO);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(UPS CRTOBJ Stamp      IF) TYPE(EXCINTFUN)                      AC1359517;
   PARAMETER(DB1.Record_Status);
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Record Status = CND.Active
    PAR.Record_Status = 'A';

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

 }

}


