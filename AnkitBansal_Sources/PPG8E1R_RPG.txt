     H/TITLE EDT Cust Sls Info      E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 08/27/24  Time  : 03:04:51
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPG8E1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Cust Sls Info      E1 Edit record(1 screen)
      *
     FCAEOREL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Company Customer          Active Records         N
      *
     FPMA7REL1IF  E           K        DISK
      * RTV : Sales Route Authority     Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State Master              Retrieval index       NV
      *
     FCAECREL1IF  E           K        DISK
      * RTV : County Master             Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FCAAJREL1IF  E           K        DISK
      * RTV : Type Codes New            Retrieval index       NV
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FPDM3REL1IF  E           K        DISK
      * RTV : Customer Fax              Retrieval index
      *
     FPMDDREL1IF  E           K        DISK
      * RTV : Sales Market              Retrieval index
      *
     FPUAAREL1IF  E           K        DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker News               Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCAAOREL0IF  E           K        DISK
      * RTV : Terms Master              Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDJXREL2IF  E           K        DISK
      * RTV : Customer Group Master     Active Customer Group
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPUB6CPL1IF  E           K        DISK
      * RTV : Pallet Master             Retrieval index
      *
     FPUB1REL1IF  E           K        DISK
      * RTV : Buying Group              Retrieval index
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPBB6REL1IF  E           K        DISK
      * RTV : Sales Customer Sold To    Retrieval index
      *
     FCAEOREL0UF  E           K        DISK
      * UPD : Company Customer          Update index
      *
     FPDNIREL0UF  E           K        DISK                      A
      * UPD : Company Customer EXT      Update index
      *
     FCABBREL0UF  E           K        DISK
      * UPD : Customer Master           Update index
      *
     FPDNEREL0UF  E           K        DISK                      A
      * UPD : Customer EXT              Update index
      *
     FPDM3REL0UF  E           K        DISK                      A
      * UPD : Customer Fax              Update index
      *
     FPUAAREL0UF  E           K        DISK                      A
      * UPD : Customer EXT2             Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   3 003  5 0A
     E                    W0END   3 003  5 0A
     E                    W0NAM   3 003 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 048  5 0A
     E                    W1END   7 048  5 0A
     E                    W1NAM   7 048 10
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WAAIC3
     I              ABADTX                          WAADTX
     I              ABACNA                          WAACNA
     I              ABADNA                          WAADNA
     I              ABAENA                          WAAENA
     I              ABAJNA                          WAAJNA
     I              ABBTTX                          WABTTX
     I              ABBVTX                          WABVTX
     I              ABBWTX                          WABWTX
     I              ABA2NA                          WAA2NA
     I              ABABTX                          WAABTX
     I              ABBGCD                          WABGCD
     I              ABKXCD                          WAKXCD
     I              ABUVST                          WAUVST
     I              ABUWST                          WAUWST
     I              ABUXST                          WAUXST
     I              ABVSST                          WAVSST
     I              ABAATM                          WAAATM
     I              ABAYNA                          WAAYNA
     I              ABA0NA                          WAA0NA
     I              ABAXDT                          WAAXDT
      *
     I@EOREU0
      * Company Customer          Customer/Company
      * Renamed input format fields
     I              EOAIC3                          WBAIC3
     I              EOBKC7                          WBBKC7
     I              EOAQCD                          WBAQCD
     I              EOR4CD                          WBR4CD
     I              EOBYNA                          WBBYNA
     I              EOB6NA                          WBB6NA
     I              EOBZNA                          WBBZNA
     I              EOLLST                          WBLLST
     I              EOPPST                          WBPPST
     I              EOR5NB                          WBR5NB
     I              EOR6NB                          WBR6NB
     I              EOQGST                          WBQGST
     I              EOBOCD                          WBBOCD
     I              EOTBNB                          WBTBNB
     I              EOMTCU                          WBMTCU
     I              EOW2NB                          WBW2NB
     I              EORPCD                          WBRPCD
     I              EOAJCD                          WBAJCD
     I              EOX9ST                          WBX9ST
     I              EOT9CD                          WBT9CD
     I              EOUBCD                          WBUBCD
     I              EOISTX                          WBISTX
     I              EOLQCD                          WBLQCD
     I              EONJNA                          WBNJNA
     I              EOI0TX                          WBI0TX
     I              EONKNA                          WBNKNA
     I              EOI1TX                          WBI1TX
     I              EOVLST                          WBVLST
     I              EORLST                          WBRLST
     I              EOMMTX                          WBMMTX
     I              EOOHNA                          WBOHNA
     I              EOQ6ST                          WBQ6ST
     I              EOQ8ST                          WBQ8ST
     I              EORBST                          WBRBST
     I              EOREST                          WBREST
     I              EOUVST                          WBUVST
     I              EOUWST                          WBUWST
     I              EOUXST                          WBUXST
     I              EOVSST                          WBVSST
     I              EOAATM                          WBAATM
     I              EOAYNA                          WBAYNA
     I              EOA0NA                          WBA0NA
     I              EOAXDT                          WBAXDT
      *
     I@NIREBN
      * Company Customer EXT      Update index
      * Renamed input format fields
     I              NIAIC3                          WCAIC3
     I              NIBKC7                          WCBKC7
     I              NIUFTX                          WCUFTX
     I              NIUGTX                          WCUGTX
     I              NIPFNA                          WCPFNA
     I              NIJ5NX                          WCJ5NX
     I              NIU5TX                          WCU5TX
     I              NIU6TX                          WCU6TX
     I              NIW0TX                          WCW0TX
     I              NIKSNX                          WCKSNX
     I              NIPENX                          WCPENX
     I              NIHSSX                          WCHSSX
     I              NIHTSX                          WCHTSX
     I              NIHUSX                          WCHUSX
     I              NIHVSX                          WCHVSX
     I              NINCT1                          WCNCT1
     I              NIM9T1                          WCM9T1
     I              NINAT1                          WCNAT1
     I              NIL9AA                          WCL9AA
     I              NIWJT1                          WCWJT1
     I              NIHLST                          WCHLST
     I              NIHMST                          WCHMST
     I              NINBT1                          WCNBT1
     I              NIWKT1                          WCWKT1
     I              NIJ7NY                          WCJ7NY
     I              NIRJNY                          WCRJNY
     I              NIRKNY                          WCRKNY
     I              NIH9ST                          WCH9ST
     I              NIAATM                          WCAATM
     I              NIAYNA                          WCAYNA
     I              NIA0NA                          WCA0NA
     I              NIAXDT                          WCAXDT
      *
     I@BBREE8
      * Customer Master           Update index
      * Renamed input format fields
     I              BBBKC7                          WDBKC7
     I              BBAYTX                          WDAYTX
     I              BBACNA                          WDACNA
     I              BBADNA                          WDADNA
     I              BBAENA                          WDAENA
     I              BBAJNA                          WDAJNA
     I              BBBGCD                          WDBGCD
     I              BBG5CD                          WDG5CD
     I              BBBTTX                          WDBTTX
     I              BBBVTX                          WDBVTX
     I              BBBWTX                          WDBWTX
     I              BBABTX                          WDABTX
     I              BBA2NA                          WDA2NA
     I              BBCBST                          WDCBST
     I              BBB0NA                          WDB0NA
     I              BBP3NB                          WDP3NB
     I              BBAXNA                          WDAXNA
     I              BBI6DT                          WDI6DT
     I              BBAYDT                          WDAYDT
     I              BBANC7                          WDANC7
     I              BBBTC7                          WDBTC7
     I              BBK6ST                          WDK6ST
     I              BBUZST                          WDUZST
     I              BBKXCD                          WDKXCD
     I              BBLTCD                          WDLTCD
     I              BBQNST                          WDQNST
     I              BBS2NB                          WDS2NB
     I              BBVHVA                          WDVHVA
     I              BBI7DT                          WDI7DT
     I              BBRJST                          WDRJST
     I              BBRKST                          WDRKST
     I              BBQWST                          WDQWST
     I              BBQXST                          WDQXST
     I              BBQYST                          WDQYST
     I              BBUNCS                          WDUNCS
     I              BBUVST                          WDUVST
     I              BBUWST                          WDUWST
     I              BBUXST                          WDUXST
     I              BBVSST                          WDVSST
     I              BBAATM                          WDAATM
     I              BBAYNA                          WDAYNA
     I              BBA0NA                          WDA0NA
     I              BBAXDT                          WDAXDT
      *
     I@NEREAS
      * Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WEBKC7
     I              NEUFTX                          WEUFTX
     I              NEUGTX                          WEUGTX
     I              NEPFNA                          WEPFNA
     I              NEJ5NX                          WEJ5NX
     I              NEU5TX                          WEU5TX
     I              NEU6TX                          WEU6TX
     I              NEW0TX                          WEW0TX
     I              NEHSSX                          WEHSSX
     I              NEHUSX                          WEHUSX
     I              NEHVSX                          WEHVSX
     I              NEAAC8                          WEAAC8
     I              NEP0SX                          WEP0SX
     I              NEP1SX                          WEP1SX
     I              NEP2SX                          WEP2SX
     I              NEP3SX                          WEP3SX
     I              NEP4SX                          WEP4SX
     I              NEP5SX                          WEP5SX
     I              NEP6SX                          WEP6SX
     I              NEUVST                          WEUVST
     I              NEUWST                          WEUWST
     I              NEUXST                          WEUXST
     I              NEVSST                          WEVSST
     I              NEAATM                          WEAATM
     I              NEAYNA                          WEAYNA
     I              NEA0NA                          WEA0NA
     I              NEAXDT                          WEAXDT
      *
     I@M3REZD
      * Customer Fax              Update index
      * Renamed input format fields
     I              M3BKC7                          WFBKC7
     I              M3A0AA                          WFA0AA
     I              M3HXNX                          WFHXNX
     I              M3TFTX                          WFTFTX
     I              M3W5T1                          WFW5T1
     I              M3HYNX                          WFHYNX
     I              M3TGTX                          WFTGTX
     I              M3HZNX                          WFHZNX
     I              M3THTX                          WFTHTX
     I              M3D7T1                          WFD7T1
     I              M3D8T1                          WFD8T1
     I              M3D9T1                          WFD9T1
     I              M3EAT1                          WFEAT1
     I              M3FISX                          WFFISX
     I              M3FJSX                          WFFJSX
     I              M3FKSX                          WFFKSX
     I              M3FLSX                          WFFLSX
     I              M3FMSX                          WFFMSX
     I              M3VSST                          WFVSST
     I              M3MJDT                          WFMJDT
     I              M3BETM                          WFBETM
     I              M3CCVN                          WFCCVN
     I              M3CDVN                          WFCDVN
     I              M3MKDT                          WFMKDT
     I              M3BFTM                          WFBFTM
     I              M3CEVN                          WFCEVN
     I              M3CFVN                          WFCFVN
      *
     I@AAREY8
      * Customer EXT2             Update index
      * Renamed input format fields
     I              AABKC7                          WGBKC7
     I              AAVEAA                          WGVEAA
     I              AAD9SC                          WGD9SC
     I              AAZZAA                          WGZZAA
     I              AAK8SC                          WGK8SC
     I              AAK5SC                          WGK5SC
     I              AAK6SC                          WGK6SC
     I              AAK7SC                          WGK7SC
     I              AAZ3AA                          WGZ3AA
     I              AAZ4AA                          WGZ4AA
     I              AAZ5AA                          WGZ5AA
     I              AAGBNZ                          WGGBNZ
     I              AAFCNZ                          WGFCNZ
     I              AAXKDT                          WGXKDT
     I              AAEPTM                          WGEPTM
     I              AAO1U1                          WGO1U1
     I              AALWSC                          WGLWSC
     I              AAAKAB                          WGAKAB
     I              AAGANZ                          WGGANZ
     I              AAEOTM                          WGEOTM
     I              AAVSST                          WGVSST
     I              AAMJDT                          WGMJDT
     I              AABETM                          WGBETM
     I              AACCVN                          WGCCVN
     I              AACDVN                          WGCDVN
     I              AAMKDT                          WGMKDT
     I              AABFTM                          WGBFTM
     I              AACEVN                          WGCEVN
     I              AACFVN                          WGCFVN
      *
     I@B6REVA
      * Sales Customer Sold To    Retrieval index
      * Renamed input format fields
     I              B6BKC7                          WHBKC7
     I              B6TYAA                          WHTYAA
     I              B6VSST                          WHVSST
     I              B6MJDT                          WHMJDT
     I              B6BETM                          WHBETM
     I              B6CCVN                          WHCCVN
     I              B6CDVN                          WHCDVN
     I              B6MKDT                          WHMKDT
     I              B6BFTM                          WHBFTM
     I              B6CEVN                          WHCEVN
     I              B6CFVN                          WHCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSCAEOREL0
      * UPD : Company Customer          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            344
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      * Outward parameters
     IPARC        DS                              8
      * KEY : Customer Item Reference   Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PABKC7
      *
     IYARDCS      DS                            344
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDNI1    E DSPDNIREL0
      * UPD : Company Customer EXT      Update index
      * Renamed input format fields
     I              NIAIC3                          WCAIC3
     I              NIBKC7                          WCBKC7
     I              NIUFTX                          WCUFTX
     I              NIUGTX                          WCUGTX
     I              NIPFNA                          WCPFNA
     I              NIJ5NX                          WCJ5NX
     I              NIU5TX                          WCU5TX
     I              NIU6TX                          WCU6TX
     I              NIW0TX                          WCW0TX
     I              NIKSNX                          WCKSNX
     I              NIPENX                          WCPENX
     I              NIHSSX                          WCHSSX
     I              NIHTSX                          WCHTSX
     I              NIHUSX                          WCHUSX
     I              NIHVSX                          WCHVSX
     I              NINCT1                          WCNCT1
     I              NIM9T1                          WCM9T1
     I              NINAT1                          WCNAT1
     I              NIL9AA                          WCL9AA
     I              NIWJT1                          WCWJT1
     I              NIHLST                          WCHLST
     I              NIHMST                          WCHMST
     I              NINBT1                          WCNBT1
     I              NIWKT1                          WCWKT1
     I              NIJ7NY                          WCJ7NY
     I              NIRJNY                          WCRJNY
     I              NIRKNY                          WCRKNY
     I              NIH9ST                          WCH9ST
     I              NIAATM                          WCAATM
     I              NIAYNA                          WCAYNA
     I              NIA0NA                          WCA0NA
     I              NIAXDT                          WCAXDT
      *
     IYBRDCS      DS                            245
     IQCABB1    E DSCABBREL0
      * UPD : Customer Master           Update index
      * Renamed input format fields
     I              BBBKC7                          WDBKC7
     I              BBAYTX                          WDAYTX
     I              BBACNA                          WDACNA
     I              BBADNA                          WDADNA
     I              BBAENA                          WDAENA
     I              BBAJNA                          WDAJNA
     I              BBBGCD                          WDBGCD
     I              BBG5CD                          WDG5CD
     I              BBBTTX                          WDBTTX
     I              BBBVTX                          WDBVTX
     I              BBBWTX                          WDBWTX
     I              BBABTX                          WDABTX
     I              BBA2NA                          WDA2NA
     I              BBCBST                          WDCBST
     I              BBB0NA                          WDB0NA
     I              BBP3NB                          WDP3NB
     I              BBAXNA                          WDAXNA
     I              BBI6DT                          WDI6DT
     I              BBAYDT                          WDAYDT
     I              BBANC7                          WDANC7
     I              BBBTC7                          WDBTC7
     I              BBK6ST                          WDK6ST
     I              BBUZST                          WDUZST
     I              BBKXCD                          WDKXCD
     I              BBLTCD                          WDLTCD
     I              BBQNST                          WDQNST
     I              BBS2NB                          WDS2NB
     I              BBVHVA                          WDVHVA
     I              BBI7DT                          WDI7DT
     I              BBRJST                          WDRJST
     I              BBRKST                          WDRKST
     I              BBQWST                          WDQWST
     I              BBQXST                          WDQXST
     I              BBQYST                          WDQYST
     I              BBUNCS                          WDUNCS
     I              BBUVST                          WDUVST
     I              BBUWST                          WDUWST
     I              BBUXST                          WDUXST
     I              BBVSST                          WDVSST
     I              BBAATM                          WDAATM
     I              BBAYNA                          WDAYNA
     I              BBA0NA                          WDA0NA
     I              BBAXDT                          WDAXDT
      *
     IYCRDCS      DS                            357
     IQPDNE1    E DSPDNEREL0
      * UPD : Customer EXT              Update index
      * Renamed input format fields
     I              NEBKC7                          WEBKC7
     I              NEUFTX                          WEUFTX
     I              NEUGTX                          WEUGTX
     I              NEPFNA                          WEPFNA
     I              NEJ5NX                          WEJ5NX
     I              NEU5TX                          WEU5TX
     I              NEU6TX                          WEU6TX
     I              NEW0TX                          WEW0TX
     I              NEHSSX                          WEHSSX
     I              NEHUSX                          WEHUSX
     I              NEHVSX                          WEHVSX
     I              NEAAC8                          WEAAC8
     I              NEP0SX                          WEP0SX
     I              NEP1SX                          WEP1SX
     I              NEP2SX                          WEP2SX
     I              NEP3SX                          WEP3SX
     I              NEP4SX                          WEP4SX
     I              NEP5SX                          WEP5SX
     I              NEP6SX                          WEP6SX
     I              NEUVST                          WEUVST
     I              NEUWST                          WEUWST
     I              NEUXST                          WEUXST
     I              NEVSST                          WEVSST
     I              NEAATM                          WEAATM
     I              NEAYNA                          WEAYNA
     I              NEA0NA                          WEA0NA
     I              NEAXDT                          WEAXDT
      *
     IYDRDCS      DS                            191
     IQPDM31    E DSPDM3REL0
      * UPD : Customer Fax              Update index
      * Renamed input format fields
     I              M3BKC7                          WFBKC7
     I              M3A0AA                          WFA0AA
     I              M3HXNX                          WFHXNX
     I              M3TFTX                          WFTFTX
     I              M3W5T1                          WFW5T1
     I              M3HYNX                          WFHYNX
     I              M3TGTX                          WFTGTX
     I              M3HZNX                          WFHZNX
     I              M3THTX                          WFTHTX
     I              M3D7T1                          WFD7T1
     I              M3D8T1                          WFD8T1
     I              M3D9T1                          WFD9T1
     I              M3EAT1                          WFEAT1
     I              M3FISX                          WFFISX
     I              M3FJSX                          WFFJSX
     I              M3FKSX                          WFFKSX
     I              M3FLSX                          WFFLSX
     I              M3FMSX                          WFFMSX
     I              M3VSST                          WFVSST
     I              M3MJDT                          WFMJDT
     I              M3BETM                          WFBETM
     I              M3CCVN                          WFCCVN
     I              M3CDVN                          WFCDVN
     I              M3MKDT                          WFMKDT
     I              M3BFTM                          WFBFTM
     I              M3CEVN                          WFCEVN
     I              M3CFVN                          WFCFVN
      *
     IYERDCS      DS                            375
     IQPUAA1    E DSPUAAREL0
      * UPD : Customer EXT2             Update index
      * Renamed input format fields
     I              AABKC7                          WGBKC7
     I              AAVEAA                          WGVEAA
     I              AAD9SC                          WGD9SC
     I              AAZZAA                          WGZZAA
     I              AAK8SC                          WGK8SC
     I              AAK5SC                          WGK5SC
     I              AAK6SC                          WGK6SC
     I              AAK7SC                          WGK7SC
     I              AAZ3AA                          WGZ3AA
     I              AAZ4AA                          WGZ4AA
     I              AAZ5AA                          WGZ5AA
     I              AAGBNZ                          WGGBNZ
     I              AAFCNZ                          WGFCNZ
     I              AAXKDT                          WGXKDT
     I              AAEPTM                          WGEPTM
     I              AAO1U1                          WGO1U1
     I              AALWSC                          WGLWSC
     I              AAAKAB                          WGAKAB
     I              AAGANZ                          WGGANZ
     I              AAEOTM                          WGEOTM
     I              AAVSST                          WGVSST
     I              AAMJDT                          WGMJDT
     I              AABETM                          WGBETM
     I              AACCVN                          WGCCVN
     I              AACDVN                          WGCDVN
     I              AAMKDT                          WGMKDT
     I              AABFTM                          WGBFTM
     I              AACEVN                          WGCEVN
     I              AACFVN                          WGCFVN
      *
     IYFRDCS      DS                            151
     IYGRDCS      DS                            151
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Customer
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Ship To Customer
     I                                    P   3   60P1BKC7
      * I :  Sales Route Code
     I                                        7   9 P1R4CD
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  Allow Multi_Company
     I                                       13  13 P2I6ST
      * N :  Default Printer
     I                                       14  23 P2MPNA
      * N :  User Organization Access
     I                                       24  24 P2JFST
     IP3PARM      DS
      * FLD: Print Options
      * N :  PRT Description
     I                                        1  25 P3G3TX
      * N :  PRT Printer Device
     I                                       26  35 P3WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P3WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P3WTST
      * N :  PRT Night Queue Run Sts
     I                                       44  44 P3WUST
      * N :  PRT Night Queue
     I                                       45  54 P3BVVN
     IP4PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P4M8NB
     IP5PARM      DS
      * FLD: *Arrays
      * N : MAP Company Number Pass   USR
     I                                    P   1   85P5AJAA
     IP6PARM      DS
      * N : MAP USR Company Number
     I                                    P   1   20P6FKNB
     IP7PARM      DS
      * N : MAP USR Ship To Customer
     I                                    P   1   40P7BLC7
     IP8PARM      DS
      * N : MAP USR Salesperson Code
     I                                        1   3 P8BWCD
     IP9PARM      DS
      * FLD: Customer EXT
      * N :  EDI Trading Partner No
     I                                        1   6 P9J5NX
      * N :  EDI Cust Duns Number
     I                                        7  26 P9U5TX
      * N :  EDI Warehouse_Store No
     I                                       27  46 P9U6TX
      * N :  State Tax ID
     I                                       47  66 P9W0TX
      * N :  Cust Shipping Temp C_F
     I                                       67  67 P9HSSX
      * N :  One Invoice Per PO
     I                                       68  68 P9HUSX
      * N :  EDI Advanced Ship Notice
     I                                       69  69 P9HVSX
      * N :  Regional Mgr Fax_Email
     I                                       70  70 P9P1SX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Customer Market        NF'
      * Market Code
     I                                        1   3 ZA0001
      * Message data for 'Generic Message 80 NBR'
      * Generic Message 80 USR
     I                                        1  80 ZA0002
      * @Numeric 15.2
     I                                    P  81  882ZA0003
      * Message data for 'Enter Fahrenheit or Cels'
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0004
      * USR Status (Y/N)
     I                                       81  81 ZA0005
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0006
      * USR Status (Y/N)
     I                                       81  81 ZA0007
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0008
      * USR Status (Y/N)
     I                                       81  81 ZA0009
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0012
      * Application Code
     I                                       11  16 ZA0013
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1BKC7    PARM           WP0002  70       Ship To Custome
     C           P1R4CD    PARM           WP0003  3        Sales Route Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1BKC7    OREQ *ZERO                      Ship To Custome
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3
     C                     Z-ADD#1BKC7    EOBKC7
     C           KRTV      CHAIN@EOREUB              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Company Customer       NF'
     C                     MOVEL'USR1007' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
     C                     MOVEL'Y'       YL0001           Access Denied (
      * Sales Channel-Allow changes
      * RTV Check by Full Key  RT - Sales Route Authority  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2BCCD    WL0001    P      Sales Route Cod
     C                     MOVELP2BCCD    WL0002    P      Salesperson Cod
     C                     MOVEL'SC'      WL0003    P      Approval Type
     C                     MOVELYL0001    WL0004    P      Access Denied (
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0001    P      Access Denied (
     C                     MOVEL'Y'       YL0002           USR Access Deni
      * Only certain Sls people can chg the Mkt Code.
      * RTV Check by Full Key  RT - Sales Route Authority  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2BCCD    WL0001    P      Sales Route Cod
     C                     MOVELP2BCCD    WL0002    P      Salesperson Cod
     C                     MOVEL'MC'      WL0003    P      Approval Type
     C                     MOVELYL0002    WL0004    P      Access Denied (
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0002    P      Access Denied (
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDEOAIC3    WL0005           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DADTX    P      Name
      * RTV Cust Defaults      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDEOBKC7    WL0007           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DAYTX    P      Customer Name
     C                     MOVELWL0009    #DACNA    P      Address Line 1
     C                     MOVELWL0010    #DADNA    P      Address Line 2
     C                     MOVELWL0011    #DAENA    P      Address Line 3
     C                     MOVELWL0012    #DAJNA    P      City
     C                     MOVELWL0013    #DBGCD    P      State Code
     C                     MOVELWL0014    #DG5CD    P      County Code
     C                     MOVELWL0015    #DBTTX    P      Zip Postal Code
     C                     MOVELWL0016    #DBVTX    P      Telephone Numbe
     C                     MOVELWL0017    #DBWTX    P      Fax Number FF
     C                     MOVELWL0018    WUA2NA    P      Federal Tax Id
     C                     Z-ADDWL0019    #DDUC7           AR Customer Num
     C                     MOVELWL0020    WUK6ST    P      Credit Check AR
     C                     MOVELWL0021    #DQWST    P      Email When Orde
     C                     MOVELWL0022    #DQYST    P      Item Reference
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SDRVGN
      * RTV State Description  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBGCD    WL0023    P      State Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DAUNA    P      Description
     C                     MOVELWL0025    WUVSST    P      Record Status
      * RTV County Desc.       RT - County Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBGCD    WL0026    P      State Code
     C                     MOVEL#DG5CD    WL0027    P      County Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    #DDL01    P      Description
     C                     MOVELWL0029    WUVSST    P      Record Status
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
     C                     EXSR SGRVGN
      * Catchall 12/9/05 RMC
      * CASE: LCL.Customer TF Exempt Code EQ WRK.Blank for 4           US
     C           YL0005    IFEQ WUOTTX                     *IF
     C                     MOVEL'NE'      YL0005           Customer TF Exe
     C                     END                             *FI
      * RTV SR Desc,person     RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELEOR4CD    WL0030    P      Sales Route Cod
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #DMZNA    P      Sales Route Des
     C                     MOVELWL0032    YN0003    P      Salesperson Cod
      * RTV Type Code Desc.    RT - Type Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELEOBOCD    WL0033    P      Type Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0034    #DIXTX    P      Description
     C                     MOVELWL0035    YN0004    P      Record Status
      * Rtv Cust Shipping Tmp RT - Company Customer EXT  * 
     C                     EXSR SJRVGN
      * Rtv Cust Fax Buyer NbrsRT - Customer Fax  * 
     C                     EXSR SKRVGN
      * DTL.Reg Fax/Email Sts DescUsr = Condition name of DTL.Regional Mg
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1717257   Y2LSNO  70       List number
     C                     PARM #DP1SX    W0INVL 25        Regional Mgr Fa
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6T1    PARM           W0CNNM 25        Reg Fax/Email S
      *
      * Rtv Description       RT - Sales Market  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DP6SX    WL0036    P      Market Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0037    #DR3NA    P      Market Desc
      * Display Class for edit if Parent
      * DN 05/21/20 R16543-Combined RTV into 1 to Get Customer Info.
      * RTV Cust Sls Info     RT - Customer  * 
     C                     EXSR SMRVGN
      * Parent Status
      * CASE: LCL.Parent Customer EQ DB1.Ship To Customer
     C           YL0006    IFEQ EOBKC7                     *IF
     C                     MOVEL'Y'       YL0008           Parent Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0008           Parent Status
     C                     END                             *FI
      * wi464 added this
      * Rtv Pallet/price type RT - Customer EXT2  * 
     C                     EXSR SNRVGN
      * DN 05/21/20 R16543-Get Buying Group Info for Ship To Cust Only.
      * CASE: LCL.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0007    IFEQ 'Y'                        *IF
      * Rtv Buying Group Info RT - Customer EXT2  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * 08/06/24 SP S312312-Start (Get field Broker Code and Email ID)
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
     C                     EXSR SPRVGN
      * 08/06/24 SP S312312-End
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate USR Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVPFKNB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVPFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #PFKNB           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #PFKNB           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate USR Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELVPBLC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVPBLC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #PBLC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #PBLC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFNE *BLANK
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VACKRL
      * Check restriction within
     C                     EXSR VBCKRL
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
      * Select company or customer
      * CASE: KEY.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> KEY.USR Company Number
     C           W0CFL     IFEQ 'VPFKNB'                   *IF
      * CASE: PAR.Allow Multi-Company is yes
     C           P2I6ST    IFEQ 'Y'                        *IF
      * SEL Co By Number       SR - Company Name and Address  * 
     C                     CALL 'PDMESRR'              90  SEL Co By Numbe
     C                     PARM *BLANK    W0RTN   7
     C           #PFKNB    PARM #PFKNB    WQ0004  30       Company Number
     C           YL0012    PARM *BLANK    WQ0005 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Selection not allowed'
     C                     MOVEL'USR2389' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Cursor field <IS> KEY.USR Ship To Customer
     C           W0CFL     IFEQ 'VPBLC7'                   *IF
      * 4/2/04 slm add select on shipped to customer with customer name s
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #PBLC7    PARM #PBLC7    WQ0006  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Select sales route/salesperson
      * CASE: KEY.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> KEY.USR Salesperson Code
     C           W0CFL     IFEQ '#PBWCD'                   *IF
      * SEL Route by Sls Persn SR - Sales Route  * 
     C                     CALL 'PDS1SRR'              90  SEL Route by Sl
     C                     PARM *BLANK    W0RTN   7
     C           #PBWCD    PARM #PBWCD    WQ0007  3        Sales Route Cod
     C           P2BCCD    PARM P2BCCD    WQ0008  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#PFKNB    #1AIC3           Company Number
     C                     Z-ADD#PBLC7    #1BKC7           Ship To Custome
     C                     END
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate Cust Shipping Temp C_F
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHSSX'  IFEQ YPMTFD
      * Cust Shipping Temp C_F
     C                     MOVEL#DHSSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHSSX
     C                     SELEC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD1         ZHHSSX
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD2         ZHHSSX
     C                     ENDSL
     C                     EXFMTZGHSSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHSSX    WHEQ 1
     C                     MOVEL'C'       W0INVL           C
     C           ZHHSSX    WHEQ 2
     C                     MOVEL'F'       W0INVL           F
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHSSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Distributor
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1Q6ST'  IFEQ YPMTFD
      * Distributor
     C                     MOVEL#1Q6ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ6ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHQ6ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHQ6ST
     C                     ENDSL
     C                     EXFMTZGQ6ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ6ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHQ6ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1Q6ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Air Freight Orders
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DP0SX'  IFEQ YPMTFD
      * Air Freight Orders
     C                     MOVEL#DP0SX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHP0SX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHP0SX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHP0SX
     C                     ENDSL
     C                     EXFMTZGP0SX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHP0SX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHP0SX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DP0SX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Print Req Delv Tm on Docs
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHLST'  IFEQ YPMTFD
      * Print Req Delv Tm on Docs
     C                     MOVEL#DHLST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHLST
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZHHLST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHHLST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD3         ZHHLST
     C                     ENDSL
     C                     EXFMTZGHLST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHLST    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHHLST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHHLST    WHEQ 3
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHLST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Item Reference Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DQYST'  IFEQ YPMTFD
      * Item Reference Status
     C                     MOVEL#DQYST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQYST
     C                     SELEC
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD1         ZHQYST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD2         ZHQYST
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD3         ZHQYST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD4         ZHQYST
     C                     ENDSL
     C                     EXFMTZGQYST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQYST    WHEQ 1
     C                     MOVEL'I'       W0INVL           I
     C           ZHQYST    WHEQ 2
     C                     MOVEL'P'       W0INVL           P
     C           ZHQYST    WHEQ 3
     C                     MOVEL'B'       W0INVL           B
     C           ZHQYST    WHEQ 4
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DQYST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1RBST'  IFEQ YPMTFD
      * Ord Ent Default Sls Rte
     C                     MOVEL#1RBST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRBST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHRBST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHRBST
     C                     ENDSL
     C                     EXFMTZGRBST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRBST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHRBST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1RBST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Buying Group Opt In_Out
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DK8SC'  IFEQ YPMTFD
      * Buying Group Opt In_Out
     C                     MOVEL#DK8SC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHK8SC
     C                     SELEC
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD1         ZHK8SC
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD2         ZHK8SC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD3         ZHK8SC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHK8SC
     C                     ENDSL
     C                     EXFMTZGK8SC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHK8SC    WHEQ 1
     C                     MOVEL'I'       W0INVL           I
     C           ZHK8SC    WHEQ 2
     C                     MOVEL'O'       W0INVL           O
     C           ZHK8SC    WHEQ 3
     C                     MOVEL'N'       W0INVL           N
     C           ZHK8SC    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DK8SC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Field vs In_House flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DRKST'  IFEQ YPMTFD
      * Field vs In_House flag
     C                     MOVEL#DRKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRKST
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZHRKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHRKST
     C                     ENDSL
     C                     EXFMTZGRKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRKST    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZHRKST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DRKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Cust Dft Price Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DAKAB'  IFEQ YPMTFD
      * Cust Dft Price Type
     C                     MOVEL#DAKAB    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHAKAB
     C                     SELEC
     C           W0INVL    WHEQ 'CON'                      CON
     C                     Z-ADD1         ZHAKAB
     C           W0INVL    WHEQ 'FRM'                      FRM
     C                     Z-ADD2         ZHAKAB
     C           W0INVL    WHEQ 'NEG'                      NEG
     C                     Z-ADD3         ZHAKAB
     C           W0INVL    WHEQ 'HDG'                      HDG
     C                     Z-ADD4         ZHAKAB
     C           W0INVL    WHEQ 'DST'                      DST
     C                     Z-ADD5         ZHAKAB
     C           W0INVL    WHEQ 'NHT'                      NHT
     C                     Z-ADD6         ZHAKAB
     C           W0INVL    WHEQ 'TNK'                      TNK
     C                     Z-ADD7         ZHAKAB
     C           W0INVL    WHEQ 'FLR'                      FLR
     C                     Z-ADD8         ZHAKAB
     C                     ENDSL
     C                     EXFMTZGAKAB
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHAKAB    WHEQ 1
     C                     MOVEL'CON'     W0INVL           CON
     C           ZHAKAB    WHEQ 2
     C                     MOVEL'FRM'     W0INVL           FRM
     C           ZHAKAB    WHEQ 3
     C                     MOVEL'NEG'     W0INVL           NEG
     C           ZHAKAB    WHEQ 4
     C                     MOVEL'HDG'     W0INVL           HDG
     C           ZHAKAB    WHEQ 5
     C                     MOVEL'DST'     W0INVL           DST
     C           ZHAKAB    WHEQ 6
     C                     MOVEL'NHT'     W0INVL           NHT
     C           ZHAKAB    WHEQ 7
     C                     MOVEL'TNK'     W0INVL           TNK
     C           ZHAKAB    WHEQ 8
     C                     MOVEL'FLR'     W0INVL           FLR
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DAKAB
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * SEL: Market Code
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Customer Market Code
     C           W0CFL     IFEQ '#DP6SX'                   *IF
      * Sel Market            SR - Sales Market  * 
     C                     CALL 'PMQYSRR'              90  Sel Market
     C                     PARM *BLANK    W0RTN   7
     C           #DP6SX    PARM #DP6SX    WQ0009  3        Market Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9956  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Buying Group.                            DN 05/21/20 R16543
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Buying Group
     C           W0CFL     IFEQ '#DZZAA'                   *IF
      * Sel Buying Group      SR - Buying Group  * 
     C                     CALL 'PUQ1SRR'              90  Sel Buying Grou
     C                     PARM *BLANK    W0RTN   7
     C           #DZZAA    PARM #DZZAA    WQ0010 10        Buying Group
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUQ1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * SEL: pallet
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.PM Pallet Type USR
     C           W0CFL     IFEQ '#DQ6U1'                   *IF
      * Sel Pallet Master     SR - Pallet Master  * 
     C                     CALL 'PUTOSRR'              90  Sel Pallet Mast
     C                     PARM *BLANK    W0RTN   7
     C           #DQ6U1    PARM #DQ6U1    WQ0011  2        PM Pallet Type
     C                     PARM YL0013    WQ0012  1        Rental_Y_N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9958  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Customer Market Code is Entered
     C           #DP6SX    IFNE *BLANK                     *IF
      * Rtv Description       RT - Customer Market  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DP6SX    WL0036    P      Market Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0037    #DR3NA    P      Market Desc
      * CASE: DTL.CM Market Desc is equal to blank
     C           #DR3NA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DP6SX    ZA0001           Customer Market
      * Send message 'Customer Market        NF'
     C                     MOVEL'USR3859' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9956  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Terms Master
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9943  *
     C                     END
      * Check reference to Carrier Info
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Type Codes New
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9942  *
     C                     END
      * Check reference to Warehouse Codes
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer Group Master
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer Group Master
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Commodity Markets
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0005           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DADTX    P      Name
      * RTV Cust Defaults      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0007           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DAYTX    P      Customer Name
     C                     MOVELWL0009    #DACNA    P      Address Line 1
     C                     MOVELWL0010    #DADNA    P      Address Line 2
     C                     MOVELWL0011    #DAENA    P      Address Line 3
     C                     MOVELWL0012    #DAJNA    P      City
     C                     MOVELWL0013    #DBGCD    P      State Code
     C                     MOVELWL0014    #DG5CD    P      County Code
     C                     MOVELWL0015    #DBTTX    P      Zip Postal Code
     C                     MOVELWL0016    WUBVTX    P      Telephone Numbe
     C                     MOVELWL0017    WUBWTX    P      Fax Number FF
     C                     MOVELWL0018    WUA2NA    P      Federal Tax Id
     C                     Z-ADDWL0019    WUANC7           AR Customer Num
     C                     MOVELWL0020    WUK6ST    P      Credit Check AR
     C                     MOVELWL0021    WUQWST    P      Email When Orde
     C                     MOVELWL0022    WUQYST    P      Item Reference
      * RTV State Description  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBGCD    WL0023    P      State Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DAUNA    P      Description
     C                     MOVELWL0025    WUVSST    P      Record Status
      * RTV County Desc.       RT - County Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBGCD    WL0026    P      State Code
     C                     MOVEL#DG5CD    WL0027    P      County Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    #DDL01    P      Description
     C                     MOVELWL0029    WUVSST    P      Record Status
      * RTV SR Desc,person     RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0030    P      Sales Route Cod
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #DMZNA    P      Sales Route Des
     C                     MOVELWL0032    YN0003    P      Salesperson Cod
      * RTV Type Code Desc.    RT - Type Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BOCD    WL0033    P      Type Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0034    #DIXTX    P      Description
     C                     MOVELWL0035    YN0004    P      Record Status
      * Rtv Description       RT - Sales Market  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DP6SX    WL0036    P      Market Code
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0037    #DR3NA    P      Market Desc
      * pallet type
      * CASE: DTL.PM Pallet Type USR is Entered
     C           #DQ6U1    IFNE *BLANK                     *IF
      * Rtv Pallet Desc       RT - Pallet Master  * 
     C                     EXSR SRRVGN
      * CASE: LCL.Pallet type 1 Desc is Not entered
     C           YL0014    IFEQ *BLANK                     *IF
      * Send message 'Pallet Master          NF'
     C                     MOVEL'USR5203' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Delivery Time.
      * CASE:
      *  - (c1 AND c2 )OR c3
      *   |- c1    : DTL.Deliver after time is Entered
      *   |- c2    : DTL.Deliver after time is LE 2400
      *   |- c3    : DTL.Deliver after time is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1R5NB    IFNE *ZERO                      *IF
     C           #1R5NB    IFLE 2400                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1R5NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL@CN,002   ZA0002           Generic Message
     C                     Z-ADD#1R5NB    ZA0003           Deliver after t
      * Send message 'Generic Message 80 NBR'
     C                     MOVEL'USR5117' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9957  *
      *
     C                     END                             *FI
      * F7=Edit Customer Item Reference
      * CASE: DTL.*CMD key is CF07
     C           *IN07     IFEQ '1'                        *IF
      * Edt Cust Item Ref     EF - Customer Item Reference  * 
     C                     CLEARPARC
     C                     Z-ADD#1BKC7    PABKC7           Ship To Custome
      *
     C                     CALL 'POMXEFR'              90  Edt Cust Item R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Customer I
     C                     PARM #DAYTX    WQ0024 30        Customer Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMXEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Enter temp type
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Cust Shipping Temp is Entered
      *   |- c2    : DTL.Cust Shipping Temp C/F EQ WRK.Blank for 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DPENX    IFNE *ZERO                      *IF
     C           #DHSSX    IFEQ WUOTTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Send message 'Enter Fahrenheit or Cels'
     C                     MOVEL'USR3139' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * DN 05/21/20 R16543-Validations for Buying Group Info.
      * CASE: DTL.Buying Group is Entered
     C           #DZZAA    IFNE *BLANK                     *IF
      * Val Active Buying Grp RT - Buying Group  * 
     C                     EXSR SSRVGN
      * Record Exist?
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If Not Active, Send Error Msg.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0016           Generic Message
     C                     MOVEL@CN,003   YL0016           Generic Message
      * Setup message data for message
     C                     MOVELYL0016    ZA0004           Generic Message
     C                     MOVEL#DZZAA    ZA0005           Buying Group
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0016           Generic Message
     C                     MOVEL@CN,004   YL0016           Generic Message
      * Setup message data for message
     C                     MOVELYL0016    ZA0006           Generic Message
     C                     MOVEL#DZZAA    ZA0007           Buying Group
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Buying Group is required.
      * CASE:
      *  - NOTc1
      *   |- c1    : DTL.Buying Group Opt In/Out is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DK8SC    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0016           Generic Message
     C                     MOVEL@CN,005   YL0016           Generic Message
      * Setup message data for message
     C                     MOVELYL0016    ZA0008           Generic Message
     C                     MOVEL#DZZAA    ZA0009           Buying Group
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Distributor required
     C           #1Q6ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Air Freight Orders required
     C           #DP0SX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Email When Order Shipped required
     C           #DQWST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Item Reference Status required
     C           #DQYST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9941  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Type Code required
     C           #1BOCD    IFEQ *BLANK                     IF
     C           *IN77     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Sales Route Code required
     C           #1R4CD    IFEQ *BLANK                     IF
     C           *IN76     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9943  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ord Ent Default Sls Rte required
     C           #1RBST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9944  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Field vs In_House flag required
     C           #DRKST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9951  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG Co/Customer - SalesIF
      * Company Customer Update  and Company Customer Ext Crt/Upd
      * upd deliver after time
      * RTV Chg Co/Cust        RT - Company Customer  * 
     C                     EXSR STRVGN
      * Customer Update
      * CHG Phone# & Fax # EXT CH - Customer  * 
     C                     EXSR SYCHRC
      * Rtv Upd Cust FaxBUYFX RT - Customer Fax  * 
     C                     EXSR TDRVGN
      * Rtv Chg Pallet/price  RT - Customer EXT2  * 
     C                     EXSR TGRVGN
      * DN 05/21/20 R16543-Update Buying Group Info in Customer EXT2 File
      * CASE: PAR.Ship To Customer Flag is Allow Use as Ship To Cust
     C           YL0007    IFEQ 'Y'                        *IF
      * Upd Buying Group Info RT - Customer EXT2  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YGRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           P2I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           YL0008    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #DHHAA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0035    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0007    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
      * Disable key screen
     C                     SETOF                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     MOVEL*BLANK    #DDL01           Description. .
     C                     MOVEL*BLANK    #1MMTX           Fax Invoice Fax
     C                     MOVEL*BLANK    #DWMT1           CDE Destination
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1LLST           Broker
     C                     MOVEL*BLANK    #1PPST           P_O Required Fl
     C                     Z-ADD*ZERO     #1R6NB           Deliver before
     C                     MOVEL*BLANK    #1QGST           Alt Remittance
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1MTCU           Mileage To Cust
     C                     Z-ADD*ZERO     #1W2NB           Co_Cust Overage
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #1X9ST           Outside Warehou
     C                     MOVEL*BLANK    #1T9CD           Customer Group
     C                     MOVEL*BLANK    #1UBCD           Customer Group
     C                     MOVEL*BLANK    #1ISTX           G_L Code
     C                     MOVEL*BLANK    #1LQCD           Commodity Marke
     C                     MOVEL*BLANK    #1NJNA           Credit Contact
     C                     MOVEL*BLANK    #1I0TX           Credit Contact
     C                     MOVEL*BLANK    #1NKNA           Credit Contact
     C                     MOVEL*BLANK    #1I1TX           Credit Contact
     C                     MOVEL*BLANK    #1VLST           Allow Man_Qt WO
     C                     MOVEL*BLANK    #1RLST           Fax Invoice Fla
     C                     MOVEL*BLANK    #1OHNA           Fax Invoice Con
     C                     MOVEL*BLANK    #1Q8ST           Default Shippin
     C                     MOVEL*BLANK    #1REST           Bypass DDt_Dela
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DAYTX           Customer Name
     C                     MOVEL*BLANK    #DACNA           Address Line 1
     C                     MOVEL*BLANK    #DADNA           Address Line 2
     C                     MOVEL*BLANK    #DH9ST           CCE Classificat
     C                     MOVEL*BLANK    #DAENA           Address Line 3
     C                     MOVEL*BLANK    #DAJNA           City
     C                     MOVEL*BLANK    #DBGCD           State Code
     C                     MOVEL*BLANK    #DBTTX           Zip Postal Code
     C                     MOVEL*BLANK    #DG5CD           County Code
     C                     Z-ADD*ZERO     #DDUC7           A_R Customer
      * Clear external version also
     C                     MOVEL*BLANK    VDDUC7
     C                     MOVEL*BLANK    #DAQTX           AR Customer Nam
     C                     MOVEL*BLANK    #DBVTX           Telephone Numbe
     C                     Z-ADD*ZERO     #DPENX           Cust Shipping T
     C                     MOVEL*BLANK    #DHSSX           Cust Shipping T
     C                     MOVEL*BLANK    #DBWTX           Fax Number FF
     C                     MOVEL*BLANK    #1Q6ST           Distributor
     C                     MOVEL*BLANK    #DUFTX           Internet Passwo
     C                     MOVEL*BLANK    #DP0SX           Air Freight Ord
     C                     MOVEL*BLANK    #DHLST           Print Req Delv
     C                     MOVEL*BLANK    #DQWST           Email When Orde
     C                     MOVEL*BLANK    #DUGTX           Email Address
     C                     MOVEL*BLANK    #DQYST           Item Reference
     C                     MOVEL*BLANK    #DHHAA           Broker Code
     C                     MOVEL*BLANK    #DC9T1           Broker Email Ad
     C                     MOVEL*BLANK    #1BOCD           Type Code
     C                     MOVEL*BLANK    #DIXTX           Condition Name
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #DMZNA           Sales Route Des
     C                     MOVEL*BLANK    #1RBST           Ord Ent Default
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #DZZAA           Buying Group
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #DK8SC           Buying Group Op
     C                     MOVEL*BLANK    #DTFTX           Buyer Fax Name
     C                     MOVEL*BLANK    #DHXNX           Buyer Fax Numbe
     C                     MOVEL*BLANK    #DRKST           Field vs In_Hou
     C                     MOVEL*BLANK    #DW5T1           Buyer Email Add
     C                     Z-ADD*ZERO     #DRJNY           Item Age Days F
     C                     Z-ADD*ZERO     #DRKNY           Item Age Days F
     C                     MOVEL*BLANK    #DP5SX           Customer Sales
     C                     MOVEL*BLANK    #DP6SX           Customer Market
     C                     MOVEL*BLANK    #DR3NA           Market Desc
     C                     Z-ADD*ZERO     #1R5NB           Deliver after t
     C                     MOVEL*BLANK    #DQ6U1           PM Pallet Type
     C                     MOVEL*BLANK    #DP1SX           Regional Mgr Fa
     C                     MOVEL*BLANK    #DE6T1           Reg Fax/Email S
     C                     MOVEL*BLANK    #DAKAB           Cust Dft Price
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @EOREUB fields to screen
      *================================================================
     C                     Z-ADDEOAIC3    #1AIC3           Company Number
     C                     MOVELEOMMTX    #1MMTX           Fax Invoice Fax
     C                     MOVELEOAQCD    #1AQCD           Terms Code
     C                     MOVELEOBZNA    #1BZNA           Carrier Code
     C                     MOVELEOLLST    #1LLST           Broker
     C                     MOVELEOPPST    #1PPST           P_O Required Fl
     C                     Z-ADDEOR6NB    #1R6NB           Deliver before
     C                     MOVELEOQGST    #1QGST           Alt Remittance
     C                     Z-ADDEOTBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDEOMTCU    #1MTCU           Mileage To Cust
     C                     Z-ADDEOW2NB    #1W2NB           Co_Cust Overage
     C                     MOVELEORPCD    #1RPCD           Age Code
     C                     MOVELEOAJCD    #1AJCD           Warehouse Code
     C                     MOVELEOX9ST    #1X9ST           Outside Warehou
     C                     MOVELEOT9CD    #1T9CD           Customer Group
     C                     MOVELEOUBCD    #1UBCD           Customer Group
     C                     MOVELEOISTX    #1ISTX           G_L Code
     C                     MOVELEOLQCD    #1LQCD           Commodity Marke
     C                     MOVELEONJNA    #1NJNA           Credit Contact
     C                     MOVELEOI0TX    #1I0TX           Credit Contact
     C                     MOVELEONKNA    #1NKNA           Credit Contact
     C                     MOVELEOI1TX    #1I1TX           Credit Contact
     C                     MOVELEOVLST    #1VLST           Allow Man_Qt WO
     C                     MOVELEORLST    #1RLST           Fax Invoice Fla
     C                     MOVELEOOHNA    #1OHNA           Fax Invoice Con
     C                     MOVELEOQ8ST    #1Q8ST           Default Shippin
     C                     MOVELEOREST    #1REST           Bypass DDt_Dela
     C                     MOVELEOUVST    #1UVST           EDI Status 1
     C                     MOVELEOUWST    #1UWST           EDI Status 2
     C                     MOVELEOUXST    #1UXST           EDI Status 3
     C                     MOVELEOVSST    #1VSST           Record Status
     C                     Z-ADDEOAATM    #1AATM           Job Time
     C                     MOVELEOAYNA    #1AYNA           User Id
     C                     MOVELEOA0NA    #1A0NA           Job Name
     C                     Z-ADDEOAXDT    #1AXDT           Job Date
     C                     Z-ADDEOBKC7    #1BKC7           Ship To Custome
     C                     MOVELEOQ6ST    #1Q6ST           Distributor
     C                     MOVELEOBOCD    #1BOCD           Type Code
     C                     MOVELEOR4CD    #1R4CD           Sales Route Cod
     C                     MOVELEORBST    #1RBST           Ord Ent Default
     C                     MOVELEOB6NA    #1B6NA           Special Instruc
     C                     MOVELEOBYNA    #1BYNA           Special Instruc
     C                     Z-ADDEOR5NB    #1R5NB           Deliver after t
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP5AJAA    #PAJAA           Company Number
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
     C                     Z-ADDP6FKNB    #PFKNB           USR Company Num
      * Clear external version also
     C                     MOVEL*BLANK    VPFKNB
     C                     Z-ADDP7BLC7    #PBLC7           USR Ship To Cus
      * Clear external version also
     C                     MOVEL*BLANK    VPBLC7
     C                     MOVELP8BWCD    #PBWCD           USR Salesperson
      * Check restriction within
     C                     EXSR VKCKRL
      * Check restriction within
     C                     EXSR VLCKRL
      * USER: Initialize key screen
     C                     Z-ADDP1AIC3    #PFKNB           USR Company Num
     C                     Z-ADDP1BKC7    #PBLC7           USR Ship To Cus
     C                     MOVELP1R4CD    #PBWCD           USR Salesperson
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#PFKNB    WL0005           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0012    P      Name
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #PFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#PFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VPFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPFKNB           CD3 Ext Numeric
     C                     END                             *FI
      * Convert USR Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PBLC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PBLC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPBLC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBLC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert A_R Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DDUC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DDUC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDDUC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDDUC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Check by Full Key  RT - Sales Route Authority  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           A7R4CD           Sales Route Cod
     C                     KFLD           A7BCCD           Salesperson Cod
     C                     KFLD           A7GETX           Approval Type
      * Setup key
     C                     MOVELWL0001    A7R4CD           Sales Route Cod
     C                     MOVELWL0002    A7BCCD           Salesperson Cod
     C                     MOVELWL0003    A7GETX           Approval Type
      * Establish starting position
     C           KRSSA     CHAIN@A7RELA              90    *
      * Data record not found
     C   90                MOVEL'USR3750' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           A7VSST    IFEQ 'A'                        *IF
     C                     MOVEL'N'       WL0004           Access Denied (
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0005    ABAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Name
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0006           Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Cust Defaults      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0007    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Customer Name
     C                     MOVEL*BLANK    WL0009           Address Line 1
     C                     MOVEL*BLANK    WL0010           Address Line 2
     C                     MOVEL*BLANK    WL0011           Address Line 3
     C                     MOVEL*BLANK    WL0012           City
     C                     MOVEL*BLANK    WL0013           State Code
     C                     MOVEL*BLANK    WL0014           County Code
     C                     MOVEL*BLANK    WL0015           Zip Postal Code
     C                     MOVEL*BLANK    WL0016           Telephone Numbe
     C                     MOVEL*BLANK    WL0017           Fax Number FF
     C                     MOVEL*BLANK    WL0018           Federal Tax Id
     C                     Z-ADD*ZERO     WL0019           AR Customer Num
     C                     MOVEL*BLANK    WL0020           Credit Check AR
     C                     MOVEL*BLANK    WL0021           Email When Orde
     C                     MOVEL*BLANK    WL0022           Item Reference
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0008           Customer Name
     C                     MOVELBBACNA    WL0009           Address Line 1
     C                     MOVELBBADNA    WL0010           Address Line 2
     C                     MOVELBBAENA    WL0011           Address Line 3
     C                     MOVELBBAJNA    WL0012           City
     C                     MOVELBBBGCD    WL0013           State Code
     C                     MOVELBBG5CD    WL0014           County Code
     C                     MOVELBBBTTX    WL0015           Zip Postal Code
     C                     MOVELBBBVTX    WL0016           Telephone Numbe
     C                     MOVELBBBWTX    WL0017           Fax Number FF
     C                     MOVELBBA2NA    WL0018           Federal Tax Id
     C                     Z-ADDBBANC7    WL0019           AR Customer Num
     C                     MOVELBBK6ST    WL0020           Credit Check AR
     C                     MOVELBBQWST    WL0021           Email When Orde
     C                     MOVELBBQYST    WL0022           Item Reference
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#DDUC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAQTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #DAQTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELWL0023    ACBGCD           State Code
      * Establish starting position
     C           KRSSE     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0024           Description
     C                     MOVEL*BLANK    WL0025           Record Status
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    WL0024           Description
     C                     MOVELACVSST    WL0025           Record Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV County Desc.       RT - County Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ECBGCD           State Code
     C                     KFLD           ECG5CD           County Code
      * Setup key
     C                     MOVELWL0026    ECBGCD           State Code
     C                     MOVELWL0027    ECG5CD           County Code
      * Establish starting position
     C           KRSSF     CHAIN@ECREVS              90    *
      * Data record not found
     C   90                MOVEL'USR0852' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELECAUNA    WL0028           Description
     C                     MOVELECVSST    WL0029           Record Status
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDEOBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DUFTX           Internet Passwo
     C                     MOVEL*BLANK    #DUGTX           Email Address
     C                     MOVEL*BLANK    YL0003           Email User ID
     C                     MOVEL*BLANK    P9J5NX           EDI Trading Par
     C                     MOVEL*BLANK    P9U5TX           EDI Cust Duns N
     C                     MOVEL*BLANK    P9U6TX           EDI Warehouse_S
     C                     MOVEL*BLANK    P9W0TX           State Tax ID
     C                     MOVEL*BLANK    P9HSSX           Cust Shipping T
     C                     MOVEL*BLANK    P9HUSX           One Invoice Per
     C                     MOVEL*BLANK    P9HVSX           EDI Advanced Sh
     C                     Z-ADD*ZERO     YL0004           Customer G_L Ve
     C                     MOVEL*BLANK    #DP0SX           Air Freight Ord
     C                     MOVEL*BLANK    #DP1SX           Regional Mgr Fa
     C                     MOVEL*BLANK    YL0005           Customer TF Exe
     C                     MOVEL*BLANK    #DP5SX           Customer Sales
     C                     MOVEL*BLANK    #DP6SX           Customer Market
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEUFTX    #DUFTX           Internet Passwo
     C                     MOVELNEUGTX    #DUGTX           Email Address
     C                     MOVELNEPFNA    YL0003           Email User ID
     C                     MOVELNEJ5NX    P9J5NX           EDI Trading Par
     C                     MOVELNEU5TX    P9U5TX           EDI Cust Duns N
     C                     MOVELNEU6TX    P9U6TX           EDI Warehouse_S
     C                     MOVELNEW0TX    P9W0TX           State Tax ID
     C                     MOVELNEHSSX    P9HSSX           Cust Shipping T
     C                     MOVELNEHUSX    P9HUSX           One Invoice Per
     C                     MOVELNEHVSX    P9HVSX           EDI Advanced Sh
     C                     Z-ADDNEAAC8    YL0004           Customer G_L Ve
     C                     MOVELNEP0SX    #DP0SX           Air Freight Ord
     C                     MOVELNEP1SX    #DP1SX           Regional Mgr Fa
     C                     MOVELNEP3SX    YL0005           Customer TF Exe
     C                     MOVELNEP5SX    #DP5SX           Customer Sales
     C                     MOVELNEP6SX    #DP6SX           Customer Market
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV SR Desc,person     RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0030    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSH     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Sales Route Des
     C                     MOVEL*BLANK    WL0032           Salesperson Cod
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    WL0031           Sales Route Des
     C                     MOVELJEBCCD    WL0032           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Type Code Desc.    RT - Type Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVELWL0033    AJBOCD           Type Code
      * Establish starting position
     C           KRSSI     CHAIN@AJREBR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0026' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0034           Description
     C                     MOVEL*BLANK    WL0035           Record Status
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAJAUNA    WL0034           Description
     C                     MOVELAJVSST    WL0035           Record Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Cust Shipping Tmp RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDEOAIC3    NIAIC3           Company Number
     C                     Z-ADDEOBKC7    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DPENX           Cust Shipping T
     C                     MOVEL*BLANK    #DHSSX           Cust Shipping T
     C                     MOVEL*BLANK    #DHLST           Print Req Delv
     C                     Z-ADD*ZERO     #DRJNY           Item Age Days F
     C                     Z-ADD*ZERO     #DRKNY           Item Age Days F
     C                     MOVEL*BLANK    #DH9ST           CCE Classificat
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDNIPENX    #DPENX           Cust Shipping T
     C                     MOVELNIHSSX    #DHSSX           Cust Shipping T
     C                     MOVELNIHLST    #DHLST           Print Req Delv
     C                     Z-ADDNIRJNY    #DRJNY           Item Age Days F
     C                     Z-ADDNIRKNY    #DRKNY           Item Age Days F
     C                     MOVELNIH9ST    #DH9ST           CCE Classificat
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Cust Fax Buyer NbrsRT - Customer Fax  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           M3BKC7           Ship To Custome
     C                     KFLD           M3A0AA           Fax Application
      * Setup key
     C                     Z-ADDEOBKC7    M3BKC7           Ship To Custome
     C                     MOVEL*BLANK    M3A0AA           Fax Application
      * Establish starting position
     C           KRSSK     CHAIN@M3REZE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2843' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DHXNX           Buyer Fax Numbe
     C                     MOVEL*BLANK    #DTFTX           Buyer Fax Name
     C                     MOVEL*BLANK    #DW5T1           Buyer Email Add
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELM3HXNX    #DHXNX           Buyer Fax Numbe
     C                     MOVELM3TFTX    #DTFTX           Buyer Fax Name
     C                     MOVELM3W5T1    #DW5T1           Buyer Email Add
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Description       RT - Sales Market  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           DDISAA           Market Code
      * Setup key
     C                     MOVELWL0036    DDISAA           Market Code
      * Establish starting position
     C           KRSSL     CHAIN@DDREQI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3863' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0037           Market Desc
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDDR3NA    WL0037           Market Desc
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Cust Sls Info     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           Parent Customer
     C                     MOVEL*BLANK    YL0007           Ship To Custome
     C                     MOVEL*BLANK    #DRKST           Field vs In_Hou
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDEOBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBBTC7    YL0006           Parent Customer
     C                     MOVELBBRJST    YL0007           Ship To Custome
     C                     MOVELBBRKST    #DRKST           Field vs In_Hou
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Pallet/price type RT - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDEOBKC7    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@AAREY9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4969' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DQ6U1           PM Pallet Type
     C                     MOVEL*BLANK    #DAKAB           Cust Dft Price
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAALWSC    #DQ6U1           PM Pallet Type
     C                     MOVELAAAKAB    #DAKAB           Cust Dft Price
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Buying Group Info RT - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #DZZAA           Buying Group
     C                     MOVEL*BLANK    #DK8SC           Buying Group Op
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDEOBKC7    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@AAREY9              90    *
      * Data record not found
     C   90                MOVEL'USR4969' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAZZAA    #DZZAA           Buying Group
     C                     MOVELAAK8SC    #DK8SC           Buying Group Op
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    #DHHAA           Broker Code
     C                     MOVEL*BLANK    #DC9T1           Broker Email Ad
      * Declare restrictor key work fields
     C           *LIKE     DEFN HOBKC7    WQSP01           Ship To Custome
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Ship To Custome
      * Setup key
     C                     Z-ADDEOBKC7    WQSP01           Ship To Custome
      * Establish starting position
     C           KRSSP     SETLL@HORELA                    *
     C           KRSSP     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Period Beginning Date LE PAR.Date From
      *   |- c2    : DB1.Period Ending Date GE PAR.Date From
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           HOBFDT    IFLE ##JDT                      *IF
     C           HOA2DT    IFGE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Broker Code is Entered
     C           HOHHAA    IFNE *BLANK                     *IF
      * Rtv All details        RT - Broker News  * 
     C                     EXSR SQRVGN
      * CASE: LCL.Record Status is Active
     C           YL0010    IFEQ 'A'                        *IF
     C                     MOVELHOHHAA    #DHHAA           Broker Code
     C                     MOVELYL0009    #DC9T1           Broker Email Ad
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv All details        RT - Broker News  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Broker Email Ad
     C                     MOVEL*BLANK    YL0010           Record Status
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           C5HHAA           Broker Code
      * Setup key
     C                     MOVELHOHHAA    C5HHAA           Broker Code
      * Establish starting position
     C           KRSSQ     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC5C9T1    YL0009           Broker Email Ad
     C                     MOVELC5VSST    YL0010           Record Status
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Pallet Desc       RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVEL#DQ6U1    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSSR     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0014           PM Description
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB6QJU1    YL0014           PM Description
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Val Active Buying Grp RT - Buying Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0015           Record Status
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           B1ZZAA           Buying Group
      * Setup key
     C                     MOVEL#DZZAA    B1ZZAA           Buying Group
      * Establish starting position
     C           KRSSS     CHAIN@B1REHM              90    *
      * Data record not found
     C   90                MOVEL'USR5183' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELB1VSST    YL0015           Record Status
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Chg Co/Cust        RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQST01           Ship To Custome
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WQST01           Ship To Custome
      * Establish starting position
     C           KRSST     SETLL@EOREU0                    *
     C           KRSST     READE@EOREU0                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Co/Customer - SalesCH - Company Customer  * 
     C                     EXSR SUCHRC
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * Rtv/Upd Shipping Temp RT - Company Customer EXT  * 
     C                     EXSR SVRVGN
     C           KRSST     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Co/Customer - SalesCH - Company Customer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Terms Code
     C                     MOVEL*BLANK    WN0002  3        Carrier Code
     C                     MOVEL*BLANK    WN0003  1        Broker
     C                     MOVEL*BLANK    WN0004  1        P_O Required Fl
     C                     Z-ADD*ZERO     WN0005  40       Deliver before
     C                     MOVEL*BLANK    WN0006  1        Alt Remittance
     C                     Z-ADD*ZERO     WN0007  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0008  92       Mileage To Cust
     C                     Z-ADD*ZERO     WN0009 112       Co_Cust Overage
     C                     MOVEL*BLANK    WN0010  3        Warehouse Code
     C                     MOVEL*BLANK    WN0011  1        Outside Warehou
     C                     MOVEL*BLANK    WN0012  3        Customer Group
     C                     MOVEL*BLANK    WN0013  3        Customer Group
     C                     MOVEL*BLANK    WN0014  8        G_L Code
     C                     MOVEL*BLANK    WN0015  3        Commodity Marke
     C                     MOVEL*BLANK    WN0016 30        Credit Contact
     C                     MOVEL*BLANK    WN0017 25        Credit Contact
     C                     MOVEL*BLANK    WN0018 30        Credit Contact
     C                     MOVEL*BLANK    WN0019 25        Credit Contact
     C                     MOVEL*BLANK    WN0020  1        Allow Man_Qt WO
     C                     MOVEL*BLANK    WN0021  1        Fax Invoice Fla
     C                     MOVEL*BLANK    WN0022 25        Fax Invoice Fax
     C                     MOVEL*BLANK    WN0023 30        Fax Invoice Con
     C                     MOVEL*BLANK    WN0024  1        Default Shippin
     C                     MOVEL*BLANK    WN0025  1        Bypass DDt_Dela
     C                     MOVEL*BLANK    WN0026  1        EDI Status 1
     C                     MOVEL*BLANK    WN0027  1        EDI Status 2
     C                     MOVEL*BLANK    WN0028  1        EDI Status 3
     C                     MOVEL*BLANK    WN0029  1        Record Status
     C                     Z-ADD*ZERO     WN0030  60       Job Time
     C                     MOVEL*BLANK    WN0031 10        User Id
     C                     MOVEL*BLANK    WN0032 10        Job Name
     C                     Z-ADD*ZERO     WN0033  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @EOREXL
     C                     Z-ADDWBAIC3    EOAIC3           Company Number
     C                     Z-ADDWBBKC7    EOBKC7           Ship To Custome
      *
     C           KLCHSU    KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
     C           KLCHSU    CHAIN@EOREXL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAEOREL0'MDACP
     C                     MOVEL'@EOREXL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @EOREXL
     C                     MOVEL#1R4CD    EOR4CD    P      Sales Route Cod
     C                     MOVEL#1BYNA    EOBYNA    P      Special Instruc
     C                     MOVEL#1B6NA    EOB6NA    P      Special Instruc
     C                     Z-ADD#1R5NB    EOR5NB           Deliver after t
     C                     MOVEL#1BOCD    EOBOCD    P      Type Code
     C                     MOVEL#1RPCD    EORPCD    P      Age Code
     C                     MOVEL#1Q6ST    EOQ6ST    P      Distributor
     C                     MOVEL#1RBST    EORBST    P      Ord Ent Default
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) EOAATM' defaulted for 'Job Time'.
      * Field '(DB1) EOAYNA' defaulted for 'User Id'.
      * Field '(DB1) EOA0NA' defaulted for 'Job Name'.
      * Field '(DB1) EOAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     EOAATM           Job Time
     C                     MOVEL##USR     EOAYNA           User Id
     C                     MOVEL##JOB     EOA0NA           Job Name
     C                     Z-ADD##JDT     EOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@EOREXL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAEOREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv/Upd Shipping Temp RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBAIC3    NIAIC3           Company Number
     C                     Z-ADDWBBKC7    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSV     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Cust Elec Comm    CR - Company Customer EXT  * 
     C                     EXSR SWCRRC
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Shipping Temp    CH - Company Customer EXT  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt Cust Elec Comm    CR - Company Customer EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0034 10        Internet Passwo
     C                     MOVEL*BLANK    WN0035 50        Email Address
     C                     MOVEL*BLANK    WN0036  8        Email User ID
     C                     MOVEL*BLANK    WN0037  6        EDI Trading Par
     C                     MOVEL*BLANK    WN0038 20        EDI Cust Duns N
     C                     MOVEL*BLANK    WN0039 20        EDI Warehouse_S
     C                     MOVEL*BLANK    WN0040 20        State Tax ID
     C                     Z-ADD*ZERO     WN0041  50       Additional Rout
     C                     MOVEL*BLANK    WN0042  1        EDI Invoices
     C                     MOVEL*BLANK    WN0043  1        One Invoice Per
     C                     MOVEL*BLANK    WN0044  1        EDI Advanced Sh
     C                     MOVEL*BLANK    WN0045 20        HPB Employer ID
     C                     MOVEL*BLANK    WN0046  4        HPB ULSD Compan
     C                     MOVEL*BLANK    WN0047  5        HPB ULSD Facili
     C                     MOVEL*BLANK    WN0048  3        Ship To Warehou
     C                     MOVEL*BLANK    WN0049  3        CCE Unused Text
     C                     MOVEL*BLANK    WN0050  2        CCE GL Sales Ac
     C                     MOVEL*BLANK    WN0051 15        DP Location 15
     C                     MOVEL*BLANK    WN0052  3        CCE Unused Text
     C                     Z-ADD*ZERO     WN0053  70       CCE Last ABS Fr
     C                     Z-ADD*ZERO     WN0054  60       Job Time
     C                     MOVEL*BLANK    WN0055 10        User Id
     C                     MOVEL*BLANK    WN0056 10        Job Name
     C                     Z-ADD*ZERO     WN0057  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NIREBN
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
     C                     Z-ADD#DPENX    WCPENX           Cust Shipping T
     C                     MOVEL#DHSSX    WCHSSX           Cust Shipping T
     C                     MOVEL#DHLST    WCHLST           Print Req Delv
     C                     Z-ADD#DRJNY    WCRJNY           Item Age Days F
     C                     Z-ADD#DRKNY    WCRKNY           Item Age Days F
     C                     MOVEL#DH9ST    WCH9ST           CCE Classificat
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSW    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRSW    SETLL@NIREBN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2905' W0RTN   7
      * Send message 'Company Customer EXT   EX'
     C                     MOVEL'USR2905' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@NIREBN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Shipping Temp    CH - Company Customer EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0058 10        Internet Passwo
     C                     MOVEL*BLANK    WN0059 50        Email Address
     C                     MOVEL*BLANK    WN0060  8        Email User ID
     C                     MOVEL*BLANK    WN0061  6        EDI Trading Par
     C                     MOVEL*BLANK    WN0062 20        EDI Cust Duns N
     C                     MOVEL*BLANK    WN0063 20        EDI Warehouse_S
     C                     MOVEL*BLANK    WN0064 20        State Tax ID
     C                     Z-ADD*ZERO     WN0065  50       Additional Rout
     C                     MOVEL*BLANK    WN0066  1        EDI Invoices
     C                     MOVEL*BLANK    WN0067  1        One Invoice Per
     C                     MOVEL*BLANK    WN0068  1        EDI Advanced Sh
     C                     MOVEL*BLANK    WN0069 20        HPB Employer ID
     C                     MOVEL*BLANK    WN0070  4        HPB ULSD Compan
     C                     MOVEL*BLANK    WN0071  5        HPB ULSD Facili
     C                     MOVEL*BLANK    WN0072  3        Ship To Warehou
     C                     MOVEL*BLANK    WN0073  3        CCE Unused Text
     C                     MOVEL*BLANK    WN0074  2        CCE GL Sales Ac
     C                     MOVEL*BLANK    WN0075 15        DP Location 15
     C                     MOVEL*BLANK    WN0076  3        CCE Unused Text
     C                     Z-ADD*ZERO     WN0077  70       CCE Last ABS Fr
     C                     Z-ADD*ZERO     WN0078  60       Job Time
     C                     MOVEL*BLANK    WN0079 10        User Id
     C                     MOVEL*BLANK    WN0080 10        Job Name
     C                     Z-ADD*ZERO     WN0081  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @NIREBN
     C                     Z-ADDNIAIC3    WCAIC3           Company Number
     C                     Z-ADDNIBKC7    WCBKC7           Ship To Custome
      *
     C           KLCHSX    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
     C           KLCHSX    CHAIN@NIREBN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNIREL0'MDACP
     C                     MOVEL'@NIREBN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDNI1    YBRDCS
      * Move non-key fields to @NIREBN
     C                     Z-ADD#DPENX    WCPENX           Cust Shipping T
     C                     MOVEL#DHSSX    WCHSSX    P      Cust Shipping T
     C                     MOVEL#DHLST    WCHLST    P      Print Req Delv
     C                     Z-ADD#DRJNY    WCRJNY           Item Age Days F
     C                     Z-ADD#DRKNY    WCRKNY           Item Age Days F
     C                     MOVEL#DH9ST    WCH9ST    P      CCE Classificat
      *
      * Set PGM.*Record Data Changed flag
     C           QPDNI1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDNI1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@NIREBN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDNIREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Phone# & Fax # EXT CH - Customer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0082 30        Customer Name
     C                     MOVEL*BLANK    WN0083 30        Address Line 1
     C                     MOVEL*BLANK    WN0084 30        Address Line 2
     C                     MOVEL*BLANK    WN0085 30        Address Line 3
     C                     MOVEL*BLANK    WN0086 20        City
     C                     MOVEL*BLANK    WN0087  2        State Code
     C                     MOVEL*BLANK    WN0088  6        County Code
     C                     MOVEL*BLANK    WN0089 11        Zip Postal Code
     C                     MOVEL*BLANK    WN0090 25        Alpha Search
     C                     MOVEL*BLANK    WN0091 20        Federal Tax Id
     C                     MOVEL*BLANK    WN0092  1        New Customer St
     C                     MOVEL*BLANK    WN0093  8        SIC Number
     C                     Z-ADD*ZERO     WN0094  90       D_B Number
     C                     MOVEL*BLANK    WN0095  5        D_B Rating
     C                     Z-ADD*ZERO     WN0096  70       Date of D_B Rat
     C                     Z-ADD*ZERO     WN0097  70       Credit Line Exp
     C                     Z-ADD*ZERO     WN0098  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0099  70       Parent Customer
     C                     MOVEL*BLANK    WN0100  1        Credit Check AR
     C                     MOVEL*BLANK    WN0101  1        Credit Check Pa
     C                     MOVEL*BLANK    WN0102  6        Country Code
     C                     MOVEL*BLANK    WN0103  1        EDI Invoice Sts
     C                     MOVEL*BLANK    WN0104  1        Order Entry Hol
     C                     Z-ADD*ZERO     WN0105 112       Parent Credit L
     C                     Z-ADD*ZERO     WN0106 112       AR Credit Limit
     C                     Z-ADD*ZERO     WN0107  70       Order Entry Hol
     C                     MOVEL*BLANK    WN0108  1        Ship To Custome
     C                     MOVEL*BLANK    WN0109  1        Print Invoice S
     C                     MOVEL*BLANK    WN0110  1        Statement Print
     C                     MOVEL*BLANK    WN0111  1        EDI Status 1
     C                     MOVEL*BLANK    WN0112  1        EDI Status 2
     C                     MOVEL*BLANK    WN0113  1        EDI Status 3
     C                     MOVEL*BLANK    WN0114  1        Record Status
     C                     Z-ADD*ZERO     WN0115  60       Job Time
     C                     MOVEL*BLANK    WN0116 10        User Id
     C                     MOVEL*BLANK    WN0117 10        Job Name
     C                     Z-ADD*ZERO     WN0118  70       Job Date
     C                     MOVEL*BLANK    WN0119  8        Email User ID
     C                     MOVEL*BLANK    WN0120  1        Employee_Co_Pac
     C                     MOVEL*BLANK    WN0121  2        Customer Watch
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BBREE8
     C                     Z-ADD#1BKC7    WDBKC7           Ship To Custome
      *
     C           KLCHSY    KLIST
     C                     KFLD           WDBKC7           Ship To Custome
     C           KLCHSY    CHAIN@BBREE8              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABBREL0'MDACP
     C                     MOVEL'@BBREE8' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCABB1    YCRDCS
      * USER: Processing after Data read
      * Create or change customer ext record
      * Val Cust Elec Exists  RT - Customer EXT  * 
     C                     EXSR SZRVGN
      * Create or change customer ext record
      * CASE: LCL.Email User ID is Not Entered Blank
     C           YL0017    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0019           Customer Number
     C                     MOVELWDBKC7    YL0019           Customer Number
     C                     Z-ADD*ZERO     ZQ      50
     C           'A'       CAT  YL0019:ZQ YL0017    P      Email User ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Upd Customer EXT      RT - Customer EXT  * 
     C                     EXSR TARVGN
      * Move non-key fields to @BBREE8
     C                     MOVEL#DBVTX    WDBVTX    P      Telephone Numbe
     C                     MOVEL#DBWTX    WDBWTX    P      Fax Number FF
     C                     MOVEL#DRKST    WDRKST    P      Field vs In_Hou
     C                     MOVEL#DQWST    WDQWST    P      Email When Orde
     C                     MOVEL#DQYST    WDQYST    P      Item Reference
      *
      * Set PGM.*Record Data Changed flag
     C           QCABB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCABB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BBREE8                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABBREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Val Cust Elec Exists  RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0017           Email User ID
     C                     MOVEL*BLANK    YL0018           Air Freight Ord
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSZ     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEPFNA    YL0017           Email User ID
     C                     MOVELNEP0SX    YL0018           Air Freight Ord
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Upd Customer EXT      RT - Customer EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0122  1        EDI Status 1
     C                     MOVEL*BLANK    WN0123  1        EDI Status 2
     C                     MOVEL*BLANK    WN0124  1        EDI Status 3
     C                     MOVEL*BLANK    WN0125  1        Record Status
     C                     Z-ADD*ZERO     WN0126  60       Job Time
     C                     MOVEL*BLANK    WN0127 10        User Id
     C                     MOVEL*BLANK    WN0128 10        Job Name
     C                     Z-ADD*ZERO     WN0129  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSTA     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Customer Elec Comm CR - Customer EXT  * 
     C                     EXSR TBCRRC
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * upd empl/copack with db1.. its not passed in
      * Chg Customer Elec Comm CH - Customer EXT  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Customer Elec Comm CR - Customer EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0130  60       Job Time
     C                     MOVEL*BLANK    WN0131 10        User Id
     C                     MOVEL*BLANK    WN0132 10        Job Name
     C                     Z-ADD*ZERO     WN0133  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NEREAS
     C                     Z-ADDWDBKC7    WEBKC7           Ship To Custome
     C                     MOVEL#DUFTX    WEUFTX           Internet Passwo
     C                     MOVEL#DUGTX    WEUGTX           Email Address
     C                     MOVELYL0017    WEPFNA           Email User ID
     C                     MOVELP9J5NX    WEJ5NX           EDI Trading Par
     C                     MOVELP9U5TX    WEU5TX           EDI Cust Duns N
     C                     MOVELP9U6TX    WEU6TX           EDI Warehouse_S
     C                     MOVELP9W0TX    WEW0TX           State Tax ID
     C                     MOVEL#DHSSX    WEHSSX           Cust Shipping T
     C                     MOVELP9HUSX    WEHUSX           One Invoice Per
     C                     MOVELP9HVSX    WEHVSX           EDI Advanced Sh
     C                     Z-ADDYL0004    WEAAC8           Customer G_L Ve
     C                     MOVEL#DP0SX    WEP0SX           Air Freight Ord
     C                     MOVEL#DP1SX    WEP1SX           Regional Mgr Fa
     C                     MOVELWN0120    WEP2SX           Employee_Co_Pac
     C                     MOVELYL0005    WEP3SX           Customer TF Exe
     C                     MOVELWN0121    WEP4SX           Customer Watch
     C                     MOVEL#DP5SX    WEP5SX           Customer Sales
     C                     MOVEL#DP6SX    WEP6SX           Customer Market
     C                     MOVELWN0122    WEUVST           EDI Status 1
     C                     MOVELWN0123    WEUWST           EDI Status 2
     C                     MOVELWN0124    WEUXST           EDI Status 3
     C                     MOVELWN0125    WEVSST           Record Status
      *
      * USER: Processing before Data update
      * Add customer to Pork Email File - This is an IBM file.
      * Crt Cust Usr Id IBM Fl UP - Customer EXT  * 
     C                     CALL 'PDW1UPR'              90  Crt Cust Usr Id
     C                     PARM WEUGTX    WQ0025 50        Email Address
     C                     PARM WEPFNA    WQ0026  8        Email User ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW1UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRTB    KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRTB    SETLL@NEREAS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2881' W0RTN   7
      * Send message 'Customer EXT           EX'
     C                     MOVEL'USR2881' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@NEREAS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Customer Elec Comm CH - Customer EXT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0134  60       Job Time
     C                     MOVEL*BLANK    WN0135 10        User Id
     C                     MOVEL*BLANK    WN0136 10        Job Name
     C                     Z-ADD*ZERO     WN0137  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @NEREAS
     C                     Z-ADDNEBKC7    WEBKC7           Ship To Custome
      *
     C           KLCHTC    KLIST
     C                     KFLD           WEBKC7           Ship To Custome
     C           KLCHTC    CHAIN@NEREAS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNEREL0'MDACP
     C                     MOVEL'@NEREAS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDNE1    YDRDCS
      * Move non-key fields to @NEREAS
     C                     MOVEL#DUFTX    WEUFTX    P      Internet Passwo
     C                     MOVEL#DUGTX    WEUGTX    P      Email Address
     C                     MOVELYL0017    WEPFNA    P      Email User ID
     C                     MOVELP9J5NX    WEJ5NX    P      EDI Trading Par
     C                     MOVELP9U5TX    WEU5TX    P      EDI Cust Duns N
     C                     MOVELP9U6TX    WEU6TX    P      EDI Warehouse_S
     C                     MOVELP9W0TX    WEW0TX    P      State Tax ID
     C                     MOVEL#DHSSX    WEHSSX    P      Cust Shipping T
     C                     MOVELP9HUSX    WEHUSX    P      One Invoice Per
     C                     MOVELP9HVSX    WEHVSX    P      EDI Advanced Sh
     C                     Z-ADDYL0004    WEAAC8           Customer G_L Ve
     C                     MOVEL#DP0SX    WEP0SX    P      Air Freight Ord
     C                     MOVEL#DP1SX    WEP1SX    P      Regional Mgr Fa
     C                     MOVELNEP2SX    WEP2SX    P      Employee_Co_Pac
     C                     MOVELYL0005    WEP3SX    P      Customer TF Exe
     C                     MOVELWN0121    WEP4SX    P      Customer Watch
     C                     MOVEL#DP5SX    WEP5SX    P      Customer Sales
     C                     MOVEL#DP6SX    WEP6SX    P      Customer Market
     C                     MOVELNEUVST    WEUVST    P      EDI Status 1
     C                     MOVELNEUWST    WEUWST    P      EDI Status 2
     C                     MOVELNEUXST    WEUXST    P      EDI Status 3
     C                     MOVELNEVSST    WEVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Add or change Pork Email Address in file. - This is an IBM file.
      * Crt Cust Usr Id IBM Fl UP - Customer EXT  * 
     C                     CALL 'PDW1UPR'              90  Crt Cust Usr Id
     C                     PARM WEUGTX    WQ0027 50        Email Address
     C                     PARM WEPFNA    WQ0028  8        Email User ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW1UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDNE1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@NEREAS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDNEREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Upd Cust FaxBUYFX RT - Customer Fax  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           M3BKC7           Ship To Custome
     C                     KFLD           M3A0AA           Fax Application
      * Setup key
     C                     Z-ADD#1BKC7    M3BKC7           Ship To Custome
     C                     MOVEL*BLANK    M3A0AA           Fax Application
      * Establish starting position
     C           KRSTD     CHAIN@M3REZE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2843' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Customer Fax      CR - Customer Fax  * 
     C                     EXSR TECRRC
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Customer Fax      CH - Customer Fax  * 
     C                     EXSR TFCHRC
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Customer Fax      CR - Customer Fax  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @M3REZD
     C                     Z-ADD#1BKC7    WFBKC7           Ship To Custome
     C                     MOVEL*BLANK    WFA0AA           Fax Application
     C                     MOVEL#DHXNX    WFHXNX           Buyer Fax Numbe
     C                     MOVEL#DTFTX    WFTFTX           Buyer Fax Name
     C                     MOVEL#DW5T1    WFW5T1           Buyer Email Add
     C                     MOVEL@CN,006   WFHYNX           Fax Number 2
     C                     MOVEL@CN,006   WFTGTX           Fax Contact Nam
     C                     MOVEL*BLANK    WFHZNX           Fax Number 3
     C                     MOVEL*BLANK    WFTHTX           Fax Contact Nam
     C                     MOVEL*BLANK    WFD7T1           Fax Number 4
     C                     MOVEL*BLANK    WFD8T1           Fax Contact Nam
     C                     MOVEL*BLANK    WFD9T1           Fax Number 5
     C                     MOVEL*BLANK    WFEAT1           Fax Contact Nam
     C                     MOVELWUFISX    WFFISX           Fax Unused Sts
     C                     MOVELWUFJSX    WFFJSX           Fax Unused Sts
     C                     MOVELWUFKSX    WFFKSX           Fax Unused Sts
     C                     MOVELWUFLSX    WFFLSX           Fax Unused Sts
     C                     MOVELWUFMSX    WFFMSX           Fax Unused Sts
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     MOVEL*BLANK    WFCCVN           Create User
     C                     MOVEL*BLANK    WFCDVN           Create Program
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WFMJDT           Create Date
     C                     Z-ADD##JTM     WFBETM           Create Time
     C                     MOVEL##USR     WFCCVN           Create User
     C                     MOVEL##PGM     WFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
     C                     MOVEL*BLANK    WFCEVN           Change User
     C                     MOVEL*BLANK    WFCFVN           Change Program
     C           KLCRTE    KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFA0AA           Fax Application
      * Check for duplicate primary key
     C           KLCRTE    SETLL@M3REZD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2844' W0RTN   7
      * Send message 'Customer Fax           EX'
     C                     MOVEL'USR2844' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@M3REZD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Customer Fax      CH - Customer Fax  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @M3REZD
     C                     Z-ADD#1BKC7    WFBKC7           Ship To Custome
     C                     MOVEL*BLANK    WFA0AA    P      Fax Application
      *
     C           KLCHTF    KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFA0AA           Fax Application
     C           KLCHTF    CHAIN@M3REZD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDM3REL0'MDACP
     C                     MOVEL'@M3REZD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDM31    YERDCS
      * Move non-key fields to @M3REZD
     C                     MOVEL#DHXNX    WFHXNX    P      Buyer Fax Numbe
     C                     MOVEL#DTFTX    WFTFTX    P      Buyer Fax Name
     C                     MOVEL#DW5T1    WFW5T1    P      Buyer Email Add
     C                     MOVELM3HYNX    WFHYNX    P      Fax Number 2
     C                     MOVELM3TGTX    WFTGTX    P      Fax Contact Nam
     C                     MOVELM3HZNX    WFHZNX    P      Fax Number 3
     C                     MOVELM3THTX    WFTHTX    P      Fax Contact Nam
     C                     MOVELM3D7T1    WFD7T1    P      Fax Number 4
     C                     MOVELM3D8T1    WFD8T1    P      Fax Contact Nam
     C                     MOVELM3D9T1    WFD9T1    P      Fax Number 5
     C                     MOVELM3EAT1    WFEAT1    P      Fax Contact Nam
     C                     MOVELM3FISX    WFFISX    P      Fax Unused Sts
     C                     MOVELM3FJSX    WFFJSX    P      Fax Unused Sts
     C                     MOVELM3FKSX    WFFKSX    P      Fax Unused Sts
     C                     MOVELM3FLSX    WFFLSX    P      Fax Unused Sts
     C                     MOVELM3FMSX    WFFMSX    P      Fax Unused Sts
     C                     MOVELM3VSST    WFVSST    P      Record Status
     C                     Z-ADDM3MJDT    WFMJDT           Create Date
     C                     Z-ADDM3BETM    WFBETM           Create Time
     C                     MOVELM3CCVN    WFCCVN    P      Create User
     C                     MOVELM3CDVN    WFCDVN    P      Create Program
     C                     Z-ADDM3MKDT    WFMKDT           Change Date
     C                     Z-ADDM3BFTM    WFBFTM           Change Time
     C                     MOVELM3CEVN    WFCEVN    P      Change User
     C                     MOVELM3CFVN    WFCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPDM31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WFMKDT           Change Date
     C                     Z-ADD##JTM     WFBFTM           Change Time
     C                     MOVEL##USR     WFCEVN           Change User
     C                     MOVEL##PGM     WFCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPDM31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@M3REZD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDM3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Chg Pallet/price  RT - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSTG     CHAIN@AAREY9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Customer EXT2     CR - Customer EXT2  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0038           Ship To Custome
     C                     MOVEL*BLANK    WL0039           M3 Supplier ID
     C                     MOVEL*BLANK    WL0040           Dft Mode of Tra
     C                     MOVEL*BLANK    WL0041           Buying Group
     C                     MOVEL*BLANK    WL0042           Buying Group Op
     C                     MOVELYL0020    WL0043    P      CEXT2 Unused St
     C                     MOVELYL0021    WL0044    P      CEXT2 Unused St
     C                     MOVELYL0022    WL0045    P      CEXT2 Unused St
     C                     MOVEL*BLANK    WL0046           Automated A_R A
     C                     MOVEL*BLANK    WL0047           CEXT2 Unused Cd
     C                     MOVEL*BLANK    WL0048           CEXT2 Unused Cd
     C                     Z-ADD*ZERO     WL0049           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WL0050           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WL0051           CEXT2 Unused Dt
     C                     Z-ADD*ZERO     WL0052           CEXT2 Unused Tm
     C                     MOVEL*BLANK    WL0053           Ship To Establi
     C                     MOVEL#DQ6U1    WL0054    P      PM Pallet Type
     C                     MOVEL#DAKAB    WL0055    P      Cust Dft Price
     C                     Z-ADD*ZERO     WL0056           Cust Dft Age Da
     C                     Z-ADD*ZERO     WL0057           Cust Dft Delive
     C                     EXSR THCRRC
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pallet/Price typesCH - Customer EXT2  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Crt Customer EXT2     CR - Customer EXT2  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0138  1        Record Status
     C                     Z-ADD*ZERO     WN0139  70       Create Date
     C                     Z-ADD*ZERO     WN0140  60       Create Time
     C                     MOVEL*BLANK    WN0141 10        Create User
     C                     MOVEL*BLANK    WN0142 10        Create Program
     C                     Z-ADD*ZERO     WN0143  70       Change Date
     C                     Z-ADD*ZERO     WN0144  60       Change Time
     C                     MOVEL*BLANK    WN0145 10        Change User
     C                     MOVEL*BLANK    WN0146 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AAREY8
     C                     Z-ADDWL0038    WGBKC7           Ship To Custome
     C                     MOVELWL0039    WGVEAA           M3 Supplier ID
     C                     MOVELWL0040    WGD9SC           Dft Mode of Tra
     C                     MOVELWL0041    WGZZAA           Buying Group
     C                     MOVELWL0042    WGK8SC           Buying Group Op
     C                     MOVELWL0043    WGK5SC           CEXT2 Unused St
     C                     MOVELWL0044    WGK6SC           CEXT2 Unused St
     C                     MOVELWL0045    WGK7SC           CEXT2 Unused St
     C                     MOVELWL0046    WGZ3AA           Automated A_R A
     C                     MOVELWL0047    WGZ4AA           CEXT2 Unused Cd
     C                     MOVELWL0048    WGZ5AA           CEXT2 Unused Cd
     C                     Z-ADDWL0049    WGGBNZ           CEXT2 Unused Nb
     C                     Z-ADDWL0050    WGFCNZ           CEXT2 Unused Nb
     C                     Z-ADDWL0051    WGXKDT           CEXT2 Unused Dt
     C                     Z-ADDWL0052    WGEPTM           CEXT2 Unused Tm
     C                     MOVELWL0053    WGO1U1           Ship To Establi
     C                     MOVELWL0054    WGLWSC           PM Pallet Type
     C                     MOVELWL0055    WGAKAB           Cust Dft Price
     C                     Z-ADDWL0056    WGGANZ           Cust Dft Age Da
     C                     Z-ADDWL0057    WGEOTM           Cust Dft Delive
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WGVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WGMJDT           Create Date
     C                     Z-ADD##JTM     WGBETM           Create Time
     C                     MOVEL##USR     WGCCVN           Create User
     C                     MOVEL##PGM     WGCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
     C                     MOVEL*BLANK    WGCEVN           Change User
     C                     MOVEL*BLANK    WGCFVN           Change Program
     C           KLCRTH    KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRTH    SETLL@AAREY8                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4970' W0RTN   7
      * Send message 'Customer EXT2          EX'
     C                     MOVEL'USR4970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C                     WRITE@AAREY8                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Pallet/Price typesCH - Customer EXT2  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0147 10        M3 Supplier ID
     C                     MOVEL*BLANK    WN0148  2        Dft Mode of Tra
     C                     MOVEL*BLANK    WN0149 10        Buying Group
     C                     MOVEL*BLANK    WN0150  1        Buying Group Op
     C                     MOVEL*BLANK    WN0151  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0152  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0153  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0154  3        Automated A_R A
     C                     MOVEL*BLANK    WN0155  3        CEXT2 Unused Cd
     C                     MOVEL*BLANK    WN0156  6        CEXT2 Unused Cd
     C                     Z-ADD*ZERO     WN0157  50       CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WN0158  70       CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WN0159  70       CEXT2 Unused Dt
     C                     Z-ADD*ZERO     WN0160  60       CEXT2 Unused Tm
     C                     MOVEL*BLANK    WN0161 25        Ship To Establi
     C                     Z-ADD*ZERO     WN0162  50       Cust Dft Age Da
     C                     Z-ADD*ZERO     WN0163  60       Cust Dft Delive
     C                     MOVEL*BLANK    WN0164  1        Record Status
     C                     Z-ADD*ZERO     WN0165  70       Create Date
     C                     Z-ADD*ZERO     WN0166  60       Create Time
     C                     MOVEL*BLANK    WN0167 10        Create User
     C                     MOVEL*BLANK    WN0168 10        Create Program
     C                     Z-ADD*ZERO     WN0169  70       Change Date
     C                     Z-ADD*ZERO     WN0170  60       Change Time
     C                     MOVEL*BLANK    WN0171 10        Change User
     C                     MOVEL*BLANK    WN0172 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AAREY8
     C                     Z-ADDAABKC7    WGBKC7           Ship To Custome
      *
     C           KLCHTI    KLIST
     C                     KFLD           WGBKC7           Ship To Custome
     C           KLCHTI    CHAIN@AAREY8              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUAAREL0'MDACP
     C                     MOVEL'@AAREY8' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUAA1    YFRDCS
      * Move non-key fields to @AAREY8
     C                     MOVEL#DQ6U1    WGLWSC    P      PM Pallet Type
     C                     MOVEL#DAKAB    WGAKAB    P      Cust Dft Price
      *
      * Set PGM.*Record Data Changed flag
     C           QPUAA1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WN0169           Change Date
     C                     Z-ADD##JTM     WN0170           Change Time
     C                     MOVEL##USR     WN0171           Change User
     C                     MOVEL##PGM     WN0172           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPUAA1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AAREY8                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUAAREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Upd Buying Group Info RT - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSTJ     CHAIN@AAREY9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Customer EXT2     CR - Customer EXT2  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0038           Ship To Custome
     C                     MOVEL*BLANK    WL0039           M3 Supplier ID
     C                     MOVEL'FT'      WL0040    P      Dft Mode of Tra
     C                     MOVEL#DZZAA    WL0041    P      Buying Group
     C                     MOVEL#DK8SC    WL0042    P      Buying Group Op
     C                     MOVELYL0023    WL0043    P      CEXT2 Unused St
     C                     MOVELYL0024    WL0044    P      CEXT2 Unused St
     C                     MOVELYL0025    WL0045    P      CEXT2 Unused St
     C                     MOVELYL0026    WL0046    P      Automated A_R A
     C                     MOVELYL0027    WL0047    P      CEXT2 Unused Cd
     C                     MOVELYL0028    WL0048    P      CEXT2 Unused Cd
     C                     Z-ADDYL0029    WL0049           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WL0050           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WL0051           CEXT2 Unused Dt
     C                     Z-ADDYL0030    WL0052           CEXT2 Unused Tm
     C                     MOVELYL0031    WL0053    P      Ship To Establi
     C                     MOVEL*BLANK    WL0054           PM Pallet Type
     C                     MOVELYL0032    WL0055    P      Cust Dft Price
     C                     Z-ADDYL0033    WL0056           Cust Dft Age Da
     C                     Z-ADDYL0034    WL0057           Cust Dft Delive
     C                     EXSR THCRRC
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Buying Group NE DB1.Buying Group
      *   |- c2    : PAR.Buying Group Opt In/Out NE DB1.Buying Group Opt
      *   '-
     C           #DZZAA    IFNE AAZZAA                     *IF
     C           #DK8SC    ORNE AAK8SC                     *OR
      * Chg Buying Group Info CH - Customer EXT2  * 
     C                     EXSR TKCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg Buying Group Info CH - Customer EXT2  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0173 10        M3 Supplier ID
     C                     MOVEL*BLANK    WN0174  2        Dft Mode of Tra
     C                     MOVEL*BLANK    WN0175  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0176  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0177  1        CEXT2 Unused St
     C                     MOVEL*BLANK    WN0178  3        Automated A_R A
     C                     MOVEL*BLANK    WN0179  3        CEXT2 Unused Cd
     C                     MOVEL*BLANK    WN0180  6        CEXT2 Unused Cd
     C                     Z-ADD*ZERO     WN0181  50       CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WN0182  70       CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WN0183  70       CEXT2 Unused Dt
     C                     Z-ADD*ZERO     WN0184  60       CEXT2 Unused Tm
     C                     MOVEL*BLANK    WN0185 25        Ship To Establi
     C                     MOVEL*BLANK    WN0186  2        PM Pallet Type
     C                     MOVEL*BLANK    WN0187  3        Cust Dft Price
     C                     Z-ADD*ZERO     WN0188  50       Cust Dft Age Da
     C                     Z-ADD*ZERO     WN0189  60       Cust Dft Delive
     C                     MOVEL*BLANK    WN0190  1        Record Status
     C                     Z-ADD*ZERO     WN0191  70       Create Date
     C                     Z-ADD*ZERO     WN0192  60       Create Time
     C                     MOVEL*BLANK    WN0193 10        Create User
     C                     MOVEL*BLANK    WN0194 10        Create Program
     C                     Z-ADD*ZERO     WN0195  70       Change Date
     C                     Z-ADD*ZERO     WN0196  60       Change Time
     C                     MOVEL*BLANK    WN0197 10        Change User
     C                     MOVEL*BLANK    WN0198 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @AAREY8
     C                     Z-ADDAABKC7    WGBKC7           Ship To Custome
      *
     C           KLCHTK    KLIST
     C                     KFLD           WGBKC7           Ship To Custome
     C           KLCHTK    CHAIN@AAREY8              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUAAREL0'MDACP
     C                     MOVEL'@AAREY8' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUAA1    YGRDCS
      * USER: Processing after Data read
      * If Buying Group Info Changed Then Update Else Quit.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Buying Group NE DB1.Buying Group
      *   |- c2    : PAR.Buying Group Opt In/Out NE DB1.Buying Group Opt
      *   '-
     C           #DZZAA    IFNE WGZZAA                     *IF
     C           #DK8SC    ORNE WGK8SC                     *OR
      * Continue to update.
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO TKEXIT                     *QUIT
     C                     END                             *FI
      * Move non-key fields to @AAREY8
     C                     MOVEL#DZZAA    WGZZAA    P      Buying Group
     C                     MOVEL#DK8SC    WGK8SC    P      Buying Group Op
      *
      * Set PGM.*Record Data Changed flag
     C           QPUAA1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WGMKDT           Change Date
     C                     Z-ADD##JTM     WGBFTM           Change Time
     C                     MOVEL##USR     WGCEVN           Change User
     C                     MOVEL##PGM     WGCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPUAA1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@AAREY8                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUAAREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0199    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTL     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0037           Company Number
     C                     MOVELDRBUVN    WN0200           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0058    DTAJVN           User Profile Na
     C                     MOVELWL0059    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTM     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0060           Company Number
     C                     MOVELDTAJCD    WL0061           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTN01           Application Cod
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTN01           Application Cod
     C                     MOVEL'A/R'     WQTN01           Application Cod
      * Establish starting position
     C           KRSTN     SETLL@DNRESF                    *
     C           KRSTN     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C           KRSTN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTO01           Application Cod
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTO01           Application Cod
      * Establish starting position
     C           KRSTO     SETLL@DNRESF                    *
     C           KRSTO     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTP     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0201           User Code Model
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WN0201           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv First Org         RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DTAJVN    WQTQ01           User Profile Na
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           User Profile Na
      * Setup key
     C                     MOVELWL0062    WQTQ01           User Profile Na
      * Establish starting position
     C           KRSTQ     SETLL@DTRETE                    *
     C           KRSTQ     READE@DTRETE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0063           Company Number
     C                     MOVEL*BLANK    WL0064           Warehouse Code
     C                     MOVEL*BLANK    WL0065           User Organizati
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0063           Company Number
     C                     MOVELDTAJCD    WL0064           Warehouse Code
     C                     MOVELDTJFST    WL0065           User Organizati
     C                     GOTO TQEXIT                     *QUIT
     C           KRSTQ     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv SalesCstSoldTo Ex RT - Sales Customer Sold To  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSTR     CHAIN@B6REVA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4836' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0035           Sales Sold To E
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0035           Sales Sold To E
     C                     GOTO TREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVAWA    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'AR Customer Number'.
      * Field '(LCL) YL0011' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0002  70       AR Customer Num
     C           YL0011    PARM *ZERO     WQ0003  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVBBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Terms Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AQCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'CACFSRR'              90  SEL Terms
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0013  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0014  2        Terms Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CACFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVCAO    CHAIN@AOREB3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Terms Master           NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0015  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9943  *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVDJE    CHAIN@JEREWF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Carrier Info
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #DADTX' defaulted for 'Name'.
     C                     CALL 'PDWHSRR'              90  SEL Carrier Nam
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0016  3        Carrier Code
     C           #DADTX    PARM *BLANK    WQ0017 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVEFF    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Type Codes New
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BOCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Type Code
     C           YPMTFD    OREQ '#1BOCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BOCD' defaulted for 'Type Code'.
     C                     CALL 'CABVSRR'              90  SEL Type Codes
     C                     PARM *BLANK    W0RTN   7
     C           #1BOCD    PARM #1BOCD    WQ0018  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9942  *
     C                     END
      *
     C           #1BOCD    IFNE *BLANK                     Type Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BOCD    IFEQ *BLANK                     Type Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAJ    KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVEL#1BOCD    AJBOCD
     C           KLVFAJ    CHAIN@AJREBR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Type Codes New         NF'
     C                     MOVEL'USR0026' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0026' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0019  3        Warehouse Code
     C                     PARM *ZERO     WQ0020  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAD    KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    ADAJCD
     C           KLVGAD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Customer Group Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1T9CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Group
     C           YPMTFD    OREQ '#1T9CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1T9CD' defaulted for 'Customer Group Code'.
     C                     CALL 'PDSASRR'              90  SEL Active Cust
     C                     PARM *BLANK    W0RTN   7
     C           #1T9CD    PARM #1T9CD    WQ0021  3        Customer Group
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1T9CD    IFNE *BLANK                     Customer Group
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1T9CD    IFEQ *BLANK                     Customer Group
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHJX    KLIST
     C                     KFLD           JXT9CD           Customer Group
      * Setup key
     C                     MOVEL#1T9CD    JXT9CD
     C           KLVHJX    CHAIN@JXREB5              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Customer Group Master  NF'
     C                     MOVEL'USR2021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2021' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Customer Group Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1UBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Customer Group
     C           YPMTFD    OREQ '#1UBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1UBCD' defaulted for 'Customer Group Code 2'.
     C                     CALL 'PDSASRR'              90  SEL Active Cust
     C                     PARM *BLANK    W0RTN   7
     C           #1UBCD    PARM #1UBCD    WQ0022  3        Customer Group
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1UBCD    IFNE *BLANK                     Customer Group
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1UBCD    IFEQ *BLANK                     Customer Group
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIJX    KLIST
     C                     KFLD           JXT9CD           Customer Group
      * Setup key
     C                     MOVEL#1UBCD    JXT9CD
     C           KLVIJX    CHAIN@JXREB5              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Customer Group Master  NF'
     C                     MOVEL'USR2021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2021' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Commodity Markets
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Marke
     C           YPMTFD    OREQ '#1LQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LQCD' defaulted for 'Commodity Market Code'.
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #1LQCD    PARM #1LQCD    WQ0023  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1LQCD    IFNE *BLANK                     Commodity Marke
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LQCD    IFEQ *BLANK                     Commodity Marke
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJFY    KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#1LQCD    FYLQCD
     C           KLVJFY    CHAIN@FYREDK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Commodity Markets      NF'
     C                     MOVEL'USR1218' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1218' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0029  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VK999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVKWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVKWA    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
     C           VK999     TAG
      * Restrictor relation not satisfied
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'AR Customer Number'.
      * Field '(LCL) YL0011' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0030  70       AR Customer Num
     C           YL0011    PARM *ZERO     WQ0031  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VL999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVLBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVLBB    CHAIN@BBREE9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
     C           VL999     TAG
      * Restrictor relation not satisfied
      * Send message 'Customer Master        NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ110
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHSSX'  YPMTFD           Cust Shipping T
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ102
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1Q6ST'  YPMTFD           Distributor
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ063
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DP0SX'  YPMTFD           Air Freight Ord
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ102
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHLST'  YPMTFD           Print Req Delv
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ025
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DQYST'  YPMTFD           Item Reference
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE026
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1BOCD'  YPMTFD           Type Code
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE050
     C           ZHCSCL    ANDLE052
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1R4CD'  YPMTFD           Sales Route Cod
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ081
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1RBST'  YPMTFD           Ord Ent Default
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ111
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DK8SC'  YPMTFD           Buying Group Op
     C                     END
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDEQ104
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DRKST'  YPMTFD           Field vs In_Hou
     C                     END
      *
     C           ZHCSRW    IFEQ 023
     C           ZHCSCL    ANDGE104
     C           ZHCSCL    ANDLE106
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DAKAB'  YPMTFD           Cust Dft Price
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2JFST           User Organizati
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3G3TX           PRT Description
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P3WSST           PRT Hold Output
     C                     MOVEL*BLANK    P3WTST           PRT Save Output
     C                     MOVEL*BLANK    P3WUST           PRT Night Queue
     C                     MOVEL*BLANK    P3BVVN           PRT Night Queue
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4M8NB           System Value Nu
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5AJAA           Company Number
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6FKNB           USR Company Num
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7BLC7           USR Ship To Cus
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8BWCD           USR Salesperson
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9J5NX           EDI Trading Par
     C                     MOVEL*BLANK    P9U5TX           EDI Cust Duns N
     C                     MOVEL*BLANK    P9U6TX           EDI Warehouse_S
     C                     MOVEL*BLANK    P9W0TX           State Tax ID
     C                     MOVEL*BLANK    P9HSSX           Cust Shipping T
     C                     MOVEL*BLANK    P9HUSX           One Invoice Per
     C                     MOVEL*BLANK    P9HVSX           EDI Advanced Sh
     C                     MOVEL*BLANK    P9P1SX           Regional Mgr Fa
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Federal Tax Id
     C                     MOVEL*BLANK    WUA2NA 20
      * Define work field Credit Check AR Customer
     C                     MOVEL*BLANK    WUK6ST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Telephone Number FF
     C                     MOVEL*BLANK    WUBVTX 25
      * Define work field Fax Number FF
     C                     MOVEL*BLANK    WUBWTX 25
      * Define work field AR Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field Email When Order Shipped
     C                     MOVEL*BLANK    WUQWST  1
      * Define work field Item Reference Status
     C                     MOVEL*BLANK    WUQYST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBR5NB           Deliver after t
     C                     Z-ADD*ZERO     WBR6NB           Deliver before
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WBW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCKSNX           Additional Rout
     C                     Z-ADD*ZERO     WCPENX           Cust Shipping T
     C                     Z-ADD*ZERO     WCJ7NY           CCE Last ABS Fr
     C                     Z-ADD*ZERO     WCRJNY           Item Age Days F
     C                     Z-ADD*ZERO     WCRKNY           Item Age Days F
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDP3NB           D_B Number
     C                     Z-ADD*ZERO     WDI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WDAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WDVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WDI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEAAC8           Customer G_L Ve
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Fax Unused Sts 1
     C                     MOVEL*BLANK    WUFISX  1
      * Define work field Fax Unused Sts 2
     C                     MOVEL*BLANK    WUFJSX  1
      * Define work field Fax Unused Sts 3
     C                     MOVEL*BLANK    WUFKSX  1
      * Define work field Fax Unused Sts 4
     C                     MOVEL*BLANK    WUFLSX  2
      * Define work field Fax Unused Sts 5
     C                     MOVEL*BLANK    WUFMSX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGGBNZ           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WGFCNZ           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     WGXKDT           CEXT2 Unused Dt
     C                     Z-ADD*ZERO     WGEPTM           CEXT2 Unused Tm
     C                     Z-ADD*ZERO     WGGANZ           Cust Dft Age Da
     C                     Z-ADD*ZERO     WGEOTM           Cust Dft Delive
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHTYAA           Sales Sold To C
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  2
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006 30
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010 30
     C                     MOVEL*BLANK    WL0011 30
     C                     MOVEL*BLANK    WL0012 20
     C                     MOVEL*BLANK    WL0013  2
     C                     MOVEL*BLANK    WL0014  6
     C                     MOVEL*BLANK    WL0015 11
     C                     MOVEL*BLANK    WL0016 25
     C                     MOVEL*BLANK    WL0017 25
     C                     MOVEL*BLANK    WL0018 20
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027  6
     C                     MOVEL*BLANK    WL0028 30
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031 30
     C                     MOVEL*BLANK    WL0032  3
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0033  2
     C                     MOVEL*BLANK    WL0034 30
     C                     MOVEL*BLANK    WL0035  1
      * Define local variables for subroutine SLRVGN.
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037 30
      * Define local variables for subroutine THCRRC.
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039 10
     C                     MOVEL*BLANK    WL0040  2
     C                     MOVEL*BLANK    WL0041 10
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  3
     C                     MOVEL*BLANK    WL0047  3
     C                     MOVEL*BLANK    WL0048  6
     C                     Z-ADD*ZERO     WL0049  50
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  60
     C                     MOVEL*BLANK    WL0053 25
     C                     MOVEL*BLANK    WL0054  2
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  50
     C                     Z-ADD*ZERO     WL0057  60
      * Define local variables for subroutine TMRVGN.
     C                     MOVEL*BLANK    WL0058 10
     C                     MOVEL*BLANK    WL0059  6
     C                     Z-ADD*ZERO     WL0060  30
     C                     MOVEL*BLANK    WL0061  3
      * Define local variables for subroutine TQRVGN.
     C                     MOVEL*BLANK    WL0062 10
     C                     Z-ADD*ZERO     WL0063  30
     C                     MOVEL*BLANK    WL0064  3
     C                     MOVEL*BLANK    WL0065  1
      * Define local work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field USR Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Email User ID
     C                     MOVEL*BLANK    YL0003  8
      * Define local work field Customer G_L Vendor Num
     C                     Z-ADD*ZERO     YL0004  80
      * Define null work field Employee_Co_Packer Sale
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Customer TF Exempt Code
     C                     MOVEL*BLANK    YL0005  2
      * Define null work field Customer Watch Flag
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Ship To Warehouse
     C                     MOVEL*BLANK    YN0005  3
      * Define local work field Parent Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Parent Status         USR
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Broker Name
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Broker Address Line 1
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Broker Address Line 2
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Broker City
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field Broker State
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Broker Zip
     C                     MOVEL*BLANK    YN0011 11
      * Define null work field Broker Office Manager
     C                     MOVEL*BLANK    YN0012 30
      * Define null work field Broker Telephone Number
     C                     MOVEL*BLANK    YN0013 25
      * Define null work field Broker Fax Number
     C                     MOVEL*BLANK    YN0014 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0009 50
      * Define null work field Broker G_L Vendor Number
     C                     Z-ADD*ZERO     YN0015  80
      * Define null work field Broker unused txt 1
     C                     MOVEL*BLANK    YN0016 25
      * Define null work field Broker M3 Supplier
     C                     MOVEL*BLANK    YN0017 20
      * Define null work field Broker EDI Trade Partner
     C                     MOVEL*BLANK    YN0018 20
      * Define null work field Broker Fax_Email Inv
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Broker Fax_Email Prc Sht
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Payee Type
     C                     MOVEL*BLANK    YN0021  2
      * Define null work field Broker unused sts 4
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0023  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0026  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0011  80
      * Define local work field Name
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Rental_Y_N
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Pallet type 1 Desc
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0016 80
      * Define local work field Email User ID
     C                     MOVEL*BLANK    YL0017  8
      * Define local work field Air Freight Orders
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Customer Number Alpha
     C                     MOVEL*BLANK    YL0019  7
      * Define local work field CEXT2 Unused Sts 1
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field CEXT2 Unused Sts 2
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field CEXT2 Unused Sts 3
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field CEXT2 Unused Sts 1
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field CEXT2 Unused Sts 2
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field CEXT2 Unused Sts 3
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Automated A_R Aging Rpt
     C                     MOVEL*BLANK    YL0026  3
      * Define local work field CEXT2 Unused Cde 2
     C                     MOVEL*BLANK    YL0027  3
      * Define local work field CEXT2 Unused Cde 3
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field CEXT2 Unused Nbr 2
     C                     Z-ADD*ZERO     YL0029  50
      * Define local work field CEXT2 Unused Tme 1
     C                     Z-ADD*ZERO     YL0030  60
      * Define local work field Ship To Establishment nbr
     C                     MOVEL*BLANK    YL0031 25
      * Define local work field Cust Dft Price Type
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field Cust Dft Age Days
     C                     Z-ADD*ZERO     YL0033  50
      * Define local work field Cust Dft Delivery Time
     C                     Z-ADD*ZERO     YL0034  60
      * Define local work field Sales Sold To Exist
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0036  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0038  3
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0027  30
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0028  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0199 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0199           User Profile Na
      *
     C                     MOVEL*BLANK    WN0200 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TLRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,007                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0199    ZA0010           User Profile Na
     C                     MOVEL'A/R'     ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0200    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0199    WL0058    P      User Profile Na
     C                     MOVEL'A/R'     WL0059    P      Application Cod
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    YL0036           Company Number
     C                     MOVELWL0061    YL0038    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0200    WL0058    P      User Profile Na
     C                     MOVEL'A/R'     WL0059    P      Application Cod
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0060    YL0036           Company Number
     C                     MOVELWL0061    YL0038    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0038    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0199    ZA0012           User Profile Na
     C                     MOVEL'A/R'     ZA0013           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0037    IFNE 0                          *IF
     C                     Z-ADDYL0037    YL0036           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0038    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0032  3        Warehouse Code
     C                     PARM YL0037    WQ0033  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TNRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      *
     C                     MOVEL*BLANK    WN0201 10        User Code Model
      *
      * RTV First Org         IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR TPRVGN
      * CASE: PAR.User Code Model is equal to blank
     C           WN0201    IFEQ *BLANK                     *IF
      * Rtv First Org         RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0062    P      User Profile Na
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YN0027           Company Number
     C                     MOVELWL0064    YN0028    P      Warehouse Code
     C                     MOVELWL0065    P2JFST    P      User Organizati
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv First Org         RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0201    WL0062    P      User Profile Na
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YN0027           Company Number
     C                     MOVELWL0064    YN0028    P      Warehouse Code
     C                     MOVELWL0065    P2JFST    P      User Organizati
     C                     END                             *FI
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL'N'       P3WUST           PRT Night Queue
      * E3882SS JJH 01/29/16 - Determine if there is a Sales Customer Sol
      *   To record
      * Rtv SalesCstSoldTo Ex RT - Sales Customer Sold To  * 
     C                     EXSR TRRVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
010470130301815
** W0END
010490130901817
** W0NAM
VPFKNB    VPBLC7    #PBWCD
** W1BEG
01049010580130501561016100181702073
02094020970212102329023380258502662
02670028410291803097031350317403609
03628038650387903886041210412604146
04152041770463304710048890497505145
05176052240540105480055030565705688
056940573605759059130591505992
** W1END
01055010870133401590016100184602092
02095021070212602335023670260902668
02670028650291803106031350317403609
03677038650388403935041220413504148
04163041770467204719049280497505169
05200052240545005483055060565905690
057120573905760059130592805994
** W1NAM
V1BKC7    #DAYTX    #DACNA    #DADNA    #DH9ST    #DAENA    #DAJNA
#DBGCD    #DBTTX    #DG5CD    VDDUC7    #DAQTX    #DBVTX    #DPENX
#DHSSX    #DBWTX    #1Q6ST    #DUFTX    #DP0SX    #DHLST    #DQWST
#DUGTX    #DQYST    #DHHAA    #DC9T1    #1BOCD    #DIXTX    #1R4CD
#DMZNA    #1RBST    #1B6NA    #DZZAA    #1BYNA    #DK8SC    #DTFTX
#DHXNX    #DRKST    #DW5T1    #DRJNY    #DRKNY    #DP5SX    #DP6SX
#DR3NA    #1R5NB    #DQ6U1    #DP1SX    #DE6T1    #DAKAB
** @CN
00001 USR0752
00002 Invalid time.
00003 Buying Group not active.
00004 Buying Group not found.
00005 Buying Group required.
00006 *BLANKS
00007 Y2U0005
