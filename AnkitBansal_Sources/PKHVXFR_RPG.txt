     H/TITLE Prc Fax Prdcr/Prdcrloc XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISPPATE
     H* Date          : 10/19/00  Time  : 11:25:22
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     E                    QRCP       45 25
     E                    QRCO       45 30
     E                    QFXA       45  3
     E                    QFXN       45 12
     E                    QRTG       45  3
     E                    QINT       45  3
     E                    QAD1       45 30
     E                    QAD2       45 30
     E                    QCTY       45 30
     E                    QSTA       45  2
     E                    QZIP       45 10
     E                    QCNY       45 30
     E                    QCT1       15 80
     E                    QCT2       15 80
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQIAPDS      DS
     I                                        1  10 QSDR
     I*                                                  USER ID OF SENDER
     I                                       11  160QSDT
     I*                                                  SEND DATE MMDDYY
     I                                       17  200QSTM
     I*                                                  SEND TIME  24HR HHMM
     I                                       21  220QPTY
     I*                                                  SEND PRIORITY
     I*                                                  01=HI - 98=LO 99=HLD
     I                                       23  29 QCAC
     I*                                                  COST ACCOUNT
     I                                       30  39 QCVR
     I*                                                  COVER NAME
     I                                       40  49 QFMN
     I*                                                  FORM NAME
     I                                       50  500QRSL
     I*                                                  FUTURE/RESOLUTTION
     I                                       51  530QFPG
     I*                                                  FUTURE/FROM PAGE
     I                                       54  560QTPG
     I*                                                  FUTURE/TO PAGE
     I                                       57  590QPGL
     I*                                                  FUTURE/PAGE LENGTH
     I                                       60  620QPGW
     I*                                                  FUTURE/PAGE WIDTH
     I                                       63  640QCPI
     I*                                                  FUTURE/CPI
     I                                       65  660QLPI
     I*                                                  FUTURE/LPI
     I                                       67  710QFNT
     I*                                                  FUTURE/FONT NAME
     I                                       72  74 QSVC
     I*                                                  SAVE COPY OF FAX
     I*                                                  0=NO 999=PERM X=DAYS
     I                                       75  75 QPRC
     I*                                                  PRINT COPY OF FAX
     I*                                                  0=NO 1=IMMED 2=SENT
     I                                       76  85 QPRQ
     I*                                                  PRINTER/OUTQ NAME
     I                                       86  95 QQLB
     I*                                                  OUTQ LIBRARY
     I                                       96  96 QPRF
     I*                                                  FUTURE/PRINT W/FORM
     I                                       97  97 QLAN
     I*                                                  FUTURE/LANDSCAPE
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * B :  PD VND Address Number
     I                                        1   80P1GCNB
      * B :  Pl VND Address Number
     I                                        9  160P1GLNB
      * I :  Fax Producer USR
     I                                       17  17 P1PMST
      * I :  Fax Producer/Location USR
     I                                       18  18 P1PNST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Spool File Selection
     I                                        1  10 P2AFNA
      * N :  Display Fax Select Screen
     I                                       11  11 P2PHST
      * N :  User-defined attribute
     I                                       12  21 P2UATR
      * N :  Send Date
     I                                    P  22  250P2KXDT
      * N :  Send Time
     I                                    P  26  290P2SDTM
      * N :  Send Priority
     I                                    P  30  310P2FRNB
      * N :  Cost Account Name
     I                                       32  38 P2AGNA
      * N :  Cover Sheet Name
     I                                       39  48 P2AHNA
      * N :  Forms Type Str.
     I                                       49  58 P2FDNA
      * N :  Fax Resolution
     I                                    P  59  590P2FAXR
      * N :  From Page
     I                                    P  60  610P2FRMP
      * N :  To Page
     I                                    P  62  630P2TOPG
      * N :  Page Length
     I                                    P  64  650P2PGLN
      * N :  Page Width
     I                                    P  66  670P2PGWD
      * N :  CPI
     I                                    P  68  690P2CPII
      * N :  LPI
     I                                    P  70  710P2LPII
      * N :  Save Copy of Fax
     I                                       72  74 P2LITX
      * N :  Print Copy of Fax
     I                                       75  75 P2PCOF
      * N :  Printer Name or Outq
     I                                       76  85 P2LJTX
      * N :  Outq Library
     I                                       86  95 P2LKTX
      * N :  Print on Form
     I                                       96  96 P2PROF
      * N :  Landscape
     I                                       97  97 P2PSST
      * N :  Fax Recipient
     I                                       98 122 P2LLTX
      * N :  Company Recipient Name
     I                                      123 152 P2LMTX
      * N :  Fax Area Code
     I                                      153 155 P2XDCD
      * N :  Fax Phone Number
     I                                      156 167 P2LNTX
      * N :  Routing Code
     I                                      168 170 P2GJCD
      * N :  International Code
     I                                      171 173 P2P0ST
      * N :  Fast Fax Address Line 1
     I                                      174 203 P2AQNA
      * N :  Fast Fax Address Line 2
     I                                      204 233 P2ARNA
      * N :  City for Fax
     I                                      234 263 P2LOTX
      * N :  Fast Fax State Code
     I                                      264 265 P2EINA
      * N :  Zip Code for Fax
     I                                      266 275 P2LPTX
      * N :  Country Description
     I                                      276 305 P2ASNA
      * N :  Index
     I                                    P 306 3070P2INDE
     IP3PARM      DS
      * FLD: STR VND Common Routines
      * N :  Fax Area Code #
     I                                        1   6 P3LSTX
      * N :  Fax Telephone
     I                                        7  26 P3LRTX
      * N :  Fax Attn 1
     I                                       27  66 P3NVTX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1GCNB    PARM P1GCNB    WP0001  80       PD VND Address
     C           P1GLNB    PARM P1GLNB    WP0002  80       Pl VND Address
     C           P1PMST    PARM           WP0003  1        Fax Producer US
     C           P1PNST    PARM           WP0004  1        Fax Producer/Lo
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Fax Prdcr/Prdcrloc XF
     C                     Z-ADD*ZERO     P2INDE           Index
      * Setup producer fax
      * CASE: PAR.Fax Producer USR is Yes
     C           P1PMST    IFEQ 'Y'                        *IF
      * Get Vendor Address    RT - STR VND Common Routines  * 
     C                     CALL 'VNDFAXR'              90  Get Vendor Addr
     C           WUGUST    PARM *BLANK    WQ0001  7        *Return code
     C           P1GCNB    PARM P1GCNB    WQ0002  80       Address Number
     C           P2LLTX    PARM P2LLTX    WQ0003 40        Pass Name
     C           WUDNTX    PARM WUDNTX    WQ0004 40        Address 1
     C           WUDOTX    PARM WUDOTX    WQ0005 40        Address 2
     C           WUDPTX    PARM WUDPTX    WQ0006 40        Address 3
     C           WUDQTX    PARM WUDQTX    WQ0007 40        City
     C           WUDRTX    PARM WUDRTX    WQ0008  3        State
     C           WUDSTX    PARM WUDSTX    WQ0009 12        Zip
     C           WUDTTX    PARM WUDTTX    WQ0010  6        Area Code
     C           WUDUTX    PARM WUDUTX    WQ0011 20        Telephone
     C           P3LSTX    PARM P3LSTX    WQ0012  6        Fax Area Code #
     C           P3LRTX    PARM P3LRTX    WQ0013 20        Fax Telephone
     C           WUNGTX    PARM WUNGTX    WQ0014  6        Fax Area Code #
     C           WUNHTX    PARM WUNHTX    WQ0015 20        Fax Telephone 2
     C           WUGNST    PARM WUGNST    WQ0016  1        Vendor 1099
     C           WUDXTX    PARM WUDXTX    WQ0017 16        Vendor Tax Id.
     C           WUE0CD    PARM WUE0CD    WQ0018  3        Country Code
     C                     PARM WUJYST    WQ0019  1        Producer/Trucke
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'VNDFAXR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Vendor Return Code Usr is Vendor Error
     C           WUGUST    IFEQ 'ERR'                      *IF
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         P2INDE           Index
     C                     MOVELP3LSTX    P2XDCD           Fax Area Code
     C                     MOVELP3LRTX    P2LNTX           Fax Phone Numbe
     C                     MOVEL*BLANK    P2AFNA           Spool File Sele
     C                     MOVEL'*JOB'    P2AFNA           Spool File Sele
     C                     MOVEL'Y'       P2PHST           Display Fax Sel
      * Convert to MDY format.
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL##JDT     WUCZCD           Date Alpha USR
     C                     MOVEL*BLANK    WUOITX           Date From Conve
     C                     MOVELWUCZCD    WUOITX           Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM WUOITX    WQ0020 10        Date From Conve
     C           WUOJTX    PARM *BLANK    WQ0021 11        Date To Convert
     C                     PARM '*CYMD'   WQ0022  8        Date From Forma
     C                     PARM '*MDY'    WQ0023  8        Date To Format
     C                     PARM '*NONE'   WQ0024  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUOJTX    WUFLCD           Code USR
     C                     MOVE WUFLCD    P2KXDT           Send Date
      * PRC Load FastFax Array US - STR User Source Functions  * 
     C                     Z-ADDP2INDE    X       30                   TEXT2
     C                     MOVELP2LLTX    QRCP,X                       TEXT2
     C                     MOVELP2LMTX    QRCO,X                       Y
     C                     MOVELP2XDCD    QFXA,X                       E ARRAY
     C                     MOVELP2LNTX    QFXN,X                       RRAY
     C                     MOVELP2GJCD    QRTG,X                        ARRAY
     C                     MOVELP2P0ST    QINT,X                       'INT'
     C                     MOVELP2AQNA    QAD1,X                       ARRAY
     C                     MOVELP2ARNA    QAD2,X                       ARRAY
     C                     MOVELP2LOTX    QCTY,X                       RRAY
     C                     MOVELP2EINA    QSTA,X                       ARRAY
     C                     MOVELP2LPTX    QZIP,X                       RAY
     C                     MOVELP2ASNA    QCNY,X                       Y ARRAY
     C                     END                             *FI
     C                     END                             *FI
      * Setup producer location fax
      * CASE: PAR.Fax Producer/Location USR is Yes
     C           P1PNST    IFEQ 'Y'                        *IF
      * Get Vendor Address    RT - STR VND Common Routines  * 
     C                     CALL 'VNDFAXR'              90  Get Vendor Addr
     C           WUGUST    PARM *BLANK    WQ0025  7        *Return code
     C           P1GLNB    PARM P1GLNB    WQ0026  80       Address Number
     C           P2LLTX    PARM P2LLTX    WQ0027 40        Pass Name
     C           WUDNTX    PARM WUDNTX    WQ0028 40        Address 1
     C           WUDOTX    PARM WUDOTX    WQ0029 40        Address 2
     C           WUDPTX    PARM WUDPTX    WQ0030 40        Address 3
     C           WUDQTX    PARM WUDQTX    WQ0031 40        City
     C           WUDRTX    PARM WUDRTX    WQ0032  3        State
     C           WUDSTX    PARM WUDSTX    WQ0033 12        Zip
     C           WUDTTX    PARM WUDTTX    WQ0034  6        Area Code
     C           WUDUTX    PARM WUDUTX    WQ0035 20        Telephone
     C           P3LSTX    PARM P3LSTX    WQ0036  6        Fax Area Code #
     C           P3LRTX    PARM P3LRTX    WQ0037 20        Fax Telephone
     C           WUNGTX    PARM WUNGTX    WQ0038  6        Fax Area Code #
     C           WUNHTX    PARM WUNHTX    WQ0039 20        Fax Telephone 2
     C           WUGNST    PARM WUGNST    WQ0040  1        Vendor 1099
     C           WUDXTX    PARM WUDXTX    WQ0041 16        Vendor Tax Id.
     C           WUE0CD    PARM WUE0CD    WQ0042  3        Country Code
     C                     PARM WUJYST    WQ0043  1        Producer/Trucke
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'VNDFAXR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Vendor Return Code Usr is Vendor Error
     C           WUGUST    IFEQ 'ERR'                      *IF
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         P2INDE           Index
     C                     MOVELP3LSTX    P2XDCD           Fax Area Code
     C                     MOVELP3LRTX    P2LNTX           Fax Phone Numbe
     C                     MOVEL*BLANK    P2AFNA           Spool File Sele
     C                     MOVEL'*JOB'    P2AFNA           Spool File Sele
     C                     MOVEL'Y'       P2PHST           Display Fax Sel
      * Convert Date to MDY.
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL##JDT     WUCZCD           Date Alpha USR
     C                     MOVEL*BLANK    WUOITX           Date From Conve
     C                     MOVELWUCZCD    WUOITX           Date From Conve
      * Cvt Date              UP - STR Miscellaneous  * 
     C                     CALL 'PKPOUPR'              90  Cvt Date
     C                     PARM WUOITX    WQ0044 10        Date From Conve
     C           WUOJTX    PARM *BLANK    WQ0045 11        Date To Convert
     C                     PARM '*CYMD'   WQ0046  8        Date From Forma
     C                     PARM '*MDY'    WQ0047  8        Date To Format
     C                     PARM '*NONE'   WQ0048  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPOUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUOJTX    WUFLCD           Code USR
     C                     MOVE WUFLCD    P2KXDT           Send Date
      * PRC Load FastFax Array US - STR User Source Functions  * 
     C                     Z-ADDP2INDE    X       30                   TEXT2
     C                     MOVELP2LLTX    QRCP,X                       TEXT2
     C                     MOVELP2LMTX    QRCO,X                       Y
     C                     MOVELP2XDCD    QFXA,X                       E ARRAY
     C                     MOVELP2LNTX    QFXN,X                       RRAY
     C                     MOVELP2GJCD    QRTG,X                        ARRAY
     C                     MOVELP2P0ST    QINT,X                       'INT'
     C                     MOVELP2AQNA    QAD1,X                       ARRAY
     C                     MOVELP2ARNA    QAD2,X                       ARRAY
     C                     MOVELP2LOTX    QCTY,X                       RRAY
     C                     MOVELP2EINA    QSTA,X                       ARRAY
     C                     MOVELP2LPTX    QZIP,X                       RAY
     C                     MOVELP2ASNA    QCNY,X                       Y ARRAY
     C                     END                             *FI
     C                     END                             *FI
      * Send fax if index is GT 0, that means no errors
      * CASE: PAR.Index is Not Zero
     C           P2INDE    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    P2AHNA           Cover Sheet Nam
     C                     MOVEL'SC'      P2AHNA           Cover Sheet Nam
      * PRC Call FastFax PGM  US - STR User Source Functions  * 
     C****************************************************************
     C           QIAPRM    PLIST
     C                     PARM           QSLCT  10        SPOOL FILE SELE
     C*                                                  *JOB *USER 'USER DATE'
     C                     PARM           QSBMT   1        PARMS SET/DISPALAY SC
     C*                                                  ERRORS 'Y' 'N' ' '
     C                     PARM           QIAPDS           DATA STRUCTURE ABOVE
     C                     PARM           QRCP             RECIPIENT ARRAY
     C                     PARM           QRCO             COMPANY ARRAY
     C                     PARM           QFXA             FAX AREA CODE ARRAY
     C                     PARM           QFXN             FAX NUMBER ARRAY
     C                     PARM           QRTG             ROUTING CODE ARRAY
     C                     PARM           QINT             'USA' 'CAN' 'INT'
     C*                                                    'OTH' 'PVT'
     C                     PARM           QAD1             RECIP ADDR1 ARRAY
     C                     PARM           QAD2             RECIP ADDR2 ARRAY
     C                     PARM           QCTY             RECIP CITY ARRAY
     C                     PARM           QSTA             RECIP STATE ARRAY
     C                     PARM           QZIP             RECIP ZIP ARRAY
     C                     PARM           QCNY             RECIP COUNTRY ARRAY
     C                     PARM           QCT1             COVER SHEET TEXT1
     C                     PARM           QCT2             COVER SHEET TEXT2
     C****************************************************************
     C                     MOVELP2AFNA    QSLCT
     C                     MOVELP2PHST    QSBMT
     C                     MOVE P2UATR    QSDR
     C                     Z-ADDP2KXDT    QSDT
     C                     Z-ADDP2SDTM    QSTM
     C                     Z-ADDP2FRNB    QPTY
     C                     MOVELP2AGNA    QCAC
     C                     MOVELP2AHNA    QCVR
     C                     MOVELP2FDNA    QFMN
     C                     Z-ADDP2FAXR    QRSL
     C                     Z-ADDP2FRMP    QFPG
     C                     Z-ADDP2TOPG    QTPG
     C                     Z-ADDP2PGLN    QPGL
     C                     Z-ADDP2PGWD    QPGW
     C                     Z-ADDP2CPII    QCPI
     C                     Z-ADDP2LPII    QLPI
     C                     MOVELP2LITX    QSVC
     C                     MOVELP2PCOF    QPRC
     C                     MOVELP2LJTX    QPRQ
     C                     MOVELP2LKTX    QQLB
     C                     MOVELP2PROF    QPRF
     C                     MOVELP2PSST    QLAN
     C*
     C                     MOVEL'FASTFAX/'QIAPGM 16
     C                     MOVE 'FFX300CL'QIAPGM
     C                     CALL QIAPGM    QIAPRM
     C                     SETON                     LR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AFNA           Spool File Sele
     C                     MOVEL*BLANK    P2PHST           Display Fax Sel
     C                     MOVEL*BLANK    P2UATR           User-defined at
     C                     Z-ADD*ZERO     P2KXDT           Send Date
     C                     Z-ADD*ZERO     P2SDTM           Send Time
     C                     Z-ADD*ZERO     P2FRNB           Send Priority
     C                     MOVEL*BLANK    P2AGNA           Cost Account Na
     C                     MOVEL*BLANK    P2AHNA           Cover Sheet Nam
     C                     MOVEL*BLANK    P2FDNA           Forms Type Str.
     C                     Z-ADD*ZERO     P2FAXR           Fax Resolution
     C                     Z-ADD*ZERO     P2FRMP           From Page
     C                     Z-ADD*ZERO     P2TOPG           To Page
     C                     Z-ADD*ZERO     P2PGLN           Page Length
     C                     Z-ADD*ZERO     P2PGWD           Page Width
     C                     Z-ADD*ZERO     P2CPII           CPI
     C                     Z-ADD*ZERO     P2LPII           LPI
     C                     MOVEL*BLANK    P2LITX           Save Copy of Fa
     C                     MOVEL*BLANK    P2PCOF           Print Copy of F
     C                     MOVEL*BLANK    P2LJTX           Printer Name or
     C                     MOVEL*BLANK    P2LKTX           Outq Library
     C                     MOVEL*BLANK    P2PROF           Print on Form
     C                     MOVEL*BLANK    P2PSST           Landscape
     C                     MOVEL*BLANK    P2LLTX           Fax Recipient
     C                     MOVEL*BLANK    P2LMTX           Company Recipie
     C                     MOVEL*BLANK    P2XDCD           Fax Area Code
     C                     MOVEL*BLANK    P2LNTX           Fax Phone Numbe
     C                     MOVEL*BLANK    P2GJCD           Routing Code
     C                     MOVEL*BLANK    P2P0ST           International C
     C                     MOVEL*BLANK    P2AQNA           Fast Fax Addres
     C                     MOVEL*BLANK    P2ARNA           Fast Fax Addres
     C                     MOVEL*BLANK    P2LOTX           City for Fax
     C                     MOVEL*BLANK    P2EINA           Fast Fax State
     C                     MOVEL*BLANK    P2LPTX           Zip Code for Fa
     C                     MOVEL*BLANK    P2ASNA           Country Descrip
     C                     Z-ADD*ZERO     P2INDE           Index
     C                     MOVEL*BLANK    P3LSTX           Fax Area Code #
     C                     MOVEL*BLANK    P3LRTX           Fax Telephone
     C                     MOVEL*BLANK    P3NVTX           Fax Attn 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Vendor Return Code Usr
     C                     MOVEL*BLANK    WUGUST  7
      * Define work field Address 1
     C                     MOVEL*BLANK    WUDNTX 40
      * Define work field Address 2
     C                     MOVEL*BLANK    WUDOTX 40
      * Define work field Address 3
     C                     MOVEL*BLANK    WUDPTX 40
      * Define work field City
     C                     MOVEL*BLANK    WUDQTX 40
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field Zip
     C                     MOVEL*BLANK    WUDSTX 12
      * Define work field Area Code
     C                     MOVEL*BLANK    WUDTTX  6
      * Define work field Telephone
     C                     MOVEL*BLANK    WUDUTX 20
      * Define work field Fax Area Code # 2
     C                     MOVEL*BLANK    WUNGTX  6
      * Define work field Fax Telephone 2
     C                     MOVEL*BLANK    WUNHTX 20
      * Define work field Vendor 1099
     C                     MOVEL*BLANK    WUGNST  1
      * Define work field Vendor Tax Id.
     C                     MOVEL*BLANK    WUDXTX 16
      * Define work field Country Code
     C                     MOVEL*BLANK    WUE0CD  3
      * Define work field Producer/Trucker Sts Usr
     C                     MOVEL*BLANK    WUJYST  1
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Date From Convert USR
     C                     MOVEL*BLANK    WUOITX 10
      * Define work field Date To Convert USR
     C                     MOVEL*BLANK    WUOJTX 11
      * Define work field Code USR
     C                     MOVEL*BLANK    WUFLCD  6
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
