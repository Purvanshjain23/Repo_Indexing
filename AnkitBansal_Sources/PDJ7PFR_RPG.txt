     H/TITLE PRT Pre-Invoice Except PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/30/18  Time  : 16:00:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMBFCPM2IF  E           K        DISK
      * RTV : Order Header TRG          Orders not C/X/H
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPMJIF  E           K        DISK
      * RSQ : Order Header TRG          Co/ShipTo/PO/SSD/Ord <>X
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDJ7PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Pre-Invoice Except PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  32  6   @CN    25
     I@BFCPHR
      * Order Header TRG          Co/ShipTo/PO/SSD/Ord <>X
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Actual Shipped Date
     I                                    P   7  100P1GNDT
      * I :  Load ID
     I                                    P  11  140P1RMNB
      * I :  Billing Activity Type
     I                                       15  15 P1OBST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  USR Date Shipped
     I                                    P   1   40P2FADT
      * N :  Item Description Text
     I                                        5  54 P2BDTX
      * N :  Update Exception Status
     I                                       55  55 P2F6ST
      * N :  Print Pre-Inv/Exception
     I                                       56  56 P2PPIX
      * N :  Departure Sts USR
     I                                       57  57 P2GESX
      * N :  System Value Numeric
     I                                    P  58  655P2M8NB
      * N :  Item Code USR
     I                                    P  66  690P2B6C7
      * I :  Process Cust Types Usr
     I                                       70  71 P2YDSX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Manual Prc Err Sts USR
     I                                        1   1 P3HOSX
      * N :  Average Ship Wgt Err USR
     I                                        2   2 P3Q6SX
      * N :  Item Code
     I                                    P   3   60P3HGCD
      * N :  InterCo Price Err USR
     I                                        7   7 P3X6SX
      * N :  Record Found USR
     I                                        8   8 P3WXST
      * N :  Order Status
     I                                        9   9 P3UCST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Status - Y or N
     I                                        1   1 P4B8ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Rtv Truck Departure'
      * Hour 1 USR
     I                                    P   1   20ZA0001
      * Message data for 'RTV BOL Completed'
      * Hour 1 USR
     I                                    P   1   20ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P1RMNB    PARM           WP0004  70       Load ID
     C           P1OBST    PARM           WP0005  1        Billing Activit
     C           P2YDSX    PARM           WP0006  2        Process Cust Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Pre-Invoice Except PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Pre-Invoice Except PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@BFCPDU                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set W0AL1P         US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CAPTX           Company Name
     C                     Z-ADD*ZERO     $CRMNB           Load ID
     C                     Z-ADD*ZERO     $CC4NB           Order Number
     C                     MOVEL*BLANK    $CE2TX           USR Work Field
     C                     Z-ADD*ZERO     $CGNDT           Actual Shipped
     C                     MOVEL*BLANK    $CNCNA           USR Desc. 10
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
     C                     Z-ADDBEC4NB    $DC4NB           Order Number
     C                     MOVELBEJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDBEBKC7    $DBKC7           Ship To Custome
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     MOVEL*BLANK    $DBCTX           One Invoice Per
     C                     Z-ADDBEGNDT    $DGNDT           Actual Shipped
     C                     MOVELBEU1ST    $DU1ST           Price Status
     C                     MOVELBEU0ST    $DU0ST           Price Audit
     C                     MOVEL*BLANK    $DBCCD           Salesperson Cod
     C                     Z-ADDBEANC7    $DANC7           A/R Customer Nu
     C                     MOVELBEHMNA    $DHMNA           Ship To Address
     C                     MOVELBEHONA    $DHONA           Ship To Address
     C                     MOVELBEHPNA    $DHPNA           Ship To Address
     C                     MOVELBEHNNA    $DHNNA           Ship To City
     C                     MOVELBEDBCD    $DDBCD           Ship To State C
     C                     MOVELBECKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $DB0C7           Bill to Custome
     C                     MOVELBEAETX    $DAETX           Bill to Name
     C                     MOVELBEB1NA    $DB1NA           Bill to Address
     C                     MOVELBEB3NA    $DB3NA           Bill to Address
     C                     MOVELBEB4NA    $DB4NA           Bill to Address
     C                     MOVELBEB2NA    $DB2NA           Bill to City
     C                     MOVELBEBHCD    $DBHCD           Bill to State C
     C                     MOVELBEC8TX    $DC8TX           Bill to Zip/Pos
     C                     Z-ADDBEACDT    $DACDT           Cancel Date
     C                     MOVELBEAQCD    $DAQCD           Terms Code
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     MOVELBEGTST    $DGTST           Comment Print A
     C                     MOVELBEGVST    $DGVST           Comment Print I
     C                     MOVELBEGUST    $DGUST           Comment Print P
     C                     MOVELBEQFST    $DQFST           Comment Print S
     C                     MOVELBECQCD    $DCQCD           Reason Code
     C                     MOVELBEGJST    $DGJST           Order in Use
     C                     MOVELBEGWST    $DGWST           Header Status
     C                     MOVELBEJPCD    $DJPCD           Event Code
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     Z-ADD*ZERO     $DJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     $DKIDT           Truck Departure
     C                     Z-ADD*ZERO     $DASTM           Truck Departure
     C                     MOVEL*BLANK    $DPKST           Load Status
     C                     MOVEL*BLANK    $DFLST           USR Process sta
     C                     MOVEL*BLANK    $DBDTX           Item Descriptio
     C                     MOVEL*BLANK    $DKWTX           Error Reason De
     C                     MOVEL*BLANK    $DTJST           USR Display 2
     C                     MOVEL*BLANK    $DKXTX           Error Reason De
     C                     MOVEL*BLANK    $DASTS           USR Display 3
     C                     MOVEL*BLANK    $DKYTX           Error Reason De
     C                     MOVEL*BLANK    $DBSTS           USR Display 4
     C                     MOVEL*BLANK    $DKZTX           Error Reason De
     C                     MOVEL*BLANK    $DGFSX           USR Display 5
     C                     MOVEL*BLANK    $DTITX           Error Reason De
     C                     MOVEL*BLANK    $DHPSX           USR Display 6
     C                     MOVEL*BLANK    $DU1TX           Error Reason De
     C                     Z-ADD*ZERO     $DKWNX           Price 6,4 USR
     C                     MOVEL*BLANK    $DIDSX           USR Display 7
     C                     MOVEL*BLANK    $DWYTX           Error Reason De
     C                     Z-ADD*ZERO     $DM8NX           Price 6,4 2 USR
     C                     MOVEL*BLANK    $DQ5SX           USR Display 8
     C                     MOVEL*BLANK    $DDXT1           Error Reason De
     C                     MOVEL*BLANK    $DX7SX           USR Display 9
     C                     MOVEL*BLANK    $DHGT1           Error Reason De
     C                     MOVEL*BLANK    $DDXSX           Display Flag 1
     C                     MOVEL*BLANK    $DHETX           Explaination Te
     C                     MOVEL*BLANK    $DZ2SX           USR Display 11
     C                     MOVEL*BLANK    $DIRT1           Explaination Te
     C                     MOVEL*BLANK    $DA6TX           USR Display 12
     C                     MOVEL*BLANK    $DJWT1           Explaination Te
     C                     MOVEL*BLANK    $D               USR Display 13
     C                     MOVEL*BLANK    $DJ9T1           Explaination Te
     C                     MOVEL*BLANK    $DKAT1           Explaination Te
     C                     MOVEL*BLANK    $DBASC           USR Display 15
     C                     MOVEL*BLANK    $DDHU1           Explaination Te
     C                     MOVEL*BLANK    $DBCSC           USR Display 16
     C                     MOVEL*BLANK    $DDJU1           Explaination Te
     C                     MOVEL*BLANK    $DKUST           USR Display Mod
     C                     MOVELBEGXST    $DGXST           Header Status L
     C                     MOVELBEGYST    $DGYST           Order Type Prin
     C                     Z-ADDBEAODT    $DAODT           Scheduled Ship
     C                     MOVELBEAIVN    $DAIVN           User Original E
     C                     Z-ADDBECXDT    $DCXDT           Date of Origina
     C                     MOVELBEXIST    $DXIST           Credit Hold
     C                     MOVELBEXJST    $DXJST           Production Hold
     C                     MOVELBEXKST    $DXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEE8CD    $DE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $DR1NB           Rated Freight
     C                     MOVELBEPJST    $DPJST           LTL Flag
     C                     MOVELBEQ2CD    $DQ2CD           Shipping Method
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     MOVELBEVEST    $DVEST           Palletize
     C                     MOVELBEVFST    $DVFST           Shrink Wrap
     C                     MOVELBEVGST    $DVGST           Slip Sheet
     C                     MOVELBERPCD    $DRPCD           Age Code
     C                     Z-ADDBERNNB    $DRNNB           Reefer Temperat
     C                     MOVELBEVDST    $DVDST           Load Type
     C                     Z-ADDBEATIN    $DATIN           Attach to Invoi
     C                     MOVELBEU4ST    $DU4ST           Load Plan Order
     C                     MOVELBEU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $DRSRN           Resell Referenc
     C                     MOVELBEMHNA    $DMHNA           Special Comment
     C                     MOVELBEMINA    $DMINA           Special Comment
     C                     MOVELBEWBST    $DWBST           Affect Auto Acc
     C                     MOVELBER4CD    $DR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $DBFCD           Manager Level C
     C                     MOVELBEQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $DT3NB           Attach to Order
     C                     MOVELBESICD    $DSICD           Reason for Pric
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $DAWDT           Invoice Date
     C                     MOVELBEXUST    $DXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $DVRVA           A/R order Value
     C                     MOVELBEOBST    $DOBST           Billing Activit
     C                     MOVELBEBCST    $DBCST           Block Order Fla
     C                     MOVELBEBDST    $DBDST           Order Certifica
     C                     Z-ADDBEB7VL    $DB7VL           Invoice Order V
     C                     MOVELBEGASX    $DGASX           Process Sts for
     C                     MOVELBEGBSX    $DGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $DGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $DFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $DFOSX           Email Cust On O
     C                     MOVELBEFPSX    $DFPSX           Order Emailed
     C                     MOVELBEFQSX    $DFQSX           Export Docs Go
     C                     MOVELBEFRSX    $DFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $DFSSX           Broker Order St
     C                     MOVELBEFTSX    $DFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $DFUSX           Order Requires
     C                     MOVELBEFVSX    $DFVSX           OH Load Plan Re
     C                     MOVELBEFWSX    $DFWSX           Export USDA App
     C                     MOVELBEFXSX    $DFXSX           HPB Ship to War
     C                     MOVELBEFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $DNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    $DNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    $DNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    $DNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    $DNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $DBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $DBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    $DBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    $DBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $DC0C7           Claim Number
     C                     MOVELBEUVST    $DUVST           EDI Status 1
     C                     MOVELBEUWST    $DUWST           EDI Status 2
     C                     MOVELBEUXST    $DUXST           EDI Status 3
     C                     Z-ADDBEAATM    $DAATM           Job Time
     C                     MOVELBEAYNA    $DAYNA           User Id
     C                     MOVELBEA0NA    $DA0NA           Job Name
     C                     Z-ADDBEAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * CASE: DB1.Order Type Print Status is yes
     C           BEGYST    IFEQ 'Y'                        *IF
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
     C                     EXSR SICHRC
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BFCPDU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * NOTE:  IF CHANGES ARE MADE TO SELECTION CRITERIA PROCESSING, ALSO
      *        LOOK AT PRE INVOICE REGISTER!!!
      * NOTE:  THIS PROGRAM ONLY RUNS FOR INVOICES.  THE OTHER CODE WAS
      *        LEFT IN FOR DOCUMENTATION PURPOSES.
      * 04/26/18 DN R12926-Change AFR parm from both to input only & use
      * PRT Invc Excpt Sel V 2 XF - Order Header TRG  * 
     C                     CALL 'PDKNXFR'              90  PRT Invc Excpt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0001  30       Company Number
     C                     PARM BEC4NB    WQ0002  70       Order Number
     C                     PARM BEJNCD    WQ0003  2        Order Type - Sa
     C                     PARM BEANC7    WQ0004  70       A/R Customer Nu
     C                     PARM BEBKC7    WQ0005  70       Ship To Custome
     C                     PARM BEBCNA    WQ0006 15        Customer Purcha
     C                     PARM BEA0DT    WQ0007  70       Order Date
     C                     PARM BEGNDT    WQ0008  70       Actual Shipped
     C                     PARM BEGWST    WQ0009  1        Header Status
     C                     PARM BEGXST    WQ0010  1        Header Status L
     C                     PARM BEAODT    WQ0011  70       Scheduled Ship
     C                     PARM BERMNB    WQ0012  70       Load ID
     C                     PARM BETBNB    WQ0013  52       Absorbed Freigh
     C                     PARM BEU0ST    WQ0014  1        Price Audit
     C                     PARM BEU1ST    WQ0015  1        Price Status
     C                     PARM BEQ2CD    WQ0016  2        Shipping Method
     C                     PARM BER4CD    WQ0017  3        Sales Route Cod
     C                     PARM BEJPCD    WQ0018  2        Event Code
     C                     PARM BEOBST    WQ0019  1        Billing Activit
     C                     PARM P1C4NB    WQ0020  70       USR Order Numbe
     C                     PARM P1RMNB    WQ0021  70       Load ID USR
     C                     PARM P1OBST    WQ0022  1        USR Billing Act
     C                     PARM P1GNDT    WQ0023  70       USR Actual Ship
     C           P2F6ST    PARM P2F6ST    WQ0024  1        Update Exceptio
     C           W0RSL     PARM W0RSL     WQ0025  1        *Record selecte
     C           P2PPIX    PARM *BLANK    WQ0026  1        Print Pre-Inv/E
     C           P2GESX    PARM *BLANK    WQ0027  1        Departure Sts U
     C           P2M8NB    PARM P2M8NB    WQ0028 155       System Value Nu
     C           P3HOSX    PARM P3HOSX    WQ0029  1        Manual Prc Err
     C           YL0007    PARM YL0007    WQ0030 114       Projected Marke
     C           P3Q6SX    PARM P3Q6SX    WQ0031  1        Average Ship Wg
     C           P3X6SX    PARM P3X6SX    WQ0032  1        InterCo Price E
     C           P3WXST    PARM P3WXST    WQ0033  1        Record Found US
     C           P3UCST    PARM P3UCST    WQ0034  1        Order Status
     C           YL0022    PARM YL0022    WQ0035  1        GTIN Error Sts
     C           YL0024    PARM YL0024    WQ0036  70       GTIN Error Item
     C           P2B6C7    PARM *ZERO     WQ0037  70       Item Code USR
     C           P3HGCD    PARM *ZERO     WQ0038  70       Item Code
     C           YL0004    PARM YL0004    WQ0039  3        Default Commod
     C           YL0014    PARM YL0014    WQ0040 114       Market Overage
     C           YL0005    PARM YL0005    WQ0041  7        Commodity Price
     C           YL0003    PARM *ZERO     WQ0042 114       Price Overage O
     C                     PARM P2YDSX    WQ0043  2        Process Cust Ty
     C           P4B8ST    PARM P4B8ST    WQ0044  1        Status - Y or N
     C           YL0020    PARM YL0020    WQ0045  1        D-EDI INV PROC
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: PAR.Print Pre-Inv/Exception is Print on Exception
     C           P2PPIX    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Pre-Invoice Except PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Pre-Invoice Except PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
     C                     Z-ADDP1RMNB    $CRMNB           Load ID
     C                     Z-ADDP1C4NB    $CC4NB           Order Number
     C                     Z-ADDP1GNDT    $CGNDT           Actual Shipped
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : PAR.Order Number is Equal to zeros
      *   |- c2    : PAR.Load ID is Blank
      *   |- c3    : PAR.Actual Shipped Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFEQ *ZERO                      *IF
     C           P1RMNB    IFEQ *ZERO                      *IF
     C           P1GNDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    $CNCNA           USR Desc. 10
     C                     MOVEL'*ALL'    $CNCNA           USR Desc. 10
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
      * Billing type - work field
      * CASE: PAR.Billing Activity Type is Invoice
     C           P1OBST    IFEQ '1'                        *IF
     C                     MOVEL@CN,009   $CE2TX           USR Work Field
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P1OBST    IFEQ '2'                        *IF
     C                     MOVEL@CN,010   $CE2TX           USR Work Field
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P1OBST    IFEQ '3'                        *IF
     C                     MOVEL@CN,010   $CE2TX           USR Work Field
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,010   $CE2TX           USR Work Field
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $CGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCGNDT
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of PRT Pre-Invoice Except PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Detail line. of PRT Pre-Invoice Except PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL*BLANK    $DBCTX           One Invoice Per
      * One Invoice Per PO DRV
      * Rtv One Invoice /PO   RT - Customer EXT  * 
     C                     EXSR SDRVGN
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SERVGN
      * 05/23/16 RMC E4119 remove live with tpm check
      * Rtv Sts/BOLDt/DptDtTm RT - Load Header  * 
     C                     EXSR SFRVGN
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     MOVEL'N'       WUTJST           USR Display 2
     C                     MOVEL'N'       WUASTS           USR Display 3
     C                     MOVEL'N'       WUBSTS           USR Display 4
     C                     MOVEL'N'       WUGFSX           USR Display 5
     C                     MOVEL'N'       WUHPSX           USR Display 6
     C                     MOVEL'N'       WUIDSX           USR Display 7
     C                     MOVEL'N'       WUQ5SX           USR Display 8
     C                     MOVEL'N'       WUX7SX           USR Display 9
     C                     MOVEL'N'       WUDXSX           Display Flag 1
     C                     MOVEL'N'       WUZ2SX           USR Display 11
     C                     MOVEL'N'       WUA6TX           USR Display 12
     C                     MOVEL'N'       WU               USR Display 13
     C                     MOVEL'N'       WUBASC           USR Display 15
     C                     MOVEL'N'       WUBCSC           USR Display 16
      * Reason 1:  Order Unpriced
      * CASE: DB1.Price Status is Unpriced
     C           BEU1ST    IFEQ 'U'                        *IF
     C                     MOVEL*BLANK    $DKWTX           Error Reason De
     C                     MOVEL@CN,011   $DKWTX           Error Reason De
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     END                             *FI
      * Reason 2:  Order Marked for Price Audit
      * CASE: DB1.Price Audit is Needs Price Audit
     C           BEU0ST    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    $DKXTX           Error Reason De
     C                     MOVEL@CN,012   $DKXTX           Error Reason De
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     END                             *FI
      * Reason 3:  Load status not= "S"
      * CASE: CUR.Load Status is Not Shipped
     C           $DPKST    IFEQ 'C'                        *IF
     C           $DPKST    OREQ 'E'
     C           $DPKST    OREQ 'I'
     C           $DPKST    OREQ 'L'
     C           $DPKST    OREQ 'U'
     C                     MOVEL*BLANK    $DKYTX           Error Reason De
     C                     MOVEL@CN,013   $DKYTX           Error Reason De
     C                     MOVEL'Y'       WUASTS           USR Display 3
     C                     END                             *FI
      * Reason 4:  Pricing extension error
      * CASE: PAR.Update Exception Status is yes
     C           P2F6ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    $DKZTX           Error Reason De
     C                     MOVEL@CN,014   $DKZTX           Error Reason De
     C                     MOVEL'Y'       WUBSTS           USR Display 4
     C                     END                             *FI
      * Reason 5:  Departure status
      * CASE:
      *  - c1 OR c3
      *   |- c1    : PAR.Departure Sts USR is No Dalay
      *   |- c3    : PAR.Departure Sts USR is BOL Not Completed
      *   '-
     C           P2GESX    IFEQ 'D'                        *IF
     C           P2GESX    OREQ 'B'
     C           P2GESX    OREQ 'N'
     C           P2GESX    OREQ 'C'                        *OR
      * CUR.Error Reason Descript 5 = Condition name of PAR.Departure Sts
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1560199   Y2LSNO  70       List number
     C                     PARM P2GESX    W0INVL 25        Departure Sts U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DTITX    PARM           W0CNNM 25        Error Reason De
      *
     C                     MOVEL'Y'       WUGFSX           USR Display 5
     C                     ELSE
      * CASE: PAR.Departure Sts USR is Truck departed < ?hrs ago
     C           P2GESX    IFEQ 'T'                        *IF
     C                     Z-ADDP2M8NB    WUIJNX           Hour 1 USR
      * Setup message data for message
     C                     Z-ADDWUIJNX    ZA0001           Hour 1 USR
      * Retrieve message Rtv Truck Departure
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2846' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           $DTITX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL'Y'       WUGFSX           USR Display 5
     C                     ELSE
      * CASE: PAR.Departure Sts USR is BOL Completed <?Min ago
     C           P2GESX    IFEQ 'P'                        *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SGRVGN
     C                     Z-ADDYL0001    WUIJNX           Hour 1 USR
      * Setup message data for message
     C                     Z-ADDWUIJNX    ZA0002           Hour 1 USR
      * Retrieve message RTV BOL Completed
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3833' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           $DTITX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL'Y'       WUGFSX           USR Display 5
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reason 6 & 7:  Manual Price out of range
      * CASE: PAR.Manual Prc Err Sts USR is yes
     C           P3HOSX    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0002           Item Code Txt
     C                     MOVELP2B6C7    YL0002           Item Code Txt
      * Line 6
     C                     Z-ADD1         ZQ      50
     C           @CN,016   CAT  YL0002:ZQ $DU1TX    P      Error Reason De
     C                     Z-ADDYL0003    $DKWNX           Price 6,4 USR
      * Line 7
     C                     Z-ADD0         ZQ      50
     C           YL0004    CAT  YL0005:ZQ $DWYTX    P      Error Reason De
     C                     Z-ADD*ZERO     ZQ      50
     C           $DWYTX    CAT  '=':ZQ    $DWYTX    P      Error Reason De
     C                     Z-ADDYL0007    YL0006           Price USR
     C                     MOVEL*BLANK    YL0008           Price Alpha USR
     C                     MOVELYL0006    YL0008           Price Alpha USR
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00006
     C           ZQ        ORGT 00006
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0008:ZQ YL0009    P  90  Text 1 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00006
     C           ZQ        ORGT 00006
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0008:ZQ YL0010    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0009    CAT  '.':ZQ    YL0008    P      Price Alpha USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0008    CAT  YL0010:ZQ YL0008    P      Price Alpha USR
     C                     Z-ADD*ZERO     ZQ      50
     C           $DWYTX    CAT  YL0008:ZQ $DWYTX    P      Error Reason De
      * Absorbed Freight Rate
      * 04/26/18 DN R12926-Use Absorbed Freight Rate from OH instead of C
     C           BETBNB    DIV  100       YL0011           Price 6,4 USR
     C                     MOVEL*BLANK    YL0012           Price 7 Alpha U
     C                     MOVELYL0011    YL0012           Price 7 Alpha U
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0012:ZQ YL0013    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0012:ZQ YL0010    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0013    CAT  '.':ZQ    YL0012    P      Price 7 Alpha U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0012    CAT  YL0010:ZQ YL0012    P      Price 7 Alpha U
     C                     Z-ADD0         ZQ      50
     C           $DWYTX    CAT  '+F=':ZQ  $DWYTX    P      Error Reason De
     C                     Z-ADD*ZERO     ZQ      50
     C           $DWYTX    CAT  YL0012:ZQ $DWYTX    P      Error Reason De
      * Overage
     C                     Z-ADDYL0014    YL0011           Price 6,4 USR
     C                     MOVEL*BLANK    YL0012           Price 7 Alpha U
     C                     MOVELYL0011    YL0012           Price 7 Alpha U
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0012:ZQ YL0013    P  90  Text 2 Length U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0012:ZQ YL0010    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0013    CAT  '.':ZQ    YL0012    P      Price 7 Alpha U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0012    CAT  YL0010:ZQ YL0012    P      Price 7 Alpha U
     C                     Z-ADD0         ZQ      50
     C           $DWYTX    CAT  '+O=':ZQ  $DWYTX    P      Error Reason De
     C                     Z-ADD*ZERO     ZQ      50
     C           $DWYTX    CAT  YL0012:ZQ $DWYTX    P      Error Reason De
     C                     Z-ADD*ZERO     ZQ      50
     C           $DWYTX    CAT  '=>':ZQ   $DWYTX    P      Error Reason De
      * Price
      * 04/26/18 DN R12926-Use Absorbed Freight Rate from OH instead of C
      * Comparison Price
      * CUR.Price 6,4 2 USR =
      *    *COMPUTE (x1 + (x2 / x3) + x4)
      * x1    : LCL.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : DB1.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
      * +     : PGM.*Synon (15,5) work field
      * x4    : LCL.Market Overage
     C           BETBNB    DIV  100       W0WB02           *Synon (15,5) w
     C           YL0007    ADD  W0WB02    W0WB01           *Synon (15,5) w
     C           W0WB01    ADD  YL0014    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    $DM8NX           Price 6,4 2 USR
     C                     MOVEL'Y'       WUHPSX           USR Display 6
     C                     MOVEL'Y'       WUIDSX           USR Display 7
     C                     END                             *FI
      * Reason 8:  Average Shipped Weight not in range
      * CASE: PAR.Average Ship Wgt Err USR is yes
     C           P3Q6SX    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0002           Item Code Txt
     C                     MOVELP3HGCD    YL0002           Item Code Txt
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  @CN,017:ZQ$DDXT1    P      Error Reason De
     C                     MOVEL'Y'       WUQ5SX           USR Display 8
     C                     END                             *FI
      * Reason 9:  Inter-Company Price Error  IC Invoice Price = 0
      * CASE: PAR.InterCo Price Err USR is Yes
     C           P3X6SX    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0002           Item Code Txt
     C                     MOVELP3HGCD    YL0002           Item Code Txt
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0002    CAT  @CN,018:ZQ$DHGT1    P      Error Reason De
     C                     MOVEL'Y'       WUX7SX           USR Display 9
     C                     END                             *FI
      * Reason 10: Revenue week is closed for the Actual Ship Date    LJB
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Status - Y or N is yes
      *   |- c2    : DB1.Order Type - Sales is Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4B8ST    IFEQ 'Y'                        *IF
     C           BEJNCD    IFEQ 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    $DHETX           Explaination Te
     C                     MOVEL@CN,019   $DHETX           Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DHETX    CAT  @CN,020:ZQ$DHETX    P      Explaination Te
     C                     MOVEL'Y'       WUDXSX           Display Flag 1
     C                     END                             *FI
      * Reason 11: PFS Ship order detail is unprocessed    RMC 7/31/06
      * CASE: PAR.Record Found USR is Record Found
     C           P3WXST    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,021   CAT  @CN,022:ZQ$DIRT1    P      Explaination Te
     C                     MOVEL'Y'       WUZ2SX           USR Display 11
     C                     END                             *FI
      * Reason 12: Order Status for One-Invoice Per PO. 12/05/06 PKD PK00
      * CASE: PAR.Order Status is Open
     C           P3UCST    IFEQ 'O'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,023   CAT  BEBCNA:ZQ $DJWT1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DJWT1    CAT  @CN,024:ZQ$DJWT1    P      Explaination Te
     C                     MOVEL'Y'       WUA6TX           USR Display 12
     C                     END                             *FI
     C                     MOVEL*BLANK    $DJ9T1           Explaination Te
     C                     MOVEL*BLANK    $DKAT1           Explaination Te
      * Reason 13: Oth Ords for this Combo PO has errors 4/26/07 SLM PK00
      * CASE: combo messages
      *  - c1 OR c3
      *   |- c1    : PAR.Order Status is Cmb PO has Errors
      *   |- c3    : CUR.One Invoice Per PO DRV is Yes
      *   '-
     C           P3UCST    IFEQ 'E'                        *IF
     C           $DBCTX    OREQ 'Y'                        *OR
      * RTV Po and its Orders RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * CASE: LCL.Order Number 1 ALPHA USR GT WRK.BLANK 1               U
     C           YL0015    IFGT WUJ1TX                     *IF
     C                     Z-ADD1         ZQ      50
     C           'PO #'    CAT  BEBCNA:ZQ $DJ9T1    P      Explaination Te
      * CASE: PAR.Order Status is Cmb PO has Errors
     C           P3UCST    IFEQ 'E'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $DJ9T1    CAT  @CN,025:ZQ$DJ9T1    P      Explaination Te
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           $DJ9T1    CAT  @CN,026:ZQ$DJ9T1    P      Explaination Te
     C                     END                             *FI
     C                     MOVEL'Y'       WU               USR Display 13
     C                     Z-ADD1         ZQ      50
     C           @CN,027   CAT  YL0015:ZQ $DKAT1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DKAT1    CAT  YL0016:ZQ $DKAT1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DKAT1    CAT  YL0017:ZQ $DKAT1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DKAT1    CAT  YL0018:ZQ $DKAT1    P      Explaination Te
      * CASE: LCL.More Explanation USR is Yes
     C           YL0019    IFEQ 'Y'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $DKAT1    CAT  '+':ZQ    $DKAT1    P      Explaination Te
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reason 15: EDI PO Ack-855 not sent yet for customer that requires
      * CASE: LCL.D-EDI INV PROC FLAG is Not Yes
     C           YL0020    IFEQ 'N'                        *IF
     C           YL0020    OREQ *BLANK
     C                     MOVEL*BLANK    $DDHU1           Explaination Te
     C                     MOVEL@CN,028   $DDHU1           Explaination Te
      * CASE: LCL.D-EDI INV PROC FLAG is *No
     C           YL0020    IFEQ 'N'                        *IF
     C                     MOVEL@CN,029   YL0021           Text 10A USR
     C                     ELSE
      * CASE: LCL.D-EDI INV PROC FLAG is Not Processed
     C           YL0020    IFEQ *BLANK                     *IF
     C                     MOVEL@CN,030   YL0021           Text 10A USR
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         ZQ      50
     C           $DDHU1    CAT  YL0021:ZQ $DDHU1    P      Explaination Te
     C                     MOVEL'Y'       WUBASC           USR Display 15
     C                     END                             *FI
      * Reason 16: GTIN Error
      * CASE: LCL.GTIN Error Sts USR is Error
     C           YL0022    IFEQ 'E'                        *IF
     C                     MOVEL*BLANK    $DDJU1           Explaination Te
     C                     MOVEL@CN,031   $DDJU1           Explaination Te
     C                     MOVEL*BLANK    YL0023           Item Code DRV
      * Item Code DRV
     C                     Z-ADDYL0024    YL0025           Number 5,0
     C                     MOVELYL0025    YL0026           Text USR 5
     C                     MOVEL*BLANK    YL0023           Item Code DRV
     C                     MOVELYL0026    YL0023           Item Code DRV
     C                     MOVELYL0023    YL0027           Item Code 5A
     C                     Z-ADD1         ZQ      50
     C           $DDJU1    CAT  YL0027:ZQ $DDJU1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DDJU1    CAT  'GTIN':ZQ $DDJU1    P      Explaination Te
     C                     Z-ADD1         ZQ      50
     C           $DDJU1    CAT  @CN,032:ZQ$DDJU1    P      Explaination Te
     C                     MOVEL'Y'       WUBCSC           USR Display 16
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $DGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDGNDT
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  $DJ7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDJ7DT
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  $DKIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKIDT
     C                     MOVEL'0'       *IN79
     C           WUW0NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUTJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUASTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUBSTS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           WUGFSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WUHPSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           WUIDSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           WUQ5SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           WUX7SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
     C                     MOVEL'0'       *IN69
     C           WUDXSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN69
     C                     END                             *FI
     C                     MOVEL'0'       *IN68
     C           WUZ2SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN68
     C                     END                             *FI
     C                     MOVEL'0'       *IN67
     C           WUA6TX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN67
     C                     END                             *FI
     C                     MOVEL'0'       *IN66
     C           WU        IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN66
     C                     END                             *FI
     C                     MOVEL'0'       *IN65
     C           WUEYST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN65
     C                     END                             *FI
     C                     MOVEL'0'       *IN64
     C           WUBASC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN64
     C                     END                             *FI
     C                     MOVEL'0'       *IN63
     C           WUBCSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN63
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Pre-Invoice Except PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  8         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Pre-Invoice Except PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Pre-Invoice Except PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD17        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Billing type   - First part of title
      * CASE: PAR.Billing Activity Type is Invoice
     C           P1OBST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    $BHPT1           Description Usr
     C                     MOVEL@CN,001   $BHPT1           Description Usr
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Credit Memo
     C           P1OBST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    $BHPT1           Description Usr
     C                     MOVEL@CN,002   $BHPT1           Description Usr
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Debit Memo
     C           P1OBST    IFEQ '3'                        *IF
     C                     MOVEL*BLANK    $BHPT1           Description Usr
     C                     MOVEL@CN,003   $BHPT1           Description Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BHPT1           Description Usr
     C                     MOVEL@CN,004   $BHPT1           Description Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Last part of title
      * CASE: PAR.Process Cust Types Usr is Inter-Co Customer's
     C           P2YDSX    IFEQ 'IC'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,005:ZQ$BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is 3rd Party Customer(s)
     C           P2YDSX    IFEQ 'TP'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,006:ZQ$BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is All Customers
     C           P2YDSX    IFEQ 'BT'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,007:ZQ$BHPT1    P      Description Usr
     C                     ELSE
      * CASE: PAR.Process Cust Types Usr is Selection by Order/Load
     C           P2YDSX    IFEQ 'OR'                       *IF
     C                     Z-ADD1         ZQ      50
     C           $BHPT1    CAT  @CN,008:ZQ$BHPT1    P      Description Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CAPTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv One Invoice /PO   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       $DBCTX           One Invoice Per
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEHUSX    $DBCTX           One Invoice Per
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL$DR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSE     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DBCCD           Salesperson Cod
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    $DBCCD           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Sts/BOLDt/DptDtTm RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DPKST           Load Status
     C                     Z-ADD*ZERO     $DJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     $DKIDT           Truck Departure
     C                     Z-ADD*ZERO     $DASTM           Truck Departure
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    $DPKST           Load Status
     C                     Z-ADDFJJ7DT    $DJ7DT           BOL Complete Da
     C                     Z-ADDFJKIDT    $DKIDT           Truck Departure
     C                     Z-ADDFJASTM    $DASTM           Truck Departure
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD$DAIC3    KMAIC3           Company Number
     C                     MOVEL@CN,015   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSG     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    YL0001           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Po and its Orders RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0015           Order Number 1
     C                     MOVEL*BLANK    YL0016           Order Number 2
     C                     MOVEL*BLANKS   YL0017           Order Number 3
     C                     MOVEL*BLANKS   YL0018           Order Number 4
     C                     MOVEL*BLANKS   YL0019           More Explanatio
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WABKC7    WQSH02           Ship To Custome
     C           *LIKE     DEFN WABCNA    WQSH03           Customer Purcha
     C           *LIKE     DEFN WAAODT    WQSH04           Scheduled Ship
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Ship To Custome
     C                     KFLD           WQSH03           Customer Purcha
     C                     KFLD           WQSH04           Scheduled Ship
      * Setup key
     C                     Z-ADDBEAIC3    WQSH01           Company Number
     C                     Z-ADDBEBKC7    WQSH02           Ship To Custome
     C                     MOVELBEBCNA    WQSH03           Customer Purcha
     C                     Z-ADDBEAODT    WQSH04           Scheduled Ship
      * Establish starting position
     C           KRSSH     SETLL@BFCPHR                    *
     C           KRSSH     READE@BFCPHR                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           BEC4NB    IFEQ WAC4NB                     *IF
      * do not perform this on the order = to order being sent in
     C                     ELSE
      * CASE: PAR.Order Number 1 ALPHA USR EQ WRK.Blank for 12          U
     C           YL0015    IFEQ WUS3TX                     *IF
     C                     MOVEL*BLANK    YL0015           Order Number 1
     C                     MOVELWAC4NB    YL0015           Order Number 1
     C                     ELSE
      * CASE: PAR.Order Number 2 ALPHA USR EQ WRK.Blank for 12          U
     C           YL0016    IFEQ WUS3TX                     *IF
     C                     MOVEL*BLANK    YL0016           Order Number 2
     C                     MOVELWAC4NB    YL0016           Order Number 2
     C                     ELSE
      * CASE: PAR.Order Number 3 ALPHA USR EQ WRK.Blank for 12          U
     C           YL0017    IFEQ WUS3TX                     *IF
     C                     MOVEL*BLANK    YL0017           Order Number 3
     C                     MOVELWAC4NB    YL0017           Order Number 3
     C                     ELSE
      * CASE: PAR.Order Number 4 ALPHA USR EQ WRK.Blank for 12          U
     C           YL0018    IFEQ WUS3TX                     *IF
     C                     MOVEL*BLANK    YL0018           Order Number 4
     C                     MOVELWAC4NB    YL0018           Order Number 4
     C                     ELSE
      * CASE: PAR.Order Number 4 ALPHA USR NE WRK.Blank for 12          U
     C           YL0018    IFNE WUS3TX                     *IF
      * Still more records so this will make the + and quit
     C                     MOVEL'Y'       YL0019           More Explanatio
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BFCPHR                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Ord Typ Prt Status CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     Z-ADD*ZERO     WN0036  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0037 10        User Original E
     C                     Z-ADD*ZERO     WN0038  70       Date of Origina
     C                     Z-ADD*ZERO     WN0039 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0040 112       Order Weight To
     C                     MOVEL*BLANK    WN0041  1        Credit Hold
     C                     MOVEL*BLANK    WN0042  1        Production Hold
     C                     MOVEL*BLANK    WN0043  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0044  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0045  40       Requested Deliv
     C                     MOVEL*BLANK    WN0046  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0047 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0048  70       Load ID
     C                     Z-ADD*ZERO     WN0049  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A/R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD$DAIC3    WBAIC3           Company Number
     C                     Z-ADD$DC4NB    WBC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSI    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WBGYST    P      Order Type Prin
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWBANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVEL'N'       PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A/R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2FADT           USR Date Shippe
     C                     MOVEL*BLANK    P2BDTX           Item Descriptio
     C                     MOVEL*BLANK    P2F6ST           Update Exceptio
     C                     MOVEL*BLANK    P2PPIX           Print Pre-Inv/E
     C                     MOVEL*BLANK    P2GESX           Departure Sts U
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P2B6C7           Item Code USR
     C                     MOVEL*BLANK    P3HOSX           Manual Prc Err
     C                     MOVEL*BLANK    P3Q6SX           Average Ship Wg
     C                     Z-ADD*ZERO     P3HGCD           Item Code
     C                     MOVEL*BLANK    P3X6SX           InterCo Price E
     C                     MOVEL*BLANK    P3WXST           Record Found US
     C                     MOVEL*BLANK    P3UCST           Order Status
     C                     MOVEL*BLANK    P4B8ST           Status - Y or N
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field USR Display 2
     C                     MOVEL*BLANK    WUTJST  1
      * Define work field USR Display 3
     C                     MOVEL*BLANK    WUASTS  1
      * Define work field USR Display 4
     C                     MOVEL*BLANK    WUBSTS  1
      * Define work field USR Display 5
     C                     MOVEL*BLANK    WUGFSX  1
      * Define work field USR Display 6
     C                     MOVEL*BLANK    WUHPSX  1
      * Define work field USR Display 7
     C                     MOVEL*BLANK    WUIDSX  1
      * Define work field USR Display 8
     C                     MOVEL*BLANK    WUQ5SX  1
      * Define work field USR Display 9
     C                     MOVEL*BLANK    WUX7SX  1
      * Define work field Display Flag 1 USR
     C                     MOVEL*BLANK    WUDXSX  1
      * Define work field USR Display 11
     C                     MOVEL*BLANK    WUZ2SX  1
      * Define work field USR Display 12
     C                     MOVEL*BLANK    WUA6TX  1
      * Define work field USR Display 13
     C                     MOVEL*BLANK    WU      1
      * Define work field USR Display 15
     C                     MOVEL*BLANK    WUBASC  1
      * Define work field USR Display 16
     C                     MOVEL*BLANK    WUBCSC  1
      * Define work field Hour 1 USR
     C                     Z-ADD*ZERO     WUIJNX  20
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field USR Display 14
     C                     MOVEL*BLANK    WUEYST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0001 155
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0002  7
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0003 114
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field Price USR
     C                     Z-ADD*ZERO     YL0006  54
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Price Alpha USR
     C                     MOVEL*BLANK    YL0008  6
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field USR Work Field 4A     USR
     C                     MOVEL*BLANK    YL0010  4
      * Define local work field Price 6,4 USR
     C                     Z-ADD*ZERO     YL0011  64
      * Define local work field Price 7 Alpha USR
     C                     MOVEL*BLANK    YL0012  7
      * Define local work field Text 2 Length USR
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0014 114
      * Define local work field Order Number 1 ALPHA USR
     C                     MOVEL*BLANK    YL0015  7
      * Define local work field Order Number 2 ALPHA USR
     C                     MOVEL*BLANK    YL0016  7
      * Define local work field Order Number 3 ALPHA USR
     C                     MOVEL*BLANK    YL0017  7
      * Define local work field Order Number 4 ALPHA USR
     C                     MOVEL*BLANK    YL0018  7
      * Define local work field More Explanation USR
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field D-EDI INV PROC FLAG
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Text 10A USR
     C                     MOVEL*BLANK    YL0021 10
      * Define local work field GTIN Error Sts USR
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Item Code DRV
     C                     MOVEL*BLANK    YL0023  7
      * Define local work field GTIN Error Item Code USR
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Number 5,0            USR
     C                     Z-ADD*ZERO     YL0025  50
      * Define local work field Text USR 5
     C                     MOVEL*BLANK    YL0026  5
      * Define local work field Item Code 5A
     C                     MOVEL*BLANK    YL0027  5
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 *** SALES ORDERS ONLY ***
00002 *** CREDIT MEMOS ONLY ***
00003 *** Debit Memos Only ***
00004 *** Cr/Dr Memos Only ***
00005 - Inter-Co Customers
00006 - 3rd Party Customers
00007 - *All Customers
00008 - Selection by Order/Load
00009 Shipped
00010 Entered
00011 Order Unpriced
00012 Price Audit Required
00013 Load not Shipped
00014 Pricing Extension Error
00015 INVDELAYMN
00016 MAN Price Rng Err for
00017 : Avg Ship Wgt Err
00018 :IC Invoice Price = 0
00019 Revenue Week closed for
00020 Actual Ship Date
00021 PFS Ship Order Dtl is Unp
00022 rocessed.
00023 Orders for PO
00024 not shipped
00025 has ords with errors
00026 has other orders
00027 Orders:
00028 EDI PO Ack Sts =
00029 Pending
00030 Not Found
00031 EDI PO Ack Err =
00032 Missing
