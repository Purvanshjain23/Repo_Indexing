// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKVVXFR
// ?Date: 14.08.2025 Time: 02:53:05
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Val Appl/User Only    IF) TYPE(EXCINTFUN)                      AB1191075;
PARAMETER(PAR.Oms_Warehouse_Code);
PARAMETER(PAR.CC_Company_Number);
PARAMETER('HPE');
PARAMETER(PAR.Oms_SalesPerson_Code);
PARAMETER(PAR.Oms_Allow_Multi_Company);
PARAMETER(PAR.Oms_Default_Printer);
PARAMETER(PAR.Oms_Name);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.Oms_Access_Denied_Y_N);
{
 //?Execute internal function

 // Call program Val Application/User  XF.
 CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
 PARAMETER(PAR.Oms_Warehouse_Code);
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.Oms_Application_Code);
 PARAMETER(PAR.Oms_SalesPerson_Code);
 PARAMETER(PAR.Oms_Allow_Multi_Company);
 PARAMETER(PAR.Oms_Default_Printer);
 PARAMETER(PAR.Oms_Name);
 PARAMETER(PAR.Oms_System_Value_Alpha);
 PARAMETER(PAR.Oms_Access_Denied_Y_N);

 CASE;

 // IF PAR.Oms Access Denied (Y/N) is Yes
 IF PAR.Oms_Access_Denied_Y_N = 'Y';

 // Send error message - 'Access Denied for User'
 ERROR(PRK0298);

 ENDIF;

}


// Call program Rtv Prior Month       XF.
CALL PROGRAM(Rtv Prior Month       XF) ('POG6XFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);

// Send information message - 'Frm: &1  To: &2'
MESSAGE(PRK0961 *INFO);
MSGPARM(LCL.Date_From_USR);
MSGPARM(LCL.Date_To_USR);

// Call program Clc Prod Hist MNTH    UP.
CALL PROGRAM(Clc Prod Hist MNTH    UP) ('PKVTUPC');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER('PRKPRT04');
PARAMETER(*YES);
PARAMETER(*YES);
PARAMETER(01);

