// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDJRPVR
// ?Date: 14.08.2025 Time: 03:32:03
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?***** Change log and comments
DO;

//?** E00243 SLM 10/28/2008
//?** Add option to perform the Trim Production Schedul
//?** Add option to perform the Belly Production schedule
//?** FP1235 LJB 04/14/2008
//?** Add option to email the make sheet to the distribution list
//?** "DL Triumph Production Sheet"
//?** FP1235 LJB 01/23/2008 Leave report type as "Day" Schedule
//?** Add program & display file names for new variance style report
//?** Pass the program based on the requested schedule. If "D" for
//?** Day Schedule or "V" for Variance, pass the original program.
//?** If "M" for Make Sheet Schedule, pass the Make Sheet with
//?** Variance program name.
//?RMC 10/21/05 make warehouse a BOTH parameter so its passed in/out
ENDDO;

//?USER: Load screen

// DTL.Status - Y or N = CND.yes
DTL.Status_Y_or_N = 'Y';

// DTL.Report Type Schedule  USR = CND.Day Schedule
DTL.Report_Type_Schedule_USR = 'D';

// DTL.Condition Desc. 3  USR = Condition name of DTL.Report Type Schedule  USR
DTL.Condition_Desc_3_USR = RTVCND(DTL.Report_Type_Schedule_USR);

// DTL.Warehouse Code PASS   USR = PAR.Warehouse Code
DTL.Warehouse_Code_PASS_USR = PAR.Warehouse_Code;

EXECUTE FUNCTION(RTV Whse Descrip       RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1257603;
PARAMETER(DTL.Warehouse_Code_PASS_USR);
PARAMETER(DTL.Warehouse_Description);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 // PAR.Warehouse Description = DB1.Warehouse Description
 PAR.Warehouse_Description = DB1.Warehouse_Description;

}


// DTL.Production Date = PAR.Production Date
DTL.Production_Date = PAR.Production_Date;

// DTL.Email Selection usr = CND.Not Selected
DTL.Email_Selection_usr = *BLANK;

//?USER: Validate fields

//?Prompt warehouse
CASE;

// IF DTL.*CMD key is *Prompt
IF DTL.*CMD_key = '04';

CASE;

// IF PGM.*Cursor field <IS> DTL.Warehouse Code PASS   USR
IF PGM.*Cursor_field = DTL.Warehouse_Code_PASS_USR;

// Call program SEL Prod Whse          SR.
CALL PROGRAM(SEL Prod Whse          SR) ('PDLISRR');
PARAMETER(DTL.Warehouse_Code_PASS_USR);

ENDIF;

ENDIF;

//?CALC: Screen function fields

EXECUTE FUNCTION(RTV Whse Descrip       RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1257603;
PARAMETER(DTL.Warehouse_Code_PASS_USR);
PARAMETER(DTL.Warehouse_Description);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 // PAR.Warehouse Description = DB1.Warehouse Description
 PAR.Warehouse_Description = DB1.Warehouse_Description;

}


// DTL.Condition Desc. 3  USR = Condition name of DTL.Report Type Schedule  USR
DTL.Condition_Desc_3_USR = RTVCND(DTL.Report_Type_Schedule_USR);

//?USER: Validate relations

EXECUTE FUNCTION(Val Warehouse Exists   RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1323885;
PARAMETER(DTL.Warehouse_Code_PASS_USR);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

}


CASE;

// IF PGM.*Return code is *Record does not exist
IF PGM.*Return_code = 'Y2U0005';

// Send error message - 'Warehouse not found'
ERROR(USR0372);
MSGPARM(DTL.Warehouse_Code_PASS_USR);

ENDIF;

//?USER: Exit program processing

// PAR.Status - Y or N = DTL.Status - Y or N
PAR.Status_Y_or_N = DTL.Status_Y_or_N;

// PAR.Report Type Schedule  USR = DTL.Report Type Schedule  USR
PAR.Report_Type_Schedule_USR = DTL.Report_Type_Schedule_USR;

// PAR.Warehouse Code = DTL.Warehouse Code PASS   USR
PAR.Warehouse_Code = DTL.Warehouse_Code_PASS_USR;

// PAR.Production Date = DTL.Production Date
PAR.Production_Date = DTL.Production_Date;

//?** Pass the program based on the requested schedule   FP1235 LJB
CASE;

// IF DTL.Report Type Schedule  USR is Make Sheet with Variance
IF DTL.Report_Type_Schedule_USR = 'M';

// PAR.Program name USR = CON.PMRVPFR
PAR.Program_name_USR = 'PMRVPFR';

// PAR.Program Name$ USR = CON.PMRVPFR$
PAR.Program_Name$_USR = 'PMRVPFR$';

// PAR.Email Selection usr = DTL.Email Selection usr
PAR.Email_Selection_usr = DTL.Email_Selection_usr;

//?** Pass the program based on the requested schedule   FP1235 LJB
// IF DTL.Report Type Schedule  USR is Day Schedule
IF DTL.Report_Type_Schedule_USR = 'D';

// PAR.Program name USR = CON.PLA9PFR
PAR.Program_name_USR = 'PLA9PFR';

// PAR.Program Name$ USR = CON.PLA9PFR$
PAR.Program_Name$_USR = 'PLA9PFR$';

//?** Pass the program based on the requested schedule   FP1235 LJB
// IF DTL.Report Type Schedule  USR is Variance Schedule
IF DTL.Report_Type_Schedule_USR = 'V';

// PAR.Program name USR = CON.PLA9PFR
PAR.Program_name_USR = 'PLA9PFR';

// PAR.Program Name$ USR = CON.PLA9PFR$
PAR.Program_Name$_USR = 'PLA9PFR$';

ENDIF;

