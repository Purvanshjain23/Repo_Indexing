     H/TITLE PRT Load Confirmation  PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/07/21  Time  : 11:28:09
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDLNCPL1IF  E           K        DISK
      * RTV : WF Load Confirmation Work Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDLHCPLEIF  E           K        DISK
      * RSQ : Load Order Change Log     Load/Order/Seq Num
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFJCPLHIF  E           K        DISK
      * RSQ : Load Header               Carrier/Load-w/Carrie
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FPDLHCPL2IF  E           K        DISK
      * RSQ : Load Order Change Log     Ld ID,Stop,Order,D/T/
      *
     FPDLNCPL0UF  E           K        DISK
      * UPD : WF Load Confirmation Work Update index
      *
     FPDDJPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Load Confirmation  PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  21  6   @CN    25
     I@FJCPPF
      * Load Header               Carrier/Load-w/Carrie
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@AMREB0
      * Unit of Measure           Retrieval index       NV
      * Renamed input format fields
     I              AMHHCD                          WDHHCD
     I              AMAUNA                          WDAUNA
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@LHCPOT
      * Load Order Change Log     Ld ID,Stop,Order,D/T/
      * Renamed input format fields
     I              LHK4DT                          WFK4DT
     I              LHA1TM                          WFA1TM
     I              LHDXNB                          WFDXNB
     I              LHRMNB                          WFRMNB
     I              LHRVNB                          WFRVNB
     I              LHRVST                          WFRVST
     I              LHUJST                          WFUJST
     I              LHMNTX                          WFMNTX
     I              LHMOTX                          WFMOTX
     I              LHAYNA                          WFAYNA
     I              LHA0NA                          WFA0NA
     I              LHBZNA                          WFBZNA
     I              LHXMCD                          WFXMCD
     I              LHAIC3                          WFAIC3
     I              LHC4NB                          WFC4NB
      *
     I@LNCPPB
      * WF Load Confirmation Work Update index
      * Renamed input format fields
     I              LNB2VN                          WGB2VN
     I              LNBZNA                          WGBZNA
     I              LNRMNB                          WGRMNB
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPDLN1    E DSPDLNCPL0
      * UPD : WF Load Confirmation Work Update index
      * Renamed input format fields
     I              LNB2VN                          WGB2VN
     I              LNBZNA                          WGBZNA
     I              LNRMNB                          WGRMNB
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF Load Confirmation Work
      * I : RST Job Name CDE
     I                                        1  10 P1B2VN
      * I : RST Carrier Code
     I                                       11  13 P1BZNA
     IP2PARM      DS
      * I :  Fax/Print Flag
     I                                        1   1 P2UQST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B2VN    PARM           WP0001 10        Job Name CDE
     C           P1BZNA    PARM           WP0002  3        Carrier Code
     C           P2UQST    PARM           WP0003  1        Fax/Print Flag
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Load Confirmation  PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$PENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Load Confirmation  PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN LNB2VN    WQKA01           Job Name CDE
     C           *LIKE     DEFN LNBZNA    WQKA02           Carrier Code
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Job Name CDE
     C                     KFLD           WQKA02           Carrier Code
      * Setup key
     C                     MOVELP1B2VN    WQKA01           Job Name CDE
     C                     MOVELP1BZNA    WQKA02           Carrier Code
      * Establish starting position
     C           KRSA      SETLL@LNCPPC                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Job Name CDE
     C                     MOVEL'Y'       W0AL01  1        Carrier Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELLNB2VN    $CB2VN           Job Name CDE
     C                     MOVELLNBZNA    $CBZNA           Carrier Code
     C                     Z-ADDLNRMNB    $CRMNB           Load ID
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load Confirmation  PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Load Order Chg Lg PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * DLT PD Load Confirmati DL - Load Confirmation Work  * 
     C                     EXSR SWDLRC
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN LNB2VN    WZA001           Job Name CDE
     C                     MOVELLNB2VN    WZA001
     C           *LIKE     DEFN LNBZNA    WZA002           Carrier Code
     C                     MOVELLNBZNA    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@LNCPPC                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Job Name CDE
     C                     MOVEL*BLANK    W0AL01  1        Carrier Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Job Name CDE
     C                     MOVEL'Y'       W0AL01  1        Carrier Code
     C                     ELSE
      * Next record - Detect level breaks
     C           LNB2VN    IFNE WZA001                     Job Name CDE
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           LNBZNA    IFNE WZA002                     Carrier Code
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Load Confirmation  PO: Mainline
      *================================================================
      * PRT Load Confirmation  PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABZNA    WQKB01           Carrier Code
     C           *LIKE     DEFN WARMNB    WQKB03           Load ID
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Carrier Code
     C                     KFLD           WQKB03           Load ID
      * Setup key
     C                     MOVEL$CBZNA    WQKB01           Carrier Code
     C                     Z-ADD$CRMNB    WQKB03           Load ID
      * Establish starting position
     C           KRSB      SETLL@FJCPPF                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Carrier Code
     C                     MOVEL'Y'       W0BL01  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWAAIC3    $DAIC3           Company Number
     C                     MOVEL*BLANK    $DAPTX           Company Name
     C                     Z-ADDWARMNB    $DRMNB           Load ID
     C                     Z-ADDWAT4NB    $DT4NB           Schedule Sequen
     C                     Z-ADDWARPNB    $DRPNB           Total Load Orde
     C                     Z-ADDWAAODT    $DAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $DQS01           Quantity Schedu
     C                     Z-ADDWARNNB    $DRNNB           Reefer Temperat
     C                     MOVELWAWTTX    $DWTTX           Seal 4
     C                     MOVELWAWUTX    $DWUTX           Seal 2 Unused
     C                     Z-ADDWATLMI    $DTLMI           Total Load Mile
     C                     Z-ADD*ZERO     $DPCNX           USR Temperature
     C                     MOVEL*BLANK    $DFRSX           Shipping Temp C
     C                     MOVELWARNST    $DRNST           LH Carrier Paym
     C                     MOVELWALHOS    $DLHOS           Load Held Over
     C                     MOVELWALHOR    $DLHOR           Load Held Over
     C                     MOVELWAWNTX    $DWNTX           Load Held Over
     C                     MOVELWAOITX    $DOITX           Ocean BOL Numbe
     C                     MOVELWAOJTX    $DOJTX           Express Mail Nu
     C                     Z-ADDWALLDT    $DLLDT           Express Mail Da
     C                     MOVELWALSHG    $DLSHG           Load Shag Flag
     C                     MOVELWAYPST    $DYPST           Load Wash Flag
     C                     Z-ADDWAKNNX    $DKNNX           Pallets Loaded
     C                     Z-ADDWAICWG    $DICWG           Avg Pallet Tare
     C                     Z-ADDWAIDWG    $DIDWG           Tot Pallet Tare
     C                     MOVELWAH9SX    $DH9SX           Load Confirmed
     C                     MOVELWAWOTX    $DWOTX           Load Confirmed
     C                     MOVELWAWPTX    $DWPTX           Hide on WW Load
     C                     MOVELWAWQTX    $DWQTX           Late Billing Em
     C                     MOVELWAWRTX    $DWRTX           Shipping Temp C
     C                     MOVELWAWSTX    $DWSTX           LH Held Over Rs
     C                     MOVELWARVSX    $DRVSX           Multi Company L
     C                     MOVELWARUSX    $DRUSX           Fax Sent to SSI
     C                     MOVELWARWSX    $DRWSX           Schedule Pos Lo
     C                     MOVELWARXSX    $DRXSX           LH Power Only L
     C                     MOVELWARYSX    $DRYSX           MG Created Load
     C                     MOVELWARZSX    $DRZSX           LH Unused Sts 5
     C                     MOVELWAR0SX    $DR0SX           Load U/M
     C                     MOVELWAR1SX    $DR1SX           TPM Shipment St
     C                     MOVELWAR2SX    $DR2SX           LH Unused Sts 8
     C                     MOVELWAR3SX    $DR3SX           LH On-Time Reas
     C                     MOVELWAR4SX    $DR4SX           LH Held Over Re
     C                     Z-ADDWAPYDT    $DPYDT           LH Carrier Paid
     C                     Z-ADDWACKTM    $DCKTM           LH Carrier Paid
     C                     Z-ADDWAPZDT    $DPZDT           LH Last Combo P
     C                     Z-ADDWACLTM    $DCLTM           LH Last Combo P
     C                     Z-ADDWAP0DT    $DP0DT           LPT Load Plan S
     C                     Z-ADDWACMTM    $DCMTM           LPT Load Plan S
     C                     Z-ADDWAP1DT    $DP1DT           TPM Planned Shi
     C                     Z-ADDWACNTM    $DCNTM           LH Unused Time
     C                     Z-ADDWAP2DT    $DP2DT           LH Unused Date
     C                     Z-ADDWACOTM    $DCOTM           LH Unused Time
     C                     Z-ADDWAP3DT    $DP3DT           LH Unused Date
     C                     Z-ADDWACQTM    $DCQTM           LH Unused Time
      * Load related totals format
     C                     Z-ADDWAKZDT    $KKZDT           Deadline Depart
     C                     Z-ADD*ZERO     $KOTNB           USR Deadline De
     C                     MOVELWADXTX    $KDXTX           Trailer Id
     C                     MOVEL*BLANK    $KMUTX           Trailer Id
     C                     Z-ADDWAAXTM    $KAXTM           Deadline Depart
     C                     Z-ADDWAAIC3    $KAIC3           Company Number
     C                     Z-ADDWARMNB    $KRMNB           Load ID
     C                     Z-ADDWAAODT    $KAODT           Scheduled Ship
     C                     MOVELWAPJST    $KPJST           LTL Flag
     C                     MOVELWAPKST    $KPKST           Load Status
     C                     Z-ADDWARNNB    $KRNNB           Reefer Temperat
     C                     MOVELWADMTX    $KDMTX           Seal 1
     C                     MOVELWADNTX    $KDNTX           Seal 2
     C                     MOVELWADOTX    $KDOTX           Seal 3
     C                     MOVELWAWTTX    $KWTTX           Seal 4
     C                     MOVELWAWUTX    $KWUTX           Seal 2 Unused
     C                     Z-ADDWARPNB    $KRPNB           Total Load Orde
     C                     Z-ADDWAFLAM    $KFLAM           Flat Amount
     C                     MOVELWAXQST    $KXQST           Allocate Pounds
     C                     Z-ADDWARRNB    $KRRNB           Total Stops
     C                     MOVELWADYTX    $KDYTX           Transloader Car
     C                     Z-ADDWASBNB    $KSBNB           BOL Time
     C                     MOVELWABZNA    $KBZNA           Carrier Code
     C                     MOVELWARONB    $KRONB           Truck Size
     C                     Z-ADDWASQNB    $KSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDWAR1NB    $KR1NB           Rated Freight
     C                     MOVELWAVCST    $KVCST           Ship Status
     C                     MOVELWAVDST    $KVDST           Load Type
     C                     Z-ADDWASDNB    $KSDNB           Number Pallets
     C                     Z-ADDWAPAOU    $KPAOU           Number Pallets
     C                     Z-ADDWADGWG    $KDGWG           Load Carrier Pa
     C                     Z-ADDWASXNB    $KSXNB           Estimated Arriv
     C                     Z-ADDWAHADT    $KHADT           Actual Arrival
     C                     Z-ADDWAAART    $KAART           Actual Arrival
     C                     Z-ADDWADHWG    $KDHWG           Trailer IN Weig
     C                     Z-ADDWADIWG    $KDIWG           Trailer OUT Wei
     C                     Z-ADDWAAQDT    $KAQDT           Actual Departur
     C                     Z-ADDWAS6NB    $KS6NB           Departure Time
     C                     Z-ADDWAT4NB    $KT4NB           Schedule Sequen
     C                     Z-ADDWAPRTM    $KPRTM           Product Tempera
     C                     Z-ADDWANPSV    $KNPSV           Number Spacers
     C                     MOVELWAJ8TX    $KJ8TX           Car/Veh. Initia
     C                     Z-ADDWATLMI    $KTLMI           Total Load Mile
     C                     MOVELWAJ9TX    $KJ9TX           Recorder ID
     C                     MOVELWAQ2CD    $KQ2CD           Shipping Method
     C                     MOVELWAVPCD    $KVPCD           Ship From Wareh
     C                     MOVELWADBCD    $KDBCD           Ship To State C
     C                     Z-ADDWAGRWE    $KGRWE           Gross Weight
     C                     MOVELWAXCCD    $KXCCD           Carrier Broker
     C                     MOVELWAU2ST    $KU2ST           Export Status
     C                     Z-ADDWAF9DT    $KF9DT           Actual Ship Dat
     C                     MOVELWAONTM    $KONTM           On Time - (Y/N)
     C                     Z-ADDWAJ4DT    $KJ4DT           Truck Ready Dat
     C                     Z-ADDWATRTM    $KTRTM           Truck Ready Tim
     C                     Z-ADDWAJ5DT    $KJ5DT           Spotted Date
     C                     Z-ADDWASPTM    $KSPTM           Spotted Time
     C                     Z-ADDWAJ6DT    $KJ6DT           Load Finished D
     C                     Z-ADDWALFTM    $KLFTM           Load Finished T
     C                     Z-ADDWAJ7DT    $KJ7DT           BOL Complete Da
     C                     Z-ADDWABOTM    $KBOTM           BOL Complete Ti
     C                     Z-ADDWAJ8DT    $KJ8DT           BOL Received Da
     C                     Z-ADDWABLTM    $KBLTM           BOL Received Ti
     C                     Z-ADDWAKIDT    $KKIDT           Truck Departure
     C                     Z-ADDWAASTM    $KASTM           Truck Departure
     C                     Z-ADDWAKADT    $KKADT           Adjusted Depart
     C                     Z-ADDWAAJCM    $KAJCM           Adjusted Depart
     C                     MOVELWAXACD    $KXACD           Shipping Line
     C                     MOVELWAOANA    $KOANA           Port Delv Termi
     C                     MOVELWAK4TX    $KK4TX           Vessel Name
     C                     Z-ADDWAVOAG    $KVOAG           Voyage
     C                     Z-ADDWAKBDT    $KKBDT           Sail Date
     C                     MOVELWANBBO    $KNBBO           Booking Number
     C                     MOVELWAW4CD    $KW4CD           Discharge Port
     C                     Z-ADDWAEFDT    $KEFDT           Arrival Date
     C                     MOVELWACNTN    $KCNTN           Container Numbe
     C                     Z-ADDWAKCDT    $KKCDT           Date In
     C                     Z-ADDWATMIN    $KTMIN           Time In
     C                     Z-ADDWAKDDT    $KKDDT           Date Out
     C                     Z-ADDWAVMNB    $KVMNB           Time Out
     C                     Z-ADDWAOCFR    $KOCFR           Load Total Frei
     C                     Z-ADDWAKJDT    $KKJDT           Scheduled Deliv
     C                     Z-ADDWAATTM    $KATTM           Scheduled Deliv
     C                     MOVELWAOTRS    $KOTRS           LH Unused Sts
     C                     MOVELWARNST    $KRNST           LH Carrier Paym
     C                     Z-ADDWABRBK    $KBRBK           Bring Back Mile
     C                     Z-ADDWAEIDT    $KEIDT           Requested Deliv
     C                     MOVELWARMST    $KRMST           Load Acceptance
     C                     MOVELWAAJCD    $KAJCD           Warehouse Code
     C                     Z-ADDWAKKDT    $KKKDT           On Yard Date
     C                     Z-ADDWAAVTM    $KAVTM           On Yard Time
     C                     MOVELWALHOS    $KLHOS           Load Held Over
     C                     MOVELWALHOR    $KLHOR           Load Held Over
     C                     MOVELWAWNTX    $KWNTX           Load Held Over
     C                     MOVELWAOITX    $KOITX           Ocean BOL Numbe
     C                     MOVELWAOJTX    $KOJTX           Express Mail Nu
     C                     Z-ADDWALLDT    $KLLDT           Express Mail Da
     C                     MOVELWALSHG    $KLSHG           Load Shag Flag
     C                     MOVELWAYPST    $KYPST           Load Wash Flag
     C                     Z-ADDWAK0DT    $KK0DT           Product Complet
     C                     Z-ADDWAAYTM    $KAYTM           Product Complet
     C                     Z-ADDWAKNNX    $KKNNX           Pallets Loaded
     C                     Z-ADDWAICWG    $KICWG           Avg Pallet Tare
     C                     Z-ADDWAIDWG    $KIDWG           Tot Pallet Tare
     C                     MOVELWAH9SX    $KH9SX           Load Confirmed
     C                     MOVELWAWOTX    $KWOTX           Load Confirmed
     C                     Z-ADDWAK1DT    $KK1DT           Load Confirmati
     C                     Z-ADDWAAZTM    $KAZTM           Load Door 1
     C                     Z-ADDWAK2DT    $KK2DT           Override Total
     C                     Z-ADDWAA0TM    $KA0TM           Load Door 2
     C                     MOVELWAROST    $KROST           Partial Load
     C                     MOVELWARPST    $KRPST           Load Confirmati
     C                     MOVELWARQST    $KRQST           Export Load USD
     C                     MOVELWARRST    $KRRST           Late Delivery E
     C                     Z-ADDWAZBVA    $KZBVA           Load Actual Fre
     C                     MOVELWAWPTX    $KWPTX           Hide on WW Load
     C                     MOVELWAWQTX    $KWQTX           Late Billing Em
     C                     MOVELWAWRTX    $KWRTX           Shipping Temp C
     C                     MOVELWAWSTX    $KWSTX           LH Held Over Rs
     C                     MOVELWARVSX    $KRVSX           Multi Company L
     C                     MOVELWARUSX    $KRUSX           Fax Sent to SSI
     C                     MOVELWARWSX    $KRWSX           Schedule Pos Lo
     C                     MOVELWARXSX    $KRXSX           LH Power Only L
     C                     MOVELWARYSX    $KRYSX           MG Created Load
     C                     MOVELWARZSX    $KRZSX           LH Unused Sts 5
     C                     MOVELWAR0SX    $KR0SX           Load U/M
     C                     MOVELWAR1SX    $KR1SX           TPM Shipment St
     C                     MOVELWAR2SX    $KR2SX           LH Unused Sts 8
     C                     MOVELWAR3SX    $KR3SX           LH On-Time Reas
     C                     MOVELWAR4SX    $KR4SX           LH Held Over Re
     C                     Z-ADDWAPYDT    $KPYDT           LH Carrier Paid
     C                     Z-ADDWACKTM    $KCKTM           LH Carrier Paid
     C                     Z-ADDWAPZDT    $KPZDT           LH Last Combo P
     C                     Z-ADDWACLTM    $KCLTM           LH Last Combo P
     C                     Z-ADDWAP0DT    $KP0DT           LPT Load Plan S
     C                     Z-ADDWACMTM    $KCMTM           LPT Load Plan S
     C                     Z-ADDWAP1DT    $KP1DT           TPM Planned Shi
     C                     Z-ADDWACNTM    $KCNTM           LH Unused Time
     C                     Z-ADDWAP2DT    $KP2DT           LH Unused Date
     C                     Z-ADDWACOTM    $KCOTM           LH Unused Time
     C                     Z-ADDWAP3DT    $KP3DT           LH Unused Date
     C                     Z-ADDWACQTM    $KCQTM           LH Unused Time
     C                     MOVELWAUVST    $KUVST           EDI Status 1
     C                     MOVELWAUWST    $KUWST           EDI Status 2
     C                     MOVELWAUXST    $KUXST           EDI Status 3
     C                     Z-ADDWAAATM    $KAATM           Job Time
     C                     MOVELWAAYNA    $KAYNA           User Id
     C                     MOVELWAA0NA    $KA0NA           Job Name
     C                     Z-ADDWAAXDT    $KAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAAIC3    $EAIC3           Company Number
     C                     Z-ADDWARMNB    $ERMNB           Load ID
     C                     Z-ADDWAAODT    $EAODT           Scheduled Ship
     C                     MOVELWAPJST    $EPJST           LTL Flag
     C                     MOVELWAPKST    $EPKST           Load Status
     C                     Z-ADDWARNNB    $ERNNB           Reefer Temperat
     C                     MOVELWADMTX    $EDMTX           Seal 1
     C                     MOVELWADNTX    $EDNTX           Seal 2
     C                     MOVELWADOTX    $EDOTX           Seal 3
     C                     MOVELWAWTTX    $EWTTX           Seal 4
     C                     MOVELWAWUTX    $EWUTX           Seal 2 Unused
     C                     Z-ADDWARPNB    $ERPNB           Total Load Orde
     C                     Z-ADDWAFLAM    $EFLAM           Flat Amount
     C                     MOVELWAXQST    $EXQST           Allocate Pounds
     C                     Z-ADDWARRNB    $ERRNB           Total Stops
     C                     MOVELWADXTX    $EDXTX           Trailer Id
     C                     MOVELWADYTX    $EDYTX           Transloader Car
     C                     Z-ADDWASBNB    $ESBNB           BOL Time
     C                     MOVELWABZNA    $EBZNA           Carrier Code
     C                     MOVELWARONB    $ERONB           Truck Size
     C                     Z-ADDWASQNB    $ESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDWAR1NB    $ER1NB           Rated Freight
     C                     MOVELWAVCST    $EVCST           Ship Status
     C                     MOVELWAVDST    $EVDST           Load Type
     C                     Z-ADDWASDNB    $ESDNB           Number Pallets
     C                     Z-ADDWAPAOU    $EPAOU           Number Pallets
     C                     Z-ADDWADGWG    $EDGWG           Load Carrier Pa
     C                     Z-ADDWASXNB    $ESXNB           Estimated Arriv
     C                     Z-ADDWAHADT    $EHADT           Actual Arrival
     C                     Z-ADDWAAART    $EAART           Actual Arrival
     C                     Z-ADDWADHWG    $EDHWG           Trailer IN Weig
     C                     Z-ADDWADIWG    $EDIWG           Trailer OUT Wei
     C                     Z-ADDWAAQDT    $EAQDT           Actual Departur
     C                     Z-ADDWAS6NB    $ES6NB           Departure Time
     C                     Z-ADDWAT4NB    $ET4NB           Schedule Sequen
     C                     Z-ADDWAPRTM    $EPRTM           Product Tempera
     C                     Z-ADDWANPSV    $ENPSV           Number Spacers
     C                     MOVELWAJ8TX    $EJ8TX           Car/Veh. Initia
     C                     Z-ADDWATLMI    $ETLMI           Total Load Mile
     C                     MOVELWAJ9TX    $EJ9TX           Recorder ID
     C                     MOVELWAQ2CD    $EQ2CD           Shipping Method
     C                     MOVELWAVPCD    $EVPCD           Ship From Wareh
     C                     MOVELWADBCD    $EDBCD           Ship To State C
     C                     Z-ADDWAGRWE    $EGRWE           Gross Weight
     C                     MOVELWAXCCD    $EXCCD           Carrier Broker
     C                     MOVELWAU2ST    $EU2ST           Export Status
     C                     Z-ADDWAF9DT    $EF9DT           Actual Ship Dat
     C                     MOVELWAONTM    $EONTM           On Time - (Y/N)
     C                     Z-ADDWAJ4DT    $EJ4DT           Truck Ready Dat
     C                     Z-ADDWATRTM    $ETRTM           Truck Ready Tim
     C                     Z-ADDWAJ5DT    $EJ5DT           Spotted Date
     C                     Z-ADDWASPTM    $ESPTM           Spotted Time
     C                     Z-ADDWAJ6DT    $EJ6DT           Load Finished D
     C                     Z-ADDWALFTM    $ELFTM           Load Finished T
     C                     Z-ADDWAJ7DT    $EJ7DT           BOL Complete Da
     C                     Z-ADDWABOTM    $EBOTM           BOL Complete Ti
     C                     Z-ADDWAJ8DT    $EJ8DT           BOL Received Da
     C                     Z-ADDWABLTM    $EBLTM           BOL Received Ti
     C                     Z-ADDWAKIDT    $EKIDT           Truck Departure
     C                     Z-ADDWAASTM    $EASTM           Truck Departure
     C                     Z-ADDWAKADT    $EKADT           Adjusted Depart
     C                     Z-ADDWAAJCM    $EAJCM           Adjusted Depart
     C                     MOVELWAXACD    $EXACD           Shipping Line
     C                     MOVEL*BLANK    $EADTX           Name
     C                     Z-ADDWAVOAG    $EVOAG           Voyage
     C                     Z-ADDWAKCDT    $EKCDT           Date In
     C                     MOVELWAOANA    $EOANA           Port Delv Termi
     C                     MOVELWACNTN    $ECNTN           Container Numbe
     C                     Z-ADDWATMIN    $ETMIN           Time In
     C                     MOVEL*BLANK    $EOKTX           Port City
     C                     MOVELWAW4CD    $EW4CD           Discharge Port
     C                     Z-ADDWAKDDT    $EKDDT           Date Out
     C                     MOVELWAK4TX    $EK4TX           Vessel Name
     C                     Z-ADDWAKBDT    $EKBDT           Sail Date
     C                     Z-ADDWAVMNB    $EVMNB           Time Out
     C                     MOVELWANBBO    $ENBBO           Booking Number
     C                     Z-ADDWAEFDT    $EEFDT           Arrival Date
     C                     Z-ADDWAOCFR    $EOCFR           Load Total Frei
     C                     Z-ADDWAKJDT    $EKJDT           Scheduled Deliv
     C                     Z-ADDWAATTM    $EATTM           Scheduled Deliv
     C                     MOVELWAOTRS    $EOTRS           LH Unused Sts
     C                     MOVELWARNST    $ERNST           LH Carrier Paym
     C                     Z-ADDWABRBK    $EBRBK           Bring Back Mile
     C                     Z-ADDWAEIDT    $EEIDT           Requested Deliv
     C                     MOVELWARMST    $ERMST           Load Acceptance
     C                     MOVELWAAJCD    $EAJCD           Warehouse Code
     C                     Z-ADDWAKKDT    $EKKDT           On Yard Date
     C                     Z-ADDWAAVTM    $EAVTM           On Yard Time
     C                     Z-ADDWAKZDT    $EKZDT           Deadline Depart
     C                     Z-ADDWAAXTM    $EAXTM           Deadline Depart
     C                     MOVELWALHOS    $ELHOS           Load Held Over
     C                     MOVELWALHOR    $ELHOR           Load Held Over
     C                     MOVELWAWNTX    $EWNTX           Load Held Over
     C                     MOVELWAOITX    $EOITX           Ocean BOL Numbe
     C                     MOVELWAOJTX    $EOJTX           Express Mail Nu
     C                     Z-ADDWALLDT    $ELLDT           Express Mail Da
     C                     MOVELWALSHG    $ELSHG           Load Shag Flag
     C                     MOVELWAYPST    $EYPST           Load Wash Flag
     C                     Z-ADDWAK0DT    $EK0DT           Product Complet
     C                     Z-ADDWAAYTM    $EAYTM           Product Complet
     C                     Z-ADDWAKNNX    $EKNNX           Pallets Loaded
     C                     Z-ADDWAICWG    $EICWG           Avg Pallet Tare
     C                     Z-ADDWAIDWG    $EIDWG           Tot Pallet Tare
     C                     MOVELWAH9SX    $EH9SX           Load Confirmed
     C                     MOVELWAWOTX    $EWOTX           Load Confirmed
     C                     Z-ADDWAK1DT    $EK1DT           Load Confirmati
     C                     Z-ADDWAAZTM    $EAZTM           Load Door 1
     C                     Z-ADDWAK2DT    $EK2DT           Override Total
     C                     Z-ADDWAA0TM    $EA0TM           Load Door 2
     C                     MOVELWAROST    $EROST           Partial Load
     C                     MOVELWARPST    $ERPST           Load Confirmati
     C                     MOVELWARQST    $ERQST           Export Load USD
     C                     MOVELWARRST    $ERRST           Late Delivery E
     C                     Z-ADDWAZBVA    $EZBVA           Load Actual Fre
     C                     MOVELWAWPTX    $EWPTX           Hide on WW Load
     C                     MOVELWAWQTX    $EWQTX           Late Billing Em
     C                     MOVELWAWRTX    $EWRTX           Shipping Temp C
     C                     MOVELWAWSTX    $EWSTX           LH Held Over Rs
     C                     MOVELWARVSX    $ERVSX           Multi Company L
     C                     MOVELWARUSX    $ERUSX           Fax Sent to SSI
     C                     MOVELWARWSX    $ERWSX           Schedule Pos Lo
     C                     MOVELWARXSX    $ERXSX           LH Power Only L
     C                     MOVELWARYSX    $ERYSX           MG Created Load
     C                     MOVELWARZSX    $ERZSX           LH Unused Sts 5
     C                     MOVELWAR0SX    $ER0SX           Load U/M
     C                     MOVELWAR1SX    $ER1SX           TPM Shipment St
     C                     MOVELWAR2SX    $ER2SX           LH Unused Sts 8
     C                     MOVELWAR3SX    $ER3SX           LH On-Time Reas
     C                     MOVELWAR4SX    $ER4SX           LH Held Over Re
     C                     Z-ADDWAPYDT    $EPYDT           LH Carrier Paid
     C                     Z-ADDWACKTM    $ECKTM           LH Carrier Paid
     C                     Z-ADDWAPZDT    $EPZDT           LH Last Combo P
     C                     Z-ADDWACLTM    $ECLTM           LH Last Combo P
     C                     Z-ADDWAP0DT    $EP0DT           LPT Load Plan S
     C                     Z-ADDWACMTM    $ECMTM           LPT Load Plan S
     C                     Z-ADDWAP1DT    $EP1DT           TPM Planned Shi
     C                     Z-ADDWACNTM    $ECNTM           LH Unused Time
     C                     Z-ADDWAP2DT    $EP2DT           LH Unused Date
     C                     Z-ADDWACOTM    $ECOTM           LH Unused Time
     C                     Z-ADDWAP3DT    $EP3DT           LH Unused Date
     C                     Z-ADDWACQTM    $ECQTM           LH Unused Time
     C                     MOVELWAUVST    $EUVST           EDI Status 1
     C                     MOVELWAUWST    $EUWST           EDI Status 2
     C                     MOVELWAUXST    $EUXST           EDI Status 3
     C                     Z-ADDWAAATM    $EAATM           Job Time
     C                     MOVELWAAYNA    $EAYNA           User Id
     C                     MOVELWAA0NA    $EA0NA           Job Name
     C                     Z-ADDWAAXDT    $EAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load Confirm Dtl   PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WABZNA    WZB001           Carrier Code
     C                     MOVELWABZNA    WZB001
     C           *LIKE     DEFN WARMNB    WZB002           Load ID
     C                     Z-ADDWARMNB    WZB002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FJCPPF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Carrier Code
     C                     MOVEL*BLANK    W0BL01  1        Load ID
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Carrier Code
     C                     MOVEL'Y'       W0BL01  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           WABZNA    IFNE WZB001                     Carrier Code
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WARMNB    IFNE WZB002                     Load ID
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL01    IFEQ 'Y'
      * USER: Process before print of Load ID format
     C           $KAXTM    DIV  100       $KOTNB           USR Deadline De
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
     C                     MOVEL$KDXTX    $KMUTX           Trailer Id
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  $KKZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKKZDT
      * Print format
     C                     WRITE$KKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * PRTOBJ calls after print of Load ID format
      * Embedded PRTOBJ : PRT Traffic Comments PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Load Confirm Dtl   PO: Mainline
      *================================================================
      * PRT Load Confirm Dtl   PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKC02           Load ID
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC02           Load ID
     C                     KFLD           FLRVNB           Stop/Drop
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC02           Load ID
      * Setup key
     C                     Z-ADD$ERMNB    WQKC02           Load ID
     C                     Z-ADD99999     FLRVNB           Stop/Drop
      * Establish starting position
     C           KPSC      SETLL@FLCPE8                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Load ID
     C                     MOVEL'Y'       W0CL01  1        Stop/Drop
     C                     MOVEL'Y'       W0CL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFLAIC3    $FAIC3           Company Number
     C                     Z-ADDFLRMNB    $FRMNB           Load ID
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $JTENB           USR Stop
     C                     MOVEL*BLANK    $JCPCD           USR Warehouse C
     C                     MOVEL*BLANK    $JF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $JBRTX           Ship To Name
     C                     Z-ADDFLAIC3    $JAIC3           Company Number
     C                     Z-ADDFLRMNB    $JRMNB           Load ID
     C                     Z-ADDFLRVNB    $JRVNB           Stop/Drop
     C                     MOVEL*BLANK    $JLMNA           USR City 15
     C                     MOVEL*BLANK    $JLNNA           USR State 2
     C                     Z-ADD*ZERO     $JR6NB           Deliver before
     C                     Z-ADD*ZERO     $JR5NB           Deliver after t
     C                     Z-ADDFLC4NB    $JC4NB           Order Number
     C                     Z-ADD*ZERO     $JLLNA           USR Weight 9
     C                     MOVEL*BLANK    $JCDTX           USR Telephone C
     C                     MOVEL*BLANK    $JBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $JEIDT           Requested Deliv
     C                     Z-ADD*ZERO     $JAFTM           Requested Deliv
     C                     Z-ADDFLRWNB    $JRWNB           Miles to next s
     C                     MOVEL*BLANK    $JKINA           USR Special Ins
     C                     MOVEL*BLANK    $JN1NA           USR Special Ins
     C                     MOVEL*BLANK    $JB6NA           Special Instruc
     C                     MOVEL*BLANK    $JBYNA           Special Instruc
     C                     MOVEL*BLANK    $JDXTX           Trailer Id
     C                     MOVEL*BLANK    $JEVTX           USR Customer Sh
     C                     Z-ADD*ZERO     $JBUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    $JF2TX           USR City Short
     C                     MOVEL*BLANK    $JGWNA           USR State - ATR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFLAIC3    $GAIC3           Company Number
     C                     Z-ADDFLRMNB    $GRMNB           Load ID
     C                     Z-ADDFLRVNB    $GRVNB           Stop/Drop
     C                     MOVEL*BLANK    $GKTTX           Alpha Zeros 2
     C                     Z-ADD*ZERO     $GTENB           USR Stop
     C                     MOVEL*BLANK    $GCPCD           USR Warehouse C
     C                     MOVEL*BLANK    $GF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $GBRTX           Ship To Name
     C                     MOVEL*BLANK    $GBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $GR6NB           Deliver before
     C                     Z-ADD*ZERO     $GR5NB           Deliver after t
     C                     Z-ADDFLC4NB    $GC4NB           Order Number
     C                     Z-ADD*ZERO     $GLLNA           USR Weight 9
     C                     MOVEL*BLANK    $GAGCD           U/M - Ordered
     C                     MOVEL*BLANK    $GHMNA           Ship To Address
     C                     MOVEL*BLANK    $GLMT1           Delivery P.O. N
     C                     Z-ADD*ZERO     $GEIDT           Requested Deliv
     C                     Z-ADD*ZERO     $GAFTM           Requested Deliv
     C                     Z-ADD*ZERO     $GASNX           Quantity Sched
     C                     MOVEL*BLANK    $GUCTX           UOM Description
     C                     MOVEL*BLANK    $GHONA           Ship To Address
     C                     MOVEL*BLANK    $GCDTX           USR Telephone C
     C                     MOVEL*BLANK    $GHPNA           Ship To Address
     C                     MOVEL*BLANK    $GLMNA           USR City 15
     C                     MOVEL*BLANK    $GLNNA           USR State 2
     C                     MOVEL*BLANK    $GCKTX           Ship To Zip/Pos
     C                     MOVEL*BLANK    $GKINA           USR Special Ins
     C                     MOVEL*BLANK    $GN1NA           USR Special Ins
     C                     MOVEL*BLANK    $GB6NA           Special Instruc
     C                     MOVEL*BLANK    $GBYNA           Special Instruc
     C                     MOVELFLVCST    $GVCST           Ship Status
     C                     Z-ADDFLKEDT    $GKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $GSXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $GKFDT           Appointment Con
     C                     Z-ADDFLACTM    $GACTM           Appointment Con
     C                     Z-ADDFLEJDT    $GEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $GAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $GKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $GATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $GHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $GAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $GKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $GAVTM           On Yard Time
     C                     Z-ADDFLZ4NB    $GZ4NB           MPC Number
     C                     MOVELFLY7ST    $GY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $GY2ST           On Time Add'l R
     C                     MOVELFLWHTX    $GWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $GWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $GWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $GWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $GWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $GN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $GN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $GN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $GB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $GB4TM           LD Unused Time
     C                     MOVELFLW5CD    $GW5CD           Confirmation Nu
     C                     MOVELFLK5TX    $GK5TX           Confirmation Ma
     C                     Z-ADDFLB5TM    $GB5TM           LD Unused Time
     C                     MOVELFLIASX    $GIASX           Miles Error Sts
     C                     MOVELFLIBSX    $GIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $GICSX           HPB Transload S
     C                     MOVELFLWVTX    $GWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $GWWTX           Carrier Ref PRO
     C                     MOVELFLWXTX    $GWXTX           Cust Assigned A
     C                     MOVELFLUVST    $GUVST           EDI Status 1
     C                     MOVELFLUWST    $GUWST           EDI Status 2
     C                     MOVELFLUXST    $GUXST           EDI Status 3
     C                     Z-ADDFLRUNB    $GRUNB           Stop/Drop Seque
     C                     MOVELFLDQTX    $GDQTX           Comments for Pi
     C                     Z-ADDFLRWNB    $GRWNB           Miles to next s
     C                     Z-ADDFLRXNB    $GRXNB           Freight Charge
     C                     Z-ADDFLSQNB    $GSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFLT0NB    $GT0NB           Freight Misc. C
     C                     Z-ADDFLT1NB    $GT1NB           Freight Stop Ch
     C                     Z-ADDFLR1NB    $GR1NB           Rated Freight
     C                     Z-ADDFLAATM    $GAATM           Job Time
     C                     MOVELFLAYNA    $GAYNA           User Id
     C                     MOVELFLA0NA    $GA0NA           Job Name
     C                     Z-ADDFLAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load Conf Exp Inst PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Load Confirm Dtl  PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZC001           Load ID
     C                     Z-ADDFLRMNB    WZC001
     C           *LIKE     DEFN FLRVNB    WZC002           Stop/Drop
     C                     Z-ADDFLRVNB    WZC002
     C           *LIKE     DEFN FLC4NB    WZC003           Order Number
     C                     Z-ADDFLC4NB    WZC003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@FLCPE8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Increment counter (used for null report msg) if select record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Load ID
     C                     MOVEL*BLANK    W0CL01  1        Stop/Drop
     C                     MOVEL*BLANK    W0CL02  1        Order Number
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Load ID
     C                     MOVEL'Y'       W0CL01  1        Stop/Drop
     C                     MOVEL'Y'       W0CL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZC001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           FLRVNB    IFNE WZC002                     Stop/Drop
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           FLC4NB    IFNE WZC003                     Order Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
      * USER: Process after print of Stop/Drop format
     C                     Z-ADD*ZERO     WULLNA           USR Weight 9
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Load Conf Exp Inst PO: Mainline
      *================================================================
      * PRT Load Conf Exp Inst PO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMAIC3    WQKD01           Company Number
     C           *LIKE     DEFN AMC4NB    WQKD02           Order Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQKD01           Company Number
     C                     Z-ADD$GC4NB    WQKD02           Order Number
      * Establish starting position
     C           KRSD      SETLL@AMREJF                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAMAIC3    $HAIC3           Company Number
     C                     Z-ADDAMC4NB    $HC4NB           Order Number
     C                     Z-ADDAMRMNB    $HRMNB           Load ID
     C                     Z-ADDAMRUNB    $HRUNB           Stop/Drop Seque
     C                     MOVELAMXACD    $HXACD           Shipping Line
     C                     MOVEL*BLANK    $HJNNA           USR Description
     C                     MOVELAMHCAA    $HHCAA           OHE Discharge P
     C                     MOVELAMOANA    $HOANA           Port Delv Termi
     C                     Z-ADDAMQWDT    $HQWDT           OHE Sail/Flight
     C                     MOVELAMHBAA    $HHBAA           OHE City
     C                     Z-ADDAMQYDT    $HQYDT           OHE Arrival Dat
     C                     MOVELAMJ0T1    $HJ0T1           OHE Vessel/Airl
     C                     MOVELAMGENY    $HGENY           OHE Voyage/Flig
     C                     MOVELAMJ1T1    $HJ1T1           OHE Booking Num
     C                     MOVELAMJ2T1    $HJ2T1           OHE Container N
     C                     Z-ADDAMQXDT    $HQXDT           OHE Port Cut Da
     C                     MOVELAMHDAA    $HHDAA           OHE Late Delive
     C                     MOVELAMCCTX    $HCCTX           OHE Ship Status
     C                     MOVELAMRLNA    $HRLNA           OHE Comment 1
     C                     MOVELAMRMNA    $HRMNA           OHE Comment 2
     C                     Z-ADDAMGINY    $HGINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    $HGFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    $HGGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    $HGHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    $HHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    $HHFVL           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    $HHGVL           Transload Termi
     C                     Z-ADDAMQZDT    $HQZDT           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    $HQ0DT           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    $HQ1DT           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    $HQ2DT           OHE Actual Ship
     C                     MOVELAMC2TX    $HC2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    $HC3TX           OHE Spot Buy
     C                     MOVELAMC6TX    $HC6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    $HCHTX           OHE Override Ty
     C                     MOVELAMCITX    $HCITX           OHE Backhaul St
     C                     MOVELAMCLTX    $HCLTX           OHE Backhaul ET
     C                     MOVELAMB4TX    $HB4TX           OHE Load Haul T
     C                     MOVELAMCUTX    $HCUTX           OHE Backhaul Ca
     C                     MOVELAMCVTX    $HCVTX           OHE Bookings Co
     C                     MOVELAMB9TX    $HB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    $HJWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    $HITNY           HPB COA Batch N
     C                     MOVELAMLMT1    $HLMT1           Delivery P.O. N
     C                     MOVELAMLWAA    $HLWAA           OHE Intended fo
     C                     MOVELAMFVST    $HFVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    $HF0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    $HF2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    $HF3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    $HJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    $HJVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    $HV3T1           OHE Transload S
     C                     MOVELAMV4T1    $HV4T1           OHE Abs Rate Ov
     C                     MOVELAMV5T1    $HV5T1           OHE Appt Confir
     C                     MOVELAMV6T1    $HV6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    $HV7T1           OHE Backhaul Ch
     C                     MOVELAMV8T1    $HV8T1           OHE Transload C
     C                     MOVELAMV9T1    $HV9T1           OHE Pier Pass I
     C                     MOVELAMWAT1    $HWAT1           OHE Carrier Nm
     C                     MOVELAMWBT1    $HWBT1           OHE Appt Confir
     C                     MOVELAMWCT1    $HWCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    $HWDT1           Letter of Credi
     C                     Z-ADDAMQJNY    $HQJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    $HQKNY           LD Stop/Drop
     C                     Z-ADDAMQLNY    $HQLNY           OHE Unused Numb
     C                     Z-ADDAMP8NY    $HP8NY           OHE Pier Pass F
     C                     Z-ADDAMP9NY    $HP9NY           OHE Port Check
     C                     Z-ADDAMQANY    $HQANY           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    $HQCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    $HQDNY           OHE Load Sched
     C                     Z-ADDAMQENY    $HQENY           Original Appoin
     C                     Z-ADDAMQFNY    $HQFNY           Original Appoin
     C                     Z-ADDAMQGNY    $HQGNY           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    $HQHNY           OHE PowerPro Lo
     C                     Z-ADDAMQINY    $HQINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    $HQMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    $HMYU1           OHE Genset Numb
     C                     MOVELAMJXSC    $HJXSC           OHE Email BOL/S
     C                     MOVELAMJYSC    $HJYSC           OHE Unused Stat
     C                     MOVELAMJZSC    $HJZSC           OHE Unused Stat
     C                     MOVELAMJ0SC    $HJ0SC           OHE Unused Stat
     C                     MOVELAMMZU1    $HMZU1           OHE Unused Text
     C                     MOVELAMM0U1    $HM0U1           OHE Unused Text
     C                     MOVELAMM1U1    $HM1U1           OHE Customer Ve
     C                     MOVELAMM2U1    $HM2U1           OHE Unused Text
     C                     MOVELAMM3U1    $HM3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    $HW5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    $HW6DT           OHE Unused Date
     C                     MOVELAMUVST    $HUVST           EDI Status 1
     C                     MOVELAMUWST    $HUWST           EDI Status 2
     C                     MOVELAMUXST    $HUXST           EDI Status 3
     C                     MOVELAMVSST    $HVSST           Record Status
     C                     Z-ADDAMAATM    $HAATM           Job Time
     C                     MOVELAMAYNA    $HAYNA           User Id
     C                     MOVELAMA0NA    $HA0NA           Job Name
     C                     Z-ADDAMAXDT    $HAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AMAIC3    WZD001           Company Number
     C                     Z-ADDAMAIC3    WZD001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@AMREJF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Record Status is Deleted & Inactive
     C           AMVSST    IFEQ 'D'                        *IF
     C           AMVSST    OREQ 'I'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     ELSE
      * Next record - Detect level breaks
     C           AMAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Load Confirm Dtl  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQKE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQKE02           Order Number
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Company Number
     C                     KFLD           WQKE02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQKE01           Company Number
     C                     Z-ADD$GC4NB    WQKE02           Order Number
      * Establish starting position
     C           KRSE      SETLL@BGWKFW                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Order Number
     C                     MOVEL'Y'       W0EL02  1        Item Code
     C                     MOVEL'Y'       W0EL03  1        Warehouse Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWEAIC3    $IAIC3           Company Number
     C                     Z-ADDWEC4NB    $IC4NB           Order Number
     C                     Z-ADDWEDPNB    $IDPNB           Order Sequence
     C                     Z-ADDWEUENB    $IUENB           Order Secondary
     C                     Z-ADDWEHGCD    $IHGCD           Item Code
     C                     MOVEL*BLANK    $IOONA           Item Desc DRV
     C                     MOVELWEAJCD    $IAJCD           Warehouse Code
     C                     Z-ADDWEBKC7    $IBKC7           Ship To Custome
     C                     Z-ADDWECFC7    $ICFC7           Order Group Cod
     C                     MOVELWEGMST    $IGMST           Detail Line Sta
     C                     MOVELWEGNST    $IGNST           Detail Line Sta
     C                     Z-ADDWEMAVA    $IMAVA           Billing Detail
     C                     Z-ADDWEKDVA    $IKDVA           Billing Detail
     C                     Z-ADDWEL8VA    $IL8VA           Billing Detail
     C                     Z-ADDWEL9VA    $IL9VA           Quantity to Sub
     C                     MOVELWEGTST    $IGTST           Comment Print A
     C                     MOVELWEGVST    $IGVST           Comment Print I
     C                     MOVELWEGUST    $IGUST           Comment Print P
     C                     MOVELWEQFST    $IQFST           Comment Print S
     C                     Z-ADDWEAYVA    $IAYVA           Extended Amount
     C                     Z-ADDWEEXDT    $IEXDT           Market Pricing
     C                     MOVELWELQCD    $ILQCD           Commodity Marke
     C                     MOVELWERDCD    $IRDCD           Date Method Cod
     C                     MOVELWEQ7CD    $IQ7CD           Price Method Co
     C                     Z-ADDWEBZPR    $IBZPR           Price Overage O
     C                     Z-ADDWEL6NB    $IL6NB           Contract Number
     C                     MOVELWEU1ST    $IU1ST           Price Status
     C                     Z-ADDWEGIDT    $IGIDT           Pricing Date Us
     C                     MOVELWECRCD    $ICRCD           U/M - Base Pric
     C                     MOVELWEAGCD    $IAGCD           U/M - Ordered
     C                     MOVELWERZST    $IRZST           Work Confirm St
     C                     MOVELWER0ST    $IR0ST           Work Over/Short
     C                     MOVELWER1ST    $IR1ST           OD Production P
     C                     MOVELWEG7NA    $IG7NA           Order Desc. Lin
     C                     MOVELWEG8NA    $IG8NA           Order Desc. Lin
     C                     MOVELWERPCD    $IRPCD           Age Code
     C                     MOVELWEVEST    $IVEST           Palletize
     C                     MOVELWEVGST    $IVGST           Slip Sheet
     C                     MOVELWEAVST    $IAVST           Catch Weight St
     C                     MOVELWEU0ST    $IU0ST           Price Audit
     C                     MOVELWERFCD    $IRFCD           Price Audit Rea
     C                     MOVELWEFZST    $IFZST           Production Date
     C                     Z-ADDWER1NB    $IR1NB           Rated Freight
     C                     Z-ADDWEAVQT    $IAVQT           Quantity Ordere
     C                     Z-ADDWED0WG    $ID0WG           Weight Ordered
     C                     Z-ADDWECCQT    $ICCQT           Quantity Schedu
     C                     Z-ADDWEAUWG    $IAUWG           Weight Schedule
     C                     Z-ADDWECBQT    $ICBQT           Quantity Shippe
     C                     Z-ADDWEATWG    $IATWG           Weight Shipped
     C                     Z-ADDWEAQCS    $IAQCS           Unit Cost Prici
     C                     Z-ADDWEAGCS    $IAGCS           Unit Cost Per P
     C                     Z-ADDWEAKPR    $IAKPR           Unit Price
     C                     Z-ADDWEALPR    $IALPR           Unit Price - Cr
     C                     Z-ADDWEAUPR    $IAUPR           Unit Price Orde
     C                     Z-ADDWEAVWG    $IAVWG           Unit Weight Ord
     C                     Z-ADDWEA4WG    $IA4WG           Tare Weight Tot
     C                     Z-ADDWEA5DT    $IA5DT           Requested Ship
     C                     Z-ADDWEAODT    $IAODT           Scheduled Ship
     C                     Z-ADDWEGNDT    $IGNDT           Actual Shipped
     C                     MOVELWEAMST    $IAMST           Affect Inventor
     C                     MOVELWEANST    $IANST           Affect Sales Do
     C                     MOVELWEVAST    $IVAST           Affect Sales Pn
     C                     Z-ADDWERGNB    $IRGNB           Item Structure
     C                     Z-ADDWERHNB    $IRHNB           Item Structure
     C                     Z-ADDWERINB    $IRINB           Item Structure
     C                     MOVELWERBCD    $IRBCD           Item Level
     C                     MOVELWEHICD    $IHICD           Quality Level
     C                     MOVELWERNCD    $IRNCD           Pricing Product
     C                     MOVELWEROCD    $IROCD           Season Product
     C                     Z-ADDWECXDT    $ICXDT           Date of Origina
     C                     MOVELWEAJVN    $IAJVN           User Profile Na
     C                     MOVELWEKXCD    $IKXCD           Country Code
     C                     MOVELWEJPCD    $IJPCD           Event Code
     C                     MOVELWECQCD    $ICQCD           Reason Code
     C                     MOVELWER4CD    $IR4CD           Sales Route Cod
     C                     MOVELWEZ1ST    $IZ1ST           Modified Flag
     C                     MOVELWEZ3ST    $IZ3ST           Substituted Fla
     C                     MOVELWEZ4ST    $IZ4ST           OD Schedule Ove
     C                     Z-ADDWEDUPR    $IDUPR           Invoice Unit Pr
     C                     Z-ADDWEB6VL    $IB6VL           Invoice Extende
     C                     Z-ADDWEA1AA    $IA1AA           Ham Group Numbe
     C                     MOVELWEFZSX    $IFZSX           OD Adj Type Ove
     C                     MOVELWEF0SX    $IF0SX           Affect Trade Fu
     C                     MOVELWEF1SX    $IF1SX           Affect Commissi
     C                     MOVELWEF2SX    $IF2SX           Affect Pricing
     C                     MOVELWEF3SX    $IF3SX           Released by Use
     C                     MOVELWEF4SX    $IF4SX           Ord TF Exempt C
     C                     MOVELWEF5SX    $IF5SX           OD Pallet Type
     C                     MOVELWEF6SX    $IF6SX           Production Ware
     C                     MOVELWEF7SX    $IF7SX           OD Price Type
     C                     Z-ADDWENTDT    $INTDT           Warehouse Palle
     C                     Z-ADDWENUDT    $INUDT           Consumed Item C
     C                     Z-ADDWENVDT    $INVDT           Deadline Depart
     C                     Z-ADDWENWDT    $INWDT           OD Price Type R
     C                     Z-ADDWENXDT    $INXDT           OD Firm Date
     C                     Z-ADDWEBUTM    $IBUTM           Deadline Depart
     C                     Z-ADDWEBVTM    $IBVTM           Price Code
     C                     Z-ADDWEBWTM    $IBWTM           Maximum Net Wei
     C                     Z-ADDWEBXTM    $IBXTM           Substitution Li
     C                     Z-ADDWEBYTM    $IBYTM           Max Qty to sche
     C                     Z-ADDWEH5NX    $IH5NX           Warehouse Palle
     C                     Z-ADDWEH6NX    $IH6NX           Warehouse Avg P
     C                     Z-ADDWEH7NX    $IH7NX           OD Item Target
     C                     Z-ADDWEH8NX    $IH8NX           OD Estimated Gr
     C                     Z-ADDWEH9NX    $IH9NX           OD Maximum Unit
     C                     Z-ADDWEDVPR    $IDVPR           Order Gate/Fina
     C                     Z-ADDWEDWPR    $IDWPR           OD Ceiling Pric
     C                     Z-ADDWEDXPR    $IDXPR           OD Gate/Final P
     C                     Z-ADDWEDYPR    $IDYPR           OD Weighted Avg
     C                     Z-ADDWEDZPR    $IDZPR           OD Original Ord
     C                     Z-ADDWEGSPR    $IGSPR           OD Cancel Date
     C                     Z-ADDWEGTPR    $IGTPR           OD Unused Prc 7
     C                     Z-ADDWEGUPR    $IGUPR           OD Unused Prc 8
     C                     MOVELWEHOST    $IHOST           OD MPR Sent to
     C                     MOVELWEHPST    $IHPST           OD MPR Prc Read
     C                     MOVELWEIOST    $IIOST           OD UnUsed Price
     C                     Z-ADDWEPEWG    $IPEWG           Weight Amount E
     C                     Z-ADDWERINY    $IRINY           Item Age Days
     C                     Z-ADDWETIDT    $ITIDT           Production Ovr
     C                     Z-ADDWETJDT    $ITJDT           Production Ovr
     C                     MOVELWEH2ST    $IH2ST           OD Spot Buy
     C                     MOVELWEH0ST    $IH0ST           OD Clm Full Ret
     C                     MOVELWEH1ST    $IH1ST           Order Line Erro
     C                     Z-ADDWETKDT    $ITKDT           OD Market Begin
     C                     Z-ADDWETLDT    $ITLDT           OD Market Endin
     C                     Z-ADDWETMDT    $ITMDT           OD Atch to Ord
     C                     MOVELWEUVST    $IUVST           EDI Status 1
     C                     MOVELWEUWST    $IUWST           EDI Status 2
     C                     MOVELWEUXST    $IUXST           EDI Status 3
     C                     Z-ADDWEAATM    $IAATM           Job Time
     C                     MOVELWEAYNA    $IAYNA           User Id
     C                     MOVELWEA0NA    $IA0NA           Job Name
     C                     Z-ADDWEAXDT    $IAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WEAIC3    WZE001           Company Number
     C                     Z-ADDWEAIC3    WZE001
     C           *LIKE     DEFN WEC4NB    WZE002           Order Number
     C                     Z-ADDWEC4NB    WZE002
     C           *LIKE     DEFN WEHGCD    WZE003           Item Code
     C                     Z-ADDWEHGCD    WZE003
     C           *LIKE     DEFN WEAJCD    WZE004           Warehouse Code
     C                     MOVELWEAJCD    WZE004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@BGWKFW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Company Number
     C                     MOVEL*BLANK    W0EL01  1        Order Number
     C                     MOVEL*BLANK    W0EL02  1        Item Code
     C                     MOVEL*BLANK    W0EL03  1        Warehouse Code
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Company Number
     C                     MOVEL'Y'       W0EL01  1        Order Number
     C                     MOVEL'Y'       W0EL02  1        Item Code
     C                     MOVEL'Y'       W0EL03  1        Warehouse Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WEAIC3    IFNE WZE001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           WEC4NB    IFNE WZE002                     Order Number
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           WEHGCD    IFNE WZE003                     Item Code
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           WEAJCD    IFNE WZE004                     Warehouse Code
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * PRT Traffic Comments PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQKF01           Load ID
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           Load ID
      * Setup key
     C                     Z-ADD$KRMNB    WQKF01           Load ID
      * Establish starting position
     C           KRSF      SETLL@KECPGI                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELKEGXTX    $LGXTX           Comment Line
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KERMNB    WZF001           Load ID
     C                     Z-ADDKERMNB    WZF001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@KECPGI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        Load ID
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           KERMNB    IFNE WZF001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * Prt Load Order Chg Lg PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQKG02           Load ID
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG02           Load ID
      * Setup key
     C                     Z-ADD$CRMNB    WQKG02           Load ID
      * Establish starting position
     C           KRSG      SETLL@LHCPOT                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        Load ID
     C                     MOVEL'Y'       W0GL01  1        Stop/Drop
     C                     MOVEL'Y'       W0GL02  1        Order Number
     C                     MOVEL'Y'       W0GL03  1        Created Date
     C                     MOVEL'Y'       W0GL04  1        Created Time
     C                     MOVEL'Y'       W0GL05  1        Sequence Number
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP02  1
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP03  1
     C                     END
      *
     C           W0GL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP04  1
     C                     END
      *
     C           W0GL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP05  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWFAIC3    $NAIC3           Company Number
     C                     Z-ADDWFRVNB    $NRVNB           Stop/Drop
     C                     Z-ADDWFC4NB    $NC4NB           Order Number
     C                     Z-ADDWFK4DT    $NK4DT           Created Date
     C                     Z-ADDWFA1TM    $NA1TM           Created Time
     C                     Z-ADDWFDXNB    $NDXNB           Sequence Number
     C                     Z-ADDWFRMNB    $NRMNB           Load ID
     C                     MOVELWFUJST    $NUJST           Department Cont
     C                     MOVELWFMNTX    $NMNTX           Change Log Prio
     C                     MOVELWFMOTX    $NMOTX           Change Log New
     C                     MOVELWFRVST    $NRVST           Load Change Typ
     C                     MOVEL*BLANK    $NHLTX           Condition Desc.
     C                     MOVELWFAYNA    $NAYNA           User Id
     C                     MOVELWFA0NA    $NA0NA           Job Name
     C                     MOVELWFBZNA    $NBZNA           Carrier Code
     C                     MOVELWFXMCD    $NXMCD           Carrier Broker
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WFRMNB    WZG001           Load ID
     C                     Z-ADDWFRMNB    WZG001
     C           *LIKE     DEFN WFRVNB    WZG002           Stop/Drop
     C                     Z-ADDWFRVNB    WZG002
     C           *LIKE     DEFN WFC4NB    WZG003           Order Number
     C                     Z-ADDWFC4NB    WZG003
     C           *LIKE     DEFN WFK4DT    WZG004           Created Date
     C                     Z-ADDWFK4DT    WZG004
     C           *LIKE     DEFN WFA1TM    WZG005           Created Time
     C                     Z-ADDWFA1TM    WZG005
     C           *LIKE     DEFN WFDXNB    WZG006           Sequence Number
     C                     Z-ADDWFDXNB    WZG006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@LHCPOT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * select load order change type
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Load Change Type is Order Changes
      *   |- c2    : DB1.Load Change Type is Delete Load Group
      *   '-
     C           WFRVST    IFEQ @CN,007                    *IF
     C           WFRVST    OREQ @CN,008
     C           WFRVST    OREQ @CN,009
     C           WFRVST    OREQ @CN,004
     C           WFRVST    OREQ @CN,006
     C           WFRVST    OREQ @CN,010
     C           WFRVST    OREQ @CN,011
     C           WFRVST    OREQ @CN,012
     C           WFRVST    OREQ @CN,013
     C           WFRVST    OREQ @CN,005
     C           WFRVST    OREQ @CN,014
     C           WFRVST    OREQ @CN,015
     C           WFRVST    OREQ @CN,016
     C           WFRVST    OREQ @CN,017                    *OR
     C           WFRVST    OREQ @CN,018
     C           WFRVST    OREQ @CN,019
     C           WFRVST    OREQ @CN,020
     C           WFRVST    OREQ @CN,021
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        Load ID
     C                     MOVEL*BLANK    W0GL01  1        Stop/Drop
     C                     MOVEL*BLANK    W0GL02  1        Order Number
     C                     MOVEL*BLANK    W0GL03  1        Created Date
     C                     MOVEL*BLANK    W0GL04  1        Created Time
     C                     MOVEL*BLANK    W0GL05  1        Sequence Number
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        Load ID
     C                     MOVEL'Y'       W0GL01  1        Stop/Drop
     C                     MOVEL'Y'       W0GL02  1        Order Number
     C                     MOVEL'Y'       W0GL03  1        Created Date
     C                     MOVEL'Y'       W0GL04  1        Created Time
     C                     MOVEL'Y'       W0GL05  1        Sequence Number
     C                     ELSE
      * Next record - Detect level breaks
     C           WFRMNB    IFNE WZG001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           WFRVNB    IFNE WZG002                     Stop/Drop
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C           WFC4NB    IFNE WZG003                     Order Number
     C           W0GL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL02
     C                     END
     C           WFK4DT    IFNE WZG004                     Created Date
     C           W0GL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL03
     C                     END
     C           WFA1TM    IFNE WZG005                     Created Time
     C           W0GL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL04
     C                     END
     C           WFDXNB    IFNE WZG006                     Sequence Number
     C           W0GL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL05
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP05
     C                     END
      *
     C           W0GL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP04
     C                     END
      *
     C           W0GL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP03
     C                     END
      *
     C           W0GL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP02
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$OFINTTL
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Load Confirmation  PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Load Confirmation  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * USER: On print of first page format
     C                     MOVEL'N'       W0PFM            *Print format
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Job Name CDE of PRT Load Confirmation  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Carrier Code of PRT Load Confirmation  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of PRT Load Confirmation  PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Load Confirmation  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Carrier Code of PRT Load Confirmation  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Load ID of PRT Load Confirmation  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
      * CUR = DB1 By name
     C                     Z-ADDWAAIC3    $DAIC3           Company Number
     C                     Z-ADDWARMNB    $DRMNB           Load ID
     C                     Z-ADDWAT4NB    $DT4NB           Schedule Sequen
     C                     Z-ADDWARPNB    $DRPNB           Total Load Orde
     C                     Z-ADDWAAODT    $DAODT           Scheduled Ship
     C                     Z-ADDWARNNB    $DRNNB           Reefer Temperat
     C                     MOVELWAWTTX    $DWTTX           Seal 4
     C                     MOVELWAWUTX    $DWUTX           Seal 2 Unused
     C                     Z-ADDWATLMI    $DTLMI           Total Load Mile
     C                     MOVELWARNST    $DRNST           LH Carrier Paym
     C                     MOVELWALHOS    $DLHOS           Load Held Over
     C                     MOVELWALHOR    $DLHOR           Load Held Over
     C                     MOVELWAWNTX    $DWNTX           Load Held Over
     C                     MOVELWAOITX    $DOITX           Ocean BOL Numbe
     C                     MOVELWAOJTX    $DOJTX           Express Mail Nu
     C                     Z-ADDWALLDT    $DLLDT           Express Mail Da
     C                     MOVELWALSHG    $DLSHG           Load Shag Flag
     C                     MOVELWAYPST    $DYPST           Load Wash Flag
     C                     Z-ADDWAKNNX    $DKNNX           Pallets Loaded
     C                     Z-ADDWAICWG    $DICWG           Avg Pallet Tare
     C                     Z-ADDWAIDWG    $DIDWG           Tot Pallet Tare
     C                     MOVELWAH9SX    $DH9SX           Load Confirmed
     C                     MOVELWAWOTX    $DWOTX           Load Confirmed
     C                     MOVELWAWPTX    $DWPTX           Hide on WW Load
     C                     MOVELWAWQTX    $DWQTX           Late Billing Em
     C                     MOVELWAWRTX    $DWRTX           Shipping Temp C
     C                     MOVELWAWSTX    $DWSTX           LH Held Over Rs
     C                     MOVELWARVSX    $DRVSX           Multi Company L
     C                     MOVELWARUSX    $DRUSX           Fax Sent to SSI
     C                     MOVELWARWSX    $DRWSX           Schedule Pos Lo
     C                     MOVELWARXSX    $DRXSX           LH Power Only L
     C                     MOVELWARYSX    $DRYSX           MG Created Load
     C                     MOVELWARZSX    $DRZSX           LH Unused Sts 5
     C                     MOVELWAR0SX    $DR0SX           Load U/M
     C                     MOVELWAR1SX    $DR1SX           TPM Shipment St
     C                     MOVELWAR2SX    $DR2SX           LH Unused Sts 8
     C                     MOVELWAR3SX    $DR3SX           LH On-Time Reas
     C                     MOVELWAR4SX    $DR4SX           LH Held Over Re
     C                     Z-ADDWAPYDT    $DPYDT           LH Carrier Paid
     C                     Z-ADDWACKTM    $DCKTM           LH Carrier Paid
     C                     Z-ADDWAPZDT    $DPZDT           LH Last Combo P
     C                     Z-ADDWACLTM    $DCLTM           LH Last Combo P
     C                     Z-ADDWAP0DT    $DP0DT           LPT Load Plan S
     C                     Z-ADDWACMTM    $DCMTM           LPT Load Plan S
     C                     Z-ADDWAP1DT    $DP1DT           TPM Planned Shi
     C                     Z-ADDWACNTM    $DCNTM           LH Unused Time
     C                     Z-ADDWAP2DT    $DP2DT           LH Unused Date
     C                     Z-ADDWACOTM    $DCOTM           LH Unused Time
     C                     Z-ADDWAP3DT    $DP3DT           LH Unused Date
     C                     Z-ADDWACQTM    $DCQTM           LH Unused Time
     C                     Z-ADD$DRNNB    $DPCNX           USR Temperature
     C                     MOVELWAWRTX    $DFRSX           Shipping Temp C
      * Rtv Load Quantity     RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * ** Always use Override miles, if they are entered       E00207
      * ** If override miles is entered, use instead of total load miles
      * CASE: DB1.Override Total Load Miles is Entered
     C           WAK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWAK2DT    $DTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWATLMI    $DTLMI           Total Load Mile
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Detail line. of PRT Load Confirmation  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: DB1.Export Status is Not Yes
     C           WAU2ST    IFEQ *BLANK                     *IF
     C           WAU2ST    OREQ 'N'
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Confirm Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Load ID of PRT Load Confirm Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Print format
     C                     WRITE$FKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Stop/Drop of PRT Load Confirm Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Number of PRT Load Confirm Dtl   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Detail line. of PRT Load Confirm Dtl   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * RTV for Load Reporting RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * Move customer address to screen.
     C                     EXSR UDSUBR                     Move customer a
      * Move special instructions to special comment if spc comment is bl
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Special Comment 1 is equal to blank
      *   |- c2    : WRK.Special Comment 2 is equal to blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUMHNA    IFEQ *BLANK                     *IF
     C           WUMINA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWUB6NA    $GKINA           USR Special Ins
     C                     MOVELWUBYNA    $GN1NA           USR Special Ins
     C                     MOVEL'N'       WN0013           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $GKINA           USR Special Ins
     C                     MOVELWUMHNA    $GKINA           USR Special Ins
     C                     MOVEL*BLANK    $GN1NA           USR Special Ins
     C                     MOVELWUMINA    $GN1NA           USR Special Ins
     C                     MOVELWUB6NA    $GB6NA           Special Instruc
     C                     MOVELWUBYNA    $GBYNA           Special Instruc
     C                     MOVEL'Y'       WN0013           USR Display fie
     C                     END                             *FI
      * ** 02/05/2009 LJB FP1303  Add Delivery P.O.
      * RTV OHE for Ord Entry RT - Order Header Extension  * 
     C                     EXSR SKRVGN
      * C2748:  Changed from RTV Warehouse code RT (rtv index) to new fun
      * S17054 DN 04/06/21-Count Cases as Boxes. Replaced function with
      *   'RTV UM/Whs Code-Add CS RT'.
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
     C                     EXSR SLRVGN
      * ** 9/27/02 Check for Combo for addtl message print on confirmatio
      * RTV Check for Combo    RT - Order Detail  * 
     C                     EXSR SNRVGN
      * **
      * RTV Qty & Wght Schedul RT - Order Detail  * PF3280
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0004           Company Number
     C                     Z-ADD$GC4NB    WL0005           Order Number
     C                     Z-ADDWUCCQT    WL0006           Quantity Schedu
     C                     Z-ADDWUAUWG    WL0007           Weight Schedule
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WUCCQT           Quantity Schedu
     C                     Z-ADDWL0007    WUAUWG           Weight Schedule
     C                     Z-ADDWUCCQT    $GASNX           Quantity Sched
      * Retrieve UOM description
      * CASE: CUR.U/M - Ordered is Mixed
     C           $GAGCD    IFEQ 'MX'                       *IF
     C                     MOVEL*BLANK    $GUCTX           UOM Description
     C                     MOVEL'Mixed'   $GUCTX           UOM Description
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SPRVGN
     C                     MOVELWN0009    $GLMNA           USR City 15
     C                     MOVELWN0010    $GLNNA           USR State 2
      * RTV Deliv. Times       RT - Company Customer  * 
     C                     EXSR SQRVGN
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SRRVGN
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
     C                     EXSR SSRVGN
     C                     Z-ADD$GRVNB    $GTENB           USR Stop
      * ** Retrieve Export Status flag. Test for printing export info.  S
      * RTV Export Status      RT - Order Header TRG  * 
     C                     EXSR STRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $GEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGEIDT
      * Convert LD Unused Date 2 to display format
      * Convert date
     C           1000000   ADD  $GN8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGN8DT
     C                     MOVEL'0'       *IN79
     C           YL0013    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0007    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0008    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WN0013    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Conf Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Load Conf Exp Inst PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Detail line. of PRT Load Conf Exp Inst PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CUR = DB1 By name
     C                     Z-ADDAMAIC3    $HAIC3           Company Number
     C                     Z-ADDAMC4NB    $HC4NB           Order Number
     C                     Z-ADDAMRMNB    $HRMNB           Load ID
     C                     Z-ADDAMRUNB    $HRUNB           Stop/Drop Seque
     C                     MOVELAMXACD    $HXACD           Shipping Line
     C                     MOVELAMHCAA    $HHCAA           OHE Discharge P
     C                     MOVELAMOANA    $HOANA           Port Delv Termi
     C                     Z-ADDAMQWDT    $HQWDT           OHE Sail/Flight
     C                     MOVELAMHBAA    $HHBAA           OHE City
     C                     Z-ADDAMQYDT    $HQYDT           OHE Arrival Dat
     C                     MOVELAMJ0T1    $HJ0T1           OHE Vessel/Airl
     C                     MOVELAMGENY    $HGENY           OHE Voyage/Flig
     C                     MOVELAMJ1T1    $HJ1T1           OHE Booking Num
     C                     MOVELAMJ2T1    $HJ2T1           OHE Container N
     C                     Z-ADDAMQXDT    $HQXDT           OHE Port Cut Da
     C                     MOVELAMHDAA    $HHDAA           OHE Late Delive
     C                     MOVELAMCCTX    $HCCTX           OHE Ship Status
     C                     MOVELAMRLNA    $HRLNA           OHE Comment 1
     C                     MOVELAMRMNA    $HRMNA           OHE Comment 2
     C                     Z-ADDAMGINY    $HGINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    $HGFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    $HGGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    $HGHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    $HHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    $HHFVL           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    $HHGVL           Transload Termi
     C                     Z-ADDAMQZDT    $HQZDT           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    $HQ0DT           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    $HQ1DT           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    $HQ2DT           OHE Actual Ship
     C                     MOVELAMC2TX    $HC2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    $HC3TX           OHE Spot Buy
     C                     MOVELAMC6TX    $HC6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    $HCHTX           OHE Override Ty
     C                     MOVELAMCITX    $HCITX           OHE Backhaul St
     C                     MOVELAMCLTX    $HCLTX           OHE Backhaul ET
     C                     MOVELAMB4TX    $HB4TX           OHE Load Haul T
     C                     MOVELAMCUTX    $HCUTX           OHE Backhaul Ca
     C                     MOVELAMCVTX    $HCVTX           OHE Bookings Co
     C                     MOVELAMB9TX    $HB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    $HJWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    $HITNY           HPB COA Batch N
     C                     MOVELAMLMT1    $HLMT1           Delivery P.O. N
     C                     MOVELAMLWAA    $HLWAA           OHE Intended fo
     C                     MOVELAMFVST    $HFVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    $HF0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    $HF2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    $HF3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    $HJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    $HJVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    $HV3T1           OHE Transload S
     C                     MOVELAMV4T1    $HV4T1           OHE Abs Rate Ov
     C                     MOVELAMV5T1    $HV5T1           OHE Appt Confir
     C                     MOVELAMV6T1    $HV6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    $HV7T1           OHE Backhaul Ch
     C                     MOVELAMV8T1    $HV8T1           OHE Transload C
     C                     MOVELAMV9T1    $HV9T1           OHE Pier Pass I
     C                     MOVELAMWAT1    $HWAT1           OHE Carrier Nm
     C                     MOVELAMWBT1    $HWBT1           OHE Appt Confir
     C                     MOVELAMWCT1    $HWCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    $HWDT1           Letter of Credi
     C                     Z-ADDAMQJNY    $HQJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    $HQKNY           LD Stop/Drop
     C                     Z-ADDAMQLNY    $HQLNY           OHE Unused Numb
     C                     Z-ADDAMP8NY    $HP8NY           OHE Pier Pass F
     C                     Z-ADDAMP9NY    $HP9NY           OHE Port Check
     C                     Z-ADDAMQANY    $HQANY           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    $HQCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    $HQDNY           OHE Load Sched
     C                     Z-ADDAMQENY    $HQENY           Original Appoin
     C                     Z-ADDAMQFNY    $HQFNY           Original Appoin
     C                     Z-ADDAMQGNY    $HQGNY           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    $HQHNY           OHE PowerPro Lo
     C                     Z-ADDAMQINY    $HQINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    $HQMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    $HMYU1           OHE Genset Numb
     C                     MOVELAMJXSC    $HJXSC           OHE Email BOL/S
     C                     MOVELAMJYSC    $HJYSC           OHE Unused Stat
     C                     MOVELAMJZSC    $HJZSC           OHE Unused Stat
     C                     MOVELAMJ0SC    $HJ0SC           OHE Unused Stat
     C                     MOVELAMMZU1    $HMZU1           OHE Unused Text
     C                     MOVELAMM0U1    $HM0U1           OHE Unused Text
     C                     MOVELAMM1U1    $HM1U1           OHE Customer Ve
     C                     MOVELAMM2U1    $HM2U1           OHE Unused Text
     C                     MOVELAMM3U1    $HM3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    $HW5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    $HW6DT           OHE Unused Date
     C                     MOVELAMUVST    $HUVST           EDI Status 1
     C                     MOVELAMUWST    $HUWST           EDI Status 2
     C                     MOVELAMUXST    $HUXST           EDI Status 3
     C                     MOVELAMVSST    $HVSST           Record Status
     C                     Z-ADDAMAATM    $HAATM           Job Time
     C                     MOVELAMAYNA    $HAYNA           User Id
     C                     MOVELAMA0NA    $HA0NA           Job Name
     C                     Z-ADDAMAXDT    $HAXDT           Job Date
      * RTV Carrier Name       RT - Carrier  * 
     C                     EXSR SURVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OHE Sail/Flight Date to display format
      * Convert date
     C           1000000   ADD  $HQWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHQWDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  $HQYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHQYDT
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Load Confirm Dtl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Company Number of PRT Load Confirm Dtl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Order Number of PRT Load Confirm Dtl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print Item Code of PRT Load Confirm Dtl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print Warehouse Code of PRT Load Confirm Dtl  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print hetail line. of PRT Load Confirm Dtl  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL*BLANK    $IOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SVRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $IHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$IHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VIHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of PRT Traffic Comments PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print Load ID of PRT Traffic Comments PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Detail line. of PRT Traffic Comments PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Print format
     C                     WRITE$M1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print Load ID of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Stop/Drop of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Order Number of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP02
     C                     END                             FI
      * Print Created Date of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP03
     C                     END                             FI
      * Print Created Time of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP04
     C                     END                             FI
      * Print Sequence Number of Prt Load Order Chg Lg PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP05
     C                     END                             FI
      * Print Detail line. of Prt Load Order Chg Lg PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CUR.Condition Desc. 1  USR = Condition name of DB1.Load Change Ty
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1463079   Y2LSNO  70       List number
     C                     PARM WFRVST    W0INVL 25        Load Change Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $NHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      *   If Date Change Type, reverse the values
      * CASE: DB1.Load Change Type is Date changes
     C           WFRVST    IFEQ @CN,004                    *IF
     C           WFRVST    OREQ @CN,005
     C           WFRVST    OREQ @CN,006
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMNTX:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMNTX:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMNTX:ZQ WUT6TX    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  WUT6TX:ZQ WUZ7TX    P      Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUEZTX:ZQ $NMNTX    P      Change Log Prio
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMOTX:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMOTX:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWFMOTX:ZQ WUT6TX    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  WUT6TX:ZQ WUZ7TX    P      Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUEZTX:ZQ $NMOTX    P      Change Log New
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $NC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$NC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VNC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VNC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Created Date to display format
      * Convert date
     C           1000000   ADD  $NK4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VNK4DT
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$NCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$NDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0APDT    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Load Confirmation  PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Job Name CDE of PRT Load Confirmation  PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Carrier Code of PRT Load Confirmation  PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Confirmation  PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Confirmation  PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Carrier Code of PRT Load Confirmation  PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Load Confirmation  PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  5         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Confirmation  PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Confirm Dtl   PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Load Confirm Dtl   PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Stop/Drop of PRT Load Confirm Dtl   PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Load Confirm Dtl   PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Confirm Dtl   PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD12        W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Conf Exp Inst PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Conf Exp Inst PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load Conf Exp Inst PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD9         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load Confirm Dtl  PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load Confirm Dtl  PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Load Confirm Dtl  PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of PRT Load Confirm Dtl  PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of PRT Load Confirm Dtl  PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * hetail line. of PRT Load Confirm Dtl  PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD1         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Traffic Comments PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Traffic Comments PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Traffic Comments PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Load Order Chg Lg PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Load ID of Prt Load Order Chg Lg PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Stop/Drop of Prt Load Order Chg Lg PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Load Order Chg Lg PO
     C           W0GP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Created Date of Prt Load Order Chg Lg PO
     C           W0GP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Created Time of Prt Load Order Chg Lg PO
     C           W0GP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Sequence Number of Prt Load Order Chg Lg PO
     C           W0GP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Load Order Chg Lg PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * ** Print all on top of page                  E00111 06/01/2009
      * ** Print Load Str Co. message at top
      * RTV Load Str Company  RT - Load Header  * 
     C                     EXSR SCRVGN
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SDRVGN
      * ** Set flags to non-display "Revised" & Change Log text
     C                     MOVEL'N'       YL0001           Print (Yes/No)
     C                     MOVEL'N'       YL0002           Print Yes/No
     C                     MOVEL'0'       YL0003           Print On Form
      * ** Faxing and Fax Status routine
      * CASE: PAR.Fax/Print Flag is Fax processing
     C           P2UQST    IFEQ 'F'                        *IF
      * RTV Load Conf Fax Sts  RT - Load Header  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * If Fax Sts is yes, the fax has been sent at least once, so print
      * CASE: LCL.Load Confirmation Fax Sts is Yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0001           Print (Yes/No)
      * ** Print REVISED, print condition name of the last
      * ** change log entry
     C                     MOVEL@CN,002   $BNLTX           USR 15 Text
      * RTV Last Entry for LoadRT - Load Order Change Log  * 
     C                     EXSR SFRVGN
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
      * ** Control print of text - Don't print text for internal changes
      * CASE: WRK.Department Control Code is Internal Control
     C           WUUJST    IFEQ 'INT'                      *IF
     C                     MOVEL'N'       YL0002           Print Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0002           Print Yes/No
      * TOP.Condition Desc. 1  USR = Condition name of WRK.Load Change Ty
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1463079   Y2LSNO  70       List number
     C                     PARM WURVST    W0INVL 25        Load Change Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       YL0003           Print On Form
     C                     MOVEL'Y2U0005' YL0005           *Return code
     C                     END                             *FI
     C                     END                             *FI
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0001    P      Carrier Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BKMNA    P      Name
     C                     MOVELWL0003    YL0006    P      Record Status
     C                     MOVEL'0'       *IN79
     C           YL0003    IFEQ '0'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load Str Company  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDLNRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAIC3           Company Number
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    WUAIC3           Company Number
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWUAIC3    KMAIC3           Company Number
     C                     MOVEL@CN,001   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    $BHETX           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Conf Fax Sts  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDLNRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Load Confirmati
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRPST    YL0004           Load Confirmati
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Last Entry for LoadRT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN LHRMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADDLNRMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@LHCPQY                    *
     C           KRSSF     READE@LHCPQY                  90*
      * Data record not found
     C   90                MOVEL'USR2471' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELLHRVST    WURVST           Load Change Typ
     C                     MOVELLHUJST    WUUJST           Department Cont
     C           KRSSF     READE@LHCPQY                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0001    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSG     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     MOVEL*BLANK    WL0003           Record Status
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0002           Name
     C                     MOVELFFVSST    WL0003           Record Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Load Quantity     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSH01           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    WQSH01           Load ID
      * Establish starting position
     C           KRSSH     SETLL@BFCPR0                    *
     C           KRSSH     READE@BFCPR0                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Qty & Wght Schedul RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0004           Company Number
     C                     Z-ADDBEC4NB    WL0005           Order Number
     C                     Z-ADDYL0007    WL0006           Quantity Schedu
     C                     Z-ADDYL0008    WL0007           Weight Schedule
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0007           Quantity Schedu
     C                     Z-ADDWL0007    YL0008           Weight Schedule
     C                     ADD  YL0007    $DQS01           Quantity Schedu
     C           KRSSH     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Qty & Wght Schedul RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0006           Quantity Schedu
     C                     Z-ADD*ZERO     WL0007           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWL0004    WQSI01           Company Number
     C                     Z-ADDWL0005    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKZL                    *
     C           KRSSI     READE@BGWKZL                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
     C                     ADD  OMCCQT    WL0006           Quantity Schedu
     C                     ADD  OMAUWG    WL0007           Weight Schedule
     C                     END                             *FI
     C           KRSSI     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV for Load Reporting RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WBAIC3           Company Number
     C                     Z-ADD$GC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBKC7    WN0004           Ship To Custome
     C                     MOVELWBBRTX    $GBRTX           Ship To Name
     C                     MOVELWBHMNA    WN0006           Ship To Address
     C                     MOVELWBHONA    WN0007           Ship To Address
     C                     MOVELWBHPNA    WN0008           Ship To Address
     C                     MOVELWBHNNA    WN0009           Ship To City
     C                     MOVELWBDBCD    WN0010           Ship To State C
     C                     MOVELWBCKTX    WN0011           Ship To Zip/Pos
     C                     MOVELWBBCNA    $GBCNA           Customer Purcha
     C                     MOVELWBB6NA    WUB6NA           Special Instruc
     C                     MOVELWBBYNA    WUBYNA           Special Instruc
     C                     Z-ADDWBA1WG    $GLLNA           Order Weight To
     C                     Z-ADDWBEIDT    $GEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    $GAFTM           Requested Deliv
     C                     MOVELWBMHNA    WUMHNA           Special Comment
     C                     MOVELWBMINA    WUMINA           Special Comment
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV OHE for Ord Entry RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    AMAIC3           Company Number
     C                     Z-ADD$GC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $GLMT1           Delivery P.O. N
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMLMT1    $GLMT1           Delivery P.O. N
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0010           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSL02           Order Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQSL01           Company Number
     C                     Z-ADD$GC4NB    WQSL02           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
      * Establish starting position
     C           KPSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $GCPCD           Warehouse Code
     C                     MOVEL*BLANK    $GAGCD           USR Unit of Mea
     C                     GOTO SLEXIT                     *QUIT
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELWCAJCD    $GCPCD           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           WCAGCD    IFEQ 'CB'                       *IF
     C           WCAGCD    OREQ 'BX'                       *OR
     C           WCAGCD    OREQ 'MX'                       *OR
     C           WCAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           WCGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/06/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/06/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWCAGCD    YL0011           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0011    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0011           U/M - Ordered
     C                     END                             *FI
      * Sum for later check
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0011    IFEQ 'BX'                       *IF
     C                     ADD  WCAVQT    YL0010           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           $GAGCD    IFEQ *BLANK                     *IF
     C                     MOVELYL0011    $GAGCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0011    IFEQ $GAGCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    $GAGCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           $GAGCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0008           Company Number
     C                     MOVEL'BOXLOAD' WL0009    P      Company Value C
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    YL0012           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0010    IFLT YL0012                     *IF
     C                     MOVEL'CB'      $GAGCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      $GAGCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0008    KMAIC3           Company Number
     C                     MOVELWL0009    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSM     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0010           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Check for Combo    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WQSN01           Company Number
     C                     Z-ADD$GC4NB    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@BGWKL1                    *
     C           KRSSN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WCGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.U/M - Ordered is Combos
     C           WCAGCD    IFEQ 'CB'                       *IF
     C                     MOVEL'Y'       YL0009           Status Flag 1
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WDHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL$GAGCD    WDHHCD           U/M - Primary D
      * Establish starting position
     C           KRSSO     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $GUCTX           Description
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWDAUNA    $GUCTX           Description
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$GCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $GF8NA           Warehouse Descr
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    $GF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Deliv. Times       RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$GAIC3    EOAIC3           Company Number
     C                     Z-ADDWN0004    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSQ     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOR4CD    WUR4CD           Sales Route Cod
     C                     Z-ADDEOR5NB    $GR5NB           Deliver after t
     C                     Z-ADDEOR6NB    $GR6NB           Deliver before
     C                     Z-ADDEOMTCU    $GRWNB           Mileage To Cust
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWN0004    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSR     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $GCDTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$GAIC3    NIAIC3           Company Number
     C                     Z-ADDWN0004    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           Print Req Delv
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNIHLST    YL0013           Print Req Delv
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Export Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUU2ST           Export Status
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    WBAIC3           Company Number
     C                     Z-ADD$GC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBU2ST    WUU2ST           Export Status
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$HXACD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSU     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HJNNA           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $HJNNA           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD$IHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSV     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $IOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    $IOONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWDLRC    BEGSR
      *================================================================
      * DLT PD Load Confirmati DL - Load Confirmation Work  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LNCPPB
     C                     MOVEL$CB2VN    WGB2VN           Job Name CDE
     C                     MOVEL$CBZNA    WGBZNA           Carrier Code
     C                     Z-ADD$CRMNB    WGRMNB           Load ID
      *
     C           KLDLSW    KLIST
     C                     KFLD           WGB2VN           Job Name CDE
     C                     KFLD           WGBZNA           Carrier Code
     C                     KFLD           WGRMNB           Load ID
     C           KLDLSW    CHAIN@LNCPPB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLNCPL0'MDACP
     C                     MOVEL'@LNCPPB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LNCPPB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Confirmation  PO
      *================================================================
      * CASE: LCL.*Return code is *Record does not exist
     C           YL0005    IFEQ @CN,003                    *IF
     C                     GOTO UAEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0001 30        Name
     C                     MOVEL*BLANK    WN0002 30        Ship Via - Carr
      *
      * PRT Load Confirmation  PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 05/20/2011 RMC E01488 Print appt conf info
      * *****
      * ** 02/05/2009 LJB FP1303  Add Delivery P.O.
      * *****
      * ** 08/12/2008 LJB E00207
      * ** Always use Override miles, if they are entered to print on the
      * ** load miles field, otherwise, use the total load miles
      * *****
      * ** 04/26/2007 LJB FP1101
      * ** All Export Instruction processing has been moved to the
      * ** Order Header Extension file print object
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Confirm Dtl   PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  70       Order Number
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     MOVEL*BLANK    WN0005 30        Ship To Name
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 30        Ship To Address
     C                     MOVEL*BLANK    WN0009 20        Ship To City
     C                     MOVEL*BLANK    WN0010  2        Ship To State C
     C                     MOVEL*BLANK    WN0011 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0012 15        Customer Purcha
     C                     MOVEL*BLANK    WN0013  1        USR Display fie
      *
      * PRT Load Confirm Dtl   PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Move customer address to screen.
      *================================================================
     C                     MOVELWN0006    $GHMNA           Ship To Address
     C                     MOVELWN0007    $GHONA           Ship To Address
     C                     MOVELWN0008    $GHPNA           Ship To Address
     C                     MOVELWN0011    $GCKTX           Ship To Zip/Pos
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Conf Exp Inst PO
      *================================================================
      * ** Only print export fields if export status is "Y"es.  S00693
      * CASE: WRK.Export Status is Not Yes
     C           WUU2ST    IFEQ *BLANK                     *IF
     C           WUU2ST    OREQ 'N'
     C                     GOTO UEEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load Conf Exp Inst PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load Confirm Dtl  PO
      *================================================================
      * CASE: PAR.Load Type is *Not Bulk
     C           $EVDST    IFEQ *BLANK                     *IF
     C           $EVDST    OREQ 'R'
     C                     GOTO UFEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load Confirm Dtl  PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Traffic Comments PO
      *================================================================
      * PRT Traffic Comments PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Load Order Chg Lg PO
      *================================================================
      * ** If delete load, print delete load group so traffic will
      * ** be able to validate all details.                     E000722
      * Prt Load Order Chg Lg PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Load Confirmation  PO: Initialise
      *================================================================
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT Load Confirm Dtl   PO: Initialise
      *================================================================
      * USER: Initialize program
      * Will be yes if a Combo order exists on the load.
     C                     MOVEL'N'       YL0009           Status Flag 1
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * PRT Load Conf Exp Inst PO: Initialise
      *================================================================
      * USER: Initialize program
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    LNB2VN           Job Name CDE
     C                     MOVEL*LOVAL    LNBZNA           Carrier Code
     C                     MOVEL*LOVAL    LNRMNB           Load ID
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WABZNA           Carrier Code
     C                     MOVEL*LOVAL    WARMNB           Load ID
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*HIVAL    FLRVNB           Stop/Drop
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field Special Instructions
     C                     MOVEL*BLANK    WUB6NA 40
      * Define work field Special Instructions 2
     C                     MOVEL*BLANK    WUBYNA 40
      * Define work field Special Comment 1
     C                     MOVEL*BLANK    WUMHNA 30
      * Define work field Special Comment 2
     C                     MOVEL*BLANK    WUMINA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field Quantity Scheduled
     C                     Z-ADD*ZERO     WUCCQT 112
      * Define work field Weight Scheduled
     C                     Z-ADD*ZERO     WUAUWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Sales Route Code
     C                     MOVEL*BLANK    WUR4CD  3
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AMAIC3           Company Number
     C                     MOVEL*LOVAL    AMC4NB           Order Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WEAIC3           Company Number
     C                     MOVEL*LOVAL    WEC4NB           Order Number
     C                     MOVEL*LOVAL    WEHGCD           Item Code
     C                     MOVEL*LOVAL    WEAJCD           Warehouse Code
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field USR Weight 9
     C                     Z-ADD*ZERO     WULLNA  90
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KERMNB           Load ID
     C                     MOVEL*LOVAL    KEDXNB           Sequence Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFK4DT           Created Date
     C                     Z-ADD*ZERO     WFA1TM           Created Time
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WFRMNB           Load ID
     C                     MOVEL*LOVAL    WFRVNB           Stop/Drop
     C                     MOVEL*LOVAL    WFC4NB           Order Number
     C                     MOVEL*LOVAL    WFK4DT           Created Date
     C                     MOVEL*LOVAL    WFA1TM           Created Time
     C                     MOVEL*LOVAL    WFDXNB           Sequence Number
      * Define work field USR Work Field 3A
     C                     MOVEL*BLANK    WUEZTX  3
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009 10
     C                     Z-ADD*ZERO     WL0010 155
      * Define local work field Print (Yes/No) USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Print Yes/No          USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Print On Form
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Print Req Delv Tm on Docs
     C                     MOVEL*BLANK    YL0013  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     Z-ADD*ZERO     WUCNTU           Count USR
     C                     MOVEL'N'       WUGGST           USR Display fie
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SHIPFRMMSG
00002 *** REVISED ***
00003 Y2U0005
00004 RQSDLV
00005 RQSSHP
00006 SCHSHP
00007 CANORD
00008 CHGWHS
00009 LODTYP
00010 SHPCST
00011 SHPMTH
00012 DELORD
00013 DEADLN
00014 ADDSTP
00015 CHGSTP
00016 CHGLCO
00017 DELOAD
00018 DELCAR
00019 DELCST
00020 DELSSD
00021 DELTRL
