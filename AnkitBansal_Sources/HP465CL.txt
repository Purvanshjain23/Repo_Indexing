/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  HP465CL                                       */
/*  PROGRAM NAME:    PURGE                                         */
/*  PROGRAMMER:      LEANNE FEDOR                                  */
/*  CREATE DATE:     05/22/97                                      */
/*                                                                 */
/*  FUNCTION:  THIS CL IS SUBMITTED FROM:                          */
/*             1) HP465-SPECIFY OPTIONS FOR PURGE                  */
/*                                                                 */
/*******************************************************************/
/* MODIFICATIONS                                                   */
/*                                                                 */
/* 02/14/08  LEANNE RAMSEY                                         */
/*           TO DATE, WE HAVE NEVER PURGED--AND STAYED PURGED.     */
/*           WE ARE REWRITING OUR LOGIC IN ANTICIPATION OF PURGING.*/
/*           SINCE LEE C. REORGS THE FILES EACH MONTH, WE WILL NOT */
/*           REORG HERE.                                           */
/*                                                                 */
/* 04/07/09  LEANNE RAMSEY                                         */
/*           REMOVED LOGIC FOR HSP088-FARM DEATHS WITH REASONS;    */
/*           WE NO LONGER HAVE THIS FILE.                          */
/*******************************************************************/

             PGM        PARM(&NEEDDATE)
             DCL        VAR(&NEEDDATE) TYPE(*CHAR) LEN(1)

/*-------------------------------------------------------------------*/
/* Conditionally call the program to calc the Purge Date/Year/Period */
/*-------------------------------------------------------------------*/

             IF         COND(&NEEDDATE *EQ 'Y') THEN(DO)
             CALL       PGM(HP962)
             ENDDO

/*-----------------------------------------------------------------*/
/* Before deleting a record, we will write it to its purge file in */
/* the HPS purge library. So, clear the library and dup the files. */
/*-----------------------------------------------------------------*/

             ADDLIBLE   LIB(PRGHPSF)
             MONMSG     MSGID(CPF0000)
             CLRLIB     LIB(PRGHPSF)

             CRTDUPOBJ  OBJ(HSP033) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP033PR)

             CRTDUPOBJ  OBJ(HSP034) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP034PR)

             CRTDUPOBJ  OBJ(HSP037) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP037PR)

             CRTDUPOBJ  OBJ(HSP038) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP038PR)

             CRTDUPOBJ  OBJ(HSP039) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP039PR)

             CRTDUPOBJ  OBJ(HSP047) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP047PR)

             CRTDUPOBJ  OBJ(HSP048) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP048PR)

             CRTDUPOBJ  OBJ(HSP055) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP055PR)

             CRTDUPOBJ  OBJ(HSP058) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP058PR)

             CRTDUPOBJ  OBJ(HSP059) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP059PR)

             CRTDUPOBJ  OBJ(HSP063) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP063PR)

             CRTDUPOBJ  OBJ(HSP064) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP064PR)

             CRTDUPOBJ  OBJ(HSP065) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP065PR)

             CRTDUPOBJ  OBJ(HSP068) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP068PR)

             CRTDUPOBJ  OBJ(HSP069) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP069PR)

             CRTDUPOBJ  OBJ(HSP074) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP074PR)

             CRTDUPOBJ  OBJ(HSP075) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP075PR)

             CRTDUPOBJ  OBJ(HSP078) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP078PR)

             CRTDUPOBJ  OBJ(HSP080) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP080PR)

             CRTDUPOBJ  OBJ(HSP081) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP081PR)

             CRTDUPOBJ  OBJ(HSP082) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP082PR)

             CRTDUPOBJ  OBJ(HSP084) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP084PR)

             CRTDUPOBJ  OBJ(HSP085) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP085PR)

             CRTDUPOBJ  OBJ(HSP086) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP086PR)

             CRTDUPOBJ  OBJ(HSP092) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP092PR)

             CRTDUPOBJ  OBJ(HSP093) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP093PR)

             CRTDUPOBJ  OBJ(HSP102) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP102PR)

             CRTDUPOBJ  OBJ(HSP103) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP103PR)

             CRTDUPOBJ  OBJ(HSP118) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP118PR)

             CRTDUPOBJ  OBJ(HSP120) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP120PR)

             CRTDUPOBJ  OBJ(HSP188) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP188PR)

             CRTDUPOBJ  OBJ(HSP189) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP189PR)

             CRTDUPOBJ  OBJ(HSP192) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP192PR)

             CRTDUPOBJ  OBJ(HSP193) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(PRGHPSF) NEWOBJ(HSP193PR)

/*------------------------------------------------------------------*/
/* Create workfiles to hold groups that pass the group purge edits  */
/*------------------------------------------------------------------*/

             CRTDUPOBJ  OBJ(HSP364) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(HSP365) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

             CRTDUPOBJ  OBJ(HSL365A) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)

/*-----------------------------------------------------------------*/
/* Call the program to delete/void old groups that still have a    */
/* status of 'CREATED'.                                            */
/*-----------------------------------------------------------------*/

             CALL       PGM(HP963)

/*-----------------------------------------------------------------*/
/* Call the Purge Program for Individual files.                    */
/*-----------------------------------------------------------------*/

             CALL       PGM(HP964)

/*-----------------------------------------------------------------*/
/* Call the Purge Edit program to determine which Voided/Closed    */
/* groups are eligible for purging.                                */
/*-----------------------------------------------------------------*/

             CALL       PGM(HP965)

/*-----------------------------------------------------------------*/
/* Call the Purge program to purge Closed/Voided Hog Groups that   */
/* passed the edits.                                               */
/*-----------------------------------------------------------------*/

             CALL       PGM(HP966)

/*-----------------------------------------------------------------*/
/* Remove the Purge library                                        */
/*-----------------------------------------------------------------*/

             RMVLIBLE   LIB(PRGHPSF)
             MONMSG     MSGID(CPF0000)

             ENDPGM

