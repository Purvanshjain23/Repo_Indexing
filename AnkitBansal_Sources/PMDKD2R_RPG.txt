     H/TITLE Dsp Customer/Co Cust  D2  Display record(2 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Display DBF file records, one at a time
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display record(2 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISELOUC
     H* Date          : 04/27/23  Time  : 10:25:31
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMDKD2R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Dsp Customer/Co Cust  D2  Display record(2 screen)
      *
     FCABBREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FCAECREL1IF  E           K        DISK
      * RTV : County Master             Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country                   Retrieval index
      *
     FPMDDREL1IF  E           K        DISK
      * RTV : Sales Market              Retrieval index
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FPUAAREL1IF  E           K        DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FPUB6CPL1IF  E           K        DISK
      * RTV : Pallet Master             Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDLUREL1IF  E           K        DISK
      * RTV : Destination-Zone          Retrieval index
      *
     FOMGZCPL1IF  E           K        DISK
      * RTV : Company Customer Credit   Retrieval index
      *
     FCAAOREL0IF  E           K        DISK
      * RTV : Terms                     Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FPDJXREL2IF  E           K        DISK
      * RTV : Customer Group Master     Active Customer Group
      *
     FCAAJREL1IF  E           K        DISK
      * RTV : Type Codes                Retrieval index       NV
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : Commodity Markets         Retrieval index
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  02  6   @CN    25
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  31 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  31 INSCR2
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Customer
      * I : RST Ship To Customer
     I                                    P   1   40P1BKC7
      * N :  AR Customer Number
     I                                    P   5   80P1ANC7
      * N :  Parent Customer
     I                                    P   9  120P1BTC7
      * N :  Order Entry Hold
     I                                       13  13 P1QNST
      * N :  Record Status
     I                                       14  14 P1VSST
     IP2PARM      DS
      * FLD: User Profile Control
      * N :  User Profile Name
     I                                        1  10 P2AJVN
      * N :  System Date Format
     I                                       11  13 P2B8NA
      * N :  Company Number
     I                                    P  14  150P2AIC3
     IP3PARM      DS
      * FLD: *Arrays
      * N :  USR Formula Meth Type Sts
     I                                        1   1 P3YKST
      * N :  USR Market Meth Type Sts
     I                                        2   2 P3YLST
      * N :  USR Manual Meth Type Sts
     I                                        3   3 P3YMST
      * N :  USR Extend Meth Type Sts
     I                                        4   4 P3YNST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  USR Check Y/N Status
     I                                        1   1 P4JDST
      * N :  USR Customer/Vendor Code
     I                                    P   2   60P4ATC8
      * N :  USR Search Request
     I                                        7   7 P4ELST
      * N :  USR Update Flag
     I                                        8   8 P4R4ST
      * N :  USR Hold A/R Credit Limit
     I                                    P   9  142P4YBVA
      * N :  USR Hold Parent Credit L
     I                                    P  15  202P4YAVA
      * N :  USR Tot. Due W/O CB
     I                                    P  21  262P4WBVA
      * N :  USR Return Code
     I                                       27  27 P4N7CD
      * N :  USR Parent Total Due
     I                                    P  28  332P4YIVA
      * N :  USR Order Entry Hold
     I                                       34  34 P4RWST
      * N :  USR Order Entry Hold Date
     I                                    P  35  380P4K5DT
     IP5PARM      DS
      * FLD: Customer EXT
      * N : MAP Internet Password
     I                                        1  10 P5UFTX
      * N : MAP Email Address
     I                                       11  60 P5UGTX
      * N :  EDI Trading Partner No.
     I                                       61  66 P5J5NX
      * N :  EDI Cust Duns Number
     I                                       67  86 P5U5TX
      * N :  EDI Warehouse/Store No.
     I                                       87 106 P5U6TX
      * N :  State Tax ID
     I                                      107 126 P5W0TX
      * N :  Cust Shipping Temp C/F
     I                                      127 127 P5HSSX
      * N :  One Invoice Per PO
     I                                      128 128 P5HUSX
      * N :  EDI Advanced Ship Notice
     I                                      129 129 P5HVSX
     IP6PARM      DS
      * FLD: Company Customer
      * N : MAP Terms Code
     I                                        1   2 P6AQCD
      * N : MAP Sales Route Code
     I                                        3   5 P6R4CD
      * N : MAP Special Instructions 2
     I                                        6  45 P6BYNA
      * N : MAP Special Instructions
     I                                       46  85 P6B6NA
      * N : MAP Carrier Code
     I                                       86  88 P6BZNA
      * N : MAP Broker
     I                                       89  89 P6LLST
      * N : MAP P.O. Required Flag
     I                                       90  90 P6PPST
      * N : MAP Deliver after time
     I                                    P  91  930P6R5NB
      * N : MAP Deliver before time
     I                                    P  94  960P6R6NB
      * N : MAP Alt Remittance Flag
     I                                       97  97 P6QGST
      * N : MAP Type Code
     I                                       98  99 P6BOCD
      * N : MAP Absorbed Freight Rate CWT
     I                                    P 100 1022P6TBNB
      * N : MAP Mileage To Customer
     I                                    P 103 1072P6MTCU
      * N : MAP Co/Cust Overage Rate CWT
     I                                    P 108 1132P6W2NB
      * N : MAP Age Code
     I                                      114 114 P6RPCD
      * N : MAP Warehouse Code
     I                                      115 117 P6AJCD
      * N : MAP Outside Warehouse Flag
     I                                      118 118 P6X9ST
      * N : MAP Customer Group Code
     I                                      119 121 P6T9CD
      * N : MAP Customer Group Code 2
     I                                      122 124 P6UBCD
      * N : MAP G/L Code
     I                                      125 132 P6ISTX
      * N : MAP Commodity Market Code
     I                                      133 135 P6LQCD
      * N : MAP Credit Contact Name
     I                                      136 165 P6NJNA
      * N : MAP Credit Contact Telephone
     I                                      166 190 P6I0TX
      * N : MAP Credit Contact Bus. Title
     I                                      191 220 P6NKNA
      * N : MAP Credit Contact Fax Number
     I                                      221 245 P6I1TX
      * N : MAP Allow Man/Qt WO/Approval
     I                                      246 246 P6VLST
      * N : MAP Fax Invoice Flag
     I                                      247 247 P6RLST
      * N : MAP Fax Invoice Fax Number
     I                                      248 272 P6MMTX
      * N : MAP Fax Invoice Contact Name
     I                                      273 302 P6OHNA
      * N : MAP Distributor
     I                                      303 303 P6Q6ST
      * N : MAP Default Shipping Co Sts
     I                                      304 304 P6Q8ST
      * N : MAP Ord Ent Default Sls Rte
     I                                      305 305 P6RBST
      * N : MAP Bypass DDt/Delay w/Invcng
     I                                      306 306 P6REST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0001
      * Application Code
     I                                       11  16 ZA0002
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BKC7    PARM           WP0001  70       Ship To Custome
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KRTV      CHAIN@BBREE9              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, then signal error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Load detail screen from DBF record
      * Customer Rules for Existing Customer for DTL screen
     C                     EXSR UASUBR                     Customer Rules
      * Get the Company Customer for Company
     C                     EXSR UBSUBR                     Get the Company
      * DTL.Reg Fax/Email Sts DescUsr = Condition name of DTL.Regional Mg
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1717257   Y2LSNO  70       List number
     C                     PARM #DP1SX    W0INVL 25        Regional Mgr Fa
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6T1    PARM           W0CNNM 25        Reg Fax/Email S
      *
      * 2ND.TF Exempt Code Desc Usr = Condition name of 2ND.Customer TF E
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1745570   Y2LSNO  70       List number
     C                     PARM #DP3SX    W0INVL 25        Customer TF Exe
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHET1    PARM           W0CNNM 25        TF Exempt Code
      *
      * 2ND.Condition Desc. 1  USR = Condition name of 2ND.One Invoice Pe
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1506876   Y2LSNO  70       List number
     C                     PARM #DHUSX    W0INVL 25        One Invoice Per
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Only display Field Managed description if flag is entered   E0040
      * CASE: DB1.Field vs. In-House flag is Managed Flag
     C           BBRKST    IFEQ 'F'                        *IF
     C           BBRKST    OREQ 'I'
      * 2ND.Description 21a 4 Usr = Condition name of DB1.Field vs. In-Ho
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1462357   Y2LSNO  70       List number
     C                     PARM BBRKST    W0INVL 25        Field vs. In-Ho
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DG3T1    PARM           W0CNNM 25        Description 21a
      *
     C                     END                             *FI
     C                     END
      *
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
      * Select existing record
     C                     EXSR VACKRL
      * Ship To Customer required
     C           #1BKC7    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEL'2'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD2         W0SCR
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD1         W0SCR
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C                     MOVEL'Y'       W0TRN
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR2    IFNE *ZEROS
     C                     Z-ADD2         W0SCR
     C                     END
     C           INSCR1    IFNE *ZEROS
     C                     Z-ADD1         W0SCR
     C                     END
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MEIZ#1
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1BKC7    IFEQ *ZERO                      Ship To Custome
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     END
     C           W0SCR     IFNE 2
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     END
     C           W0SCR     IFEQ 2
     C                     END
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVELP6AQCD    #PAQCD           Terms Code
     C                     MOVELP6R4CD    #PR4CD           Sales Route Cod
     C                     MOVELP6BYNA    #PBYNA           Special Instruc
     C                     MOVELP6B6NA    #PB6NA           Special Instruc
     C                     MOVELP6BZNA    #PBZNA           Carrier Code
     C                     MOVELP6LLST    #PLLST           Broker
     C                     MOVELP6PPST    #PPPST           P.O. Required F
     C                     Z-ADDP6R5NB    #PR5NB           Deliver after t
     C                     Z-ADDP6R6NB    #PR6NB           Deliver before
     C                     MOVELP6QGST    #PQGST           Alt Remittance
     C                     MOVELP6BOCD    #PBOCD           Type Code
     C                     Z-ADDP6TBNB    #PTBNB           Absorbed Freigh
     C                     Z-ADDP6MTCU    #PMTCU           Mileage To Cust
     C                     Z-ADDP6W2NB    #PW2NB           Co/Cust Overage
     C                     MOVELP6RPCD    #PRPCD           Age Code
     C                     MOVELP6AJCD    #PAJCD           Warehouse Code
     C                     MOVELP6X9ST    #PX9ST           Outside Warehou
     C                     MOVELP6T9CD    #PT9CD           Customer Group
     C                     MOVELP6UBCD    #PUBCD           Customer Group
     C                     MOVELP6ISTX    #PISTX           G/L Code
     C                     MOVELP6LQCD    #PLQCD           Commodity Marke
     C                     MOVELP6NJNA    #PNJNA           Credit Contact
     C                     MOVELP6I0TX    #PI0TX           Credit Contact
     C                     MOVELP6NKNA    #PNKNA           Credit Contact
     C                     MOVELP6I1TX    #PI1TX           Credit Contact
     C                     MOVELP6VLST    #PVLST           Allow Man/Qt WO
     C                     MOVELP6RLST    #PRLST           Fax Invoice Fla
     C                     MOVELP6MMTX    #PMMTX           Fax Invoice Fax
     C                     MOVELP6OHNA    #POHNA           Fax Invoice Con
     C                     MOVELP6Q6ST    #PQ6ST           Distributor
     C                     MOVELP6Q8ST    #PQ8ST           Default Shippin
     C                     MOVELP6RBST    #PRBST           Ord Ent Default
     C                     MOVELP6REST    #PREST           Bypass DDt/Dela
     C                     MOVEL*BLANK    #1ABTX           Alpha Search
     C                     MOVEL*BLANK    #DFXSX           HPB Ship to War
     C                     MOVEL*BLANK    #DDET1           Broker Name DRV
     C                     MOVEL*BLANK    #1CBST           New Customer St
     C                     Z-ADD*ZERO     #1P3NB           D & B Number
     C                     MOVEL*BLANK    #1LTCD           EDI Invoice Sts
     C                     MOVEL*BLANK    #1RKST           Field vs. In-Ho
     C                     MOVEL*BLANK    #1QXST           Print Invoice S
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1ANC7           AR Customer Num
      * Clear external version also
     C                     MOVEL*BLANK    V1ANC7
     C                     MOVEL*BLANK    #DC0TX           USR A/R Custome
     C                     MOVEL*BLANK    #1AYTX           Customer Name
     C                     Z-ADD*ZERO     #1BTC7           Parent Customer
      * Clear external version also
     C                     MOVEL*BLANK    V1BTC7
     C                     MOVEL*BLANK    #DC1TX           USR Bill To Cus
     C                     MOVEL*BLANK    #1ACNA           Address Line 1
     C                     MOVEL*BLANK    #1K6ST           Credit Check AR
     C                     MOVEL*BLANK    #1UZST           Credit Check Pa
     C                     MOVEL*BLANK    #1ADNA           Address Line 2
     C                     MOVEL*BLANK    #1UNCS           Statement Print
     C                     MOVEL*BLANK    #DI6TX           Description 14A
     C                     MOVEL*BLANK    #1AENA           Address Line 3
     C                     Z-ADD*ZERO     #1VHVA           AR Credit Limit
     C                     MOVEL*BLANK    #1AJNA           City
     C                     Z-ADD*ZERO     #1S2NB           Parent Credit L
     C                     MOVEL*BLANK    #1BGCD           State Code
     C                     MOVEL*BLANK    #DHSNA           State Descripti
     C                     MOVEL*BLANK    #1B0NA           SIC Number
     C                     MOVEL*BLANK    #1G5CD           County Code
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     MOVEL*BLANK    #1AXNA           D & B Rating
     C                     MOVEL*BLANK    #1KXCD           Country Code
     C                     MOVEL*BLANK    #DDATX           Country Descrip
     C                     Z-ADD*ZERO     #1I6DT           Date of D & B R
      * Clear external version also
     C                     Z-ADD*ZERO     V1I6DT
     C                     MOVEL*BLANK    #1BTTX           Zip Postal Code
     C                     Z-ADD*ZERO     #1AYDT           Credit Line Exp
      * Clear external version also
     C                     Z-ADD*ZERO     V1AYDT
     C                     MOVEL*BLANK    #1BVTX           Telephone Numbe
     C                     MOVEL*BLANK    #1QNST           Order Entry Hol
     C                     MOVEL*BLANK    #1BWTX           Fax Number FF
     C                     Z-ADD*ZERO     #1I7DT           Order Entry Hol
      * Clear external version also
     C                     Z-ADD*ZERO     V1I7DT
     C                     MOVEL*BLANK    #1A2NA           Federal Tax Id.
     C                     MOVEL*BLANK    #1QYST           Item Reference
     C                     MOVEL*BLANK    #1RJST           Ship To Custome
     C                     MOVEL*BLANK    #DGZT1           Description 21a
     C                     MOVEL*BLANK    #DP5SX           Customer Sales
     C                     MOVELP5UFTX    #PUFTX           Internet Passwo
     C                     MOVEL*BLANK    #DDFT1           Pass Name
     C                     MOVEL*BLANK    #DP1SX           Regional Mgr Fa
     C                     MOVEL*BLANK    #DE6T1           Reg Fax/Email S
     C                     MOVEL*BLANK    #1QWST           Email When Orde
     C                     Z-ADD*ZERO     #DAAC8           Customer G/L Ve
     C                     MOVEL*BLANK    #DJNNA           USR Description
     C                     MOVEL*BLANK    #DVEAA           M3 Supplier ID
     C                     MOVELP5UGTX    #PUGTX           Email Address
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     MOVEL*BLANK    #DO1U1           Ship To Establi
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BBREE9 fields to screen
      *================================================================
     C                     MOVELBBABTX    #1ABTX           Alpha Search
     C                     MOVELBBCBST    #1CBST           New Customer St
     C                     Z-ADDBBP3NB    #1P3NB           D & B Number
     C                     MOVELBBLTCD    #1LTCD           EDI Invoice Sts
     C                     MOVELBBRKST    #1RKST           Field vs. In-Ho
     C                     MOVELBBQXST    #1QXST           Print Invoice S
     C                     MOVELBBUVST    #1UVST           EDI Status 1
     C                     MOVELBBUWST    #1UWST           EDI Status 2
     C                     MOVELBBUXST    #1UXST           EDI Status 3
     C                     Z-ADDBBAATM    #1AATM           Job Time
     C                     MOVELBBAYNA    #1AYNA           User Id
     C                     MOVELBBA0NA    #1A0NA           Job Name
     C                     Z-ADDBBAXDT    #1AXDT           Job Date
     C                     Z-ADDBBBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDBBANC7    #1ANC7           AR Customer Num
     C                     MOVELBBAYTX    #1AYTX           Customer Name
     C                     Z-ADDBBBTC7    #1BTC7           Parent Customer
     C                     MOVELBBACNA    #1ACNA           Address Line 1
     C                     MOVELBBK6ST    #1K6ST           Credit Check AR
     C                     MOVELBBUZST    #1UZST           Credit Check Pa
     C                     MOVELBBADNA    #1ADNA           Address Line 2
     C                     MOVELBBUNCS    #1UNCS           Statement Print
     C                     MOVELBBAENA    #1AENA           Address Line 3
     C                     Z-ADDBBVHVA    #1VHVA           AR Credit Limit
     C                     MOVELBBAJNA    #1AJNA           City
     C                     Z-ADDBBS2NB    #1S2NB           Parent Credit L
     C                     MOVELBBBGCD    #1BGCD           State Code
     C                     MOVELBBB0NA    #1B0NA           SIC Number
     C                     MOVELBBG5CD    #1G5CD           County Code
     C                     MOVELBBAXNA    #1AXNA           D & B Rating
     C                     MOVELBBKXCD    #1KXCD           Country Code
     C                     Z-ADDBBI6DT    #1I6DT           Date of D & B R
     C                     MOVELBBBTTX    #1BTTX           Zip Postal Code
     C                     Z-ADDBBAYDT    #1AYDT           Credit Line Exp
     C                     MOVELBBBVTX    #1BVTX           Telephone Numbe
     C                     MOVELBBQNST    #1QNST           Order Entry Hol
     C                     MOVELBBBWTX    #1BWTX           Fax Number FF
     C                     Z-ADDBBI7DT    #1I7DT           Order Entry Hol
     C                     MOVELBBA2NA    #1A2NA           Federal Tax Id.
     C                     MOVELBBQYST    #1QYST           Item Reference
     C                     MOVELBBRJST    #1RJST           Ship To Custome
     C                     MOVELBBQWST    #1QWST           Email When Orde
     C                     MOVELBBVSST    #1VSST           Record Status
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP6AQCD    #PAQCD           Terms Code
     C                     MOVELP6R4CD    #PR4CD           Sales Route Cod
     C                     MOVELP6BYNA    #PBYNA           Special Instruc
     C                     MOVELP6B6NA    #PB6NA           Special Instruc
     C                     MOVELP6BZNA    #PBZNA           Carrier Code
     C                     MOVELP6LLST    #PLLST           Broker
     C                     MOVELP6PPST    #PPPST           P.O. Required F
     C                     Z-ADDP6R5NB    #PR5NB           Deliver after t
     C                     Z-ADDP6R6NB    #PR6NB           Deliver before
     C                     MOVELP6QGST    #PQGST           Alt Remittance
     C                     MOVELP6BOCD    #PBOCD           Type Code
     C                     Z-ADDP6TBNB    #PTBNB           Absorbed Freigh
     C                     Z-ADDP6MTCU    #PMTCU           Mileage To Cust
     C                     Z-ADDP6W2NB    #PW2NB           Co/Cust Overage
     C                     MOVELP6RPCD    #PRPCD           Age Code
     C                     MOVELP6AJCD    #PAJCD           Warehouse Code
     C                     MOVELP6X9ST    #PX9ST           Outside Warehou
     C                     MOVELP6T9CD    #PT9CD           Customer Group
     C                     MOVELP6UBCD    #PUBCD           Customer Group
     C                     MOVELP6ISTX    #PISTX           G/L Code
     C                     MOVELP6LQCD    #PLQCD           Commodity Marke
     C                     MOVELP6NJNA    #PNJNA           Credit Contact
     C                     MOVELP6I0TX    #PI0TX           Credit Contact
     C                     MOVELP6NKNA    #PNKNA           Credit Contact
     C                     MOVELP6I1TX    #PI1TX           Credit Contact
     C                     MOVELP6VLST    #PVLST           Allow Man/Qt WO
     C                     MOVELP6RLST    #PRLST           Fax Invoice Fla
     C                     MOVELP6MMTX    #PMMTX           Fax Invoice Fax
     C                     MOVELP6OHNA    #POHNA           Fax Invoice Con
     C                     MOVELP6Q6ST    #PQ6ST           Distributor
     C                     MOVELP6Q8ST    #PQ8ST           Default Shippin
     C                     MOVELP6RBST    #PRBST           Ord Ent Default
     C                     MOVELP6REST    #PREST           Bypass DDt/Dela
     C                     MOVELP5UFTX    #PUFTX           Internet Passwo
     C                     MOVELP5UGTX    #PUGTX           Email Address
     C                     Z-ADDP1BKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MEIZ#1    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DDET1           Broker Name DRV
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert AR Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1ANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1ANC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Date of D & B Rating to display format
      * Convert date
     C           1000000   ADD  #1I6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1I6DT
      * Convert Credit Line Expire Date to display format
      * Convert date
     C           1000000   ADD  #1AYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AYDT
      * Convert Order Entry Hold Date to display format
      * Convert date
     C           1000000   ADD  #1I7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1I7DT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBBBKC7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSA     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PUFTX           Internet Passwo
     C                     MOVEL*BLANK    #PUGTX           Email Address
     C                     MOVEL*BLANK    WUPFNA           Email User ID
     C                     MOVEL*BLANK    P5J5NX           EDI Trading Par
     C                     MOVEL*BLANK    P5U5TX           EDI Cust Duns N
     C                     MOVEL*BLANK    P5U6TX           EDI Warehouse/S
     C                     MOVEL*BLANK    P5W0TX           State Tax ID
     C                     MOVEL*BLANK    P5HSSX           Cust Shipping T
     C                     MOVEL*BLANK    #DHUSX           One Invoice Per
     C                     MOVEL*BLANK    P5HVSX           EDI Advanced Sh
     C                     Z-ADD*ZERO     #DAAC8           Customer G/L Ve
     C                     MOVEL*BLANK    #DP1SX           Regional Mgr Fa
     C                     MOVEL*BLANK    #DP3SX           Customer TF Exe
     C                     MOVEL*BLANK    #DP5SX           Customer Sales
     C                     MOVEL*BLANK    #DP6SX           Customer Market
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEUFTX    #PUFTX           Internet Passwo
     C                     MOVELNEUGTX    #PUGTX           Email Address
     C                     MOVELNEPFNA    WUPFNA           Email User ID
     C                     MOVELNEJ5NX    P5J5NX           EDI Trading Par
     C                     MOVELNEU5TX    P5U5TX           EDI Cust Duns N
     C                     MOVELNEU6TX    P5U6TX           EDI Warehouse/S
     C                     MOVELNEW0TX    P5W0TX           State Tax ID
     C                     MOVELNEHSSX    P5HSSX           Cust Shipping T
     C                     MOVELNEHUSX    #DHUSX           One Invoice Per
     C                     MOVELNEHVSX    P5HVSX           EDI Advanced Sh
     C                     Z-ADDNEAAC8    #DAAC8           Customer G/L Ve
     C                     MOVELNEP1SX    #DP1SX           Regional Mgr Fa
     C                     MOVELNEP3SX    #DP3SX           Customer TF Exe
     C                     MOVELNEP5SX    #DP5SX           Customer Sales
     C                     MOVELNEP6SX    #DP6SX           Customer Market
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELBBBGCD    ACBGCD           State Code
      * Establish starting position
     C           KRSSB     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DHSNA           Description
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    #DHSNA           Description
     C                     MOVELACVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV County Desc.       RT - County Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ECBGCD           State Code
     C                     KFLD           ECG5CD           County Code
      * Setup key
     C                     MOVELBBBGCD    ECBGCD           State Code
     C                     MOVELBBG5CD    ECG5CD           County Code
      * Establish starting position
     C           KRSSC     CHAIN@ECREVS              90    *
      * Data record not found
     C   90                MOVEL'USR0852' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELECAUNA    #DAUNA           Description
     C                     MOVELECVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELBBKXCD    E5KXCD           Country Code
      * Establish starting position
     C           KRSSD     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDATX           Country Descrip
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    #DDATX           Country Descrip
     C                     MOVELE5VSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Description       RT - Customer Market  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           DDISAA           Market Code
      * Setup key
     C                     MOVEL#DP6SX    DDISAA           Market Code
      * Establish starting position
     C           KRSSE     CHAIN@DDREQI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3863' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DR3NA           Market Desc
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDDR3NA    #DR3NA           Market Desc
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Credit Limits      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABTC7    WL0002           Parent Customer
     C                     MOVELWAK6ST    WL0003           Credit Check AR
     C                     MOVELWAUZST    WL0004           Credit Check Pa
     C                     Z-ADDWAS2NB    WL0005           Parent Credit L
     C                     Z-ADDWAVHVA    WL0006           AR Credit Limit
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv All - Customer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #DVEAA           M3 Supplier ID
     C                     MOVEL*BLANK    #DZZAA           Buying Group
     C                     MOVEL*BLANK    #DK8SC           Buying Group Op
     C                     MOVEL*BLANK    #DO1U1           Ship To Establi
     C                     MOVEL*BLANK    #DLWSC           PM Pallet Type
     C                     MOVEL*BLANK    #DAKAB           Cust Dft Price
     C                     Z-ADD*ZERO     #DGANZ           Cust Dft Age Da
     C                     Z-ADD*ZERO     YL0001           Cust Dft Delive
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDBBBKC7    AABKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@AAREY9              90    *
      * Data record not found
     C   90                MOVEL'USR4969' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAVEAA    #DVEAA           M3 Supplier ID
     C                     MOVELAAZZAA    #DZZAA           Buying Group
     C                     MOVELAAK8SC    #DK8SC           Buying Group Op
     C                     MOVELAAO1U1    #DO1U1           Ship To Establi
     C                     MOVELAALWSC    #DLWSC           PM Pallet Type
     C                     MOVELAAAKAB    #DAKAB           Cust Dft Price
     C                     Z-ADDAAGANZ    #DGANZ           Cust Dft Age Da
     C                     Z-ADDAAEOTM    YL0001           Cust Dft Delive
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Pallet Master     RT - Pallet Master  * Get description
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVEL#DLWSC    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSSH     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DQJU1           PM Description
     C                     MOVEL'N'       YN0019           Record Found US
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB6QJU1    #DQJU1           PM Description
     C                     MOVEL'Y'       YN0019           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Company/Cust Data  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2AIC3    EOAIC3           Company Number
     C                     Z-ADDBBBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAQCD    #PAQCD           Terms Code
     C                     MOVELEOR4CD    #PR4CD           Sales Route Cod
     C                     MOVELEOBYNA    #PBYNA           Special Instruc
     C                     MOVELEOB6NA    #PB6NA           Special Instruc
     C                     MOVELEOBZNA    #PBZNA           Carrier Code
     C                     MOVELEOLLST    #PLLST           Broker
     C                     MOVELEOPPST    #PPPST           P.O. Required F
     C                     Z-ADDEOR5NB    #PR5NB           Deliver after t
     C                     Z-ADDEOR6NB    #PR6NB           Deliver before
     C                     MOVELEOBOCD    #PBOCD           Type Code
     C                     Z-ADDEOTBNB    #PTBNB           Absorbed Freigh
     C                     Z-ADDEOMTCU    #PMTCU           Mileage To Cust
     C                     MOVELEORPCD    #PRPCD           Age Code
     C                     MOVELEOAJCD    #PAJCD           Warehouse Code
     C                     MOVELEOX9ST    #PX9ST           Outside Warehou
     C                     MOVELEOT9CD    #PT9CD           Customer Group
     C                     MOVELEOUBCD    #PUBCD           Customer Group
     C                     MOVELEOISTX    #PISTX           G/L Code
     C                     MOVELEOLQCD    #PLQCD           Commodity Marke
     C                     MOVELEONJNA    #PNJNA           Credit Contact
     C                     MOVELEOI0TX    #PI0TX           Credit Contact
     C                     MOVELEONKNA    #PNKNA           Credit Contact
     C                     MOVELEOI1TX    #PI1TX           Credit Contact
     C                     MOVELEOVLST    #PVLST           Allow Man/Qt WO
     C                     MOVELEORLST    #PRLST           Fax Invoice Fla
     C                     MOVELEOMMTX    #PMMTX           Fax Invoice Fax
     C                     MOVELEOOHNA    #POHNA           Fax Invoice Con
     C                     MOVELEOQ6ST    #PQ6ST           Distributor
     C                     MOVELEOQ8ST    #PQ8ST           Default Shippin
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Zone for City-ST   RT - Destination-Zone  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           LUAIC3           Company Number
     C                     KFLD           LUBGCD           State Code
     C                     KFLD           LUXECD           Destination Cit
      * Setup key
     C                     Z-ADDP2AIC3    LUAIC3           Company Number
     C                     MOVEL#1BGCD    LUBGCD           State Code
     C                     MOVELYL0006    LUXECD           Destination Cit
      * Establish starting position
     C           KRSSJ     CHAIN@LUREQM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2562' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DX1CD           Shipping Zone C
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLUX1CD    #DX1CD           Shipping Zone C
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Account info-Co/ShpRT - Company Customer G/L  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           GZAIC3           Company Number
     C                     KFLD           GZBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2AIC3    GZAIC3           Company Number
     C                     Z-ADDBBBKC7    GZBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@GZCPIH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1444' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUOOVA           Extra Amount 1
     C                     Z-ADD*ZERO     WUZBNB           Extra Number 1
     C                     MOVEL*BLANK    WUSNST           Extra Status 1
     C                     MOVEL*BLANK    WUIOCD           SH Expense Buck
     C                     MOVEL*BLANK    WUIPCD           G_L Sub Account
     C                     MOVEL*BLANK    WUIOCD           SH Expense Buck
     C                     MOVEL*BLANK    WUIPCD           G_L Sub Account
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDGZOOVA    WUOOVA           Extra Amount 1
     C                     Z-ADDGZZBNB    WUZBNB           Extra Number 1
     C                     MOVELGZSNST    WUSNST           Extra Status 1
     C                     MOVELGZAVNB    WUIOCD           SH Expense Buck
     C                     MOVELGZDSCD    WUIPCD           G_L Sub Account
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Terms              RT - Terms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADDP2AIC3    AOAIC3           Company Number
     C                     MOVEL#PAQCD    AOAQCD           Terms Code
      * Establish starting position
     C           KRSSL     CHAIN@AOREB3              90    *
      * Data record not found
     C   90                MOVEL'USR0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOAUNA    #DC9NA           Description
     C                     MOVELAOD3ST    WUD3ST           Terms Type
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV SR Desc,person     RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#PR4CD    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSM     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DMZNA           Sales Route Des
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    #DMZNA           Sales Route Des
     C                     MOVELJEBCCD    #DBCCD           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#DBCCD    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSN     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    #DBCCD           Salesperson Cod
     C                     MOVELAPALTX    #DALTX           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#PBZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSO     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    #DADTX           Name
     C                     MOVELFFVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Cust Group Descrp. RT - Customer Group Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           JXT9CD           Customer Group
      * Setup key
     C                     MOVELWL0007    JXT9CD           Customer Group
      * Establish starting position
     C           KRSSP     CHAIN@JXREB5              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2021' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Customer Group
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJXNDNA    WL0008           Customer Group
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Type Code Desc.    RT - Type Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVEL#PBOCD    AJBOCD           Type Code
      * Establish starting position
     C           KRSSQ     CHAIN@AJREBR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0026' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DEET1           Description
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAJAUNA    #DEET1           Description
     C                     MOVELAJVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#PLQCD    FYLQCD           Commodity Marke
      * Establish starting position
     C           KRSSR     CHAIN@FYREDK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1218' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ3NA           Commodity Marke
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFYJ3NA    #DJ3NA           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv CCE GL Sales Acct RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2AIC3    NIAIC3           Company Number
     C                     Z-ADDBBBKC7    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNIHMST    #DHMST           CCE GL Sales Ac
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSST     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDRAIC3    YL0013           Company Number
     C                     MOVELDRBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0009    DTAJVN           User Profile Na
     C                     MOVELWL0010    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSU     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0011           Company Number
     C                     MOVELDTAJCD    WL0012           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSV01           Application Cod
     C                     MOVEL'A/R'     WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * E1LIVE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDP2AIC3    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'E1LIVE'  KMV8CD           Company Value C
      * Establish starting position
     C           KRSSX     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0012           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Customer Rules for Existing Customer for DTL screen
      *================================================================
     C                     Z-ADDBBANC7    P1ANC7           AR Customer Num
     C                     Z-ADDBBBTC7    P1BTC7           Parent Customer
     C                     MOVELBBQNST    P4RWST           USR Order Entry
     C                     Z-ADDBBI7DT    P4K5DT           USR Order Entry
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
     C                     EXSR SARVGN
      * RTV State Description  RT - State  * 
     C                     EXSR SBRVGN
      * RTV County Desc.       RT - County Master  * 
     C                     EXSR SCRVGN
      * RTV Desc, Status       RT - Country  * 
     C                     EXSR SDRVGN
      * Rtv Description       RT - Customer Market  * 
     C                     EXSR SERVGN
      * Retrieve a/r customer name if not the same number
      * CASE: PAR.A/R Customer Number NE PAR.Ship To Customer
     C           P1ANC7    IFNE P1BKC7                     *IF
      * RTV Customer Name     XF - Customer  * 
     C                     CALL 'PPH6XFR'              90  RTV Customer Na
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BBANC7    WQ0001  70       Ship To Custome
     C           #DC0TX    PARM *BLANK    WQ0002 30        Customer Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPH6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBBAYTX    #DC0TX           USR A/R Custome
     C                     END                             *FI
      * Retrieve parent customer name if not the same
      * CASE: PAR.Parent Customer NE PAR.Ship To Customer
     C           P1BTC7    IFNE P1BKC7                     *IF
      * RTV Customer Name     XF - Customer  * 
     C                     CALL 'PPH6XFR'              90  RTV Customer Na
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BBBTC7    WQ0003  70       Ship To Custome
     C           #DC1TX    PARM *BLANK    WQ0004 30        Customer Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPH6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBBAYTX    #DC1TX           USR Bill To Cus
     C                     END                             *FI
      * Retrieve g/l customer
      * CASE: DTL.Customer G/L Vendor Num is Entered
     C           #DAAC8    IFNE *ZERO                      *IF
      * Get Vendor Address    RT - STR VND Common Routines  * 
     C                     CALL 'VNDFAXR'              90  Get Vendor Addr
     C           W0RTN     PARM *BLANK    WQ0005  7        *Return code
     C           #DAAC8    PARM #DAAC8    WQ0006  80       Address Number
     C           #DJNNA    PARM #DJNNA    WQ0007 40        Pass Name
     C           WUDGT1    PARM WUDGT1    WQ0008 40        Address 1
     C           WUDHT1    PARM WUDHT1    WQ0009 40        Address 2
     C           WUDIT1    PARM WUDIT1    WQ0010 40        Address 3
     C           WUDST1    PARM WUDST1    WQ0011 40        VND City
     C           WUDTT1    PARM WUDTT1    WQ0012  3        VND State
     C           WUDUT1    PARM WUDUT1    WQ0013 12        VND Zip
     C           WUDKT1    PARM WUDKT1    WQ0014  6        Area Code
     C           WUDLT1    PARM WUDLT1    WQ0015 20        Telephone
     C           WUDMT1    PARM WUDMT1    WQ0016  6        Fax Area Code #
     C           WUDNT1    PARM WUDNT1    WQ0017 25        Fax Telephone
     C           WUDQT1    PARM WUDQT1    WQ0018  6        Fax Area Code #
     C           WUDRT1    PARM WUDRT1    WQ0019 25        Fax Telephone 2
     C           WUQ4SX    PARM WUQ4SX    WQ0020  1        Vendor 1099
     C           WUDWT1    PARM WUDWT1    WQ0021 16        Vendor Tax Id.
     C           WUE8AA    PARM WUE8AA    WQ0022  3        VND Country
     C                     PARM WUB8ST    WQ0023  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'VNDFAXR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Dsply A/R credit limit from A/R customer record - ARS032
      * CASE: PAR.Ship To Customer NE PAR.A/R Customer Number
     C           P1BKC7    IFNE P1ANC7                     *IF
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0001           Ship To Custome
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUBTC7           Parent Customer
     C                     MOVELWL0003    WUK6ST    P      Credit Check AR
     C                     MOVELWL0004    WUUZST    P      Credit Check Pa
     C                     Z-ADDWL0005    WUS2NB           Parent Credit L
     C                     Z-ADDWL0006    #1VHVA           AR Credit Limit
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     END                             *FI
      * Dsply Parent credit limit from Parent customer record - ARS032
      * CASE: PAR.Ship To Customer NE PAR.Parent Customer
     C           P1BKC7    IFNE P1BTC7                     *IF
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BTC7    WL0001           Ship To Custome
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WUBTC7           Parent Customer
     C                     MOVELWL0003    WUK6ST    P      Credit Check AR
     C                     MOVELWL0004    WUUZST    P      Credit Check Pa
     C                     Z-ADDWL0005    #1S2NB           Parent Credit L
     C                     Z-ADDWL0006    WUVHVA           AR Credit Limit
     C                     MOVEL'N'       WUUFL2           USR Flag 2
     C                     END                             *FI
      * DTL.Description 21a 1 Usr = Condition name of DB1.Ship To Custome
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1462353   Y2LSNO  70       List number
     C                     PARM BBRJST    W0INVL 25        Ship To Custome
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGZT1    PARM           W0CNNM 25        Description 21a
      *
      * DTL.Description 14A      USR = Condition name of DB1.Statement Pr
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1651263   Y2LSNO  70       List number
     C                     PARM BBUNCS    W0INVL 25        Statement Print
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DI6TX    PARM           W0CNNM 25        Description 14A
      *
      * DN R16543 05/13/20-Get Info from Customer EXT2.
      * CASE: *OTHERWISE
      * Rtv All - Customer EXT2  * 
     C                     EXSR SGRVGN
      * Get Condition Desc.
      * CASE:
      *  - NOTc1
      *   |- c1    : 2ND.Buying Group Opt In/Out is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DK8SC    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 2ND.Condition Desc. 2  USR = Condition name of 2ND.Buying Group O
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2184321   Y2LSNO  70       List number
     C                     PARM #DK8SC    W0INVL 25        Buying Group Op
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * WI464 DN 02/07/22-Format Delivery Time.
      * CASE: LCL.Cust Dft Delivery Time is Entered
     C           YL0001    IFGT *ZERO                      *IF
      * Only Display Hours & Minutes from Cust Dft Delivery Time.
     C                     Z-ADDYL0001    YL0002           Time Zoned USR
     C                     MOVELYL0002    YL0003           Time Alpha usr
     C                     MOVELYL0003    YL0004           Time HHMM Alpha
     C                     MOVE YL0004    YL0005           Requested Deliv
     C                     Z-ADDYL0005    #DASTH           Requested Deliv
     C                     END                             *FI
      *  9/17/2021 JBB WI464 - Pallet Management
      * Rtv Pallet Master     RT - Pallet Master  * Get description
     C                     EXSR SHRVGN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the Company Customer for Company
      *================================================================
      * Rtv Company/Cust Data  RT - Company Customer  * 
     C                     EXSR SIRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEA#1AJNA    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       YL0006           LOAD OUTPUT
      * RTV Zone for City-ST   RT - Destination-Zone  * 
     C                     EXSR SJRVGN
      * Rtv Account info-Co/ShpRT - Company Customer G/L  * 
     C                     EXSR SKRVGN
      * RTV Terms              RT - Terms  * 
     C                     EXSR SLRVGN
      * RTV SR Desc,person     RT - Sales Route  * 
     C                     EXSR SMRVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SNRVGN
      * RTV Name, Status       RT - Carrier  * 
     C                     EXSR SORVGN
      * RTV Cust Group Descrp. RT - Customer Group Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT9CD    WL0007    P      Customer Group
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DNDNA    P      Customer Group
      * RTV Cust Group Descrp. RT - Customer Group Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PUBCD    WL0007    P      Customer Group
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    #DJMNA    P      Customer Group
      * 2ND.Status Description = Condition name of 2ND.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
     C                     Z-ADD#PW2NB    YL0007           Co/Cust Overage
     C                     MOVELBBVSST    YL0008           Record Status
     C                     MOVEL#PNJNA    YL0009           Credit Contact
     C                     MOVEL#PI1TX    YL0010           Credit Contact
      * RTV Type Code Desc.    RT - Type Codes  * 
     C                     EXSR SQRVGN
      * RTV Commod. Mkts Desc  RT - Commodity Markets  * 
     C                     EXSR SRRVGN
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0024  30       Company Number
     C                     PARM #PISTX    WQ0025  8        G/L Account Cod
     C           #DIYTX    PARM *BLANK    WQ0026 25        G/L Code Desc U
     C           WUURCD    PARM *BLANK    WQ0027  8        G/L Account Id
     C                     PARM WUAT1U    WQ0028  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0029  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0030  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 2ND.Name 25A USR = Condition name of 2ND.Age Code
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1385378   Y2LSNO  70       List number
     C                     PARM #PRPCD    W0INVL 25        Age Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DUJTX    PARM           W0CNNM 25        Name 25A USR
      *
      * 2ND.Alt Rem Flag Desc Usr = Condition name of 2ND.Alt Remittance
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1192202   Y2LSNO  70       List number
     C                     PARM #PQGST    W0INVL 25        Alt Remittance
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEST1    PARM           W0CNNM 25        Alt Rem Flag De
      *
      * Rtv CCE GL Sales Acct RT - Company Customer EXT  * 
     C                     EXSR SSRVGN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1BKC7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Ship To Custome
     C           YPMTFD    OREQ '#1BKC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'AR Customer Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0011' defaulted for 'G/L Vendor Number USR'.
     C                     CALL 'PMFRSRR'              90  SEL A/R Cust W/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1ANC7    WQ0031  70       AR Customer Num
     C           YL0011    PARM *ZERO     WQ0032  80       G/L Vendor Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE022
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1BKC7'  YPMTFD           Ship To Custome
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ANC7           AR Customer Num
     C                     Z-ADD*ZERO     P1BTC7           Parent Customer
     C                     MOVEL*BLANK    P1QNST           Order Entry Hol
     C                     MOVEL*BLANK    P1VSST           Record Status
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     MOVEL*BLANK    P3YKST           USR Formula Met
     C                     MOVEL*BLANK    P3YLST           USR Market Meth
     C                     MOVEL*BLANK    P3YMST           USR Manual Meth
     C                     MOVEL*BLANK    P3YNST           USR Extend Meth
     C                     MOVEL*BLANK    P4JDST           USR Check Y/N S
     C                     Z-ADD*ZERO     P4ATC8           USR Customer/Ve
     C                     MOVEL*BLANK    P4ELST           USR Search Requ
     C                     MOVEL*BLANK    P4R4ST           USR Update Flag
     C                     Z-ADD*ZERO     P4YBVA           USR Hold A/R Cr
     C                     Z-ADD*ZERO     P4YAVA           USR Hold Parent
     C                     Z-ADD*ZERO     P4WBVA           USR Tot. Due W/
     C                     MOVEL*BLANK    P4N7CD           USR Return Code
     C                     Z-ADD*ZERO     P4YIVA           USR Parent Tota
     C                     MOVEL*BLANK    P4RWST           USR Order Entry
     C                     Z-ADD*ZERO     P4K5DT           USR Order Entry
     C                     MOVEL*BLANK    P5UFTX           Internet Passwo
     C                     MOVEL*BLANK    P5UGTX           Email Address
     C                     MOVEL*BLANK    P5J5NX           EDI Trading Par
     C                     MOVEL*BLANK    P5U5TX           EDI Cust Duns N
     C                     MOVEL*BLANK    P5U6TX           EDI Warehouse/S
     C                     MOVEL*BLANK    P5W0TX           State Tax ID
     C                     MOVEL*BLANK    P5HSSX           Cust Shipping T
     C                     MOVEL*BLANK    P5HUSX           One Invoice Per
     C                     MOVEL*BLANK    P5HVSX           EDI Advanced Sh
     C                     MOVEL*BLANK    P6AQCD           Terms Code
     C                     MOVEL*BLANK    P6R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P6BYNA           Special Instruc
     C                     MOVEL*BLANK    P6B6NA           Special Instruc
     C                     MOVEL*BLANK    P6BZNA           Carrier Code
     C                     MOVEL*BLANK    P6LLST           Broker
     C                     MOVEL*BLANK    P6PPST           P.O. Required F
     C                     Z-ADD*ZERO     P6R5NB           Deliver after t
     C                     Z-ADD*ZERO     P6R6NB           Deliver before
     C                     MOVEL*BLANK    P6QGST           Alt Remittance
     C                     MOVEL*BLANK    P6BOCD           Type Code
     C                     Z-ADD*ZERO     P6TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     P6MTCU           Mileage To Cust
     C                     Z-ADD*ZERO     P6W2NB           Co/Cust Overage
     C                     MOVEL*BLANK    P6RPCD           Age Code
     C                     MOVEL*BLANK    P6AJCD           Warehouse Code
     C                     MOVEL*BLANK    P6X9ST           Outside Warehou
     C                     MOVEL*BLANK    P6T9CD           Customer Group
     C                     MOVEL*BLANK    P6UBCD           Customer Group
     C                     MOVEL*BLANK    P6ISTX           G/L Code
     C                     MOVEL*BLANK    P6LQCD           Commodity Marke
     C                     MOVEL*BLANK    P6NJNA           Credit Contact
     C                     MOVEL*BLANK    P6I0TX           Credit Contact
     C                     MOVEL*BLANK    P6NKNA           Credit Contact
     C                     MOVEL*BLANK    P6I1TX           Credit Contact
     C                     MOVEL*BLANK    P6VLST           Allow Man/Qt WO
     C                     MOVEL*BLANK    P6RLST           Fax Invoice Fla
     C                     MOVEL*BLANK    P6MMTX           Fax Invoice Fax
     C                     MOVEL*BLANK    P6OHNA           Fax Invoice Con
     C                     MOVEL*BLANK    P6Q6ST           Distributor
     C                     MOVEL*BLANK    P6Q8ST           Default Shippin
     C                     MOVEL*BLANK    P6RBST           Ord Ent Default
     C                     MOVEL*BLANK    P6REST           Bypass DDt/Dela
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Email User ID
     C                     MOVEL*BLANK    WUPFNA  8
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Address 1
     C                     MOVEL*BLANK    WUDGT1 40
      * Define work field Address 2
     C                     MOVEL*BLANK    WUDHT1 40
      * Define work field Address 3
     C                     MOVEL*BLANK    WUDIT1 40
      * Define work field VND City
     C                     MOVEL*BLANK    WUDST1 40
      * Define work field VND State
     C                     MOVEL*BLANK    WUDTT1  3
      * Define work field VND Zip
     C                     MOVEL*BLANK    WUDUT1 12
      * Define work field Area Code
     C                     MOVEL*BLANK    WUDKT1  6
      * Define work field Telephone
     C                     MOVEL*BLANK    WUDLT1 20
      * Define work field Fax Area Code #
     C                     MOVEL*BLANK    WUDMT1  6
      * Define work field Fax Telephone
     C                     MOVEL*BLANK    WUDNT1 25
      * Define work field Fax Area Code # 2
     C                     MOVEL*BLANK    WUDQT1  6
      * Define work field Fax Telephone 2
     C                     MOVEL*BLANK    WUDRT1 25
      * Define work field Vendor 1099
     C                     MOVEL*BLANK    WUQ4SX  1
      * Define work field Vendor Tax Id.
     C                     MOVEL*BLANK    WUDWT1 16
      * Define work field VND Country
     C                     MOVEL*BLANK    WUE8AA  3
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Parent Customer
     C                     Z-ADD*ZERO     WUBTC7  70
      * Define work field Credit Check AR Customer
     C                     MOVEL*BLANK    WUK6ST  1
      * Define work field Credit Check Parent Cust
     C                     MOVEL*BLANK    WUUZST  1
      * Define work field Parent Credit Limit
     C                     Z-ADD*ZERO     WUS2NB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field AR Credit Limit
     C                     Z-ADD*ZERO     WUVHVA 112
      * Define work field USR Flag 2
     C                     MOVEL*BLANK    WUUFL2  1
      * Define work field Extra Amount 1
     C                     Z-ADD*ZERO     WUOOVA 112
      * Define work field Extra Number 1
     C                     Z-ADD*ZERO     WUZBNB  50
      * Define work field Extra Status 1
     C                     MOVEL*BLANK    WUSNST  1
      * Define work field @G/L Acct Number
     C                     MOVEL*BLANK    WUIOCD  6
      * Define work field @G/L Acct Number Sub
     C                     MOVEL*BLANK    WUIPCD  8
      * Define work field Terms Type
     C                     MOVEL*BLANK    WUD3ST  1
      * Define work field G/L Account Id USR
     C                     MOVEL*BLANK    WUURCD  8
      * Define work field G/L Account Type 1 USR
     C                     MOVEL*BLANK    WUAT1U  3
      * Define work field G/L Account Type 2 USR
     C                     MOVEL*BLANK    WUAT2U  3
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008 30
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0009 10
     C                     MOVEL*BLANK    WL0010  6
     C                     Z-ADD*ZERO     WL0011  30
     C                     MOVEL*BLANK    WL0012  3
      * Define null work field Air Freight Orders
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Employee/Co-Packer Sale
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Customer Watch Flag
     C                     MOVEL*BLANK    YN0003  2
      * Define null work field Dft Mode of Transportaton
     C                     MOVEL*BLANK    YN0004  2
      * Define local work field Cust Dft Delivery Time
     C                     Z-ADD*ZERO     YL0001  60
      * Define local work field Time Zoned USR
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field Time Alpha usr 6
     C                     MOVEL*BLANK    YL0003  6
      * Define local work field Time HHMM Alpha USR
     C                     MOVEL*BLANK    YL0004  4
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0005  40
      * Define null work field Misc Tare Weight
     C                     Z-ADD*ZERO     YN0005  52
      * Define null work field Rental (Y/N)
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Effective Date
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Product ID GTIN
     C                     MOVEL*BLANK    YN0008 48
      * Define null work field Interchange Code
     C                     MOVEL*BLANK    YN0009  6
      * Define null work field Class Code
     C                     MOVEL*BLANK    YN0010  3
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0011  6
      * Define null work field EDI Whs Duns Number
     C                     MOVEL*BLANK    YN0012 20
      * Define null work field Contact Name
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field ASN Ready (Y/N)
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Status 1 - Unused
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Status 2 - Unused
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Text 75 - Unused
     C                     MOVEL*BLANK    YN0017 75
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Record Found USR
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Alt Remittance Flag
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Co/Cust Overage Rate CWT
     C                     Z-ADD*ZERO     YN0021 112
      * Define local work field Destination City
     C                     MOVEL*BLANK    YL0006 20
      * Define local work field Co/Cust Overage Rate CWT
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Credit Contact Name
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Credit Contact Fax Number
     C                     MOVEL*BLANK    YL0010 25
      * Define local work field G/L Vendor Number USR
     C                     Z-ADD*ZERO     YL0011  80
      * Define local work field Live with E1 usr
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0023  3
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0025 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0014  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL##USR     P2AJVN           User Profile Na
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR STRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0001           User Profile Na
     C                     MOVEL'A/R'     ZA0002           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0009    P      User Profile Na
     C                     MOVEL'A/R'     WL0010    P      Application Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    P2AIC3           Company Number
     C                     MOVELWL0012    YL0014    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0009    P      User Profile Na
     C                     MOVEL'A/R'     WL0010    P      Application Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    P2AIC3           Company Number
     C                     MOVELWL0012    YL0014    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0014    YN0022           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0003           User Profile Na
     C                     MOVEL'A/R'     ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
     C                     Z-ADDYL0013    P2AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0014    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *BLANK    WQ0033  3        Warehouse Code
     C                     PARM YL0013    WQ0034  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SVRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * JBB WI-440  4/14/21 - M3 to JDE E1 Financials
      * RTV Alpha Value        RT - Company Values  * E1LIVE
     C                     EXSR SXRVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 USR0752
00002 Y2U0005
