     H/TITLE Snd PFS Prd Sch Bt Dt XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/07/20  Time  : 11:18:53
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBB2CPL1IF  E           K        DISK
      * RTV : PFS Prod Sched Batch Hdr  Retrieval index
      *
     FPBB3CPL1IF  E           K        DISK
      * RTV : PFS Prod Sched Batch Sel  Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCABZREMHIF  E           K        DISK
      * RSQ : Company Item              Co/Typ/Grp/Itm SEL
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FPDI8CPLTIF  E           K        DISK
      * RSQ : PS Prod Item Schedule      Typ/Dte/Itm/PWhs
      *
     FPBB1CPL3IF  E           K        DISK
      * RSQ : PFS Prod Sched Batch Dtl  Co/BcDt/Itm
      *
     FPDKNCPL6IF  E           K        DISK
      * RSQ : Order Detail Schedule           Co/Item/ProdDt/Ord
      *
     FPDKNCPLCIF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Whs/Itm/PrDt/ScDt/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPBB1CPL0IF  E           K        DISK                      A
      * UPD : PFS Prod Sched Batch Dtl  Update index
      *
     FPBB2CPL0UF  E           K        DISK
      * UPD : PFS Prod Sched Batch Hdr  Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@B2CPUQ
      * PFS Prod Sched Batch Hdr  Retrieval index
      * Renamed input format fields
     I              B2Y1NX                          WAY1NX
     I              B2ASD8                          WAASD8
     I              B2AOTS                          WAAOTS
     I              B2TVAA                          WATVAA
     I              B2B0SC                          WAB0SC
     I              B2ATD8                          WAATD8
     I              B2APTS                          WAAPTS
     I              B2UWSX                          WAUWSX
     I              B2UXSX                          WAUXSX
     I              B2V3SX                          WAV3SX
     I              B2AHNY                          WAAHNY
     I              B2AINY                          WAAINY
     I              B2AJNY                          WAAJNY
     I              B2AKNY                          WAAKNY
      *
     I@B3CPUW
      * PFS Prod Sched Batch Sel  Retrieval index
      * Renamed input format fields
     I              B3Y1NX                          WBY1NX
     I              B3ASD8                          WBASD8
     I              B3AOTS                          WBAOTS
     I              B3TVAA                          WBTVAA
     I              B3DNNB                          WBDNNB
     I              B3DONB                          WBDONB
     I              B3UWSX                          WBUWSX
     I              B3UXSX                          WBUXSX
     I              B3V3SX                          WBV3SX
     I              B3AHNY                          WBAHNY
     I              B3AINY                          WBAINY
     I              B3AJNY                          WBAJNY
     I              B3AKNY                          WBAKNY
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WDAIC3
     I              KMV8CD                          WDV8CD
     I              KMAUNA                          WDAUNA
     I              KMI5ST                          WDI5ST
     I              KMBXTX                          WDBXTX
     I              KMM8NB                          WDM8NB
     I              KMUVST                          WDUVST
     I              KMUWST                          WDUWST
     I              KMUXST                          WDUXST
     I              KMVSST                          WDVSST
     I              KMAATM                          WDAATM
     I              KMAYNA                          WDAYNA
     I              KMA0NA                          WDA0NA
     I              KMAXDT                          WDAXDT
      *
     I@BZREUZ
      * Company Item              Co/Typ/Grp/Itm SEL
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WFAIC3
     I              FDHGCD                          WFHGCD
     I              FDD0ST                          WFD0ST
     I              FDD2ST                          WFD2ST
     I              FDD6ST                          WFD6ST
     I              FDWESP                          WFWESP
     I              FDEDST                          WFEDST
     I              FDEFST                          WFEFST
     I              FDEHST                          WFEHST
     I              FDEMST                          WFEMST
     I              FDENST                          WFENST
     I              FDEOST                          WFEOST
     I              FDEPST                          WFEPST
     I              FDEQST                          WFEQST
     I              FDOQNY                          WFOQNY
     I              FDORNY                          WFORNY
     I              FDS2DT                          WFS2DT
     I              FDUFT1                          WFUFT1
     I              FDKUAA                          WFKUAA
     I              FDVSST                          WFVSST
     I              FDMJDT                          WFMJDT
     I              FDBETM                          WFBETM
     I              FDCCVN                          WFCCVN
     I              FDCDVN                          WFCDVN
     I              FDMKDT                          WFMKDT
     I              FDBFTM                          WFBFTM
     I              FDCEVN                          WFCEVN
     I              FDCFVN                          WFCFVN
      *
     I@I8CPWC
      * PS Prod Item Schedule      Typ/Dte/Itm/PWhs
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
     I@B1CPVC
      * PFS Prod Sched Batch Dtl  Co/BcDt/Itm
      * Renamed input format fields
     I              B1Y1NX                          WHY1NX
     I              B1ASD8                          WHASD8
     I              B1AOTS                          WHAOTS
     I              B1TVAA                          WHTVAA
     I              B1BTSQ                          WHBTSQ
     I              B1P7DT                          WHP7DT
     I              B1Y2NX                          WHY2NX
     I              B1U2SX                          WHU2SX
     I              B1ZPNX                          WHZPNX
     I              B1ZXNX                          WHZXNX
     I              B1CSSC                          WHCSSC
     I              B1ODQY                          WHODQY
     I              B1INAL                          WHINAL
     I              B1C6NB                          WHC6NB
     I              B1C8NB                          WHC8NB
     I              B1FLQ1                          WHFLQ1
     I              B1FLQ2                          WHFLQ2
     I              B1ZGNX                          WHZGNX
     I              B1ZWNX                          WHZWNX
     I              B1ZSNX                          WHZSNX
     I              B1ZJNX                          WHZJNX
     I              B1ZKNX                          WHZKNX
     I              B1DNNB                          WHDNNB
     I              B1DONB                          WHDONB
     I              B1DRNB                          WHDRNB
     I              B1U0SX                          WHU0SX
     I              B1BZSC                          WHBZSC
     I              B1B3SC                          WHB3SC
     I              B1B0SC                          WHB0SC
     I              B1VISX                          WHVISX
     I              B1ZLSX                          WHZLSX
     I              B1VGSX                          WHVGSX
     I              B1OJU1                          WHOJU1
     I              B1UWSX                          WHUWSX
     I              B1UXSX                          WHUXSX
     I              B1V3SX                          WHV3SX
     I              B1AHNY                          WHAHNY
     I              B1AINY                          WHAINY
     I              B1AJNY                          WHAJNY
     I              B1AKNY                          WHAKNY
      *
     I@KNCPAF
      * Order Detail Schedule           Co/Item/ProdDt/Ord
      * Renamed input format fields
     I              KNAIC3                          WIAIC3
     I              KNC4NB                          WIC4NB
     I              KNDPNB                          WIDPNB
     I              KNUENB                          WIUENB
     I              KNJGDT                          WIJGDT
     I              KNAODT                          WIAODT
     I              KNAJCD                          WIAJCD
     I              KNAYAA                          WIAYAA
     I              KNHGCD                          WIHGCD
     I              KNIGQT                          WIIGQT
     I              KNFLWG                          WIFLWG
     I              KNIUQT                          WIIUQT
     I              KNF3WG                          WIF3WG
     I              KNIVQT                          WIIVQT
     I              KNF4WG                          WIF4WG
     I              KNP7ST                          WIP7ST
     I              KNP8ST                          WIP8ST
     I              KNQAST                          WIQAST
     I              KNUVST                          WIUVST
     I              KNUWST                          WIUWST
     I              KNUXST                          WIUXST
     I              KNVSST                          WIVSST
     I              KNAATM                          WIAATM
     I              KNAYNA                          WIAYNA
     I              KNA0NA                          WIA0NA
     I              KNAXDT                          WIAXDT
      *
     I@B1CPUS
      * PFS Prod Sched Batch Dtl  Update index
      * Renamed input format fields
     I              B1Y1NX                          WJY1NX
     I              B1ASD8                          WJASD8
     I              B1AOTS                          WJAOTS
     I              B1TVAA                          WJTVAA
     I              B1BTSQ                          WJBTSQ
     I              B1P7DT                          WJP7DT
     I              B1Y2NX                          WJY2NX
     I              B1U2SX                          WJU2SX
     I              B1ZPNX                          WJZPNX
     I              B1ZXNX                          WJZXNX
     I              B1CSSC                          WJCSSC
     I              B1ODQY                          WJODQY
     I              B1INAL                          WJINAL
     I              B1C6NB                          WJC6NB
     I              B1C8NB                          WJC8NB
     I              B1FLQ1                          WJFLQ1
     I              B1FLQ2                          WJFLQ2
     I              B1ZGNX                          WJZGNX
     I              B1ZWNX                          WJZWNX
     I              B1ZSNX                          WJZSNX
     I              B1ZJNX                          WJZJNX
     I              B1ZKNX                          WJZKNX
     I              B1DNNB                          WJDNNB
     I              B1DONB                          WJDONB
     I              B1DRNB                          WJDRNB
     I              B1U0SX                          WJU0SX
     I              B1BZSC                          WJBZSC
     I              B1B3SC                          WJB3SC
     I              B1B0SC                          WJB0SC
     I              B1VISX                          WJVISX
     I              B1ZLSX                          WJZLSX
     I              B1VGSX                          WJVGSX
     I              B1OJU1                          WJOJU1
     I              B1UWSX                          WJUWSX
     I              B1UXSX                          WJUXSX
     I              B1V3SX                          WJV3SX
     I              B1AHNY                          WJAHNY
     I              B1AINY                          WJAINY
     I              B1AJNY                          WJAJNY
     I              B1AKNY                          WJAKNY
      *
     I@KNCPU1
      * Order Detail Schedule     Co/Whs/Itm/PrDt/ScDt/Ord
      * Renamed input format fields
     I              KNAIC3                          WKAIC3
     I              KNC4NB                          WKC4NB
     I              KNDPNB                          WKDPNB
     I              KNUENB                          WKUENB
     I              KNJGDT                          WKJGDT
     I              KNAODT                          WKAODT
     I              KNAJCD                          WKAJCD
     I              KNAYAA                          WKAYAA
     I              KNHGCD                          WKHGCD
     I              KNIGQT                          WKIGQT
     I              KNFLWG                          WKFLWG
     I              KNIUQT                          WKIUQT
     I              KNF3WG                          WKF3WG
     I              KNIVQT                          WKIVQT
     I              KNF4WG                          WKF4WG
     I              KNP7ST                          WKP7ST
     I              KNP8ST                          WKP8ST
     I              KNQAST                          WKQAST
     I              KNUVST                          WKUVST
     I              KNUWST                          WKUWST
     I              KNUXST                          WKUXST
     I              KNVSST                          WKVSST
     I              KNAATM                          WKAATM
     I              KNAYNA                          WKAYNA
     I              KNA0NA                          WKA0NA
     I              KNAXDT                          WKAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WORMNB
     I              FJAIC3                          WOAIC3
     I              FJAODT                          WOAODT
     I              FJPJST                          WOPJST
     I              FJPKST                          WOPKST
     I              FJRNNB                          WORNNB
     I              FJDMTX                          WODMTX
     I              FJDNTX                          WODNTX
     I              FJDOTX                          WODOTX
     I              FJWTTX                          WOWTTX
     I              FJWUTX                          WOWUTX
     I              FJRPNB                          WORPNB
     I              FJFLAM                          WOFLAM
     I              FJXQST                          WOXQST
     I              FJRRNB                          WORRNB
     I              FJDXTX                          WODXTX
     I              FJDYTX                          WODYTX
     I              FJSBNB                          WOSBNB
     I              FJBZNA                          WOBZNA
     I              FJRONB                          WORONB
     I              FJSQNB                          WOSQNB
     I              FJR1NB                          WOR1NB
     I              FJVCST                          WOVCST
     I              FJVDST                          WOVDST
     I              FJSDNB                          WOSDNB
     I              FJPAOU                          WOPAOU
     I              FJDGWG                          WODGWG
     I              FJSXNB                          WOSXNB
     I              FJHADT                          WOHADT
     I              FJAART                          WOAART
     I              FJDHWG                          WODHWG
     I              FJDIWG                          WODIWG
     I              FJAQDT                          WOAQDT
     I              FJS6NB                          WOS6NB
     I              FJT4NB                          WOT4NB
     I              FJPRTM                          WOPRTM
     I              FJNPSV                          WONPSV
     I              FJJ8TX                          WOJ8TX
     I              FJTLMI                          WOTLMI
     I              FJJ9TX                          WOJ9TX
     I              FJQ2CD                          WOQ2CD
     I              FJVPCD                          WOVPCD
     I              FJDBCD                          WODBCD
     I              FJGRWE                          WOGRWE
     I              FJXCCD                          WOXCCD
     I              FJU2ST                          WOU2ST
     I              FJF9DT                          WOF9DT
     I              FJONTM                          WOONTM
     I              FJJ4DT                          WOJ4DT
     I              FJTRTM                          WOTRTM
     I              FJJ5DT                          WOJ5DT
     I              FJSPTM                          WOSPTM
     I              FJJ6DT                          WOJ6DT
     I              FJLFTM                          WOLFTM
     I              FJJ7DT                          WOJ7DT
     I              FJBOTM                          WOBOTM
     I              FJJ8DT                          WOJ8DT
     I              FJBLTM                          WOBLTM
     I              FJKIDT                          WOKIDT
     I              FJASTM                          WOASTM
     I              FJKADT                          WOKADT
     I              FJAJCM                          WOAJCM
     I              FJXACD                          WOXACD
     I              FJOANA                          WOOANA
     I              FJK4TX                          WOK4TX
     I              FJVOAG                          WOVOAG
     I              FJKBDT                          WOKBDT
     I              FJNBBO                          WONBBO
     I              FJW4CD                          WOW4CD
     I              FJEFDT                          WOEFDT
     I              FJCNTN                          WOCNTN
     I              FJKCDT                          WOKCDT
     I              FJTMIN                          WOTMIN
     I              FJKDDT                          WOKDDT
     I              FJVMNB                          WOVMNB
     I              FJOCFR                          WOOCFR
     I              FJKJDT                          WOKJDT
     I              FJATTM                          WOATTM
     I              FJOTRS                          WOOTRS
     I              FJRNST                          WORNST
     I              FJBRBK                          WOBRBK
     I              FJEIDT                          WOEIDT
     I              FJRMST                          WORMST
     I              FJAJCD                          WOAJCD
     I              FJKKDT                          WOKKDT
     I              FJAVTM                          WOAVTM
     I              FJKZDT                          WOKZDT
     I              FJAXTM                          WOAXTM
     I              FJLHOS                          WOLHOS
     I              FJLHOR                          WOLHOR
     I              FJWNTX                          WOWNTX
     I              FJOITX                          WOOITX
     I              FJOJTX                          WOOJTX
     I              FJLLDT                          WOLLDT
     I              FJLSHG                          WOLSHG
     I              FJYPST                          WOYPST
     I              FJK0DT                          WOK0DT
     I              FJAYTM                          WOAYTM
     I              FJKNNX                          WOKNNX
     I              FJICWG                          WOICWG
     I              FJIDWG                          WOIDWG
     I              FJH9SX                          WOH9SX
     I              FJWOTX                          WOWOTX
     I              FJK1DT                          WOK1DT
     I              FJAZTM                          WOAZTM
     I              FJK2DT                          WOK2DT
     I              FJA0TM                          WOA0TM
     I              FJROST                          WOROST
     I              FJRPST                          WORPST
     I              FJRQST                          WORQST
     I              FJRRST                          WORRST
     I              FJZBVA                          WOZBVA
     I              FJWPTX                          WOWPTX
     I              FJWQTX                          WOWQTX
     I              FJWRTX                          WOWRTX
     I              FJWSTX                          WOWSTX
     I              FJRVSX                          WORVSX
     I              FJRUSX                          WORUSX
     I              FJRWSX                          WORWSX
     I              FJRXSX                          WORXSX
     I              FJRYSX                          WORYSX
     I              FJRZSX                          WORZSX
     I              FJR0SX                          WOR0SX
     I              FJR1SX                          WOR1SX
     I              FJR2SX                          WOR2SX
     I              FJR3SX                          WOR3SX
     I              FJR4SX                          WOR4SX
     I              FJPYDT                          WOPYDT
     I              FJCKTM                          WOCKTM
     I              FJPZDT                          WOPZDT
     I              FJCLTM                          WOCLTM
     I              FJP0DT                          WOP0DT
     I              FJCMTM                          WOCMTM
     I              FJP1DT                          WOP1DT
     I              FJCNTM                          WOCNTM
     I              FJP2DT                          WOP2DT
     I              FJCOTM                          WOCOTM
     I              FJP3DT                          WOP3DT
     I              FJCQTM                          WOCQTM
     I              FJUVST                          WOUVST
     I              FJUWST                          WOUWST
     I              FJUXST                          WOUXST
     I              FJAATM                          WOAATM
     I              FJAYNA                          WOAYNA
     I              FJA0NA                          WOA0NA
     I              FJAXDT                          WOAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WRAJCD
     I              ADF8NA                          WRF8NA
     I              ADACNA                          WRACNA
     I              ADADNA                          WRADNA
     I              ADAENA                          WRAENA
     I              ADAJNA                          WRAJNA
     I              ADBTTX                          WRBTTX
     I              ADAOCD                          WRAOCD
     I              ADBGCD                          WRBGCD
     I              ADVHST                          WRVHST
     I              ADMPNA                          WRMPNA
     I              ADWPST                          WRWPST
     I              ADXUST                          WRXUST
     I              ADT0ST                          WRT0ST
     I              ADT1ST                          WRT1ST
     I              ADDBNB                          WRDBNB
     I              ADT2ST                          WRT2ST
     I              ADT3ST                          WRT3ST
     I              ADT4ST                          WRT4ST
     I              ADT6ST                          WRT6ST
     I              ADBWC3                          WRBWC3
     I              ADBTC3                          WRBTC3
     I              ADBUC3                          WRBUC3
     I              ADBVC3                          WRBVC3
     I              ADFCAA                          WRFCAA
     I              ADRQSX                          WRRQSX
     I              ADRRSX                          WRRRSX
     I              ADRSSX                          WRRSSX
     I              ADRTSX                          WRRTSX
     I              ADT7ST                          WRT7ST
     I              ADT8ST                          WRT8ST
     I              ADRNSX                          WRRNSX
     I              ADROSX                          WRROSX
     I              ADRPSX                          WRRPSX
     I              ADUVST                          WRUVST
     I              ADUWST                          WRUWST
     I              ADUXST                          WRUXST
     I              ADVSST                          WRVSST
     I              ADAATM                          WRAATM
     I              ADAYNA                          WRAYNA
     I              ADA0NA                          WRA0NA
     I              ADAXDT                          WRAXDT
      *
     I@B2CPUP
      * PFS Prod Sched Batch Hdr  Update index
      * Renamed input format fields
     I              B2Y1NX                          WSY1NX
     I              B2ASD8                          WSASD8
     I              B2AOTS                          WSAOTS
     I              B2TVAA                          WSTVAA
     I              B2B0SC                          WSB0SC
     I              B2ATD8                          WSATD8
     I              B2APTS                          WSAPTS
     I              B2UWSX                          WSUWSX
     I              B2UXSX                          WSUXSX
     I              B2V3SX                          WSV3SX
     I              B2AHNY                          WSAHNY
     I              B2AINY                          WSAINY
     I              B2AJNY                          WSAJNY
     I              B2AKNY                          WSAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPBB11    E DSPBB1CPL0
      * UPD : PFS Prod Sched Batch Dtl  Update index
      * Renamed input format fields
     I              B1Y1NX                          WJY1NX
     I              B1ASD8                          WJASD8
     I              B1AOTS                          WJAOTS
     I              B1TVAA                          WJTVAA
     I              B1BTSQ                          WJBTSQ
     I              B1P7DT                          WJP7DT
     I              B1Y2NX                          WJY2NX
     I              B1U2SX                          WJU2SX
     I              B1ZPNX                          WJZPNX
     I              B1ZXNX                          WJZXNX
     I              B1CSSC                          WJCSSC
     I              B1ODQY                          WJODQY
     I              B1INAL                          WJINAL
     I              B1C6NB                          WJC6NB
     I              B1C8NB                          WJC8NB
     I              B1FLQ1                          WJFLQ1
     I              B1FLQ2                          WJFLQ2
     I              B1ZGNX                          WJZGNX
     I              B1ZWNX                          WJZWNX
     I              B1ZSNX                          WJZSNX
     I              B1ZJNX                          WJZJNX
     I              B1ZKNX                          WJZKNX
     I              B1DNNB                          WJDNNB
     I              B1DONB                          WJDONB
     I              B1DRNB                          WJDRNB
     I              B1U0SX                          WJU0SX
     I              B1BZSC                          WJBZSC
     I              B1B3SC                          WJB3SC
     I              B1B0SC                          WJB0SC
     I              B1VISX                          WJVISX
     I              B1ZLSX                          WJZLSX
     I              B1VGSX                          WJVGSX
     I              B1OJU1                          WJOJU1
     I              B1UWSX                          WJUWSX
     I              B1UXSX                          WJUXSX
     I              B1V3SX                          WJV3SX
     I              B1AHNY                          WJAHNY
     I              B1AINY                          WJAINY
     I              B1AJNY                          WJAJNY
     I              B1AKNY                          WJAKNY
      *
     IQPBB21    E DSPBB2CPL0
      * UPD : PFS Prod Sched Batch Hdr  Update index
      * Renamed input format fields
     I              B2Y1NX                          WSY1NX
     I              B2ASD8                          WSASD8
     I              B2AOTS                          WSAOTS
     I              B2TVAA                          WSTVAA
     I              B2B0SC                          WSB0SC
     I              B2ATD8                          WSATD8
     I              B2APTS                          WSAPTS
     I              B2UWSX                          WSUWSX
     I              B2UXSX                          WSUXSX
     I              B2V3SX                          WSV3SX
     I              B2AHNY                          WSAHNY
     I              B2AINY                          WSAINY
     I              B2AJNY                          WSAJNY
     I              B2AKNY                          WSAKNY
      *
     IYARDCS      DS                             78
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Prod Sched Batch Hdr
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Batch Date
     I                                        4  110P1ASD8
      * I :  PFS Batch Time
     I                                       12  170P1AOTS
      * I :  PFS User ID
     I                                       18  27 P1TVAA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1ASD8    PARM           WP0002  80       PFS Batch Date
     C           P1AOTS    PARM           WP0003  60       PFS Batch Time
     C           P1TVAA    PARM           WP0004 10        PFS User ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Snd PFS Prd Sch Bt Dt XF
      * Get the PFS Prod Sched Batch Hdr information.
      * Rtv PFS Prd Sch Bt Hd RT - PFS Prod Sched Batch Hdr  * 
     C                     EXSR SARVGN
      * Process all PFS Prod Sched Batch Sel records.
      * Snd PFS Prd Sch Bt Dt RT - PFS Prod Sched Batch Sel  * 
     C                     EXSR SBRVGN
      * E5496 JJH 03/30/16 - Combine Daily Production onto Work Ahead
      * Ext Add Alc Qty WkAhd XF - PFS Prod Sched Batch Dtl  * 
     C                     CALL 'PBWTXFR'              90  Ext Add Alc Qty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1Y1NX    WQ0010  30       PFS Company Num
     C                     PARM P1ASD8    WQ0011  80       PFS Batch Date
     C                     PARM P1AOTS    WQ0012  60       PFS Batch Time
     C                     PARM P1TVAA    WQ0013 10        PFS User ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E5496 JJH 03/31/16 - Remove records with PFS Fill Qty Prod = 0
      * Ext Dlt FillQtyProd=0 XF - PFS Prod Sched Batch Dtl  * 
     C                     CALL 'PBWUXFR'              90  Ext Dlt FillQty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1Y1NX    WQ0014  30       PFS Company Num
     C                     PARM P1ASD8    WQ0015  80       PFS Batch Date
     C                     PARM P1AOTS    WQ0016  60       PFS Batch Time
     C                     PARM P1TVAA    WQ0017 10        PFS User ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * R9035 JJH 01/30/17 - Correct Double Scheduled records
      * Ext Deallocated Combo XF - PFS Prod Sched Batch Hdr  * 
     C                     CALL 'PBWSXFR'              90  Ext Deallocated
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1Y1NX    WQ0018  30       PFS Company Num
     C                     PARM P1ASD8    WQ0019  80       PFS Batch Date
     C                     PARM P1AOTS    WQ0020  60       PFS Batch Time
     C                     PARM P1TVAA    WQ0021 10        PFS User ID
     C                     PARM YL0002    WQ0022  70       PFS Batch Seq
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Convert PFS Change Date to YYYYMMDD
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0005           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0006    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0007    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0008    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0006    CAT  YL0007:ZQ YL0009    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           YL0009    CAT  YL0008:ZQ YL0009    P      Date (Char-8) U
     C                     MOVE YL0009    YL0010           DATE
      *
     C                     Z-ADD*ZERO     WN0027  40       Year Code
     C                     Z-ADD*ZERO     WN0028  20       Month
     C                     Z-ADD*ZERO     WN0029  20       Day of Month US
     C                     MOVEL*BLANK    WN0030  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0031  2        Month (Char) US
     C                     MOVEL*BLANK    WN0032  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0033  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0034  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0035  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0010    DIV  10000     WN0027           Year Code
     C                     Z-ADDWN0027    WN0033           Year  NBR USR
     C                     MOVELWN0033    WN0034           Year  (Char) US
      * ** MONTH **
     C           YL0010    DIV  100       WN0028           Month
     C                     MOVELWN0028    WN0031           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0010    WN0029           Day of Month US
     C                     MOVELWN0029    WN0032           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0027    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0034:ZQ WN0035    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0034:ZQ WN0035    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0035    CAT  WN0031:ZQ WN0035    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0035    CAT  WN0032:ZQ WN0035    P      Date (Alpha) US
     C                     MOVE WN0035    YL0087           Date
      *
     C                     MOVEL*BLANK    WN0036  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0037  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0038  2        Month (Char) US
     C                     MOVEL*BLANK    WN0039  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0087    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0012
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0087    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0013
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0087    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0014
     C                     MOVEL*BLANK    WN0037           Year Alpha (YYY
     C                     MOVELYL0012    WN0037           Year Alpha (YYY
     C                     MOVELYL0013    WN0038           Month (Char) US
     C                     MOVELYL0014    WN0039           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0037    CAT  WN0038:ZQ WN0036    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0036    CAT  WN0039:ZQ WN0036    P      Date (Char-8) U
     C                     MOVE WN0036    YL0088           Date Out (8,0)
      * PFS Process Status = Ready to Send
      * Chg PFS Process Sts   RT - PFS Prod Sched Batch Hdr  * 
     C                     EXSR STCHRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PFS Prd Sch Bt Hd RT - PFS Prod Sched Batch Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAY1NX           PFS Company Num
     C                     KFLD           WAASD8           PFS Batch Date
     C                     KFLD           WAAOTS           PFS Batch Time
     C                     KFLD           WATVAA           PFS User ID
      * Setup key
     C                     Z-ADDP1Y1NX    WAY1NX           PFS Company Num
     C                     Z-ADDP1ASD8    WAASD8           PFS Batch Date
     C                     Z-ADDP1AOTS    WAAOTS           PFS Batch Time
     C                     MOVELP1TVAA    WATVAA           PFS User ID
      * Establish starting position
     C           KRSSA     CHAIN@B2CPUQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4806' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           PFS Baseline Sc
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAB0SC    YL0001           PFS Baseline Sc
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Snd PFS Prd Sch Bt Dt RT - PFS Prod Sched Batch Sel  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
     C                     Z-ADD0         YL0003           PFS Batch Seq
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBY1NX    WQSB01           PFS Company Num
     C           *LIKE     DEFN WBASD8    WQSB02           PFS Batch Date
     C           *LIKE     DEFN WBAOTS    WQSB03           PFS Batch Time
     C           *LIKE     DEFN WBTVAA    WQSB04           PFS User ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           PFS Company Num
     C                     KFLD           WQSB02           PFS Batch Date
     C                     KFLD           WQSB03           PFS Batch Time
     C                     KFLD           WQSB04           PFS User ID
      * Setup key
     C                     Z-ADDP1Y1NX    WQSB01           PFS Company Num
     C                     Z-ADDP1ASD8    WQSB02           PFS Batch Date
     C                     Z-ADDP1AOTS    WQSB03           PFS Batch Time
     C                     MOVELP1TVAA    WQSB04           PFS User ID
      * Establish starting position
     C           KRSSB     SETLL@B3CPUW                    *
     C           KRSSB     READE@B3CPUW                  90*
      * Data record not found
     C   90                MOVEL'USR4808' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set Date and Times to be used for PFS Prod Sched Batch Dtl
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0005           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0006    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0007    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0005:ZQ YL0008    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           YL0006    CAT  YL0007:ZQ YL0009    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           YL0009    CAT  YL0008:ZQ YL0009    P      Date (Char-8) U
     C                     MOVE YL0009    YL0010           DATE
      *
     C                     Z-ADD*ZERO     WN0001  40       Year Code
     C                     Z-ADD*ZERO     WN0002  20       Month
     C                     Z-ADD*ZERO     WN0003  20       Day of Month US
     C                     MOVEL*BLANK    WN0004  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0005  2        Month (Char) US
     C                     MOVEL*BLANK    WN0006  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0007  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0008  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0009  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0010    DIV  10000     WN0001           Year Code
     C                     Z-ADDWN0001    WN0007           Year  NBR USR
     C                     MOVELWN0007    WN0008           Year  (Char) US
      * ** MONTH **
     C           YL0010    DIV  100       WN0002           Month
     C                     MOVELWN0002    WN0005           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0010    WN0003           Day of Month US
     C                     MOVELWN0003    WN0006           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0001    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0008:ZQ WN0009    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0008:ZQ WN0009    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0009    CAT  WN0005:ZQ WN0009    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0009    CAT  WN0006:ZQ WN0009    P      Date (Alpha) US
     C                     MOVE WN0009    YL0004           Date
      *
     C                     MOVEL*BLANK    WN0010  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0011  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0012  2        Month (Char) US
     C                     MOVEL*BLANK    WN0013  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0004    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0012
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0004    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0013
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0004    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0014
     C                     MOVEL*BLANK    WN0011           Year Alpha (YYY
     C                     MOVELYL0012    WN0011           Year Alpha (YYY
     C                     MOVELYL0013    WN0012           Month (Char) US
     C                     MOVELYL0014    WN0013           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0011    CAT  WN0012:ZQ WN0010    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0010    CAT  WN0013:ZQ WN0010    P      Date (Char-8) U
     C                     MOVE WN0010    YL0011           Date Out (8,0)
     C                     Z-ADDYL0011    YL0015           PFS Create Date
     C                     Z-ADD##JTM     YL0016           PFS Create Time
      * Set PFS Fill Qty Ship Date 0, 1, 2
      * E15568 JBB 10/04/19 - Change Date Calc to exlude certain days
      *
     C                     Z-ADD*ZERO     WN0014  70       Kill Date
      *
      * Calc Day0,Day1,Day2   IF
      * Initialize output parameters
     C                     Z-ADD0         YL0017           PFS Fill Qty Sh
     C                     Z-ADD0         YL0018           PFS Fill Qty Sh
     C                     Z-ADD0         YL0019           PFS Fill Qty Sh
      * Day0 is always current job date
     C                     Z-ADD##JDT     YL0020           Post to G/L Dat
     C                     Z-ADD##JDT     YL0021           PFS Fill Qty Sh
      * Loop to populate Day1 and Day2 dates (production dates only)
      * DO WHILE: LCL.PFS Fill Qty Ship Date 2 is Zero
     C           YL0022    DOWEQ0                          *DOW
      * LCL.Post to G/L Date = LCL.Post to G/L Date + CON.1 *DAYS
     C           YL0020    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0020
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0020
     C                     END
      * Rtv Kill/Prod Day Sts RT - Calendar  * Test if production date
     C                     EXSR SCRVGN
      * If Production Day Status is Yes
      * CASE: LCL.Production Day Status is yes
     C           YL0024    IFEQ 'Y'                        *IF
      * Load appropriate PFS Fill Qty Ship Date
      * CASE: LCL.PFS Fill Qty Ship Date 1 is Zero
     C           YL0025    IFEQ 0                          *IF
     C                     Z-ADDYL0020    YL0025           PFS Fill Qty Sh
     C                     ELSE
      * CASE: LCL.PFS Fill Qty Ship Date 2 is Zero
     C           YL0022    IFEQ 0                          *IF
     C                     Z-ADDYL0020    YL0022           PFS Fill Qty Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
      * Load output parameters
     C                     Z-ADDYL0021    YL0017           PFS Fill Qty Sh
     C                     Z-ADDYL0025    YL0018           PFS Fill Qty Sh
     C                     Z-ADDYL0022    YL0019           PFS Fill Qty Sh
      * Get PFS Warehouse from Company Control
      * E6225 JJH 06/23/16 - Use RTVOBJ on Comapny Values that utilizes
      *   the Company Number
      * RTV Alpha Value        RT - Company Values  * PFWHSE
     C                     EXSR SDRVGN
      * Create the PFS Prod Sched Batch Dtl records from Company Item
      * Snd PFS Prd Sch Bt Dt RT - Company Item  * 
     C                     EXSR SERVGN
     C                     Z-ADDYL0003    YL0002           PFS Batch Seq
     C           KRSSB     READE@B3CPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Kill/Prod Day Sts RT - Calendar  * Test if production date
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWBY1NX    WCAIC3           Company Number
     C                     Z-ADDYL0020    WCBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSC     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           Kill Day Status
     C                     MOVEL*BLANK    YL0024           Production Day
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCV9ST    YL0023           Kill Day Status
     C                     MOVELWCWAST    YL0024           Production Day
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * PFWHSE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV8CD           Company Value C
      * Setup key
     C                     Z-ADDWBY1NX    WDAIC3           Company Number
     C                     MOVE *BLANK    WDV8CD           Company Value C
     C                     MOVEL'PFSWHSE' WDV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBXTX    YL0026           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Snd PFS Prd Sch Bt Dt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UBSUBR                     Modifications a
     C                     Z-ADDYL0003    YL0027           PFS Batch Seq
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WERGNB    WQSE02           Item Structure
     C           *LIKE     DEFN WERHNB    WQSE03           Item Structure
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Structure
     C                     KFLD           WQSE03           Item Structure
      * Setup key
     C                     Z-ADDWBY1NX    WQSE01           Company Number
     C                     Z-ADDWBDNNB    WQSE02           Item Structure
     C                     Z-ADDWBDONB    WQSE03           Item Structure
      * Establish starting position
     C           KRSSE     SETLL@BZREUZ                    *
     C           KRSSE     READE@BZREUZ                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND (c5 OR c6)
      *   |- c1    : DB1.Item Prod Sched Send PFS is Yes
      *   |- c2    : DB1.Record Status is Active
      *   |- c3    : DB1.Base/Conv/Loss Item is Base/Converted
      *   |- c4    : DB1.Item Type Code is FG/WP
      *   |- c5    : DB1.U/M - Primary is EQ Boxes
      *   |- c6    : DB1.U/M - Primary is Combos
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WES2CD    IFEQ 'Y'                        *IF
     C           WEVSST    IFEQ 'A'                        *IF
     C           WEQZCD    IFEQ 'B'                        *IF
     C           WEQZCD    OREQ 'C'
     C           WEN0CD    IFEQ 'FG'                       *IF
     C           WEN0CD    OREQ 'WP'
     C                     MOVEL'0'       Y0CX02  1
     C           WEADCD    IFEQ 'BX'                       *IF
     C           WEADCD    OREQ 'CB'                       *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * R11918 JJH 01/25/18 - Do not place Item on Prodution Schedule if
      *                       Alocation Method on Company Item Ext = I.
      * Rtv Alloc Method  RT - Company Item Ext  * 
     C                     EXSR SFRVGN
      * CASE:
      *  - NOT c1
      *   |- c1    : LCL.Allocation Method is Suspended-Inventory Only
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0028    IFEQ 'I'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PFS Fresh/Frozen
      * CASE: DB1.Sold 100% Frozen is yes
     C           WES4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FZ'      YL0029           PFS Fresh/Froze
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'FR'      YL0029           PFS Fresh/Froze
     C                     END                             *FI
      * CASE: DB1.U/M - Primary is EQ Boxes
     C           WEADCD    IFEQ 'BX'                       *IF
      * 10/07/2020 PKD/RMC Dropped db1.Company Number as key 1.
      * Snd PFS Prd Sch Bt Dt RT - PS Prod Item Schedule  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: DB1.U/M - Primary is Combos
     C           WEADCD    IFEQ 'CB'                       *IF
      * Combo Orders - Today's Production Date
      * Snd PFS Prd Sch Bt Dt RT - Order Detail Schedule  * 
     C                     EXSR SKRVGN
      * Combo Orders - Work Ahead Production Date
      * Snd PFS Prd Sch Bt Dt2RT - Order Detail Schedule  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BZREUZ                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0027    YL0003           PFS Batch Seq
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WQSF01           Company Number
     C                     Z-ADDWEHGCD    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@FDREAW                    *
     C           KRSSF     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0028           Allocation Meth
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWFENST    YL0028           Allocation Meth
     C           KRSSF     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Snd PFS Prd Sch Bt Dt RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E3787 JJH 12/07/15 - Modify this RTVOBJ to sum the records by the
      *   Production Warehouse instead of the Warehouse.
      * PFS Batch Seq
     C                     Z-ADDYL0027    YL0030           PFS Batch Seq
      * Initialize Fields
     C                     Z-ADD0         YL0031           PFS Fill Qty Pr
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGV5ST    WQSG02           Production Type
     C           *LIKE     DEFN WGELDT    WQSG03           Production Date
     C           *LIKE     DEFN WGHGCD    WQSG04           Item Code
     C           *LIKE     DEFN WGB7ST    WQSG05           PS Production W
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Production Type
     C                     KFLD           WQSG03           Production Date
     C                     KFLD           WQSG04           Item Code
     C                     KFLD           WQSG05           PS Production W
      * Setup key
     C                     MOVEL'S'       WQSG02           Production Type
     C                     Z-ADDYL0017    WQSG03           Production Date
     C                     Z-ADDWEHGCD    WQSG04           Item Code
     C                     MOVELYL0026    WQSG05           PS Production W
      * Establish starting position
     C           KRSSG     SETLL@I8CPWC                    *
     C           KRSSG     READE@I8CPWC                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PFS Fill Qty Prod
      * Weight Scheduled and Pieces Scheduled for Base/Converted
      * CASE: PAR.PFS Base/Converted is Base
     C           WEQZCD    IFEQ 'B'                        *IF
     C                     Z-ADDWGOAWT    YL0032           Weight Sched Pr
     C                     Z-ADDWGCDNB    YL0033           Pieces Schedule
     C                     ELSE
      * CASE: PAR.PFS Base/Converted is Converted
     C           WEQZCD    IFEQ 'C'                        *IF
      * Weight Sched Prod USR
      * LCL.Weight Sched Prod USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WGDXWG    ADD  WGD1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WGWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WGGAWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0032           Weight Sched Pr
      * Pieces Scheduled
      * LCL.Pieces Scheduled =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WGB2NB    ADD  WGCBNB    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WGPSCV    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WGBPNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0033           Pieces Schedule
     C                     END                             *FI
     C                     END                             *FI
      * PFS Fill Qty Prod for Piece Count Y/N
      * CASE: PAR.Piece Count Item is yes
     C           WEPCCT    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pieces Per Bag is EQ Zero
      *   |- c2    : PAR.Bags Per Unit is EQ Zero
      *   '-
     C           WEBDNB    IFEQ 0                          *IF
     C           WEBJNB    OREQ 0                          *OR
     C                     Z-ADD0         YL0034           PFS Fill Qty Pr
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Fill Qty Prod
      * LCL.PFS Fill Qty Prod =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : LCL.Pieces Scheduled
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WEBDNB    MULT WEBJNB    W0WJ01           *Synon (15,0) w
     C           YL0033    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0034           PFS Fill Qty Pr
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Piece Count Item is no
     C           WEPCCT    IFEQ 'N'                        *IF
      * CASE: PAR.Unit Weight is Equal to zero
     C           WEAIWG    IFEQ 0                          *IF
     C                     Z-ADD0         YL0034           PFS Fill Qty Pr
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Fill Qty Prod
      * LCL.PFS Fill Qty Prod =
      *    *COMPUTE (x1 / x2)
      * x1    : LCL.Weight Sched Prod USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           YL0032    DIV  WEAIWG    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0034           PFS Fill Qty Pr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sum Totals for each PS Prod Item Schedule record
     C                     ADD  YL0034    YL0031           PFS Fill Qty Pr
     C           KRSSG     READE@I8CPWC                  90*
     C                     ENDDO
      * USER: Exit processing
      * Create PFS Prod Sched Bt Dtl
      * Record Selection Processing based on PFS Fill Qty Prod
      * CASE: LCL.PFS Fill Qty Prod Sum is LE ZERO
     C           YL0031    IFLE 0                          *IF
     C                     Z-ADD0         YL0031           PFS Fill Qty Pr
      * Rtv PFSPrdSchBtDt Ext RT - PFS Prod Sched Batch Dtl  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
      * If record selected, create PFS Prod Sched Bt Dtl
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * PFS Fill Qty Ship Day 0, 1, 2 from Order Detail Schedule
      * What are we making today that is shipping today, today +1, today
      * 10/07/2020 PKD/RMC - Changed db1.company number to par.pfs compan
      *                      for Accounting Company
      * This will pick up the Transfer Orders for External Warehouses
      * RTV PFS FillQtyShipDy RT - Order Detail Schedule  * 
     C                     EXSR SIRVGN
      * PFS Batch Seq
     C                     ADD  1         YL0030           PFS Batch Seq
      * Create the PFS Prod Sched Batch Dtl
      * R15794 DN 11/22/19-Set New DB Fields to Blank.
      * 10/07/2020 PKD/RMC Send PAR.PFS Company Number instead of par.Com
      * Crt PFS Prd Sch Bt Dt CR - PFS Prod Sched Batch Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           PFS Company Num
     C                     Z-ADDWBASD8    WL0002           PFS Batch Date
     C                     Z-ADDWBAOTS    WL0003           PFS Batch Time
     C                     MOVELWBTVAA    WL0004    P      PFS User ID
     C                     Z-ADDYL0030    WL0005           PFS Batch Seq
     C                     Z-ADDYL0011    WL0006           PFS Production
     C                     Z-ADDWEHGCD    WL0007           PFS Item Code
     C                     MOVELWES8ST    WL0008    P      PFS Label Type
     C                     Z-ADD0         WL0009           PFS Order Numbe
     C                     Z-ADD0         WL0010           PFS Order Line
     C                     MOVEL*BLANK    WL0011           PFS Order Line
     C                     Z-ADD0         WL0012           PFS Ordered Qty
     C                     Z-ADD0         WL0013           PFS Inventory A
     C                     Z-ADDYL0031    WL0014           PFS Fill Qty Pr
     C                     Z-ADDYL0035    WL0015           PFS Fill Qty Sh
     C                     Z-ADDYL0036    WL0016           PFS Fill Qty Sh
     C                     Z-ADDYL0037    WL0017           PFS Fill Qty Sh
     C                     Z-ADD0         WL0018           PFS Load ID
     C                     Z-ADD0         WL0019           PFS Loading Seq
     C                     Z-ADD0         WL0020           PFS Scheduled S
     C                     Z-ADD0         WL0021           PFS Load Deadli
     C                     Z-ADD0         WL0022           PFS Load Deadli
     C                     Z-ADDWERGNB    WL0023           PFS Item Struct
     C                     Z-ADDWERHNB    WL0024           PFS Item Struct
     C                     Z-ADDWERINB    WL0025           PFS Item Struct
     C                     MOVELWEADCD    WL0026    P      PFS Primary UOM
     C                     MOVELYL0029    WL0027    P      PFS Fresh/Froze
     C                     MOVELWEQZCD    WL0028    P      PFS Base/Conver
     C                     MOVELYL0001    WL0029    P      PFS Baseline Sc
     C                     MOVELYL0041    WL0030    P      PFS Palletize
     C                     MOVELYL0041    WL0031    P      PFS Pallet Type
     C                     MOVELYL0041    WL0032    P      PFS Slip Sheet
     C                     MOVEL*BLANK    WL0033           PFS Customer Na
     C                     MOVEL'A'       WL0034    P      PFS Record Stat
     C                     Z-ADD0         WL0035           PFS Process Sta
     C                     MOVEL*BLANK    WL0036           PFS Error Reaso
     C                     Z-ADDYL0015    WL0037           PFS Create Date
     C                     Z-ADDYL0016    WL0038           PFS Create Time
     C                     Z-ADD0         WL0039           PFS Change Date
     C                     Z-ADD0         WL0040           PFS Change time
     C                     EXSR SJCRRC
     C                     END                             *FI
      * PFS Batch Seq
     C                     Z-ADDYL0030    YL0027           PFS Batch Seq
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv PFSPrdSchBtDt Ext RT - PFS Prod Sched Batch Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E3787 JJH 08/26/15 - The purpose of this function is to determine
      * if there are any records that exist for this Co/Batch Date/Item.
      * If a record exists for a Baseline update on the same Co/Batch Dat
      * Item, then we will allow a Zero Qty PFS Prod Sched Batch Dtl
      * record to be created.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHY1NX    WQSH01           PFS Company Num
     C           *LIKE     DEFN WHASD8    WQSH02           PFS Batch Date
     C           *LIKE     DEFN WHY2NX    WQSH03           PFS Item Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           PFS Company Num
     C                     KFLD           WQSH02           PFS Batch Date
     C                     KFLD           WQSH03           PFS Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WQSH01           PFS Company Num
     C                     Z-ADDWBASD8    WQSH02           PFS Batch Date
     C                     Z-ADDWEHGCD    WQSH03           PFS Item Code
      * Establish starting position
     C           KRSSH     SETLL@B1CPVC                    *
     C           KRSSH     READE@B1CPVC                  90*
      * Data record not found
     C   90                MOVEL'USR4804' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@B1CPVC                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV PFS FillQtyShipDy RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification history
     C                     EXSR UCSUBR                     Modification hi
     C                     Z-ADD0         YL0038           PFS Fill Qty Sh
     C                     Z-ADD0         YL0039           PFS Fill Qty Sh
     C                     Z-ADD0         YL0040           PFS Fill Qty Sh
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSI02           Item Code
     C           *LIKE     DEFN WIJGDT    WQSI03           OD Production D
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WQSI03           OD Production D
      * Setup key
     C                     Z-ADDWEAIC3    WQSI01           Company Number
     C                     Z-ADDWGHGCD    WQSI02           Item Code
     C                     Z-ADDYL0017    WQSI03           OD Production D
      * Establish starting position
     C           KRSSI     SETLL@KNCPAF                    *
     C           KRSSI     READE@KNCPAF                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * E15568 JBB 10/08/19 - Change Date Calculation to exlude certain d
      * New code to accumulate quantities to the correct day
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 0
     C           WIAODT    IFLE YL0017                     *IF
     C                     ADD  WIIGQT    YL0038           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 1
     C           WIAODT    IFLE YL0018                     *IF
     C                     ADD  WIIGQT    YL0039           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 2
     C           WIAODT    IFLE YL0019                     *IF
     C                     ADD  WIIGQT    YL0040           PFS Fill Qty Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@KNCPAF                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0038    YL0035           PFS Fill Qty Sh
     C                     Z-ADDYL0039    YL0036           PFS Fill Qty Sh
     C                     Z-ADDYL0040    YL0037           PFS Fill Qty Sh
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt PFS Prd Sch Bt Dt CR - PFS Prod Sched Batch Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPUS
     C                     Z-ADDWL0001    WJY1NX           PFS Company Num
     C                     Z-ADDWL0002    WJASD8           PFS Batch Date
     C                     Z-ADDWL0003    WJAOTS           PFS Batch Time
     C                     MOVELWL0004    WJTVAA           PFS User ID
     C                     Z-ADDWL0005    WJBTSQ           PFS Batch Seq
     C                     Z-ADDWL0006    WJP7DT           PFS Production
     C                     Z-ADDWL0007    WJY2NX           PFS Item Code
     C                     MOVELWL0008    WJU2SX           PFS Label Type
     C                     Z-ADDWL0009    WJZPNX           PFS Order Numbe
     C                     Z-ADDWL0010    WJZXNX           PFS Order Line
     C                     MOVELWL0011    WJCSSC           PFS Order Line
     C                     Z-ADDWL0012    WJODQY           PFS Ordered Qty
     C                     Z-ADDWL0013    WJINAL           PFS Inventory A
     C                     Z-ADDWL0014    WJC6NB           PFS Fill Qty Pr
     C                     Z-ADDWL0015    WJC8NB           PFS Fill Qty Sh
     C                     Z-ADDWL0016    WJFLQ1           PFS Fill Qty Sh
     C                     Z-ADDWL0017    WJFLQ2           PFS Fill Qty Sh
     C                     Z-ADDWL0018    WJZGNX           PFS Load ID
     C                     Z-ADDWL0019    WJZWNX           PFS Loading Seq
     C                     Z-ADDWL0020    WJZSNX           PFS Scheduled S
     C                     Z-ADDWL0021    WJZJNX           PFS Load Deadli
     C                     Z-ADDWL0022    WJZKNX           PFS Load Deadli
     C                     Z-ADDWL0023    WJDNNB           PFS Item Struct
     C                     Z-ADDWL0024    WJDONB           PFS Item Struct
     C                     Z-ADDWL0025    WJDRNB           PFS Item Struct
     C                     MOVELWL0026    WJU0SX           PFS Primary UOM
     C                     MOVELWL0027    WJBZSC           PFS Fresh/Froze
     C                     MOVELWL0028    WJB3SC           PFS Base/Conver
     C                     MOVELWL0029    WJB0SC           PFS Baseline Sc
     C                     MOVELWL0030    WJVISX           PFS Palletize
     C                     MOVELWL0031    WJZLSX           PFS Pallet Type
     C                     MOVELWL0032    WJVGSX           PFS Slip Sheet
     C                     MOVELWL0033    WJOJU1           PFS Customer Na
     C                     MOVELWL0034    WJUWSX           PFS Record Stat
     C                     Z-ADDWL0035    WJUXSX           PFS Process Sta
     C                     MOVELWL0036    WJV3SX           PFS Error Reaso
     C                     Z-ADDWL0037    WJAHNY           PFS Create Date
     C                     Z-ADDWL0038    WJAINY           PFS Create Time
     C                     Z-ADDWL0039    WJAJNY           PFS Change Date
     C                     Z-ADDWL0040    WJAKNY           PFS Change time
      *
     C           KLCRSJ    KLIST
     C                     KFLD           WJY1NX           PFS Company Num
     C                     KFLD           WJASD8           PFS Batch Date
     C                     KFLD           WJAOTS           PFS Batch Time
     C                     KFLD           WJTVAA           PFS User ID
     C                     KFLD           WJBTSQ           PFS Batch Seq
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@B1CPUS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4805' W0RTN   7
      * Send message 'PFS Prod Sched Batch D EX'
     C                     MOVEL'USR4805' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPUS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Snd PFS Prd Sch Bt Dt RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UDSUBR                     Modifications a
     C                     Z-ADDYL0027    YL0042           PFS Batch Seq
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WKAJCD    WQSK02           Warehouse Code
     C           *LIKE     DEFN WKHGCD    WQSK03           Item Code
     C           *LIKE     DEFN WKJGDT    WQSK04           OD Production D
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Warehouse Code
     C                     KFLD           WQSK03           Item Code
     C                     KFLD           WQSK04           OD Production D
      * Setup key
     C                     Z-ADDWEAIC3    WQSK01           Company Number
     C                     MOVELYL0026    WQSK02           Warehouse Code
     C                     Z-ADDWEHGCD    WQSK03           Item Code
     C                     Z-ADDYL0017    WQSK04           OD Production D
      * Establish starting position
     C           KRSSK     SETLL@KNCPU1                    *
     C           KRSSK     READE@KNCPU1                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PFS Batch Seq
     C                     ADD  1         YL0042           PFS Batch Seq
      * PFS Fill Qty Ship Day 0, 1, 2 from Order Detail Schedule
     C                     Z-ADD0         YL0043           PFS Fill Qty Sh
     C                     Z-ADD0         YL0044           PFS Fill Qty Sh
     C                     Z-ADD0         YL0045           PFS Fill Qty Sh
      * E15568 JBB 10/04/19 - Change Date Calc to exlude certain day
      * E15568 JBB 10/04/19 - New code
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 0
     C           WKAODT    IFLE YL0017                     *IF
     C                     Z-ADDWKIGQT    YL0043           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 1
     C           WKAODT    IFLE YL0018                     *IF
     C                     Z-ADDWKIGQT    YL0044           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 2
     C           WKAODT    IFLE YL0019                     *IF
     C                     Z-ADDWKIGQT    YL0045           PFS Fill Qty Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PFS Ordered Qty from Order Detail
      * R15794 DN 11/26/19-Get Addt'l Info from OD to Create PFS Prod Sch
      * Rtv for Prod Sched Dtl RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0041           Company Number
     C                     Z-ADDWKC4NB    WL0042           Order Number
     C                     Z-ADDWKDPNB    WL0043           Order Sequence
     C                     Z-ADDWKUENB    WL0044           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YL0046    P      Detail Line Sta
     C                     MOVELWL0046    YL0047    P      Palletize
     C                     MOVELWL0047    YL0048    P      Slip Sheet
     C                     Z-ADDWL0048    YL0049           Quantity Ordere
     C                     MOVELWL0049    YL0050    P      OD Pallet Type
      * 5/24/16 E4119 RMC REMOVE LIVE WITH TPM CHECK
      * PFS Load Id
      * R15794 DN 11/26/19-Changed to Get Ship To Customer Name.
      * Rtv PFS Prd Sch Bt Dt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0050           Company Number
     C                     Z-ADDWKC4NB    WL0051           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0052    YL0051    P      Ship To Name
     C                     Z-ADDWL0053    YL0052           Load ID
     C                     Z-ADDWL0054    YN0010           Load Truck Depa
     C                     Z-ADDWL0055    YN0011           Load Truck Depa
      * PFS Loading Sequence, PFS Load Deadline Date/Time from Load Heade
      * RTV ScSeq/DeadDptDtTm RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0052    WL0056           Load ID
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0057    YL0053           Schedule Sequen
     C                     Z-ADDWL0058    YL0054           Deadline Depart
     C                     Z-ADDWL0059    YL0055           Deadline Depart
      *
     C                     MOVEL*BLANK    WN0015  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0016  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0017  2        Month (Char) US
     C                     MOVEL*BLANK    WN0018  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0054    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0012
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0054    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0013
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0054    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0014
     C                     MOVEL*BLANK    WN0016           Year Alpha (YYY
     C                     MOVELYL0012    WN0016           Year Alpha (YYY
     C                     MOVELYL0013    WN0017           Month (Char) US
     C                     MOVELYL0014    WN0018           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0016    CAT  WN0017:ZQ WN0015    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0015    CAT  WN0018:ZQ WN0015    P      Date (Char-8) U
     C                     MOVE WN0015    YL0056           Date Out (8,0)
      * CASE: LCL.PFS Load Deadline Time is EQ 240000
     C           YL0055    IFEQ 240000                     *IF
     C                     Z-ADD235959    YL0055           PFS Load Deadli
     C                     END                             *FI
      * Create the PFS Prod Sched Batch Dtl
      *
     C                     MOVEL*BLANK    WN0019  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0020  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0021  2        Month (Char) US
     C                     MOVEL*BLANK    WN0022  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WKAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0012
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WKAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0013
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0014
     C                     MOVEL*BLANK    WN0020           Year Alpha (YYY
     C                     MOVELYL0012    WN0020           Year Alpha (YYY
     C                     MOVELYL0013    WN0021           Month (Char) US
     C                     MOVELYL0014    WN0022           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0020    CAT  WN0021:ZQ WN0019    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0019    CAT  WN0022:ZQ WN0019    P      Date (Char-8) U
     C                     MOVE WN0019    YL0057           Date Out (8,0)
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * CASE: DB1.OD Qty/Cnsmd Pieces Sched is Greater than zero
     C           WKIGQT    IFGT 0                          *IF
      * R15794 DN 11/22/19-Set New DB Fields from OD & OH Files.
      * Crt PFS Prd Sch Bt Dt CR - PFS Prod Sched Batch Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           PFS Company Num
     C                     Z-ADDWBASD8    WL0002           PFS Batch Date
     C                     Z-ADDWBAOTS    WL0003           PFS Batch Time
     C                     MOVELWBTVAA    WL0004    P      PFS User ID
     C                     Z-ADDYL0042    WL0005           PFS Batch Seq
     C                     Z-ADDYL0011    WL0006           PFS Production
     C                     Z-ADDWEHGCD    WL0007           PFS Item Code
     C                     MOVELWES8ST    WL0008    P      PFS Label Type
     C                     Z-ADDWKC4NB    WL0009           PFS Order Numbe
     C                     Z-ADDWKDPNB    WL0010           PFS Order Line
     C                     MOVELYL0046    WL0011    P      PFS Order Line
     C                     Z-ADDYL0049    WL0012           PFS Ordered Qty
     C                     Z-ADDWKIUQT    WL0013           PFS Inventory A
     C                     Z-ADDWKIGQT    WL0014           PFS Fill Qty Pr
     C                     Z-ADDYL0043    WL0015           PFS Fill Qty Sh
     C                     Z-ADDYL0044    WL0016           PFS Fill Qty Sh
     C                     Z-ADDYL0045    WL0017           PFS Fill Qty Sh
     C                     Z-ADDYL0052    WL0018           PFS Load ID
     C                     Z-ADDYL0053    WL0019           PFS Loading Seq
     C                     Z-ADDYL0057    WL0020           PFS Scheduled S
     C                     Z-ADDYL0056    WL0021           PFS Load Deadli
     C                     Z-ADDYL0055    WL0022           PFS Load Deadli
     C                     Z-ADDWERGNB    WL0023           PFS Item Struct
     C                     Z-ADDWERHNB    WL0024           PFS Item Struct
     C                     Z-ADDWERINB    WL0025           PFS Item Struct
     C                     MOVELWEADCD    WL0026    P      PFS Primary UOM
     C                     MOVELYL0029    WL0027    P      PFS Fresh/Froze
     C                     MOVELWEQZCD    WL0028    P      PFS Base/Conver
     C                     MOVELYL0001    WL0029    P      PFS Baseline Sc
     C                     MOVELYL0047    WL0030    P      PFS Palletize
     C                     MOVELYL0050    WL0031    P      PFS Pallet Type
     C                     MOVELYL0048    WL0032    P      PFS Slip Sheet
     C                     MOVELYL0051    WL0033    P      PFS Customer Na
     C                     MOVEL'A'       WL0034    P      PFS Record Stat
     C                     Z-ADD0         WL0035           PFS Process Sta
     C                     MOVEL*BLANK    WL0036           PFS Error Reaso
     C                     Z-ADDYL0015    WL0037           PFS Create Date
     C                     Z-ADDYL0016    WL0038           PFS Create Time
     C                     Z-ADD0         WL0039           PFS Change Date
     C                     Z-ADD0         WL0040           PFS Change time
     C                     EXSR SJCRRC
     C                     END                             *FI
     C           KRSSK     READE@KNCPU1                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0042    YL0027           PFS Batch Seq
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv for Prod Sched Dtl RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0041    WLAIC3           Company Number
     C                     Z-ADDWL0042    WLC4NB           Order Number
     C                     Z-ADDWL0043    WLDPNB           Order Sequence
     C                     Z-ADDWL0044    WLUENB           Order Secondary
      * Establish starting position
     C           KRSSL     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0045           Detail Line Sta
     C                     MOVEL*BLANK    WL0046           Palletize
     C                     MOVEL*BLANK    WL0047           Slip Sheet
     C                     Z-ADD*ZERO     WL0048           Quantity Ordere
     C                     MOVEL*BLANK    WL0049           OD Pallet Type
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLGMST    WL0045           Detail Line Sta
     C                     MOVELWLVEST    WL0046           Palletize
     C                     MOVELWLVGST    WL0047           Slip Sheet
     C                     Z-ADDWLAVQT    WL0048           Quantity Ordere
     C                     MOVELWLF5SX    WL0049           OD Pallet Type
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv PFS Prd Sch Bt Dt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0050    WMAIC3           Company Number
     C                     Z-ADDWL0051    WMC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0052           Ship To Name
     C                     Z-ADD*ZERO     WL0053           Load ID
     C                     Z-ADD*ZERO     WL0054           Load Truck Depa
     C                     Z-ADD*ZERO     WL0055           Load Truck Depa
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBRTX    WL0052           Ship To Name
     C                     Z-ADDWMRMNB    WL0053           Load ID
     C                     Z-ADDWMNSDT    WL0054           Load Truck Depa
     C                     Z-ADDWMBTTM    WL0055           Load Truck Depa
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV ScSeq/DeadDptDtTm RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WORMNB           Load ID
      * Setup key
     C                     Z-ADDWL0056    WORMNB           Load ID
      * Establish starting position
     C           KRSSN     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0057           Schedule Sequen
     C                     Z-ADD*ZERO     WL0058           Deadline Depart
     C                     Z-ADD*ZERO     WL0059           Deadline Depart
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOT4NB    WL0057           Schedule Sequen
     C                     Z-ADDWOKZDT    WL0058           Deadline Depart
     C                     Z-ADDWOAXTM    WL0059           Deadline Depart
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Snd PFS Prd Sch Bt Dt2RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UESUBR                     Modifications a
      * The purpose of this routine is to create a PFS Prod Sched Batch D
      * record for Combo Orders with a Work Ahead.  A Work Ahead Order
      * must have a Production Date GT today's Date and Today's Date must
      * be included in the "Fresheness Date" Date Range.
     C                     Z-ADDYL0027    YL0058           PFS Batch Seq
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WKAJCD    WQSO02           Warehouse Code
     C           *LIKE     DEFN WKHGCD    WQSO03           Item Code
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Warehouse Code
     C                     KFLD           WQSO03           Item Code
     C                     KFLD           WKJGDT           OD Production D
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Warehouse Code
     C                     KFLD           WQSO03           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WQSO01           Company Number
     C                     MOVELYL0026    WQSO02           Warehouse Code
     C                     Z-ADDWEHGCD    WQSO03           Item Code
     C                     Z-ADDYL0018    WKJGDT           OD Production D
      * Establish starting position
     C           KPSSO     SETLL@KNCPU1                    *
     C           KRSSO     READE@KNCPU1                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get Production Ovr AgeDte To/Fr from Order Detail
      * Rtv PrdOv AgeDt To/Fm RT - Order Detail  * 
     C                     EXSR SPRVGN
      * Get Warehouse Std Chill Time & Warehouse Chill Time from Warehous
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
     C                     EXSR SQRVGN
      * RMC s15557 added 10.2.19
      * RTV Warehouse Inv/Max RT - Warehouse  * 
     C                     EXSR SRRVGN
      * Get Schedule Ship Date & Requested Delivery Date from Order Heade
      * E16768 JJH 08/21/20 - Add Rtv Block Order Flag
      * RTV SSD/Tm/SpIn/BO/RDlvRT - Order Header TRG  * 
     C                     EXSR SSRVGN
      * Calc Chill Time USR
      * CASE: LCL.Warehouse Std Chill Time is yes
     C           YL0062    IFEQ 'Y'                        *IF
      * RMC s15557 added 10.2.19
     C                     Z-ADDYL0064    YL0068           Chill Time USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWECHTM    YL0068           Chill Time USR
     C                     END                             *FI
      * Calculate Production Ovr AgeDte To/Fr
      * CLC PA Age FrmToDates XF - Calendar  * 
     C                     CALL 'PNO7XFR'              90  CLC PA Age FrmT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WKAIC3    WQ0001  30       Company Number
     C                     PARM YL0068    WQ0002  52       Chilling Time U
     C                     PARM YL0065    WQ0003  70       Scheduled Ship
     C                     PARM YL0066    WQ0004  70       Requested Deliv
     C                     PARM YL0059    WQ0005  40       Item Age Days
     C                     PARM YL0060    WQ0006  70       Production Ovr
     C                     PARM YL0061    WQ0007  70       Production Ovr
     C           YL0069    PARM YL0069    WQ0008  70       Production AgeD
     C           YL0070    PARM YL0070    WQ0009  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNO7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Determine if Combo Order in Age Date Range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Production AgeDte Fr is Entered
      *   |- c2    : LCL.Production AgeDte To is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0069    IFNE 0                          *IF
     C           YL0070    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Fill Qty Ship Date 0 GE LCL.Production AgeDt
      *   |- c2    : PAR.PFS Fill Qty Ship Date 0 LE LCL.Production AgeDt
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFGE YL0069                     *IF
     C           YL0017    IFLE YL0070                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0071           Work Ahead Comb
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0071           Work Ahead Comb
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * CASE: LCL.Work Ahead Combo OrderUSR is Yes
     C           YL0071    IFEQ 'Y'                        *IF
      * PFS Batch Seq
     C                     ADD  1         YL0058           PFS Batch Seq
      * PFS Fill Qty Ship Day 0, 1, 2 from Order Detail Schedule
     C                     Z-ADD0         YL0072           PFS Fill Qty Sh
     C                     Z-ADD0         YL0073           PFS Fill Qty Sh
     C                     Z-ADD0         YL0074           PFS Fill Qty Sh
      * E15568 JBB 10/04/19 - Change Date Calc to exlude certain days
      * E15568 JBB 10/04/19 - New Code
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 0
     C           WKAODT    IFLE YL0017                     *IF
     C                     Z-ADDWKIGQT    YL0072           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 1
     C           WKAODT    IFLE YL0018                     *IF
     C                     Z-ADDWKIGQT    YL0073           PFS Fill Qty Sh
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date LE PAR.PFS Fill Qty Ship Date 2
     C           WKAODT    IFLE YL0019                     *IF
     C                     Z-ADDWKIGQT    YL0074           PFS Fill Qty Sh
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PFS Ordered Qty from Order Detail
      * R15794 DN 11/26/19-Get Addt'l Info from OD to Create PFS Prod Sch
      * Rtv for Prod Sched Dtl RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0041           Company Number
     C                     Z-ADDWKC4NB    WL0042           Order Number
     C                     Z-ADDWKDPNB    WL0043           Order Sequence
     C                     Z-ADDWKUENB    WL0044           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YL0075    P      Detail Line Sta
     C                     MOVELWL0046    YL0076    P      Palletize
     C                     MOVELWL0047    YL0077    P      Slip Sheet
     C                     Z-ADDWL0048    YL0078           Quantity Ordere
     C                     MOVELWL0049    YL0079    P      OD Pallet Type
      * PFS Load Fields
      * 5/24/16 E4119 RMC Remove live with tpm
      * PFS Load Id
      * R15794 DN 11/26/19-Changed to Get Ship To Customer Name.
      * Rtv PFS Prd Sch Bt Dt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0050           Company Number
     C                     Z-ADDWKC4NB    WL0051           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0052    YL0080    P      Ship To Name
     C                     Z-ADDWL0053    YL0081           Load ID
     C                     Z-ADDWL0054    YN0016           Load Truck Depa
     C                     Z-ADDWL0055    YN0017           Load Truck Depa
      * PFS Loading Sequence, PFS Load Deadline Date/Time from Load Heade
      * E3787 JJH 10/26/15 - If Work Ahead, set Deadline Departure
      *   Date/Time to ZERO.
      * RTV ScSeq/DeadDptDtTm RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0081    WL0056           Load ID
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0057    YL0082           Schedule Sequen
     C                     Z-ADDWL0058    YL0083           Deadline Depart
     C                     Z-ADDWL0059    YL0084           Deadline Depart
     C                     Z-ADD0         YL0085           PFS Load Deadli
     C                     Z-ADD0         YL0084           PFS Load Deadli
      * Create the PFS Prod Sched Batch Dtl
      *
     C                     MOVEL*BLANK    WN0023  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0024  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0025  2        Month (Char) US
     C                     MOVEL*BLANK    WN0026  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WKAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0012
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WKAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0013
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0014
     C                     MOVEL*BLANK    WN0024           Year Alpha (YYY
     C                     MOVELYL0012    WN0024           Year Alpha (YYY
     C                     MOVELYL0013    WN0025           Month (Char) US
     C                     MOVELYL0014    WN0026           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0024    CAT  WN0025:ZQ WN0023    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0023    CAT  WN0026:ZQ WN0023    P      Date (Char-8) U
     C                     MOVE WN0023    YL0086           Date Out (8,0)
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * E16768 JJH 08/21/20 - Prevent Combo Work Ahead if Block Order
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.OD Qty/Cnsmd Pieces Sched is Greater than zero
      *   |- c2    : LCL.Block Order Flag is Not Block Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WKIGQT    IFGT 0                          *IF
     C           YL0067    IFEQ *BLANK                     *IF
     C           YL0067    OREQ 'F'
     C           YL0067    OREQ 'N'
     C           YL0067    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * R15794 DN 11/22/19-Set New DB Fields from OD & OH Files.
      * Crt PFS Prd Sch Bt Dt CR - PFS Prod Sched Batch Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           PFS Company Num
     C                     Z-ADDWBASD8    WL0002           PFS Batch Date
     C                     Z-ADDWBAOTS    WL0003           PFS Batch Time
     C                     MOVELWBTVAA    WL0004    P      PFS User ID
     C                     Z-ADDYL0058    WL0005           PFS Batch Seq
     C                     Z-ADDYL0011    WL0006           PFS Production
     C                     Z-ADDWEHGCD    WL0007           PFS Item Code
     C                     MOVELWES8ST    WL0008    P      PFS Label Type
     C                     Z-ADDWKC4NB    WL0009           PFS Order Numbe
     C                     Z-ADDWKDPNB    WL0010           PFS Order Line
     C                     MOVELYL0075    WL0011    P      PFS Order Line
     C                     Z-ADDYL0078    WL0012           PFS Ordered Qty
     C                     Z-ADDWKIUQT    WL0013           PFS Inventory A
     C                     Z-ADDWKIGQT    WL0014           PFS Fill Qty Pr
     C                     Z-ADDYL0072    WL0015           PFS Fill Qty Sh
     C                     Z-ADDYL0073    WL0016           PFS Fill Qty Sh
     C                     Z-ADDYL0074    WL0017           PFS Fill Qty Sh
     C                     Z-ADDYL0081    WL0018           PFS Load ID
     C                     Z-ADDYL0082    WL0019           PFS Loading Seq
     C                     Z-ADDYL0086    WL0020           PFS Scheduled S
     C                     Z-ADDYL0085    WL0021           PFS Load Deadli
     C                     Z-ADDYL0084    WL0022           PFS Load Deadli
     C                     Z-ADDWERGNB    WL0023           PFS Item Struct
     C                     Z-ADDWERHNB    WL0024           PFS Item Struct
     C                     Z-ADDWERINB    WL0025           PFS Item Struct
     C                     MOVELWEADCD    WL0026    P      PFS Primary UOM
     C                     MOVELYL0029    WL0027    P      PFS Fresh/Froze
     C                     MOVELWEQZCD    WL0028    P      PFS Base/Conver
     C                     MOVEL'W'       WL0029    P      PFS Baseline Sc
     C                     MOVELYL0076    WL0030    P      PFS Palletize
     C                     MOVELYL0079    WL0031    P      PFS Pallet Type
     C                     MOVELYL0077    WL0032    P      PFS Slip Sheet
     C                     MOVELYL0080    WL0033    P      PFS Customer Na
     C                     MOVEL'A'       WL0034    P      PFS Record Stat
     C                     Z-ADD0         WL0035           PFS Process Sta
     C                     MOVEL*BLANK    WL0036           PFS Error Reaso
     C                     Z-ADDYL0015    WL0037           PFS Create Date
     C                     Z-ADDYL0016    WL0038           PFS Create Time
     C                     Z-ADD0         WL0039           PFS Change Date
     C                     Z-ADD0         WL0040           PFS Change time
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@KNCPU1                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0058    YL0027           PFS Batch Seq
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv PrdOv AgeDt To/Fm RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Setup key
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     Z-ADDWKC4NB    WLC4NB           Order Number
     C                     Z-ADDWKDPNB    WLDPNB           Order Sequence
     C                     Z-ADDWKUENB    WLUENB           Order Secondary
      * Establish starting position
     C           KRSSP     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0059           Item Age Days
     C                     Z-ADD*ZERO     YL0060           Production Ovr
     C                     Z-ADD*ZERO     YL0061           Production Ovr
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLRINY    YL0059           Item Age Days
     C                     Z-ADDWLTIDT    YL0060           Production Ovr
     C                     Z-ADDWLTJDT    YL0061           Production Ovr
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWKAJCD    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0062           Warehouse Std C
     C                     Z-ADD*ZERO     YL0063           Warehouse Chill
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRT1ST    YL0062           Warehouse Std C
     C                     Z-ADDWRDBNB    YL0063           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Warehouse Inv/Max RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWKAJCD    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0064           WHS Inventory C
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRBVC3    YL0064           WHS Inventory C
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV SSD/Tm/SpIn/BO/RDlvRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWKAIC3    WMAIC3           Company Number
     C                     Z-ADDWKC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMAODT    YL0065           Scheduled Ship
     C                     Z-ADDWMEIDT    YL0066           Requested Deliv
     C                     MOVELWMBCST    YL0067           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg PFS Process Sts   RT - PFS Prod Sched Batch Hdr  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0040  1        PFS Baseline Sc
     C                     Z-ADD*ZERO     WN0041  80       PFS Batch Sent
     C                     Z-ADD*ZERO     WN0042  60       PFS Batch Sent
     C                     MOVEL*BLANK    WN0043  1        PFS Record Stat
     C                     MOVEL*BLANK    WN0044  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0045  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0046  60       PFS Create Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B2CPUP
     C                     Z-ADDP1Y1NX    WSY1NX           PFS Company Num
     C                     Z-ADDP1ASD8    WSASD8           PFS Batch Date
     C                     Z-ADDP1AOTS    WSAOTS           PFS Batch Time
     C                     MOVELP1TVAA    WSTVAA    P      PFS User ID
      *
     C           KLCHST    KLIST
     C                     KFLD           WSY1NX           PFS Company Num
     C                     KFLD           WSASD8           PFS Batch Date
     C                     KFLD           WSAOTS           PFS Batch Time
     C                     KFLD           WSTVAA           PFS User ID
     C           KLCHST    CHAIN@B2CPUP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBB2CPL0'MDACP
     C                     MOVEL'@B2CPUP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBB21    YARDCS
      * Move non-key fields to @B2CPUP
     C                     Z-ADD6         WSUXSX           PFS Process Sta
     C                     Z-ADDYL0088    WSAJNY           PFS Change Date
     C                     Z-ADD##JTM     WSAKNY           PFS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBB21    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B2CPUP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E15568 JBB 10/04/19 - Change Date Calculation to exlude certain d
      * - Change the calculation of Date0, Date1, and Date2 to use the
      *   Calendar file to exclude non-Kill Dates.  Also, when the dates
      *   compared to the ship dates, make all comparisons to be "LE".
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * - Same logic apples to Current Production Day and Work Ahead
      * R11918 JJH 01/25/18 - Do not place Item on Prodution Schedule if
      *                       Alocation Method on Company Item Ext = I.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * - Same logic apples to Current Production Day and Work Ahead
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * E15568 JBB 10/08/19 - Change Date Calculation to exlude certain d
      * - When the dates are compared to the ship dates, make all
      *   comparisons to be "LE".
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E15568 JBB 10/04/19 - Change Date Calculation to exlude certain d
      * - When the dates are compared to the ship dates, make all
      *   comparisons to be "LE".
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * - Same logic apples to Current Production Day and Work Ahead
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E15568 JBB 10/04/19 - Change Date Calc to exlude certain days
      * - When the dates are compared to the ship dates, make all
      *   comparisons to be "LE".
      * E13982 JJH 10/25/18 - Exclude Order/Items from Production Schedul
      * - If Combo Order/Item has Prod Qty to Fill = ZERO
      * - Same logic apples to Current Production Day and Work Ahead
      * E6625 JJH 07/15/16 - Correct Combo Workahead
      * - Change I  OD Production Date  POS to RST
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XSTMS     BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                     CALL 'Y2RTTSK'
     C                     PARM           ##TMS  26        System timestam
      *================================================================
     CSR         XSTMSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAASD8           PFS Batch Date
     C                     Z-ADD*ZERO     WAAOTS           PFS Batch Time
     C                     Z-ADD*ZERO     WAATD8           PFS Batch Sent
     C                     Z-ADD*ZERO     WAAPTS           PFS Batch Sent
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WBASD8           PFS Batch Date
     C                     Z-ADD*ZERO     WBAOTS           PFS Batch Time
     C                     Z-ADD*ZERO     WBDNNB           PFS Item Struct
     C                     Z-ADD*ZERO     WBDONB           PFS Item Struct
     C                     Z-ADD*ZERO     WBUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WBAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WBAINY           PFS Create Time
     C                     Z-ADD*ZERO     WBAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WBAKNY           PFS Change time
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WCCQNB           Julian Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEINB           Week Number
     C                     Z-ADD*ZERO     WCAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WCOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WCNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WCNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WCOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WCOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDM8NB           System Value Nu
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WFORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WFS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WGWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WGQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WGDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WGF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WGWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WGD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WGDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WGB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WGWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WGPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WGSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WGB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WGD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WGCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WGD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WGOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WGCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WGBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WGGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WGBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WGD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WGFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WGD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WGDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WGEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WGSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WGEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WGECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WGWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WGEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WGFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WGEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WGQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WGEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WGEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WHASD8           PFS Batch Date
     C                     Z-ADD*ZERO     WHAOTS           PFS Batch Time
     C                     Z-ADD*ZERO     WHBTSQ           PFS Batch Seq
     C                     Z-ADD*ZERO     WHP7DT           PFS Production
     C                     Z-ADD*ZERO     WHY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WHZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WHZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WHODQY           PFS Ordered Qty
     C                     Z-ADD*ZERO     WHINAL           PFS Inventory A
     C                     Z-ADD*ZERO     WHC6NB           PFS Fill Qty Pr
     C                     Z-ADD*ZERO     WHC8NB           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WHFLQ1           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WHFLQ2           PFS Fill Qty Sh
     C                     Z-ADD*ZERO     WHZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WHZWNX           PFS Loading Seq
     C                     Z-ADD*ZERO     WHZSNX           PFS Scheduled S
     C                     Z-ADD*ZERO     WHZJNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WHZKNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WHDNNB           PFS Item Struct
     C                     Z-ADD*ZERO     WHDONB           PFS Item Struct
     C                     Z-ADD*ZERO     WHDRNB           PFS Item Struct
     C                     Z-ADD*ZERO     WHUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WHAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WHAINY           PFS Create Time
     C                     Z-ADD*ZERO     WHAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WHAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIJGDT           OD Production D
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WIFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WIIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WIF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WIIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WIF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WLMAVA           Billing Detail
     C                     Z-ADD*ZERO     WLKDVA           Billing Detail
     C                     Z-ADD*ZERO     WLL8VA           Billing Detail
     C                     Z-ADD*ZERO     WLL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WLAYVA           Extended Amount
     C                     Z-ADD*ZERO     WLEXDT           Market Pricing
     C                     Z-ADD*ZERO     WLBZPR           Price Overage O
     C                     Z-ADD*ZERO     WLL6NB           Contract Number
     C                     Z-ADD*ZERO     WLGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WLD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WLCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WLCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WLATWG           Weight Shipped
     C                     Z-ADD*ZERO     WLAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAKPR           Unit Price
     C                     Z-ADD*ZERO     WLALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WLAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WLAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WLA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WLA5DT           Requested Ship
     C                     Z-ADD*ZERO     WLAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WLGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLCXDT           Date of Origina
     C                     Z-ADD*ZERO     WLDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WLB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WLA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WLNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WLNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WLNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WLNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WLNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WLBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WLBVTM           Price Code
     C                     Z-ADD*ZERO     WLBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WLBXTM           Substitution Li
     C                     Z-ADD*ZERO     WLBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WLH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WLH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WLH7NX           OD Item Target
     C                     Z-ADD*ZERO     WLH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WLH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WLDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WLDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WLDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WLDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WLDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WLGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WLGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WLGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WLPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WLRINY           Item Age Days
     C                     Z-ADD*ZERO     WLTIDT           Production Ovr
     C                     Z-ADD*ZERO     WLTJDT           Production Ovr
     C                     Z-ADD*ZERO     WLTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WLTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WLTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WMA0DT           Order Date
     C                     Z-ADD*ZERO     WMA5DT           Requested Ship
     C                     Z-ADD*ZERO     WMGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WMACDT           Cancel Date
     C                     Z-ADD*ZERO     WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMCXDT           Date of Origina
     C                     Z-ADD*ZERO     WMJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WMA1WG           Order Weight To
     C                     Z-ADD*ZERO     WMEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WMAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WMRMNB           Load ID
     C                     Z-ADD*ZERO     WMTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WMR1NB           Rated Freight
     C                     Z-ADD*ZERO     WMRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WMATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WMRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WMT3NB           Attach to Order
     C                     Z-ADD*ZERO     WMCONB           Invoice Number
     C                     Z-ADD*ZERO     WMAWDT           Invoice Date
     C                     Z-ADD*ZERO     WMVRVA           A/R order Value
     C                     Z-ADD*ZERO     WMB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WMNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WMNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WMNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WMNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WMNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WMBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WMBQTM           Time of Origina
     C                     Z-ADD*ZERO     WMBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WMBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WMBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WMH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WMH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WMH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WMH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WMH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WMC0C7           Claim Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WORMNB           Load ID
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WORNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WORPNB           Total Load Orde
     C                     Z-ADD*ZERO     WOFLAM           Flat Amount
     C                     Z-ADD*ZERO     WORRNB           Total Stops
     C                     Z-ADD*ZERO     WOSBNB           BOL Time
     C                     Z-ADD*ZERO     WOSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WOR1NB           Rated Freight
     C                     Z-ADD*ZERO     WOSDNB           Number Pallets
     C                     Z-ADD*ZERO     WOPAOU           Number Pallets
     C                     Z-ADD*ZERO     WODGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WOSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WOHADT           Actual Arrival
     C                     Z-ADD*ZERO     WOAART           Actual Arrival
     C                     Z-ADD*ZERO     WODHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WODIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WOAQDT           Actual Departur
     C                     Z-ADD*ZERO     WOS6NB           Departure Time
     C                     Z-ADD*ZERO     WOT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WOPRTM           Product Tempera
     C                     Z-ADD*ZERO     WONPSV           Number Spacers
     C                     Z-ADD*ZERO     WOTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WOGRWE           Gross Weight
     C                     Z-ADD*ZERO     WOF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WOJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WOTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WOJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WOSPTM           Spotted Time
     C                     Z-ADD*ZERO     WOJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WOLFTM           Load Finished T
     C                     Z-ADD*ZERO     WOJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WOBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WOJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WOBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WOKIDT           Truck Departure
     C                     Z-ADD*ZERO     WOASTM           Truck Departure
     C                     Z-ADD*ZERO     WOKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WOAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WOVOAG           Voyage
     C                     Z-ADD*ZERO     WOKBDT           Sail Date
     C                     Z-ADD*ZERO     WOEFDT           Arrival Date
     C                     Z-ADD*ZERO     WOKCDT           Date In
     C                     Z-ADD*ZERO     WOTMIN           Time In
     C                     Z-ADD*ZERO     WOKDDT           Date Out
     C                     Z-ADD*ZERO     WOVMNB           Time Out
     C                     Z-ADD*ZERO     WOOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WOKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WOATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WOBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WOEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WOKKDT           On Yard Date
     C                     Z-ADD*ZERO     WOAVTM           On Yard Time
     C                     Z-ADD*ZERO     WOKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WOAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WOLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WOK0DT           Product Complet
     C                     Z-ADD*ZERO     WOAYTM           Product Complet
     C                     Z-ADD*ZERO     WOKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WOICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WOIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WOK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WOAZTM           Load Door 1
     C                     Z-ADD*ZERO     WOK2DT           Override Total
     C                     Z-ADD*ZERO     WOA0TM           Load Door 2
     C                     Z-ADD*ZERO     WOZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WOPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WOCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WOPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WOCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WOP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WOCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WOP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WOCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WOP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WOCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WOP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WOCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WRBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WRBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WRBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WRBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  80
     C                     Z-ADD*ZERO     WL0003  60
     C                     MOVEL*BLANK    WL0004 10
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  80
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  20
     C                     Z-ADD*ZERO     WL0020  80
     C                     Z-ADD*ZERO     WL0021  80
     C                     Z-ADD*ZERO     WL0022  60
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027  2
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  2
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033 30
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  10
     C                     MOVEL*BLANK    WL0036  6
     C                     Z-ADD*ZERO     WL0037  80
     C                     Z-ADD*ZERO     WL0038  60
     C                     Z-ADD*ZERO     WL0039  80
     C                     Z-ADD*ZERO     WL0040  60
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  30
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048 112
     C                     MOVEL*BLANK    WL0049  2
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052 30
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  60
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  50
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  60
      * Define local work field PFS Baseline Schedule
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field PFS Batch Sent Date
     C                     Z-ADD*ZERO     YN0001  80
      * Define null work field PFS Batch Sent Time
     C                     Z-ADD*ZERO     YN0002  60
      * Define null work field PFS Record Status
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field PFS Process Status
     C                     Z-ADD*ZERO     YN0004  10
      * Define null work field PFS Error Reason
     C                     MOVEL*BLANK    YN0005  6
      * Define null work field PFS Create Date
     C                     Z-ADD*ZERO     YN0006  80
      * Define null work field PFS Create Time
     C                     Z-ADD*ZERO     YN0007  60
      * Define null work field PFS Change Date
     C                     Z-ADD*ZERO     YN0008  80
      * Define null work field PFS Change time
     C                     Z-ADD*ZERO     YN0009  60
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field *System timestamp
     C                     MOVELXDTSDL    YL0005 26
      * Define local work field Year USR
     C                     MOVEL*BLANK    YL0006  4
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0009  8
      * Define local work field DATE
     C                     Z-ADD*ZERO     YL0010  80
      * Define local work field PFS Production Date
     C                     Z-ADD*ZERO     YL0011  80
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0012  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0013  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0014  20
      * Define local work field PFS Create Date
     C                     Z-ADD*ZERO     YL0015  80
      * Define local work field PFS Create Time
     C                     Z-ADD*ZERO     YL0016  60
      * Define local work field PFS Fill Qty Ship Date 0
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field PFS Fill Qty Ship Date 1
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field PFS Fill Qty Ship Date 2
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Post to G/L Date
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field PFS Fill Qty Ship Date 0
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field PFS Fill Qty Ship Date 2
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Kill Day Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field PFS Fill Qty Ship Date 1
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0026  3
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field PFS Fresh/Frozen
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field PFS Fill Qty Prod Sum
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Weight Sched Prod USR
     C                     Z-ADD*ZERO     YL0032  92
      * Define local work field Pieces Scheduled
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field PFS Fill Qty Prod
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field PFS Fill Qty Ship Day 0
     C                     Z-ADD*ZERO     YL0035  70
      * Define local work field PFS Fill Qty Ship Day 1
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field PFS Fill Qty Ship Day 2
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field PFS Fill Qty Ship Day 0
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field PFS Fill Qty Ship Day 1
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field PFS Fill Qty Ship Day 2
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field PFS Fill Qty Ship Day 0
     C                     Z-ADD*ZERO     YL0043  70
      * Define local work field PFS Fill Qty Ship Day 1
     C                     Z-ADD*ZERO     YL0044  70
      * Define local work field PFS Fill Qty Ship Day 2
     C                     Z-ADD*ZERO     YL0045  70
      * Define local work field PFS Order Line Sts
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field PFS Ordered Qty
     C                     Z-ADD*ZERO     YL0049  70
      * Define local work field OD Pallet Type
     C                     MOVEL*BLANK    YL0050  2
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0051 30
      * Define local work field PFS Load ID
     C                     Z-ADD*ZERO     YL0052  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0010  70
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0011  60
      * Define local work field PFS Loading Sequence
     C                     Z-ADD*ZERO     YL0053  20
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0054  70
      * Define local work field PFS Load Deadline Time
     C                     Z-ADD*ZERO     YL0055  60
      * Define local work field PFS Load Deadline Date
     C                     Z-ADD*ZERO     YL0056  80
      * Define local work field PFS Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0057  80
      * Define local work field PFS Batch Seq
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0059  40
      * Define local work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YL0060  70
      * Define local work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YL0061  70
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0012  2
      * Define local work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YL0063  52
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0013  30
      * Define local work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YL0064  30
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0014 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0015 40
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0065  70
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0066  70
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Chill Time USR
     C                     Z-ADD*ZERO     YL0068  30
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0069  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0070  70
      * Define local work field Work Ahead Combo OrderUSR
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field PFS Fill Qty Ship Day 0
     C                     Z-ADD*ZERO     YL0072  70
      * Define local work field PFS Fill Qty Ship Day 1
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field PFS Fill Qty Ship Day 2
     C                     Z-ADD*ZERO     YL0074  70
      * Define local work field PFS Order Line Sts
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0077  1
      * Define local work field PFS Ordered Qty
     C                     Z-ADD*ZERO     YL0078  70
      * Define local work field OD Pallet Type
     C                     MOVEL*BLANK    YL0079  2
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0080 30
      * Define local work field PFS Load ID
     C                     Z-ADD*ZERO     YL0081  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0016  70
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0017  60
      * Define local work field PFS Loading Sequence
     C                     Z-ADD*ZERO     YL0082  20
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0083  70
      * Define local work field PFS Load Deadline Time
     C                     Z-ADD*ZERO     YL0084  60
      * Define local work field PFS Load Deadline Date
     C                     Z-ADD*ZERO     YL0085  80
      * Define local work field PFS Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0086  80
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0087  70
      * Define local work field PFS Change Date
     C                     Z-ADD*ZERO     YL0088  80
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
