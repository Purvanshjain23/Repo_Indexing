     H/TITLE Exc Lock Loads- Batch XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 07/28/17  Time  : 14:47:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPLVIF  E           K        DISK
      * RSQ : Load Header               SSD/Dr/DpDtTM/Ld ECUL
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FJCPHB
      * Load Header               SSD/Dr/DpDtTM/Ld ECUL
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WDAJVN
     I              DRAUNA                          WDAUNA
     I              DRB8NA                          WDB8NA
     I              DRAHVN                          WDAHVN
     I              DRI6ST                          WDI6ST
     I              DRI7ST                          WDI7ST
     I              DRXMST                          WDXMST
     I              DRXNST                          WDXNST
     I              DRI8ST                          WDI8ST
     I              DRNLNB                          WDNLNB
     I              DRMPNA                          WDMPNA
     I              DRBCCD                          WDBCCD
     I              DRAIC3                          WDAIC3
     I              DRDQCD                          WDDQCD
     I              DRDRCD                          WDDRCD
     I              DRAJCD                          WDAJCD
     I              DRBUVN                          WDBUVN
     I              DRUVST                          WDUVST
     I              DRUWST                          WDUWST
     I              DRUXST                          WDUXST
     I              DRAATM                          WDAATM
     I              DRAYNA                          WDAYNA
     I              DRA0NA                          WDA0NA
     I              DRAXDT                          WDAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WEAJVN
     I              DTDNCD                          WEDNCD
     I              DTAIC3                          WEAIC3
     I              DTDQCD                          WEDQCD
     I              DTDRCD                          WEDRCD
     I              DTAJCD                          WEAJCD
     I              DTJFST                          WEJFST
     I              DTUVST                          WEUVST
     I              DTUWST                          WEUWST
     I              DTUXST                          WEUXST
     I              DTAATM                          WEAATM
     I              DTAYNA                          WEAYNA
     I              DTA0NA                          WEA0NA
     I              DTAXDT                          WEAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WGAIC3
     I              ABADTX                          WGADTX
     I              ABACNA                          WGACNA
     I              ABADNA                          WGADNA
     I              ABAENA                          WGAENA
     I              ABAJNA                          WGAJNA
     I              ABBTTX                          WGBTTX
     I              ABBVTX                          WGBVTX
     I              ABBWTX                          WGBWTX
     I              ABA2NA                          WGA2NA
     I              ABABTX                          WGABTX
     I              ABBGCD                          WGBGCD
     I              ABKXCD                          WGKXCD
     I              ABUVST                          WGUVST
     I              ABUWST                          WGUWST
     I              ABUXST                          WGUXST
     I              ABVSST                          WGVSST
     I              ABAATM                          WGAATM
     I              ABAYNA                          WGAYNA
     I              ABA0NA                          WGA0NA
     I              ABAXDT                          WGAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WIRONB
     I              FKDPTX                          WIDPTX
     I              FKRSNB                          WIRSNB
     I              FKRTNB                          WIRTNB
     I              FKTANB                          WITANB
     I              FKUVST                          WIUVST
     I              FKUWST                          WIUWST
     I              FKUXST                          WIUXST
     I              FKVSST                          WIVSST
     I              FKAATM                          WIAATM
     I              FKAYNA                          WIAYNA
     I              FKA0NA                          WIA0NA
     I              FKAXDT                          WIAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WKAJCD
     I              ADF8NA                          WKF8NA
     I              ADACNA                          WKACNA
     I              ADADNA                          WKADNA
     I              ADAENA                          WKAENA
     I              ADAJNA                          WKAJNA
     I              ADBTTX                          WKBTTX
     I              ADAOCD                          WKAOCD
     I              ADBGCD                          WKBGCD
     I              ADVHST                          WKVHST
     I              ADMPNA                          WKMPNA
     I              ADWPST                          WKWPST
     I              ADXUST                          WKXUST
     I              ADT0ST                          WKT0ST
     I              ADT1ST                          WKT1ST
     I              ADDBNB                          WKDBNB
     I              ADT2ST                          WKT2ST
     I              ADT3ST                          WKT3ST
     I              ADT4ST                          WKT4ST
     I              ADT6ST                          WKT6ST
     I              ADBWC3                          WKBWC3
     I              ADBTC3                          WKBTC3
     I              ADBUC3                          WKBUC3
     I              ADBVC3                          WKBVC3
     I              ADFCAA                          WKFCAA
     I              ADRQSX                          WKRQSX
     I              ADRRSX                          WKRRSX
     I              ADRSSX                          WKRSSX
     I              ADRTSX                          WKRTSX
     I              ADT7ST                          WKT7ST
     I              ADT8ST                          WKT8ST
     I              ADRNSX                          WKRNSX
     I              ADROSX                          WKROSX
     I              ADRPSX                          WKRPSX
     I              ADUVST                          WKUVST
     I              ADUWST                          WKUWST
     I              ADUXST                          WKUXST
     I              ADVSST                          WKVSST
     I              ADAATM                          WKAATM
     I              ADAYNA                          WKAYNA
     I              ADA0NA                          WKA0NA
     I              ADAXDT                          WKAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WLRMNB
     I              FJAIC3                          WLAIC3
     I              FJAODT                          WLAODT
     I              FJPJST                          WLPJST
     I              FJPKST                          WLPKST
     I              FJRNNB                          WLRNNB
     I              FJDMTX                          WLDMTX
     I              FJDNTX                          WLDNTX
     I              FJDOTX                          WLDOTX
     I              FJWTTX                          WLWTTX
     I              FJWUTX                          WLWUTX
     I              FJRPNB                          WLRPNB
     I              FJFLAM                          WLFLAM
     I              FJXQST                          WLXQST
     I              FJRRNB                          WLRRNB
     I              FJDXTX                          WLDXTX
     I              FJDYTX                          WLDYTX
     I              FJSBNB                          WLSBNB
     I              FJBZNA                          WLBZNA
     I              FJRONB                          WLRONB
     I              FJSQNB                          WLSQNB
     I              FJR1NB                          WLR1NB
     I              FJVCST                          WLVCST
     I              FJVDST                          WLVDST
     I              FJSDNB                          WLSDNB
     I              FJPAOU                          WLPAOU
     I              FJDGWG                          WLDGWG
     I              FJSXNB                          WLSXNB
     I              FJHADT                          WLHADT
     I              FJAART                          WLAART
     I              FJDHWG                          WLDHWG
     I              FJDIWG                          WLDIWG
     I              FJAQDT                          WLAQDT
     I              FJS6NB                          WLS6NB
     I              FJT4NB                          WLT4NB
     I              FJPRTM                          WLPRTM
     I              FJNPSV                          WLNPSV
     I              FJJ8TX                          WLJ8TX
     I              FJTLMI                          WLTLMI
     I              FJJ9TX                          WLJ9TX
     I              FJQ2CD                          WLQ2CD
     I              FJVPCD                          WLVPCD
     I              FJDBCD                          WLDBCD
     I              FJGRWE                          WLGRWE
     I              FJXCCD                          WLXCCD
     I              FJU2ST                          WLU2ST
     I              FJF9DT                          WLF9DT
     I              FJONTM                          WLONTM
     I              FJJ4DT                          WLJ4DT
     I              FJTRTM                          WLTRTM
     I              FJJ5DT                          WLJ5DT
     I              FJSPTM                          WLSPTM
     I              FJJ6DT                          WLJ6DT
     I              FJLFTM                          WLLFTM
     I              FJJ7DT                          WLJ7DT
     I              FJBOTM                          WLBOTM
     I              FJJ8DT                          WLJ8DT
     I              FJBLTM                          WLBLTM
     I              FJKIDT                          WLKIDT
     I              FJASTM                          WLASTM
     I              FJKADT                          WLKADT
     I              FJAJCM                          WLAJCM
     I              FJXACD                          WLXACD
     I              FJOANA                          WLOANA
     I              FJK4TX                          WLK4TX
     I              FJVOAG                          WLVOAG
     I              FJKBDT                          WLKBDT
     I              FJNBBO                          WLNBBO
     I              FJW4CD                          WLW4CD
     I              FJEFDT                          WLEFDT
     I              FJCNTN                          WLCNTN
     I              FJKCDT                          WLKCDT
     I              FJTMIN                          WLTMIN
     I              FJKDDT                          WLKDDT
     I              FJVMNB                          WLVMNB
     I              FJOCFR                          WLOCFR
     I              FJKJDT                          WLKJDT
     I              FJATTM                          WLATTM
     I              FJOTRS                          WLOTRS
     I              FJRNST                          WLRNST
     I              FJBRBK                          WLBRBK
     I              FJEIDT                          WLEIDT
     I              FJRMST                          WLRMST
     I              FJAJCD                          WLAJCD
     I              FJKKDT                          WLKKDT
     I              FJAVTM                          WLAVTM
     I              FJKZDT                          WLKZDT
     I              FJAXTM                          WLAXTM
     I              FJLHOS                          WLLHOS
     I              FJLHOR                          WLLHOR
     I              FJWNTX                          WLWNTX
     I              FJOITX                          WLOITX
     I              FJOJTX                          WLOJTX
     I              FJLLDT                          WLLLDT
     I              FJLSHG                          WLLSHG
     I              FJYPST                          WLYPST
     I              FJK0DT                          WLK0DT
     I              FJAYTM                          WLAYTM
     I              FJKNNX                          WLKNNX
     I              FJICWG                          WLICWG
     I              FJIDWG                          WLIDWG
     I              FJH9SX                          WLH9SX
     I              FJWOTX                          WLWOTX
     I              FJK1DT                          WLK1DT
     I              FJAZTM                          WLAZTM
     I              FJK2DT                          WLK2DT
     I              FJA0TM                          WLA0TM
     I              FJROST                          WLROST
     I              FJRPST                          WLRPST
     I              FJRQST                          WLRQST
     I              FJRRST                          WLRRST
     I              FJZBVA                          WLZBVA
     I              FJWPTX                          WLWPTX
     I              FJWQTX                          WLWQTX
     I              FJWRTX                          WLWRTX
     I              FJWSTX                          WLWSTX
     I              FJRVSX                          WLRVSX
     I              FJRUSX                          WLRUSX
     I              FJRWSX                          WLRWSX
     I              FJRXSX                          WLRXSX
     I              FJRYSX                          WLRYSX
     I              FJRZSX                          WLRZSX
     I              FJR0SX                          WLR0SX
     I              FJR1SX                          WLR1SX
     I              FJR2SX                          WLR2SX
     I              FJR3SX                          WLR3SX
     I              FJR4SX                          WLR4SX
     I              FJPYDT                          WLPYDT
     I              FJCKTM                          WLCKTM
     I              FJPZDT                          WLPZDT
     I              FJCLTM                          WLCLTM
     I              FJP0DT                          WLP0DT
     I              FJCMTM                          WLCMTM
     I              FJP1DT                          WLP1DT
     I              FJCNTM                          WLCNTM
     I              FJP2DT                          WLP2DT
     I              FJCOTM                          WLCOTM
     I              FJP3DT                          WLP3DT
     I              FJCQTM                          WLCQTM
     I              FJUVST                          WLUVST
     I              FJUWST                          WLUWST
     I              FJUXST                          WLUXST
     I              FJAATM                          WLAATM
     I              FJAYNA                          WLAYNA
     I              FJA0NA                          WLA0NA
     I              FJAXDT                          WLAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@LGCPNM
      * Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      * Renamed input format fields
     I              LGMILE                          WOMILE
     I              LGHRRQ                          WOHRRQ
     I              LGAATM                          WOAATM
     I              LGAYNA                          WOAYNA
     I              LGA0NA                          WOA0NA
     I              LGAXDT                          WOAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@LECPM7
      * Carrier Destination Rate  Retrieval index
      * Renamed input format fields
     I              LEBZNA                          WSBZNA
     I              LEAJCD                          WSAJCD
     I              LEXECD                          WSXECD
     I              LEBGCD                          WSBGCD
     I              LENMVA                          WSNMVA
     I              LEAVTX                          WSAVTX
     I              LEEPPR                          WSEPPR
     I              LEEQPR                          WSEQPR
     I              LEERPR                          WSERPR
     I              LELUSX                          WSLUSX
     I              LELVSX                          WSLVSX
     I              LEOQDT                          WSOQDT
     I              LEORDT                          WSORDT
     I              LEGXVL                          WSGXVL
     I              LEAATM                          WSAATM
     I              LEAYNA                          WSAYNA
     I              LEA0NA                          WSA0NA
     I              LEAXDT                          WSAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WTRMNB
     I              FLRUNB                          WTRUNB
     I              FLRVNB                          WTRVNB
     I              FLDQTX                          WTDQTX
     I              FLRWNB                          WTRWNB
     I              FLRXNB                          WTRXNB
     I              FLSQNB                          WTSQNB
     I              FLT0NB                          WTT0NB
     I              FLT1NB                          WTT1NB
     I              FLR1NB                          WTR1NB
     I              FLAIC3                          WTAIC3
     I              FLC4NB                          WTC4NB
     I              FLVCST                          WTVCST
     I              FLKEDT                          WTKEDT
     I              FLSXNB                          WTSXNB
     I              FLKFDT                          WTKFDT
     I              FLACTM                          WTACTM
     I              FLK5TX                          WTK5TX
     I              FLW5CD                          WTW5CD
     I              FLEJDT                          WTEJDT
     I              FLAGTM                          WTAGTM
     I              FLKJDT                          WTKJDT
     I              FLATTM                          WTATTM
     I              FLHDDT                          WTHDDT
     I              FLAUTM                          WTAUTM
     I              FLKKDT                          WTKKDT
     I              FLAVTM                          WTAVTM
     I              FLZ4NB                          WTZ4NB
     I              FLY7ST                          WTY7ST
     I              FLY2ST                          WTY2ST
     I              FLWHTX                          WTWHTX
     I              FLWITX                          WTWITX
     I              FLWJTX                          WTWJTX
     I              FLWKTX                          WTWKTX
     I              FLWLTX                          WTWLTX
     I              FLN7DT                          WTN7DT
     I              FLN8DT                          WTN8DT
     I              FLN9DT                          WTN9DT
     I              FLB3TM                          WTB3TM
     I              FLB4TM                          WTB4TM
     I              FLB5TM                          WTB5TM
     I              FLIASX                          WTIASX
     I              FLIBSX                          WTIBSX
     I              FLICSX                          WTICSX
     I              FLWVTX                          WTWVTX
     I              FLWWTX                          WTWWTX
     I              FLWXTX                          WTWXTX
     I              FLUVST                          WTUVST
     I              FLUWST                          WTUWST
     I              FLUXST                          WTUXST
     I              FLAATM                          WTAATM
     I              FLAYNA                          WTAYNA
     I              FLA0NA                          WTA0NA
     I              FLAXDT                          WTAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WVRMNB
     I              FLRUNB                          WVRUNB
     I              FLRVNB                          WVRVNB
     I              FLDQTX                          WVDQTX
     I              FLRWNB                          WVRWNB
     I              FLRXNB                          WVRXNB
     I              FLSQNB                          WVSQNB
     I              FLT0NB                          WVT0NB
     I              FLT1NB                          WVT1NB
     I              FLR1NB                          WVR1NB
     I              FLAIC3                          WVAIC3
     I              FLC4NB                          WVC4NB
     I              FLVCST                          WVVCST
     I              FLKEDT                          WVKEDT
     I              FLSXNB                          WVSXNB
     I              FLKFDT                          WVKFDT
     I              FLACTM                          WVACTM
     I              FLK5TX                          WVK5TX
     I              FLW5CD                          WVW5CD
     I              FLEJDT                          WVEJDT
     I              FLAGTM                          WVAGTM
     I              FLKJDT                          WVKJDT
     I              FLATTM                          WVATTM
     I              FLHDDT                          WVHDDT
     I              FLAUTM                          WVAUTM
     I              FLKKDT                          WVKKDT
     I              FLAVTM                          WVAVTM
     I              FLZ4NB                          WVZ4NB
     I              FLY7ST                          WVY7ST
     I              FLY2ST                          WVY2ST
     I              FLWHTX                          WVWHTX
     I              FLWITX                          WVWITX
     I              FLWJTX                          WVWJTX
     I              FLWKTX                          WVWKTX
     I              FLWLTX                          WVWLTX
     I              FLN7DT                          WVN7DT
     I              FLN8DT                          WVN8DT
     I              FLN9DT                          WVN9DT
     I              FLB3TM                          WVB3TM
     I              FLB4TM                          WVB4TM
     I              FLB5TM                          WVB5TM
     I              FLIASX                          WVIASX
     I              FLIBSX                          WVIBSX
     I              FLICSX                          WVICSX
     I              FLWVTX                          WVWVTX
     I              FLWWTX                          WVWWTX
     I              FLWXTX                          WVWXTX
     I              FLUVST                          WVUVST
     I              FLUWST                          WVUWST
     I              FLUXST                          WVUXST
     I              FLAATM                          WVAATM
     I              FLAYNA                          WVAYNA
     I              FLA0NA                          WVA0NA
     I              FLAXDT                          WVAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WXY1NX
     I              BUGYAA                          WXGYAA
     I              BURENA                          WXRENA
     I              BUWSSX                          WXWSSX
     I              BUWUSX                          WXWUSX
     I              BUQEDT                          WXQEDT
     I              BUCUTM                          WXCUTM
     I              BUB0NY                          WXB0NY
     I              BUB1NY                          WXB1NY
     I              BUWXSX                          WXWXSX
     I              BUWVSX                          WXWVSX
     I              BUWWSX                          WXWWSX
     I              BUUWSX                          WXUWSX
     I              BUUXSX                          WXUXSX
     I              BUV3SX                          WXV3SX
     I              BUAHNY                          WXAHNY
     I              BUAINY                          WXAINY
     I              BUAJNY                          WXAJNY
     I              BUAKNY                          WXAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PARMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WLRMNB
     I              FJAIC3                          WLAIC3
     I              FJAODT                          WLAODT
     I              FJPJST                          WLPJST
     I              FJPKST                          WLPKST
     I              FJRNNB                          WLRNNB
     I              FJDMTX                          WLDMTX
     I              FJDNTX                          WLDNTX
     I              FJDOTX                          WLDOTX
     I              FJWTTX                          WLWTTX
     I              FJWUTX                          WLWUTX
     I              FJRPNB                          WLRPNB
     I              FJFLAM                          WLFLAM
     I              FJXQST                          WLXQST
     I              FJRRNB                          WLRRNB
     I              FJDXTX                          WLDXTX
     I              FJDYTX                          WLDYTX
     I              FJSBNB                          WLSBNB
     I              FJBZNA                          WLBZNA
     I              FJRONB                          WLRONB
     I              FJSQNB                          WLSQNB
     I              FJR1NB                          WLR1NB
     I              FJVCST                          WLVCST
     I              FJVDST                          WLVDST
     I              FJSDNB                          WLSDNB
     I              FJPAOU                          WLPAOU
     I              FJDGWG                          WLDGWG
     I              FJSXNB                          WLSXNB
     I              FJHADT                          WLHADT
     I              FJAART                          WLAART
     I              FJDHWG                          WLDHWG
     I              FJDIWG                          WLDIWG
     I              FJAQDT                          WLAQDT
     I              FJS6NB                          WLS6NB
     I              FJT4NB                          WLT4NB
     I              FJPRTM                          WLPRTM
     I              FJNPSV                          WLNPSV
     I              FJJ8TX                          WLJ8TX
     I              FJTLMI                          WLTLMI
     I              FJJ9TX                          WLJ9TX
     I              FJQ2CD                          WLQ2CD
     I              FJVPCD                          WLVPCD
     I              FJDBCD                          WLDBCD
     I              FJGRWE                          WLGRWE
     I              FJXCCD                          WLXCCD
     I              FJU2ST                          WLU2ST
     I              FJF9DT                          WLF9DT
     I              FJONTM                          WLONTM
     I              FJJ4DT                          WLJ4DT
     I              FJTRTM                          WLTRTM
     I              FJJ5DT                          WLJ5DT
     I              FJSPTM                          WLSPTM
     I              FJJ6DT                          WLJ6DT
     I              FJLFTM                          WLLFTM
     I              FJJ7DT                          WLJ7DT
     I              FJBOTM                          WLBOTM
     I              FJJ8DT                          WLJ8DT
     I              FJBLTM                          WLBLTM
     I              FJKIDT                          WLKIDT
     I              FJASTM                          WLASTM
     I              FJKADT                          WLKADT
     I              FJAJCM                          WLAJCM
     I              FJXACD                          WLXACD
     I              FJOANA                          WLOANA
     I              FJK4TX                          WLK4TX
     I              FJVOAG                          WLVOAG
     I              FJKBDT                          WLKBDT
     I              FJNBBO                          WLNBBO
     I              FJW4CD                          WLW4CD
     I              FJEFDT                          WLEFDT
     I              FJCNTN                          WLCNTN
     I              FJKCDT                          WLKCDT
     I              FJTMIN                          WLTMIN
     I              FJKDDT                          WLKDDT
     I              FJVMNB                          WLVMNB
     I              FJOCFR                          WLOCFR
     I              FJKJDT                          WLKJDT
     I              FJATTM                          WLATTM
     I              FJOTRS                          WLOTRS
     I              FJRNST                          WLRNST
     I              FJBRBK                          WLBRBK
     I              FJEIDT                          WLEIDT
     I              FJRMST                          WLRMST
     I              FJAJCD                          WLAJCD
     I              FJKKDT                          WLKKDT
     I              FJAVTM                          WLAVTM
     I              FJKZDT                          WLKZDT
     I              FJAXTM                          WLAXTM
     I              FJLHOS                          WLLHOS
     I              FJLHOR                          WLLHOR
     I              FJWNTX                          WLWNTX
     I              FJOITX                          WLOITX
     I              FJOJTX                          WLOJTX
     I              FJLLDT                          WLLLDT
     I              FJLSHG                          WLLSHG
     I              FJYPST                          WLYPST
     I              FJK0DT                          WLK0DT
     I              FJAYTM                          WLAYTM
     I              FJKNNX                          WLKNNX
     I              FJICWG                          WLICWG
     I              FJIDWG                          WLIDWG
     I              FJH9SX                          WLH9SX
     I              FJWOTX                          WLWOTX
     I              FJK1DT                          WLK1DT
     I              FJAZTM                          WLAZTM
     I              FJK2DT                          WLK2DT
     I              FJA0TM                          WLA0TM
     I              FJROST                          WLROST
     I              FJRPST                          WLRPST
     I              FJRQST                          WLRQST
     I              FJRRST                          WLRRST
     I              FJZBVA                          WLZBVA
     I              FJWPTX                          WLWPTX
     I              FJWQTX                          WLWQTX
     I              FJWRTX                          WLWRTX
     I              FJWSTX                          WLWSTX
     I              FJRVSX                          WLRVSX
     I              FJRUSX                          WLRUSX
     I              FJRWSX                          WLRWSX
     I              FJRXSX                          WLRXSX
     I              FJRYSX                          WLRYSX
     I              FJRZSX                          WLRZSX
     I              FJR0SX                          WLR0SX
     I              FJR1SX                          WLR1SX
     I              FJR2SX                          WLR2SX
     I              FJR3SX                          WLR3SX
     I              FJR4SX                          WLR4SX
     I              FJPYDT                          WLPYDT
     I              FJCKTM                          WLCKTM
     I              FJPZDT                          WLPZDT
     I              FJCLTM                          WLCLTM
     I              FJP0DT                          WLP0DT
     I              FJCMTM                          WLCMTM
     I              FJP1DT                          WLP1DT
     I              FJCNTM                          WLCNTM
     I              FJP2DT                          WLP2DT
     I              FJCOTM                          WLCOTM
     I              FJP3DT                          WLP3DT
     I              FJCQTM                          WLCQTM
     I              FJUVST                          WLUVST
     I              FJUWST                          WLUWST
     I              FJUXST                          WLUXST
     I              FJAATM                          WLAATM
     I              FJAYNA                          WLAYNA
     I              FJA0NA                          WLA0NA
     I              FJAXDT                          WLAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYBRDCS      DS                            793
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   3   60P1AODT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0001
      * *SFLSEL
     I                                        5   5 ZA0002
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Load ID
     I                                    P   2   50ZA0004
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Load ID
     I                                    P   2   50ZA0006
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0007
      * Load ID
     I                                    P   4   70ZA0008
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0009
      * Load ID
     I                                    P   8  110ZA0010
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0011
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0012
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0013
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0014
      * *SFLSEL
     I                                        5   5 ZA0015
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0016
      * *SFLSEL
     I                                        5   5 ZA0017
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0018
      * Load ID
     I                                    P   2   50ZA0019
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0020
      * Load ID
     I                                    P   2   50ZA0021
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0022
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0023
      * USR CDE Parm 1
     I                                        4   6 ZA0024
      * USR CDE Parm 2
     I                                        7   9 ZA0025
      * USR CDE Parm 3
     I                                       10  12 ZA0026
      * USR CDE Parm 4
     I                                       13  15 ZA0027
      * USR CDE Parm 5
     I                                       16  18 ZA0028
      * USR CDE Parm 6
     I                                       19  21 ZA0029
      * USR CDE Parm 7
     I                                       22  24 ZA0030
      * USR CDE Parm 8
     I                                       25  27 ZA0031
      * USR CDE Parm 9
     I                                       28  30 ZA0032
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AODT    PARM           WP0002  70       Scheduled Ship
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Lock Loads- Batch XF
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Rtv Lock Loads- Batch RT - Load Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Lock Loads- Batch RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAODT    WQSA02           Scheduled Ship
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Scheduled Ship
      * Setup key
     C                     Z-ADDP1AODT    WQSA02           Scheduled Ship
      * Establish starting position
     C           KRSSA     SETLL@FJCPHB                    *
     C           KRSSA     READE@FJCPHB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Company Number EQ PAR.Company Number
     C           WAAIC3    IFEQ P1AIC3                     *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Load Status is Unlock
      *   |- c2    : DB1.Load Status is Combined
      *   '-
     C           WAPKST    IFEQ 'U'                        *IF
     C           WAPKST    OREQ 'C'                        *OR
      * P001251 09/20/2011 Don't lock if errors still pending in Order De
      * E00495 11/04/2009 Pass Yes as lock option so date won't be checke
      *
     C                     MOVEL*BLANK    WN0001  1        Load Status
     C                     Z-ADD*ZERO     WN0002  70       Total Load Orde
     C                     MOVEL*BLANK    WN0003  3        Carrier Code
     C                     MOVEL*BLANK    WN0004  7        Truck Size
     C                     MOVEL*BLANK    WN0005  2        Shipping Method
     C                     MOVEL*BLANK    WN0006  1        Load Acceptance
     C                     MOVEL*BLANK    WN0007  1        Block Order Fla
      *
      * EDT Lock Load Edit/INF IF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR SBRVGN
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
     C                     EXSR SCRVGN
      *
     C                     Z-ADD*ZERO     WN0008  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0009  70       Minimum pounds
     C                     MOVEL*BLANK    WN0010  1        USR Orders on L
     C                     MOVEL*BLANK    WN0011  1        Order in Use
     C                     MOVEL*BLANK    WN0012  1        Header Status
     C                     MOVEL*BLANK    WN0013  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0014 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0014           User Profile Na
      *
     C                     MOVEL*BLANK    WN0015 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SDRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0015    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0014    WL0001    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0002    P      Application Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0015    WL0001    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0002    P      Application Cod
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0002    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0002    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0001    IFGT 0                          *IF
     C                     Z-ADDYL0001    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0002    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0013           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0013    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR SHRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0001           Load ID
     C                     MOVELWUSEL     ZA0002           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0007    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0003           *SFLSEL
     C                     Z-ADDWARMNB    ZA0004           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0001    IFEQ 'I'                        *IF
     C           WN0001    OREQ 'L'
     C           WN0001    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUSEL     ZA0005           *SFLSEL
     C                     Z-ADDWARMNB    ZA0006           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ WUGSTX                     *IF
     C           'N'       IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWN0003    ZA0007           Carrier Code
     C                     Z-ADDWARMNB    ZA0008           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0004    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0004    ZA0009           Truck Size
     C                     Z-ADDWARMNB    ZA0010           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0005    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0005    ZA0011           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0010    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0012           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0006    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0013           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
     C                     EXSR SIRVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0012    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0014           Load ID
     C                     MOVELWUSEL     ZA0015           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0012    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0016           Load ID
     C                     MOVELWUSEL     ZA0017           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0011    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0018           *SFLSEL
     C                     Z-ADDWARMNB    ZA0019           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVELWUSEL     ZA0020           *SFLSEL
     C                     Z-ADDWARMNB    ZA0021           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR SKRVGN
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0002    IFLT WN0009                     *IF
      * Setup message data for message
     C                     Z-ADDWARMNB    ZA0022           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0002    IFGT WN0008                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
      * ** This update recalcs the DDD/T based on Carrier appt dt/tm E004
      *
     C                     Z-ADD*ZERO     WN0016  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0017 112       Flat Amount
     C                     Z-ADD*ZERO     WN0018  50       Total Stops
     C                     Z-ADD*ZERO     WN0019  70       Total Load Mile
     C                     MOVEL*BLANK    WN0020  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0021  2        Ship To State C
     C                     MOVEL*BLANK    WN0022  3        Carrier Broker
     C                     MOVEL*BLANK    WN0023  1        Export Status
     C                     MOVEL*BLANK    WN0024  3        Shipping Line
     C                     MOVEL*BLANK    WN0025 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0026  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0027  60       Deadline Depart
     C                     MOVEL*BLANK    WN0028  1        MG Created Load
     C                     MOVEL*BLANK    WN0029  2        Load U/M
     C                     MOVEL*BLANK    WN0030  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0031 20        Destination Cit
     C                     MOVEL*BLANK    WN0032  2        State Code
     C                     MOVEL*BLANK    WN0033  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0034  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0035  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0036  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0037  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0038  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0039  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0040  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0041  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0042  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0043 155       Company Number
     C                     Z-ADD*ZERO     WN0044 155       Date 1
     C                     Z-ADD*ZERO     WN0045 155       Order Number 1
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR SLRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0020    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR SMRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0028    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR SRRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0026           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR SSRVGN
     C           WN0046    MULT 100       WN0027           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0193  51       Hours Required
     C                     Z-ADD*ZERO     WN0194  50       Miles to next s
     C                     Z-ADD*ZERO     WN0195  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0196  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0197  50       @Days 5
     C                     Z-ADD*ZERO     WN0198  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0199  20       USR Period
     C                     Z-ADD*ZERO     WN0200  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0201  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR SURVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0005    IFEQ 'CT'                       *IF
     C           YL0005    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0005           Load ID
     C                     Z-ADD0         WL0006           Stop/Drop
     C                     Z-ADD0         WL0007           Order Number
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WN0194           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0194    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDWARMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0003  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0004  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0005           Load ID
     C                     Z-ADD0         WL0006           Stop/Drop
     C                     Z-ADD0         WL0007           Order Number
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WN0194           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0194    IFEQ 0                          *IF
     C                     Z-ADD0         WN0026           Scheduled Deliv
     C                     Z-ADD0         WN0027           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0193           Hours Required
     C                     Z-ADD0         YL0006           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR SWRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0005  70       Load ID
     C           YL0007    PARM YL0007    WQ0006  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0006    ADD  YL0007    WN0193           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0193    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0193    DIV  24        WN0197           @Days 5
     C           WN0197    MULT 24        WU               USR Hours 5.0
     C           WN0193    SUB  WU        WN0195           USR Hours 5.0
     C           WN0195    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0197    IFGT 0                          *IF
     C                     MULT -1        WN0197           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0026    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0197    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0026
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0026
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0027                     *IF
     C                     SUB  WN0027    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0197           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0026    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0197    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0026
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0026
     C                     END
     C           240000    SUB  WUPINB    WN0027           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0027           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
     C                     EXSR SYRVGN
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0018    IFEQ 1                          *IF
     C           WN0017    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR TARVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0031    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0031           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UESUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR TCCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0016    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR TDRVGN
     C                     Z-ADDWAAIC3    WN0043           Company Number
     C                     Z-ADDWARMNB    WN0045           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0016    WN0044           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0033    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0047    PARM *BLANK    WQ0009  7        Return Code Usr
     C                     PARM 'OMS'     WQ0010  6        Application Cod
     C                     PARM @CN,002   WQ0011 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0012  1        USR Detail or S
     C                     PARM @CN,003   WQ0013 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0014 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0015  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0016  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0017  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0018 10        PRT Night Queue
     C           WN0043    PARM WN0043    WQ0019 155       Company Number
     C           WN0044    PARM WN0044    WQ0020 155       Date 1
     C           WN0045    PARM WN0045    WQ0021 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0022 155       System Value Nu
     C           WN0033    PARM WN0033    WQ0023  3        USR Warehouse C
     C           WN0034    PARM WN0034    WQ0024  3        USR CDE Parm 1
     C           WN0035    PARM WN0035    WQ0025  3        USR CDE Parm 2
     C           WN0036    PARM WN0036    WQ0026  3        USR CDE Parm 3
     C           WN0037    PARM WN0037    WQ0027  3        USR CDE Parm 4
     C           WN0038    PARM WN0038    WQ0028  3        USR CDE Parm 5
     C           WN0039    PARM WN0039    WQ0029  3        USR CDE Parm 6
     C           WN0040    PARM WN0040    WQ0030  3        USR CDE Parm 7
     C           WN0041    PARM WN0041    WQ0031  3        USR CDE Parm 8
     C           WN0042    PARM WN0042    WQ0032  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0033  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0034  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0339  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
     C                     EXSR TFRVGN
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR TJRVGN
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0008    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0339    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0035  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0036  70       Load ID
     C                     PARM WAAIC3    WQ0037  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0038  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0009    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0039  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0040  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,004                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0016    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0033    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0033    WQ0041  3        Warehouse Code
     C                     PARM *BLANK    WQ0042 10        Default Printer
     C           YL0010    PARM *BLANK    WQ0043  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0010    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0033    ZA0023           USR Warehouse C
     C                     MOVELWN0034    ZA0024           USR CDE Parm 1
     C                     MOVELWN0035    ZA0025           USR CDE Parm 2
     C                     MOVELWN0036    ZA0026           USR CDE Parm 3
     C                     MOVELWN0037    ZA0027           USR CDE Parm 4
     C                     MOVELWN0038    ZA0028           USR CDE Parm 5
     C                     MOVELWN0039    ZA0029           USR CDE Parm 6
     C                     MOVELWN0040    ZA0030           USR CDE Parm 7
     C                     MOVELWN0041    ZA0031           USR CDE Parm 8
     C                     MOVELWN0042    ZA0032           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UFSUBR                     ***** Change Lo
     C                     MOVEL'L'       YL0011           Load Status
     C                     MOVEL*BLANK    YL0012           Load Change Typ
     C                     MOVEL'LOCK'    YL0012           Load Change Typ
     C                     MOVEL'TRF'     YL0013           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWARMNB    PBRMNB           Load ID
     C                     Z-ADD0         PBRVNB           Stop/Drop
     C                     MOVELYL0012    PBRVST    P      Load Change Typ
     C                     MOVELYL0013    PBUJST    P      Department Cont
     C                     MOVELYL0011    PBMNTX    P      Change Log Prio
     C                     MOVEL'L'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWABZNA    PBBZNA    P      Carrier Code
     C                     Z-ADDWAAIC3    PBAIC3           Company Number
     C                     Z-ADD0         PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@FJCPHB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSB     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVEL*BLANK    WN0001           Load Status
     C                     Z-ADD*ZERO     WURNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WN0002           Total Load Orde
     C                     Z-ADD*ZERO     WUFLAM           Flat Amount
     C                     MOVEL*BLANK    WUXQST           Allocate Pounds
     C                     MOVEL*BLANK    WN0003           Carrier Code
     C                     MOVEL*BLANK    WN0004           Truck Size
     C                     Z-ADD*ZERO     WUR1NB           Rated Freight
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     WUT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    WN0005           Shipping Method
     C                     MOVEL*BLANK    WUVPCD           Ship From Wareh
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     MOVEL*BLANK    WN0006           Load Acceptance
     C                     Z-ADD*ZERO     WUK2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    WUAODT           Scheduled Ship
     C                     MOVELWBPKST    WN0001           Load Status
     C                     Z-ADDWBRNNB    WURNNB           Reefer Temperat
     C                     Z-ADDWBRPNB    WN0002           Total Load Orde
     C                     Z-ADDWBFLAM    WUFLAM           Flat Amount
     C                     MOVELWBXQST    WUXQST           Allocate Pounds
     C                     MOVELWBBZNA    WN0003           Carrier Code
     C                     MOVELWBRONB    WN0004           Truck Size
     C                     Z-ADDWBR1NB    WUR1NB           Rated Freight
     C                     MOVELWBVDST    WUVDST           Load Type
     C                     Z-ADDWBT4NB    WUT4NB           Schedule Sequen
     C                     Z-ADDWBTLMI    WUTLMI           Total Load Mile
     C                     MOVELWBQ2CD    WN0005           Shipping Method
     C                     MOVELWBVPCD    WUVPCD           Ship From Wareh
     C                     MOVELWBDBCD    WUDBCD           Ship To State C
     C                     MOVELWBXCCD    WUXCCD           Carrier Broker
     C                     MOVELWBRMST    WN0006           Load Acceptance
     C                     Z-ADDWBK2DT    WUK2DT           Override Total
     C                     MOVELWBWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WUJDST           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WN0007           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@BFCPD9                    *
     C           KRSSC     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUJDST           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WCBCST    IFEQ 'B'                        *IF
     C                     MOVELWCBCST    WN0007           Block Order Fla
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0014    WDAJVN           User Profile Na
      * Establish starting position
     C           KRSSD     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDI6ST    WUG0TX           Allow Multi-Com
     C                     MOVELWDMPNA    WUG0TX           Default Printer
     C                     MOVELWDBCCD    WUG0TX           Salesperson Cod
     C                     Z-ADDWDAIC3    YL0001           Company Number
     C                     MOVELWDBUVN    WN0015           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJVN           User Profile Na
     C                     KFLD           WEDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    WEAJVN           User Profile Na
     C                     MOVELWL0002    WEDNCD           Application Cod
      * Establish starting position
     C           KRSSE     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAIC3    WL0003           Company Number
     C                     MOVELWEAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBWC3    WQSF01           Shipping Compan
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0003    WQSF01           Shipping Compan
      * Establish starting position
     C           KRSSF     SETLL@ADREWA                    *
     C           KRSSF     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WFVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WFAOCD    IFNE *BLANK                     *IF
     C                     MOVELWFAOCD    WUG0TX           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WGAIC3           Company Number
      * Establish starting position
     C           KRSSG     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Name
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGADTX    WUG0TX           Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0010           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSH02           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSH02           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FLCPEB                    *
     C           KRSSH     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WHRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0010           Status - Y or N
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0011           Order in Use
     C                     MOVEL*BLANK    WN0012           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@BFCPD9                    *
     C           KRSSI     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WCGWST    IFEQ 'H'                        *IF
     C                     MOVELWCGWST    WN0012           Header Status
     C                     GOTO SIEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WCGWST    IFEQ 'X'                        *IF
     C                     MOVELWCGWST    WN0012           Header Status
     C                     GOTO SIEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WCGJST    IFEQ 'Y'                        *IF
     C                     MOVELWCGJST    WN0011           Order in Use
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSJ02           Load ID
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSJ02           Load ID
      * Establish starting position
     C           KRSSJ     SETLL@BFCPD9                    *
     C           KRSSJ     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Order Requires
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCFUSX    YL0004           Order Requires
     C           KRSSJ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIRONB           Truck Size
      * Setup key
     C                     MOVELWN0004    WIRONB           Truck Size
      * Establish starting position
     C           KRSSK     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0008           Maximum pounds
     C                     Z-ADD*ZERO     WN0009           Minimum pounds
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIRSNB    WN0008           Maximum pounds
     C                     Z-ADDWITANB    WN0009           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    WN0016           Scheduled Ship
     C                     MOVELWBPJST    WUG0TX           LTL Flag
     C                     MOVELWBPKST    WUG0TX           Load Status
     C                     Z-ADDWBRNNB    WUNFNN           Reefer Temperat
     C                     MOVELWBDMTX    WUG0TX           Seal 1
     C                     MOVELWBDNTX    WUG0TX           Seal 2
     C                     MOVELWBDOTX    WUG0TX           Seal 3
     C                     Z-ADDWBRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDWBFLAM    WN0017           Flat Amount
     C                     MOVELWBXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDWBRRNB    WN0018           Total Stops
     C                     MOVELWBDXTX    WUG0TX           Trailer Id
     C                     MOVELWBDYTX    WUG0TX           Transloader Car
     C                     Z-ADDWBSBNB    WUNFNN           BOL Time
     C                     MOVELWBBZNA    WUG0TX           Carrier Code
     C                     MOVELWBRONB    WUG0TX           Truck Size
     C                     Z-ADDWBSQNB    WUNFNN           Ld Hdr/Ld Dtl U
     C                     Z-ADDWBR1NB    WUNFNN           Rated Freight
     C                     MOVELWBVCST    WUG0TX           Ship Status
     C                     MOVELWBVDST    WUG0TX           Load Type
     C                     Z-ADDWBSDNB    WUNFNN           Number Pallets
     C                     Z-ADDWBPAOU    WUNFNN           Number Pallets
     C                     Z-ADDWBDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDWBSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDWBHADT    WUNFNN           Actual Arrival
     C                     Z-ADDWBAART    WUNFNN           Actual Arrival
     C                     Z-ADDWBDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDWBDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWBAQDT    WUNFNN           Actual Departur
     C                     Z-ADDWBS6NB    WUNFNN           Departure Time
     C                     Z-ADDWBT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDWBPRTM    WUNFNN           Product Tempera
     C                     Z-ADDWBNPSV    WUNFNN           Number Pallets
     C                     MOVELWBJ8TX    WUG0TX           Car/Veh. Initia
     C                     Z-ADDWBTLMI    WN0019           Total Load Mile
     C                     MOVELWBJ9TX    WUG0TX           Recorder ID
     C                     MOVELWBQ2CD    WUG0TX           Shipping Method
     C                     MOVELWBVPCD    WN0020           Ship From Wareh
     C                     MOVELWBDBCD    WN0021           Ship To State C
     C                     Z-ADDWBGRWE    WUNFNN           Gross Weight
     C                     MOVELWBXCCD    WN0022           Carrier Broker
     C                     MOVELWBU2ST    WN0023           Export Status
     C                     Z-ADDWBF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELWBONTM    WUG0TX           On Time - (Y/N)
     C                     Z-ADDWBJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDWBTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDWBJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDWBSPTM    WUNFNN           Spotted Time
     C                     Z-ADDWBJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDWBLFTM    WUNFNN           Load Finished T
     C                     Z-ADDWBJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDWBBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDWBJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDWBBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDWBKIDT    WUNFNN           Truck Departure
     C                     Z-ADDWBASTM    WUNFNN           Truck Departure
     C                     Z-ADDWBKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDWBAJCM    WUNFNN           Adjusted Depart
     C                     MOVELWBXACD    WUG0TX           Shipping Line
     C                     MOVELWBOANA    WUG0TX           Port Delv Termi
     C                     MOVELWBK4TX    WUG0TX           Vessel Name
     C                     Z-ADDWBVOAG    WUNFNN           Voyage
     C                     Z-ADDWBKBDT    WUNFNN           Sail Date
     C                     MOVELWBNBBO    WUG0TX           Booking Number
     C                     MOVELWBW4CD    WUG0TX           Discharge Port
     C                     Z-ADDWBEFDT    WUNFNN           Arrival Date
     C                     MOVELWBCNTN    WUG0TX           Container Numbe
     C                     Z-ADDWBKCDT    WUNFNN           Date In
     C                     Z-ADDWBTMIN    WUNFNN           Time In
     C                     Z-ADDWBKDDT    WUNFNN           Date Out
     C                     Z-ADDWBVMNB    WUNFNN           Time Out
     C                     Z-ADDWBOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDWBKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDWBATTM    WUNFNN           Scheduled Deliv
     C                     MOVELWBOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDWBKKDT    WUNFNN           On Yard Date
     C                     Z-ADDWBAVTM    WUNFNN           On Yard Time
     C                     Z-ADDWBKZDT    WN0026           Deadline Depart
     C                     Z-ADDWBAXTM    WN0027           Deadline Depart
     C                     MOVELWBRYSX    WN0028           MG Created Load
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0048  70       Total Load Mile
     C                     MOVEL*BLANK    WN0049  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0050  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0051  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR SNRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           WBAJCD    IFEQ WN0049                     *IF
     C                     MOVEL*BLANK    WN0050           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBAJCD    WN0050           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           WBRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDWBTLMI    WN0048           Total Load Mile
     C                     Z-ADDWBK2DT    WN0051           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDWBRMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WN0048    PARM WN0048    WQ0001  70       Total Load Mile
     C           WN0051    PARM WN0051    WQ0002  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSN02           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSN02           Load ID
     C                     Z-ADD1         WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSSN     SETLL@FLCPEB                    *
     C           KRSSN     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SORVGN
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WJC4NB    WQSO02           Order Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WQSO01           Company Number
     C                     Z-ADDWHC4NB    WQSO02           Order Number
     C                     Z-ADD0         WJDPNB           Order Sequence
     C                     Z-ADD0         WJUENB           Order Secondary
      * Establish starting position
     C           KPSSO     SETLL@BGWKAE                    *
     C           KRSSO     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0049           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SPRVGN
      * PAR = DB1 By name
     C                     MOVELWJAJCD    WN0049           Warehouse Code
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWJAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0052  30       Company Number
     C                     Z-ADD*ZERO     WN0053  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0054  1        LTL Flag
     C                     MOVEL*BLANK    WN0055  1        Load Status
     C                     Z-ADD*ZERO     WN0056  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0057 15        Seal 1
     C                     MOVEL*BLANK    WN0058 15        Seal 2
     C                     MOVEL*BLANK    WN0059 15        Seal 3
     C                     MOVEL*BLANK    WN0060 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0061 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0062  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0063 112       Flat Amount
     C                     MOVEL*BLANK    WN0064  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0065  50       Total Stops
     C                     MOVEL*BLANK    WN0066 20        Trailer Id
     C                     MOVEL*BLANK    WN0067  3        Transloader Car
     C                     Z-ADD*ZERO     WN0068  40       BOL Time
     C                     MOVEL*BLANK    WN0069  3        Carrier Code
     C                     MOVEL*BLANK    WN0070  7        Truck Size
     C                     Z-ADD*ZERO     WN0071  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0072 112       Rated Freight
     C                     MOVEL*BLANK    WN0073  1        Ship Status
     C                     MOVEL*BLANK    WN0074  1        Load Type
     C                     Z-ADD*ZERO     WN0075  50       Number Pallets
     C                     Z-ADD*ZERO     WN0076  50       Number Pallets
     C                     Z-ADD*ZERO     WN0077 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0078  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0079  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0080  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0081 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0082 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0083  70       Actual Departur
     C                     Z-ADD*ZERO     WN0084  40       Departure Time
     C                     Z-ADD*ZERO     WN0085  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0086  52       Product Tempera
     C                     Z-ADD*ZERO     WN0087  50       Number Pallets
     C                     MOVEL*BLANK    WN0088 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0089 12        Recorder ID
     C                     MOVEL*BLANK    WN0090  2        Shipping Method
     C                     MOVEL*BLANK    WN0091  2        Ship To State C
     C                     Z-ADD*ZERO     WN0092  70       Gross Weight
     C                     MOVEL*BLANK    WN0093  3        Carrier Broker
     C                     MOVEL*BLANK    WN0094  1        Export Status
     C                     Z-ADD*ZERO     WN0095  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0096  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0097  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0098  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0099  70       Spotted Date
     C                     Z-ADD*ZERO     WN0100  60       Spotted Time
     C                     Z-ADD*ZERO     WN0101  70       Load Finished D
     C                     Z-ADD*ZERO     WN0102  60       Load Finished T
     C                     Z-ADD*ZERO     WN0103  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0104  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0105  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0106  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0107  70       Truck Departure
     C                     Z-ADD*ZERO     WN0108  60       Truck Departure
     C                     Z-ADD*ZERO     WN0109  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0110  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0111  3        Shipping Line
     C                     MOVEL*BLANK    WN0112 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0113 30        Vessel Name
     C                     Z-ADD*ZERO     WN0114  50       Voyage
     C                     Z-ADD*ZERO     WN0115  70       Sail Date
     C                     MOVEL*BLANK    WN0116 12        Booking Number
     C                     MOVEL*BLANK    WN0117 20        Discharge Port
     C                     Z-ADD*ZERO     WN0118  70       Arrival Date
     C                     MOVEL*BLANK    WN0119 12        Container Numbe
     C                     Z-ADD*ZERO     WN0120  70       Date In
     C                     Z-ADD*ZERO     WN0121  60       Time In
     C                     Z-ADD*ZERO     WN0122  70       Date Out
     C                     Z-ADD*ZERO     WN0123  60       Time Out
     C                     Z-ADD*ZERO     WN0124 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0125  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0126  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0127  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0128  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0129  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0130  70       Requested Deliv
     C                     MOVEL*BLANK    WN0131  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0132  70       On Yard Date
     C                     Z-ADD*ZERO     WN0133  60       On Yard Time
     C                     Z-ADD*ZERO     WN0134  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0135  60       Deadline Depart
     C                     MOVEL*BLANK    WN0136  1        Load Held Over
     C                     MOVEL*BLANK    WN0137  1        Load Held Over
     C                     MOVEL*BLANK    WN0138 15        Load Held Over
     C                     MOVEL*BLANK    WN0139 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0140 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0141  70       Express Mail Da
     C                     MOVEL*BLANK    WN0142  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0143  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0144  70       Product Complet
     C                     Z-ADD*ZERO     WN0145  60       Product Complet
     C                     Z-ADD*ZERO     WN0146  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0147  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0148  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0149  1        Load Confirmed
     C                     MOVEL*BLANK    WN0150 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0151  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0152  60       Load Door 1
     C                     Z-ADD*ZERO     WN0153  60       Load Door 2
     C                     MOVEL*BLANK    WN0154  1        Partial Load
     C                     MOVEL*BLANK    WN0155  1        Load Confirmati
     C                     MOVEL*BLANK    WN0156  1        Export Load USD
     C                     MOVEL*BLANK    WN0157  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0158 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0159 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0160 15        Late Billing Em
     C                     MOVEL*BLANK    WN0161 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0162 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0163  1        Multi Company L
     C                     MOVEL*BLANK    WN0164  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0165  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0166  1        LH Power Only L
     C                     MOVEL*BLANK    WN0167  1        MG Created Load
     C                     MOVEL*BLANK    WN0168  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0169  2        Load U/M
     C                     MOVEL*BLANK    WN0170  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0171  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0172  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0173  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0174  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0175  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0176  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0177  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0178  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0179  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0180  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0181  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0182  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0183  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0184  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0185  60       LH Unused Time
     C                     MOVEL*BLANK    WN0186  1        EDI Status 1
     C                     MOVEL*BLANK    WN0187  1        EDI Status 2
     C                     MOVEL*BLANK    WN0188  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0189  60       Job Time
     C                     MOVEL*BLANK    WN0190 10        User Id
     C                     MOVEL*BLANK    WN0191 10        Job Name
     C                     Z-ADD*ZERO     WN0192  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWBRMNB    WLRMNB           Load ID
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WLRMNB           Load ID
     C           KLCHSQ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0048    WLTLMI           Total Load Mile
     C                     MOVELWN0049    WLVPCD    P      Ship From Wareh
     C                     MOVELWN0050    WLAJCD    P      Warehouse Code
     C                     Z-ADDWN0051    WLK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSR02           Load ID
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSR02           Load ID
     C                     Z-ADD0         WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSSR     SETLL@FLCPEB                    *
     C           KRSSR     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDWHB3TM    WN0027           LD Carrier Appt
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSS02           Load ID
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSS02           Load ID
     C                     Z-ADD0         WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSSS     SETLL@FLCPEB                    *
     C           KRSSS     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR STRVGN
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WMAIC3           Company Number
     C                     Z-ADDWHC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN0026           Requested Deliv
     C                     Z-ADD*ZERO     WN0046           Requested Deliv
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBRTX    WUBRTX           Ship To Name
     C                     MOVELWMHNNA    WUHNNA           Ship To City
     C                     Z-ADDWMEIDT    WN0026           Requested Deliv
     C                     Z-ADDWMAFTM    WN0046           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBQ2CD    YL0005           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSV02           Load ID
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
     C                     KFLD           WHC4NB           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADDWL0005    WQSV02           Load ID
     C                     Z-ADDWL0006    WHRVNB           Stop/Drop
     C                     Z-ADDWL0007    WHC4NB           Order Number
      * Establish starting position
     C           KPSSV     SETLL@FLCPEB                    *
     C           KRSSV     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHRWNB    WL0008           Miles to next s
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WOMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0194    WOMILE           Miles to First
      * Establish starting position
     C           KPSSW     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOHRRQ    YL0006           Hours Required
     C                     GOTO SWEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSX     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBPKST    WUG0TX           Load Status
     C                     Z-ADDWBTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDWBK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRRMNB    WQSY02           Load ID
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSY02           Load ID
      * Establish starting position
     C           KRSSY     SETLL@FLCPE8                    *
     C           KRSSY     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR SZRVGN
     C                     GOTO SYEXIT                     *QUIT
     C           KRSSY     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWRAIC3    WMAIC3           Company Number
     C                     Z-ADDWRC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSSZ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMBKC7    WUBKC7           Ship To Custome
     C                     MOVELWMBRTX    WUBRTX           Ship To Name
     C                     MOVELWMHMNA    WUHMNA           Ship To Address
     C                     MOVELWMHONA    WUHONA           Ship To Address
     C                     MOVELWMHPNA    WUHPNA           Ship To Address
     C                     MOVELWMHNNA    WUHNNA           Ship To City
     C                     MOVELWMDBCD    WN0021           Ship To State C
     C                     MOVELWMCKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELWMBCNA    WUG0TX           Customer Purcha
     C                     MOVELWMB6NA    WUG0TX           Special Instruc
     C                     MOVELWMBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWMEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWMAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQTA02           Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQTA02           Load ID
      * Establish starting position
     C           KRSTA     SETLL@BFCPD9                    *
     C           KRSTA     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCHNNA    WN0031           Ship To City
     C                     MOVELWCDBCD    WN0032           Ship To State C
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WSBZNA           Carrier Code
     C                     KFLD           WSAJCD           Warehouse Code
     C                     KFLD           WSXECD           Destination Cit
     C                     KFLD           WSBGCD           State Code
      * Setup key
     C                     MOVELWN0022    WSBZNA           Carrier Code
     C                     MOVELWN0020    WSAJCD           Warehouse Code
     C                     MOVELWN0031    WSXECD           Destination Cit
     C                     MOVELWN0032    WSBGCD           State Code
      * Establish starting position
     C           KRSTB     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           WSAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDWSNMVA    WN0017           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0202  30       Company Number
     C                     MOVEL*BLANK    WN0203  1        LTL Flag
     C                     Z-ADD*ZERO     WN0204  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0205 15        Seal 1
     C                     MOVEL*BLANK    WN0206 15        Seal 2
     C                     MOVEL*BLANK    WN0207 15        Seal 3
     C                     MOVEL*BLANK    WN0208 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0209 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0210  70       Total Load Orde
     C                     MOVEL*BLANK    WN0211  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0212  50       Total Stops
     C                     MOVEL*BLANK    WN0213 20        Trailer Id
     C                     MOVEL*BLANK    WN0214  3        Transloader Car
     C                     Z-ADD*ZERO     WN0215  40       BOL Time
     C                     MOVEL*BLANK    WN0216  3        Carrier Code
     C                     MOVEL*BLANK    WN0217  7        Truck Size
     C                     Z-ADD*ZERO     WN0218  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0219 112       Rated Freight
     C                     MOVEL*BLANK    WN0220  1        Ship Status
     C                     MOVEL*BLANK    WN0221  1        Load Type
     C                     Z-ADD*ZERO     WN0222  50       Number Pallets
     C                     Z-ADD*ZERO     WN0223  50       Number Pallets
     C                     Z-ADD*ZERO     WN0224 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0225  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0226  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0227  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0228 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0229 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0230  70       Actual Departur
     C                     Z-ADD*ZERO     WN0231  40       Departure Time
     C                     Z-ADD*ZERO     WN0232  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0233  52       Product Tempera
     C                     Z-ADD*ZERO     WN0234  50       Number Pallets
     C                     MOVEL*BLANK    WN0235 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0236  70       Total Load Mile
     C                     MOVEL*BLANK    WN0237 12        Recorder ID
     C                     MOVEL*BLANK    WN0238  2        Shipping Method
     C                     Z-ADD*ZERO     WN0239  70       Gross Weight
     C                     MOVEL*BLANK    WN0240  3        Carrier Broker
     C                     MOVEL*BLANK    WN0241  1        Export Status
     C                     Z-ADD*ZERO     WN0242  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0243  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0244  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0245  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0246  70       Spotted Date
     C                     Z-ADD*ZERO     WN0247  60       Spotted Time
     C                     Z-ADD*ZERO     WN0248  70       Load Finished D
     C                     Z-ADD*ZERO     WN0249  60       Load Finished T
     C                     Z-ADD*ZERO     WN0250  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0251  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0252  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0253  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0254  70       Truck Departure
     C                     Z-ADD*ZERO     WN0255  60       Truck Departure
     C                     Z-ADD*ZERO     WN0256  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0257  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0258  3        Shipping Line
     C                     MOVEL*BLANK    WN0259 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0260 30        Vessel Name
     C                     Z-ADD*ZERO     WN0261  50       Voyage
     C                     Z-ADD*ZERO     WN0262  70       Sail Date
     C                     MOVEL*BLANK    WN0263 12        Booking Number
     C                     MOVEL*BLANK    WN0264 20        Discharge Port
     C                     Z-ADD*ZERO     WN0265  70       Arrival Date
     C                     MOVEL*BLANK    WN0266 12        Container Numbe
     C                     Z-ADD*ZERO     WN0267  70       Date In
     C                     Z-ADD*ZERO     WN0268  60       Time In
     C                     Z-ADD*ZERO     WN0269  70       Date Out
     C                     Z-ADD*ZERO     WN0270  60       Time Out
     C                     Z-ADD*ZERO     WN0271 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0272  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0273  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0274  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0275  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0276  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0277  70       Requested Deliv
     C                     MOVEL*BLANK    WN0278  1        Load Acceptance
     C                     MOVEL*BLANK    WN0279  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0280  70       On Yard Date
     C                     Z-ADD*ZERO     WN0281  60       On Yard Time
     C                     MOVEL*BLANK    WN0282  1        Load Held Over
     C                     MOVEL*BLANK    WN0283  1        Load Held Over
     C                     MOVEL*BLANK    WN0284 15        Load Held Over
     C                     MOVEL*BLANK    WN0285 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0286 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0287  70       Express Mail Da
     C                     MOVEL*BLANK    WN0288  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0289  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0290  70       Product Complet
     C                     Z-ADD*ZERO     WN0291  60       Product Complet
     C                     Z-ADD*ZERO     WN0292  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0293  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0294  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0295  1        Load Confirmed
     C                     MOVEL*BLANK    WN0296 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0297  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0298  60       Load Door 1
     C                     Z-ADD*ZERO     WN0299  70       Override Total
     C                     Z-ADD*ZERO     WN0300  60       Load Door 2
     C                     MOVEL*BLANK    WN0301  1        Partial Load
     C                     MOVEL*BLANK    WN0302  1        Load Confirmati
     C                     MOVEL*BLANK    WN0303  1        Export Load USD
     C                     MOVEL*BLANK    WN0304  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0305 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0306 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0307 15        Late Billing Em
     C                     MOVEL*BLANK    WN0308 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0309 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0310  1        Multi Company L
     C                     MOVEL*BLANK    WN0311  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0312  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0313  1        LH Power Only L
     C                     MOVEL*BLANK    WN0314  1        MG Created Load
     C                     MOVEL*BLANK    WN0315  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0316  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0317  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0318  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0319  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0320  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0321  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0322  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0323  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0324  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0325  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0326  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0327  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0328  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0329  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0330  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0331  60       LH Unused Time
     C                     MOVEL*BLANK    WN0332  1        EDI Status 1
     C                     MOVEL*BLANK    WN0333  1        EDI Status 2
     C                     MOVEL*BLANK    WN0334  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0335  60       Job Time
     C                     MOVEL*BLANK    WN0336 10        User Id
     C                     MOVEL*BLANK    WN0337 10        Job Name
     C                     Z-ADD*ZERO     WN0338  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWARMNB    WLRMNB           Load ID
      *
     C           KLCHTC    KLIST
     C                     KFLD           WLRMNB           Load ID
     C           KLCHTC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0016    WLAODT           Scheduled Ship
     C                     MOVEL'L'       WLPKST    P      Load Status
     C                     Z-ADDWN0017    WLFLAM           Flat Amount
     C                     MOVELWN0020    WLVPCD    P      Ship From Wareh
     C                     MOVELWN0021    WLDBCD    P      Ship To State C
     C                     Z-ADDWN0026    WLKZDT           Deadline Depart
     C                     Z-ADDWN0027    WLAXTM           Deadline Depart
     C                     MOVELWN0029    WLR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0033           USR Warehouse C
     C                     MOVEL*BLANK    WN0034           USR CDE Parm 1
     C                     MOVEL*BLANK    WN0035           USR CDE Parm 2
     C                     MOVEL*BLANK    WN0036           USR CDE Parm 3
     C                     MOVEL*BLANK    WN0037           USR CDE Parm 4
     C                     MOVEL*BLANK    WN0038           USR CDE Parm 5
     C                     MOVEL*BLANK    WN0039           USR CDE Parm 6
     C                     MOVEL*BLANK    WN0040           USR CDE Parm 7
     C                     MOVEL*BLANK    WN0041           USR CDE Parm 8
     C                     MOVEL*BLANK    WN0042           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTRMNB    WQTD02           Load ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQTD02           Load ID
      * Establish starting position
     C           KRSTD     SETLL@FLCPKF                    *
     C           KRSTD     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR TERVGN
     C           KRSTD     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTE01           Company Number
     C           *LIKE     DEFN WJC4NB    WQTE02           Order Number
      * Define keylist
     C           KPSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Order Number
      * Setup key
     C                     Z-ADDWTAIC3    WQTE01           Company Number
     C                     Z-ADDWTC4NB    WQTE02           Order Number
     C                     Z-ADD0         WJDPNB           Order Sequence
     C                     Z-ADD0         WJUENB           Order Secondary
      * Establish starting position
     C           KPSTE     SETLL@BGWKAE                    *
     C           KRSTE     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WJAJCD    IFEQ WN0033                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WJAJCD    IFEQ WN0034                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WJAJCD    IFEQ WN0035                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WJAJCD    IFEQ WN0036                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WJAJCD    IFEQ WN0037                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WJAJCD    IFEQ WN0038                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WJAJCD    IFEQ WN0039                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WJAJCD    IFEQ WN0040                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WJAJCD    IFEQ WN0041                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WJAJCD    IFEQ WN0042                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN0033    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0033           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN0034    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0034           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN0035    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0035           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN0036    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0036           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN0037    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0037           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN0038    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0038           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN0039    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0039           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN0040    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0040           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN0041    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0041           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN0042    IFEQ WUGSTX                     *IF
     C                     MOVELWJAJCD    WN0042           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTE     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVRMNB    WQTF01           Load ID
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQTF01           Load ID
      * Establish starting position
     C           KRSTF     SETLL@FLCPBW                    *
     C           KRSTF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR TGRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0339           Trans Contol AS
     C                     GOTO TFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTF     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Setup key
     C                     Z-ADDWVAIC3    WMAIC3           Company Number
     C                     Z-ADDWVC4NB    WMC4NB           Order Number
      * Establish starting position
     C           KRSTG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR THRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTH01           Company Number
     C           *LIKE     DEFN WWC4NB    WQTH02           Order Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WQTH01           Company Number
     C                     Z-ADDWMC4NB    WQTH02           Order Number
      * Establish starting position
     C           KRSTH     SETLL@BGWKL1                    *
     C           KRSTH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WWGMST    IFEQ 'L'                        *IF
     C           WWGMST    OREQ 'A'
     C           WWGMST    OREQ 'C'
     C           WWGMST    OREQ 'R'
     C           WWGMST    OREQ 'E'
     C           WWGMST    OREQ 'H'
     C           WWGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR TIRVGN
     C                     GOTO THEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWWAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSTI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWKXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WXY1NX           PFS Company Num
     C                     KFLD           WXGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWAAIC3    WXY1NX           PFS Company Num
     C                     MOVEL'LDORDD'  WXGYAA           PFS Interface C
      * Establish starting position
     C           KRSTJ     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0009           PFS Carlisle Ac
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWXWSSX    YL0008           PFS AccuSort Ac
     C                     MOVELWXWUSX    YL0009           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 09/20/2011 LJB P001251 Don't lock if errors pending in Order Deta
      *    in function 'EDT Lock Load Edit/INF IF - Load Header'
      * 11/03/2009 LJB E00495  Change to restrict on the passed in date
      * 10/01/2009 LJB E00495  Don't lock if shipping after today
      * RMC 07/24/09 FP1054 dont lock if shipping later than tomorrow
      * RMC 02/23/07 Lock the loads in batch that are still "U"nlocked or
      *   "C"ombined leaving current date and later.
      * RMC 04/05/07 Added Company & Sched ship date parms
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 11/03/2009 LJB E00495
      * ** Change to restrict on the date entered and pass Yes in the
      * ** Lock Option Status so the date won't be checked
      * ** 09/30/2009 LJB E00495
      * ** Base Deadline Departure Date calcs on the Carrier appointment
      * ** date/time, if entered. Auto-lock if shipping today, else,
      * ** return "Y" in the error status field.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0007  70       Load ID
     C           WN0029    PARM *BLANK    WQ0008  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Pallets
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field *SFLSEL
     C                     MOVEL*BLANK    WUSEL   1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Define work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDNLNB           Entity Number
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WFBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WFBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WFBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WHRWNB           Miles to next s
     C                     Z-ADD*ZERO     WHRXNB           Freight Charge
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WHT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHKFDT           Appointment Con
     C                     Z-ADD*ZERO     WHACTM           Appointment Con
     C                     Z-ADD*ZERO     WHEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WHAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHZ4NB           MPC Number
     C                     Z-ADD*ZERO     WHN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WHN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WHN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WHB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WHB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WHB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WIRTNB           Maximum Units
     C                     Z-ADD*ZERO     WITANB           Minimum pounds
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WJDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WJDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WJDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WJDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WJGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WJGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WJGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WJPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WJRINY           Item Age Days
     C                     Z-ADD*ZERO     WJTIDT           Production Ovr
     C                     Z-ADD*ZERO     WJTJDT           Production Ovr
     C                     Z-ADD*ZERO     WJTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WJTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WJTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOMILE           Miles to First
     C                     Z-ADD*ZERO     WOHRRQ           Hours Required
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSNMVA           Flat Rate
     C                     Z-ADD*ZERO     WSEPPR           Bulk Rate
     C                     Z-ADD*ZERO     WSEQPR           Export Fresh Fl
     C                     Z-ADD*ZERO     WSERPR           Export Frozen F
     C                     Z-ADD*ZERO     WSOQDT           CDR Unused Date
     C                     Z-ADD*ZERO     WSORDT           CDR Unused Date
     C                     Z-ADD*ZERO     WSGXVL           CDR Unused Amou
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WXQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WXCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WXB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WXB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WXUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WXAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WXAINY           PFS Create Time
     C                     Z-ADD*ZERO     WXAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WXAKNY           PFS Change time
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  50
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  50
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0004  2
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0006  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0007  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0002 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field Department Control Code
     C                     MOVEL*BLANK    YL0013  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 PDIZPCLP
00003 Auto Print Prelim. Pick
00004 PDSNPFR
