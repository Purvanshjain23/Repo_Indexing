     H/TITLE Clc Carcass Analysis  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:36:02
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB1CPLHIF  E           K        DISK
      * RTV : Carcass Detail            Active Carcasses Only
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPLBPCPL2IF  E           K        DISK
      * RSQ : Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      *
     FPKBYREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Row  Cmp/MinCrc(d)
      *
     FPKBZREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%
      *
     FPKBZREL3IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      *
     FPKBYREL1IF  E           K        DISK
      * RTV : Carcass Merit Matrix Row  Retrieval index
      *
     FPKBZREL6IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      *
     FPKBZREL5IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      *
     FPKB1CPLIIF  E           K        DISK
      * RTV : Carcass Detail            Add f/Avg Value
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     FPKB1CPLDIF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index Purge
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDGCPL0IF  E           K        DISK                      A
      * UPD : Competitors Tattoo        Update index
      *
     I@B1CPEF
      * Carcass Detail            Active Carcasses Only
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WBAMCD
     I              ARA3TX                          WBA3TX
     I              ARDLST                          WBDLST
     I              ARDMST                          WBDMST
     I              ARDOST                          WBDOST
     I              ARDQST                          WBDQST
     I              ARAZPC                          WBAZPC
     I              ARA0PC                          WBA0PC
     I              ARDTST                          WBDTST
     I              ARF5ST                          WBF5ST
     I              ARI1PR                          WBI1PR
     I              ARVEPR                          WBVEPR
     I              ARVFPR                          WBVFPR
     I              ARVHPR                          WBVHPR
     I              ARVIPR                          WBVIPR
     I              ARVJPR                          WBVJPR
     I              ARZ2ST                          WBZ2ST
     I              ARZ3ST                          WBZ3ST
     I              ARZ4ST                          WBZ4ST
     I              ARAAVN                          WBAAVN
     I              ARAADT                          WBAADT
     I              ARAMTM                          WBAMTM
     I              ARAJST                          WBAJST
     I              ARAHVN                          WBAHVN
     I              ARAGVN                          WBAGVN
     I              ARABVN                          WBABVN
     I              ARABDT                          WBABDT
     I              ARABTM                          WBABTM
      *
     I@BPCPSK
      * Carcass Merit Prog MktGrp CMP/Mkt/Group/PurchDteDe
      * Renamed input format fields
     I              BPAMCD                          WCAMCD
     I              BPGYDT                          WCGYDT
     I              BPPXCD                          WCPXCD
     I              BPPYCD                          WCPYCD
     I              BPAAVN                          WCAAVN
     I              BPAADT                          WCAADT
     I              BPAMTM                          WCAMTM
     I              BPAJST                          WCAJST
     I              BPAHVN                          WCAHVN
     I              BPAGVN                          WCAGVN
     I              BPABVN                          WCABVN
     I              BPABDT                          WCABDT
     I              BPABTM                          WCABTM
      *
     I@BYREJ9
      * Carcass Merit Matrix Row  Cmp/MinCrc(d)
      * Renamed input format fields
     I              BYAMCD                          WDAMCD
     I              BYE8NB                          WDE8NB
     I              BYEGNB                          WDEGNB
     I              BYEHNB                          WDEHNB
     I              BYEINB                          WDEINB
     I              BYEJNB                          WDEJNB
     I              BYEKNB                          WDEKNB
     I              BYAQPC                          WDAQPC
     I              BYEMNB                          WDEMNB
     I              BYE2NB                          WDE2NB
     I              BYLJA1                          WDLJA1
     I              BYAAVN                          WDAAVN
     I              BYAADT                          WDAADT
     I              BYAMTM                          WDAMTM
     I              BYAJST                          WDAJST
     I              BYAHVN                          WDAHVN
     I              BYAGVN                          WDAGVN
     I              BYABVN                          WDABVN
     I              BYABDT                          WDABDT
     I              BYABTM                          WDABTM
      *
     I@BZREKA
      * Carcass Merit Matrix Col  Cmp/Row/Lean%
      * Renamed input format fields
     I              BZAMCD                          WEAMCD
     I              BZE8NB                          WEE8NB
     I              BZE4NB                          WEE4NB
     I              BZA1PC                          WEA1PC
     I              BZE7NB                          WEE7NB
     I              BZCHCD                          WECHCD
     I              BZERNB                          WEERNB
     I              BZAAVN                          WEAAVN
     I              BZAADT                          WEAADT
     I              BZAMTM                          WEAMTM
     I              BZAJST                          WEAJST
     I              BZAHVN                          WEAHVN
     I              BZAGVN                          WEAGVN
     I              BZABVN                          WEABVN
     I              BZABDT                          WEABDT
     I              BZABTM                          WEABTM
      *
     I@BZREPO
      * Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      * Renamed input format fields
     I              BZAMCD                          WFAMCD
     I              BZE8NB                          WFE8NB
     I              BZE4NB                          WFE4NB
     I              BZA1PC                          WFA1PC
     I              BZE7NB                          WFE7NB
     I              BZCHCD                          WFCHCD
     I              BZERNB                          WFERNB
     I              BZAAVN                          WFAAVN
     I              BZAADT                          WFAADT
     I              BZAMTM                          WFAMTM
     I              BZAJST                          WFAJST
     I              BZAHVN                          WFAHVN
     I              BZAGVN                          WFAGVN
     I              BZABVN                          WFABVN
     I              BZABDT                          WFABDT
     I              BZABTM                          WFABTM
      *
     I@BYREGF
      * Carcass Merit Matrix Row  Retrieval index
      * Renamed input format fields
     I              BYAMCD                          WGAMCD
     I              BYE8NB                          WGE8NB
     I              BYEGNB                          WGEGNB
     I              BYEHNB                          WGEHNB
     I              BYEINB                          WGEINB
     I              BYEJNB                          WGEJNB
     I              BYEKNB                          WGEKNB
     I              BYAQPC                          WGAQPC
     I              BYEMNB                          WGEMNB
     I              BYE2NB                          WGE2NB
     I              BYLJA1                          WGLJA1
     I              BYAAVN                          WGAAVN
     I              BYAADT                          WGAADT
     I              BYAMTM                          WGAMTM
     I              BYAJST                          WGAJST
     I              BYAHVN                          WGAHVN
     I              BYAGVN                          WGAGVN
     I              BYABVN                          WGABVN
     I              BYABDT                          WGABDT
     I              BYABTM                          WGABTM
      *
     I@BZRETM
      * Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      * Renamed input format fields
     I              BZAMCD                          WHAMCD
     I              BZE8NB                          WHE8NB
     I              BZE4NB                          WHE4NB
     I              BZA1PC                          WHA1PC
     I              BZE7NB                          WHE7NB
     I              BZCHCD                          WHCHCD
     I              BZERNB                          WHERNB
     I              BZAAVN                          WHAAVN
     I              BZAADT                          WHAADT
     I              BZAMTM                          WHAMTM
     I              BZAJST                          WHAJST
     I              BZAHVN                          WHAHVN
     I              BZAGVN                          WHAGVN
     I              BZABVN                          WHABVN
     I              BZABDT                          WHABDT
     I              BZABTM                          WHABTM
      *
     I@BZRETL
      * Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      * Renamed input format fields
     I              BZAMCD                          WIAMCD
     I              BZE8NB                          WIE8NB
     I              BZE4NB                          WIE4NB
     I              BZA1PC                          WIA1PC
     I              BZE7NB                          WIE7NB
     I              BZCHCD                          WICHCD
     I              BZERNB                          WIERNB
     I              BZAAVN                          WIAAVN
     I              BZAADT                          WIAADT
     I              BZAMTM                          WIAMTM
     I              BZAJST                          WIAJST
     I              BZAHVN                          WIAHVN
     I              BZAGVN                          WIAGVN
     I              BZABVN                          WIABVN
     I              BZABDT                          WIABDT
     I              BZABTM                          WIABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WJHMNB
     I              B1BNNB                          WJBNNB
     I              B1BONB                          WJBONB
     I              B1CVNB                          WJCVNB
     I              B1B0DT                          WJB0DT
     I              B1LGNB                          WJLGNB
     I              B1EUNB                          WJEUNB
     I              B1LHNB                          WJLHNB
     I              B1INST                          WJINST
     I              B1BEPR                          WJBEPR
     I              B1ASPC                          WJASPC
     I              B1EWNB                          WJEWNB
     I              B1B4PR                          WJB4PR
     I              B1EYNB                          WJEYNB
     I              B1B1PR                          WJB1PR
     I              B1AVPR                          WJAVPR
     I              B1AUPC                          WJAUPC
     I              B1AWPR                          WJAWPR
     I              B1AXPR                          WJAXPR
     I              B1EZNB                          WJEZNB
     I              B1AYPR                          WJAYPR
     I              B1BBDT                          WJBBDT
     I              B1AKTM                          WJAKTM
     I              B1IQST                          WJIQST
     I              B1EFST                          WJEFST
     I              B1H6NB                          WJH6NB
     I              B1BEPC                          WJBEPC
     I              B1GCST                          WJGCST
     I              B1GDST                          WJGDST
     I              B1GEST                          WJGEST
     I              B1BHPC                          WJBHPC
     I              B1IOST                          WJIOST
     I              B1IPST                          WJIPST
     I              B1LTNB                          WJLTNB
     I              B1JNST                          WJJNST
     I              B1X4NB                          WJX4NB
     I              B1FNPC                          WJFNPC
     I              B1FOPC                          WJFOPC
     I              B1FPPC                          WJFPPC
     I              B1K2ST                          WJK2ST
     I              B1K3ST                          WJK3ST
     I              B1JWPR                          WJJWPR
     I              B1F5PC                          WJF5PC
     I              B1JXPR                          WJJXPR
     I              B1JYPR                          WJJYPR
     I              B1JZPR                          WJJZPR
     I              B1J0PR                          WJJ0PR
     I              B1J1PR                          WJJ1PR
     I              B1J2PR                          WJJ2PR
     I              B1J3PR                          WJJ3PR
     I              B1J4PR                          WJJ4PR
     I              B1UTST                          WJUTST
     I              B1HVCD                          WJHVCD
     I              B1DKJR                          WJDKJR
     I              B1ITJF                          WJITJF
     I              B1IJGR                          WJIJGR
     I              B1ORJE                          WJORJE
     I              B1OTJR                          WJOTJR
     I              B1PEIR                          WJPEIR
     I              B1IEUF                          WJIEUF
     I              B1ORUE                          WJORUE
     I              B1IUTR                          WJIUTR
     I              B1IJRR                          WJIJRR
     I              B1VCST                          WJVCST
     I              B1VDST                          WJVDST
     I              B1VEST                          WJVEST
     I              B1VFST                          WJVFST
     I              B1VGST                          WJVGST
     I              B1ABCD                          WJABCD
     I              B1AACD                          WJAACD
     I              B1AAVN                          WJAAVN
     I              B1AADT                          WJAADT
     I              B1AMTM                          WJAMTM
     I              B1AJST                          WJAJST
     I              B1AHVN                          WJAHVN
     I              B1AGVN                          WJAGVN
     I              B1ABVN                          WJABVN
     I              B1ABDT                          WJABDT
     I              B1ABTM                          WJABTM
      *
     I@B1CPVI
      * Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WKHMNB
     I              B1BNNB                          WKBNNB
     I              B1BONB                          WKBONB
     I              B1CVNB                          WKCVNB
     I              B1B0DT                          WKB0DT
     I              B1LGNB                          WKLGNB
     I              B1EUNB                          WKEUNB
     I              B1LHNB                          WKLHNB
     I              B1INST                          WKINST
     I              B1BEPR                          WKBEPR
     I              B1ASPC                          WKASPC
     I              B1EWNB                          WKEWNB
     I              B1B4PR                          WKB4PR
     I              B1EYNB                          WKEYNB
     I              B1B1PR                          WKB1PR
     I              B1AVPR                          WKAVPR
     I              B1AUPC                          WKAUPC
     I              B1AWPR                          WKAWPR
     I              B1AXPR                          WKAXPR
     I              B1EZNB                          WKEZNB
     I              B1AYPR                          WKAYPR
     I              B1BBDT                          WKBBDT
     I              B1AKTM                          WKAKTM
     I              B1IQST                          WKIQST
     I              B1EFST                          WKEFST
     I              B1H6NB                          WKH6NB
     I              B1BEPC                          WKBEPC
     I              B1GCST                          WKGCST
     I              B1GDST                          WKGDST
     I              B1GEST                          WKGEST
     I              B1BHPC                          WKBHPC
     I              B1IOST                          WKIOST
     I              B1IPST                          WKIPST
     I              B1LTNB                          WKLTNB
     I              B1JNST                          WKJNST
     I              B1X4NB                          WKX4NB
     I              B1FNPC                          WKFNPC
     I              B1FOPC                          WKFOPC
     I              B1FPPC                          WKFPPC
     I              B1K2ST                          WKK2ST
     I              B1K3ST                          WKK3ST
     I              B1JWPR                          WKJWPR
     I              B1F5PC                          WKF5PC
     I              B1JXPR                          WKJXPR
     I              B1JYPR                          WKJYPR
     I              B1JZPR                          WKJZPR
     I              B1J0PR                          WKJ0PR
     I              B1J1PR                          WKJ1PR
     I              B1J2PR                          WKJ2PR
     I              B1J3PR                          WKJ3PR
     I              B1J4PR                          WKJ4PR
     I              B1UTST                          WKUTST
     I              B1HVCD                          WKHVCD
     I              B1DKJR                          WKDKJR
     I              B1ITJF                          WKITJF
     I              B1IJGR                          WKIJGR
     I              B1ORJE                          WKORJE
     I              B1OTJR                          WKOTJR
     I              B1PEIR                          WKPEIR
     I              B1IEUF                          WKIEUF
     I              B1ORUE                          WKORUE
     I              B1IUTR                          WKIUTR
     I              B1IJRR                          WKIJRR
     I              B1VCST                          WKVCST
     I              B1VDST                          WKVDST
     I              B1VEST                          WKVEST
     I              B1VFST                          WKVFST
     I              B1VGST                          WKVGST
     I              B1ABCD                          WKABCD
     I              B1AACD                          WKAACD
     I              B1AAVN                          WKAAVN
     I              B1AADT                          WKAADT
     I              B1AMTM                          WKAMTM
     I              B1AJST                          WKAJST
     I              B1AHVN                          WKAHVN
     I              B1AGVN                          WKAGVN
     I              B1ABVN                          WKABVN
     I              B1ABDT                          WKABDT
     I              B1ABTM                          WKABTM
      *
     I@B1CPEG
      * Carcass Detail            Add f/Avg Value
      * Renamed input format fields
     I              B1HMNB                          WLHMNB
     I              B1BNNB                          WLBNNB
     I              B1BONB                          WLBONB
     I              B1CVNB                          WLCVNB
     I              B1B0DT                          WLB0DT
     I              B1LGNB                          WLLGNB
     I              B1EUNB                          WLEUNB
     I              B1LHNB                          WLLHNB
     I              B1INST                          WLINST
     I              B1BEPR                          WLBEPR
     I              B1ASPC                          WLASPC
     I              B1EWNB                          WLEWNB
     I              B1B4PR                          WLB4PR
     I              B1EYNB                          WLEYNB
     I              B1B1PR                          WLB1PR
     I              B1AVPR                          WLAVPR
     I              B1AUPC                          WLAUPC
     I              B1AWPR                          WLAWPR
     I              B1AXPR                          WLAXPR
     I              B1EZNB                          WLEZNB
     I              B1AYPR                          WLAYPR
     I              B1BBDT                          WLBBDT
     I              B1AKTM                          WLAKTM
     I              B1IQST                          WLIQST
     I              B1EFST                          WLEFST
     I              B1H6NB                          WLH6NB
     I              B1BEPC                          WLBEPC
     I              B1GCST                          WLGCST
     I              B1GDST                          WLGDST
     I              B1GEST                          WLGEST
     I              B1BHPC                          WLBHPC
     I              B1IOST                          WLIOST
     I              B1IPST                          WLIPST
     I              B1LTNB                          WLLTNB
     I              B1JNST                          WLJNST
     I              B1X4NB                          WLX4NB
     I              B1FNPC                          WLFNPC
     I              B1FOPC                          WLFOPC
     I              B1FPPC                          WLFPPC
     I              B1K2ST                          WLK2ST
     I              B1K3ST                          WLK3ST
     I              B1JWPR                          WLJWPR
     I              B1F5PC                          WLF5PC
     I              B1JXPR                          WLJXPR
     I              B1JYPR                          WLJYPR
     I              B1JZPR                          WLJZPR
     I              B1J0PR                          WLJ0PR
     I              B1J1PR                          WLJ1PR
     I              B1J2PR                          WLJ2PR
     I              B1J3PR                          WLJ3PR
     I              B1J4PR                          WLJ4PR
     I              B1UTST                          WLUTST
     I              B1HVCD                          WLHVCD
     I              B1DKJR                          WLDKJR
     I              B1ITJF                          WLITJF
     I              B1IJGR                          WLIJGR
     I              B1ORJE                          WLORJE
     I              B1OTJR                          WLOTJR
     I              B1PEIR                          WLPEIR
     I              B1IEUF                          WLIEUF
     I              B1ORUE                          WLORUE
     I              B1IUTR                          WLIUTR
     I              B1IJRR                          WLIJRR
     I              B1VCST                          WLVCST
     I              B1VDST                          WLVDST
     I              B1VEST                          WLVEST
     I              B1VFST                          WLVFST
     I              B1VGST                          WLVGST
     I              B1ABCD                          WLABCD
     I              B1AACD                          WLAACD
     I              B1AAVN                          WLAAVN
     I              B1AADT                          WLAADT
     I              B1AMTM                          WLAMTM
     I              B1AJST                          WLAJST
     I              B1AHVN                          WLAHVN
     I              B1AGVN                          WLAGVN
     I              B1ABVN                          WLABVN
     I              B1ABDT                          WLABDT
     I              B1ABTM                          WLABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WMAKCD
     I              AQALCD                          WMALCD
     I              AQAHDT                          WMAHDT
     I              AQA2ST                          WMA2ST
     I              AQAZPR                          WMAZPR
     I              AQA0PR                          WMA0PR
     I              AQA9PC                          WMA9PC
     I              AQA7PR                          WMA7PR
     I              AQA8PR                          WMA8PR
     I              AQF3ST                          WMF3ST
     I              AQA9PR                          WMA9PR
     I              AQERCD                          WMERCD
     I              AQESCD                          WMESCD
     I              AQF6PR                          WMF6PR
     I              AQJ3TX                          WMJ3TX
     I              AQABCD                          WMABCD
     I              AQAECD                          WMAECD
     I              AQAGCD                          WMAGCD
     I              AQAICD                          WMAICD
     I              AQAMCD                          WMAMCD
     I              AQAAVN                          WMAAVN
     I              AQAADT                          WMAADT
     I              AQAMTM                          WMAMTM
     I              AQAJST                          WMAJST
     I              AQAHVN                          WMAHVN
     I              AQAGVN                          WMAGVN
     I              AQABVN                          WMABVN
     I              AQABDT                          WMABDT
     I              AQABTM                          WMABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WOHMNB
     I              A1BNNB                          WOBNNB
     I              A1BONB                          WOBONB
     I              A1CVNB                          WOCVNB
     I              A1B0DT                          WOB0DT
     I              A1AWDT                          WOAWDT
     I              A1BICD                          WOBICD
     I              A1CPST                          WOCPST
     I              A1ACPR                          WOACPR
     I              A1B9PR                          WOB9PR
     I              A1CAPR                          WOCAPR
     I              A1C4ST                          WOC4ST
     I              A1AIPR                          WOAIPR
     I              A1A6DT                          WOA6DT
     I              A1C2ST                          WOC2ST
     I              A1CXNB                          WOCXNB
     I              A1CWNB                          WOCWNB
     I              A1FCNB                          WOFCNB
     I              A1H9NB                          WOH9NB
     I              A1FDNB                          WOFDNB
     I              A1FENB                          WOFENB
     I              A1HENB                          WOHENB
     I              A1HFNB                          WOHFNB
     I              A1CYNB                          WOCYNB
     I              A1LRNB                          WOLRNB
     I              A1E0NB                          WOE0NB
     I              A1A5PC                          WOA5PC
     I              A1FBNB                          WOFBNB
     I              A1A4PC                          WOA4PC
     I              A1F7NB                          WOF7NB
     I              A1HDNB                          WOHDNB
     I              A1F5NB                          WOF5NB
     I              A1F4NB                          WOF4NB
     I              A1F3NB                          WOF3NB
     I              A1F2NB                          WOF2NB
     I              A1AVPC                          WOAVPC
     I              A1AWPC                          WOAWPC
     I              A1CWPC                          WOCWPC
     I              A1A8PC                          WOA8PC
     I              A1A7PC                          WOA7PC
     I              A1B8PR                          WOB8PR
     I              A1AMPR                          WOAMPR
     I              A1ANPR                          WOANPR
     I              A1AYVA                          WOAYVA
     I              A1AWVA                          WOAWVA
     I              A1AOPR                          WOAOPR
     I              A1AXVA                          WOAXVA
     I              A1APPR                          WOAPPR
     I              A1ASPR                          WOASPR
     I              A1A4VA                          WOA4VA
     I              A1ATPR                          WOATPR
     I              A1A5VA                          WOA5VA
     I              A1CBPR                          WOCBPR
     I              A1CCPR                          WOCCPR
     I              A1LPNB                          WOLPNB
     I              A1CDPR                          WOCDPR
     I              A1A7VA                          WOA7VA
     I              A1A2PR                          WOA2PR
     I              A1JWST                          WOJWST
     I              A1CWST                          WOCWST
     I              A1D7ST                          WOD7ST
     I              A1D8ST                          WOD8ST
     I              A1DWST                          WODWST
     I              A1D6ST                          WOD6ST
     I              A1GHNB                          WOGHNB
     I              A1BYDT                          WOBYDT
     I              A1E0ST                          WOE0ST
     I              A1E1ST                          WOE1ST
     I              A1E2ST                          WOE2ST
     I              A1BSDT                          WOBSDT
     I              A1BTDT                          WOBTDT
     I              A1BUDT                          WOBUDT
     I              A1HGNB                          WOHGNB
     I              A1HHNB                          WOHHNB
     I              A1HINB                          WOHINB
     I              A1A3PR                          WOA3PR
     I              A1A4PR                          WOA4PR
     I              A1A6PR                          WOA6PR
     I              A1J9NB                          WOJ9NB
     I              A1D6PR                          WOD6PR
     I              A1D7PR                          WOD7PR
     I              A1D8PR                          WOD8PR
     I              A1D9PR                          WOD9PR
     I              A1EAPR                          WOEAPR
     I              A1EBPR                          WOEBPR
     I              A1ECPR                          WOECPR
     I              A1EDPR                          WOEDPR
     I              A1EEPR                          WOEEPR
     I              A1EFPR                          WOEFPR
     I              A1EGPR                          WOEGPR
     I              A1EHPR                          WOEHPR
     I              A1KAST                          WOKAST
     I              A1J7ST                          WOJ7ST
     I              A1J9ST                          WOJ9ST
     I              A1OXNB                          WOOXNB
     I              A1LKST                          WOLKST
     I              A1LLST                          WOLLST
     I              A1J8ST                          WOJ8ST
     I              A1LIST                          WOLIST
     I              A1LJST                          WOLJST
     I              A1NZTX                          WONZTX
     I              A1HJCD                          WOHJCD
     I              A1R4ST                          WOR4ST
     I              A1R5ST                          WOR5ST
     I              A1R6ST                          WOR6ST
     I              A1R7ST                          WOR7ST
     I              A1THWT                          WOTHWT
     I              A1T2WT                          WOT2WT
     I              A1THHD                          WOTHHD
     I              A1T2HD                          WOT2HD
     I              A1OBPR                          WOOBPR
     I              A1KOER                          WOKOER
     I              A1OPIR                          WOOPIR
     I              A1OPEM                          WOOPEM
     I              A1IORP                          WOIORP
     I              A1OWEO                          WOOWEO
     I              A1OQET                          WOOQET
     I              A1URST                          WOURST
     I              A1USST                          WOUSST
     I              A1HHPC                          WOHHPC
     I              A1S9PR                          WOS9PR
     I              A1TAPR                          WOTAPR
     I              A1TBPR                          WOTBPR
     I              A1JFUR                          WOJFUR
     I              A1KRIF                          WOKRIF
     I              A1KORF                          WOKORF
     I              A1KAPR                          WOKAPR
     I              A1KROT                          WOKROT
     I              A1OTJG                          WOOTJG
     I              A1IRJG                          WOIRJG
     I              A1IMJF                          WOIMJF
     I              A1IRGF                          WOIRGF
     I              A1KRJF                          WOKRJF
     I              A1OJRF                          WOOJRF
     I              A1KFOR                          WOKFOR
     I              A1ORJK                          WOORJK
     I              A1OMVJ                          WOOMVJ
     I              A1MVNF                          WOMVNF
     I              A1MCNF                          WOMCNF
     I              A1NCNF                          WONCNF
     I              A1NCHF                          WONCHF
     I              A1IGIR                          WOIGIR
     I              A1KFJR                          WOKFJR
     I              A1EADT                          WOEADT
     I              A1EBDT                          WOEBDT
     I              A1ECDT                          WOECDT
     I              A1EDDT                          WOEDDT
     I              A1EEDT                          WOEEDT
     I              A1U4ST                          WOU4ST
     I              A1U5ST                          WOU5ST
     I              A1U6ST                          WOU6ST
     I              A1U7ST                          WOU7ST
     I              A1U8ST                          WOU8ST
     I              A1U9ST                          WOU9ST
     I              A1VAST                          WOVAST
     I              A1VBST                          WOVBST
     I              A1BDCD                          WOBDCD
     I              A1CSCD                          WOCSCD
     I              A1ABCD                          WOABCD
     I              A1AECD                          WOAECD
     I              A1ACCD                          WOACCD
     I              A1AGCD                          WOAGCD
     I              A1BECD                          WOBECD
     I              A1AAVN                          WOAAVN
     I              A1AADT                          WOAADT
     I              A1AMTM                          WOAMTM
     I              A1AJST                          WOAJST
     I              A1AHVN                          WOAHVN
     I              A1AGVN                          WOAGVN
     I              A1ABVN                          WOABVN
     I              A1ABDT                          WOABDT
     I              A1ABTM                          WOABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WRHMNB
     I              A1BNNB                          WRBNNB
     I              A1BONB                          WRBONB
     I              A1CVNB                          WRCVNB
     I              A1B0DT                          WRB0DT
     I              A1AWDT                          WRAWDT
     I              A1BICD                          WRBICD
     I              A1CPST                          WRCPST
     I              A1ACPR                          WRACPR
     I              A1B9PR                          WRB9PR
     I              A1CAPR                          WRCAPR
     I              A1C4ST                          WRC4ST
     I              A1AIPR                          WRAIPR
     I              A1A6DT                          WRA6DT
     I              A1C2ST                          WRC2ST
     I              A1CXNB                          WRCXNB
     I              A1CWNB                          WRCWNB
     I              A1FCNB                          WRFCNB
     I              A1H9NB                          WRH9NB
     I              A1FDNB                          WRFDNB
     I              A1FENB                          WRFENB
     I              A1HENB                          WRHENB
     I              A1HFNB                          WRHFNB
     I              A1CYNB                          WRCYNB
     I              A1LRNB                          WRLRNB
     I              A1E0NB                          WRE0NB
     I              A1A5PC                          WRA5PC
     I              A1FBNB                          WRFBNB
     I              A1A4PC                          WRA4PC
     I              A1F7NB                          WRF7NB
     I              A1HDNB                          WRHDNB
     I              A1F5NB                          WRF5NB
     I              A1F4NB                          WRF4NB
     I              A1F3NB                          WRF3NB
     I              A1F2NB                          WRF2NB
     I              A1AVPC                          WRAVPC
     I              A1AWPC                          WRAWPC
     I              A1CWPC                          WRCWPC
     I              A1A8PC                          WRA8PC
     I              A1A7PC                          WRA7PC
     I              A1B8PR                          WRB8PR
     I              A1AMPR                          WRAMPR
     I              A1ANPR                          WRANPR
     I              A1AYVA                          WRAYVA
     I              A1AWVA                          WRAWVA
     I              A1AOPR                          WRAOPR
     I              A1AXVA                          WRAXVA
     I              A1APPR                          WRAPPR
     I              A1ASPR                          WRASPR
     I              A1A4VA                          WRA4VA
     I              A1ATPR                          WRATPR
     I              A1A5VA                          WRA5VA
     I              A1CBPR                          WRCBPR
     I              A1CCPR                          WRCCPR
     I              A1LPNB                          WRLPNB
     I              A1CDPR                          WRCDPR
     I              A1A7VA                          WRA7VA
     I              A1A2PR                          WRA2PR
     I              A1JWST                          WRJWST
     I              A1CWST                          WRCWST
     I              A1D7ST                          WRD7ST
     I              A1D8ST                          WRD8ST
     I              A1DWST                          WRDWST
     I              A1D6ST                          WRD6ST
     I              A1GHNB                          WRGHNB
     I              A1BYDT                          WRBYDT
     I              A1E0ST                          WRE0ST
     I              A1E1ST                          WRE1ST
     I              A1E2ST                          WRE2ST
     I              A1BSDT                          WRBSDT
     I              A1BTDT                          WRBTDT
     I              A1BUDT                          WRBUDT
     I              A1HGNB                          WRHGNB
     I              A1HHNB                          WRHHNB
     I              A1HINB                          WRHINB
     I              A1A3PR                          WRA3PR
     I              A1A4PR                          WRA4PR
     I              A1A6PR                          WRA6PR
     I              A1J9NB                          WRJ9NB
     I              A1D6PR                          WRD6PR
     I              A1D7PR                          WRD7PR
     I              A1D8PR                          WRD8PR
     I              A1D9PR                          WRD9PR
     I              A1EAPR                          WREAPR
     I              A1EBPR                          WREBPR
     I              A1ECPR                          WRECPR
     I              A1EDPR                          WREDPR
     I              A1EEPR                          WREEPR
     I              A1EFPR                          WREFPR
     I              A1EGPR                          WREGPR
     I              A1EHPR                          WREHPR
     I              A1KAST                          WRKAST
     I              A1J7ST                          WRJ7ST
     I              A1J9ST                          WRJ9ST
     I              A1OXNB                          WROXNB
     I              A1LKST                          WRLKST
     I              A1LLST                          WRLLST
     I              A1J8ST                          WRJ8ST
     I              A1LIST                          WRLIST
     I              A1LJST                          WRLJST
     I              A1NZTX                          WRNZTX
     I              A1HJCD                          WRHJCD
     I              A1R4ST                          WRR4ST
     I              A1R5ST                          WRR5ST
     I              A1R6ST                          WRR6ST
     I              A1R7ST                          WRR7ST
     I              A1THWT                          WRTHWT
     I              A1T2WT                          WRT2WT
     I              A1THHD                          WRTHHD
     I              A1T2HD                          WRT2HD
     I              A1OBPR                          WROBPR
     I              A1KOER                          WRKOER
     I              A1OPIR                          WROPIR
     I              A1OPEM                          WROPEM
     I              A1IORP                          WRIORP
     I              A1OWEO                          WROWEO
     I              A1OQET                          WROQET
     I              A1URST                          WRURST
     I              A1USST                          WRUSST
     I              A1HHPC                          WRHHPC
     I              A1S9PR                          WRS9PR
     I              A1TAPR                          WRTAPR
     I              A1TBPR                          WRTBPR
     I              A1JFUR                          WRJFUR
     I              A1KRIF                          WRKRIF
     I              A1KORF                          WRKORF
     I              A1KAPR                          WRKAPR
     I              A1KROT                          WRKROT
     I              A1OTJG                          WROTJG
     I              A1IRJG                          WRIRJG
     I              A1IMJF                          WRIMJF
     I              A1IRGF                          WRIRGF
     I              A1KRJF                          WRKRJF
     I              A1OJRF                          WROJRF
     I              A1KFOR                          WRKFOR
     I              A1ORJK                          WRORJK
     I              A1OMVJ                          WROMVJ
     I              A1MVNF                          WRMVNF
     I              A1MCNF                          WRMCNF
     I              A1NCNF                          WRNCNF
     I              A1NCHF                          WRNCHF
     I              A1IGIR                          WRIGIR
     I              A1KFJR                          WRKFJR
     I              A1EADT                          WREADT
     I              A1EBDT                          WREBDT
     I              A1ECDT                          WRECDT
     I              A1EDDT                          WREDDT
     I              A1EEDT                          WREEDT
     I              A1U4ST                          WRU4ST
     I              A1U5ST                          WRU5ST
     I              A1U6ST                          WRU6ST
     I              A1U7ST                          WRU7ST
     I              A1U8ST                          WRU8ST
     I              A1U9ST                          WRU9ST
     I              A1VAST                          WRVAST
     I              A1VBST                          WRVBST
     I              A1BDCD                          WRBDCD
     I              A1CSCD                          WRCSCD
     I              A1ABCD                          WRABCD
     I              A1AECD                          WRAECD
     I              A1ACCD                          WRACCD
     I              A1AGCD                          WRAGCD
     I              A1BECD                          WRBECD
     I              A1AAVN                          WRAAVN
     I              A1AADT                          WRAADT
     I              A1AMTM                          WRAMTM
     I              A1AJST                          WRAJST
     I              A1AHVN                          WRAHVN
     I              A1AGVN                          WRAGVN
     I              A1ABVN                          WRABVN
     I              A1ABDT                          WRABDT
     I              A1ABTM                          WRABTM
      *
     I@DGCPTJ
      * Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WSAMCD
     I              DGHMNB                          WSHMNB
     I              DGBNNB                          WSBNNB
     I              DGBONB                          WSBONB
     I              DGCVNB                          WSCVNB
     I              DGB0DT                          WSB0DT
     I              DGMHST                          WSMHST
     I              DGF4PC                          WSF4PC
     I              DGG5PR                          WSG5PR
     I              DGJPPR                          WSJPPR
     I              DGG6PR                          WSG6PR
     I              DGJQPR                          WSJQPR
     I              DGG7PR                          WSG7PR
     I              DGJRPR                          WSJRPR
     I              DGJUPR                          WSJUPR
     I              DGJVPR                          WSJVPR
     I              DGG8PR                          WSG8PR
     I              DGJSPR                          WSJSPR
     I              DGG9PR                          WSG9PR
     I              DGJTPR                          WSJTPR
     I              DGAAVN                          WSAAVN
     I              DGAADT                          WSAADT
     I              DGAMTM                          WSAMTM
     I              DGAJST                          WSAJST
     I              DGAHVN                          WSAHVN
     I              DGAGVN                          WSAGVN
     I              DGABVN                          WSABVN
     I              DGABDT                          WSABDT
     I              DGABTM                          WSABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WJHMNB
     I              B1BNNB                          WJBNNB
     I              B1BONB                          WJBONB
     I              B1CVNB                          WJCVNB
     I              B1B0DT                          WJB0DT
     I              B1LGNB                          WJLGNB
     I              B1EUNB                          WJEUNB
     I              B1LHNB                          WJLHNB
     I              B1INST                          WJINST
     I              B1BEPR                          WJBEPR
     I              B1ASPC                          WJASPC
     I              B1EWNB                          WJEWNB
     I              B1B4PR                          WJB4PR
     I              B1EYNB                          WJEYNB
     I              B1B1PR                          WJB1PR
     I              B1AVPR                          WJAVPR
     I              B1AUPC                          WJAUPC
     I              B1AWPR                          WJAWPR
     I              B1AXPR                          WJAXPR
     I              B1EZNB                          WJEZNB
     I              B1AYPR                          WJAYPR
     I              B1BBDT                          WJBBDT
     I              B1AKTM                          WJAKTM
     I              B1IQST                          WJIQST
     I              B1EFST                          WJEFST
     I              B1H6NB                          WJH6NB
     I              B1BEPC                          WJBEPC
     I              B1GCST                          WJGCST
     I              B1GDST                          WJGDST
     I              B1GEST                          WJGEST
     I              B1BHPC                          WJBHPC
     I              B1IOST                          WJIOST
     I              B1IPST                          WJIPST
     I              B1LTNB                          WJLTNB
     I              B1JNST                          WJJNST
     I              B1X4NB                          WJX4NB
     I              B1FNPC                          WJFNPC
     I              B1FOPC                          WJFOPC
     I              B1FPPC                          WJFPPC
     I              B1K2ST                          WJK2ST
     I              B1K3ST                          WJK3ST
     I              B1JWPR                          WJJWPR
     I              B1F5PC                          WJF5PC
     I              B1JXPR                          WJJXPR
     I              B1JYPR                          WJJYPR
     I              B1JZPR                          WJJZPR
     I              B1J0PR                          WJJ0PR
     I              B1J1PR                          WJJ1PR
     I              B1J2PR                          WJJ2PR
     I              B1J3PR                          WJJ3PR
     I              B1J4PR                          WJJ4PR
     I              B1UTST                          WJUTST
     I              B1HVCD                          WJHVCD
     I              B1DKJR                          WJDKJR
     I              B1ITJF                          WJITJF
     I              B1IJGR                          WJIJGR
     I              B1ORJE                          WJORJE
     I              B1OTJR                          WJOTJR
     I              B1PEIR                          WJPEIR
     I              B1IEUF                          WJIEUF
     I              B1ORUE                          WJORUE
     I              B1IUTR                          WJIUTR
     I              B1IJRR                          WJIJRR
     I              B1VCST                          WJVCST
     I              B1VDST                          WJVDST
     I              B1VEST                          WJVEST
     I              B1VFST                          WJVFST
     I              B1VGST                          WJVGST
     I              B1ABCD                          WJABCD
     I              B1AACD                          WJAACD
     I              B1AAVN                          WJAAVN
     I              B1AADT                          WJAADT
     I              B1AMTM                          WJAMTM
     I              B1AJST                          WJAJST
     I              B1AHVN                          WJAHVN
     I              B1AGVN                          WJAGVN
     I              B1ABVN                          WJABVN
     I              B1ABDT                          WJABDT
     I              B1ABTM                          WJABTM
      *
     IYARDCS      DS                            267
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKB12    E DSPKB1CPLD
      * UPD : Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WKHMNB
     I              B1BNNB                          WKBNNB
     I              B1BONB                          WKBONB
     I              B1CVNB                          WKCVNB
     I              B1B0DT                          WKB0DT
     I              B1LGNB                          WKLGNB
     I              B1EUNB                          WKEUNB
     I              B1LHNB                          WKLHNB
     I              B1INST                          WKINST
     I              B1BEPR                          WKBEPR
     I              B1ASPC                          WKASPC
     I              B1EWNB                          WKEWNB
     I              B1B4PR                          WKB4PR
     I              B1EYNB                          WKEYNB
     I              B1B1PR                          WKB1PR
     I              B1AVPR                          WKAVPR
     I              B1AUPC                          WKAUPC
     I              B1AWPR                          WKAWPR
     I              B1AXPR                          WKAXPR
     I              B1EZNB                          WKEZNB
     I              B1AYPR                          WKAYPR
     I              B1BBDT                          WKBBDT
     I              B1AKTM                          WKAKTM
     I              B1IQST                          WKIQST
     I              B1EFST                          WKEFST
     I              B1H6NB                          WKH6NB
     I              B1BEPC                          WKBEPC
     I              B1GCST                          WKGCST
     I              B1GDST                          WKGDST
     I              B1GEST                          WKGEST
     I              B1BHPC                          WKBHPC
     I              B1IOST                          WKIOST
     I              B1IPST                          WKIPST
     I              B1LTNB                          WKLTNB
     I              B1JNST                          WKJNST
     I              B1X4NB                          WKX4NB
     I              B1FNPC                          WKFNPC
     I              B1FOPC                          WKFOPC
     I              B1FPPC                          WKFPPC
     I              B1K2ST                          WKK2ST
     I              B1K3ST                          WKK3ST
     I              B1JWPR                          WKJWPR
     I              B1F5PC                          WKF5PC
     I              B1JXPR                          WKJXPR
     I              B1JYPR                          WKJYPR
     I              B1JZPR                          WKJZPR
     I              B1J0PR                          WKJ0PR
     I              B1J1PR                          WKJ1PR
     I              B1J2PR                          WKJ2PR
     I              B1J3PR                          WKJ3PR
     I              B1J4PR                          WKJ4PR
     I              B1UTST                          WKUTST
     I              B1HVCD                          WKHVCD
     I              B1DKJR                          WKDKJR
     I              B1ITJF                          WKITJF
     I              B1IJGR                          WKIJGR
     I              B1ORJE                          WKORJE
     I              B1OTJR                          WKOTJR
     I              B1PEIR                          WKPEIR
     I              B1IEUF                          WKIEUF
     I              B1ORUE                          WKORUE
     I              B1IUTR                          WKIUTR
     I              B1IJRR                          WKIJRR
     I              B1VCST                          WKVCST
     I              B1VDST                          WKVDST
     I              B1VEST                          WKVEST
     I              B1VFST                          WKVFST
     I              B1VGST                          WKVGST
     I              B1ABCD                          WKABCD
     I              B1AACD                          WKAACD
     I              B1AAVN                          WKAAVN
     I              B1AADT                          WKAADT
     I              B1AMTM                          WKAMTM
     I              B1AJST                          WKAJST
     I              B1AHVN                          WKAHVN
     I              B1AGVN                          WKAGVN
     I              B1ABVN                          WKABVN
     I              B1ABDT                          WKABDT
     I              B1ABTM                          WKABTM
      *
     IYBRDCS      DS                            267
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WRHMNB
     I              A1BNNB                          WRBNNB
     I              A1BONB                          WRBONB
     I              A1CVNB                          WRCVNB
     I              A1B0DT                          WRB0DT
     I              A1AWDT                          WRAWDT
     I              A1BICD                          WRBICD
     I              A1CPST                          WRCPST
     I              A1ACPR                          WRACPR
     I              A1B9PR                          WRB9PR
     I              A1CAPR                          WRCAPR
     I              A1C4ST                          WRC4ST
     I              A1AIPR                          WRAIPR
     I              A1A6DT                          WRA6DT
     I              A1C2ST                          WRC2ST
     I              A1CXNB                          WRCXNB
     I              A1CWNB                          WRCWNB
     I              A1FCNB                          WRFCNB
     I              A1H9NB                          WRH9NB
     I              A1FDNB                          WRFDNB
     I              A1FENB                          WRFENB
     I              A1HENB                          WRHENB
     I              A1HFNB                          WRHFNB
     I              A1CYNB                          WRCYNB
     I              A1LRNB                          WRLRNB
     I              A1E0NB                          WRE0NB
     I              A1A5PC                          WRA5PC
     I              A1FBNB                          WRFBNB
     I              A1A4PC                          WRA4PC
     I              A1F7NB                          WRF7NB
     I              A1HDNB                          WRHDNB
     I              A1F5NB                          WRF5NB
     I              A1F4NB                          WRF4NB
     I              A1F3NB                          WRF3NB
     I              A1F2NB                          WRF2NB
     I              A1AVPC                          WRAVPC
     I              A1AWPC                          WRAWPC
     I              A1CWPC                          WRCWPC
     I              A1A8PC                          WRA8PC
     I              A1A7PC                          WRA7PC
     I              A1B8PR                          WRB8PR
     I              A1AMPR                          WRAMPR
     I              A1ANPR                          WRANPR
     I              A1AYVA                          WRAYVA
     I              A1AWVA                          WRAWVA
     I              A1AOPR                          WRAOPR
     I              A1AXVA                          WRAXVA
     I              A1APPR                          WRAPPR
     I              A1ASPR                          WRASPR
     I              A1A4VA                          WRA4VA
     I              A1ATPR                          WRATPR
     I              A1A5VA                          WRA5VA
     I              A1CBPR                          WRCBPR
     I              A1CCPR                          WRCCPR
     I              A1LPNB                          WRLPNB
     I              A1CDPR                          WRCDPR
     I              A1A7VA                          WRA7VA
     I              A1A2PR                          WRA2PR
     I              A1JWST                          WRJWST
     I              A1CWST                          WRCWST
     I              A1D7ST                          WRD7ST
     I              A1D8ST                          WRD8ST
     I              A1DWST                          WRDWST
     I              A1D6ST                          WRD6ST
     I              A1GHNB                          WRGHNB
     I              A1BYDT                          WRBYDT
     I              A1E0ST                          WRE0ST
     I              A1E1ST                          WRE1ST
     I              A1E2ST                          WRE2ST
     I              A1BSDT                          WRBSDT
     I              A1BTDT                          WRBTDT
     I              A1BUDT                          WRBUDT
     I              A1HGNB                          WRHGNB
     I              A1HHNB                          WRHHNB
     I              A1HINB                          WRHINB
     I              A1A3PR                          WRA3PR
     I              A1A4PR                          WRA4PR
     I              A1A6PR                          WRA6PR
     I              A1J9NB                          WRJ9NB
     I              A1D6PR                          WRD6PR
     I              A1D7PR                          WRD7PR
     I              A1D8PR                          WRD8PR
     I              A1D9PR                          WRD9PR
     I              A1EAPR                          WREAPR
     I              A1EBPR                          WREBPR
     I              A1ECPR                          WRECPR
     I              A1EDPR                          WREDPR
     I              A1EEPR                          WREEPR
     I              A1EFPR                          WREFPR
     I              A1EGPR                          WREGPR
     I              A1EHPR                          WREHPR
     I              A1KAST                          WRKAST
     I              A1J7ST                          WRJ7ST
     I              A1J9ST                          WRJ9ST
     I              A1OXNB                          WROXNB
     I              A1LKST                          WRLKST
     I              A1LLST                          WRLLST
     I              A1J8ST                          WRJ8ST
     I              A1LIST                          WRLIST
     I              A1LJST                          WRLJST
     I              A1NZTX                          WRNZTX
     I              A1HJCD                          WRHJCD
     I              A1R4ST                          WRR4ST
     I              A1R5ST                          WRR5ST
     I              A1R6ST                          WRR6ST
     I              A1R7ST                          WRR7ST
     I              A1THWT                          WRTHWT
     I              A1T2WT                          WRT2WT
     I              A1THHD                          WRTHHD
     I              A1T2HD                          WRT2HD
     I              A1OBPR                          WROBPR
     I              A1KOER                          WRKOER
     I              A1OPIR                          WROPIR
     I              A1OPEM                          WROPEM
     I              A1IORP                          WRIORP
     I              A1OWEO                          WROWEO
     I              A1OQET                          WROQET
     I              A1URST                          WRURST
     I              A1USST                          WRUSST
     I              A1HHPC                          WRHHPC
     I              A1S9PR                          WRS9PR
     I              A1TAPR                          WRTAPR
     I              A1TBPR                          WRTBPR
     I              A1JFUR                          WRJFUR
     I              A1KRIF                          WRKRIF
     I              A1KORF                          WRKORF
     I              A1KAPR                          WRKAPR
     I              A1KROT                          WRKROT
     I              A1OTJG                          WROTJG
     I              A1IRJG                          WRIRJG
     I              A1IMJF                          WRIMJF
     I              A1IRGF                          WRIRGF
     I              A1KRJF                          WRKRJF
     I              A1OJRF                          WROJRF
     I              A1KFOR                          WRKFOR
     I              A1ORJK                          WRORJK
     I              A1OMVJ                          WROMVJ
     I              A1MVNF                          WRMVNF
     I              A1MCNF                          WRMCNF
     I              A1NCNF                          WRNCNF
     I              A1NCHF                          WRNCHF
     I              A1IGIR                          WRIGIR
     I              A1KFJR                          WRKFJR
     I              A1EADT                          WREADT
     I              A1EBDT                          WREBDT
     I              A1ECDT                          WRECDT
     I              A1EDDT                          WREDDT
     I              A1EEDT                          WREEDT
     I              A1U4ST                          WRU4ST
     I              A1U5ST                          WRU5ST
     I              A1U6ST                          WRU6ST
     I              A1U7ST                          WRU7ST
     I              A1U8ST                          WRU8ST
     I              A1U9ST                          WRU9ST
     I              A1VAST                          WRVAST
     I              A1VBST                          WRVBST
     I              A1BDCD                          WRBDCD
     I              A1CSCD                          WRCSCD
     I              A1ABCD                          WRABCD
     I              A1AECD                          WRAECD
     I              A1ACCD                          WRACCD
     I              A1AGCD                          WRAGCD
     I              A1BECD                          WRBECD
     I              A1AAVN                          WRAAVN
     I              A1AADT                          WRAADT
     I              A1AMTM                          WRAMTM
     I              A1AJST                          WRAJST
     I              A1AHVN                          WRAHVN
     I              A1AGVN                          WRAGVN
     I              A1ABVN                          WRABVN
     I              A1ABDT                          WRABDT
     I              A1ABTM                          WRABTM
      *
     IYCRDCS      DS                            583
     IYDRDCS      DS                            583
     IYERDCS      DS                            583
     IQPKDG1    E DSPKDGCPL0
      * UPD : Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WSAMCD
     I              DGHMNB                          WSHMNB
     I              DGBNNB                          WSBNNB
     I              DGBONB                          WSBONB
     I              DGCVNB                          WSCVNB
     I              DGB0DT                          WSB0DT
     I              DGMHST                          WSMHST
     I              DGF4PC                          WSF4PC
     I              DGG5PR                          WSG5PR
     I              DGJPPR                          WSJPPR
     I              DGG6PR                          WSG6PR
     I              DGJQPR                          WSJQPR
     I              DGG7PR                          WSG7PR
     I              DGJRPR                          WSJRPR
     I              DGJUPR                          WSJUPR
     I              DGJVPR                          WSJVPR
     I              DGG8PR                          WSG8PR
     I              DGJSPR                          WSJSPR
     I              DGG9PR                          WSG9PR
     I              DGJTPR                          WSJTPR
     I              DGAAVN                          WSAAVN
     I              DGAADT                          WSAADT
     I              DGAMTM                          WSAMTM
     I              DGAJST                          WSAJST
     I              DGAHVN                          WSAHVN
     I              DGAGVN                          WSAGVN
     I              DGABVN                          WSABVN
     I              DGABDT                          WSABDT
     I              DGABTM                          WSABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  BOH Buy Order Number
     I                                    P   1   40P1BNNB
      * I :  BOL Load Number
     I                                    P   5   70P1BONB
      * I :  TH Tattoo Number
     I                                    P   8  100P1CVNB
      * I :  TH Live Wgt
     I                                    P  11  141P1CYNB
      * B :  TH CM Base Mkt Price
     I                                    P  15  172P1AMPR
      * N :  TH Std Yield Percent
     I                                    P  18  202P1AVPC
      * I :  TH Actual Yield %
     I                                    P  21  232P1AWPC
      * N :  TH CM Base Mkt Price Amt
     I                                    P  24  272P1ANPR
      * N :  TH CM Base Carcass Value
     I                                    P  28  312P1AOPR
      * N :  TH CM Carcass Gross Amt
     I                                    P  32  352P1APPR
      * N :  TH Avg Lean Percent
     I                                    P  36  371P1F4NB
      * N :  TH Yield Difference
     I                                    P  38  402P1A8PC
      * N :  TH CM Yield Gain/Loss Amt
     I                                    P  41  442P1AWVA
      * N :  TH CM LN AddOn/Deduct Amt
     I                                    P  45  482P1AXVA
      * N :  TH CM Sort Discount Amt
     I                                    P  49  522P1AYVA
      * N :  TH Accrual Amount
     I                                    P  53  562P1A7VA
      * I :  TH Kill Date
     I                                    P  57  600P1B0DT
      * I :  BOH Company Number
     I                                    P  61  620P1HMNB
      * N :  PSC Mkt Percent
     I                                    P  63  652P1A9PR
      * I :  Payment Process Type USR
     I                                       66  68 P1GBST
      * I :  Pricing UOM USR
     I                                       69  70 P1SNST
      * I :  PC Contract Code
     I                                       71  75 P1AKCD
      * I :  PSC Sub-Contract Code
     I                                       76  80 P1ALCD
      * I :  CMP Program Code
     I                                       81  83 P1AMCD
      * I :  BOH Quote Price Type
     I                                       84  85 P1B3ST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Head Total USR
     I                                    P   1   40P2B5NB
      * N :  Sort Loss Tot USR
     I                                    P   5   82P2BMPR
      * N :  Std Yield % Tot USR
     I                                    P   9  122P2BNPR
      * N :  Weight Tot USR
     I                                    P  13  161P2H3NB
      * N :  Adj Base Carc Val Tot USR
     I                                    P  17  202P2BOPR
      * N :  Lean Percent Tot USR
     I                                    P  21  242P2BPPR
      * N :  Lean Add/Ded Val Tot USR
     I                                    P  25  282P2BQPR
      * N :  Total Carc Val Tot USR
     I                                    P  29  322P2BRPR
      * N :  Base Carc Val Tot USR
     I                                    P  33  362P2B2PR
      * N :  TH Meat Value Factor Amt
     I                                    P  37  422P2KFOR
      * N :  TH Fixed Cost Amount
     I                                    P  43  462P2A2PR
      * N :  Gross Before Sort /HD Usr
     I                                    P  47  502P2L8A1
     IP3PARM      DS
      * FLD: Tattoo Header
      * I :  TH Purchase Date
     I                                    P   1   40P3AWDT
      * I :  TH Head Adds
     I                                    P   5   70P3HENB
      * I :  TH Adj Actual Yield %
     I                                    P   8  102P3CWPC
      * I :  TH CM Market Price
     I                                    P  11  132P3B8PR
      * I :  TH Avg Hot Wgt EXC/ADD
     I                                    P  14  171P3HHNB
      * I :  TH Head Excluded
     I                                    P  18  200P3J9NB
      * N :  TH CM Bse Mkt Live /CWT
     I                                    P  21  232P3D6PR
      * N :  TH CM Bse Mkt Carc /CWT
     I                                    P  24  262P3D7PR
      * N :  TH CM Srt Dsc Live /CWT
     I                                    P  27  292P3D8PR
      * N :  TH CM Srt Dsc Carc /CWT
     I                                    P  30  322P3D9PR
      * N :  TH CM Yld G/L Live /CWT
     I                                    P  33  352P3EAPR
      * N :  TH CM Yld G/L Carc /CWT
     I                                    P  36  382P3EBPR
      * N :  TH CM Crc Val Live /CWT
     I                                    P  39  412P3ECPR
      * N :  TH CM Crc Val Carc /CWT
     I                                    P  42  442P3EDPR
      * N :  TH CM Lean Prem Live /CWT
     I                                    P  45  472P3EEPR
      * N :  TH CM Lean Prem Carc /CWT
     I                                    P  48  502P3EFPR
      * N :  TH CM Gross Live /CWT
     I                                    P  51  532P3EGPR
      * N :  TH CM Gross Carc /CWT
     I                                    P  54  562P3EHPR
      * I :  TH Source Type
     I                                       57  57 P3KAST
      * I :  TH Payment Type
     I                                       58  58 P3J9ST
      * I :  TH PHA Lean Prm /Crc CWT
     I                                    P  59  612P3S9PR
      * B :  TH VC Gross Value /HD
     I                                    P  62  642P3TAPR
      * N :  TH Excluded Gross Value
     I                                    P  65  682P3TBPR
      * N :  TH Excluded Carc Val
     I                                    P  69  722P3KROT
      * N :  TH Excluded Premium
     I                                    P  73  762P3OTJG
      * N :  TH Break Even Price/CWT
     I                                    P  77  822P3OJRF
      * I :  TH PHA Sort Disc Fctr %
     I                                    P  83  852P3OMVJ
      * N :  TH MPR Sort Loss
     I                                    P  86  902P3NCHF
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Adj Base Carc Per CWT USR
     I                                    P   1   32P4BSPR
     IP5PARM      DS
      * I :  Competitors Processing
     I                                        1   1 P5MGST
     IP6PARM      DS
      * I :  CM Processing Type Usr
     I                                        1   1 P6M6ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BNNB    PARM           WP0001  70       BOH Buy Order N
     C           P1BONB    PARM           WP0002  50       BOL Load Number
     C           P1CVNB    PARM           WP0003  50       TH Tattoo Numbe
     C           P1CYNB    PARM           WP0004  71       TH Live Wgt
     C           P1AMPR    PARM P1AMPR    WP0005  52       TH CM Base Mkt
     C           P1AWPC    PARM           WP0006  52       TH Actual Yield
     C           P1B0DT    PARM           WP0007  70       TH Kill Date
     C           P1HMNB    PARM           WP0008  30       BOH Company Num
     C           P1GBST    PARM           WP0009  3        Payment Process
     C           P1SNST    PARM           WP0010  2        Pricing UOM USR
     C           P1AKCD    PARM           WP0011  5        PC Contract Cod
     C           P1ALCD    PARM           WP0012  5        PSC Sub-Contrac
     C           P1AMCD    PARM           WP0013  3        CMP Program Cod
     C           P1B3ST    PARM           WP0014  2        BOH Quote Price
     C           P3AWDT    PARM           WP0015  70       TH Purchase Dat
     C           P3HENB    PARM           WP0016  50       TH Head Adds
     C           P3CWPC    PARM           WP0017  52       TH Adj Actual Y
     C           P3B8PR    PARM           WP0018  52       TH CM Market Pr
     C           P3HHNB    PARM           WP0019  71       TH Avg Hot Wgt
     C           P3J9NB    PARM           WP0020  50       TH Head Exclude
     C           P3KAST    PARM           WP0021  1        TH Source Type
     C           P3J9ST    PARM           WP0022  1        TH Payment Type
     C           P3S9PR    PARM           WP0023  52       TH PHA Lean Prm
     C           P3TAPR    PARM P3TAPR    WP0024  52       TH VC Gross Val
     C           P3OMVJ    PARM           WP0025  52       TH PHA Sort Dis
     C           P5MGST    PARM           WP0026  1        Competitors Pro
     C           P6M6ST    PARM           WP0027  1        CM Processing T
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Carcass Analysis  XF
      * TestIns
      * std yield is zero send message
     C                     MOVEL'N'       WUM7ST           Average Pay Sts
      * *************
      * Commented 01/31/97 for C2343. Per Rick Hoffman
      * If Pork decides to make the Average Competitor the Analysis,
      * the next two routines need to be uncommented.  Additional checkin
      * for CM Processing Type USR = Analysis is needed.  PKD/SLM
      * RMC 10/11/17 S11862 change sort loss calc
      * RMC 11/17/06 change sort loss calc
      * RMC 01/15/06 change sort loss calc for cmp grading type "M"
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      * *************
      * *Process all Carcass Detail for the Tattoo.
      * E2521 03/27/13  slm mpr cutout or hog cutout. hard code remove in
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
     C                     EXSR SARVGN
      * Average Gross Value of Valid Carcasses for Non-Held Over Tattoo.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH VC Gross Value /HD is Zeros
      *   |- c2    : PAR.Head Total USR is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TAPR    IFEQ *ZERO                      *IF
     C           P2B5NB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR.TH VC Gross Value /HD =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Total Carc Val Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Head Total USR
     C           P2BRPR    DIV  P2B5NB    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3TAPR           TH VC Gross Val
     C                     END                             *FI
      * Process Added Carcasses
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Competitors Processing is No
      *   |- c2    : PAR.CM Processing Type Usr is Payment
      *   |- c3    : PAR.TH Head Adds is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5MGST    IFEQ 'N'                        *IF
     C           P6M6ST    IFEQ 'P'                        *IF
     C           P3HENB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc Crc Mrt Added Crc RT - Carcass Detail  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
      * Clc Carcass Anl f/EXC IF
     C                     Z-ADD*ZERO     P3KROT           TH Excluded Car
     C                     Z-ADD*ZERO     P3OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     P3TBPR           TH Excluded Gro
      * Excluded Carcass Value
      * PAR.TH Excluded Carc Val =
      *    *COMPUTE ((((x1 * x2) / x3) * x4))
      * x1    : PAR.TH Avg Hot Wgt EXC/ADD
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Excluded
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : PAR.TH CM Base Mkt Price
     C           P3HHNB    MULT P3J9NB    W0WA02           *Synon (15,2) w
     C           W0WA02    DIV  100       W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT P1AMPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3KROT           TH Excluded Car
      * Excluded Gross Value
      * PAR.TH Excluded Gross Value =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.TH VC Gross Value /HD
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Excluded
     C           P3TAPR    MULT P3J9NB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P3TBPR           TH Excluded Gro
      * Excluded Premium
      * PAR.TH Excluded Premium =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.TH Excluded Gross Value
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Excluded Carc Val
     C           P3TBPR    SUB  P3KROT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P3OTJG           TH Excluded Pre
      * Weight Total
      * PAR.Weight Tot USR =
      *    *COMPUTE (x1 - (x2 * x3))
      * x1    : PAR.Weight Tot USR
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Head Excluded
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Avg Hot Wgt EXC/ADD
     C           P3J9NB    MULT P3HHNB    W0WA01           *Synon (15,2) w
     C           P2H3NB    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P2H3NB           Weight Tot USR
     C                     SUB  P3KROT    P2B2PR           Base Carc Val T
     C                     SUB  P3KROT    P2BOPR           Adj Base Carc V
     C                     SUB  P3OTJG    P2BQPR           Lean Add/Ded Va
     C                     SUB  P3TBPR    P2BRPR           Total Carc Val
      * ----------------------------------------------------------
      * *Calculate Tattoo Summary information.
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SURVGN
      * Calc Std Yld, Act Yld, Adj Act Yld, Yld Diff
     C                     EXSR NASUBR                     Calc Std Yld, A
      * Calc Amounts
     C                     EXSR NBSUBR                     Calc Amounts
      * Calc Per Live CWT
      * CASE: WRK.Average Pay Sts Usr is Yes
     C           WUM7ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWUHDPR    P3D6PR           TH CM Bse Mkt L
     C                     Z-ADDWUHGPR    P3D8PR           TH CM Srt Dsc L
     C                     Z-ADDWUHFPR    P3EAPR           TH CM Yld G/L L
     C                     Z-ADDWUKVPR    P3ECPR           TH CM Crc Val L
     C                     Z-ADDWUHEPR    P3EEPR           TH CM Lean Prem
      * recalculate gross
     C           P3D6PR    ADD  P3D8PR    P3EGPR           TH CM Gross Liv
     C                     ADD  P3EAPR    P3EGPR           TH CM Gross Liv
     C                     ADD  P3EEPR    P3EGPR           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
      * Calc Per Live CWT
     C                     EXSR NCSUBR                     Calc Per Live C
     C                     END                             *FI
      * Calc Per Carc CWT
     C                     EXSR NDSUBR                     Calc Per Carc C
      * Re Calculate Base Carc/Cwt Per Carl Calculation DIFF OF .01-
     C                     EXSR NESUBR                     Re Calculate Ba
      * CASE: PAR.Competitors Processing is No
     C           P5MGST    IFEQ 'N'                        *IF
      * % OF Market not used here nll
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
     C                     EXSR SVRVGN
      * TH Break Even Price/CWT
      * PAR.TH Break Even Price/CWT =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.TH CM Market Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.PSC Break Even Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0019    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P3B8PR    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3OJRF           TH Break Even P
      * TH Meat Value Factor Amt
      * PAR.TH Meat Value Factor Amt =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.TH CM Carcass Gross Amt
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.TH CM Base Mkt Price Amt
     C           P1APPR    SUB  P1ANPR    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P2KFOR           TH Meat Value F
      * Chg Tattoo SummaryNEW RT - Tattoo Header  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     EXSR NHSUBR
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Calc Std Yld, Act Yld, Adj Act Yld, Yld Diff
      *================================================================
      * Std Yield Percent & Value /Head
      * CASE: PAR.Head Total USR is Greater then Zero
     C           P2B5NB    IFGT *ZERO                      *IF
     C           P2BNPR    DIV  P2B5NB    P1AVPC    H      TH Std Yield Pe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P1AVPC           TH Std Yield Pe
     C                     END                             *FI
      * Actual and Adjusted Yields are calculated in Balancing.
     C           P1AWPC    SUB  P1AVPC    P1A8PC           TH Yield Differ
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Calc Amounts
      *================================================================
      * Commented out 12/16/98. PKD
      * 03/03/06 PKD User the total from Carcass Detail
     C                     Z-ADDP2B2PR    P1ANPR           TH CM Base Mkt
     C           P2BOPR    SUB  P2B2PR    P1AYVA           TH CM Sort Disc
      * Array:  PAR Clc Carcass Anl Summ may be removed once the
      *         following calculations are removed.
     C                     Z-ADDP2BOPR    P1AOPR           TH CM Base Carc
      * Yield Gain/Loss
      * PAR.TH CM Yield Gain/Loss Amt =
      *    *COMPUTE (x1 - (x2 + x3))
      * x1    : PAR.TH CM Base Carcass Value
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.TH CM Base Mkt Price Amt
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.TH CM Sort Discount Amt
     C           P1ANPR    ADD  P1AYVA    W0WD01           *Synon (17,7) w
     C           P1AOPR    SUB  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P1AWVA           TH CM Yield Gai
     C                     Z-ADDP2BQPR    P1AXVA           TH CM LN AddOn/
      * CASE: LCL.CMP Grading Type is Meat Value
     C           YL0018    IFEQ 'M'                        *IF
     C                     Z-ADDP2BRPR    P1APPR           TH CM Carcass G
     C                     ELSE
      * CASE: *OTHERWISE
     C           P1AOPR    ADD  P1AXVA    P1APPR           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Calc Per Live CWT
      *================================================================
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           P1CYNB    IFNE WUE9NB                     *IF
      * Commented out 12/16/98 PKD
      * TH CM Bse Mkt Live /CWT w/ Quote Type.  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
     C                     Z-ADDP1AMPR    P3D6PR           TH CM Bse Mkt L
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1ANPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3D6PR           TH CM Bse Mkt L
     C                     END                             *FI
     C                     END                             *FI
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3D8PR           TH CM Srt Dsc L
      * TH CM Yld G/L Live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EAPR           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AOPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3ECPR           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AXVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EEPR           TH CM Lean Prem
      * recalculate gross
      * CASE: LCL.CMP Grading Type is Meat Value
     C           YL0018    IFEQ 'M'                        *IF
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P1CYNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1APPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EGPR           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C           P3D6PR    ADD  P3D8PR    P3EGPR           TH CM Gross Liv
     C                     ADD  P3EAPR    P3EGPR           TH CM Gross Liv
     C                     ADD  P3EEPR    P3EGPR           TH CM Gross Liv
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Commented out 12/16/98 PKD
      * TH CM Bse Mkt Live /CWT w/ Quote Type.  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
     C                     Z-ADDP1AMPR    P3D6PR           TH CM Bse Mkt L
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
     C                     Z-ADD*ZERO     P3D6PR           TH CM Bse Mkt L
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     P3D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     P3EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     P3ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     P3EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P3EGPR           TH CM Gross Liv
     C                     END                             *FI
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Calc Per Carc CWT
      *================================================================
      * CASE: PAR.Weight Tot USR NE WRK.Zero USR
     C           P2H3NB    IFNE WUE9NB                     *IF
      * Commented out 12/16/98 PKD
      * TH CM Bse Mkt Carc /CWT w/ Quote Type.  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1ANPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3D7PR           TH CM Bse Mkt C
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
     C                     Z-ADDP1AMPR    P3D7PR           TH CM Bse Mkt C
     C                     END                             *FI
     C                     END                             *FI
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AYVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3D9PR           TH CM Srt Dsc C
      * TH CM Yld G/L Carc /CWT
      * PAR.TH CM Yld G/L Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AWVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EBPR           TH CM Yld G/L C
      * TH CM Crc Val Carc /CWT
      * PAR.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AOPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EDPR           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1AXVA    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EFPR           TH CM Lean Prem
      * recalculate gross
      * CASE: LCL.CMP Grading Type is Meat Value
     C           YL0018    IFEQ 'M'                        *IF
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           P2H3NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1APPR    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3EHPR           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C           P3EDPR    ADD  P3EFPR    P3EHPR           TH CM Gross Car
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Commented out 12/16/98 PKD
      * TH CM Bse Mkt Carc /CWT w/ Quote Type.  12/16/98 PKP
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
     C                     Z-ADD*ZERO     P3D7PR           TH CM Bse Mkt C
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
     C                     Z-ADDP1AMPR    P3D7PR           TH CM Bse Mkt C
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     P3D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     P3EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     P3EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     P3EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P3EHPR           TH CM Gross Car
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Re Calculate Base Carc/Cwt Per Carl Calculation DIFF OF .01-
      *================================================================
      * CASE: PAR.TH CM Yld G/L Carc /CWT is Not Zeros
     C           P3EBPR    IFNE *ZERO                      *IF
     C           P3EDPR    SUB  P3D9PR    P3D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     P3EBPR           TH CM Yld G/L C
     C                     END                             *FI
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * CREATE OR DELETE THE TATTOO HDR EXT WITH CA FIELDS
      *================================================================
      * move payment fields to ca fields
     C                     EXSR NGSUBR                     move payment fi
      * Add/Chg Tattoo Hdr ExtXF - Tattoo Header EXT  * 
     C                     CALL 'PKAXXFR'              90  Add/Chg Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOHMNB    WQ0038  30       BOH Company Num
     C                     PARM WOBNNB    WQ0039  70       BOH Buy Order N
     C                     PARM WOBONB    WQ0040  50       BOL Load Number
     C                     PARM WOCVNB    WQ0041  50       TH Tattoo Numbe
     C                     PARM WOB0DT    WQ0042  70       TH Kill Date
     C                     PARM WUI5PR    WQ0043  52       TH CA Market Pr
     C                     PARM WUJBPR    WQ0044  72       TH CA Base Mark
     C                     PARM WUI6PR    WQ0045  72       TH CA Base Mkt
     C                     PARM WUI7PR    WQ0046  72       TH CA Sort Disc
     C                     PARM WUI8PR    WQ0047  72       TH CA Yield Gai
     C                     PARM WUI9PR    WQ0048  72       TH CA Base Carc
     C                     PARM WUJAPR    WQ0049  72       TH CA Lean Prem
     C                     PARM WUJCPR    WQ0050  72       TH CA Carcass G
     C                     PARM WUJDPR    WQ0051  52       TH CA Bse Mkt L
     C                     PARM WUJEPR    WQ0052  52       TH CA Bse Mkt C
     C                     PARM WUJFPR    WQ0053  52       TH CA Srt Dsc L
     C                     PARM WUJGPR    WQ0054  52       TH CA Srt Dsc C
     C                     PARM WUJHPR    WQ0055  52       TH CA Yld G/L L
     C                     PARM WUJIPR    WQ0056  52       TH CA Yld G/L C
     C                     PARM WUJJPR    WQ0057  52       TH CA Crc Val L
     C                     PARM WUJKPR    WQ0058  52       TH CA Crc Val C
     C                     PARM WUJLPR    WQ0059  52       TH CA Lean Prm
     C                     PARM WUJMPR    WQ0060  52       TH CA Lean Prm
     C                     PARM WUJNPR    WQ0061  52       TH CA Gross Liv
     C                     PARM WUJOPR    WQ0062  52       TH CA Gross Car
     C           W0RTN     PARM W0RTN     WQ0063  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * move payment fields to ca fields
      *================================================================
     C                     Z-ADDWOB8PR    WUI5PR           TH CA Market Pr
     C                     Z-ADDP1AMPR    WUJBPR           TH CA Base Mark
     C                     Z-ADDP1ANPR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDP1AYVA    WUI7PR           TH CA Sort Disc
     C                     Z-ADDP1AWVA    WUI8PR           TH CA Yield Gai
     C                     Z-ADDP1AOPR    WUI9PR           TH CA Base Carc
     C                     Z-ADDP1AXVA    WUJAPR           TH CA Lean Prem
     C                     Z-ADDP1APPR    WUJCPR           TH CA Carcass G
     C                     Z-ADDP3D6PR    WUJDPR           TH CA Bse Mkt L
     C                     Z-ADDP3D7PR    WUJEPR           TH CA Bse Mkt C
     C                     Z-ADDP3D8PR    WUJFPR           TH CA Srt Dsc L
     C                     Z-ADDP3D9PR    WUJGPR           TH CA Srt Dsc C
     C                     Z-ADDP3EAPR    WUJHPR           TH CA Yld G/L L
     C                     Z-ADDP3EBPR    WUJIPR           TH CA Yld G/L C
     C                     Z-ADDP3ECPR    WUJJPR           TH CA Crc Val L
     C                     Z-ADDP3EDPR    WUJKPR           TH CA Crc Val C
     C                     Z-ADDP3EEPR    WUJLPR           TH CA Lean Prm
     C                     Z-ADDP3EFPR    WUJMPR           TH CA Lean Prm
     C                     Z-ADDP3EGPR    WUJNPR           TH CA Gross Liv
     C                     Z-ADDP3EHPR    WUJOPR           TH CA Gross Car
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * Create the Competitors tattoo
      * CASE: PAR.Competitors Processing is Yes
     C           P5MGST    IFEQ 'Y'                        *IF
      * Live
     C                     Z-ADDP3D6PR    WUG5PR           CCT Base /Live
     C                     Z-ADDP3EEPR    WUG6PR           CCT Lean Prem /
     C                     Z-ADDP3EAPR    WUG7PR           CCT Yield G/L /
     C                     Z-ADDP3D8PR    WUG8PR           CCT Sort Dsc /L
     C                     Z-ADDP3EGPR    WUG9PR           CCT Gross /Live
     C                     Z-ADDP3ECPR    WUJUPR           CCT Carc Val /L
      * Carcass
     C                     Z-ADDP3D7PR    WUJPPR           CCT Base /Carc
     C                     Z-ADDP3EFPR    WUJQPR           CCT Lean Prem /
     C                     Z-ADDP3EBPR    WUJRPR           CCT Yield G/L /
     C                     Z-ADDP3D9PR    WUJSPR           CCT Sort Dsc /C
     C                     Z-ADDP3EHPR    WUJTPR           CCT Gross /Carc
     C                     Z-ADDP3EDPR    WUJVPR           CCT Carc Val /C
      * Update
      * Crt Competitors Tattoo CO - Competitors Tattoo  * 
     C                     EXSR TACRRC
     C                     END                             *FI
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc Crc Mrt Activ Crc RT - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0002  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0003  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0004  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0007  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0008  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0009  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0010  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0011  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0012  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0013  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022  72       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0023  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0024  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0025  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0026  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0027  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0028  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0029  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0030  72       CD Gross Before
     C                     MOVEL*BLANK    WN0031  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0032  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0033  1        CMP Sts
     C                     MOVEL*BLANK    WN0034  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0035  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0036  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0037  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0038  1        CMP Type
     C                     Z-ADD*ZERO     WN0039  52       CMP % of Carcas
     C                     Z-ADD*ZERO     WN0040  52       CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0041  52       CMP Grade Type
     C                     Z-ADD*ZERO     WN0042  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0043  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0044  52       CMMR Sort Disco
     C                     Z-ADD*ZERO     WN0045  52       CMMR Unused Fie
     C                     Z-ADD*ZERO     WN0046  52       CMMR Midpoint
     C                     Z-ADD*ZERO     WN0047  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0048  53       CMMC Premium Va
     C                     Z-ADD*ZERO     WN0049  52       PurchPrc + Sort
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 10/11/17 Calc MPR Sort Loss -- change on otherwise stmt
      * 5/23/03  Calc MPR Sort Loss in Carcass Analysis Detail section
      * Initialize Total Fields
     C                     EXSR UASUBR                     Initialize Tota
      * 10/23/2007 CMP Grade Type Adj to store the adj for backfat
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
     C                     EXSR SBRVGN
      * comments
     C                     EXSR UBSUBR                     comments
     C                     Z-ADDP3AWDT    YL0001           CMP Effect Purc
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
     C                     EXSR SCRVGN
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * RTV Market Price      XF - STR Order Management Sys  * 
     C                     CALL 'PDMWXFR'              90  RTV Market Pric
     C                     PARM WURTN     WQ0001  7        *Return code
     C                     PARM YL0002    WQ0002  3        PSC Commodity M
     C                     PARM YL0003    WQ0003  7        PSC Commodity P
     C                     PARM P3AWDT    WQ0004  70       TH Purchase Dat
     C                     PARM *ZERO     WQ0005  70       Date To   USR
     C           YL0004    PARM *ZERO     WQ0006 114       OMS Market Pric
     C           YL0005    PARM *ZERO     WQ0007  70       Pricing Date US
     C                     PARM P1HMNB    WQ0008  30       BOH Company Num
     C                     PARM 'CUR'     WQ0009  3        BOH Market Date
     C                     PARM 'H'       WQ0010  1        System Used
     C           WUIPTX    PARM *BLANK    WQ0011  5        OMS Error Retur
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * FIXED COST
      * if LCL.OMS Market Price Amt Usr is zero, then send a message
      * to some distribution list Market Price not available for Fixed Co
      * Calculation.
      * Market Prc Hog/Cutout USR
      * LCL.Market Prc Hog/Cutout USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : LCL.OMS Market Price Amt Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMP % of Carcass Cutout
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0039    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0004    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Market Prc Hog/
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSA03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSA04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQSA05           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
     C                     KFLD           WQSA04           TH Tattoo Numbe
     C                     KFLD           WQSA05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSA05           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@B1CPEF                    *
     C           KRSSA     READE@B1CPEF                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: Excluded Records
      *  - (c1 AND c2 AND c3) OR (c4 AND c5 AND c6)
      *   |- c1    : PAR.Competitors Processing is Yes
      *   |- c2    : PAR.CM Processing Type Usr is Payment
      *   |- c3    : DB1.CD Record Add/Del Sts is Delete
      *   |- c4    : PAR.Competitors Processing is No
      *   |- c5    : PAR.CM Processing Type Usr is Analysis
      *   |- c6    : DB1.CD Record Add/Del Sts is Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5MGST    IFEQ 'Y'                        *IF
     C           P6M6ST    IFEQ 'P'                        *IF
     C           WAINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P5MGST    IFEQ 'N'                        *IF
     C           P6M6ST    IFEQ 'A'                        *IF
     C           WAINST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.CD Adjust/Add Type is Not Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is Yes
      *   '-
     C           WAUTST    IFEQ 'HST'                      *IF
     C           WAUTST    OREQ 'AVG'
     C           WAUTST    OREQ '2WK'
     C           WAUTST    OREQ '4WK'
     C           WAUTST    OREQ 'LN%'
     C           WAUTST    OREQ *BLANK
     C           WAUTST    OREQ 'LOT'
     C           P5MGST    OREQ 'Y'                        *OR
      * move db1 ca fields to par ca fields
     C                     EXSR UCSUBR                     move db1 ca fie
      * move db1 CD fields to par CD fields
     C                     EXSR UDSUBR                     move db1 CD fie
      * Use competitors Averages or regular carcass analysis
      * CASE: PAR.Average Pay Sts Usr is Yes
     C           WUM7ST    IFEQ 'Y'                        *IF
      * Move Averages to Cd fields before extension or totals are accum
     C                     EXSR UESUBR                     Move Averages t
     C                     ELSE
      * CASE: *OTHERWISE
      * Carcass Analysis Detail
     C                     EXSR UFSUBR                     Carcass Analysi
     C                     END                             *FI
      * Totals
     C                     EXSR UMSUBR                     Totals
      * Move cd fields to ca fields, and or zero out cd fields
      * CASE: PAR.Competitors Processing is Yes
     C           P5MGST    IFEQ 'Y'                        *IF
      * zero out cd ca fields
     C                     EXSR UNSUBR                     zero out cd ca
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.CD Payment Type is Live
     C           P3J9ST    IFEQ 'L'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR UOSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UPSUBR                     zero out cd fie
     C                     ELSE
      * CASE: PAR.CD Payment Type is Carcass Merit
     C           P3J9ST    IFEQ 'C'                        *IF
      * CASE: PAR.CD Source Type is External
     C           P3KAST    IFEQ 'E'                        *IF
      * zero out cd ca fields
     C                     EXSR UQSUBR                     zero out cd ca
      * Leave payment information in the CD fields
     C                     ELSE
      * CASE: PAR.CD Source Type is Internal
     C           P3KAST    IFEQ 'I'                        *IF
      * CASE: PAR.CM Processing Type Usr is Analysis
     C           P6M6ST    IFEQ 'A'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR URSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR USSUBR                     zero out cd fie
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update Production Library
      * CASE: PAR.Competitors Processing is No
     C           P5MGST    IFEQ 'N'                        *IF
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * Create a record in QTEMP
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@B1CPEF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv CMP Payment Info3 RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WBAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSB     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUC6TX           CMP Description
     C                     MOVEL*BLANK    WN0031           CMP Grading Typ
     C                     MOVEL*BLANK    WN0032           CMP Sort Basis
     C                     MOVEL*BLANK    WN0034           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0035           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0036           CMP Lean Factor
     C                     MOVEL*BLANK    WN0037           CMP Optimal Row
     C                     MOVEL*BLANK    WN0038           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WN0039           CMP % of Carcas
     C                     Z-ADD*ZERO     WN0040           CMP Fixed Cost
     C                     Z-ADD*ZERO     WN0041           CMP Grade Type
     C                     MOVEL*BLANK    WUZ2ST           CMP CLC Premium
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBA3TX    WUC6TX           CMP Description
     C                     MOVELWBDLST    WN0031           CMP Grading Typ
     C                     MOVELWBDMST    WN0032           CMP Sort Basis
     C                     MOVELWBDQST    WN0034           CMP Carc Wgt Ty
     C                     Z-ADDWBAZPC    WN0035           CMP Std Lean Pe
     C                     Z-ADDWBA0PC    WN0036           CMP Lean Factor
     C                     MOVELWBDTST    WN0037           CMP Optimal Row
     C                     MOVELWBF5ST    WN0038           CMP Type
     C                     Z-ADDWBI1PR    WUI1PR           CMP Market Add/
     C                     Z-ADDWBVEPR    WN0039           CMP % of Carcas
     C                     Z-ADDWBVFPR    WN0040           CMP Fixed Cost
     C                     Z-ADDWBVHPR    WN0041           CMP Grade Type
     C                     MOVELWBZ2ST    WUZ2ST           CMP CLC Premium
     C                     MOVELWBAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Carcass Merit Prog RT - Carcass Merit Prog MktGrp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQSC01           CMP Program Cod
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           CMP Program Cod
     C                     KFLD           WCGYDT           CMP Effect Purc
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSC01           CMP Program Cod
     C                     Z-ADDYL0001    WCGYDT           CMP Effect Purc
      * Establish starting position
     C           KPSSC     SETLL@BPCPSK                    *
     C           KRSSC     READE@BPCPSK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1291' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           CMP Effect Purc
     C                     MOVEL*BLANK    YL0002           CMP Commodity M
     C                     MOVEL*BLANK    YL0003           CMP Commodity G
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.CMP Effect Kill Date GE DB1.CMP Effect Kill Date
     C           YL0001    IFGE WCGYDT                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWCGYDT    YL0001           CMP Effect Purc
     C                     MOVELWCPXCD    YL0002           CMP Commodity M
     C                     MOVELWCPYCD    YL0003           CMP Commodity G
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.CMP Effect Kill Date LT DB1.CMP Effect Kill Date
     C           YL0001    IFLT WCGYDT                     *IF
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BPCPSK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSD01           CMP Program Cod
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           CMP Program Cod
     C                     KFLD           WDEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSD01           CMP Program Cod
     C                     Z-ADDWAEWNB    WDEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSD     SETLL@BYREJ9                    *
     C           KRSSD     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0042           CMMR Row Number
     C                     Z-ADD*ZERO     WN0043           CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0046           CMMR Midpoint
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDE8NB    WN0042           CMMR Row Number
     C                     Z-ADDWDAQPC    WN0043           CMMR Std Dressi
     C                     Z-ADDWDLJA1    WN0046           CMMR Midpoint
     C                     Z-ADDWDEMNB    WN0001           CD Sort Loss
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSE01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSE02           CMMR Row Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
     C                     KFLD           WQSE02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
     C                     KFLD           WQSE02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSE01           CMP Program Cod
     C                     Z-ADDWN0042    WQSE02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSE     SETLL@BZREKA                    *
     C           KRSSE     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0048           CMMC Premium Va
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAMCD    WQSF01           CMP Program Cod
     C           *LIKE     DEFN WFE8NB    WQSF02           CMMR Row Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           CMP Program Cod
     C                     KFLD           WQSF02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSF01           CMP Program Cod
     C                     Z-ADDWN0042    WQSF02           CMMR Row Number
      * Establish starting position
     C           KRSSF     SETLL@BZREPO                    *
     C           KRSSF     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWFERNB    WN0048           CMMC Premium Va
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAMCD           CMP Program Cod
     C                     KFLD           WGE8NB           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WGAMCD           CMP Program Cod
     C                     Z-ADDYL0008    WGE8NB           CMMR Row Number
      * Establish starting position
     C           KRSSG     CHAIN@BYREGF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           CMMR Midpoint
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGLJA1    YL0009           CMMR Midpoint
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSH01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSH02           CMMR Row Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           CMP Program Cod
     C                     KFLD           WQSH02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSH01           CMP Program Cod
     C                     Z-ADDWN0042    WQSH02           CMMR Row Number
     C                     Z-ADDWN0047    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSH     SETLL@BZREKA                    *
     C           KRSSH     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0048           CMMC Premium Va
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAMCD    WQSI01           CMP Program Cod
     C           *LIKE     DEFN WFE8NB    WQSI02           CMMR Row Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CMP Program Cod
     C                     KFLD           WQSI02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSI01           CMP Program Cod
     C                     Z-ADDWN0042    WQSI02           CMMR Row Number
      * Establish starting position
     C           KRSSI     SETLL@BZREPO                    *
     C           KRSSI     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWFERNB    WN0048           CMMC Premium Va
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAMCD    WQSJ01           CMP Program Cod
     C           *LIKE     DEFN WHE8NB    WQSJ02           CMMR Row Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
     C                     KFLD           WQSJ02           CMMR Row Number
     C                     KFLD           WHE7NB           CMMC Backfat In
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           CMP Program Cod
     C                     KFLD           WQSJ02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSJ01           CMP Program Cod
     C                     Z-ADDWN0042    WQSJ02           CMMR Row Number
     C                     Z-ADDWUVENB    WHE7NB           CMMC Backfat In
      * Establish starting position
     C           KPSSJ     SETLL@BZRETM                    *
     C           KRSSJ     READE@BZRETM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWHERNB    WN0048           CMMC Premium Va
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BZRETM                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAMCD    WQSK01           CMP Program Cod
     C           *LIKE     DEFN WIE8NB    WQSK02           CMMR Row Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CMP Program Cod
     C                     KFLD           WQSK02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSK01           CMP Program Cod
     C                     Z-ADDWN0042    WQSK02           CMMR Row Number
      * Establish starting position
     C           KRSSK     SETLL@BZRETL                    *
     C           KRSSK     READE@BZRETL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWIERNB    WN0048           CMMC Premium Va
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BZRETL                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSL01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSL02           CMMR Row Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           CMP Program Cod
     C                     KFLD           WQSL02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           CMP Program Cod
     C                     KFLD           WQSL02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSL01           CMP Program Cod
     C                     Z-ADDYL0008    WQSL02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSL     SETLL@BZREKA                    *
     C           KRSSL     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0011           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    YL0011           CMMC Premium Va
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSM01           CMP Program Cod
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           CMP Program Cod
     C                     KFLD           WDEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSM01           CMP Program Cod
     C                     Z-ADDWAEWNB    WDEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSM     SETLL@BYREJ9                    *
     C           KRSSM     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           CMMR Row Number
     C                     Z-ADD*ZERO     YL0012           CMMR Std Dressi
     C                     Z-ADD*ZERO     YL0013           CD Sort Loss
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDE8NB    YL0008           CMMR Row Number
     C                     Z-ADDWDAQPC    YL0012           CMMR Std Dressi
     C                     Z-ADDWDEMNB    YL0013           CD Sort Loss
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSN01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSN02           CMMR Row Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
     C                     KFLD           WEA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           CMP Program Cod
     C                     KFLD           WQSN02           CMMR Row Number
      * Setup key
     C                     MOVELP1AMCD    WQSN01           CMP Program Cod
     C                     Z-ADDYL0008    WQSN02           CMMR Row Number
     C                     Z-ADDWAAUPC    WEA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSN     SETLL@BZREKA                    *
     C           KRSSN     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0014           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    YL0014           CMMC Premium Va
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Carcass Detail 2  CH - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0050  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0051  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0052  60       CD Kill Time
     C                     MOVEL*BLANK    WN0053  1        CD Carcass Acti
     C                     Z-ADD*ZERO     WN0054  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0055  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0056  31       CD Light Reflec
     C                     MOVEL*BLANK    WN0057  1        CD Trim Area
     C                     MOVEL*BLANK    WN0058  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0059  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0060  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0061  31       CD Light Reflec
     C                     Z-ADD*ZERO     WN0062  31       CD Lean Percent
     C                     MOVEL*BLANK    WN0063  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0064  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0065  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0066  52       CD Backfat Inch
     C                     MOVEL*BLANK    WN0067  1        CD Broken Back
     C                     MOVEL*BLANK    WN0068  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0069  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0070  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0071  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0072 10        RS User Changed
     C                     Z-ADD*ZERO     WN0073  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0074  60       RS Time Changed
     C                     MOVEL*BLANK    WN0075  1        RS Record Statu
     C                     MOVEL*BLANK    WN0076 10        RS Job
     C                     MOVEL*BLANK    WN0077 10        RS Program
     C                     MOVEL*BLANK    WN0078 10        RS User Added
     C                     Z-ADD*ZERO     WN0079  70       RS Date Added
     C                     Z-ADD*ZERO     WN0080  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWAHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WJBONB           BOL Load Number
     C                     Z-ADDWACVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WJLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WJEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WJLHNB           CD Carcass Numb
      *
     C           KLCHSO    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJLGNB           CD Scale Sequen
     C                     KFLD           WJEUNB           CD Carcass Numb
     C                     KFLD           WJLHNB           CD Carcass Numb
     C           KLCHSO    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YARDCS
      * Move non-key fields to @B1CPG6
     C                     MOVELWAINST    WJINST    P      CD Record Add/D
     C                     Z-ADDWN0001    WJBEPR           CD Sort Loss
     C                     Z-ADDWN0002    WJASPC           CD STD Yield
     C                     Z-ADDWN0003    WJB4PR           CD Base Carcass
     C                     Z-ADDWN0004    WJEYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    WJB1PR           CD Base Carc Va
     C                     Z-ADDWN0006    WJAVPR           CD Crc Value $
     C                     Z-ADDWN0008    WJAWPR           CD Lean Premium
     C                     Z-ADDWN0009    WJAXPR           CD Lean Premium
     C                     Z-ADDWN0010    WJEZNB           CD Gross Value
     C                     Z-ADDWN0011    WJAYPR           CD Gross Value
     C                     Z-ADDWABBDT    WJBBDT           CD Kill Date
     C                     MOVELWAIQST    WJIQST    P      CD Shift
     C                     Z-ADDWABHPC    WJBHPC           CD FFLI
     C                     MOVELWAIOST    WJIOST    P      CD Record Creat
     C                     MOVELWAIPST    WJIPST    P      CD Record Creat
     C                     Z-ADDWALTNB    WJLTNB           CD LOT
     C                     MOVELWAJNST    WJJNST    P      CD User Error O
     C                     MOVELP3KAST    WJK2ST    P      CD Source Type
     C                     MOVELP3J9ST    WJK3ST    P      CD Payment Type
     C                     Z-ADDWN0013    WJJWPR           CD CA Sort Loss
     C                     Z-ADDWN0014    WJF5PC           CD CA Std Yield
     C                     Z-ADDWN0015    WJJXPR           CD CA Base Carc
     C                     Z-ADDWN0016    WJJYPR           CD CA Crc Value
     C                     Z-ADDWN0017    WJJZPR           CD CA Base Carc
     C                     Z-ADDWN0018    WJJ0PR           CD CA Crc Value
     C                     Z-ADDWN0019    WJJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0020    WJJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0021    WJJ3PR           CD CA Gross Val
     C                     Z-ADDWN0022    WJJ4PR           CD CA Gross Val
     C                     Z-ADDWN0023    WJIJGR           CD Meat Value F
     C                     Z-ADDWN0024    WJORJE           CD Lean Prem/Di
     C                     Z-ADDWN0025    WJOTJR           CD Fixed Cost F
     C                     Z-ADDWN0026    WJPEIR           CD MPR Sort Los
     C                     Z-ADDWN0027    WJIEUF           CD Meat Value F
     C                     Z-ADDWN0028    WJORUE           CD Fixed Cost F
     C                     Z-ADDWN0029    WJIUTR           CD Gross Before
     C                     Z-ADDWN0030    WJIJRR           CD Gross Before
     C                     MOVELWAABCD    WJABCD    P      PD Producer Cod
     C                     MOVELWAAACD    WJAACD    P      SR Source Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPVI
     C                     Z-ADDWAHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WKBONB           BOL Load Number
     C                     Z-ADDWACVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WKB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WKLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WKEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WKLHNB           CD Carcass Numb
     C                     MOVELWAINST    WKINST           CD Record Add/D
     C                     Z-ADDWN0001    WKBEPR           CD Sort Loss
     C                     Z-ADDWN0002    WKASPC           CD STD Yield
     C                     Z-ADDWAEWNB    WKEWNB           CD Carcass/Hot
     C                     Z-ADDWN0003    WKB4PR           CD Base Carcass
     C                     Z-ADDWN0004    WKEYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    WKB1PR           CD Base Carc Va
     C                     Z-ADDWN0006    WKAVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    WKAUPC           CD Lean Percent
     C                     Z-ADDWN0008    WKAWPR           CD Lean Premium
     C                     Z-ADDWN0009    WKAXPR           CD Lean Premium
     C                     Z-ADDWN0010    WKEZNB           CD Gross Value
     C                     Z-ADDWN0011    WKAYPR           CD Gross Value
     C                     Z-ADDWABBDT    WKBBDT           CD Kill Date
     C                     Z-ADDWAAKTM    WKAKTM           CD Kill Time
     C                     MOVELWAIQST    WKIQST           CD Shift
     C                     MOVELWAEFST    WKEFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    WKH6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    WKBEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    WKGCST           CD Light Reflec
     C                     MOVELWAGDST    WKGDST           CD Trim Area
     C                     MOVELWAGEST    WKGEST           CD Carcass Sex
     C                     Z-ADDWABHPC    WKBHPC           CD FFLI
     C                     MOVELWAIOST    WKIOST           CD Record Creat
     C                     MOVELWAIPST    WKIPST           CD Record Creat
     C                     Z-ADDWALTNB    WKLTNB           CD LOT
     C                     MOVELWAJNST    WKJNST           CD User Error O
     C                     Z-ADDWAX4NB    WKX4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    WKFNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    WKFOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    WKFPPC           CD Lean Percent
     C                     MOVELP3KAST    WKK2ST           CD Source Type
     C                     MOVELWAK3ST    WKK3ST           CD Payment Type
     C                     Z-ADDWN0013    WKJWPR           CD CA Sort Loss
     C                     Z-ADDWN0014    WKF5PC           CD CA Std Yield
     C                     Z-ADDWN0015    WKJXPR           CD CA Base Carc
     C                     Z-ADDWN0016    WKJYPR           CD CA Crc Value
     C                     Z-ADDWN0017    WKJZPR           CD CA Base Carc
     C                     Z-ADDWN0018    WKJ0PR           CD CA Crc Value
     C                     Z-ADDWN0019    WKJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0020    WKJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0021    WKJ3PR           CD CA Gross Val
     C                     Z-ADDWN0022    WKJ4PR           CD CA Gross Val
     C                     MOVELWAUTST    WKUTST           CD Adjust/Add T
     C                     MOVELWAHVCD    WKHVCD           CD Producer Loc
     C                     Z-ADDWADKJR    WKDKJR           CD Loin Eye Inc
     C                     Z-ADDWAITJF    WKITJF           CD Backfat Inch
     C                     Z-ADDWAIJGR    WKIJGR           CD Meat Value F
     C                     Z-ADDWAORJE    WKORJE           CD Lean Prem/Di
     C                     Z-ADDWAOTJR    WKOTJR           CD Fixed Cost F
     C                     Z-ADDWAPEIR    WKPEIR           CD MPR Sort Los
     C                     Z-ADDWAIEUF    WKIEUF           CD Meat Value F
     C                     Z-ADDWAORUE    WKORUE           CD Fixed Cost F
     C                     Z-ADDWAIUTR    WKIUTR           CD Gross Before
     C                     Z-ADDWAIJRR    WKIJRR           CD Gross Before
     C                     MOVELWAVCST    WKVCST           CD Broken Back
     C                     MOVELWAVDST    WKVDST           CD Adjust/Add S
     C                     MOVELWAVEST    WKVEST           CD Unused Sts 3
     C                     MOVELWAVFST    WKVFST           CD Unused Sts 4
     C                     MOVELWAVGST    WKVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WKABCD           PD Producer Cod
     C                     MOVELWAAACD    WKAACD           SR Source Code
     C                     MOVELWAAAVN    WKAAVN           RS User Changed
     C                     Z-ADDWAAADT    WKAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WKAMTM           RS Time Changed
     C                     MOVELWAAJST    WKAJST           RS Record Statu
     C                     MOVELWAAHVN    WKAHVN           RS Job
     C                     MOVELWAAGVN    WKAGVN           RS Program
     C                     MOVELWAABVN    WKABVN           RS User Added
     C                     Z-ADDWAABDT    WKABDT           RS Date Added
     C                     Z-ADDWAABTM    WKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WKAJST           RS Record Statu
     C                     MOVEL##USR     WKABVN           RS User Added
     C                     Z-ADD##JDT     WKABDT           RS Date Added
     C                     Z-ADD##JTM     WKABTM           RS Time Added
     C                     MOVEL##PGM     WKAGVN           RS Program
     C                     MOVEL##JOB     WKAHVN           RS Job
     C           KLCRSP    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C                     KFLD           WKLGNB           CD Scale Sequen
     C                     KFLD           WKEUNB           CD Carcass Numb
     C                     KFLD           WKLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSP    SETLL@B1CPVI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPVI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Clc Crc Mrt Added Crc RT - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0081  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0082  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0083  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0084  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0085  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0086  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0087  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0088  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0089  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0090  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0091  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0092  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0093  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0094  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0095  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0096  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0097  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0098  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0099  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0100  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0101  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0102  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0103  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0104  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0105  1        CMP Sts
     C                     MOVEL*BLANK    WN0106  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0107  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0108  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0109  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0110  1        CMP Type
     C                     Z-ADD*ZERO     WN0111  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0112  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0113  52       CMMR Sort Disco
     C                     Z-ADD*ZERO     WN0114  52       CMMR Unused Fie
     C                     Z-ADD*ZERO     WN0115  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0116  53       CMMC Premium Va
     C                     Z-ADD*ZERO     WN0117  52       PurchPrc + Sort
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification History
     C                     EXSR UTSUBR                     Modification Hi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN WLBONB    WQSQ03           BOL Load Number
     C           *LIKE     DEFN WLCVNB    WQSQ04           TH Tattoo Numbe
     C           *LIKE     DEFN WLB0DT    WQSQ05           TH Kill Date
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
     C                     KFLD           WQSQ04           TH Tattoo Numbe
     C                     KFLD           WQSQ05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSQ01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSQ03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSQ04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSQ05           TH Kill Date
      * Establish starting position
     C           KRSSQ     SETLL@B1CPEG                    *
     C           KRSSQ     READE@B1CPEG                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *-----------------------------------------------------------*
      * * 02/14/02 PKD Added because the Base is zero for added carcasses
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0112    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0112    DIV  100       W0WD01    H      *Synon (17,7) w
     C           P1AMPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0083           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0083           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
     C                     Z-ADDP1AMPR    WN0083           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WLEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0083    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0085           CD Base Carc Va
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0104    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           P1AMPR    ADD  WN0081    W0WA01           *Synon (15,2) w
     C           WN0112    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0084           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0112    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0081    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0083    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0084           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0104    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0112    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0081    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           P1AMPR    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0112    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0084           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0083    ADD  WN0081    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0084           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0104    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0083    WN0084           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WLEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0084    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0086           CD Crc Value $
      * *-----------------------------------------------------------*
     C                     Z-ADDP3TAPR    WN0091           CD Gross Value
      * Lean Premium /Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x2 - x1)
      * x2    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x1    : PAR.CD Crc Value $ Per Hd
     C           WN0091    SUB  WN0086    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0089           CD Lean Premium
      * Lean Premium CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.CD Lean Premium $ Per Hd
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WN0089    DIV  WLEWNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0088           CD Lean Premium
      * Gross Value Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x2 + x1)
      * x2    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x1    : PAR.CD Lean Premium CWT
     C           WN0084    ADD  WN0088    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0090           CD Gross Value
      * Totals
     C                     EXSR UUSUBR                     Totals
      * Move CD Fields to CA Fields
      * CASE: PAR.CD Payment Type is Live
     C           P3J9ST    IFEQ 'L'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR UVSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UWSUBR                     zero out cd fie
     C                     ELSE
      * CASE: PAR.CD Payment Type is Carcass Merit
     C           P3J9ST    IFEQ 'C'                        *IF
      * CASE: PAR.CD Source Type is External
     C           P3KAST    IFEQ 'E'                        *IF
      * zero out cd ca fields
     C                     EXSR UXSUBR                     zero out cd ca
      * Leave payment information in the CD fields
     C                     ELSE
      * CASE: PAR.CD Source Type is Internal
     C           P3KAST    IFEQ 'I'                        *IF
      * CASE: PAR.CM Processing Type Usr is Analysis
     C           P6M6ST    IFEQ 'A'                        *IF
      * move cd fields to cd ca fields
     C                     EXSR UYSUBR                     move cd fields
      * zero out cd fields
     C                     EXSR UZSUBR                     zero out cd fie
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.CD CA Std Yield is eq 0
     C           WLF5PC    IFEQ 0                          *IF
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
     C                     EXSR SRRVGN
     C                     Z-ADDYL0016    YL0017           CD STD Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLASPC    YL0017           CD STD Yield
     C                     END                             *FI
      * Chg Carcass Detail    CH - Carcass Detail  * 
     C                     EXSR SSCHRC
      * Create a record in QTEMP
      * CASE: PAR.Print Comp Sum/Dtl STS is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
     C                     EXSR STCRRC
     C                     END                             *FI
     C           KRSSQ     READE@B1CPEG                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSR01           CMP Program Cod
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
     C                     KFLD           WDEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WQSR01           CMP Program Cod
     C                     Z-ADDWLEWNB    WDEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSSR     SETLL@BYREJ9                    *
     C           KRSSR     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0016           CMMR Std Dressi
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAQPC    YL0016           CMMR Std Dressi
     C                     Z-ADDWDEMNB    YN0003           CD Sort Loss
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Carcass Detail    CH - Carcass Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0118  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0119  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0120  60       CD Kill Time
     C                     MOVEL*BLANK    WN0121  1        CD Carcass Acti
     C                     Z-ADD*ZERO     WN0122  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0123  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0124  31       CD Light Reflec
     C                     MOVEL*BLANK    WN0125  1        CD Trim Area
     C                     MOVEL*BLANK    WN0126  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0127  31       CD Backfat Thic
     C                     Z-ADD*ZERO     WN0128  31       CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WN0129  31       CD Light Reflec
     C                     Z-ADD*ZERO     WN0130  31       CD Lean Percent
     C                     MOVEL*BLANK    WN0131  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0132  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0133  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0134  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0135  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0136  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0137  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0138  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0139  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0140  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0141  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0142  72       CD Gross Before
     C                     MOVEL*BLANK    WN0143  1        CD Broken Back
     C                     MOVEL*BLANK    WN0144  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0145  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0146  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0147  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0148 10        RS User Changed
     C                     Z-ADD*ZERO     WN0149  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0150  60       RS Time Changed
     C                     MOVEL*BLANK    WN0151  1        RS Record Statu
     C                     MOVEL*BLANK    WN0152 10        RS Job
     C                     MOVEL*BLANK    WN0153 10        RS Program
     C                     MOVEL*BLANK    WN0154 10        RS User Added
     C                     Z-ADD*ZERO     WN0155  70       RS Date Added
     C                     Z-ADD*ZERO     WN0156  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWLHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WJBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWLLGNB    WJLGNB           CD Scale Sequen
     C                     Z-ADDWLEUNB    WJEUNB           CD Carcass Numb
     C                     Z-ADDWLLHNB    WJLHNB           CD Carcass Numb
      *
     C           KLCHSS    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJLGNB           CD Scale Sequen
     C                     KFLD           WJEUNB           CD Carcass Numb
     C                     KFLD           WJLHNB           CD Carcass Numb
     C           KLCHSS    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YBRDCS
      * Move non-key fields to @B1CPG6
     C                     MOVELWLINST    WJINST    P      CD Record Add/D
     C                     Z-ADDWLBEPR    WJBEPR           CD Sort Loss
     C                     Z-ADDYL0017    WJASPC           CD STD Yield
     C                     Z-ADDWN0083    WJB4PR           CD Base Carcass
     C                     Z-ADDWN0084    WJEYNB           CD Crc Value Pe
     C                     Z-ADDWN0085    WJB1PR           CD Base Carc Va
     C                     Z-ADDWN0086    WJAVPR           CD Crc Value $
     C                     Z-ADDWN0088    WJAWPR           CD Lean Premium
     C                     Z-ADDWN0089    WJAXPR           CD Lean Premium
     C                     Z-ADDWN0090    WJEZNB           CD Gross Value
     C                     Z-ADDWN0091    WJAYPR           CD Gross Value
     C                     Z-ADDWLBBDT    WJBBDT           CD Kill Date
     C                     MOVELWLIQST    WJIQST    P      CD Shift
     C                     Z-ADDWLBHPC    WJBHPC           CD FFLI
     C                     MOVELWLIOST    WJIOST    P      CD Record Creat
     C                     MOVELWLIPST    WJIPST    P      CD Record Creat
     C                     Z-ADDWLLTNB    WJLTNB           CD LOT
     C                     MOVELWLJNST    WJJNST    P      CD User Error O
     C                     MOVELWLK2ST    WJK2ST    P      CD Source Type
     C                     MOVELWLK3ST    WJK3ST    P      CD Payment Type
     C                     Z-ADDWLJWPR    WJJWPR           CD CA Sort Loss
     C                     Z-ADDWLF5PC    WJF5PC           CD CA Std Yield
     C                     Z-ADDWLJXPR    WJJXPR           CD CA Base Carc
     C                     Z-ADDWLJYPR    WJJYPR           CD CA Crc Value
     C                     Z-ADDWLJZPR    WJJZPR           CD CA Base Carc
     C                     Z-ADDWLJ0PR    WJJ0PR           CD CA Crc Value
     C                     Z-ADDWN0099    WJJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0100    WJJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0101    WJJ3PR           CD CA Gross Val
     C                     Z-ADDWN0102    WJJ4PR           CD CA Gross Val
     C                     MOVELWLABCD    WJABCD    P      PD Producer Cod
     C                     MOVELWLAACD    WJAACD    P      SR Source Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Crt Carcass Dtl QTEMP CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPVI
     C                     Z-ADDWLHMNB    WKHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WKBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WKBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB0DT    WKB0DT           TH Kill Date
     C                     Z-ADDWLLGNB    WKLGNB           CD Scale Sequen
     C                     Z-ADDWLEUNB    WKEUNB           CD Carcass Numb
     C                     Z-ADDWLLHNB    WKLHNB           CD Carcass Numb
     C                     MOVELWLINST    WKINST           CD Record Add/D
     C                     Z-ADDWLBEPR    WKBEPR           CD Sort Loss
     C                     Z-ADDYL0017    WKASPC           CD STD Yield
     C                     Z-ADDWLEWNB    WKEWNB           CD Carcass/Hot
     C                     Z-ADDWLB4PR    WKB4PR           CD Base Carcass
     C                     Z-ADDWLEYNB    WKEYNB           CD Crc Value Pe
     C                     Z-ADDWLB1PR    WKB1PR           CD Base Carc Va
     C                     Z-ADDWLAVPR    WKAVPR           CD Crc Value $
     C                     Z-ADDWLAUPC    WKAUPC           CD Lean Percent
     C                     Z-ADDWN0088    WKAWPR           CD Lean Premium
     C                     Z-ADDWN0089    WKAXPR           CD Lean Premium
     C                     Z-ADDWN0090    WKEZNB           CD Gross Value
     C                     Z-ADDWN0091    WKAYPR           CD Gross Value
     C                     Z-ADDWLBBDT    WKBBDT           CD Kill Date
     C                     Z-ADDWLAKTM    WKAKTM           CD Kill Time
     C                     MOVELWLIQST    WKIQST           CD Shift
     C                     MOVELWLEFST    WKEFST           CD Carcass Acti
     C                     Z-ADDWLH6NB    WKH6NB           CD Backfat Thic
     C                     Z-ADDWLBEPC    WKBEPC           CD Loin-Eye Dep
     C                     Z-ADDWLGCST    WKGCST           CD Light Reflec
     C                     MOVELWLGDST    WKGDST           CD Trim Area
     C                     MOVELWLGEST    WKGEST           CD Carcass Sex
     C                     Z-ADDWLBHPC    WKBHPC           CD FFLI
     C                     MOVELWLIOST    WKIOST           CD Record Creat
     C                     MOVELWLIPST    WKIPST           CD Record Creat
     C                     Z-ADDWLLTNB    WKLTNB           CD LOT
     C                     MOVELWLJNST    WKJNST           CD User Error O
     C                     Z-ADDWLX4NB    WKX4NB           CD Backfat Thic
     C                     Z-ADDWLFNPC    WKFNPC           CD Loin-Eye Dep
     C                     Z-ADDWLFOPC    WKFOPC           CD Light Reflec
     C                     Z-ADDWLFPPC    WKFPPC           CD Lean Percent
     C                     MOVELWLK2ST    WKK2ST           CD Source Type
     C                     MOVELWLK3ST    WKK3ST           CD Payment Type
     C                     Z-ADDWLJWPR    WKJWPR           CD CA Sort Loss
     C                     Z-ADDWLF5PC    WKF5PC           CD CA Std Yield
     C                     Z-ADDWLJXPR    WKJXPR           CD CA Base Carc
     C                     Z-ADDWLJYPR    WKJYPR           CD CA Crc Value
     C                     Z-ADDWLJZPR    WKJZPR           CD CA Base Carc
     C                     Z-ADDWLJ0PR    WKJ0PR           CD CA Crc Value
     C                     Z-ADDWN0099    WKJ1PR           CD CA Lean Prem
     C                     Z-ADDWN0100    WKJ2PR           CD CA Lean Prem
     C                     Z-ADDWN0101    WKJ3PR           CD CA Gross Val
     C                     Z-ADDWN0102    WKJ4PR           CD CA Gross Val
     C                     MOVELWLUTST    WKUTST           CD Adjust/Add T
     C                     MOVELWLHVCD    WKHVCD           CD Producer Loc
     C                     Z-ADDWLDKJR    WKDKJR           CD Loin Eye Inc
     C                     Z-ADDWLITJF    WKITJF           CD Backfat Inch
     C                     Z-ADDWLIJGR    WKIJGR           CD Meat Value F
     C                     Z-ADDWLORJE    WKORJE           CD Lean Prem/Di
     C                     Z-ADDWLOTJR    WKOTJR           CD Fixed Cost F
     C                     Z-ADDWLPEIR    WKPEIR           CD MPR Sort Los
     C                     Z-ADDWLIEUF    WKIEUF           CD Meat Value F
     C                     Z-ADDWLORUE    WKORUE           CD Fixed Cost F
     C                     Z-ADDWLIUTR    WKIUTR           CD Gross Before
     C                     Z-ADDWLIJRR    WKIJRR           CD Gross Before
     C                     MOVELWLVCST    WKVCST           CD Broken Back
     C                     MOVELWLVDST    WKVDST           CD Adjust/Add S
     C                     MOVELWLVEST    WKVEST           CD Unused Sts 3
     C                     MOVELWLVFST    WKVFST           CD Unused Sts 4
     C                     MOVELWLVGST    WKVGST           CD Unused Sts 5
     C                     MOVELWLABCD    WKABCD           PD Producer Cod
     C                     MOVELWLAACD    WKAACD           SR Source Code
     C                     MOVELWLAAVN    WKAAVN           RS User Changed
     C                     Z-ADDWLAADT    WKAADT           RS Date Changed
     C                     Z-ADDWLAMTM    WKAMTM           RS Time Changed
     C                     MOVELWLAJST    WKAJST           RS Record Statu
     C                     MOVELWLAHVN    WKAHVN           RS Job
     C                     MOVELWLAGVN    WKAGVN           RS Program
     C                     MOVELWLABVN    WKABVN           RS User Added
     C                     Z-ADDWLABDT    WKABDT           RS Date Added
     C                     Z-ADDWLABTM    WKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WKAJST           RS Record Statu
     C                     MOVEL##USR     WKABVN           RS User Added
     C                     Z-ADD##JDT     WKABDT           RS Date Added
     C                     Z-ADD##JTM     WKABTM           RS Time Added
     C                     MOVEL##PGM     WKAGVN           RS Program
     C                     MOVEL##JOB     WKAHVN           RS Job
     C           KLCRST    KLIST
     C                     KFLD           WKHMNB           BOH Company Num
     C                     KFLD           WKBNNB           BOH Buy Order N
     C                     KFLD           WKBONB           BOL Load Number
     C                     KFLD           WKCVNB           TH Tattoo Numbe
     C                     KFLD           WKB0DT           TH Kill Date
     C                     KFLD           WKLGNB           CD Scale Sequen
     C                     KFLD           WKEUNB           CD Carcass Numb
     C                     KFLD           WKLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRST    SETLL@B1CPVI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPVI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WBAMCD           CMP Program Cod
      * Setup key
     C                     MOVELP1AMCD    WBAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSU     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0018           CMP Grading Typ
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBDLST    YL0018           CMP Grading Typ
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv PrSb-Cont Carc/Sm RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WMAKCD           PC Contract Cod
     C                     KFLD           WMALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELP1AKCD    WMAKCD           PC Contract Cod
     C                     MOVELP1ALCD    WMALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSV     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMA7PR    YL0019           PSC Break Even
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Chg Tattoo SummaryNEW RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WOHMNB           BOH Company Num
     C                     KFLD           WOBNNB           BOH Buy Order N
     C                     KFLD           WOBONB           BOL Load Number
     C                     KFLD           WOCVNB           TH Tattoo Numbe
     C                     KFLD           WOB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WOHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WOBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WOBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WOCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WOB0DT           TH Kill Date
      * Establish starting position
     C           KRSSW     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'N'       WUM8ST           Create Ext file
      * CASE: PAR.Competitors Processing is Yes
     C           P5MGST    IFEQ 'Y'                        *IF
      * zero out tattoo heade ext on ca fields if competitors
      * 030106 slm change routine not to delete records anymore
      * we believe that this routine has a create but does not create
      * the record now since we should always be in change mode.
      * Add/Chg Tattoo Hdr ExtXF - Tattoo Header EXT  * 
     C                     CALL 'PKAXXFR'              90  Add/Chg Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WOHMNB    WQ0012  30       BOH Company Num
     C                     PARM WOBNNB    WQ0013  70       BOH Buy Order N
     C                     PARM WOBONB    WQ0014  50       BOL Load Number
     C                     PARM WOCVNB    WQ0015  50       TH Tattoo Numbe
     C                     PARM WOB0DT    WQ0016  70       TH Kill Date
     C                     PARM *ZERO     WQ0017  52       TH CA Market Pr
     C                     PARM *ZERO     WQ0018  72       TH CA Base Mark
     C                     PARM *ZERO     WQ0019  72       TH CA Base Mkt
     C                     PARM *ZERO     WQ0020  72       TH CA Sort Disc
     C                     PARM *ZERO     WQ0021  72       TH CA Yield Gai
     C                     PARM *ZERO     WQ0022  72       TH CA Base Carc
     C                     PARM *ZERO     WQ0023  72       TH CA Lean Prem
     C                     PARM *ZERO     WQ0024  72       TH CA Carcass G
     C                     PARM *ZERO     WQ0025  52       TH CA Bse Mkt L
     C                     PARM *ZERO     WQ0026  52       TH CA Bse Mkt C
     C                     PARM *ZERO     WQ0027  52       TH CA Srt Dsc L
     C                     PARM *ZERO     WQ0028  52       TH CA Srt Dsc C
     C                     PARM *ZERO     WQ0029  52       TH CA Yld G/L L
     C                     PARM *ZERO     WQ0030  52       TH CA Yld G/L C
     C                     PARM *ZERO     WQ0031  52       TH CA Crc Val L
     C                     PARM *ZERO     WQ0032  52       TH CA Crc Val C
     C                     PARM *ZERO     WQ0033  52       TH CA Lean Prm
     C                     PARM *ZERO     WQ0034  52       TH CA Lean Prm
     C                     PARM *ZERO     WQ0035  52       TH CA Gross Liv
     C                     PARM *ZERO     WQ0036  52       TH CA Gross Car
     C           W0RTN     PARM W0RTN     WQ0037  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKAXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Carc Summary Info CH - Tattoo Header  * 
     C                     EXSR SXCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.CM Processing Type Usr is Analysis
     C           P6M6ST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WUM8ST           Create Ext file
      * CREATE OR DELETE THE TATTOO HDR EXT WITH CA FIELDS
     C                     EXSR NFSUBR                     CREATE OR DELET
      * Chg Carc Summary Info CH - Tattoo Header  * 
     C                     EXSR SYCHRC
     C                     ELSE
      * CASE: PAR.CM Processing Type Usr is Payment
     C           P6M6ST    IFEQ 'P'                        *IF
      * Chg Carc Summary Info CH - Tattoo Header  * 
     C                     EXSR SZCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Carc Summary Info CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0157  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0158 10        TH Group Refere
     C                     MOVEL*BLANK    WN0159  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0160  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0161  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0162  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0163  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0164  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0165  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0166  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0167  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0168  50       TH Held Over
     C                     Z-ADD*ZERO     WN0169  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0170  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0171  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0172  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0173  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0174  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0175  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0176  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0177  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0178  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0179  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0180  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0181  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0182  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0183  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0184  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0185  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0186  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0187  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0188  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0189  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0190  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0191  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0192  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0193  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0194  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0195  1        TH Header Error
     C                     MOVEL*BLANK    WN0196  1        TH Detail Error
     C                     MOVEL*BLANK    WN0197  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0198  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0199  80       TH Commission A
     C                     Z-ADD*ZERO     WN0200  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0201  1        TH User Error O
     C                     MOVEL*BLANK    WN0202  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0203  1        TH Sex
     C                     Z-ADD*ZERO     WN0204  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0205  70       TH Commission P
     C                     Z-ADD*ZERO     WN0206  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0207  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0208  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0209  31       TH FFLI
     C                     Z-ADD*ZERO     WN0210  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0211  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0212  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0213  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0214  1        TH Source Type
     C                     MOVEL*BLANK    WN0215  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0216  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0217  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0218  3        TH Source Code
     C                     MOVEL*BLANK    WN0219  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0220  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0221  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0222  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0223  3        TH State
     C                     MOVEL*BLANK    WN0224  3        TH Unused Code
     C                     MOVEL*BLANK    WN0225  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0226  1        TH Commission S
     C                     MOVEL*BLANK    WN0227  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0228  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0229  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0230  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0231  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0232  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0233  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0234  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0235  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0236  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0237  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0238  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0239  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0240  3        TH PHA Average
     C                     MOVEL*BLANK    WN0241  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0242  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0243  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0244  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0245  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0246  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0247  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0248  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0249  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0250 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0251 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0252  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0253  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0254  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0255  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0256  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0257  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0258  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0259  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0260  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0261  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0262  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0263  70       TH Unused Date
     C                     MOVEL*BLANK    WN0264  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0265  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0266  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0267  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0268  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0269  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0270  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0271  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0272  6        DF Defect Code
     C                     MOVEL*BLANK    WN0273  6        THP Process Cod
     C                     MOVEL*BLANK    WN0274  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0275  6        PL Location Cod
     C                     MOVEL*BLANK    WN0276  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0277  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0278  3        HC Class Code
     C                     MOVEL*BLANK    WN0279 10        RS User Changed
     C                     Z-ADD*ZERO     WN0280  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0281  60       RS Time Changed
     C                     MOVEL*BLANK    WN0282  1        RS Record Statu
     C                     MOVEL*BLANK    WN0283 10        RS Job
     C                     MOVEL*BLANK    WN0284 10        RS Program
     C                     MOVEL*BLANK    WN0285 10        RS User Added
     C                     Z-ADD*ZERO     WN0286  70       RS Date Added
     C                     Z-ADD*ZERO     WN0287  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WRHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WRBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WRBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WRCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WRB0DT           TH Kill Date
      *
     C           KLCHSX    KLIST
     C                     KFLD           WRHMNB           BOH Company Num
     C                     KFLD           WRBNNB           BOH Buy Order N
     C                     KFLD           WRBONB           BOL Load Number
     C                     KFLD           WRCVNB           TH Tattoo Numbe
     C                     KFLD           WRB0DT           TH Kill Date
     C           KLCHSX    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWOB9PR    WRB9PR           TH Live Gross A
     C                     Z-ADDWOCAPR    WRCAPR           TH LIve Net Amt
     C                     Z-ADDP1AVPC    WRAVPC           TH Std Yield Pe
     C                     Z-ADDP1A8PC    WRA8PC           TH Yield Differ
     C                     Z-ADDWOB8PR    WRB8PR           TH CM Market Pr
     C                     Z-ADDP1AMPR    WRAMPR           TH CM Base Mkt
     C                     Z-ADDP1ANPR    WRANPR           TH CM Base Mkt
     C                     Z-ADDP1AYVA    WRAYVA           TH CM Sort Disc
     C                     Z-ADDP1AWVA    WRAWVA           TH CM Yield Gai
     C                     Z-ADDP1AOPR    WRAOPR           TH CM Base Carc
     C                     Z-ADDP1AXVA    WRAXVA           TH CM LN AddOn/
     C                     Z-ADDP1APPR    WRAPPR           TH CM Carcass G
     C                     Z-ADDWOCBPR    WRCBPR           TH Payment Gros
     C                     Z-ADDWOCCPR    WRCCPR           Th Payment Net
     C                     Z-ADDWOLPNB    WRLPNB           TH AP Voucher/D
     C                     Z-ADDWOCDPR    WRCDPR           TH Freight Amou
     C                     Z-ADDP2A2PR    WRA2PR           TH Fixed Cost A
     C                     Z-ADDP3D6PR    WRD6PR           TH CM Bse Mkt L
     C                     Z-ADDP3D7PR    WRD7PR           TH CM Bse Mkt C
     C                     Z-ADDP3D8PR    WRD8PR           TH CM Srt Dsc L
     C                     Z-ADDP3D9PR    WRD9PR           TH CM Srt Dsc C
     C                     Z-ADDP3EAPR    WREAPR           TH CM Yld G/L L
     C                     Z-ADDP3EBPR    WREBPR           TH CM Yld G/L C
     C                     Z-ADDP3ECPR    WRECPR           TH CM Crc Val L
     C                     Z-ADDP3EDPR    WREDPR           TH CM Crc Val C
     C                     Z-ADDP3EEPR    WREEPR           TH CM Lean Prem
     C                     Z-ADDP3EFPR    WREFPR           TH CM Lean Prem
     C                     Z-ADDP3EGPR    WREGPR           TH CM Gross Liv
     C                     Z-ADDP3EHPR    WREHPR           TH CM Gross Car
     C                     Z-ADDP3TAPR    WRTAPR           TH VC Gross Val
     C                     Z-ADDP3TBPR    WRTBPR           TH Excluded Gro
     C                     Z-ADDP3KROT    WRKROT           TH Excluded Car
     C                     Z-ADDP3OTJG    WROTJG           TH Excluded Pre
     C                     Z-ADDP3OJRF    WROJRF           TH Break Even P
     C                     Z-ADDP2KFOR    WRKFOR           TH Meat Value F
     C                     Z-ADDWONCHF    WRNCHF           TH MPR Sort Los
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Carc Summary Info CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0288  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0289 10        TH Group Refere
     C                     MOVEL*BLANK    WN0290  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0291  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0292  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0293  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0294  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0295  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0296  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0297  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0298  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0299  50       TH Held Over
     C                     Z-ADD*ZERO     WN0300  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0301  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0302  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0303  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0304  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0305  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0306  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0307  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0308  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0309  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0310  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0311  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0312  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0313  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0314  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0315  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0316  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0317  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0318  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0319  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0320  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0321  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0322  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0323  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0324  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0325  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0326  1        TH Header Error
     C                     MOVEL*BLANK    WN0327  1        TH Detail Error
     C                     MOVEL*BLANK    WN0328  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0329  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0330  80       TH Commission A
     C                     Z-ADD*ZERO     WN0331  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0332  1        TH User Error O
     C                     MOVEL*BLANK    WN0333  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0334  1        TH Sex
     C                     Z-ADD*ZERO     WN0335  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0336  70       TH Commission P
     C                     Z-ADD*ZERO     WN0337  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0338  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0339  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0340  31       TH FFLI
     C                     Z-ADD*ZERO     WN0341  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0342  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0343  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0344  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0345  1        TH Source Type
     C                     MOVEL*BLANK    WN0346  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0347  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0348  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0349  3        TH Source Code
     C                     MOVEL*BLANK    WN0350  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0351  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0352  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0353  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0354  3        TH State
     C                     MOVEL*BLANK    WN0355  3        TH Unused Code
     C                     MOVEL*BLANK    WN0356  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0357  1        TH Commission S
     C                     MOVEL*BLANK    WN0358  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0359  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0360  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0361  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0362  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0363  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0364  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0365  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0366  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0367  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0368  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0369  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0370  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0371  3        TH PHA Average
     C                     MOVEL*BLANK    WN0372  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0373  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0374  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0375  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0376  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0377  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0378  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0379  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0380  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0381 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0382 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0383  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0384  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0385  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0386  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0387  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0388  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0389  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0390  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0391  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0392  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0393  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0394  70       TH Unused Date
     C                     MOVEL*BLANK    WN0395  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0396  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0397  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0398  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0399  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0400  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0401  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0402  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0403  6        DF Defect Code
     C                     MOVEL*BLANK    WN0404  6        THP Process Cod
     C                     MOVEL*BLANK    WN0405  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0406  6        PL Location Cod
     C                     MOVEL*BLANK    WN0407  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0408  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0409  3        HC Class Code
     C                     MOVEL*BLANK    WN0410 10        RS User Changed
     C                     Z-ADD*ZERO     WN0411  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0412  60       RS Time Changed
     C                     MOVEL*BLANK    WN0413  1        RS Record Statu
     C                     MOVEL*BLANK    WN0414 10        RS Job
     C                     MOVEL*BLANK    WN0415 10        RS Program
     C                     MOVEL*BLANK    WN0416 10        RS User Added
     C                     Z-ADD*ZERO     WN0417  70       RS Date Added
     C                     Z-ADD*ZERO     WN0418  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WRHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WRBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WRBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WRCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WRB0DT           TH Kill Date
      *
     C           KLCHSY    KLIST
     C                     KFLD           WRHMNB           BOH Company Num
     C                     KFLD           WRBNNB           BOH Buy Order N
     C                     KFLD           WRBONB           BOL Load Number
     C                     KFLD           WRCVNB           TH Tattoo Numbe
     C                     KFLD           WRB0DT           TH Kill Date
     C           KLCHSY    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWOB9PR    WRB9PR           TH Live Gross A
     C                     Z-ADDWOCAPR    WRCAPR           TH LIve Net Amt
     C                     Z-ADDP1AVPC    WRAVPC           TH Std Yield Pe
     C                     Z-ADDP1A8PC    WRA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WRB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WRAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WRANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WRAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WRAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WRAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WRAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WRAPPR           TH CM Carcass G
     C                     Z-ADDWOCBPR    WRCBPR           TH Payment Gros
     C                     Z-ADDWOCCPR    WRCCPR           Th Payment Net
     C                     Z-ADDWOLPNB    WRLPNB           TH AP Voucher/D
     C                     Z-ADDWOCDPR    WRCDPR           TH Freight Amou
     C                     Z-ADDP2A2PR    WRA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WRD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WRD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WRD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WRD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WREAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WREBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WRECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WREDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WREEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WREFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WREGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WREHPR           TH CM Gross Car
     C                     Z-ADDWOTAPR    WRTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WRTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WRKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WROTJG           TH Excluded Pre
     C                     Z-ADDP3OJRF    WROJRF           TH Break Even P
     C                     Z-ADDP2KFOR    WRKFOR           TH Meat Value F
     C                     Z-ADDP3NCHF    WRNCHF           TH MPR Sort Los
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Carc Summary Info CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0419  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0420 10        TH Group Refere
     C                     MOVEL*BLANK    WN0421  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0422  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0423  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0424  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0425  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0426  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0427  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0428  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0429  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0430  50       TH Held Over
     C                     Z-ADD*ZERO     WN0431  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0432  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0433  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0434  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0435  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0436  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0437  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0438  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0439  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0440  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0441  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0442  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0443  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0444  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0445  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0446  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0447  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0448  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0449  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0450  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0451  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0452  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0453  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0454  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0455  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0456  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0457  1        TH Header Error
     C                     MOVEL*BLANK    WN0458  1        TH Detail Error
     C                     MOVEL*BLANK    WN0459  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0460  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0461  80       TH Commission A
     C                     Z-ADD*ZERO     WN0462  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0463  1        TH User Error O
     C                     MOVEL*BLANK    WN0464  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0465  1        TH Sex
     C                     Z-ADD*ZERO     WN0466  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0467  70       TH Commission P
     C                     Z-ADD*ZERO     WN0468  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0469  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0470  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0471  31       TH FFLI
     C                     Z-ADD*ZERO     WN0472  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0473  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0474  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0475  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0476  1        TH Source Type
     C                     MOVEL*BLANK    WN0477  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0478  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0479  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0480  3        TH Source Code
     C                     MOVEL*BLANK    WN0481  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0482  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0483  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0484  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0485  3        TH State
     C                     MOVEL*BLANK    WN0486  3        TH Unused Code
     C                     MOVEL*BLANK    WN0487  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0488  1        TH Commission S
     C                     MOVEL*BLANK    WN0489  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0490  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0491  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0492  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0493  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0494  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0495  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0496  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0497  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0498  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0499  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0500  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0501  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0502  3        TH PHA Average
     C                     MOVEL*BLANK    WN0503  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0504  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0505  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0506  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0507  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0508  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0509  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0510  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0511  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0512 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0513 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0514  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0515  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0516  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0517  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0518  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0519  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0520  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0521  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0522  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0523  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0524  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0525  70       TH Unused Date
     C                     MOVEL*BLANK    WN0526  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0527  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0528  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0529  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0530  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0531  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0532  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0533  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0534  6        DF Defect Code
     C                     MOVEL*BLANK    WN0535  6        THP Process Cod
     C                     MOVEL*BLANK    WN0536  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0537  6        PL Location Cod
     C                     MOVEL*BLANK    WN0538  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0539  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0540  3        HC Class Code
     C                     MOVEL*BLANK    WN0541 10        RS User Changed
     C                     Z-ADD*ZERO     WN0542  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0543  60       RS Time Changed
     C                     MOVEL*BLANK    WN0544  1        RS Record Statu
     C                     MOVEL*BLANK    WN0545 10        RS Job
     C                     MOVEL*BLANK    WN0546 10        RS Program
     C                     MOVEL*BLANK    WN0547 10        RS User Added
     C                     Z-ADD*ZERO     WN0548  70       RS Date Added
     C                     Z-ADD*ZERO     WN0549  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WRHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WRBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WRBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WRCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WRB0DT           TH Kill Date
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WRHMNB           BOH Company Num
     C                     KFLD           WRBNNB           BOH Buy Order N
     C                     KFLD           WRBONB           BOL Load Number
     C                     KFLD           WRCVNB           TH Tattoo Numbe
     C                     KFLD           WRB0DT           TH Kill Date
     C           KLCHSZ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWOB9PR    WRB9PR           TH Live Gross A
     C                     Z-ADDWOCAPR    WRCAPR           TH LIve Net Amt
     C                     Z-ADDP1AVPC    WRAVPC           TH Std Yield Pe
     C                     Z-ADDP1A8PC    WRA8PC           TH Yield Differ
     C                     Z-ADDWOB8PR    WRB8PR           TH CM Market Pr
     C                     Z-ADDP1AMPR    WRAMPR           TH CM Base Mkt
     C                     Z-ADDP1ANPR    WRANPR           TH CM Base Mkt
     C                     Z-ADDP1AYVA    WRAYVA           TH CM Sort Disc
     C                     Z-ADDP1AWVA    WRAWVA           TH CM Yield Gai
     C                     Z-ADDP1AOPR    WRAOPR           TH CM Base Carc
     C                     Z-ADDP1AXVA    WRAXVA           TH CM LN AddOn/
     C                     Z-ADDP1APPR    WRAPPR           TH CM Carcass G
     C                     Z-ADDWOCBPR    WRCBPR           TH Payment Gros
     C                     Z-ADDWOCCPR    WRCCPR           Th Payment Net
     C                     Z-ADDWOLPNB    WRLPNB           TH AP Voucher/D
     C                     Z-ADDWOCDPR    WRCDPR           TH Freight Amou
     C                     Z-ADDP2A2PR    WRA2PR           TH Fixed Cost A
     C                     Z-ADDP3D6PR    WRD6PR           TH CM Bse Mkt L
     C                     Z-ADDP3D7PR    WRD7PR           TH CM Bse Mkt C
     C                     Z-ADDP3D8PR    WRD8PR           TH CM Srt Dsc L
     C                     Z-ADDP3D9PR    WRD9PR           TH CM Srt Dsc C
     C                     Z-ADDP3EAPR    WREAPR           TH CM Yld G/L L
     C                     Z-ADDP3EBPR    WREBPR           TH CM Yld G/L C
     C                     Z-ADDP3ECPR    WRECPR           TH CM Crc Val L
     C                     Z-ADDP3EDPR    WREDPR           TH CM Crc Val C
     C                     Z-ADDP3EEPR    WREEPR           TH CM Lean Prem
     C                     Z-ADDP3EFPR    WREFPR           TH CM Lean Prem
     C                     Z-ADDP3EGPR    WREGPR           TH CM Gross Liv
     C                     Z-ADDP3EHPR    WREHPR           TH CM Gross Car
     C                     Z-ADDP3TAPR    WRTAPR           TH VC Gross Val
     C                     Z-ADDP3TBPR    WRTBPR           TH Excluded Gro
     C                     Z-ADDP3KROT    WRKROT           TH Excluded Car
     C                     Z-ADDP3OTJG    WROTJG           TH Excluded Pre
     C                     Z-ADDP3OJRF    WROJRF           TH Break Even P
     C                     Z-ADDP2KFOR    WRKFOR           TH Meat Value F
     C                     Z-ADDP3NCHF    WRNCHF           TH MPR Sort Los
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WRAAVN           RS User Changed
     C                     Z-ADD##JDT     WRAADT           RS Date Changed
     C                     Z-ADD##JTM     WRAMTM           RS Time Changed
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Crt Competitors Tattoo CO - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DGCPTJ
     C                     MOVELP1AMCD    WSAMCD           CMP Program Cod
     C                     Z-ADDP1HMNB    WSHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WSBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WSCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WSB0DT           TH Kill Date
     C                     MOVEL'Y'       WSMHST           CCT Request for
     C                     Z-ADDP1AVPC    WSF4PC           CCT Std Yield
     C                     Z-ADDWUG5PR    WSG5PR           CCT Base /Live
     C                     Z-ADDWUJPPR    WSJPPR           CCT Base /Carc
     C                     Z-ADDWUG6PR    WSG6PR           CCT Lean Prem /
     C                     Z-ADDWUJQPR    WSJQPR           CCT Lean Prem /
     C                     Z-ADDWUG7PR    WSG7PR           CCT Yield G/L /
     C                     Z-ADDWUJRPR    WSJRPR           CCT Yield G/L /
     C                     Z-ADDWUJUPR    WSJUPR           CCT Carc Val /L
     C                     Z-ADDWUJVPR    WSJVPR           CCT Carc Val /C
     C                     Z-ADDWUG8PR    WSG8PR           CCT Sort Dsc /L
     C                     Z-ADDWUJSPR    WSJSPR           CCT Sort Dsc /C
     C                     Z-ADDWUG9PR    WSG9PR           CCT Gross /Live
     C                     Z-ADDWUJTPR    WSJTPR           CCT Gross /Carc
     C                     MOVEL*BLANK    WSAAVN           RS User Changed
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WSAJST           RS Record Statu
     C                     MOVEL##USR     WSABVN           RS User Added
     C                     Z-ADD##JDT     WSABDT           RS Date Added
     C                     Z-ADD##JTM     WSABTM           RS Time Added
     C                     MOVEL##PGM     WSAGVN           RS Program
     C                     MOVEL##JOB     WSAHVN           RS Job
     C           KLCRTA    KLIST
     C                     KFLD           WSAMCD           CMP Program Cod
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C                     KFLD           WSCVNB           TH Tattoo Numbe
     C                     KFLD           WSB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRTA    SETLL@DGCPTJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0571' W0RTN   7
      * Send message 'Competitors Tattoo     EX'
     C                     MOVEL'PRK0571' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@DGCPTJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Initialize Total Fields
      *================================================================
     C                     Z-ADD*ZERO     P2B5NB           Head Total USR
     C                     Z-ADD*ZERO     P2BMPR           Sort Loss Tot U
     C                     Z-ADD*ZERO     P2BNPR           Std Yield % Tot
     C                     Z-ADD*ZERO     P2H3NB           Weight Tot USR
     C                     Z-ADD*ZERO     P2B2PR           Base Carc Val T
     C                     Z-ADD*ZERO     P2BOPR           Adj Base Carc V
     C                     Z-ADD*ZERO     P2BPPR           Lean Percent To
     C                     Z-ADD*ZERO     P2BQPR           Lean Add/Ded Va
     C                     Z-ADD*ZERO     P2BRPR           Total Carc Val
     C                     Z-ADD*ZERO     P3NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     P2L8A1           Gross Before So
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * comments
      *================================================================
      * 12/15/06 PKD If Grading Type is Meat Value, then retrieve the
      *              USDA Pork Cutout Price for the Meav Value Factor.
      * 11/12/13 slm chnges per TF
      *              pull the mrk and the group from the Cmp mkt/grp
      *              need this for Triumph Foods  - Meat Value
      *              created nw file to hold this data
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * move db1 ca fields to par ca fields
      *================================================================
     C                     Z-ADDWAJWPR    WN0013           CD CA Sort Loss
     C                     Z-ADDWAF5PC    WN0014           CD CA Std Yield
     C                     Z-ADDWAJXPR    WN0015           CD CA Base Carc
     C                     Z-ADDWAJYPR    WN0016           CD CA Crc Value
     C                     Z-ADDWAJZPR    WN0017           CD CA Base Carc
     C                     Z-ADDWAJ0PR    WN0018           CD CA Crc Value
     C                     Z-ADDWAJ1PR    WN0019           CD CA Lean Prem
     C                     Z-ADDWAJ2PR    WN0020           CD CA Lean Prem
     C                     Z-ADDWAJ3PR    WN0021           CD CA Gross Val
     C                     Z-ADDWAJ4PR    WN0022           CD CA Gross Val
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * move db1 CD fields to par CD fields
      *================================================================
     C                     Z-ADDWABEPR    WN0001           CD Sort Loss
     C                     Z-ADDWN0043    WN0002           CD STD Yield
     C                     Z-ADDWAB4PR    WN0003           CD Base Carcass
     C                     Z-ADDWAEYNB    WN0004           CD Crc Value Pe
     C                     Z-ADDWAB1PR    WN0005           CD Base Carc Va
     C                     Z-ADDWAAVPR    WN0006           CD Crc Value $
     C                     Z-ADDWAAWPR    WN0008           CD Lean Premium
     C                     Z-ADDWAAXPR    WN0009           CD Lean Premium
     C                     Z-ADDWAEZNB    WN0010           CD Gross Value
     C                     Z-ADDWAAYPR    WN0011           CD Gross Value
     C                     Z-ADDWAIUTR    WN0029           CD Gross Before
     C                     Z-ADDWAIJRR    WN0030           CD Gross Before
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Move Averages to Cd fields before extension or totals are accum
      *================================================================
     C                     Z-ADDWUKWPR    WN0001           CD Sort Loss
     C                     Z-ADDWUF9PC    WN0002           CD STD Yield
     C                     Z-ADDWUKRPR    WN0003           CD Base Carcass
     C                     Z-ADDWUKUPR    WN0004           CD Crc Value Pe
     C                     Z-ADDWUKSPR    WN0008           CD Lean Premium
     C                     Z-ADDWUKXPR    WN0010           CD Gross Value
      * RE EXTENDED
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0003    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           CD Base Carc Va
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0004    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
      * CD LEAN PREM $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0008    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C           WN0006    ADD  WN0009    WN0011           CD Gross Value
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Carcass Analysis Detail
      *================================================================
      * Rtv StdYl/SrtDsc/MdPt RT - Carcass Merit Matrix Row  * 
     C                     EXSR SDRVGN
      * Commented out 12/16/98 PKD.
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0043    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0043    DIV  100       W0WD01    H      *Synon (17,7) w
     C           P1AMPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0003           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
     C                     Z-ADDP1AMPR    WN0003           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0003    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           CD Base Carc Va
      * Commented out 12/16/98 PKD.
      * CASE: WRK.CMP CLC Premium First is Sort First
     C           WUZ2ST    IFEQ *BLANK                     *IF
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0032    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           P1AMPR    ADD  WN0001    W0WA01           *Synon (15,2) w
     C           WN0043    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0043    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0001    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0003    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0032    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           P1SNST    IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0043    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0001    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           P1AMPR    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0043    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           P1SNST    IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0003    ADD  WN0001    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is % of Base Price
     C           WN0032    IFEQ 'P'                        *IF
      * 06/20/05 PKD HPE011 Add calculation for Sort Loss based on
      *              percent of base.
      * CD Crc Value Per CWT
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0001    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0003    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0007           *Synon (15,5) w
     C           YL0007    MULT 1         WN0004    H      CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0032    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0003    WN0004           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * A = TH CM Base Market Price or CD Base Carcass CWT
     C                     Z-ADDWN0003    WN0004           CD Crc Value Pe
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0004    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
      * 10/23/2007 CMP Grade Type Adj will be used on the Back Fat
      * Grade/Premium
      * CASE: PAR.CMP Grading Type is Ln%N/SrtDscF/FltCrc/MtVal
     C           WN0031    IFEQ 'C'                        *IF
     C           WN0031    OREQ 'D'
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'S'
     C           WN0031    OREQ 'M'
      * 06/20/05 PKD HPE011 Added Meat Value to Conditoin
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
     C                     EXSR UGSUBR                     LEAN PERCENT NP
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Percent FOM
     C           WN0031    IFEQ 'P'                        *IF
      * LEAN PERCENT  FAT O METER
     C                     EXSR UJSUBR                     LEAN PERCENT  F
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Backfat
     C           WN0031    IFEQ 'B'                        *IF
      * Backfat
     C                     EXSR UKSUBR                     Backfat
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Factor
     C           WN0031    IFEQ 'F'                        *IF
      * Lean Factor
     C                     EXSR ULSUBR                     Lean Factor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Sort after premium.  re-calc gross
      * CASE: WRK.CMP CLC Premium First is Premium First
     C           WUZ2ST    IFEQ 'P'                        *IF
     C                     Z-ADDWN0010    WN0029           CD Gross Before
     C                     Z-ADDWN0011    WN0030           CD Gross Before
      * CASE: PAR.CD Sort Loss is 100%
     C           WN0001    IFEQ 100                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * New Gross after Sort
      * Gross After Sort
      * LCL.*Synon (15,5) work field =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Before Sort CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0001    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0029    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0007           *Synon (15,5) w
     C           YL0007    MULT 1         WN0010    H      CD Gross Value
      * Total Gross Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
     C                     END                             *FI
      * New Carcas Value
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort CWT
     C           WN0010    SUB  WN0029    W0WA01           *Synon (15,2) w
     C           WN0003    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0004           CD Crc Value Pe
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 + (x2 - x3))
      * x1    : PAR.CD Base Carc Value
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Gross Before Sort /HD
     C           WN0011    SUB  WN0030    W0WA01           *Synon (15,2) w
     C           WN0005    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           CD Crc Value $
     C                     END                             *FI
     C                     Z-ADDWN0043    WN0002           CD STD Yield
      * Calc MPR Sort Loss            5/23/03    -- Change 10/11/17 S1186
      * Calc MPR Sort Loss   5/23/03   - chg 01/15/07 for "M" cmp grading
      * CASE: PAR.CMP Optimal Row Nbr f/srt NE WRK.Blank Usr 1 fld Usr
     C           WN0037    IFNE WUIXTX                     *IF
     C                     MOVE WN0037    YL0010           Num NU USR
     C                     Z-ADDYL0010    YL0008           CMMR Row Number
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SLRVGN
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR SMRVGN
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SNRVGN
     C           YL0014    SUB  YL0011    YL0015           Sort Total %
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0031    IFEQ 'D'                        *IF
      * If grading type is D , the lean premium values are dollars $
      * Comp: CD Mpr Sort Loss-D
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2) *(x3/x4))
      * x1    : LCL.CMMC Premium Value
      * -     : PGM.*Synon (17,7) work field
      * x2    : LCL.Optimal Lean Percent USR
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
     C           YL0014    SUB  YL0011    W0WD01           *Synon (17,7) w
     C           WAEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           CD MPR Sort Los
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * If grading type is M , take diff cac value $hd - base value   01/
     C           WN0006    SUB  WN0005    WN0026           CD MPR Sort Los
     C                     ELSE
      * CASE: *OTHERWISE
      * Original Calc done for all grading types         06/28/04
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 * x4)* (x2/x3))
      * x1    : LCL.Sort Total %
      * *     : PGM.*Synon (17,7) work field *
      * x4    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (17,7) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0015    MULT WN0003    W0WD01           *Synon (17,7) w
     C           WAEWNB    DIV  100       W0WD02           *Synon (17,7) w
     C           W0WD01    MULT W0WD02    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0026           CD MPR Sort Los
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WN0026    P3NCHF           TH MPR Sort Los
      * (note--sort loss s/be negative.)
     C                     ELSE
      * CASE: *OTHERWISE
      * Comp: CD Mpr Sort Loss
      * PAR.CD MPR Sort Loss =
      *    *COMPUTE ((x1 - x2))
      * x1    : PAR.CD Crc Value $ Per Hd
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Base Carc Value
     C           WN0006    SUB  WN0005    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0026           CD MPR Sort Los
     C                     ADD  WN0026    P3NCHF           TH MPR Sort Los
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * LEAN PERCENT NPPC or SORT DISCOUNT FACTOR or FLAT CARCASS WEIGHT
      *================================================================
      * 031606 slm added the meat value for TF Changes on Prd Avgs
      * CASE: Added Crc @ Historical Avg Hot wgt & avg Ln%
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.CD Adjust/Add Type is Producer Historical Avg
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   |- c4    : PAR.CMP Grading Type is Not Meat Value
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAUTST    IFEQ 'HST'                      *IF
     C           WAUTST    OREQ '2WK'
     C           WAUTST    OREQ '4WK'
     C           WAUTST    OREQ 'LOT'
     C           P5MGST    IFEQ 'N'                        *IF
     C           P6M6ST    IFEQ 'P'                        *IF
     C           WN0031    IFEQ 'B'                        *IF
     C           WN0031    OREQ 'C'
     C           WN0031    OREQ 'G'
     C           WN0031    OREQ 'F'
     C           WN0031    OREQ 'P'
     C           WN0031    OREQ 'D'
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** PAID WITH HISTORY **
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.CMP Grading Type is Lean Percent NPPC
      *   |- c2    : PAR.CMP Grading Type is Meat Value
      *   '-
     C           WN0031    IFEQ 'D'                        *IF
     C           WN0031    OREQ 'L'
     C           WN0031    OREQ 'M'                        *OR
      * 06/20/05 PKD HPE011 Added Meat Value to the condition.
     C                     Z-ADDP3S9PR    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01           *Synon (15,5) w
     C           WN0008    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
     C           WN0006    ADD  WN0009    WN0011           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Flat Carcass Weight
     C           WN0031    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C           WN0004    ADD  WN0008    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Sort Discount Factor
     C           WN0031    IFEQ 'S'                        *IF
      * **** Pay by Factory.  ****
     C           P3OMVJ    DIV  100       WN0048    H      CMMC Premium Va
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Paid with Average Value of Lot
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.CD Adjust/Add Type is Add w/Average Value
      *   |- c2    : PAR.Competitors Processing is No
      *   |- c3    : PAR.CM Processing Type Usr is Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAUTST    IFEQ 'ADD'                      *IF
     C           P5MGST    IFEQ 'N'                        *IF
     C           P6M6ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** ADDED AT AVERAGE VALUE OF THE LOT **
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
     C                     ELSE
      * CASE: *OTHERWISE
      * ** CALCULATE LEAN PREMIUM **
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SERVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * Lean Percent NPPC $Prem OR Meat Value *OTHERWISE
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC $Prem
     C           WN0031    IFEQ 'D'                        *IF
     C                     Z-ADDWN0048    WN0008           CD Lean Premium
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0008    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0006    ADD  WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0004    ADD  WN0008    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           CD Gross Value
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Meat Value
     C           WN0031    IFEQ 'M'                        *IF
      * Meat Value Calculation
     C                     EXSR UHSUBR                     Meat Value Calc
     C                     ELSE
      * CASE: *OTHERWISE
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Meat Value Calculation
      *================================================================
      * 06/20/05 PKD HPE011 Added Meat Value calculation
      * DOC:  Lean Premium Percent
     C                     EXSR UISUBR                     DOC:  Lean Prem
     C                     Z-ADD*ZERO     YL0008           CMMR Row Number
     C                     MOVE WN0037    YL0008           CMMR Row Number
      * Rtv Optimal Midpoint  RT - Carcass Merit Matrix Row  * 
     C                     EXSR SGRVGN
      * 08/23/05 PKD Checking Midpoint to make sure they are entered.
     C                     Z-ADDWN0048    WN0024           CD Lean Prem/Di
      * CD Lean Premium $ Per Hd
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x4/x5)) * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x4    : PAR.CD Lean Prem/Disc Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0024    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0003    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * CD Lean Premuim CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Lean Premium $ Per Hd
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0009    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * 12/15/06 PKD Below calculation uses the Base Price.
      * 12/15/06 PKD Use USDA Pork Cutout instead of the Base Price.
      *              USDA Pork Cutout = LCL.Market Prc Hog/Cutout USR
      *              pull the mrk and goup from the cmp market/group see
      * CD Fixed Cost Factor %
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.CMMR Midpoint is Entered
      *   |- c2    : PAR.CMMR Midpoint is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFGT 0                          *IF
     C           WN0046    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FIXED COST
      * CD Fixed Cost Factor %
      * PAR.CD Fixed Cost Factor % =
      *    *COMPUTE ((((x3/x4-x3/x5)/x6)*x9))
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : LCL.CMMR Midpoint
      * -     : PGM.*Synon (15,5) work field
      * x3    : PAR.CMP Fixed Cost Per Head
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : PAR.CMMR Midpoint
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : LCL.Market Prc Hog/Cutout USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x9    : CON.100
     C           WN0040    DIV  YL0009    W0WB03    H      *Synon (15,5) w
     C           WN0040    DIV  WN0046    W0WB04    H      *Synon (15,5) w
     C           W0WB03    SUB  W0WB04    W0WB02           *Synon (15,5) w
     C           W0WB02    DIV  YL0006    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0025           CD Fixed Cost F
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0025           CD Fixed Cost F
     C                     END                             *FI
      * CD Fixed Cost Factor Amt
      * PAR.CD Fixed Cost Factor Amt =
      *    *COMPUTE (x1 * ((x2/x3) * (x5/x6)))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Fixed Cost Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0025    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB03    W0WB01    H      *Synon (15,5) w
     C           WN0003    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0028           CD Fixed Cost F
      * CD Meat Value Factor %
      * PAR.CD Meat Value Factor % =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.CD Sort Loss
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Fixed Cost Factor %
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.CD Lean Prem/Disc Factor
     C           WN0001    ADD  WN0025    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WN0024    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0023           CD Meat Value F
      * CD Meat Value Factor Amt
      * PAR.CD Meat Value Factor Amt =
      *    *COMPUTE ((x1 * ((x2/x7) - x4) * (x5 / x6)) * x8)
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x7    : CON.100
      * -     : PGM.*Synon (15,5) work field
      * x4    : CON.1
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x8    : CON.1
     C           WN0023    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WB04    SUB  1         W0WB03           *Synon (15,5) w
     C           WN0003    MULT W0WB03    W0WB02    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB05    H      *Synon (15,5) w
     C           W0WB02    MULT W0WB05    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 1         W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0027           CD Meat Value F
      * CD Gross Value $ Per HD
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE ((x1 * (x2 / x3)) * (x4 / x5))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.CD Meat Value Factor %
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x5    : CON.100
     C           WN0023    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WN0003    MULT W0WB02    W0WB01    H      *Synon (15,5) w
     C           WAEWNB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB01    MULT W0WB03    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * CD Gross Value Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.CD Gross Value $ Per HD
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0011    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * ****************
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * DOC:  Lean Premium Percent
      *================================================================
      * Lean Prem% = ((A * (B/100)) + (((C/D) - (C/E)) / F) + (G/100))
      * WHERE:
      * A = Starting Point (100)
      * B = Sort Loss Percent
      * C = Fixed Cost Per Head
      * D = Optimal Weight Range Midpoint
      * E = Weight Range Midpoint
      * F = Base Market Price
      * G = Lean Premium & Discount Percent
      * 12/15/06 PKD Current:  F=Base Market Price
      *                  New:  F=USDA Pork Cutout
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * LEAN PERCENT  FAT O METER
      *================================================================
      * ---------------------------------------------------------------
      * Added 6/11/99 by Purva for C0007557.
      * Add Lean Factor/Lean % +/- to Lean Percent MM
      * CASE: PAR.CMP Lean Factor is Greater than 0
     C           WN0036    IFGT 0                          *IF
     C           WAFPPC    ADD  WN0036    WN0047           CMMC Lean Perce
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAFPPC    WN0047           CMMC Lean Perce
     C                     END                             *FI
      * ---------------------------------------------------------------
     C                     Z-ADD*ZERO     WN0048           CMMC Premium Va
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SHRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * Add the meat premium
      * Total Carcass Per CWT add
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMMC Premium Value
     C           WN0004    ADD  WN0048    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Backfat
      *================================================================
      * 10/23/2007 * out the hard code CMP Grade Type Adj
      *              and replace with value form the CMP Grade Backfat
     C           WAH6NB    ADD  WN0041    WUVENB           Backfat USR
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
     C                     EXSR SJRVGN
      * Rtv Bckf Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      * *---------------------------------------------------------------*
      * * 05/15/02 PKD Commented out.  The Backfat calculation needs
      *                to work similar to Lean Percent.
      * Lean Premium Value
      * Lean Premium Per Cwt
      * Gross Value Per cwt
      * Gross Value $
      * *---------------------------------------------------------------*
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0004    MULT WN0048    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0010    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0010    SUB  WN0004    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           WN0011    SUB  WN0006    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Lean Factor
      *================================================================
      * Diff actual/Std Lean%
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 - x2) / x3)
      * x1    : DB1.CD Lean Percent
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMP Std Lean Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WAAUPC    SUB  WN0035    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0048           CMMC Premium Va
      * multiple by lean factor
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : PAR.CMMC Premium Value
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.CMP Lean Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0048    MULT WN0036    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0048           CMMC Premium Va
      * Lean Premium Per Cwt
     C           WN0048    MULT P1AMPR    WN0008    H      CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WAEWNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0008    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0009           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0004    ADD  WN0008    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0010           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0006    ADD  WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           CD Gross Value
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Totals
      *================================================================
     C                     ADD  1         P2B5NB           Head Total USR
     C                     ADD  WN0001    P2BMPR           Sort Loss Tot U
     C                     ADD  WN0002    P2BNPR           Std Yield % Tot
     C                     ADD  WAEWNB    P2H3NB           Weight Tot USR
     C                     ADD  WN0005    P2B2PR           Base Carc Val T
     C                     ADD  WN0006    P2BOPR           Adj Base Carc V
     C                     ADD  WAAUPC    P2BPPR           Lean Percent To
     C                     ADD  WN0009    P2BQPR           Lean Add/Ded Va
     C                     ADD  WN0011    P2BRPR           Total Carc Val
     C                     ADD  WN0027    P2KFOR           TH Meat Value F
     C                     ADD  WN0028    P2A2PR           TH Fixed Cost A
     C                     ADD  WN0030    P2L8A1           Gross Before So
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0013           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022           CD CA Gross Val
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0001    WN0013           CD CA Sort Loss
     C                     Z-ADDWN0002    WN0014           CD CA Std Yield
     C                     Z-ADDWN0003    WN0015           CD CA Base Carc
     C                     Z-ADDWN0004    WN0016           CD CA Crc Value
     C                     Z-ADDWN0005    WN0017           CD CA Base Carc
     C                     Z-ADDWN0006    WN0018           CD CA Crc Value
     C                     Z-ADDWN0008    WN0019           CD CA Lean Prem
     C                     Z-ADDWN0009    WN0020           CD CA Lean Prem
     C                     Z-ADDWN0010    WN0021           CD CA Gross Val
     C                     Z-ADDWN0011    WN0022           CD CA Gross Val
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     Z-ADD*ZERO     WN0002           CD STD Yield
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     Z-ADD*ZERO     WN0004           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006           CD Crc Value $
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0013           CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0014           CD CA Std Yield
     C                     Z-ADD*ZERO     WN0015           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0016           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0017           CD CA Base Carc
     C                     Z-ADD*ZERO     WN0018           CD CA Crc Value
     C                     Z-ADD*ZERO     WN0019           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0020           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0021           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0022           CD CA Gross Val
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0001    WN0013           CD CA Sort Loss
     C                     Z-ADDWN0002    WN0014           CD CA Std Yield
     C                     Z-ADDWN0003    WN0015           CD CA Base Carc
     C                     Z-ADDWN0004    WN0016           CD CA Crc Value
     C                     Z-ADDWN0005    WN0017           CD CA Base Carc
     C                     Z-ADDWN0006    WN0018           CD CA Crc Value
     C                     Z-ADDWN0008    WN0019           CD CA Lean Prem
     C                     Z-ADDWN0009    WN0020           CD CA Lean Prem
     C                     Z-ADDWN0010    WN0021           CD CA Gross Val
     C                     Z-ADDWN0011    WN0022           CD CA Gross Val
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0001           CD Sort Loss
     C                     Z-ADD*ZERO     WN0002           CD STD Yield
     C                     Z-ADD*ZERO     WN0003           CD Base Carcass
     C                     Z-ADD*ZERO     WN0004           CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005           CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006           CD Crc Value $
     C                     Z-ADD*ZERO     WN0008           CD Lean Premium
     C                     Z-ADD*ZERO     WN0009           CD Lean Premium
     C                     Z-ADD*ZERO     WN0010           CD Gross Value
     C                     Z-ADD*ZERO     WN0011           CD Gross Value
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * 7/15/2009 slm if the std Yield is blank
      * On the added records then populate theStd Yield from the CMP
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Totals
      *================================================================
     C                     ADD  1         P2B5NB           Head Total USR
     C                     ADD  WN0081    P2BMPR           Sort Loss Tot U
     C                     ADD  WN0082    P2BNPR           Std Yield % Tot
     C                     ADD  WLEWNB    P2H3NB           Weight Tot USR
     C                     ADD  WN0085    P2B2PR           Base Carc Val T
     C                     ADD  WN0086    P2BOPR           Adj Base Carc V
     C                     ADD  WLAUPC    P2BPPR           Lean Percent To
     C                     ADD  WN0089    P2BQPR           Lean Add/Ded Va
     C                     ADD  WN0091    P2BRPR           Total Carc Val
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0088    WN0099           CD CA Lean Prem
     C                     Z-ADDWN0089    WN0100           CD CA Lean Prem
     C                     Z-ADDWN0090    WN0101           CD CA Gross Val
     C                     Z-ADDWN0091    WN0102           CD CA Gross Val
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0088           CD Lean Premium
     C                     Z-ADD*ZERO     WN0089           CD Lean Premium
     C                     Z-ADD*ZERO     WN0090           CD Gross Value
     C                     Z-ADD*ZERO     WN0091           CD Gross Value
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * zero out cd ca fields
      *================================================================
     C                     Z-ADD*ZERO     WN0099           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0100           CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0101           CD CA Gross Val
     C                     Z-ADD*ZERO     WN0102           CD CA Gross Val
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * move cd fields to cd ca fields
      *================================================================
     C                     Z-ADDWN0088    WN0099           CD CA Lean Prem
     C                     Z-ADDWN0089    WN0100           CD CA Lean Prem
     C                     Z-ADDWN0090    WN0101           CD CA Gross Val
     C                     Z-ADDWN0091    WN0102           CD CA Gross Val
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * zero out cd fields
      *================================================================
     C                     Z-ADD*ZERO     WN0088           CD Lean Premium
     C                     Z-ADD*ZERO     WN0089           CD Lean Premium
     C                     Z-ADD*ZERO     WN0090           CD Gross Value
     C                     Z-ADD*ZERO     WN0091           CD Gross Value
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     P1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     P1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     P1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     P1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     P1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     P1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     P1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     P1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     P1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     P1A9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     P2B5NB           Head Total USR
     C                     Z-ADD*ZERO     P2BMPR           Sort Loss Tot U
     C                     Z-ADD*ZERO     P2BNPR           Std Yield % Tot
     C                     Z-ADD*ZERO     P2H3NB           Weight Tot USR
     C                     Z-ADD*ZERO     P2BOPR           Adj Base Carc V
     C                     Z-ADD*ZERO     P2BPPR           Lean Percent To
     C                     Z-ADD*ZERO     P2BQPR           Lean Add/Ded Va
     C                     Z-ADD*ZERO     P2BRPR           Total Carc Val
     C                     Z-ADD*ZERO     P2B2PR           Base Carc Val T
     C                     Z-ADD*ZERO     P2KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     P2A2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     P2L8A1           Gross Before So
     C                     Z-ADD*ZERO     P3D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     P3D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     P3D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     P3D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     P3EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     P3EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     P3ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     P3EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     P3EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P3EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     P3EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     P3EHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     P3TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     P3KROT           TH Excluded Car
     C                     Z-ADD*ZERO     P3OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     P3OJRF           TH Break Even P
     C                     Z-ADD*ZERO     P3NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     P4BSPR           Adj Base Carc P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Average Pay Sts Usr
     C                     MOVEL*BLANK    WUM7ST  1
      * Define work field Cmp Base Carc
     C                     Z-ADD*ZERO     WUKRPR  62
      * Define work field Cmp Lean Premium Carc
     C                     Z-ADD*ZERO     WUKSPR  62
      * Define work field Cmp Yield Gain/Loss Carc
     C                     Z-ADD*ZERO     WUKTPR  62
      * Define work field Cmp Carc Val Carc
     C                     Z-ADD*ZERO     WUKUPR  52
      * Define work field Cmp Sort Dsc Carc
     C                     Z-ADD*ZERO     WUKWPR  62
      * Define work field Cmp Std Yield
     C                     Z-ADD*ZERO     WUF9PC  52
      * Define work field Cmp Base Mkt Price
     C                     Z-ADD*ZERO     WUKYPR  52
      * Define work field Cmp Base Live
     C                     Z-ADD*ZERO     WUHDPR  62
      * Define work field Cmp Lean Premium Live
     C                     Z-ADD*ZERO     WUHEPR  62
      * Define work field Cmp Yield Gain/Loss Live
     C                     Z-ADD*ZERO     WUHFPR  62
      * Define work field Cmp Carc Val Live
     C                     Z-ADD*ZERO     WUKVPR  52
      * Define work field Cmp Sort Dsc Live
     C                     Z-ADD*ZERO     WUHGPR  62
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field #Txt USR
     C                     MOVEL*BLANK    WUC6TX 80
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Define work field CMP CLC Premium First
     C                     MOVEL*BLANK    WUZ2ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WBA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WBI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WBVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WBVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WBVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WBVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WBVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCGYDT           CMP Effect Purc
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Define work field OMS Error Return Usr
     C                     MOVEL*BLANK    WUIPTX  5
      * Define work field Cmp Gross Carc
     C                     Z-ADD*ZERO     WUKXPR  62
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WDEGNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEHNB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEINB           CMMR Carc Wgt M
     C                     Z-ADD*ZERO     WDEJNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WDEKNB           CMMR Live Wgt M
     C                     Z-ADD*ZERO     WDAQPC           CMMR Std Dressi
     C                     Z-ADD*ZERO     WDEMNB           CMMR Sort Disco
     C                     Z-ADD*ZERO     WDE2NB           CMMR Unused Fie
     C                     Z-ADD*ZERO     WDLJA1           CMMR Midpoint
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Record Found CMMC USR
     C                     MOVEL*BLANK    WUF6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WEE4NB           CMMC Column Num
     C                     Z-ADD*ZERO     WEA1PC           CMMC Lean Perce
     C                     Z-ADD*ZERO     WEE7NB           CMMC Backfat In
     C                     Z-ADD*ZERO     WEERNB           CMMC Premium Va
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Backfat USR
     C                     Z-ADD*ZERO     WUVENB  31
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAHDT           PSC Date
     C                     Z-ADD*ZERO     WMAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WMA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WMA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WMA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WMA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WMA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WMF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WOBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WOBONB           BOL Load Number
     C                     Z-ADD*ZERO     WOCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WOB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WOAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WOACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WOB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WOCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WOAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WOA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WOCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WOCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WOFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WOH9NB           TH Held Over
     C                     Z-ADD*ZERO     WOFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WOFENB           TH Head Killed
     C                     Z-ADD*ZERO     WOHENB           TH Head Adds
     C                     Z-ADD*ZERO     WOHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WOCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WOLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WOE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WOA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WOFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WOA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WOF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WOHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WOF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WOF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WOF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WOF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WOAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WOAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WOCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WOA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WOA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WOB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WOAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WOANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WOAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WOAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WOAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WOAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WOAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WOASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WOA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WOATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WOA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WOCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WOCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WOLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WOCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WOA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WOA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WOGHNB           TH Commission A
     C                     Z-ADD*ZERO     WOBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WOBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WOBTDT           TH Commission P
     C                     Z-ADD*ZERO     WOBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WOHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WOHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WOHINB           TH FFLI
     C                     Z-ADD*ZERO     WOA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WOA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WOA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WOJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WOD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WOD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WOD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WOD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WOEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WOEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WOECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WOEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WOEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WOEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WOEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WOEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WOOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WOTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WOT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WOTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WOT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WOOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WOKOER           TH Head Identif
     C                     Z-ADD*ZERO     WOOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WOOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WOIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WOOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WOHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WOS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WOTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WOTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WOJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WOKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WOKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WOKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WOKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WOOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WOIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WOIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WOIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WOKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WOOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WOKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WOORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WOOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WOMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WOMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WONCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WONCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WOIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WOKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WOEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WOEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WOECDT           TH Head LFT
     C                     Z-ADD*ZERO     WOEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WOEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Define work field Create Ext file Usr
     C                     MOVEL*BLANK    WUM8ST  1
      * Define work field TH CA Market Price
     C                     Z-ADD*ZERO     WUI5PR  52
      * Define work field TH CA Base Market Price
     C                     Z-ADD*ZERO     WUJBPR  72
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Define work field TH CA Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     WUJDPR  52
      * Define work field TH CA Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     WUJEPR  52
      * Define work field TH CA Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     WUJFPR  52
      * Define work field TH CA Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     WUJGPR  52
      * Define work field TH CA Yld G/L Live /CWT
     C                     Z-ADD*ZERO     WUJHPR  52
      * Define work field TH CA Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     WUJIPR  52
      * Define work field TH CA Crc Val Live /CWT
     C                     Z-ADD*ZERO     WUJJPR  52
      * Define work field TH CA Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUJKPR  52
      * Define work field TH CA Lean Prm Live /CWT
     C                     Z-ADD*ZERO     WUJLPR  52
      * Define work field TH CA Lean Prm Carc /CWT
     C                     Z-ADD*ZERO     WUJMPR  52
      * Define work field TH CA Gross Live /CWT
     C                     Z-ADD*ZERO     WUJNPR  52
      * Define work field TH CA Gross Carc /CWT
     C                     Z-ADD*ZERO     WUJOPR  52
      * Define work field CCT Base /Live CWT
     C                     Z-ADD*ZERO     WUG5PR  52
      * Define work field CCT Lean Prem /Live CWT
     C                     Z-ADD*ZERO     WUG6PR  52
      * Define work field CCT Yield G/L /Live CWT
     C                     Z-ADD*ZERO     WUG7PR  52
      * Define work field CCT Sort Dsc /Live CWT
     C                     Z-ADD*ZERO     WUG8PR  52
      * Define work field CCT Gross /Live CWT
     C                     Z-ADD*ZERO     WUG9PR  52
      * Define work field CCT Carc Val /Live CWT
     C                     Z-ADD*ZERO     WUJUPR  52
      * Define work field CCT Base /Carc CWT
     C                     Z-ADD*ZERO     WUJPPR  52
      * Define work field CCT Lean Prem /Carc CWT
     C                     Z-ADD*ZERO     WUJQPR  52
      * Define work field CCT Yield G/L /Carc CWT
     C                     Z-ADD*ZERO     WUJRPR  52
      * Define work field CCT Sort Dsc /Carc CWT
     C                     Z-ADD*ZERO     WUJSPR  52
      * Define work field CCT Gross /Carc CWT
     C                     Z-ADD*ZERO     WUJTPR  52
      * Define work field CCT Carc Val /Carc CWT
     C                     Z-ADD*ZERO     WUJVPR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WSBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WSBONB           BOL Load Number
     C                     Z-ADD*ZERO     WSCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WSB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WSF4PC           CCT Std Yield
     C                     Z-ADD*ZERO     WSG5PR           CCT Base /Live
     C                     Z-ADD*ZERO     WSJPPR           CCT Base /Carc
     C                     Z-ADD*ZERO     WSG6PR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WSJQPR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WSG7PR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WSJRPR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WSJUPR           CCT Carc Val /L
     C                     Z-ADD*ZERO     WSJVPR           CCT Carc Val /C
     C                     Z-ADD*ZERO     WSG8PR           CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WSJSPR           CCT Sort Dsc /C
     C                     Z-ADD*ZERO     WSG9PR           CCT Gross /Live
     C                     Z-ADD*ZERO     WSJTPR           CCT Gross /Carc
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB05 155       *Synon (15,5) w
     C                     MOVEL'N'       W0PMT   1
      * Define local work field CMP Effect Purchase Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field CMP Commodity Market
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field CMP Commodity Group
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field OMS Market Price Amt Usr
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Market Prc Hog/Cutout USR
     C                     Z-ADD*ZERO     YL0006  52
      * Define local work field *Synon (15,5) work field
     C                     Z-ADD*ZERO     YL0007 155
      * Define local work field CMMR Row Number
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field CMMR Midpoint
     C                     Z-ADD*ZERO     YL0009  52
      * Define local work field Num NU USR
     C                     Z-ADD*ZERO     YL0010  10
      * Define local work field Optimal Lean Percent USR
     C                     Z-ADD*ZERO     YL0011  53
      * Define local work field CMMR Std Dressing Yield%
     C                     Z-ADD*ZERO     YL0012  52
      * Define local work field CD Sort Loss
     C                     Z-ADD*ZERO     YL0013  72
      * Define local work field CMMC Premium Value
     C                     Z-ADD*ZERO     YL0014  53
      * Define local work field Sort Total %
     C                     Z-ADD*ZERO     YL0015  74
      * Define null work field CMMR Row Number
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field CMMR Std Dressing Yield%
     C                     Z-ADD*ZERO     YL0016  52
      * Define null work field CMMR Midpoint
     C                     Z-ADD*ZERO     YN0002  52
      * Define null work field CD Sort Loss
     C                     Z-ADD*ZERO     YN0003  72
      * Define local work field CD STD Yield
     C                     Z-ADD*ZERO     YL0017  52
      * Define null work field CMP Description
     C                     MOVEL*BLANK    YN0004 25
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0018  1
      * Define null work field CMP Sort Basis
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     YN0007  31
      * Define null work field CMP Lean Factor
     C                     Z-ADD*ZERO     YN0008  31
      * Define null work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field CMP Type
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     YN0011  52
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     YN0013  30
      * Define local work field PSC Break Even Percent
     C                     Z-ADD*ZERO     YL0019  52
      * Define null work field PSC Mkt Percent
     C                     Z-ADD*ZERO     YN0014  52
      *================================================================
     CSR         ZZEXIT    ENDSR
