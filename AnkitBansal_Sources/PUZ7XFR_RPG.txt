     H/TITLE Crt Block Order Qtemp XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 05/06/24  Time  : 09:42:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAADREL3  IF   E           K DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOPBGWKL0  IF A E           K DISK
      * UPD : Order Detail              Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOPBG1        E DS                  EXTNAME(OPBGWKL0)
      * UPD : Order Detail              Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(OMAIC3)
     D  WAC4NB       E                     EXTFLD(OMC4NB)
     D  WADPNB       E                     EXTFLD(OMDPNB)
     D  WAUENB       E                     EXTFLD(OMUENB)
     D  WAHGCD       E                     EXTFLD(OMHGCD)
     D  WAAJCD       E                     EXTFLD(OMAJCD)
     D  WABKC7       E                     EXTFLD(OMBKC7)
     D  WACFC7       E                     EXTFLD(OMCFC7)
     D  WAGMST       E                     EXTFLD(OMGMST)
     D  WAGNST       E                     EXTFLD(OMGNST)
     D  WAMAVA       E                     EXTFLD(OMMAVA)
     D  WAKDVA       E                     EXTFLD(OMKDVA)
     D  WAL8VA       E                     EXTFLD(OML8VA)
     D  WAL9VA       E                     EXTFLD(OML9VA)
     D  WAGTST       E                     EXTFLD(OMGTST)
     D  WAGVST       E                     EXTFLD(OMGVST)
     D  WAGUST       E                     EXTFLD(OMGUST)
     D  WAQFST       E                     EXTFLD(OMQFST)
     D  WAAYVA       E                     EXTFLD(OMAYVA)
     D  WAEXDT       E                     EXTFLD(OMEXDT)
     D  WALQCD       E                     EXTFLD(OMLQCD)
     D  WARDCD       E                     EXTFLD(OMRDCD)
     D  WAQ7CD       E                     EXTFLD(OMQ7CD)
     D  WABZPR       E                     EXTFLD(OMBZPR)
     D  WAL6NB       E                     EXTFLD(OML6NB)
     D  WAU1ST       E                     EXTFLD(OMU1ST)
     D  WAGIDT       E                     EXTFLD(OMGIDT)
     D  WACRCD       E                     EXTFLD(OMCRCD)
     D  WAAGCD       E                     EXTFLD(OMAGCD)
     D  WARZST       E                     EXTFLD(OMRZST)
     D  WAR0ST       E                     EXTFLD(OMR0ST)
     D  WAR1ST       E                     EXTFLD(OMR1ST)
     D  WAG7NA       E                     EXTFLD(OMG7NA)
     D  WAG8NA       E                     EXTFLD(OMG8NA)
     D  WARPCD       E                     EXTFLD(OMRPCD)
     D  WAVEST       E                     EXTFLD(OMVEST)
     D  WAVGST       E                     EXTFLD(OMVGST)
     D  WAAVST       E                     EXTFLD(OMAVST)
     D  WAU0ST       E                     EXTFLD(OMU0ST)
     D  WARFCD       E                     EXTFLD(OMRFCD)
     D  WAFZST       E                     EXTFLD(OMFZST)
     D  WAR1NB       E                     EXTFLD(OMR1NB)
     D  WAAVQT       E                     EXTFLD(OMAVQT)
     D  WAD0WG       E                     EXTFLD(OMD0WG)
     D  WACCQT       E                     EXTFLD(OMCCQT)
     D  WAAUWG       E                     EXTFLD(OMAUWG)
     D  WACBQT       E                     EXTFLD(OMCBQT)
     D  WAATWG       E                     EXTFLD(OMATWG)
     D  WAAQCS       E                     EXTFLD(OMAQCS)
     D  WAAGCS       E                     EXTFLD(OMAGCS)
     D  WAAKPR       E                     EXTFLD(OMAKPR)
     D  WAALPR       E                     EXTFLD(OMALPR)
     D  WAAUPR       E                     EXTFLD(OMAUPR)
     D  WAAVWG       E                     EXTFLD(OMAVWG)
     D  WAA4WG       E                     EXTFLD(OMA4WG)
     D  WAA5DT       E                     EXTFLD(OMA5DT)
     D  WAAODT       E                     EXTFLD(OMAODT)
     D  WAGNDT       E                     EXTFLD(OMGNDT)
     D  WAAMST       E                     EXTFLD(OMAMST)
     D  WAANST       E                     EXTFLD(OMANST)
     D  WAVAST       E                     EXTFLD(OMVAST)
     D  WARGNB       E                     EXTFLD(OMRGNB)
     D  WARHNB       E                     EXTFLD(OMRHNB)
     D  WARINB       E                     EXTFLD(OMRINB)
     D  WARBCD       E                     EXTFLD(OMRBCD)
     D  WAHICD       E                     EXTFLD(OMHICD)
     D  WARNCD       E                     EXTFLD(OMRNCD)
     D  WAROCD       E                     EXTFLD(OMROCD)
     D  WACXDT       E                     EXTFLD(OMCXDT)
     D  WAAJVN       E                     EXTFLD(OMAJVN)
     D  WAKXCD       E                     EXTFLD(OMKXCD)
     D  WAJPCD       E                     EXTFLD(OMJPCD)
     D  WACQCD       E                     EXTFLD(OMCQCD)
     D  WAR4CD       E                     EXTFLD(OMR4CD)
     D  WAZ1ST       E                     EXTFLD(OMZ1ST)
     D  WAZ3ST       E                     EXTFLD(OMZ3ST)
     D  WAZ4ST       E                     EXTFLD(OMZ4ST)
     D  WADUPR       E                     EXTFLD(OMDUPR)
     D  WAB6VL       E                     EXTFLD(OMB6VL)
     D  WAA1AA       E                     EXTFLD(OMA1AA)
     D  WAFZSX       E                     EXTFLD(OMFZSX)
     D  WAF0SX       E                     EXTFLD(OMF0SX)
     D  WAF1SX       E                     EXTFLD(OMF1SX)
     D  WAF2SX       E                     EXTFLD(OMF2SX)
     D  WAF3SX       E                     EXTFLD(OMF3SX)
     D  WAF4SX       E                     EXTFLD(OMF4SX)
     D  WAF5SX       E                     EXTFLD(OMF5SX)
     D  WAF6SX       E                     EXTFLD(OMF6SX)
     D  WAF7SX       E                     EXTFLD(OMF7SX)
     D  WANTDT       E                     EXTFLD(OMNTDT)
     D  WANUDT       E                     EXTFLD(OMNUDT)
     D  WANVDT       E                     EXTFLD(OMNVDT)
     D  WANWDT       E                     EXTFLD(OMNWDT)
     D  WANXDT       E                     EXTFLD(OMNXDT)
     D  WABUTM       E                     EXTFLD(OMBUTM)
     D  WABVTM       E                     EXTFLD(OMBVTM)
     D  WABWTM       E                     EXTFLD(OMBWTM)
     D  WABXTM       E                     EXTFLD(OMBXTM)
     D  WABYTM       E                     EXTFLD(OMBYTM)
     D  WAH5NX       E                     EXTFLD(OMH5NX)
     D  WAH6NX       E                     EXTFLD(OMH6NX)
     D  WAH7NX       E                     EXTFLD(OMH7NX)
     D  WAH8NX       E                     EXTFLD(OMH8NX)
     D  WAH9NX       E                     EXTFLD(OMH9NX)
     D  WADVPR       E                     EXTFLD(OMDVPR)
     D  WADWPR       E                     EXTFLD(OMDWPR)
     D  WADXPR       E                     EXTFLD(OMDXPR)
     D  WADYPR       E                     EXTFLD(OMDYPR)
     D  WADZPR       E                     EXTFLD(OMDZPR)
     D  WAGSPR       E                     EXTFLD(OMGSPR)
     D  WAGTPR       E                     EXTFLD(OMGTPR)
     D  WAGUPR       E                     EXTFLD(OMGUPR)
     D  WAHOST       E                     EXTFLD(OMHOST)
     D  WAHPST       E                     EXTFLD(OMHPST)
     D  WAIOST       E                     EXTFLD(OMIOST)
     D  WAPEWG       E                     EXTFLD(OMPEWG)
     D  WARINY       E                     EXTFLD(OMRINY)
     D  WATIDT       E                     EXTFLD(OMTIDT)
     D  WATJDT       E                     EXTFLD(OMTJDT)
     D  WAH2ST       E                     EXTFLD(OMH2ST)
     D  WAH0ST       E                     EXTFLD(OMH0ST)
     D  WAH1ST       E                     EXTFLD(OMH1ST)
     D  WATKDT       E                     EXTFLD(OMTKDT)
     D  WATLDT       E                     EXTFLD(OMTLDT)
     D  WATMDT       E                     EXTFLD(OMTMDT)
     D  WAUVST       E                     EXTFLD(OMUVST)
     D  WAUWST       E                     EXTFLD(OMUWST)
     D  WAUXST       E                     EXTFLD(OMUXST)
     D  WAAATM       E                     EXTFLD(OMAATM)
     D  WAAYNA       E                     EXTFLD(OMAYNA)
     D  WAA0NA       E                     EXTFLD(OMA0NA)
     D  WAAXDT       E                     EXTFLD(OMAXDT)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WN0001         S              6  0
     D  WN0002         S             10
     D  WN0003         S             10
     D  WN0004         S              7  0
     D  YL0001         S              5  2
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              5  2
     D  W0CLPG         S             10
     D  YL0002         S              5  2
     D  YL0003         S              5  0
     D  YL0004         S              5  2
     D  YL0005         S              7  0
     D  WQ0004         S              3  0
     D  WQ0005         S              7  0
     D  WQ0006         S              5  2
     D  WQ0007         S              5  0
     D  WQ0008         S              5  2
     D  WQ0009         S              7  0
     D  WQ0010         S              2
     D  YL0006         S              5  2
     D  YL0007         S              9  2
     D  YL0008         S              9  2
     D  WQ0011         S              3  0
     D  WQ0012         S              7  0
     D  WQ0013         S              7  0
     D  YN0001         S              3  0
     D  ZADFMF         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0WA01         S             15  2
     D  W0WA00         S             15  2
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           525
      * RCD: Order Detail              Update index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Order Sequence Number
     D  P1DPNB                 7      8P 0
      * I :  Order Secondary Line Seq
     D  P1UENB                 9     10P 0
      * I :  Item Code
     D  P1HGCD                11     14P 0
      * I :  Warehouse Code
     D  P1AJCD                15     17
      * I :  Ship To Customer
     D  P1BKC7                18     21P 0
      * I :  Order Group Code
     D  P1CFC7                22     25P 0
      * I :  Detail Line Status
     D  P1GMST                26     26
      * I :  Detail Line Status Last
     D  P1GNST                27     27
      * I :  Billing Detail Cost Dol
     D  P1MAVA                28     33P 2
      * I :  Billing Detail Gross Dol
     D  P1KDVA                34     39P 2
      * I :  Billing Detail Net Dol
     D  P1L8VA                40     45P 2
      * I :  Quantity to Substitute
     D  P1L9VA                46     51P 2
      * I :  Comment Print Acknowledge
     D  P1GTST                52     52
      * I :  Comment Print Inv_Cr_Memo
     D  P1GVST                53     53
      * I :  Comment Print Pick Slip
     D  P1GUST                54     54
      * I :  Comment Print Ship Doc
     D  P1QFST                55     55
      * I :  Extended Amount
     D  P1AYVA                56     61P 2
      * I :  Market Pricing Date
     D  P1EXDT                62     65P 0
      * I :  Commodity Market Code
     D  P1LQCD                66     68
      * I :  Date Method Code
     D  P1RDCD                69     71
      * I :  Price Method Code
     D  P1Q7CD                72     74
      * I :  Price Overage Override
     D  P1BZPR                75     80P 4
      * I :  Contract Number
     D  P1L6NB                81     84P 0
      * I :  Price Status
     D  P1U1ST                85     85
      * I :  Pricing Date Used
     D  P1GIDT                86     89P 0
      * I :  U_M_Base Price
     D  P1CRCD                90     91
      * I :  U_M_Ordered
     D  P1AGCD                92     93
      * I :  Work Confirm Status
     D  P1RZST                94     94
      * I :  Work Over_Short Status
     D  P1R0ST                95     95
      * I :  OD Production Plan Sts
     D  P1R1ST                96     96
      * I :  Order Desc_Line One
     D  P1G7NA                97    126
      * I :  Order Desc_Line Two
     D  P1G8NA               127    156
      * I :  Age Code
     D  P1RPCD               157    157
      * I :  Palletize
     D  P1VEST               158    158
      * I :  Slip Sheet
     D  P1VGST               159    159
      * I :  Catch Weight Status
     D  P1AVST               160    160
      * I :  Price Audit
     D  P1U0ST               161    161
      * I :  Price Audit Reason Code
     D  P1RFCD               162    164
      * I :  Production Date Control
     D  P1FZST               165    165
      * I :  Rated Freight
     D  P1R1NB               166    171P 2
      * I :  Quantity Ordered
     D  P1AVQT               172    177P 2
      * I :  Weight Ordered
     D  P1D0WG               178    183P 2
      * I :  Quantity Scheduled
     D  P1CCQT               184    189P 2
      * I :  Weight Scheduled
     D  P1AUWG               190    195P 2
      * I :  Quantity Shipped Total
     D  P1CBQT               196    201P 2
      * I :  Weight Shipped Total
     D  P1ATWG               202    207P 2
      * I :  Unit Cost Pricing U_M
     D  P1AQCS               208    213P 4
      * I :  Unit Cost Per Pound
     D  P1AGCS               214    219P 4
      * I :  Unit Price
     D  P1AKPR               220    225P 4
      * I :  Unit Price_Credit
     D  P1ALPR               226    231P 4
      * I :  Unit Price Ordered U_M
     D  P1AUPR               232    237P 4
      * I :  Unit Weight Ordered U_M
     D  P1AVWG               238    243P 2
      * I :  Tare Weight Total
     D  P1A4WG               244    249P 2
      * I :  Requested Ship Date
     D  P1A5DT               250    253P 0
      * I :  Scheduled Ship Date
     D  P1AODT               254    257P 0
      * I :  Actual Shipped Date
     D  P1GNDT               258    261P 0
      * I :  Affect Inventory Status
     D  P1AMST               262    262
      * I :  Affect Sales Doll Status
     D  P1ANST               263    263
      * I :  Affect Sales Pnds Status
     D  P1VAST               264    264
      * I :  Item Structure Type Code
     D  P1RGNB               265    266P 0
      * I :  Item Structure Group Code
     D  P1RHNB               267    268P 0
      * I :  Item Structure Class Code
     D  P1RINB               269    270P 0
      * I :  Item Level
     D  P1RBCD               271    272
      * I :  Quality Level
     D  P1HICD               273    274
      * I :  Pricing Product Class Rep
     D  P1RNCD               275    276
      * I :  Season Product Class Repo
     D  P1ROCD               277    278
      * I :  Date of Original Entry
     D  P1CXDT               279    282P 0
      * I :  User Profile Name
     D  P1AJVN               283    292
      * I :  Country Code
     D  P1KXCD               293    298
      * I :  Event Code
     D  P1JPCD               299    300
      * I :  Reason Code
     D  P1CQCD               301    303
      * I :  Sales Route Code
     D  P1R4CD               304    306
      * I :  Modified Flag
     D  P1Z1ST               307    307
      * I :  Substituted Flag
     D  P1Z3ST               308    308
      * I :  OD Schedule Override Sts
     D  P1Z4ST               309    309
      * I :  Invoice Unit Price
     D  P1DUPR               310    315P 4
      * I :  Invoice Extended Amt
     D  P1B6VL               316    321P 2
      * I :  Ham Group Number
     D  P1A1AA               322    323P 0
      * I :  OD Adj Type Override
     D  P1FZSX               324    324
      * I :  Affect Trade Fund
     D  P1F0SX               325    325
      * I :  Affect Commission
     D  P1F1SX               326    326
      * I :  Affect Pricing
     D  P1F2SX               327    327
      * I :  Released by User Sts Y_N
     D  P1F3SX               328    328
      * I :  Ord TF Exempt Code
     D  P1F4SX               329    330
      * I :  OD Pallet Type
     D  P1F5SX               331    332
      * I :  Production Warehouse
     D  P1F6SX               333    335
      * I :  OD Price Type
     D  P1F7SX               336    338
      * I :  Warehouse Pallets Loaded
     D  P1NTDT               339    342P 0
      * I :  Consumed Item Code
     D  P1NUDT               343    346P 0
      * I :  Deadline Depart Date LH
     D  P1NVDT               347    350P 0
      * I :  OD Price Type Ref Num
     D  P1NWDT               351    354P 0
      * I :  OD Firm Date
     D  P1NXDT               355    358P 0
      * I :  Deadline Depart Time LH
     D  P1BUTM               359    362P 0
      * I :  Price Code
     D  P1BVTM               363    366P 0
      * I :  Maximum Net Weight
     D  P1BWTM               367    370P 0
      * I :  Substitution Line Number
     D  P1BXTM               371    374P 0
      * I :  Max Qty to sched per day
     D  P1BYTM               375    378P 0
      * I :  Warehouse Pallet Tare
     D  P1H5NX               379    384P 2
      * I :  Warehouse Avg Pallet Tare
     D  P1H6NX               385    390P 2
      * I :  OD Item Target Price
     D  P1H7NX               391    396P 2
      * I :  OD Estimated Gross Weight
     D  P1H8NX               397    402P 2
      * I :  OD Maximum Unit Weight
     D  P1H9NX               403    408P 2
      * I :  Order Gate_Final Price
     D  P1DVPR               409    414P 4
      * I :  OD Ceiling Price
     D  P1DWPR               415    420P 4
      * I :  OD Gate_Final Price Adj
     D  P1DXPR               421    426P 4
      * I :  OD Weighted Avg Price
     D  P1DYPR               427    432P 4
      * I :  OD Original Ordered Qty
     D  P1DZPR               433    438P 4
      * I :  OD Cancel Date
     D  P1GSPR               439    444P 4
      * I :  OD Unused Prc 7
     D  P1GTPR               445    450P 4
      * I :  OD Unused Prc 8
     D  P1GUPR               451    456P 4
      * I :  OD MPR Sent to USDA Sts
     D  P1HOST               457    457
      * I :  OD MPR Prc Ready to Send
     D  P1HPST               458    458
      * I :  OD UnUsed Price Sts 3
     D  P1IOST               459    459
      * I :  Weight Amount Entered
     D  P1PEWG               460    465P 2
      * I :  Item Age Days
     D  P1RINY               466    468P 0
      * I :  Production Ovr AgeDte Fr
     D  P1TIDT               469    472P 0
      * I :  Production Ovr AgeDte To
     D  P1TJDT               473    476P 0
      * I :  OD Spot Buy
     D  P1H2ST               477    477
      * I :  OD Clm Full Return to Plt
     D  P1H0ST               478    479
      * I :  Order Line Error Type
     D  P1H1ST               480    482
      * I :  OD Market Begin Date
     D  P1TKDT               483    486P 0
      * I :  OD Market Ending Date
     D  P1TLDT               487    490P 0
      * I :  OD Atch to Ord ActShpDte
     D  P1TMDT               491    494P 0
      * I :  EDI Status 1
     D  P1UVST               495    495
      * I :  EDI Status 2
     D  P1UWST               496    496
      * I :  EDI Status 3
     D  P1UXST               497    497
     D                 DS
     D  ZAMSDA                 1    132
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                      WAAIC3
     I              OMC4NB                      WAC4NB
     I              OMDPNB                      WADPNB
     I              OMUENB                      WAUENB
     I              OMHGCD                      WAHGCD
     I              OMAJCD                      WAAJCD
     I              OMBKC7                      WABKC7
     I              OMCFC7                      WACFC7
     I              OMGMST                      WAGMST
     I              OMGNST                      WAGNST
     I              OMMAVA                      WAMAVA
     I              OMKDVA                      WAKDVA
     I              OML8VA                      WAL8VA
     I              OML9VA                      WAL9VA
     I              OMGTST                      WAGTST
     I              OMGVST                      WAGVST
     I              OMGUST                      WAGUST
     I              OMQFST                      WAQFST
     I              OMAYVA                      WAAYVA
     I              OMEXDT                      WAEXDT
     I              OMLQCD                      WALQCD
     I              OMRDCD                      WARDCD
     I              OMQ7CD                      WAQ7CD
     I              OMBZPR                      WABZPR
     I              OML6NB                      WAL6NB
     I              OMU1ST                      WAU1ST
     I              OMGIDT                      WAGIDT
     I              OMCRCD                      WACRCD
     I              OMAGCD                      WAAGCD
     I              OMRZST                      WARZST
     I              OMR0ST                      WAR0ST
     I              OMR1ST                      WAR1ST
     I              OMG7NA                      WAG7NA
     I              OMG8NA                      WAG8NA
     I              OMRPCD                      WARPCD
     I              OMVEST                      WAVEST
     I              OMVGST                      WAVGST
     I              OMAVST                      WAAVST
     I              OMU0ST                      WAU0ST
     I              OMRFCD                      WARFCD
     I              OMFZST                      WAFZST
     I              OMR1NB                      WAR1NB
     I              OMAVQT                      WAAVQT
     I              OMD0WG                      WAD0WG
     I              OMCCQT                      WACCQT
     I              OMAUWG                      WAAUWG
     I              OMCBQT                      WACBQT
     I              OMATWG                      WAATWG
     I              OMAQCS                      WAAQCS
     I              OMAGCS                      WAAGCS
     I              OMAKPR                      WAAKPR
     I              OMALPR                      WAALPR
     I              OMAUPR                      WAAUPR
     I              OMAVWG                      WAAVWG
     I              OMA4WG                      WAA4WG
     I              OMA5DT                      WAA5DT
     I              OMAODT                      WAAODT
     I              OMGNDT                      WAGNDT
     I              OMAMST                      WAAMST
     I              OMANST                      WAANST
     I              OMVAST                      WAVAST
     I              OMRGNB                      WARGNB
     I              OMRHNB                      WARHNB
     I              OMRINB                      WARINB
     I              OMRBCD                      WARBCD
     I              OMHICD                      WAHICD
     I              OMRNCD                      WARNCD
     I              OMROCD                      WAROCD
     I              OMCXDT                      WACXDT
     I              OMAJVN                      WAAJVN
     I              OMKXCD                      WAKXCD
     I              OMJPCD                      WAJPCD
     I              OMCQCD                      WACQCD
     I              OMR4CD                      WAR4CD
     I              OMZ1ST                      WAZ1ST
     I              OMZ3ST                      WAZ3ST
     I              OMZ4ST                      WAZ4ST
     I              OMDUPR                      WADUPR
     I              OMB6VL                      WAB6VL
     I              OMA1AA                      WAA1AA
     I              OMFZSX                      WAFZSX
     I              OMF0SX                      WAF0SX
     I              OMF1SX                      WAF1SX
     I              OMF2SX                      WAF2SX
     I              OMF3SX                      WAF3SX
     I              OMF4SX                      WAF4SX
     I              OMF5SX                      WAF5SX
     I              OMF6SX                      WAF6SX
     I              OMF7SX                      WAF7SX
     I              OMNTDT                      WANTDT
     I              OMNUDT                      WANUDT
     I              OMNVDT                      WANVDT
     I              OMNWDT                      WANWDT
     I              OMNXDT                      WANXDT
     I              OMBUTM                      WABUTM
     I              OMBVTM                      WABVTM
     I              OMBWTM                      WABWTM
     I              OMBXTM                      WABXTM
     I              OMBYTM                      WABYTM
     I              OMH5NX                      WAH5NX
     I              OMH6NX                      WAH6NX
     I              OMH7NX                      WAH7NX
     I              OMH8NX                      WAH8NX
     I              OMH9NX                      WAH9NX
     I              OMDVPR                      WADVPR
     I              OMDWPR                      WADWPR
     I              OMDXPR                      WADXPR
     I              OMDYPR                      WADYPR
     I              OMDZPR                      WADZPR
     I              OMGSPR                      WAGSPR
     I              OMGTPR                      WAGTPR
     I              OMGUPR                      WAGUPR
     I              OMHOST                      WAHOST
     I              OMHPST                      WAHPST
     I              OMIOST                      WAIOST
     I              OMPEWG                      WAPEWG
     I              OMRINY                      WARINY
     I              OMTIDT                      WATIDT
     I              OMTJDT                      WATJDT
     I              OMH2ST                      WAH2ST
     I              OMH0ST                      WAH0ST
     I              OMH1ST                      WAH1ST
     I              OMTKDT                      WATKDT
     I              OMTLDT                      WATLDT
     I              OMTMDT                      WATMDT
     I              OMUVST                      WAUVST
     I              OMUWST                      WAUWST
     I              OMUXST                      WAUXST
     I              OMAATM                      WAAATM
     I              OMAYNA                      WAAYNA
     I              OMA0NA                      WAA0NA
     I              OMAXDT                      WAAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                      WBAJCD
     I              ADF8NA                      WBF8NA
     I              ADACNA                      WBACNA
     I              ADADNA                      WBADNA
     I              ADAENA                      WBAENA
     I              ADAJNA                      WBAJNA
     I              ADBTTX                      WBBTTX
     I              ADAOCD                      WBAOCD
     I              ADBGCD                      WBBGCD
     I              ADVHST                      WBVHST
     I              ADMPNA                      WBMPNA
     I              ADWPST                      WBWPST
     I              ADXUST                      WBXUST
     I              ADT0ST                      WBT0ST
     I              ADT1ST                      WBT1ST
     I              ADDBNB                      WBDBNB
     I              ADT2ST                      WBT2ST
     I              ADT3ST                      WBT3ST
     I              ADT4ST                      WBT4ST
     I              ADT6ST                      WBT6ST
     I              ADBWC3                      WBBWC3
     I              ADBTC3                      WBBTC3
     I              ADBUC3                      WBBUC3
     I              ADBVC3                      WBBVC3
     I              ADFCAA                      WBFCAA
     I              ADRQSX                      WBRQSX
     I              ADRRSX                      WBRRSX
     I              ADRSSX                      WBRSSX
     I              ADRTSX                      WBRTSX
     I              ADT7ST                      WBT7ST
     I              ADT8ST                      WBT8ST
     I              ADRNSX                      WBRNSX
     I              ADROSX                      WBROSX
     I              ADRPSX                      WBRPSX
     I              ADUVST                      WBUVST
     I              ADUWST                      WBUWST
     I              ADUXST                      WBUXST
     I              ADVSST                      WBVSST
     I              ADAATM                      WBAATM
     I              ADAYNA                      WBAYNA
     I              ADA0NA                      WBA0NA
     I              ADAXDT                      WBAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Order Deta
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Crt Block Order Qtemp XF
      * Create Order Detail (OPBGWKP) Record in QTEMP.
      * Crt Block Order Qtemp CR - Order Detail  * 
     C                   EXSR      SACRRC
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt Block Order Qtemp CR - Order Detail  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Job Time
     C                   EVAL      WN0002 = ' '                                 User Id
     C                   EVAL      WN0003 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0004                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @BGWKL0
     C                   Z-ADD     P1AIC3        WAAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WAC4NB                         Order Number
     C                   Z-ADD     P1DPNB        WADPNB                         Order Sequence
     C                   Z-ADD     P1UENB        WAUENB                         Order Secondary
     C                   Z-ADD     P1HGCD        WAHGCD                         Item Code
     C                   MOVEL     P1AJCD        WAAJCD                         Warehouse Code
     C                   Z-ADD     P1BKC7        WABKC7                         Ship To Custome
     C                   Z-ADD     P1CFC7        WACFC7                         Order Group Cod
     C                   MOVEL     P1GMST        WAGMST                         Detail Line Sta
     C                   MOVEL     P1GNST        WAGNST                         Detail Line Sta
     C                   Z-ADD     P1MAVA        WAMAVA                         Billing Detail
     C                   Z-ADD     P1KDVA        WAKDVA                         Billing Detail
     C                   Z-ADD     P1L8VA        WAL8VA                         Billing Detail
     C                   Z-ADD     P1L9VA        WAL9VA                         Quantity to Sub
     C                   MOVEL     P1GTST        WAGTST                         Comment Print A
     C                   MOVEL     P1GVST        WAGVST                         Comment Print I
     C                   MOVEL     P1GUST        WAGUST                         Comment Print P
     C                   MOVEL     P1QFST        WAQFST                         Comment Print S
     C                   Z-ADD     P1AYVA        WAAYVA                         Extended Amount
     C                   Z-ADD     P1EXDT        WAEXDT                         Market Pricing
     C                   MOVEL     P1LQCD        WALQCD                         Commodity Marke
     C                   MOVEL     P1RDCD        WARDCD                         Date Method Cod
     C                   MOVEL     P1Q7CD        WAQ7CD                         Price Method Co
     C                   Z-ADD     P1BZPR        WABZPR                         Price Overage O
     C                   Z-ADD     P1L6NB        WAL6NB                         Contract Number
     C                   MOVEL     P1U1ST        WAU1ST                         Price Status
     C                   Z-ADD     P1GIDT        WAGIDT                         Pricing Date Us
     C                   MOVEL     P1CRCD        WACRCD                         U_M_Base Price
     C                   MOVEL     P1AGCD        WAAGCD                         U_M_Ordered
     C                   MOVEL     P1RZST        WARZST                         Work Confirm St
     C                   MOVEL     P1R0ST        WAR0ST                         Work Over_Short
     C                   MOVEL     P1R1ST        WAR1ST                         OD Production P
     C                   MOVEL     P1G7NA        WAG7NA                         Order Desc_Line
     C                   MOVEL     P1G8NA        WAG8NA                         Order Desc_Line
     C                   MOVEL     P1RPCD        WARPCD                         Age Code
     C                   MOVEL     P1VEST        WAVEST                         Palletize
     C                   MOVEL     P1VGST        WAVGST                         Slip Sheet
     C                   MOVEL     P1AVST        WAAVST                         Catch Weight St
     C                   MOVEL     P1U0ST        WAU0ST                         Price Audit
     C                   MOVEL     P1RFCD        WARFCD                         Price Audit Rea
     C                   MOVEL     P1FZST        WAFZST                         Production Date
     C                   Z-ADD     P1R1NB        WAR1NB                         Rated Freight
     C                   Z-ADD     P1AVQT        WAAVQT                         Quantity Ordere
     C                   Z-ADD     P1D0WG        WAD0WG                         Weight Ordered
     C                   Z-ADD     P1CCQT        WACCQT                         Quantity Schedu
     C                   Z-ADD     P1AUWG        WAAUWG                         Weight Schedule
     C                   Z-ADD     P1CBQT        WACBQT                         Quantity Shippe
     C                   Z-ADD     P1ATWG        WAATWG                         Weight Shipped
     C                   Z-ADD     P1AQCS        WAAQCS                         Unit Cost Prici
     C                   Z-ADD     P1AGCS        WAAGCS                         Unit Cost Per P
     C                   Z-ADD     P1AKPR        WAAKPR                         Unit Price
     C                   Z-ADD     P1ALPR        WAALPR                         Unit Price_Cred
     C                   Z-ADD     P1AUPR        WAAUPR                         Unit Price Orde
     C                   Z-ADD     P1AVWG        WAAVWG                         Unit Weight Ord
     C                   Z-ADD     P1A4WG        WAA4WG                         Tare Weight Tot
     C                   Z-ADD     P1A5DT        WAA5DT                         Requested Ship
     C                   Z-ADD     P1AODT        WAAODT                         Scheduled Ship
     C                   Z-ADD     P1GNDT        WAGNDT                         Actual Shipped
     C                   MOVEL     P1AMST        WAAMST                         Affect Inventor
     C                   MOVEL     P1ANST        WAANST                         Affect Sales Do
     C                   MOVEL     P1VAST        WAVAST                         Affect Sales Pn
     C                   Z-ADD     P1RGNB        WARGNB                         Item Structure
     C                   Z-ADD     P1RHNB        WARHNB                         Item Structure
     C                   Z-ADD     P1RINB        WARINB                         Item Structure
     C                   MOVEL     P1RBCD        WARBCD                         Item Level
     C                   MOVEL     P1HICD        WAHICD                         Quality Level
     C                   MOVEL     P1RNCD        WARNCD                         Pricing Product
     C                   MOVEL     P1ROCD        WAROCD                         Season Product
     C                   Z-ADD     P1CXDT        WACXDT                         Date of Origina
     C                   MOVEL     P1AJVN        WAAJVN                         User Profile Na
     C                   MOVEL     P1KXCD        WAKXCD                         Country Code
     C                   MOVEL     P1JPCD        WAJPCD                         Event Code
     C                   MOVEL     P1CQCD        WACQCD                         Reason Code
     C                   MOVEL     P1R4CD        WAR4CD                         Sales Route Cod
     C                   MOVEL     P1Z1ST        WAZ1ST                         Modified Flag
     C                   MOVEL     P1Z3ST        WAZ3ST                         Substituted Fla
     C                   MOVEL     P1Z4ST        WAZ4ST                         OD Schedule Ove
     C                   Z-ADD     P1DUPR        WADUPR                         Invoice Unit Pr
     C                   Z-ADD     P1B6VL        WAB6VL                         Invoice Extende
     C                   Z-ADD     P1A1AA        WAA1AA                         Ham Group Numbe
     C                   MOVEL     P1FZSX        WAFZSX                         OD Adj Type Ove
     C                   MOVEL     P1F0SX        WAF0SX                         Affect Trade Fu
     C                   MOVEL     P1F1SX        WAF1SX                         Affect Commissi
     C                   MOVEL     P1F2SX        WAF2SX                         Affect Pricing
     C                   MOVEL     P1F3SX        WAF3SX                         Released by Use
     C                   MOVEL     P1F4SX        WAF4SX                         Ord TF Exempt C
     C                   MOVEL     P1F5SX        WAF5SX                         OD Pallet Type
     C                   MOVEL     P1F6SX        WAF6SX                         Production Ware
     C                   MOVEL     P1F7SX        WAF7SX                         OD Price Type
     C                   Z-ADD     P1NTDT        WANTDT                         Warehouse Palle
     C                   Z-ADD     P1NUDT        WANUDT                         Consumed Item C
     C                   Z-ADD     P1NVDT        WANVDT                         Deadline Depart
     C                   Z-ADD     P1NWDT        WANWDT                         OD Price Type R
     C                   Z-ADD     P1NXDT        WANXDT                         OD Firm Date
     C                   Z-ADD     P1BUTM        WABUTM                         Deadline Depart
     C                   Z-ADD     P1BVTM        WABVTM                         Price Code
     C                   Z-ADD     P1BWTM        WABWTM                         Maximum Net Wei
     C                   Z-ADD     P1BXTM        WABXTM                         Substitution Li
     C                   Z-ADD     P1BYTM        WABYTM                         Max Qty to sche
     C                   Z-ADD     P1H5NX        WAH5NX                         Warehouse Palle
     C                   Z-ADD     P1H6NX        WAH6NX                         Warehouse Avg P
     C                   Z-ADD     P1H7NX        WAH7NX                         OD Item Target
     C                   Z-ADD     P1H8NX        WAH8NX                         OD Estimated Gr
     C                   Z-ADD     P1H9NX        WAH9NX                         OD Maximum Unit
     C                   Z-ADD     P1DVPR        WADVPR                         Order Gate_Fina
     C                   Z-ADD     P1DWPR        WADWPR                         OD Ceiling Pric
     C                   Z-ADD     P1DXPR        WADXPR                         OD Gate_Final P
     C                   Z-ADD     P1DYPR        WADYPR                         OD Weighted Avg
     C                   Z-ADD     P1DZPR        WADZPR                         OD Original Ord
     C                   Z-ADD     P1GSPR        WAGSPR                         OD Cancel Date
     C                   Z-ADD     P1GTPR        WAGTPR                         OD Unused Prc 7
     C                   Z-ADD     P1GUPR        WAGUPR                         OD Unused Prc 8
     C                   MOVEL     P1HOST        WAHOST                         OD MPR Sent to
     C                   MOVEL     P1HPST        WAHPST                         OD MPR Prc Read
     C                   MOVEL     P1IOST        WAIOST                         OD UnUsed Price
     C                   Z-ADD     P1PEWG        WAPEWG                         Weight Amount E
     C                   Z-ADD     P1RINY        WARINY                         Item Age Days
     C                   Z-ADD     P1TIDT        WATIDT                         Production Ovr
     C                   Z-ADD     P1TJDT        WATJDT                         Production Ovr
     C                   MOVEL     P1H2ST        WAH2ST                         OD Spot Buy
     C                   MOVEL     P1H0ST        WAH0ST                         OD Clm Full Ret
     C                   MOVEL     P1H1ST        WAH1ST                         Order Line Erro
     C                   Z-ADD     P1TKDT        WATKDT                         OD Market Begin
     C                   Z-ADD     P1TLDT        WATLDT                         OD Market Endin
     C                   Z-ADD     P1TMDT        WATMDT                         OD Atch to Ord
     C                   MOVEL     P1UVST        WAUVST                         EDI Status 1
     C                   MOVEL     P1UWST        WAUWST                         EDI Status 2
     C                   MOVEL     P1UXST        WAUXST                         EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                   Z-ADD     ##JTM         WAAATM                         Job Time
     C                   MOVEL     ##USR         WAAYNA                         User Id
     C                   MOVEL     ##PGM         WAA0NA                         Job Name
     C                   Z-ADD     ##JDT         WAAXDT                         Job Date
     C                   MOVEL     @CN(001)      WAAYNA                         User Id
     C                   MOVEL     @CN(002)      WAA0NA                         Job Name
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt func
     C                   EXSR      UASUBR                                       Calc Gross Weig
      * ** WI546_2 Added code similar to manual Block Order
     C                   EVAL      WARPCD = ' '                                 Age Code
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                   CALL      'POP1XFR'                            90      Rtv First Consu
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0011                         Company Number
     C                   PARM      WAHGCD        WQ0012                         Item Code
     C     WANUDT        PARM      *ZERO         WQ0013                         Component Item
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'POP1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Rtv Productin Whs     RT - Warehouse Codes  * 
     C                   EXSR      SBRVGN
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADPNB                         Order Sequence
     C                   KFLD                    WAUENB                         Order Secondary
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @BGWKL0                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR1310'     W0RTN
      * Send message 'Order Detail           EX'
     C                   MOVEL     'USR1310'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @BGWKL0                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WAAJCD        WBAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSB         CHAIN     @ADRET1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WAF6SX = ' '                                 Production Ware
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBAOCD        WAF6SX                         Production Ware
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Calc Gross Weight from tares...    copied from Dsp Gross Wgt fun
      *================================================================
      * Rtv Tare Weight        XF - Company Item  * 
     C                   CALL      'PBI3XFR'                            90      Rtv Tare Weight
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0001                         Company Number
     C                   PARM      WAHGCD        WQ0002                         Item Code
     C     YL0001        PARM      YL0001        WQ0003                         Misc Tare Weigh
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI3XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * wi464
      * RTV Itm BxID & Tares  XF - Item Bill Of Material  * 
     C                   CALL      'PBI4XFR'                            90      RTV Itm BxID &
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0004                         Company Number
     C                   PARM      WAHGCD        WQ0005                         Item Code
     C     YL0002        PARM      *ZERO         WQ0006                         Box Weight
     C     YL0003        PARM      *ZERO         WQ0007                         Number Cases On
     C     YL0004        PARM      *ZERO         WQ0008                         Pallet Tare Wei
     C     YL0005        PARM      *ZERO         WQ0009                         Box iD
     C                   PARM      WAF5SX        WQ0010                         OD Pallet Type
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PBI4XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C     YL0002        ADD       YL0001        YL0006                         Total Tare USR
      * Box + Misc Tare
      * LCL.Weight 1.1             .U =
      *    *COMPUTE ((x1 + x2) * x3)
      * x1    : LCL.Box Weight
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Misc Tare Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Quantity Ordered
     C     YL0002        ADD       YL0001        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   WAAVQT        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0007                         Weight 1.1
      * Pallet Tare
      * CASE: DB1.Palletize is yes
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C                   IF        WAVEST = 'Y'
      * Pallet Weight
      * LCL.Weight 1.2             .U =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.Number Cases On A Pallet
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : LCL.Pallet Tare Weight
     C                   IF        YL0003 > 0
     C     WAAVQT        DIV(H)    YL0003        W0WA01                         *Synon (15,2) w
     C     W0WA01        MULT(H)   YL0004        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        YL0008                         Weight 1.2
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0008                         Weight 1.2
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     *ZERO         YL0008                         Weight 1.2
     C                   END                                                    *FI
      * Estimated Gross
      * DB1.OD Minimum Unit Weight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : DB1.Weight Ordered
      * +     : PGM.*Synon (15,2) work field
      * x2    : LCL.Weight 1.1             .U
      * +     : PGM.*Synon (15,2) work field
      * x3    : LCL.Weight 1.2             .U
     C     WAD0WG        ADD       YL0007        W0WA01                         *Synon (15,2) w
     C     W0WA01        ADD       YL0008        W0WA00                         *Synon (15,2) w
     C                   Z-ADD     W0WA00        WAH8NX                         OD Estimated Gr
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WADPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WAUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WAHGCD                         Item Code
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WACFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WAMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WAL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WAAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WAEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WABZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WAL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WAGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WAAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WAD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WACCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WAAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WACBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WAATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WAAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WAAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WAAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WAALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WAAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WAAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WAA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WARGNB                         Item Structure
     C                   Z-ADD     *ZERO         WARHNB                         Item Structure
     C                   Z-ADD     *ZERO         WARINB                         Item Structure
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WADUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WAB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WAA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WANTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WANUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WANVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WANWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WANXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WABUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WABVTM                         Price Code
     C                   Z-ADD     *ZERO         WABWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WABXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WABYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WAH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WAH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WAH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WAH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WAH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WADVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WADWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WADXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WADYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WADZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WAGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WAGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WAGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WAPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WARINY                         Item Age Days
     C                   Z-ADD     *ZERO         WATIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WATKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WATLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WATMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WBBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WBBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WBBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WBBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        W0WA01                         *Synon (15,2) w
     C                   Z-ADD     *ZEROS        W0WA00                         *Synon (15,2) w
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Misc Tare Weight
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Box Weight
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Number Cases On A Pallet
     C                   Z-ADD     *ZERO         YL0003
      * Define local work field Pallet Tare Weight
     C                   Z-ADD     *ZERO         YL0004
      * Define local work field Box iD
     C                   Z-ADD     *ZERO         YL0005
      * Define local work field Total Tare USR
     C                   Z-ADD     *ZERO         YL0006
      * Define local work field Weight 1.1             .U
     C                   Z-ADD     *ZERO         YL0007
      * Define local work field Weight 1.2             .U
     C                   Z-ADD     *ZERO         YL0008
      * Define null work field Accounting Company
     C                   Z-ADD     *ZERO         YN0001
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 INFORMATIC
00002 AUTOUPLOAD
