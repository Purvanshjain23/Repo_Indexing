     H/TITLE EDT Company Default    E2 Edit record(2 screens)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Edit record(2 screens)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 16:18:02
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FCAC4E3R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Company Default    E2 Edit record(2 screens)
      *
     FCAAQREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Company Defaults          Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FCAAOREL0IF  E           K        DISK
      * RTV : Terms                     Retrieval index       NV
      *
     FCAALREL1IF  E           K        DISK
      * RTV : Manager Level             Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FPDIHREL4IF  E           K        DISK
      * RSQ : Price Method Header       Price Method Header
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FPDIHREL3IF  E           K        DISK
      * RSQ : Price Method Header       System/Co/Price Method
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FCAALREL3IF  E           K        DISK
      * RTV : Manager Level             Active Only
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms                     Retrieve Active Records
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCAAAREL1IF  E           K        DISK
      * RTV : System Control            Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAQREL0UF  E           K        DISK                      A
      * UPD : Company Defaults          Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   1 001  5 0A
     E                    W0END   1 001  5 0A
     E                    W0NAM   1 001 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 024  5 0A
     E                    W1END   7 024  5 0A
     E                    W1NAM   7 024 10
      * DETAIL 2 Screen: Field position and name array
     E                    W2BEG   7 012  5 0A
     E                    W2END   7 012  5 0A
     E                    W2NAM   7 012 10
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WAAIC3
     I              ABADTX                          WAADTX
     I              ABACNA                          WAACNA
     I              ABADNA                          WAADNA
     I              ABAENA                          WAAENA
     I              ABAJNA                          WAAJNA
     I              ABBTTX                          WABTTX
     I              ABBVTX                          WABVTX
     I              ABBWTX                          WABWTX
     I              ABA2NA                          WAA2NA
     I              ABABTX                          WAABTX
     I              ABBGCD                          WABGCD
     I              ABKXCD                          WAKXCD
     I              ABUVST                          WAUVST
     I              ABUWST                          WAUWST
     I              ABUXST                          WAUXST
     I              ABVSST                          WAVSST
     I              ABAATM                          WAAATM
     I              ABAYNA                          WAAYNA
     I              ABA0NA                          WAA0NA
     I              ABAXDT                          WAAXDT
      *
     I@IHREFI
      * Price Method Header       System/Co/Price Method
      * Renamed input format fields
     I              IHAIC3                          WBAIC3
     I              IHQ7CD                          WBQ7CD
     I              IHMLNA                          WBMLNA
     I              IHU0ST                          WBU0ST
     I              IHV8ST                          WBV8ST
     I              IHBYST                          WBBYST
     I              IHRMNY                          WBRMNY
     I              IHH3ST                          WBH3ST
     I              IHH5ST                          WBH5ST
     I              IHH6ST                          WBH6ST
     I              IHH7ST                          WBH7ST
     I              IHUVST                          WBUVST
     I              IHUWST                          WBUWST
     I              IHUXST                          WBUXST
     I              IHAATM                          WBAATM
     I              IHAYNA                          WBAYNA
     I              IHA0NA                          WBA0NA
     I              IHAXDT                          WBAXDT
      *
     I@FFREUG
      * Carrier                   Active records
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
     I@ALREVE
      * Manager Level             Active Only
      * Renamed input format fields
     I              ALBFCD                          WDBFCD
     I              ALAUNA                          WDAUNA
     I              ALQ4CD                          WDQ4CD
     I              ALUVST                          WDUVST
     I              ALUWST                          WDUWST
     I              ALUXST                          WDUXST
     I              ALVSST                          WDVSST
     I              ALAATM                          WDAATM
     I              ALAYNA                          WDAYNA
     I              ALA0NA                          WDA0NA
     I              ALAXDT                          WDAXDT
      *
     I@AOREU1
      * Terms                     Retrieve Active Records
      * Renamed input format fields
     I              AOAIC3                          WEAIC3
     I              AOAQCD                          WEAQCD
     I              AOAUNA                          WEAUNA
     I              AOD3ST                          WED3ST
     I              AOANDY                          WEANDY
     I              AOAKDY                          WEAKDY
     I              AOA4PC                          WEA4PC
     I              AOAJDY                          WEAJDY
     I              AOCUNB                          WECUNB
     I              AOALDY                          WEALDY
     I              AOAPDY                          WEAPDY
     I              AOCTNB                          WECTNB
     I              AOAMDY                          WEAMDY
     I              AOAQDY                          WEAQDY
     I              AOASDT                          WEASDT
     I              AOATDT                          WEATDT
     I              AOUVST                          WEUVST
     I              AOUWST                          WEUWST
     I              AOUXST                          WEUXST
     I              AOVSST                          WEVSST
     I              AOAATM                          WEAATM
     I              AOAYNA                          WEAYNA
     I              AOA0NA                          WEA0NA
     I              AOAXDT                          WEAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WFAIC3
     I              IHQ7CD                          WFQ7CD
     I              IHMLNA                          WFMLNA
     I              IHU0ST                          WFU0ST
     I              IHV8ST                          WFV8ST
     I              IHBYST                          WFBYST
     I              IHRMNY                          WFRMNY
     I              IHH3ST                          WFH3ST
     I              IHH5ST                          WFH5ST
     I              IHH6ST                          WFH6ST
     I              IHH7ST                          WFH7ST
     I              IHUVST                          WFUVST
     I              IHUWST                          WFUWST
     I              IHUXST                          WFUXST
     I              IHAATM                          WFAATM
     I              IHAYNA                          WFAYNA
     I              IHA0NA                          WFA0NA
     I              IHAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSCAAQREL0
      * UPD : Company Defaults          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            268
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  43 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  39 INSCR2
     IYARDCS      DS                            268
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  System Date Format
     I                                       15  17 P1B8NA
      * N :  User Profile Name
     I                                       18  27 P1AJVN
      * N :  Allow Multi-Company
     I                                       28  28 P1I6ST
      * N :  Default Printer
     I                                       29  38 P1MPNA
     IP2PARM      DS
      * FLD: Company Defaults
      * N :  Record Status
     I                                        1   1 P2VSST
     IP3PARM      DS
      * N :  USR Display field
     I                                        1   1 P3GGST
     IP4PARM      DS
      * FLD: System Control
      * N :  Inventory Status
     I                                        1   1 P4BRST
      * N :  Order Processing Status
     I                                        2   2 P4CCST
      * N :  Purchasing Status
     I                                        3   3 P4C9ST
      * N :  General Ledger Status
     I                                        4   4 P4BNST
      * N :  Accounts Payable Status
     I                                        5   5 P4AKST
      * N :  Accounts Receivable Sts
     I                                        6   6 P4ALST
     IP5PARM      DS
      * N :  USR Name
     I                                        1  30 P5A7TX
     IP6PARM      DS
      * FLD: Print Options
      * N :  PRT Description
     I                                        1  25 P6G3TX
      * N :  PRT Printer Device
     I                                       26  35 P6WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P6WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P6WTST
      * N :  PRT Number of Copies
     I                                       44  450P6DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P6WUST
      * N :  PRT Night Queue
     I                                       47  56 P6BVVN
     IP7PARM      DS
      * N :  System Value Numeric
     I                                    P   1   85P7M8NB
     IP8PARM      DS
      * N :  Company Number Pass   USR
     I                                    P   1   85P8AJAA
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Price Meth Invalid-Cr/Dr'
      * Price Method Code
     I                                        1   3 ZA0001
      * Message data for 'Price Meth Invalid-Cr/Dr'
      * Price Method Code
     I                                        1   3 ZA0002
      * Message data for 'A/P installed, must terms'
      * Message data for 'A/R installed, must terms'
      * Message data for 'O/E installed, sls terr'
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0005
      * Application Code
     I                                       11  16 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Repeat forever
     C                     DO   *HIVAL
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Display key screen
     C                     EXSR BBEXFM
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           AQAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    AQAIC3
     C           KRTV      CHAIN@AQREB9              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Company Defaults       NF'
     C                     MOVEL'USR0041' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
      * RTV SR Desc,person     RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELAQR4CD    WL0003    P      Sales Route Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUMZNA    P      Sales Route Des
     C                     MOVELWL0005    WUBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUBCCD    WL0006    P      Salesperson Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WUBCCD    P      Salesperson Cod
     C                     MOVELWL0007    #DA7TX    P      Salesperson Nam
      * RTV Terms              RT - Terms  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAQAIC3    WL0008           Company Number
     C                     MOVELAQIDCD    WL0009    P      Terms Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DCFNA    P      Description
     C                     MOVELWL0011    WUD3ST    P      Terms Type
      * RTV Terms              RT - Terms  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAQAIC3    WL0008           Company Number
     C                     MOVELAQBSCD    WL0009    P      Terms Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DCGNA    P      Description
     C                     MOVELWL0011    WUD3ST    P      Terms Type
      * RTV Manager Descript   RT - Manager Level  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELAQBFCD    WL0012    P      Manager Level C
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    #DDCNA    P      Description
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELAQBZNA    WL0014    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    #DADTX    P      Name
     C                     MOVELWL0016    WUG0TX    P      Record Status
      * RTV Active Description RT - State  * 
     C                     EXSR SGRVGN
      * DTL.USR Description - 15 = Condition name of DB1.A/R Open Item/Ba
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158389   Y2LSNO  70       List number
     C                     PARM AQAIST    W0INVL 25        A/R Open Item/B
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJUNA    PARM           W0CNNM 25        USR Description
      *
      * DTL.Yes/No Description = Condition name of DB1.Contract Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM AQA3ST    W0INVL 25        Contract Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNANA    PARM           W0CNNM 25        Yes/No Descript
      *
     C                     MOVEL*BLANK    #DNBNA           Yes/No Descript
     C                     MOVELAQAVST    #DNBNA           Yes/No Descript
      * DTL.Status Description = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1TOCD    WL0017    P      Price Method Co
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    #DAUNA    P      Price Method De
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1TPCD    WL0017    P      Price Method Co
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    #DAWNA    P      Price Method De
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     9931  *
      * Send message 'Company Defaults       EX'
     C                     MOVEL'USR0042' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
     C                     MOVEL'A'       #1VSST           Record Status
      * DTL.Status Description = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
      * Set defaults if A/R is active
      * CASE: PAR.Accounts Receivable Sts is yes
     C           P4ALST    IFEQ 'Y'                        *IF
     C                     MOVEL'O'       #1AIST           A/R Open Item/B
     C                     END                             *FI
      * RTV Text Value         RT - System Values  * Contract Status
      * Move input parameters to subroutine local variables.
     C                     MOVEL'DFTCS'   WL0019    P      System Value Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUBXTX    P      System Value Al
      * Load contract status based on system value
      * CASE: WRK.System Value Alpha is Equal to Y
     C           WUBXTX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #1A3ST           Contract Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1A3ST           Contract Status
     C                     END                             *FI
     C                     MOVEL'N'       #1AVST           Catch Weight St
      * RTV Text Value         RT - System Values  * Enable Catchweight
      * Move input parameters to subroutine local variables.
     C                     MOVEL'ENBCWP'  WL0019    P      System Value Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUBXTX    P      System Value Al
      * Load catchweight status based on system value
      * CASE: WRK.System Value Alpha is Equal to Y
     C           WUBXTX    IFEQ 'Y'                        *IF
      * RTV Text Value         RT - System Values  * Catchweight Default
      * Move input parameters to subroutine local variables.
     C                     MOVEL'DFTCWP'  WL0019    P      System Value Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUBXTX    P      System Value Al
      * CASE: WRK.System Value Alpha is Equal to Y
     C           WUBXTX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #1AVST           Catch Weight St
     C                     END                             *FI
     C                     END                             *FI
      * Set defaults if P/O is active
      * CASE: PAR.Purchasing Status is yes
     C           P4C9ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #1J8ST           PO Matching Req
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1J8ST           PO Matching Req
     C                     END                             *FI
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
      * Move 'V1' Company Nbr  ? - /UT User Source  * 
     C                     MOVELV1AIC3    WUELST
      * CASE: WRK.USR Search Request is Search requested
     C           WUELST    IFEQ '?'                        *IF
      * SEL Company by Number  SR - Company Name and Address  * 
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0002  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD2         W0SCR
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD1         W0SCR
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C                     Z-ADD2         W0SCR
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate PO Matching Required
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1J8ST    W0NSRQ  1        PO Matching Req
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1J8ST'  OREQ YPMTFD
     C           W0SCR     ANDEQ1
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #1J8ST    PARM #1J8ST    W0EXVL 25        PO Matching Req
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,33
     C                     SETON                     99    *
     C                     END
      * Validate A/R Open Item/Balance Fwd
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1AIST    W0NSRQ  1        A/R Open Item/B
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1AIST'  OREQ YPMTFD
     C           W0SCR     ANDEQ1
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158389   Y2LSNO  70
     C           #1AIST    PARM #1AIST    W0EXVL 25        A/R Open Item/B
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,35
     C                     SETON                     99    *
     C                     END
      * Validate Contract Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1A3ST    W0NSRQ  1        Contract Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1A3ST'  OREQ YPMTFD
     C           W0SCR     ANDEQ1
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #1A3ST    PARM #1A3ST    W0EXVL 25        Contract Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,36
     C                     SETON                     99    *
     C                     END
      * Validate Catch Weight Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1AVST    W0NSRQ  1        Catch Weight St
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1AVST'  OREQ YPMTFD
     C           W0SCR     ANDEQ1
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #1AVST    PARM #1AVST    W0EXVL 25        Catch Weight St
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
     C                     END
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VSST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Record Status
     C                     MOVEL#1VSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVSST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZHVSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHVSST
     C                     ENDSL
     C                     EXFMTZGVSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVSST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZHVSST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,43
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Select state
      * CASE: Select State
      *  - (c1 AND c2) OR c3 OR c4
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> 2ND.Alt Remittance State
      *   |- c3    : 2ND.Alt Remittance State is Select State
      *   |- c4    : 2ND.Alt Remittance State is Select State 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0SCR     IFEQ 2                          *
     C           W0CFL     ANDEQ'#1LWCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1LWCD    IFEQ '?'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1LWCD    IFEQ ' ?'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1LWCD    PARM #1LWCD    WQ0003  2        State Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,35           *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * DTL.USR Description - 15 = Condition name of DTL.A/R Open Item/Ba
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158389   Y2LSNO  70       List number
     C                     PARM #1AIST    W0INVL 25        A/R Open Item/B
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJUNA    PARM           W0CNNM 25        USR Description
      *
      * DTL.Yes/No Description = Condition name of DTL.Contract Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1A3ST    W0INVL 25        Contract Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNANA    PARM           W0CNNM 25        Yes/No Descript
      *
     C                     MOVEL*BLANK    #DNBNA           Yes/No Descript
     C                     MOVEL#1AVST    #DNBNA           Yes/No Descript
      * DTL.Status Description = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * RTV Prc MthTyp,Dsc-Sys RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0021           Company Number
     C                     MOVEL#1TOCD    WL0022    P      Price Method Co
     C                     MOVEL'O'       WL0025    P      System Using Pr
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    #DAUNA    P      Price Method De
     C                     MOVELWL0024    WUV8ST    P      Price Method Ty
      * Validate C/M default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: WRK.Price Method Type is Extended or Manual
     C           WUV8ST    IFEQ 'X'                        *IF
     C           WUV8ST    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TOCD    ZA0001           Price Method De
      * Send message 'Price Meth Invalid-Cr/Dr'
     C                     MOVEL'USR1971' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV Prc MthTyp,Dsc-Sys RT - PD Price Method Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0021           Company Number
     C                     MOVEL#1TPCD    WL0022    P      Price Method Co
     C                     MOVEL'O'       WL0025    P      System Using Pr
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    #DAWNA    P      Price Method De
     C                     MOVELWL0024    WUV8ST    P      Price Method Ty
      * Validate D/M default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: WRK.Price Method Type is Extended or Manual
     C           WUV8ST    IFEQ 'X'                        *IF
     C           WUV8ST    OREQ 'M'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1TPCD    ZA0002           Price Method De
      * Send message 'Price Meth Invalid-Cr/Dr'
     C                     MOVEL'USR1971' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,39           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Carrier
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,41
     C                     SETON                     99    *
     C                     END
      * Check reference to Manager Level
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
     C                     END
      * Check reference to Terms
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,31
     C                     SETON                     9931  *
     C                     END
      * Check reference to Terms
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,32
     C                     SETON                     9931  *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I2,38
     C                     SETON                     9931  *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I2,39
     C                     SETON                     9931  *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Vendor terms must be entered if A/P installed
      * CASE: PAR.Accounts Payable Status is yes
     C           P4AKST    IFEQ 'Y'                        *IF
      * CASE: DTL.Vendor Terms Code is blank
     C           #1BSCD    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'A/P installed, must terms'
     C                     MOVEL'USR0349' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Customer terms must be entered if A/R installed
      * CASE: PAR.Accounts Receivable Sts is yes
     C           P4ALST    IFEQ 'Y'                        *IF
      * CASE: DTL.Customer Terms Code is blank
     C           #1IDCD    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'A/R installed, must terms'
     C                     MOVEL'USR0350' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If OP installed, must enter Region
      * CASE: PAR.Order Processing Status is yes
     C           P4CCST    IFEQ 'Y'                        *IF
      * CASE: DTL.Region Code is blanks
     C           #1BFCD    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'O/E installed, sls terr'
     C                     MOVEL'USR0077' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV SR Desc,person     RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0003    P      Sales Route Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUMZNA    P      Sales Route Des
     C                     MOVELWL0005    WUBCCD    P      Salesperson Cod
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUBCCD    WL0006    P      Salesperson Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WUBCCD    P      Salesperson Cod
     C                     MOVELWL0007    #DA7TX    P      Salesperson Nam
      * RTV Terms              RT - Terms  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     MOVEL#1IDCD    WL0009    P      Terms Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DCFNA    P      Description
     C                     MOVELWL0011    WUD3ST    P      Terms Type
      * RTV Terms              RT - Terms  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     MOVEL#1BSCD    WL0009    P      Terms Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DCGNA    P      Description
     C                     MOVELWL0011    WUD3ST    P      Terms Type
      * RTV Manager Descript   RT - Manager Level  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BFCD    WL0012    P      Manager Level C
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    #DDCNA    P      Description
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0014    P      Carrier Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    #DADTX    P      Name
     C                     MOVELWL0016    WUG0TX    P      Record Status
      * Process F11=Purge
      * CASE: DTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
     C                     MOVEL'D'       #1VSST           Record Status
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Contract Status required
     C           #1A3ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,36
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Catch Weight Status required
     C           #1AVST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Sales Route Code required
     C           #1R4CD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Record Status required
     C           #1VSST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,43
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C           W0SCR     IFEQ 1
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     WRITE#CMDTXT3
     C                     WRITE#RCDDTL2
     C                     END
     C                     END
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1TOCD' defaulted for 'Price Method Default C/M'.
      * Field '(DTL) #1TPCD' defaulted for 'Price Method Default D/M'.
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
      * CRT Company Defaults   CR - Company Defaults  * 
     C                     EXSR SKCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1TOCD' defaulted for 'Price Method Default C/M'.
      * Field '(DTL) #1TPCD' defaulted for 'Price Method Default D/M'.
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
      * CHG Company Defaults   CH - Company Defaults  * 
     C                     EXSR SLCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YARDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     END
     C           W0SCR     IFNE 2
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           W0PMD     IFEQ 'ADD'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     END
     C                     END
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #DIMNB           USR Customer Nu
     C                     MOVEL*BLANK    #1TOCD           Price Method De
     C                     MOVEL*BLANK    #1TPCD           Price Method De
     C                     MOVEL*BLANK    #1J7NA           Alt Remittance
     C                     MOVEL*BLANK    #1J8NA           Alt Remittance
     C                     MOVEL*BLANK    #1J9NA           Alt Remittance
     C                     MOVEL*BLANK    #1KANA           Alt Remittance
     C                     MOVEL*BLANK    #1LWCD           Alt Remittance
     C                     MOVEL*BLANK    #1EJTX           Alt Remittance
     C                     Z-ADD*ZERO     #1DGPC           Cooler Shrink P
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     MOVEL*BLANK    #1IDCD           Customer Terms
     C                     MOVEL*BLANK    #DCFNA           Customer Terms
     C                     MOVEL*BLANK    #1BSCD           Vendor Terms Co
     C                     MOVEL*BLANK    #DCGNA           Vendor Terms Co
     C                     MOVEL*BLANK    #1J8ST           PO Matching Req
     C                     Z-ADD*ZERO     #1ASVA           Credit Limit
     C                     MOVEL*BLANK    #1AIST           A/R Open Item/B
     C                     MOVEL*BLANK    #DJUNA           USR Description
     C                     MOVEL*BLANK    #1A3ST           Contract Status
     C                     MOVEL*BLANK    #DNANA           Yes/No Descript
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #DNBNA           Yes/No Descript
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #DDCNA           Sales Territory
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #DA7TX           USR Name
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     MOVEL*BLANK    #DHSNA           State Descripti
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     MOVEL*BLANK    #DAWNA           Description Lin
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AQREB9 fields to screen
      *================================================================
     C                     MOVELAQTOCD    #1TOCD           Price Method De
     C                     MOVELAQTPCD    #1TPCD           Price Method De
     C                     MOVELAQJ7NA    #1J7NA           Alt Remittance
     C                     MOVELAQJ8NA    #1J8NA           Alt Remittance
     C                     MOVELAQJ9NA    #1J9NA           Alt Remittance
     C                     MOVELAQKANA    #1KANA           Alt Remittance
     C                     MOVELAQLWCD    #1LWCD           Alt Remittance
     C                     MOVELAQEJTX    #1EJTX           Alt Remittance
     C                     Z-ADDAQDGPC    #1DGPC           Cooler Shrink P
     C                     MOVELAQUVST    #1UVST           EDI Status 1
     C                     MOVELAQUWST    #1UWST           EDI Status 2
     C                     MOVELAQUXST    #1UXST           EDI Status 3
     C                     Z-ADDAQAATM    #1AATM           Job Time
     C                     MOVELAQAYNA    #1AYNA           User Id
     C                     MOVELAQA0NA    #1A0NA           Job Name
     C                     Z-ADDAQAXDT    #1AXDT           Job Date
     C                     Z-ADDAQAIC3    #1AIC3           Company Number
     C                     MOVELAQIDCD    #1IDCD           Customer Terms
     C                     MOVELAQBSCD    #1BSCD           Vendor Terms Co
     C                     MOVELAQJ8ST    #1J8ST           PO Matching Req
     C                     Z-ADDAQASVA    #1ASVA           Credit Limit
     C                     MOVELAQAIST    #1AIST           A/R Open Item/B
     C                     MOVELAQA3ST    #1A3ST           Contract Status
     C                     MOVELAQAVST    #1AVST           Catch Weight St
     C                     MOVELAQBFCD    #1BFCD           Manager Level C
     C                     MOVELAQB6NA    #1B6NA           Special Instruc
     C                     MOVELAQBYNA    #1BYNA           Special Instruc
     C                     MOVELAQBZNA    #1BZNA           Carrier Code
     C                     MOVELAQR4CD    #1R4CD           Sales Route Cod
     C                     MOVELAQVSST    #1VSST           Record Status
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
      * USER: Initialize key screen
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * RTV Installation Qst   RT - System Control  * 
     C                     EXSR SMRVGN
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV SR Desc,person     RT - PD Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0003    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSB     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Sales Route Des
     C                     MOVEL*BLANK    WL0005           Salesperson Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEMZNA    WL0004           Sales Route Des
     C                     MOVELJEBCCD    WL0005           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0006    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSC     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Salesperson Cod
     C                     MOVEL*BLANK    WL0007           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    WL0006           Salesperson Cod
     C                     MOVELAPALTX    WL0007           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Terms              RT - Terms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADDWL0008    AOAIC3           Company Number
     C                     MOVELWL0009    AOAQCD           Terms Code
      * Establish starting position
     C           KRSSD     CHAIN@AOREB3              90    *
      * Data record not found
     C   90                MOVEL'USR0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOAUNA    WL0010           Description
     C                     MOVELAOD3ST    WL0011           Terms Type
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Manager Descript   RT - Manager Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVELWL0012    ALBFCD           Manager Level C
      * Establish starting position
     C           KRSSE     CHAIN@ALREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           Description
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELALAUNA    WL0013           Description
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0014    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSF     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0015           Name
     C                     MOVEL*BLANK    WL0016           Record Status
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0015           Name
     C                     MOVELFFVSST    WL0016           Record Status
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Active Description RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELAQLWCD    ACBGCD           State Code
      * Establish starting position
     C           KRSSG     CHAIN@ACRET7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DHSNA           Description
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    #DHSNA           Description
     C                     MOVELACVSST    WUG0TX           Record Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IHQ7CD    WQSH01           Price Method Co
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Price Method Co
      * Setup key
     C                     MOVELWL0017    WQSH01           Price Method Co
      * Establish starting position
     C           KRSSH     SETLL@IHREU4                    *
     C           KRSSH     READE@IHREU4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0018           Price Method De
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHMLNA    WL0018           Price Method De
     C           KRSSH     READE@IHREU4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Text Value         RT - System Values  * Contract Status
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVELWL0019    DPDOCD           System Value Co
      * Establish starting position
     C           KRSSI     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELDPBXTX    WL0020           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Prc MthTyp,Dsc-Sys RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBYST    WQSJ01           System Using Pr
     C           *LIKE     DEFN WBAIC3    WQSJ02           Company Number
     C           *LIKE     DEFN WBQ7CD    WQSJ03           Price Method Co
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           System Using Pr
     C                     KFLD           WQSJ02           Company Number
     C                     KFLD           WQSJ03           Price Method Co
      * Setup key
     C                     MOVELWL0025    WQSJ01           System Using Pr
     C                     Z-ADDWL0021    WQSJ02           Company Number
     C                     MOVELWL0022    WQSJ03           Price Method Co
      * Establish starting position
     C           KRSSJ     SETLL@IHREFI                    *
     C           KRSSJ     READE@IHREFI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0023           Price Method De
     C                     MOVEL*BLANK    WL0024           Price Method Ty
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBMLNA    WL0023           Price Method De
     C                     MOVELWBV8ST    WL0024           Price Method Ty
     C           KRSSJ     READE@IHREFI                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT Company Defaults   CR - Company Defaults  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AQREB2
     C                     Z-ADD#1AIC3    AQAIC3           Company Number
     C                     Z-ADD#1ASVA    AQASVA           Credit Limit
     C                     MOVEL#1AIST    AQAIST           A/R Open Item/B
     C                     MOVEL#1A3ST    AQA3ST           Contract Status
     C                     MOVEL#1AVST    AQAVST           Catch Weight St
     C                     MOVEL#1BYNA    AQBYNA           Special Instruc
     C                     MOVEL#1B6NA    AQB6NA           Special Instruc
     C                     MOVEL#1BZNA    AQBZNA           Carrier Code
     C                     MOVEL#1J8ST    AQJ8ST           PO Matching Req
     C                     MOVEL#1J7NA    AQJ7NA           Alt Remittance
     C                     MOVEL#1J8NA    AQJ8NA           Alt Remittance
     C                     MOVEL#1J9NA    AQJ9NA           Alt Remittance
     C                     MOVEL#1KANA    AQKANA           Alt Remittance
     C                     MOVEL#1LWCD    AQLWCD           Alt Remittance
     C                     MOVEL#1EJTX    AQEJTX           Alt Remittance
     C                     Z-ADD#1DGPC    AQDGPC           Cooler Shrink P
     C                     MOVEL#1BFCD    AQBFCD           Manager Level C
     C                     MOVEL#1IDCD    AQIDCD           Customer Terms
     C                     MOVEL#1BSCD    AQBSCD           Vendor Terms Co
     C                     MOVEL#1TOCD    AQTOCD           Price Method De
     C                     MOVEL#1TPCD    AQTPCD           Price Method De
     C                     MOVEL#1R4CD    AQR4CD           Sales Route Cod
     C                     MOVEL#1UVST    AQUVST           EDI Status 1
     C                     MOVEL#1UWST    AQUWST           EDI Status 2
     C                     MOVEL#1UXST    AQUXST           EDI Status 3
     C                     MOVEL#1VSST    AQVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) AQAATM' defaulted for 'Job Time'.
      * Field '(DB1) AQAYNA' defaulted for 'User Id'.
      * Field '(DB1) AQA0NA' defaulted for 'Job Name'.
      * Field '(DB1) AQAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     AQAATM           Job Time
     C                     MOVEL##USR     AQAYNA           User Id
     C                     MOVEL##JOB     AQA0NA           Job Name
     C                     Z-ADD##JDT     AQAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           AQAIC3           Company Number
      * Check for duplicate primary key
     C           KLCRSK    SETLL@AQREB2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0042' W0RTN   7
      * Send message 'Company Defaults       EX'
     C                     MOVEL'USR0042' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@AQREB2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG Company Defaults   CH - Company Defaults  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  60       Job Time
     C                     MOVEL*BLANK    WN0006 10        User Id
     C                     MOVEL*BLANK    WN0007 10        Job Name
     C                     Z-ADD*ZERO     WN0008  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AQREB2
     C                     Z-ADD#1AIC3    AQAIC3           Company Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           AQAIC3           Company Number
     C           KLCHSL    CHAIN@AQREB2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAAQREL0'MDACP
     C                     MOVEL'@AQREB2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKCAAQREL0               91  *
     C                     GOTO SLEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @AQREB2
     C                     Z-ADD#1ASVA    AQASVA           Credit Limit
     C                     MOVEL#1AIST    AQAIST    P      A/R Open Item/B
     C                     MOVEL#1A3ST    AQA3ST    P      Contract Status
     C                     MOVEL#1AVST    AQAVST    P      Catch Weight St
     C                     MOVEL#1BYNA    AQBYNA    P      Special Instruc
     C                     MOVEL#1B6NA    AQB6NA    P      Special Instruc
     C                     MOVEL#1BZNA    AQBZNA    P      Carrier Code
     C                     MOVEL#1J8ST    AQJ8ST    P      PO Matching Req
     C                     MOVEL#1J7NA    AQJ7NA    P      Alt Remittance
     C                     MOVEL#1J8NA    AQJ8NA    P      Alt Remittance
     C                     MOVEL#1J9NA    AQJ9NA    P      Alt Remittance
     C                     MOVEL#1KANA    AQKANA    P      Alt Remittance
     C                     MOVEL#1LWCD    AQLWCD    P      Alt Remittance
     C                     MOVEL#1EJTX    AQEJTX    P      Alt Remittance
     C                     Z-ADD#1DGPC    AQDGPC           Cooler Shrink P
     C                     MOVEL#1BFCD    AQBFCD    P      Manager Level C
     C                     MOVEL#1IDCD    AQIDCD    P      Customer Terms
     C                     MOVEL#1BSCD    AQBSCD    P      Vendor Terms Co
     C                     MOVEL#1TOCD    AQTOCD    P      Price Method De
     C                     MOVEL#1TPCD    AQTPCD    P      Price Method De
     C                     MOVEL#1R4CD    AQR4CD    P      Sales Route Cod
     C                     MOVEL#1UVST    AQUVST    P      EDI Status 1
     C                     MOVEL#1UWST    AQUWST    P      EDI Status 2
     C                     MOVEL#1UXST    AQUXST    P      EDI Status 3
     C                     MOVEL#1VSST    AQVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) AQAATM' defaulted for 'Job Time'.
      * Field '(DB1) AQAYNA' defaulted for 'User Id'.
      * Field '(DB1) AQA0NA' defaulted for 'Job Name'.
      * Field '(DB1) AQAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     AQAATM           Job Time
     C                     MOVEL##USR     AQAYNA           User Id
     C                     MOVEL##JOB     AQA0NA           Job Name
     C                     Z-ADD##JDT     AQAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AQREB2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAAQREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Installation Qst   RT - System Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           AABRCD           System Control
      * Setup key
     C                     MOVEL'GY'      AABRCD           System Control
      * Establish starting position
     C           KRSSM     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'USR0001' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAABRST    P4BRST           Inventory Statu
     C                     MOVELAACCST    P4CCST           Order Processin
     C                     MOVELAADHST    WUDHST           Sales Analysis
     C                     MOVELAAC9ST    P4C9ST           Purchasing Stat
     C                     MOVELAABNST    P4BNST           General Ledger
     C                     MOVELAAAKST    P4AKST           Accounts Payabl
     C                     MOVELAAALST    P4ALST           Accounts Receiv
     C                     MOVELAACNST    WUCNST           Payroll Status
     C                     MOVELAADKST    WUDKST           Serialized Inve
     C                     MOVELAADRST    WUDRST           Single Level Ki
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0009    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0001           Company Number
     C                     MOVELDRBUVN    WN0010           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0026    DTAJVN           User Profile Na
     C                     MOVELWL0027    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0028           Company Number
     C                     MOVELDTAJCD    WL0029           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSP01           Application Cod
     C                     MOVEL'C/S'     WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVAWA    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0004  3        Carrier Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWC    KLIST
     C                     KFLD           WCBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    WCBZNA
     C           KLVBWC    CHAIN@FFREUG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Manager Level C
     C           YPMTFD    OREQ '#1BFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                     CALL 'CABRSRR'              90  SEL Manager Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1BFCD    PARM #1BFCD    WQ0005  2        Manager Level C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     END
      *
     C           #1BFCD    IFNE *BLANK                     Manager Level C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BFCD    IFEQ *BLANK                     Manager Level C
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWD    KLIST
     C                     KFLD           WDBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    WDBFCD
     C           KLVCWD    CHAIN@ALREVE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Manager Level          NF'
     C                     MOVEL'USR0030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0030' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1IDCD    WK1X02  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1IDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1IDCD' defaulted for 'Customer Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0006  30       Company Number
     C           #1IDCD    PARM #1IDCD    WQ0007  2        Terms Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1IDCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1IDCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     MOVEL#1IDCD    WEAQCD
     C           KLVDWE    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BSCD    WK1X02  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1BSCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1BSCD' defaulted for 'Vendor Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0008  30       Company Number
     C           #1BSCD    PARM #1BSCD    WQ0009  2        Terms Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BSCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BSCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     MOVEL#1BSCD    WEAQCD
     C           KLVEWE    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1TOCD    WK1X02  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1TOCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1TOCD' defaulted for 'Price Method Default C/M'.
     C                     CALL 'PDPTSRR'              90  SEL Man,Ext Typ
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0010  30       Company Number
     C           #1TOCD    PARM #1TOCD    WQ0011  3        Price Method Co
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1TOCD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1TOCD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    WFAIC3
     C                     MOVEL#1TOCD    WFQ7CD
     C           KLVFWF    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1TPCD    WK1X02  1
     C           YPMTFD    IFEQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1TPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1TPCD' defaulted for 'Price Method Default D/M'.
     C                     CALL 'PDPTSRR'              90  SEL Man,Ext Typ
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0012  30       Company Number
     C           #1TPCD    PARM #1TPCD    WQ0013  3        Price Method Co
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1TPCD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1TPCD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    WFAIC3
     C                     MOVEL#1TPCD    WFQ7CD
     C           KLVGWF    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0014  3        Sales Route Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,42           *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVHJE    CHAIN@JEREWF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW2END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW2BEG,F
     C                     MOVELW2NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE021
     C           ZHCSCL    ANDLE023
     C           @#DFMT    ANDEQ'#RCDKEY'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1IDCD'  YPMTFD           Customer Terms
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BSCD'  YPMTFD           Vendor Terms Co
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1J8ST'  YPMTFD           PO Matching Req
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AIST'  YPMTFD           A/R Open Item/B
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1A3ST'  YPMTFD           Contract Status
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1AVST'  YPMTFD           Catch Weight St
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BFCD'  YPMTFD           Manager Level C
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1BZNA'  YPMTFD           Carrier Code
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1R4CD'  YPMTFD           Sales Route Cod
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1VSST'  YPMTFD           Record Status
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1TOCD'  YPMTFD           Price Method De
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1TPCD'  YPMTFD           Price Method De
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P2VSST           Record Status
     C                     MOVEL*BLANK    P3GGST           USR Display fie
     C                     MOVEL*BLANK    P4BRST           Inventory Statu
     C                     MOVEL*BLANK    P4CCST           Order Processin
     C                     MOVEL*BLANK    P4C9ST           Purchasing Stat
     C                     MOVEL*BLANK    P4BNST           General Ledger
     C                     MOVEL*BLANK    P4AKST           Accounts Payabl
     C                     MOVEL*BLANK    P4ALST           Accounts Receiv
     C                     MOVEL*BLANK    P5A7TX           USR Name
     C                     MOVEL*BLANK    P6G3TX           PRT Description
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     Z-ADD*ZERO     P6DYNB           PRT Number of C
     C                     MOVEL*BLANK    P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P7M8NB           System Value Nu
     C                     Z-ADD*ZERO     P8AJAA           Company Number
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Sales Route Description
     C                     MOVEL*BLANK    WUMZNA 30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Terms Type
     C                     MOVEL*BLANK    WUD3ST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR Search Request
     C                     MOVEL*BLANK    WUELST  1
      * Define work field Price Method Type
     C                     MOVEL*BLANK    WUV8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBRMNY           Decimal Places
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WCEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WCNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WCNSVA           Long hook balan
     C                     Z-ADD*ZERO     WCNTVA           Short hook bala
     C                     Z-ADD*ZERO     WCNUVA           Tub Balance
     C                     Z-ADD*ZERO     WCS8NB           Home Phone
     C                     Z-ADD*ZERO     WCS9NB           Other Phone
     C                     Z-ADD*ZERO     WCNMVA           Flat Rate
     C                     Z-ADD*ZERO     WCNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WCNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WCNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WCQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WCRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WCB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WCAAC7           Contact Number
     C                     Z-ADD*ZERO     WCTENO           Carrier Unused
     C                     Z-ADD*ZERO     WCAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WCAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WCKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEANDY           Net Due Days
     C                     Z-ADD*ZERO     WEAKDY           Discount Due Da
     C                     Z-ADD*ZERO     WEA4PC           Terms Discount
     C                     Z-ADD*ZERO     WEAJDY           Cutoff Day
     C                     Z-ADD*ZERO     WECUNB           Months to add b
     C                     Z-ADD*ZERO     WEALDY           Disc. Due Day b
     C                     Z-ADD*ZERO     WEAPDY           Net Due Day bef
     C                     Z-ADD*ZERO     WECTNB           Months to add a
     C                     Z-ADD*ZERO     WEAMDY           Disc. Due Day a
     C                     Z-ADD*ZERO     WEAQDY           Net Due Day aft
     C                     Z-ADD*ZERO     WEASDT           Discount Due Da
     C                     Z-ADD*ZERO     WEATDT           Due Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * CRT Company Defaults   CR - Company Defaults  * 
     C                     Z-ADD*ZERO     AQAATM           Job Time
     C                     Z-ADD*ZERO     AQAXDT           Job Date
      * Define work field Sales Analysis Status
     C                     MOVEL*BLANK    WUDHST  1
      * Define work field Payroll Status
     C                     MOVEL*BLANK    WUCNST  1
      * Define work field Serialized Inventory Sts
     C                     MOVEL*BLANK    WUDKST  1
      * Define work field Single Level Kit Status
     C                     MOVEL*BLANK    WUDRST  1
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  3
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  2
     C                     MOVEL*BLANK    WL0010 30
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013 30
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015 30
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018 30
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0019 10
     C                     MOVEL*BLANK    WL0020 40
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023 30
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0026 10
     C                     MOVEL*BLANK    WL0027  6
     C                     Z-ADD*ZERO     WL0028  30
     C                     MOVEL*BLANK    WL0029  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0002  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0009 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0009           User Profile Na
      *
     C                     MOVEL*BLANK    WN0010 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0009    ZA0003           User Profile Na
     C                     MOVEL'C/S'     ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0010    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0009    WL0026    P      User Profile Na
     C                     MOVEL'C/S'     WL0027    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    P1AIC3           Company Number
     C                     MOVELWL0029    YL0002    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0026    P      User Profile Na
     C                     MOVEL'C/S'     WL0027    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    P1AIC3           Company Number
     C                     MOVELWL0029    YL0002    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0002    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0009    ZA0005           User Profile Na
     C                     MOVEL'C/S'     ZA0006           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0001    IFNE *ZERO                      *IF
     C                     Z-ADDYL0001    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0002    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0015  3        Warehouse Code
     C                     PARM YL0001    WQ0016  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P3GGST           USR Display fie
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
01045
** W0END
01047
** W0NAM
V1AIC3
** W1BEG
01045010500156801574018240183002080
02336025920259902848028550310403111
03360033670361603872041280413504384
043910489604903
** W1END
01047010790156901603018250185902080
02348025920261302848028580310403114
03361033960365503911041300416404386
044200489604914
** W1NAM
V1AIC3    #DAGTX    #1IDCD    #DCFNA    #1BSCD    #DCGNA    #1J8ST
#1ASVA    #1AIST    #DJUNA    #1A3ST    #DNANA    #1AVST    #DNBNA
#1BFCD    #DDCNA    #1B6NA    #1BYNA    #1BZNA    #DADTX    #1R4CD
#DA7TX    #1VSST    #DHKNA
** W2BEG
01056013120156801824020800208602336
0259203104031110336003367
** W2END
01085013410159701843020810211502346
0259703106031400336203396
** W2NAM
#1J7NA    #1J8NA    #1J9NA    #1KANA    #1LWCD    #DHSNA    #1EJTX
#1DGPC    #1TOCD    #DAUNA    #1TPCD    #DAWNA
