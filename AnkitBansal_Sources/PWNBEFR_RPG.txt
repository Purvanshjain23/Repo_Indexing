     H/TITLE Chg Hd Rcvd for Repay EF  Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 01/20/22  Time  : 11:23:53
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPWNBEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Chg Hd Rcvd for Repay EF  Edit file
      *
     FPKA2CPLMIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Tattoo Detail             Co/BO/Ld/KillDt/Tto/Seq
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPWAXCPL1IF  E           K        DISK
      * RTV : Tattoo Repayment Detail   Retrieval index
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKBXREL1IF  E           K        DISK
      * RTV : Tattoo Detail Process     Retrieval index
      *
     FPWAYCPL3IF  E           K        DISK
      * RSQ : Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPWAYCPL0IF  E           K        DISK                      A
      * UPD : Tattoo Repayment Comment  Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@AXCPAX
      * Tattoo Repayment Detail   Retrieval index
      * Renamed input format fields
     I              AXHONB                          WAHONB
     I              AXCDNZ                          WACDNZ
     I              AXHMNB                          WAHMNB
     I              AXBNNB                          WABNNB
     I              AXBONB                          WABONB
     I              AXCVNB                          WACVNB
     I              AXB0DT                          WAB0DT
     I              AXCGNZ                          WACGNZ
     I              AXCENZ                          WACENZ
     I              AXCFNZ                          WACFNZ
     I              AXIIDT                          WAIIDT
     I              AXTOCD                          WATOCD
     I              AXTPCD                          WATPCD
     I              AXINT1                          WAINT1
     I              AXMCSS                          WAMCSS
     I              AXC1NZ                          WAC1NZ
     I              AXMZSS                          WAMZSS
     I              AXTNCD                          WATNCD
     I              AXABCD                          WAABCD
     I              AXNYCD                          WANYCD
     I              AXNASS                          WANASS
     I              AXAACD                          WAAACD
     I              AXAECD                          WAAECD
     I              AXAKCD                          WAAKCD
     I              AXALCD                          WAALCD
     I              AXAAVN                          WAAAVN
     I              AXAADT                          WAAADT
     I              AXAMTM                          WAAMTM
     I              AXAJST                          WAAJST
     I              AXAHVN                          WAAHVN
     I              AXAGVN                          WAAGVN
     I              AXABVN                          WAABVN
     I              AXABDT                          WAABDT
     I              AXABTM                          WAABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     I@AYCPA6
      * Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      * Renamed input format fields
     I              AYHONB                          WDHONB
     I              AYCDNZ                          WDCDNZ
     I              AYCINZ                          WDCINZ
     I              AYHMNB                          WDHMNB
     I              AYBNNB                          WDBNNB
     I              AYBONB                          WDBONB
     I              AYCVNB                          WDCVNB
     I              AYB0DT                          WDB0DT
     I              AYG7T1                          WDG7T1
     I              AYMKSS                          WDMKSS
     I              AYAAVN                          WDAAVN
     I              AYAADT                          WDAADT
     I              AYAMTM                          WDAMTM
     I              AYAJST                          WDAJST
     I              AYAHVN                          WDAHVN
     I              AYAGVN                          WDAGVN
     I              AYABVN                          WDABVN
     I              AYABDT                          WDABDT
     I              AYABTM                          WDABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Current/previous master file format fields for change control
      *
     IYARDCS      DS                            133
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     IYBRDCS      DS                            583
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     IYCRDCS      DS                            237
     IQPWAY1    E DSPWAYCPL0
      * UPD : Tattoo Repayment Comment  Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Detail
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : RST TH Kill Date
     I                                    P  13  160P1B0DT
     IP2PARM      DS
      * FLD: Tattoo Header
      * N :  TH Head Received
     I                                    P   1   30P2CWNB
      * N : MAP TH Payment Sts
     I                                        4   5 P2CWST
      * N : MAP TH Held Over Record
     I                                        6   6 P2E1ST
      * N : MAP TH Held/Ovr Completed Dte
     I                                    P   7  100P2BSDT
      * N : MAP TH Hog Class Type
     I                                       11  11 P2LLST
      * N : MAP PD Producer Code
     I                                       12  17 P2ABCD
      * N : MAP PL Location Code
     I                                       18  23 P2AECD
     IP3PARM      DS
      * FLD: Buy Order Load
      * N : MAP BOL Kill Date
     I                                    P   1   40P3CQDT
      * N : MAP BOL Head Received
     I                                    P   5   80P3DHNB
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Tattoo Number Selected
     I                                    P   1   30P4A7NZ
      * N :  Kill Date Selected
     I                                    P   4   70P4H6DT
     IP5PARM      DS
      * FLD: Tattoo Repayment Detail
      * I :  CC Company Number
     I                                    P   1   20P5HONB
      * I :  TRH Repayment ID
     I                                    P   3   50P5CDNZ
      * I :  TRD Pen Head
     I                                    P   6   80P5C1NZ
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P5HONB    PARM           WP0006  30       CC Company Numb
     C           P5CDNZ    PARM           WP0007  50       TRH Repayment I
     C           P5C1NZ    PARM           WP0008  50       TRD Pen Head
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
     C                     Z-ADDP5CDNZ    #CCDNZ           TRH Repayment I
     C                     Z-ADDP1B0DT    #CCGDT           Kill Date Usr
     C                     Z-ADDP1CVNB    #CKENB           Tattoo Number U
      * Retrieve the current Head Received values
      * Rtv Buy Order Load    RT - Buy Order Load  * BOL Head Received
     C                     EXSR SARVGN
     C                     Z-ADD*ZERO     #CBDNZ           Head Rcvd 1
      * RMC ADDED KILL DATE RST HERE
      * Rtv Hd Rcvd for Repay RT - Tattoo Header  * TH Head Rcvd
     C                     EXSR SBRVGN
      * Position to the first Tattoo for the Company, Buy Order, and Load
     C                     Z-ADD*ZERO     #CA5NZ           Calc BOL Head R
     C                     Z-ADD*ZERO     #CA4NZ           Calc Head Rcvd
     C                     END
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADD#2HMNB    A2HMNB
     C                     Z-ADD#2BNNB    A2BNNB
     C                     Z-ADD#2BONB    A2BONB
     C                     Z-ADD#2B0DT    A2B0DT
     C                     Z-ADD#2CVNB    A2CVNB
     C                     Z-ADD#2C2NB    A2C2NB
      * 82=EOF
     C           KPOS      SETLL@A2CPZK              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#2HMNB    A2HMNB
     C                     Z-ADD#2BNNB    A2BNNB
     C                     Z-ADD#2BONB    A2BONB
     C                     Z-ADD#2B0DT    A2B0DT
     C  N82      KRST      READE@A2CPZK                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@A2CPZK                  90*
     C  N82                READ @A2CPZK                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  1
     C                     MOVE *ALL'1'   WKIND1  1
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
      * Rtv Tattoo Repay Dtl  RT - Tattoo Repayment Detail  * Original
     C                     EXSR SCRVGN
     C                     Z-ADD#1C0NB    #RCZNZ           Pen Head - Curr
      * Initially load New Head from Current Head
     C                     Z-ADD#1C0NB    #RC0NZ           Pen Head - New
      * Protect New Pen Head field if Tattoo Numbers do not match
      * CASE: RCD.TH Tattoo Number NE CTL.Tattoo Number USR
     C           #1CVNB    IFNE #CKENB                     *IF
     C                     MOVEL'Y'       #RKSSS           Protect field
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RKSSS           Protect field
     C                     END                             *FI
     C                     MOVEL'1'       *IN84            *Re-read Subfil
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C           KRST      READE@A2CPZK                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN89     IFNE CAIN89
     C           *IN81     ORNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN89     CAIN89  1
     C                     MOVE *IN81     CAIN81  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
      * Initial flag that signifies that a Pen Head was changed
     C                     MOVEL'N'       YL0003           Update Flag
      * Initialize the new Tattoo Header and Buy Order Load screen fields
     C                     Z-ADD#CBDNZ    #CA4NZ           Calc Head Rcvd
     C                     Z-ADD#CA9NZ    #CA5NZ           Calc BOL Head R
      * Initialize BOL Head Received accumulator
     C                     Z-ADD*ZERO     YL0004           Calc BOL Head R
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Determine difference between original value and new value
     C           #RC0NZ    SUB  #RCZNZ    #RXXNB           DIFF Total Head
      * Accumulate Tattoo Header and BOL values for Head Received
     C                     ADD  #RXXNB    #CA5NZ           Calc BOL Head R
     C                     ADD  #RXXNB    #CA4NZ           Calc Head Rcvd
      * Set update flag so confirmation prompt will display
     C                     MOVEL'Y'       YL0003           Update Flag
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Tattoo Header
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Pen
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Tattoo Detail Process
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Pen
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * Determine confirm prompt Y/N
      * CASE: LCL.Update Flag is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Force PUTOVR
     C                     SETON                     86
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Hd Rcvd for Repay CH - Tattoo Detail  * 
     C                     EXSR SDCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL'0'       *IN79
     C           #1B9CD    IFNE 'K'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL*IN87     *IN78
     C           #RKSSS    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #1CZNB           TD Live Wgt
     C                     Z-ADD*ZERO     #1C0NB           TD Pen Head
     C                     Z-ADD*ZERO     #RXXNB           DIFF Total Head
     C                     MOVEL*BLANK    #RL9ST           Display Output
     C                     MOVEL*BLANK    #1GGST           TD Held Over St
     C                     Z-ADD*ZERO     #1AJTM           TD Drive Time
     C                     Z-ADD*ZERO     #1JEA1           TD Drive Hour
     C                     Z-ADD*ZERO     #1B7CD           TD Drive Card N
     C                     Z-ADD*ZERO     #1D7NB           TD Avg Live Wgt
     C                     MOVEL*BLANK    #1D9ST           TD Gen Bal To K
     C                     MOVEL*BLANK    #1E3ST           TD Recs Created
     C                     MOVEL*BLANK    #1E4ST           TD User Status
     C                     MOVEL*BLANK    #1E5ST           TD User Status
     C                     Z-ADD*ZERO     #1BVDT           TD User Date 1
     C                     Z-ADD*ZERO     #1BWDT           TD User Date 2
     C                     Z-ADD*ZERO     #1BXDT           TD Drive Date
     C                     Z-ADD*ZERO     #1HVNB           Pen Company Num
     C                     Z-ADD*ZERO     #1H8NB           Held Over Pen C
     C                     MOVEL*BLANK    #RKSSS           Protect field
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #1C2NB           TD Sequence Num
     C                     Z-ADD*ZERO     #RCYNZ           Pen Head - Orig
     C                     Z-ADD*ZERO     #RCZNZ           Pen Head - Curr
     C                     Z-ADD*ZERO     #RC0NZ           Pen Head - New
     C                     Z-ADD*ZERO     #1D8NB           TD Yard Dead
     C                     Z-ADD*ZERO     #1H7NB           TD Held Over
     C                     MOVEL*BLANK    #1CMCD           Pen Number
     C                     MOVEL*BLANK    #1CYCD           Held Over Pen N
     C                     MOVEL*BLANK    #1B9CD           TDP Process Cod
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A2CPZK fields to subfile
      *================================================================
     C                     Z-ADDA2HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDA2BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #1BONB           BOL Load Number
     C                     Z-ADDA2CZNB    #1CZNB           TD Live Wgt
     C                     Z-ADDA2C0NB    #1C0NB           TD Pen Head
     C                     MOVELA2GGST    #1GGST           TD Held Over St
     C                     Z-ADDA2AJTM    #1AJTM           TD Drive Time
     C                     Z-ADDA2JEA1    #1JEA1           TD Drive Hour
     C                     Z-ADDA2B7CD    #1B7CD           TD Drive Card N
     C                     Z-ADDA2D7NB    #1D7NB           TD Avg Live Wgt
     C                     MOVELA2D9ST    #1D9ST           TD Gen Bal To K
     C                     MOVELA2E3ST    #1E3ST           TD Recs Created
     C                     MOVELA2E4ST    #1E4ST           TD User Status
     C                     MOVELA2E5ST    #1E5ST           TD User Status
     C                     Z-ADDA2BVDT    #1BVDT           TD User Date 1
     C                     Z-ADDA2BWDT    #1BWDT           TD User Date 2
     C                     Z-ADDA2BXDT    #1BXDT           TD Drive Date
     C                     Z-ADDA2HVNB    #1HVNB           Pen Company Num
     C                     Z-ADDA2H8NB    #1H8NB           Held Over Pen C
     C                     MOVELA2AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA2AADT    #1AADT           RS Date Changed
     C                     Z-ADDA2AMTM    #1AMTM           RS Time Changed
     C                     MOVELA2AJST    #1AJST           RS Record Statu
     C                     MOVELA2AHVN    #1AHVN           RS Job
     C                     MOVELA2AGVN    #1AGVN           RS Program
     C                     MOVELA2ABVN    #1ABVN           RS User Added
     C                     Z-ADDA2ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA2ABTM    #1ABTM           RS Time Added
     C                     Z-ADDA2B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA2CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA2C2NB    #1C2NB           TD Sequence Num
     C                     Z-ADDA2D8NB    #1D8NB           TD Yard Dead
     C                     Z-ADDA2H7NB    #1H7NB           TD Held Over
     C                     MOVELA2CMCD    #1CMCD           Pen Number
     C                     MOVELA2CYCD    #1CYCD           Held Over Pen N
     C                     MOVELA2B9CD    #1B9CD           TDP Process Cod
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP3CQDT    #PCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     #CHONB           CC Company Numb
     C                     MOVELP2E1ST    #PE1ST           TH Held Over Re
     C                     Z-ADDP2BSDT    #PBSDT           TH Held/Ovr Com
     C                     Z-ADDP1B0DT    #2B0DT           TH Kill Date
     C                     Z-ADDP1CVNB    #2CVNB           TH Tattoo Numbe
     C                     Z-ADDP3DHNB    #PDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     #2C2NB           TD Sequence Num
     C                     Z-ADD*ZERO     #CCDNZ           TRH Repayment I
     C                     Z-ADDP1HMNB    #2HMNB           BOH Company Num
     C                     MOVELP2ABCD    #PABCD           PD Producer Cod
     C                     MOVELP2AECD    #PAECD           PL Location Cod
     C                     Z-ADDP1BNNB    #2BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #2BONB           BOL Load Number
     C                     Z-ADD*ZERO     #CCGDT           Kill Date Usr
      * Clear external version also
     C                     Z-ADD*ZERO     VCCGDT
     C                     Z-ADD*ZERO     #CA9NZ           BOL Head Receiv
     C                     Z-ADD*ZERO     #CA5NZ           Calc BOL Head R
     C                     Z-ADD*ZERO     #CKENB           Tattoo Number U
     C                     Z-ADD*ZERO     #CBDNZ           Head Rcvd 1
     C                     Z-ADD*ZERO     #CA4NZ           Calc Head Rcvd
     C                     MOVELP2CWST    #PCWST           TH Payment Sts
     C                     MOVELP2LLST    #PLLST           TH Hog Class Ty
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Kill Date Usr to display format
      * Convert date
     C           1000000   ADD  #CCGDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCCGDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load    RT - Buy Order Load  * BOL Head Received
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSA     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXCQDT    YL0001           BOL Kill Date
     C                     Z-ADDAXDHNB    #CA9NZ           BOL Head Receiv
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Hd Rcvd for Repay RT - Tattoo Header  * TH Head Rcvd
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0002           Head Rcvd 1
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    A1BONB           BOL Load Number
     C                     Z-ADDP1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#2B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CBDNZ           Head Rcvd 1
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     ADD  A1CWNB    YL0002           Head Rcvd 1
     C                     ENDIF
      * USER: Exit processing
     C                     Z-ADDYL0002    #CBDNZ           Head Rcvd 1
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Repay Dtl  RT - Tattoo Repayment Detail  * Original
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WACDNZ           TRH Repayment I
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP5HONB    WAHONB           CC Company Numb
     C                     Z-ADDP5CDNZ    WACDNZ           TRH Repayment I
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
     C                     Z-ADD#1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSC     CHAIN@AXCPAX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1566' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RCYNZ           TRD Pen Head
     C                     MOVEL*BLANK    #PABCD           PD Producer Cod
     C                     MOVEL*BLANK    #PAECD           PL Location Cod
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAC1NZ    #RCYNZ           TRD Pen Head
     C                     MOVELWAABCD    #PABCD           PD Producer Cod
     C                     MOVELWAAECD    #PAECD           PL Location Cod
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Hd Rcvd for Repay CH - Tattoo Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  71       TD Live Wgt
     C                     Z-ADD*ZERO     WN0002  50       TD Yard Dead
     C                     Z-ADD*ZERO     WN0003  50       TD Held Over
     C                     MOVEL*BLANK    WN0004  1        TD Held Over St
     C                     Z-ADD*ZERO     WN0005  60       TD Drive Time
     C                     Z-ADD*ZERO     WN0006  20       TD Drive Hour
     C                     Z-ADD*ZERO     WN0007  30       TD Drive Card N
     C                     Z-ADD*ZERO     WN0008  51       TD Avg Live Wgt
     C                     MOVEL*BLANK    WN0009  1        TD Gen Bal To K
     C                     MOVEL*BLANK    WN0010  1        TD Recs Created
     C                     MOVEL*BLANK    WN0011  1        TD User Status
     C                     MOVEL*BLANK    WN0012  1        TD User Status
     C                     Z-ADD*ZERO     WN0013  70       TD User Date 1
     C                     Z-ADD*ZERO     WN0014  70       TD User Date 2
     C                     Z-ADD*ZERO     WN0015  70       TD Drive Date
     C                     Z-ADD*ZERO     WN0016  30       Pen Company Num
     C                     MOVEL*BLANK    WN0017  3        Pen Number
     C                     MOVEL*BLANK    WN0018  6        TDP Process Cod
     C                     Z-ADD*ZERO     WN0019  30       Held Over Pen C
     C                     MOVEL*BLANK    WN0020  3        Held Over Pen N
     C                     MOVEL*BLANK    WN0021 10        RS User Changed
     C                     Z-ADD*ZERO     WN0022  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0023  60       RS Time Changed
     C                     MOVEL*BLANK    WN0024  1        RS Record Statu
     C                     MOVEL*BLANK    WN0025 10        RS Job
     C                     MOVEL*BLANK    WN0026 10        RS Program
     C                     MOVEL*BLANK    WN0027 10        RS User Added
     C                     Z-ADD*ZERO     WN0028  70       RS Date Added
     C                     Z-ADD*ZERO     WN0029  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADD#1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD#1C2NB    A2C2NB           TD Sequence Num
      *
     C           KLCHSD    KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
     C           KLCHSD    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     GOTO SDEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @A2CPDF
     C                     Z-ADD#RC0NZ    A2C0NB           TD Pen Head
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     A2AAVN           RS User Changed
     C                     Z-ADD##JDT     A2AADT           RS Date Changed
     C                     Z-ADD##JTM     A2AMTM           RS Time Changed
     C                     MOVEL##JOB     A2AHVN           RS Job
     C                     MOVEL##PGM     A2AGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Hd Rcvd for Repay CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0030  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0031 10        TH Group Refere
     C                     MOVEL*BLANK    WN0032  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0033  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0034  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0035  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0036  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0037  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0038  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0039  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0040  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0041  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0042  50       TH Held Over
     C                     Z-ADD*ZERO     WN0043  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0044  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0045  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0046  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0047  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0048  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0049  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0050  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0051  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0052  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0053  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0054  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0055  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0056  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0057  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0058  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0059  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0060  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0061  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0062  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0063  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0064  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0065  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0066  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0067  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0068  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0069  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0070  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0071  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0072  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0073  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0074  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0075  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0076  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0077  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0078  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0079  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0080  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0081  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0082  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0083  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0084  1        TH Header Error
     C                     MOVEL*BLANK    WN0085  1        TH Detail Error
     C                     MOVEL*BLANK    WN0086  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0087  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0088  80       TH Commission A
     C                     Z-ADD*ZERO     WN0089  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0090  1        TH User Error O
     C                     MOVEL*BLANK    WN0091  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0092  1        TH Sex
     C                     Z-ADD*ZERO     WN0093  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0094  70       TH Commission P
     C                     Z-ADD*ZERO     WN0095  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0096  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0097  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0098  31       TH FFLI
     C                     Z-ADD*ZERO     WN0099  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0100  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0101  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0102  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0103  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0104  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0105  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0106  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0107  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0108  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0109  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0110  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0111  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0112  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0113  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0114  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0115  1        TH Source Type
     C                     MOVEL*BLANK    WN0116  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0117  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0118  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0119  3        TH Source Code
     C                     MOVEL*BLANK    WN0120  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0121  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0122  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0123  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0124  3        TH State
     C                     MOVEL*BLANK    WN0125  3        TH Unused Code
     C                     MOVEL*BLANK    WN0126  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0127  1        TH Commission S
     C                     MOVEL*BLANK    WN0128  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0129  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0130  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0131  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0132  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0133  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0134  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0135  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0136  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0137  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0138  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0139  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0140  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0141  3        TH PHA Average
     C                     MOVEL*BLANK    WN0142  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0143  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0144  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0145  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0146  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0147  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0148  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0149  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0150  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0151  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0152  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0153  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0154  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0155 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0156 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0157 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0158 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0159  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0160  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0161  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0162  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0163  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0164  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0165  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0166  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0167  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0168  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0169  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0170  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0171  70       TH Unused Date
     C                     MOVEL*BLANK    WN0172  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0173  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0174  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0175  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0176  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0177  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0178  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0179  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0180  6        DF Defect Code
     C                     MOVEL*BLANK    WN0181  6        THP Process Cod
     C                     MOVEL*BLANK    WN0182  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0183  6        PL Location Cod
     C                     MOVEL*BLANK    WN0184  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0185  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0186  3        HC Class Code
     C                     MOVEL*BLANK    WN0187 10        RS User Changed
     C                     Z-ADD*ZERO     WN0188  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0189  60       RS Time Changed
     C                     MOVEL*BLANK    WN0190  1        RS Record Statu
     C                     MOVEL*BLANK    WN0191 10        RS Job
     C                     MOVEL*BLANK    WN0192 10        RS Program
     C                     MOVEL*BLANK    WN0193 10        RS User Added
     C                     Z-ADD*ZERO     WN0194  70       RS Date Added
     C                     Z-ADD*ZERO     WN0195  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDP1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WBBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WBB0DT           TH Kill Date
      *
     C           KLCHSE    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C           KLCHSE    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD#CA4NZ    WBCWNB           TH Head Receive
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Head Rec/Live Wgt RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSF03           BOL Load Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSF03           BOL Load Number
      * Establish starting position
     C           KRSSF     SETLL@A1CPC4                    *
     C           KRSSF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  A1CWNB    YL0005           TH Head Receive
      * CASE: DB1.TH Tattoo Number EQ PAR.TH Tattoo Number
     C           A1CVNB    IFEQ P1CVNB                     *IF
     C                     Z-ADDA1F7NB    YN0035           TH Avg Live Wgt
     C                     END                             *FI
     C           KRSSF     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg BOL Head Received CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0196  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0197  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0198  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0199  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0200  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0201  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0202  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0203  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0204  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0205  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0206  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0207  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0208  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0209  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0210  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0211 11        BOL Trailer
     C                     MOVEL*BLANK    WN0212  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0213  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0214  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0215  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0216  1        Reported to USD
     C                     MOVEL*BLANK    WN0217  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0218  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0219  2        BOL Status 5
     C                     MOVEL*BLANK    WN0220  2        BOL Status 6
     C                     MOVEL*BLANK    WN0221  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0222  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0223  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0224  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0225  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0226  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0227 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0228 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0229 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0230 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0231 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0232  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0233  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0234  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0235  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0236  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0237  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0238  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0239  6        PL Location Cod
     C                     MOVEL*BLANK    WN0240 10        RS User Changed
     C                     Z-ADD*ZERO     WN0241  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0242  60       RS Time Changed
     C                     MOVEL*BLANK    WN0243  1        RS Record Statu
     C                     MOVEL*BLANK    WN0244 10        RS Job
     C                     MOVEL*BLANK    WN0245 10        RS Program
     C                     MOVEL*BLANK    WN0246 10        RS User Added
     C                     Z-ADD*ZERO     WN0247  70       RS Date Added
     C                     Z-ADD*ZERO     WN0248  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDP1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WCBONB           BOL Load Number
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C           KLCHSG    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YCRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDYL0005    WCDHNB           BOL Head Receiv
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * Head Rcvd
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0249  50       TRC Sequence
     C                     MOVEL*BLANK    WN0250 10        RS User Changed
     C                     Z-ADD*ZERO     WN0251  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0252  60       RS Time Changed
     C                     MOVEL*BLANK    WN0253  1        RS Record Statu
     C                     MOVEL*BLANK    WN0254 10        RS Job
     C                     MOVEL*BLANK    WN0255 10        RS Program
     C                     MOVEL*BLANK    WN0256 10        RS User Added
     C                     Z-ADD*ZERO     WN0257  70       RS Date Added
     C                     Z-ADD*ZERO     WN0258  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPAP
     C                     Z-ADDP5HONB    AYHONB           CC Company Numb
     C                     Z-ADDP5CDNZ    AYCDNZ           TRH Repayment I
     C                     Z-ADDP1HMNB    AYHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AYBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AYBONB           BOL Load Number
     C                     Z-ADDP1CVNB    AYCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    AYB0DT           TH Kill Date
     C                     MOVELYL0008    AYG7T1           TRC Comment
     C                     MOVEL'S'       AYMKSS           TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C           P1HMNB    IFEQ 0                          *IF
     C                     Z-ADDP5HONB    AYHMNB           BOH Company Num
     C                     END                             *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                     EXSR SIRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AYAJST           RS Record Statu
     C                     MOVEL##USR     AYABVN           RS User Added
     C                     Z-ADD##JDT     AYABDT           RS Date Added
     C                     Z-ADD##JTM     AYABTM           RS Time Added
     C                     MOVEL##PGM     AYAGVN           RS Program
     C                     MOVEL##JOB     AYAHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           AYHONB           CC Company Numb
     C                     KFLD           AYCDNZ           TRH Repayment I
     C                     KFLD           AYCINZ           TRC Sequence
      * Check for duplicate primary key
     C           KLCRSH    SETLL@AYCPAP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1569' W0RTN   7
      * Send message 'Tattoo Repayment Comme EX'
     C                     MOVEL'PRK1569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPAP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSI01           CC Company Numb
     C           *LIKE     DEFN WDCDNZ    WQSI02           TRH Repayment I
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CC Company Numb
     C                     KFLD           WQSI02           TRH Repayment I
      * Setup key
     C                     Z-ADDP5HONB    WQSI01           CC Company Numb
     C                     Z-ADDP5CDNZ    WQSI02           TRH Repayment I
      * Establish starting position
     C           KRSSI     SETLL@AYCPA6                    *
     C           KRSSI     READE@AYCPA6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1568' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         AYCINZ           TRC Sequence
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WDCINZ    ADD  1         AYCINZ           TRC Sequence
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@AYCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * Head Rcvd
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0259  50       TRC Sequence
     C                     MOVEL*BLANK    WN0260 10        RS User Changed
     C                     Z-ADD*ZERO     WN0261  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0262  60       RS Time Changed
     C                     MOVEL*BLANK    WN0263  1        RS Record Statu
     C                     MOVEL*BLANK    WN0264 10        RS Job
     C                     MOVEL*BLANK    WN0265 10        RS Program
     C                     MOVEL*BLANK    WN0266 10        RS User Added
     C                     Z-ADD*ZERO     WN0267  70       RS Date Added
     C                     Z-ADD*ZERO     WN0268  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPAP
     C                     Z-ADDP5HONB    AYHONB           CC Company Numb
     C                     Z-ADDP5CDNZ    AYCDNZ           TRH Repayment I
     C                     Z-ADDP1HMNB    AYHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AYBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AYBONB           BOL Load Number
     C                     Z-ADDP1CVNB    AYCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    AYB0DT           TH Kill Date
     C                     MOVELYL0008    AYG7T1           TRC Comment
     C                     MOVEL'S'       AYMKSS           TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C           P1HMNB    IFEQ 0                          *IF
     C                     Z-ADDP5HONB    AYHMNB           BOH Company Num
     C                     END                             *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                     EXSR SKRVGN
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AYAJST           RS Record Statu
     C                     MOVEL##USR     AYABVN           RS User Added
     C                     Z-ADD##JDT     AYABDT           RS Date Added
     C                     Z-ADD##JTM     AYABTM           RS Time Added
     C                     MOVEL##PGM     AYAGVN           RS Program
     C                     MOVEL##JOB     AYAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           AYHONB           CC Company Numb
     C                     KFLD           AYCDNZ           TRH Repayment I
     C                     KFLD           AYCINZ           TRC Sequence
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@AYCPAP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1569' W0RTN   7
      * Send message 'Tattoo Repayment Comme EX'
     C                     MOVEL'PRK1569' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPAP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSK01           CC Company Numb
     C           *LIKE     DEFN WDCDNZ    WQSK02           TRH Repayment I
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CC Company Numb
     C                     KFLD           WQSK02           TRH Repayment I
      * Setup key
     C                     Z-ADDP5HONB    WQSK01           CC Company Numb
     C                     Z-ADDP5CDNZ    WQSK02           TRH Repayment I
      * Establish starting position
     C           KRSSK     SETLL@AYCPA6                    *
     C           KRSSK     READE@AYCPA6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1568' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         AYCINZ           TRC Sequence
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WDCINZ    ADD  1         AYCINZ           TRC Sequence
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@AYCPA6                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      *  6/08/2021 JBB SDD619 - Repayment by Business User
      *                         Function created. copied from function:
      *                         Edt HdRcvAftrSnt2Kill EF - Tattoo Detail.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1CVNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(RCD) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(RCD) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0001  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0002  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0003  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C           #1CVNB    ANDEQ*ZERO                      TH Tattoo Numbe
     C           #1B0DT    ANDEQ*ZERO                      TH Kill Date
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAA1    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KLVAA1    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CMCD    WK1X02  1
     C           YPMTFD    IFEQ '#1HVNB'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CMCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HVNB' defaulted for 'Pen Company Number'.
      * Field '(RCD) #1CMCD' defaulted for 'Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0004  30       Pen Company Num
     C           #1CMCD    PARM #1CMCD    WQ0005  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1HVNB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CMCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVNB    IFEQ *ZERO                      Pen Company Num
     C           #1CMCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBA3    KLIST
     C                     KFLD           A3HVNB           Pen Company Num
     C                     KFLD           A3CMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    A3HVNB
     C                     MOVEL#1CMCD    A3CMCD
     C           KLVBA3    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Detail Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B9CD    IFEQ *BLANK                     TDP Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBX    KLIST
     C                     KFLD           BXB9CD           TDP Process Cod
      * Setup key
     C                     MOVEL#1B9CD    BXB9CD
     C           KLVCBX    CHAIN@BXREGA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Tattoo Detail Process  NF'
     C                     MOVEL'PRK0128' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0128' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CYCD    WK1X02  1
     C           YPMTFD    IFEQ '#1H8NB'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CYCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1H8NB' defaulted for 'Held Over Pen Company Num'.
      * Field '(RCD) #1CYCD' defaulted for 'Held Over Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1H8NB    PARM #1H8NB    WQ0006  30       Pen Company Num
     C           #1CYCD    PARM #1CYCD    WQ0007  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1H8NB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CYCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1H8NB    IFEQ *ZERO                      Pen Company Num
     C           #1CYCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDA3    KLIST
     C                     KFLD           A3HVNB           Pen Company Num
     C                     KFLD           A3CMCD           Pen Number
      * Setup key
     C                     Z-ADD#1H8NB    A3HVNB
     C                     MOVEL#1CYCD    A3CMCD
     C           KLVDA3    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD16        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * RMC MOVED HERE FROM FUNCTION KEYS 1/20/22
      * Perform Tattoo Header, BOL, and Tattoo Repayment Detail updates
      * CASE: *OTHERWISE
      * Chg Hd Rcvd for Repay CH - Tattoo Header  * 
     C                     EXSR SECHRC
     C                     Z-ADD*ZERO     YL0005           TH Head Receive
      * RTV Head Rec/Live Wgt RT - Tattoo Header  * 
     C                     EXSR SFRVGN
      * Chg BOL Head Received CH - Buy Order Load  * 
     C                     EXSR SGCHRC
      * Update Tattoo Repayment Detail and create comments
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0006           Head - Orig 3 A
     C                     MOVEL#CBDNZ    YL0006           Head - Orig 3 A
     C                     MOVEL*BLANK    YL0007           Head - New 3 Al
     C                     MOVEL#CA4NZ    YL0007           Head - New 3 Al
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,001   CAT  'm':ZQ    YL0008    P      TRC Comment
     C                     Z-ADD1         ZQ      50
     C           YL0008    CAT  YL0006:ZQ YL0008    P      TRC Comment
     C                     Z-ADD1         ZQ      50
     C           YL0008    CAT  'to':ZQ   YL0008    P      TRC Comment
     C                     Z-ADD1         ZQ      50
     C           YL0008    CAT  YL0007:ZQ YL0008    P      TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * Head Rcvd
     C                     EXSR SHCRRC
      * Chg Tatt Repay Dtl Sts XF - Tattoo Repayment Detail  * 
     C                     CALL 'PWNQXFR'              90  Chg Tatt Repay
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P5HONB    WQ0008  30       CC Company Numb
     C                     PARM P5CDNZ    WQ0009  50       TRH Repayment I
     C                     PARM #2HMNB    WQ0010  30       BOH Company Num
     C                     PARM #2BNNB    WQ0011  70       BOH Buy Order N
     C                     PARM #2BONB    WQ0012  50       BOL Load Number
     C                     PARM #2CVNB    WQ0013  50       TH Tattoo Numbe
     C                     PARM 'E'       WQ0014  1        TRD Repayment S
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Create a Tattoo Repayment Comment showing record as Edited
      * CASE: *OTHERWISE
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,002   CAT  @CN,003:ZQYL0008    P      TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * Head Rcvd
     C                     EXSR SJCRRC
      * Exit program after update
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2CWNB           TH Head Receive
     C                     MOVEL*BLANK    P2CWST           TH Payment Sts
     C                     MOVEL*BLANK    P2E1ST           TH Held Over Re
     C                     Z-ADD*ZERO     P2BSDT           TH Held/Ovr Com
     C                     MOVEL*BLANK    P2LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    P2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    P2AECD           PL Location Cod
     C                     Z-ADD*ZERO     P3CQDT           BOL Kill Date
     C                     Z-ADD*ZERO     P3DHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     P4A7NZ           Tattoo Number S
     C                     Z-ADD*ZERO     P4H6DT           Kill Date Selec
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACDNZ           TRH Repayment I
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WACGNZ           Transfer Buy Or
     C                     Z-ADD*ZERO     WACENZ           Transfer Buy Or
     C                     Z-ADD*ZERO     WACFNZ           Transfer Tattoo
     C                     Z-ADD*ZERO     WAIIDT           Transfer Kill D
     C                     Z-ADD*ZERO     WAC1NZ           TRD Pen Head
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Clear all neither parameters
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * Head Rcvd
     C                     Z-ADD*ZERO     AYCINZ           TRC Sequence
     C                     Z-ADD*ZERO     AYAADT           RS Date Changed
     C                     Z-ADD*ZERO     AYAMTM           RS Time Changed
     C                     Z-ADD*ZERO     AYABDT           RS Date Added
     C                     Z-ADD*ZERO     AYABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDCDNZ           TRH Repayment I
     C                     Z-ADD*ZERO     WDCINZ           TRC Sequence
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field BOL Kill Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define null work field BOL Pln Delv Start Time
     C                     Z-ADD*ZERO     YN0001  40
      * Define null work field BOL Pln Delv End Time
     C                     Z-ADD*ZERO     YN0002  40
      * Define null work field BOL Pln Head Delv
     C                     Z-ADD*ZERO     YN0003  50
      * Define null work field BOL Shipped Wgt
     C                     Z-ADD*ZERO     YN0004  71
      * Define null work field BOL Pln Delv Date
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field BOL Freight UOM
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field BOL Freight Unit Amt
     C                     Z-ADD*ZERO     YN0007  72
      * Define null work field BOL Freight Amt
     C                     Z-ADD*ZERO     YN0008  72
      * Define null work field BOL Freight Allocation
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     YN0010  71
      * Define null work field BOL Trucker Payment Sts
     C                     MOVEL*BLANK    YN0011  2
      * Define null work field BOL Trucker Check Number
     C                     Z-ADD*ZERO     YN0012  80
      * Define null work field BOL Trucker Check Date
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field BOL AP Voucher
     C                     Z-ADD*ZERO     YN0014  80
      * Define null work field BOL Trailer
     C                     MOVEL*BLANK    YN0015 11
      * Define null work field BOL Freight Exp Paid By
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field BOL Scheduled Kill Shift
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field BOL Truck Scale Weigh Sts
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Reported to USDA
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field BOL MPR Prior Day Prch
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field BOL Violated Auth Tme Sts
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field TRK Trucker Code
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0023  6
      * Define null work field PL Location Code
     C                     MOVEL*BLANK    YN0024  6
      * Define local work field Head Rcvd 1
     C                     Z-ADD*ZERO     YL0002  30
      * Define null work field Transfer Buy Order Number
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Transfer Buy Order Load
     C                     Z-ADD*ZERO     YN0026  50
      * Define null work field Transfer Tattoo Number
     C                     Z-ADD*ZERO     YN0027  50
      * Define null work field TRD Repayment Status
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field TRD Payment Sts
     C                     MOVEL*BLANK    YN0029  2
      * Define null work field TRD Process Code
     C                     MOVEL*BLANK    YN0030  6
      * Define null work field PS Site ID
     C                     MOVEL*BLANK    YN0031 10
      * Define null work field SR Source Code
     C                     MOVEL*BLANK    YN0032  3
      * Define null work field PC Contract Code
     C                     MOVEL*BLANK    YN0033  5
      * Define null work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    YN0034  5
      * Define local work field Update Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Calc BOL Head Rcvd USR
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0005  50
      * Define null work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YN0035  51
      * Define local work field Head - Orig 3 Alpha
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Head - New 3 Alpha
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field TRC Comment
     C                     MOVEL*BLANK    YL0008 60
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * This program displays all Tattoo Detail records associated with a
      * Company, Buy Order, and Load.  The only Tattoo Detail records tha
      * can be updated are the ones that match the incoming Tattoo and
      * Kill Date.  The other records are used for reference only.
     C                     Z-ADDP1CVNB    P4A7NZ           Tattoo Number S
     C                     Z-ADDP1B0DT    P4H6DT           Kill Date Selec
     C                     MOVEL'N'       YL0003           Update Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Head Received changed fro
00002 Tattoo record marked as e
00003 dited (Head Received)
