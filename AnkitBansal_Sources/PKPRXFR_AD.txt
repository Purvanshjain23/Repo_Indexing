// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKPRXFR
// ?Date: 14.08.2025 Time: 02:50:07
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?THESE 2 FUNCTIONS ARE EXTERNAL TO PREVENT THE TATTOO WEIGHT FILE
//?FROM BEING LOCKED WHEN THE PC TRIES TO DELETE THE RECORD WHEN A
//?WEIGHING HAS COMPLETED.
//?If the weighing is in process, call DSPRCD so record wont be locked.
//? else call EDTRCD to allow updates.
EXECUTE FUNCTION(RTV SF WIP Flag       RT) TYPE(RTVOBJ) FILE(PKCOCPP)           AB1134207;
PARAMETER(1);
PARAMETER(WRK.SF_Cancel_Get_Weight_Flag);
PARAMETER(WRK.SF_PC_WIP_Flag);
{
 //?USER: Process Data record

 // *MO.VE             1183529*Bu = ilt. in functions
 PAR.SF_PC_WIP_Flag = DB1.SF_PC_WIP_Flag;

 // *MO.VE             1183529*Bu = ilt. in functions
 PAR.SF_Cancel_Get_Weight_Flag = DB1.SF_Cancel_Get_Weight_Flag;

}


CASE;

// IF WRK.SF PC WIP Flag is Status is on
IF WRK.SF_PC_WIP_Flag = '1';

// Call program Zzz Dsp Ttt Wt        XF.
CALL PROGRAM(Zzz Dsp Ttt Wt        XF) ('PKPVXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.TW_Sequence_number);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(WRK.Simulate_Weight_Cmplt_Usr);
PARAMETER(PAR.PD_Producer_Code);
PARAMETER(PAR.PL_Location_Code);
PARAMETER(PAR.PD_Name);
PARAMETER(PAR.PL_Name);
PARAMETER(PAR.HC_Class_Code);
PARAMETER(PAR.DF_Defect_Code);

// IF *OTHERWISE
IF *OTHERWISE;

// Call program Zzz Edit Ttt Wt       XF.
CALL PROGRAM(Zzz Edit Ttt Wt       XF) ('PKPSXFR');
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.TW_Sequence_number);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(WRK.Simulate_Weight_Cmplt_Usr);
PARAMETER(PAR.PD_Producer_Code);
PARAMETER(PAR.PL_Location_Code);
PARAMETER(PAR.PD_Name);
PARAMETER(PAR.PL_Name);
PARAMETER(PAR.HC_Class_Code);
PARAMETER(PAR.DF_Defect_Code);

ENDIF;

//?F24=Simulate Weight Complete requested  (until PC comm. done)
CASE;

// IF WRK.Simulate Weight Cmplt Usr is Simulate Weight Complete
IF WRK.Simulate_Weight_Cmplt_Usr = 'Y';

// Execute command - 'Tattoo Weight- clrpfm'
EXECUTE COMMAND(PRK0371);

ENDIF;

