     H/TITLE PFS Lock Load/Order   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/12/19  Time  : 10:53:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFJCPMDIF  E           K        DISK
      * RSQ : Load Header               Load-L/S/I
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPPBACPL1IF  E           K        DISK
      * RTV : PFS Load Header           Retrieval index
      *
     FPPBACPL0UF  E           K        DISK                      A
      * UPD : PFS Load Header           Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@FJCPDG
      * Load Header               Load-L/S/I
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WGAIC3
     I              EOBKC7                          WGBKC7
     I              EOAQCD                          WGAQCD
     I              EOR4CD                          WGR4CD
     I              EOBYNA                          WGBYNA
     I              EOB6NA                          WGB6NA
     I              EOBZNA                          WGBZNA
     I              EOLLST                          WGLLST
     I              EOPPST                          WGPPST
     I              EOR5NB                          WGR5NB
     I              EOR6NB                          WGR6NB
     I              EOQGST                          WGQGST
     I              EOBOCD                          WGBOCD
     I              EOTBNB                          WGTBNB
     I              EOMTCU                          WGMTCU
     I              EOW2NB                          WGW2NB
     I              EORPCD                          WGRPCD
     I              EOAJCD                          WGAJCD
     I              EOX9ST                          WGX9ST
     I              EOT9CD                          WGT9CD
     I              EOUBCD                          WGUBCD
     I              EOISTX                          WGISTX
     I              EOLQCD                          WGLQCD
     I              EONJNA                          WGNJNA
     I              EOI0TX                          WGI0TX
     I              EONKNA                          WGNKNA
     I              EOI1TX                          WGI1TX
     I              EOVLST                          WGVLST
     I              EORLST                          WGRLST
     I              EOMMTX                          WGMMTX
     I              EOOHNA                          WGOHNA
     I              EOQ6ST                          WGQ6ST
     I              EOQ8ST                          WGQ8ST
     I              EORBST                          WGRBST
     I              EOREST                          WGREST
     I              EOUVST                          WGUVST
     I              EOUWST                          WGUWST
     I              EOUXST                          WGUXST
     I              EOVSST                          WGVSST
     I              EOAATM                          WGAATM
     I              EOAYNA                          WGAYNA
     I              EOA0NA                          WGA0NA
     I              EOAXDT                          WGAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WHAIC3
     I              KMV8CD                          WHV8CD
     I              KMAUNA                          WHAUNA
     I              KMI5ST                          WHI5ST
     I              KMBXTX                          WHBXTX
     I              KMM8NB                          WHM8NB
     I              KMUVST                          WHUVST
     I              KMUWST                          WHUWST
     I              KMUXST                          WHUXST
     I              KMVSST                          WHVSST
     I              KMAATM                          WHAATM
     I              KMAYNA                          WHAYNA
     I              KMA0NA                          WHA0NA
     I              KMAXDT                          WHAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WIBZNA
     I              FFADTX                          WIADTX
     I              FFACNA                          WIACNA
     I              FFADNA                          WIADNA
     I              FFAENA                          WIAENA
     I              FFAJNA                          WIAJNA
     I              FFBTTX                          WIBTTX
     I              FFEZNB                          WIEZNB
     I              FFBGCD                          WIBGCD
     I              FFEEDT                          WIEEDT
     I              FFDUTX                          WIDUTX
     I              FFNRVA                          WINRVA
     I              FFNSVA                          WINSVA
     I              FFNTVA                          WINTVA
     I              FFNUVA                          WINUVA
     I              FFP1ST                          WIP1ST
     I              FFDVTX                          WIDVTX
     I              FFDWTX                          WIDWTX
     I              FFLVCD                          WILVCD
     I              FFS8NB                          WIS8NB
     I              FFS9NB                          WIS9NB
     I              FFNMVA                          WINMVA
     I              FFNOVA                          WINOVA
     I              FFNPVA                          WINPVA
     I              FFNQVA                          WINQVA
     I              FFMFCD                          WIMFCD
     I              FFQXNB                          WIQXNB
     I              FFQ1NB                          WIQ1NB
     I              FFMRNG                          WIMRNG
     I              FFMRNE                          WIMRNE
     I              FFRFNB                          WIRFNB
     I              FFMREG                          WIMREG
     I              FFBQPR                          WIBQPR
     I              FFBRPR                          WIBRPR
     I              FFBSPR                          WIBSPR
     I              FFBTPR                          WIBTPR
     I              FFBUPR                          WIBUPR
     I              FFBVPR                          WIBVPR
     I              FFDJWG                          WIDJWG
     I              FFDKWG                          WIDKWG
     I              FFDLWG                          WIDLWG
     I              FFDMWG                          WIDMWG
     I              FFDNWG                          WIDNWG
     I              FFDOWG                          WIDOWG
     I              FFB2PR                          WIB2PR
     I              FFB3PR                          WIB3PR
     I              FFB4PR                          WIB4PR
     I              FFB5PR                          WIB5PR
     I              FFB6PR                          WIB6PR
     I              FFB7PR                          WIB7PR
     I              FFAAC7                          WIAAC7
     I              FFCOFI                          WICOFI
     I              FFK6TX                          WIK6TX
     I              FFOCNA                          WIOCNA
     I              FFODNA                          WIODNA
     I              FFW7CD                          WIW7CD
     I              FFK7TX                          WIK7TX
     I              FFTENO                          WITENO
     I              FFK8TX                          WIK8TX
     I              FFAOFC                          WIAOFC
     I              FFAOLI                          WIAOLI
     I              FFKHDT                          WIKHDT
     I              FFUNUS                          WIUNUS
     I              FFUNU2                          WIUNU2
     I              FFUNU3                          WIUNU3
     I              FFUVST                          WIUVST
     I              FFUWST                          WIUWST
     I              FFUXST                          WIUXST
     I              FFVSST                          WIVSST
     I              FFAATM                          WIAATM
     I              FFAYNA                          WIAYNA
     I              FFA0NA                          WIA0NA
     I              FFAXDT                          WIAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WKAIC3
     I              ABADTX                          WKADTX
     I              ABACNA                          WKACNA
     I              ABADNA                          WKADNA
     I              ABAENA                          WKAENA
     I              ABAJNA                          WKAJNA
     I              ABBTTX                          WKBTTX
     I              ABBVTX                          WKBVTX
     I              ABBWTX                          WKBWTX
     I              ABA2NA                          WKA2NA
     I              ABABTX                          WKABTX
     I              ABBGCD                          WKBGCD
     I              ABKXCD                          WKKXCD
     I              ABUVST                          WKUVST
     I              ABUWST                          WKUWST
     I              ABUXST                          WKUXST
     I              ABVSST                          WKVSST
     I              ABAATM                          WKAATM
     I              ABAYNA                          WKAYNA
     I              ABA0NA                          WKA0NA
     I              ABAXDT                          WKAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WLRONB
     I              FKDPTX                          WLDPTX
     I              FKRSNB                          WLRSNB
     I              FKRTNB                          WLRTNB
     I              FKTANB                          WLTANB
     I              FKUVST                          WLUVST
     I              FKUWST                          WLUWST
     I              FKUXST                          WLUXST
     I              FKVSST                          WLVSST
     I              FKAATM                          WLAATM
     I              FKAYNA                          WLAYNA
     I              FKA0NA                          WLA0NA
     I              FKAXDT                          WLAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WORMNB
     I              FJAIC3                          WOAIC3
     I              FJAODT                          WOAODT
     I              FJPJST                          WOPJST
     I              FJPKST                          WOPKST
     I              FJRNNB                          WORNNB
     I              FJDMTX                          WODMTX
     I              FJDNTX                          WODNTX
     I              FJDOTX                          WODOTX
     I              FJWTTX                          WOWTTX
     I              FJWUTX                          WOWUTX
     I              FJRPNB                          WORPNB
     I              FJFLAM                          WOFLAM
     I              FJXQST                          WOXQST
     I              FJRRNB                          WORRNB
     I              FJDXTX                          WODXTX
     I              FJDYTX                          WODYTX
     I              FJSBNB                          WOSBNB
     I              FJBZNA                          WOBZNA
     I              FJRONB                          WORONB
     I              FJSQNB                          WOSQNB
     I              FJR1NB                          WOR1NB
     I              FJVCST                          WOVCST
     I              FJVDST                          WOVDST
     I              FJSDNB                          WOSDNB
     I              FJPAOU                          WOPAOU
     I              FJDGWG                          WODGWG
     I              FJSXNB                          WOSXNB
     I              FJHADT                          WOHADT
     I              FJAART                          WOAART
     I              FJDHWG                          WODHWG
     I              FJDIWG                          WODIWG
     I              FJAQDT                          WOAQDT
     I              FJS6NB                          WOS6NB
     I              FJT4NB                          WOT4NB
     I              FJPRTM                          WOPRTM
     I              FJNPSV                          WONPSV
     I              FJJ8TX                          WOJ8TX
     I              FJTLMI                          WOTLMI
     I              FJJ9TX                          WOJ9TX
     I              FJQ2CD                          WOQ2CD
     I              FJVPCD                          WOVPCD
     I              FJDBCD                          WODBCD
     I              FJGRWE                          WOGRWE
     I              FJXCCD                          WOXCCD
     I              FJU2ST                          WOU2ST
     I              FJF9DT                          WOF9DT
     I              FJONTM                          WOONTM
     I              FJJ4DT                          WOJ4DT
     I              FJTRTM                          WOTRTM
     I              FJJ5DT                          WOJ5DT
     I              FJSPTM                          WOSPTM
     I              FJJ6DT                          WOJ6DT
     I              FJLFTM                          WOLFTM
     I              FJJ7DT                          WOJ7DT
     I              FJBOTM                          WOBOTM
     I              FJJ8DT                          WOJ8DT
     I              FJBLTM                          WOBLTM
     I              FJKIDT                          WOKIDT
     I              FJASTM                          WOASTM
     I              FJKADT                          WOKADT
     I              FJAJCM                          WOAJCM
     I              FJXACD                          WOXACD
     I              FJOANA                          WOOANA
     I              FJK4TX                          WOK4TX
     I              FJVOAG                          WOVOAG
     I              FJKBDT                          WOKBDT
     I              FJNBBO                          WONBBO
     I              FJW4CD                          WOW4CD
     I              FJEFDT                          WOEFDT
     I              FJCNTN                          WOCNTN
     I              FJKCDT                          WOKCDT
     I              FJTMIN                          WOTMIN
     I              FJKDDT                          WOKDDT
     I              FJVMNB                          WOVMNB
     I              FJOCFR                          WOOCFR
     I              FJKJDT                          WOKJDT
     I              FJATTM                          WOATTM
     I              FJOTRS                          WOOTRS
     I              FJRNST                          WORNST
     I              FJBRBK                          WOBRBK
     I              FJEIDT                          WOEIDT
     I              FJRMST                          WORMST
     I              FJAJCD                          WOAJCD
     I              FJKKDT                          WOKKDT
     I              FJAVTM                          WOAVTM
     I              FJKZDT                          WOKZDT
     I              FJAXTM                          WOAXTM
     I              FJLHOS                          WOLHOS
     I              FJLHOR                          WOLHOR
     I              FJWNTX                          WOWNTX
     I              FJOITX                          WOOITX
     I              FJOJTX                          WOOJTX
     I              FJLLDT                          WOLLDT
     I              FJLSHG                          WOLSHG
     I              FJYPST                          WOYPST
     I              FJK0DT                          WOK0DT
     I              FJAYTM                          WOAYTM
     I              FJKNNX                          WOKNNX
     I              FJICWG                          WOICWG
     I              FJIDWG                          WOIDWG
     I              FJH9SX                          WOH9SX
     I              FJWOTX                          WOWOTX
     I              FJK1DT                          WOK1DT
     I              FJAZTM                          WOAZTM
     I              FJK2DT                          WOK2DT
     I              FJA0TM                          WOA0TM
     I              FJROST                          WOROST
     I              FJRPST                          WORPST
     I              FJRQST                          WORQST
     I              FJRRST                          WORRST
     I              FJZBVA                          WOZBVA
     I              FJWPTX                          WOWPTX
     I              FJWQTX                          WOWQTX
     I              FJWRTX                          WOWRTX
     I              FJWSTX                          WOWSTX
     I              FJRVSX                          WORVSX
     I              FJRUSX                          WORUSX
     I              FJRWSX                          WORWSX
     I              FJRXSX                          WORXSX
     I              FJRYSX                          WORYSX
     I              FJRZSX                          WORZSX
     I              FJR0SX                          WOR0SX
     I              FJR1SX                          WOR1SX
     I              FJR2SX                          WOR2SX
     I              FJR3SX                          WOR3SX
     I              FJR4SX                          WOR4SX
     I              FJPYDT                          WOPYDT
     I              FJCKTM                          WOCKTM
     I              FJPZDT                          WOPZDT
     I              FJCLTM                          WOCLTM
     I              FJP0DT                          WOP0DT
     I              FJCMTM                          WOCMTM
     I              FJP1DT                          WOP1DT
     I              FJCNTM                          WOCNTM
     I              FJP2DT                          WOP2DT
     I              FJCOTM                          WOCOTM
     I              FJP3DT                          WOP3DT
     I              FJCQTM                          WOCQTM
     I              FJUVST                          WOUVST
     I              FJUWST                          WOUWST
     I              FJUXST                          WOUXST
     I              FJAATM                          WOAATM
     I              FJAYNA                          WOAYNA
     I              FJA0NA                          WOA0NA
     I              FJAXDT                          WOAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WSAIC3
     I              AMC4NB                          WSC4NB
     I              AMRMNB                          WSRMNB
     I              AMRUNB                          WSRUNB
     I              AMXACD                          WSXACD
     I              AMOANA                          WSOANA
     I              AMHBAA                          WSHBAA
     I              AMJ0T1                          WSJ0T1
     I              AMGENY                          WSGENY
     I              AMJ1T1                          WSJ1T1
     I              AMHCAA                          WSHCAA
     I              AMQWDT                          WSQWDT
     I              AMQXDT                          WSQXDT
     I              AMQYDT                          WSQYDT
     I              AMHDAA                          WSHDAA
     I              AMCCTX                          WSCCTX
     I              AMJ2T1                          WSJ2T1
     I              AMRLNA                          WSRLNA
     I              AMRMNA                          WSRMNA
     I              AMGINY                          WSGINY
     I              AMGFNY                          WSGFNY
     I              AMGGNY                          WSGGNY
     I              AMGHNY                          WSGHNY
     I              AMHEVL                          WSHEVL
     I              AMHFVL                          WSHFVL
     I              AMHGVL                          WSHGVL
     I              AMQZDT                          WSQZDT
     I              AMQ0DT                          WSQ0DT
     I              AMQ1DT                          WSQ1DT
     I              AMQ2DT                          WSQ2DT
     I              AMC2TX                          WSC2TX
     I              AMC3TX                          WSC3TX
     I              AMC6TX                          WSC6TX
     I              AMCHTX                          WSCHTX
     I              AMCITX                          WSCITX
     I              AMCLTX                          WSCLTX
     I              AMB4TX                          WSB4TX
     I              AMCUTX                          WSCUTX
     I              AMCVTX                          WSCVTX
     I              AMB9TX                          WSB9TX
     I              AMJWSC                          WSJWSC
     I              AMITNY                          WSITNY
     I              AMLMT1                          WSLMT1
     I              AMLWAA                          WSLWAA
     I              AMFVST                          WSFVST
     I              AMF0ST                          WSF0ST
     I              AMF2ST                          WSF2ST
     I              AMF3ST                          WSF3ST
     I              AMJUSC                          WSJUSC
     I              AMJVSC                          WSJVSC
     I              AMV3T1                          WSV3T1
     I              AMV4T1                          WSV4T1
     I              AMV5T1                          WSV5T1
     I              AMV6T1                          WSV6T1
     I              AMV7T1                          WSV7T1
     I              AMV8T1                          WSV8T1
     I              AMV9T1                          WSV9T1
     I              AMWAT1                          WSWAT1
     I              AMWBT1                          WSWBT1
     I              AMWCT1                          WSWCT1
     I              AMWDT1                          WSWDT1
     I              AMQJNY                          WSQJNY
     I              AMQKNY                          WSQKNY
     I              AMQLNY                          WSQLNY
     I              AMP8NY                          WSP8NY
     I              AMP9NY                          WSP9NY
     I              AMQANY                          WSQANY
     I              AMQCNY                          WSQCNY
     I              AMQDNY                          WSQDNY
     I              AMQENY                          WSQENY
     I              AMQFNY                          WSQFNY
     I              AMQGNY                          WSQGNY
     I              AMQHNY                          WSQHNY
     I              AMQINY                          WSQINY
     I              AMQMNY                          WSQMNY
     I              AMMYU1                          WSMYU1
     I              AMJXSC                          WSJXSC
     I              AMJYSC                          WSJYSC
     I              AMJZSC                          WSJZSC
     I              AMJ0SC                          WSJ0SC
     I              AMMZU1                          WSMZU1
     I              AMM0U1                          WSM0U1
     I              AMM1U1                          WSM1U1
     I              AMM2U1                          WSM2U1
     I              AMM3U1                          WSM3U1
     I              AMW5DT                          WSW5DT
     I              AMW6DT                          WSW6DT
     I              AMUVST                          WSUVST
     I              AMUWST                          WSUWST
     I              AMUXST                          WSUXST
     I              AMVSST                          WSVSST
     I              AMAATM                          WSAATM
     I              AMAYNA                          WSAYNA
     I              AMA0NA                          WSA0NA
     I              AMAXDT                          WSAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          WTXACD
     I              LCOANA                          WTOANA
     I              LCOKTX                          WTOKTX
     I              LCLBTX                          WTLBTX
     I              LCLATX                          WTLATX
     I              LCXBCD                          WTXBCD
     I              LCLCTX                          WTLCTX
     I              LCSPPN                          WTSPPN
     I              LCLDTX                          WTLDTX
     I              LCPYAA                          WTPYAA
     I              LCUVST                          WTUVST
     I              LCUWST                          WTUWST
     I              LCUXST                          WTUXST
     I              LCVSST                          WTVSST
     I              LCAATM                          WTAATM
     I              LCAYNA                          WTAYNA
     I              LCA0NA                          WTA0NA
     I              LCAXDT                          WTAXDT
      *
     I@BACPZJ
      * PFS Load Header           Retrieval index
      * Renamed input format fields
     I              BAY1NX                          WVY1NX
     I              BAZGNX                          WVZGNX
     I              BAAWNY                          WVAWNY
     I              BAF4AA                          WVF4AA
     I              BAFQT1                          WVFQT1
     I              BAVBSX                          WVVBSX
     I              BAF5AA                          WVF5AA
     I              BAFRT1                          WVFRT1
     I              BAFST1                          WVFST1
     I              BAFTT1                          WVFTT1
     I              BAFUT1                          WVFUT1
     I              BAFVT1                          WVFVT1
     I              BAFWT1                          WVFWT1
     I              BAFXT1                          WVFXT1
     I              BAZLNX                          WVZLNX
     I              BAF7AA                          WVF7AA
     I              BAF6AA                          WVF6AA
     I              BAU7SX                          WVU7SX
     I              BAU9SX                          WVU9SX
     I              BAVASX                          WVVASX
     I              BAZMNX                          WVZMNX
     I              BAZNNX                          WVZNNX
     I              BAZONX                          WVZONX
     I              BAU8SX                          WVU8SX
     I              BAZHNX                          WVZHNX
     I              BAZINX                          WVZINX
     I              BAZJNX                          WVZJNX
     I              BAZKNX                          WVZKNX
     I              BABLNY                          WVBLNY
     I              BAFYT1                          WVFYT1
     I              BABKNY                          WVBKNY
     I              BAATNY                          WVATNY
     I              BAB4NY                          WVB4NY
     I              BAY7SX                          WVY7SX
     I              BAHST1                          WVHST1
     I              BAF5NY                          WVF5NY
     I              BAY8SX                          WVY8SX
     I              BAY9SX                          WVY9SX
     I              BAZASX                          WVZASX
     I              BAZBSX                          WVZBSX
     I              BAZCSX                          WVZCSX
     I              BAMWU1                          WVMWU1
     I              BAUWSX                          WVUWSX
     I              BAUXSX                          WVUXSX
     I              BAV3SX                          WVV3SX
     I              BAAHNY                          WVAHNY
     I              BAAINY                          WVAINY
     I              BAAJNY                          WVAJNY
     I              BAAKNY                          WVAKNY
      *
     I@BACPZI
      * PFS Load Header           Update index
      * Renamed input format fields
     I              BAY1NX                          WWY1NX
     I              BAZGNX                          WWZGNX
     I              BAAWNY                          WWAWNY
     I              BAF4AA                          WWF4AA
     I              BAFQT1                          WWFQT1
     I              BAVBSX                          WWVBSX
     I              BAF5AA                          WWF5AA
     I              BAFRT1                          WWFRT1
     I              BAFST1                          WWFST1
     I              BAFTT1                          WWFTT1
     I              BAFUT1                          WWFUT1
     I              BAFVT1                          WWFVT1
     I              BAFWT1                          WWFWT1
     I              BAFXT1                          WWFXT1
     I              BAZLNX                          WWZLNX
     I              BAF7AA                          WWF7AA
     I              BAF6AA                          WWF6AA
     I              BAU7SX                          WWU7SX
     I              BAU9SX                          WWU9SX
     I              BAVASX                          WWVASX
     I              BAZMNX                          WWZMNX
     I              BAZNNX                          WWZNNX
     I              BAZONX                          WWZONX
     I              BAU8SX                          WWU8SX
     I              BAZHNX                          WWZHNX
     I              BAZINX                          WWZINX
     I              BAZJNX                          WWZJNX
     I              BAZKNX                          WWZKNX
     I              BABLNY                          WWBLNY
     I              BAFYT1                          WWFYT1
     I              BABKNY                          WWBKNY
     I              BAATNY                          WWATNY
     I              BAB4NY                          WWB4NY
     I              BAY7SX                          WWY7SX
     I              BAHST1                          WWHST1
     I              BAF5NY                          WWF5NY
     I              BAY8SX                          WWY8SX
     I              BAY9SX                          WWY9SX
     I              BAZASX                          WWZASX
     I              BAZBSX                          WWZBSX
     I              BAZCSX                          WWZCSX
     I              BAMWU1                          WWMWU1
     I              BAUWSX                          WWUWSX
     I              BAUXSX                          WWUXSX
     I              BAV3SX                          WWV3SX
     I              BAAHNY                          WWAHNY
     I              BAAINY                          WWAINY
     I              BAAJNY                          WWAJNY
     I              BAAKNY                          WWAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPPBA1    E DSPPBACPL0
      * UPD : PFS Load Header           Update index
      * Renamed input format fields
     I              BAY1NX                          WWY1NX
     I              BAZGNX                          WWZGNX
     I              BAAWNY                          WWAWNY
     I              BAF4AA                          WWF4AA
     I              BAFQT1                          WWFQT1
     I              BAVBSX                          WWVBSX
     I              BAF5AA                          WWF5AA
     I              BAFRT1                          WWFRT1
     I              BAFST1                          WWFST1
     I              BAFTT1                          WWFTT1
     I              BAFUT1                          WWFUT1
     I              BAFVT1                          WWFVT1
     I              BAFWT1                          WWFWT1
     I              BAFXT1                          WWFXT1
     I              BAZLNX                          WWZLNX
     I              BAF7AA                          WWF7AA
     I              BAF6AA                          WWF6AA
     I              BAU7SX                          WWU7SX
     I              BAU9SX                          WWU9SX
     I              BAVASX                          WWVASX
     I              BAZMNX                          WWZMNX
     I              BAZNNX                          WWZNNX
     I              BAZONX                          WWZONX
     I              BAU8SX                          WWU8SX
     I              BAZHNX                          WWZHNX
     I              BAZINX                          WWZINX
     I              BAZJNX                          WWZJNX
     I              BAZKNX                          WWZKNX
     I              BABLNY                          WWBLNY
     I              BAFYT1                          WWFYT1
     I              BABKNY                          WWBKNY
     I              BAATNY                          WWATNY
     I              BAB4NY                          WWB4NY
     I              BAY7SX                          WWY7SX
     I              BAHST1                          WWHST1
     I              BAF5NY                          WWF5NY
     I              BAY8SX                          WWY8SX
     I              BAY9SX                          WWY9SX
     I              BAZASX                          WWZASX
     I              BAZBSX                          WWZBSX
     I              BAZCSX                          WWZCSX
     I              BAMWU1                          WWMWU1
     I              BAUWSX                          WWUWSX
     I              BAUXSX                          WWUXSX
     I              BAV3SX                          WWV3SX
     I              BAAHNY                          WWAHNY
     I              BAAINY                          WWAINY
     I              BAAJNY                          WWAJNY
     I              BAAKNY                          WWAKNY
      *
     IYARDCS      DS                            430
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * N :  Company Number
     I                                    P   5   60P1AIC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Lock Load/Order   XF
      * ** Create PFS records for Load Header, Order Header, Order Detail
      * CASE: PAR.Load ID is NE Blank
     C           P1RMNB    IFNE *ZERO                      *IF
      * ** Check for errors during Export Order Automation Upload   P0012
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * ** Skip if Order Requires Review                      P001251
      * CASE: LCL.Order Requires Review is No
     C           YL0001    IFEQ *BLANK                     *IF
      * PFS Load/Orders       RT - Load Header  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BFCPD9                    *
     C           KRSSA     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Order Requires
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAFUSX    YL0001           Order Requires
     C           KRSSA     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * PFS Load/Orders       RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0002  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0003  50       PFS Sched Seque
     C                     MOVEL*BLANK    WN0004  3        PFS Carrier Cod
     C                     MOVEL*BLANK    WN0005 30        PFS Carrier Nam
     C                     MOVEL*BLANK    WN0006  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0007  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0008 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0009 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0010 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0011 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0012  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0013 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0014 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0015 15        PFS Voyage
     C                     MOVEL*BLANK    WN0016 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0017 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0018  2        PFS Shipping Me
     C                     MOVEL*BLANK    WN0019  1        PFS Load Shag F
     C                     MOVEL*BLANK    WN0020  1        PFS Load Wash F
     C                     Z-ADD*ZERO     WN0021  20       PFS Load Total
     C                     Z-ADD*ZERO     WN0022  50       PFS Load Total
     C                     Z-ADD*ZERO     WN0023  52       PFS Reefer Temp
     C                     MOVEL*BLANK    WN0024  1        PFS Reefer Temp
     C                     Z-ADD*ZERO     WN0025  80       PFS Load Sched
     C                     Z-ADD*ZERO     WN0026  60       PFS Load Sched
     C                     Z-ADD*ZERO     WN0027  80       PFS Load Deadli
     C                     Z-ADD*ZERO     WN0028  60       PFS Load Deadli
     C                     Z-ADD*ZERO     WN0029  82       PFS Maximum Loa
     C                     MOVEL*BLANK    WN0030 20        PFS Federal Tax
     C                     Z-ADD*ZERO     WN0031  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0032  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0033  82       PFS Predicted L
     C                     MOVEL*BLANK    WN0034  1        PFS Load Status
     C                     MOVEL*BLANK    WN0035 20        PFS Trailer Id
     C                     MOVEL*BLANK    WN0036  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0037  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0038  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0039  2        PFS Load Unused
     C                     MOVEL*BLANK    WN0040  2        PFS Load Unused
     C                     MOVEL*BLANK    WN0041 15        PFS Load Unused
     C                     MOVEL*BLANK    WN0042  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0043  50       Number Pallets
     C                     Z-ADD*ZERO     WN0044 112       Weight 1 USR
     C                     MOVEL*BLANK    WN0045  1        Receipt Order S
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KPSSB     SETLL@FJCPDG                    *
     C                     READ @FJCPDG                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           PFS Company Num
     C                     Z-ADD*ZERO     WN0002           PFS Load ID
     C                     Z-ADD*ZERO     WN0003           PFS Sched Seque
     C                     MOVEL*BLANK    WN0004           PFS Carrier Cod
     C                     MOVEL*BLANK    WN0005           PFS Carrier Nam
     C                     MOVEL*BLANK    WN0006           PFS Export Stat
     C                     MOVEL*BLANK    WN0007           PFS Shipping Li
     C                     MOVEL*BLANK    WN0008           PFS Shipping Li
     C                     MOVEL*BLANK    WN0009           PFS Shipping Li
     C                     MOVEL*BLANK    WN0010           PFS Shipping Li
     C                     MOVEL*BLANK    WN0011           PFS Shipping Li
     C                     MOVEL*BLANK    WN0012           PFS Shipping Li
     C                     MOVEL*BLANK    WN0013           PFS Shipping LI
     C                     MOVEL*BLANK    WN0014           PFS Vessel Name
     C                     MOVEL*BLANK    WN0015           PFS Voyage
     C                     MOVEL*BLANK    WN0016           PFS Discharge P
     C                     MOVEL*BLANK    WN0017           PFS Booking Num
     C                     MOVEL*BLANK    WN0018           PFS Shipping Me
     C                     MOVEL*BLANK    WN0019           PFS Load Shag F
     C                     MOVEL*BLANK    WN0020           PFS Load Wash F
     C                     Z-ADD*ZERO     WN0021           PFS Load Total
     C                     Z-ADD*ZERO     WN0022           PFS Load Total
     C                     Z-ADD*ZERO     WN0023           PFS Reefer Temp
     C                     MOVEL*BLANK    WN0024           PFS Reefer Temp
     C                     Z-ADD*ZERO     WN0025           PFS Load Sched
     C                     Z-ADD*ZERO     WN0026           PFS Load Sched
     C                     Z-ADD*ZERO     WN0027           PFS Load Deadli
     C                     Z-ADD*ZERO     WN0028           PFS Load Deadli
     C                     Z-ADD*ZERO     WN0029           PFS Maximum Loa
     C                     MOVEL*BLANK    WN0030           PFS Federal Tax
     C                     Z-ADD*ZERO     WN0031           PFS Estimated P
     C                     Z-ADD*ZERO     WN0032           PFS Average Pal
     C                     Z-ADD*ZERO     WN0033           PFS Predicted L
     C                     MOVEL*BLANK    WN0034           PFS Load Status
     C                     MOVEL*BLANK    WN0035           PFS Trailer Id
     C                     MOVEL*BLANK    WN0036           PFS Load Unused
     C                     MOVEL*BLANK    WN0037           PFS Load Unused
     C                     MOVEL*BLANK    WN0038           PFS Load Unused
     C                     MOVEL*BLANK    WN0039           PFS Load Unused
     C                     MOVEL*BLANK    WN0040           PFS Load Unused
     C                     MOVEL*BLANK    WN0041           PFS Load Unused
     C                     MOVEL*BLANK    WN0042           PFS Record Stat
     C                     Z-ADD*ZERO     WN0043           Number Pallets
     C                     Z-ADD*ZERO     WN0044           Weight 1 USR
     C                     MOVEL*BLANK    WN0045           Receipt Order S
      * EXIT: If PAR.Load ID Entered and PAR.Load ID NE DB1.Load ID
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load ID is NE Blank
      *   |- c2    : DB1.Load ID NE PAR.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFNE 0                          *IF
     C           WBRMNB    IFNE P1RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CHK:  Send to PFS
     C                     EXSR UASUBR                     CHK:  Send to P
      * RTV Any Ord/Blk OR Hld RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * CHK: Order Status
      * CASE: LCL.USR Check Y/N Status is no
     C           YL0030    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0002           PFS Send Sts US
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0031    IFEQ 'B'                        *IF
     C                     MOVEL'N'       YL0002           PFS Send Sts US
     C                     END                             *FI
      * CASE: LCL.Hold Order is yes
     C           YL0032    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0002           PFS Send Sts US
     C                     END                             *FI
     C                     END                             *FI
      * 01/29/09 PKD If Carrier Code is blank, do not send anything
      * CHK: Carrier Code
      * CASE: DB1.Carrier Code is not entered
     C           WBBZNA    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       YL0002           PFS Send Sts US
     C                     END                             *FI
      * ** Create PFS file records if PFS Send Status is Yes
      * CASE: LCL.PFS Send Sts USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * ****************
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UBSUBR                     Get Next PFS Se
      * ****************
      * *** CREATE ORDER HEADER, ORDER DETAIL, & SHIPPING INSTRUCTIONS **
      * **  Get Export Instruction information from OHE by order number
      * ** in the following function. The passed in shipping line par
      * ** will be blank at this point because is is no longer used.
      * PFS Order Header/Dtl  XF - PFS Order Header  * 
     C                     CALL 'PPNJXFR'              90  PFS Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBRMNB    WQ0004  70       Load ID
     C                     PARM WBPKST    WQ0005  1        Load Status
     C                     PARM WBBZNA    WQ0006  3        Carrier Code
     C           WN0043    PARM WN0043    WQ0007  50       Number Pallets
     C           WN0044    PARM WN0044    WQ0008 112       Weight 1 USR
     C                     PARM YL0034    WQ0009  3        Shipping Line
     C           YL0035    PARM YL0035    WQ0010 20        Port Delv Termi
     C                     PARM YL0033    WQ0011  90       PFS Sequence No
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Fill in PFS Load Header Fields (export instr are cleared here)
      * *** CREATE LOAD HEADER ***
     C                     EXSR UCSUBR                     *** CREATE LOAD
     C                     END                             *FI
     C                     READ @FJCPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           USR Warehouse C
     C                     MOVEL*BLANK    YL0014           USR CDE Parm 1
     C                     MOVEL*BLANK    YL0015           USR CDE Parm 2
     C                     MOVEL*BLANK    YL0016           USR CDE Parm 3
     C                     MOVEL*BLANK    YL0017           USR CDE Parm 4
     C                     MOVEL*BLANK    YL0018           USR CDE Parm 5
     C                     MOVEL*BLANK    YL0019           USR CDE Parm 6
     C                     MOVEL*BLANK    YL0020           USR CDE Parm 7
     C                     MOVEL*BLANK    YL0021           USR CDE Parm 8
     C                     MOVEL*BLANK    YL0022           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FLCPKF                    *
     C           KRSSC     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR SDRVGN
     C           KRSSC     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSD01           Company Number
     C                     Z-ADDWCC4NB    WQSD02           Order Number
     C                     Z-ADD0         WDDPNB           Order Sequence
     C                     Z-ADD0         WDUENB           Order Secondary
      * Establish starting position
     C           KPSSD     SETLL@BGWKAE                    *
     C           KRSSD     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WDAJCD    IFEQ YL0013                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WDAJCD    IFEQ YL0014                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WDAJCD    IFEQ YL0015                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WDAJCD    IFEQ YL0016                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WDAJCD    IFEQ YL0017                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WDAJCD    IFEQ YL0018                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WDAJCD    IFEQ YL0019                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WDAJCD    IFEQ YL0020                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WDAJCD    IFEQ YL0021                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WDAJCD    IFEQ YL0022                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           YL0013    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0013           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           YL0014    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0014           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           YL0015    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0015           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           YL0016    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0016           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           YL0017    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0017           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           YL0018    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0018           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           YL0019    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0019           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           YL0020    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0020           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           YL0021    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0021           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           YL0022    IFEQ WUGSTX                     *IF
     C                     MOVELWDAJCD    YL0022           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Shipping Compan
     C                     MOVEL*BLANK    WL0003           WHS Live w/Carl
     C                     MOVEL*BLANK    WL0004           WHS PFS Interfa
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBWC3    WL0002           Shipping Compan
     C                     MOVELWERRSX    WL0003           WHS Live w/Carl
     C                     MOVELWERSSX    WL0004           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Chk f/Receipt Ord RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0045           Receipt Order S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@BFCPD9                    *
     C           KRSSF     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PFS Ship To Warehouse * RMC PFS015 If TR order, send to pfs if to
      * CASE: DB1.Order Type - Sales is Transfer Order
     C           WAJNCD    IFEQ 'TR'                       *IF
      * Get FROM Whse info---
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SGRVGN
      * Rtv Liv w/Carl,Locatn RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0026    WL0005    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0027    P      Warehouse Locat
     C                     MOVELWL0007    YL0028    P      WHS Live w/Carl
     C                     MOVELWL0008    YL0029    P      WHS PFS Interfa
      * Get TO Whse info---
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR SIRVGN
      * Rtv Liv w/Carl,Locatn RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUAJCD    WL0005    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0007    WURRSX    P      WHS Live w/Carl
     C                     MOVELWL0008    WURSSX    P      WHS PFS Interfa
      * If From Whse is Ext & Live=No, and TO Whse is Internal and Live=Y
      * CASE:
      *  - c4ANDc1ANDc2ANDc3
      *   |- c4    : LCL.WHS Live w/Carlisle is No
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : WRK.Warehouse Location is Internal (Plant)
      *   |- c3    : WRK.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0028    IFEQ 'N'                        *IF
     C           YL0027    IFEQ 'E'                        *IF
     C           WUT0ST    IFEQ 'I'                        *IF
     C           WURRSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0045           Receipt Order S
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSG01           Company Number
     C                     Z-ADDWAC4NB    WQSG02           Order Number
     C                     Z-ADD0         WFDPNB           Order Sequence
     C                     Z-ADD0         WFUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWFAJCD    YL0026           Warehouse Code
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Liv w/Carl,Locatn RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0005    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Warehouse Locat
     C                     MOVEL*BLANK    WL0007           WHS Live w/Carl
     C                     MOVEL*BLANK    WL0008           WHS PFS Interfa
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWET0ST    WL0006           Warehouse Locat
     C                     MOVELWERRSX    WL0007           WHS Live w/Carl
     C                     MOVELWERSSX    WL0008           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WGAIC3           Company Number
     C                     Z-ADDWABKC7    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAJCD           Warehouse Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAJCD    WUAJCD           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk OR Hld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    YL0030           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       YL0031           Block Order Fla
     C                     MOVEL'N'       YL0032           Hold Order
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSJ02           Load ID
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSJ02           Load ID
      * Establish starting position
     C           KRSSJ     SETLL@BFCPD9                    *
     C           KRSSJ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0030           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
     C                     MOVELWABCST    YL0031           Block Order Fla
     C                     END                             *FI
      * CASE: DB1.Header Status is Hold
     C           WAGWST    IFEQ 'H'                        *IF
     C                     MOVEL'Y'       YL0032           Hold Order
     C                     END                             *FI
     C           KRSSJ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0009    WHAIC3           Company Number
     C                     MOVELWL0010    WHV8CD           Company Value C
      * Establish starting position
     C           KRSSK     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHM8NB    WL0011           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * PFS Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIBZNA           Carrier Code
      * Setup key
     C                     MOVELWBBZNA    WIBZNA           Carrier Code
      * Establish starting position
     C           KRSSL     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0005           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIADTX    WN0005           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Name, Address, Fax RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIBZNA           Carrier Code
      * Setup key
     C                     MOVELWBBZNA    WIBZNA           Carrier Code
      * Establish starting position
     C           KRSSM     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0008           Name
     C                     MOVEL*BLANK    WN0009           Address Line 1
     C                     MOVEL*BLANK    WN0010           Address Line 2
     C                     MOVEL*BLANK    WN0011           City
     C                     MOVEL*BLANK    WN0013           Zip/Postal Code
     C                     MOVEL*BLANK    WN0012           State Code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIADTX    WN0008           Name
     C                     MOVELWIACNA    WN0009           Address Line 1
     C                     MOVELWIADNA    WN0010           Address Line 2
     C                     MOVELWIAJNA    WN0011           City
     C                     MOVELWIBTTX    WN0013           Zip/Postal Code
     C                     MOVELWIBGCD    WN0012           State Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV First Appd Dt TMS RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJRMNB    WQSN02           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN02           Load ID
     C                     KFLD           WJRVNB           Stop/Drop
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSN02           Load ID
     C                     Z-ADD1         WJRVNB           Stop/Drop
      * Establish starting position
     C           KPSSN     SETLL@FLCPEB                    *
     C           KRSSN     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJN7DT    YL0036           LD Carrier Appt
     C                     Z-ADDWJB3TM    YL0037           LD Carrier Appt
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Federal ID         RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAIC3           Company Number
      * Setup key
     C                     Z-ADDWBAIC3    WKAIC3           Company Number
      * Establish starting position
     C           KRSSO     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKA2NA    WN0030           Federal Tax Id.
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLRONB           Truck Size
      * Setup key
     C                     MOVELWBRONB    WLRONB           Truck Size
      * Establish starting position
     C           KRSSP     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0029           Maximum pounds
     C                     Z-ADD*ZERO     YL0041           Minimum pounds
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLRSNB    WN0029           Maximum pounds
     C                     Z-ADDWLTANB    YL0041           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Gross Weight Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0033           USR Weight Accu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQSQ01           Load ID
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Load ID
     C                     KFLD           WMRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSQ01           Load ID
     C                     Z-ADD0         WMRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSQ     SETLL@FLCPBW                    *
     C           KRSSQ     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Rtv pallet tare and send into gross weight calc   E000261
      * RTV Pallet/Tare        RT - Load Header  * 
     C                     EXSR SRRVGN
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WMAIC3    WQ0012  30       Company Number
     C                     PARM WMC4NB    WQ0013  70       Order Number
     C                     PARM 0         WQ0014  30       Order Sequence
     C                     PARM 0         WQ0015  30       Order Secondary
     C           WN0033    PARM WN0033    WQ0016 112       USR Weight Accu
     C           YL0045    PARM YL0045    WQ0017 112       Order Quantity
     C                     PARM YL0043    WQ0018  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSQ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WORMNB           Load ID
      * Setup key
     C                     Z-ADDWMRMNB    WORMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOKNNX    YL0042           Pallets Loaded
     C                     Z-ADDWOICWG    YL0043           Avg Pallet Tare
     C                     Z-ADDWOIDWG    YL0044           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv ShipLine Info PFS RT - Order Header TRG  * change for TMS li
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E4119 RMC 7/5/16 If mg created load, then ............... get
      *   the shipping line info from the TMS International Shipmnt file
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRRMNB    WQSS01           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSS01           Load ID
      * Establish starting position
     C           KRSSS     SETLL@BFCPR0                    *
     C           KRSSS     READE@BFCPR0                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Not cancelled
     C           WRGWST    IFEQ 'L'                        *IF
     C           WRGWST    OREQ 'A'
     C           WRGWST    OREQ 'C'
     C           WRGWST    OREQ 'R'
     C           WRGWST    OREQ 'E'
     C           WRGWST    OREQ 'H'
     C           WRGWST    OREQ 'I'
      * CASE: DB1.Export Status is yes
     C           WRU2ST    IFEQ 'Y'                        *IF
      * RTV OHE Ship fields    RT - Order Header Extension  * 
     C                     EXSR STRVGN
      * CASE: PAR.MG Created Load is Yes
     C           WBRYSX    IFEQ 'Y'                        *IF
      * Exc Rtv Shpng Ln /PFS XF - TMS International Shipmnt  * 
     C                     CALL 'PBXUXFR'              90  Exc Rtv Shpng L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRC4NB    WQ0019  70       TMS Order ID
     C           WN0008    PARM *BLANK    WQ0020 50        TMS Address Nam
     C           WN0009    PARM *BLANK    WQ0021 50        TMS Address Lin
     C           WN0010    PARM *BLANK    WQ0022 50        TMS Address Lin
     C           WN0011    PARM *BLANK    WQ0023 50        TMS City
     C           WN0012    PARM *BLANK    WQ0024 50        TMS State Provi
     C           WN0013    PARM *BLANK    WQ0025 20        TMS Postal Code
     C           YL0048    PARM *BLANK    WQ0026 10        TMS Country Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR SURVGN
     C                     MOVELYL0046    WN0007           PFS Shipping Li
     C                     MOVEL*BLANK    WN0008           PFS Shipping Li
     C                     MOVELYL0047    WN0008           PFS Shipping Li
     C                     END                             *FI
     C                     GOTO SSEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
      * Setup key
     C                     Z-ADDWRAIC3    WSAIC3           Company Number
     C                     Z-ADDWRC4NB    WSC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0046           Shipping Line
     C                     MOVEL*BLANK    YL0047           Port Delv Termi
     C                     MOVEL*BLANK    WN0011           OHE City
     C                     MOVEL*BLANK    WN0014           OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0015           OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0017           OHE Booking Num
     C                     MOVEL*BLANK    WN0016           OHE Discharge P
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSXACD    YL0046           Shipping Line
     C                     MOVELWSOANA    YL0047           Port Delv Termi
     C                     MOVELWSHBAA    WN0011           OHE City
     C                     MOVELWSJ0T1    WN0014           OHE Vessel/Airl
     C                     MOVELWSGENY    WN0015           OHE Voyage/Flig
     C                     MOVELWSJ1T1    WN0017           OHE Booking Num
     C                     MOVELWSHCAA    WN0016           OHE Discharge P
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WTXACD           Shipping Line
     C                     KFLD           WTOANA           Port Delv Termi
      * Setup key
     C                     MOVELYL0046    WTXACD           Shipping Line
     C                     MOVELYL0047    WTOANA           Port Delv Termi
      * Establish starting position
     C           KRSSU     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0011           Port City
     C                     MOVEL*BLANK    WN0009           Port Address Li
     C                     MOVEL*BLANK    WN0010           Port Address Li
     C                     MOVEL*BLANK    WN0012           Sail Port State
     C                     MOVEL*BLANK    WN0013           Port Zip/Postal
     C                     Z-ADD*ZERO     YL0049           Port Phone Numb
     C                     MOVEL*BLANK    YL0050           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTOKTX    WN0011           Port City
     C                     MOVELWTLBTX    WN0009           Port Address Li
     C                     MOVELWTLATX    WN0010           Port Address Li
     C                     MOVELWTXBCD    WN0012           Sail Port State
     C                     MOVELWTLCTX    WN0013           Port Zip/Postal
     C                     Z-ADDWTSPPN    YL0049           Port Phone Numb
     C                     MOVELWTLDTX    YL0050           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Upd Load Header       RT - PFS Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0054  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0055  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0056  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0057  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0058  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0059  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVZGNX           PFS Load ID
      * Setup key
     C                     Z-ADDWL0012    WVY1NX           PFS Company Num
     C                     Z-ADDWL0013    WVZGNX           PFS Load ID
      * Establish starting position
     C           KRSSV     CHAIN@BACPZJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3484' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Load Header   CR - PFS Load Header  * 
     C                     EXSR SWCRRC
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Load Header   CH - PFS Load Header  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Crt PFS Load Header   CR - PFS Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BACPZI
     C                     Z-ADDWL0012    WWY1NX           PFS Company Num
     C                     Z-ADDWL0013    WWZGNX           PFS Load ID
     C                     Z-ADDWL0014    WWAWNY           PFS Sched Seque
     C                     MOVELWL0015    WWF4AA           PFS Carrier Cod
     C                     MOVELWL0016    WWFQT1           PFS Carrier Nam
     C                     MOVELWL0017    WWVBSX           PFS Export Stat
     C                     MOVELWL0018    WWF5AA           PFS Shipping Li
     C                     MOVELWL0019    WWFRT1           PFS Shipping Li
     C                     MOVELWL0020    WWFST1           PFS Shipping Li
     C                     MOVELWL0021    WWFTT1           PFS Shipping Li
     C                     MOVELWL0022    WWFUT1           PFS Shipping Li
     C                     MOVELWL0023    WWFVT1           PFS Shipping Li
     C                     MOVELWL0024    WWFWT1           PFS Shipping LI
     C                     MOVELWL0025    WWFXT1           PFS Vessel Name
     C                     MOVELWL0026    WWZLNX           PFS Voyage
     C                     MOVELWL0027    WWF7AA           PFS Discharge P
     C                     MOVELWL0028    WWF6AA           PFS Booking Num
     C                     MOVELWL0029    WWU7SX           PFS Shipping Me
     C                     MOVELWL0030    WWU9SX           PFS Load Shag F
     C                     MOVELWL0031    WWVASX           PFS Load Wash F
     C                     Z-ADDWL0032    WWZMNX           PFS Load Total
     C                     Z-ADDWL0033    WWZNNX           PFS Load Total
     C                     Z-ADDWL0034    WWZONX           PFS Reefer Temp
     C                     MOVELWL0035    WWU8SX           PFS Reefer Temp
     C                     Z-ADDWL0036    WWZHNX           PFS Load Sched
     C                     Z-ADDWL0037    WWZINX           PFS Load Sched
     C                     Z-ADDWL0038    WWZJNX           PFS Load Deadli
     C                     Z-ADDWL0039    WWZKNX           PFS Load Deadli
     C                     Z-ADDWL0040    WWBLNY           PFS Maximum Loa
     C                     MOVELWL0041    WWFYT1           PFS Federal Tax
     C                     Z-ADDWL0042    WWBKNY           PFS Estimated P
     C                     Z-ADDWL0043    WWATNY           PFS Average Pal
     C                     Z-ADDWL0044    WWB4NY           PFS Predicted L
     C                     MOVELWL0045    WWY7SX           PFS Load Status
     C                     MOVELWL0046    WWHST1           PFS Trailer Id
     C                     Z-ADDWL0047    WWF5NY           PFS Sequence No
     C                     MOVELWL0048    WWY8SX           PFS Load Unused
     C                     MOVELWL0049    WWY9SX           PFS Load Unused
     C                     MOVELWL0050    WWZASX           PFS Load Unused
     C                     MOVELWL0051    WWZBSX           PFS Load Unused
     C                     MOVELWL0052    WWZCSX           PFS Load Unused
     C                     MOVELWL0053    WWMWU1           PFS Load Unused
     C                     MOVELWL0054    WWUWSX           PFS Record Stat
     C                     Z-ADDWN0054    WWUXSX           PFS Process Sta
     C                     MOVELWN0055    WWV3SX           PFS Error Reaso
     C                     Z-ADDWN0056    WWAHNY           PFS Create Date
     C                     Z-ADDWN0057    WWAINY           PFS Create Time
     C                     Z-ADDWN0058    WWAJNY           PFS Change Date
     C                     Z-ADDWN0059    WWAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD0         WWUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WWAHNY           PFS Create Date
     C                     Z-ADD##JTM     WWAINY           PFS Create Time
     C           KLCRSW    KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWZGNX           PFS Load ID
      * Check for duplicate primary key
     C           KLCRSW    SETLL@BACPZI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3485' W0RTN   7
      * Send message 'PFS Load Header        EX'
     C                     MOVEL'USR3485' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@BACPZI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg PFS Load Header   CH - PFS Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0061  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0062  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0063  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0064  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0065  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BACPZI
     C                     Z-ADDWL0012    WWY1NX           PFS Company Num
     C                     Z-ADDWL0013    WWZGNX           PFS Load ID
      *
     C           KLCHSX    KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWZGNX           PFS Load ID
     C           KLCHSX    CHAIN@BACPZI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBACPL0'MDACP
     C                     MOVEL'@BACPZI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBA1    YARDCS
      * Move non-key fields to @BACPZI
     C                     Z-ADDWL0014    WWAWNY           PFS Sched Seque
     C                     MOVELWL0015    WWF4AA    P      PFS Carrier Cod
     C                     MOVELWL0016    WWFQT1    P      PFS Carrier Nam
     C                     MOVELWL0017    WWVBSX    P      PFS Export Stat
     C                     MOVELWL0018    WWF5AA    P      PFS Shipping Li
     C                     MOVELWL0019    WWFRT1    P      PFS Shipping Li
     C                     MOVELWL0020    WWFST1    P      PFS Shipping Li
     C                     MOVELWL0021    WWFTT1    P      PFS Shipping Li
     C                     MOVELWL0022    WWFUT1    P      PFS Shipping Li
     C                     MOVELWL0023    WWFVT1    P      PFS Shipping Li
     C                     MOVELWL0024    WWFWT1    P      PFS Shipping LI
     C                     MOVELWL0025    WWFXT1    P      PFS Vessel Name
     C                     MOVELWL0026    WWZLNX    P      PFS Voyage
     C                     MOVELWL0027    WWF7AA    P      PFS Discharge P
     C                     MOVELWL0028    WWF6AA    P      PFS Booking Num
     C                     MOVELWL0029    WWU7SX    P      PFS Shipping Me
     C                     MOVELWL0030    WWU9SX    P      PFS Load Shag F
     C                     MOVELWL0031    WWVASX    P      PFS Load Wash F
     C                     Z-ADDWL0032    WWZMNX           PFS Load Total
     C                     Z-ADDWL0033    WWZNNX           PFS Load Total
     C                     Z-ADDWL0034    WWZONX           PFS Reefer Temp
     C                     MOVELWL0035    WWU8SX    P      PFS Reefer Temp
     C                     Z-ADDWL0036    WWZHNX           PFS Load Sched
     C                     Z-ADDWL0037    WWZINX           PFS Load Sched
     C                     Z-ADDWL0038    WWZJNX           PFS Load Deadli
     C                     Z-ADDWL0039    WWZKNX           PFS Load Deadli
     C                     Z-ADDWL0040    WWBLNY           PFS Maximum Loa
     C                     MOVELWL0041    WWFYT1    P      PFS Federal Tax
     C                     Z-ADDWL0042    WWBKNY           PFS Estimated P
     C                     Z-ADDWL0043    WWATNY           PFS Average Pal
     C                     Z-ADDWL0044    WWB4NY           PFS Predicted L
     C                     MOVELWL0045    WWY7SX    P      PFS Load Status
     C                     MOVELWL0046    WWHST1    P      PFS Trailer Id
     C                     Z-ADDWL0047    WWF5NY           PFS Sequence No
     C                     MOVELWL0048    WWY8SX    P      PFS Load Unused
     C                     MOVELWL0049    WWY9SX    P      PFS Load Unused
     C                     MOVELWL0050    WWZASX    P      PFS Load Unused
     C                     MOVELWL0051    WWZBSX    P      PFS Load Unused
     C                     MOVELWL0052    WWZCSX    P      PFS Load Unused
     C                     MOVELWL0053    WWMWU1    P      PFS Load Unused
     C                     MOVELWL0054    WWUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WWAJNY           PFS Change Date
     C                     Z-ADD##JTM     WWAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BACPZI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * CHK:  Send to PFS
      *================================================================
     C                     MOVEL'N'       YL0002           PFS Send Sts US
     C                     Z-ADD0         YL0003           USR Company Num
     C                     Z-ADD0         YL0004           USR Company Num
     C                     Z-ADD0         YL0005           USR Company Num
     C                     Z-ADD0         YL0006           USR Company Num
     C                     Z-ADD0         YL0007           USR Company Num
     C                     Z-ADD0         YL0008           USR Company Num
     C                     Z-ADD0         YL0009           USR Company Num
     C                     Z-ADD0         YL0010           USR Company Num
     C                     Z-ADD0         YL0011           USR Company Num
     C                     Z-ADD0         YL0012           USR Company Num
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR SCRVGN
      * 10/20/06 PKD Changed to check WHS PFS LD/ORD Interface
      * USR Warehouse Code
      * CASE: LCL.USR Warehouse Code is Warehouse Code not Blank
     C           YL0013    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0012           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 1
      * CASE: LCL.USR CDE Parm 1 is Warehouse Code not Blank
     C           YL0014    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0014    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0003           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 2
      * CASE: LCL.USR CDE Parm 2 is Warehouse Code not Blank
     C           YL0015    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0015    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0004           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 3
      * CASE: LCL.USR CDE Parm 3 is Warehouse Code not Blank
     C           YL0016    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0016    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0005           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 4
      * CASE: LCL.USR CDE Parm 4 is Warehouse Code not Blank
     C           YL0017    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0017    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0006           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 5
      * CASE: LCL.USR CDE Parm 5 is Warehouse Code not Blank
     C           YL0018    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0018    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0007           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 6
      * CASE: LCL.USR CDE Parm 6 is Warehouse Code not Blank
     C           YL0019    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0019    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0008           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 7
      * CASE: LCL.USR CDE Parm 7 is Warehouse Code not Blank
     C           YL0020    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0020    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0009           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 8
      * CASE: LCL.USR CDE Parm 8 is Warehouse Code not Blank
     C           YL0021    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0021    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0010           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * USR CDE Parm 9
      * CASE: LCL.USR CDE Parm 9 is Warehouse Code not Blank
     C           YL0022    IFNE *BLANK                     *IF
      * Rtv Live w/CT PFS,SCO RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0022    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0023           Shipping Compan
     C                     MOVELWL0003    YL0024    P      WHS Live w/Carl
     C                     MOVELWL0004    YL0025    P      WHS PFS Interfa
      * PFS Send Sts = Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Download/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0024    IFEQ 'Y'                        *IF
     C           YL0025    IFEQ 'D'                        *IF
     C           YL0025    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     Z-ADDYL0023    YL0011           USR Company Num
     C                     END                             *FI
     C                     END                             *FI
      * Receipt Order?    RMC 8/14/06 PFS015
      * CASE: LCL.PFS Send Sts USR is No
     C           YL0002    IFEQ 'N'                        *IF
      * RTV Chk f/Receipt Ord RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Receipt Order Sts USR is yes
     C           WN0045    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           PFS Send Sts US
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * Create all records for this order/load with same sequence.
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Skip 0
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C                     PARM YL0033    WQ0003 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * *** CREATE LOAD HEADER ***
      *================================================================
     C                     Z-ADDWBAIC3    WN0001           PFS Company Num
     C                     Z-ADDWBRMNB    WN0002           PFS Load ID
     C                     Z-ADDWBT4NB    WN0003           PFS Sched Seque
     C                     MOVELWBBZNA    WN0004           PFS Carrier Cod
      * RTV Carrier Name       RT - Carrier  * PFS Carrier
     C                     EXSR SLRVGN
     C                     MOVELWBU2ST    WN0006           PFS Export Stat
      * ** FP1101
      * RTV Name, Address, Fax RT - Carrier  * 
     C                     EXSR SMRVGN
     C                     MOVELWBDXTX    WN0035           PFS Trailer Id
     C                     MOVELWBQ2CD    WN0018           PFS Shipping Me
     C                     MOVELWBLSHG    WN0019           PFS Load Shag F
     C                     MOVELWBYPST    WN0020           PFS Load Wash F
     C                     Z-ADDWBRRNB    WN0021           PFS Load Total
      * ** Pass in Override miles, if entered, else total miles   E00207
      * CASE: DB1.Override Total Load Miles is Entered
     C           WBK2DT    IFNE 0                          *IF
     C                     Z-ADDWBK2DT    WN0022           PFS Load Total
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBTLMI    WN0022           PFS Load Total
     C                     END                             *FI
     C                     Z-ADDWBRNNB    WN0023           PFS Reefer Temp
     C                     MOVELWBWRTX    WN0024           PFS Reefer Temp
      * E4119 RMC 7/5/16 TMS Use appt date/time if there, else use req de
      * RTV First Appd Dt TMS RT - Load Detail  * 
     C                     EXSR SNRVGN
      * CASE: DB1.MG Created Load is Yes
     C           WBRYSX    IFEQ 'Y'                        *IF
      * dont populate here per Mike B 9.2.16
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0046  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0047  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0048  2        Month (Char) US
     C                     MOVEL*BLANK    WN0049  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WBEIDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0038
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WBEIDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0039
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WBEIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0040
     C                     MOVEL*BLANK    WN0047           Year Alpha (YYY
     C                     MOVELYL0038    WN0047           Year Alpha (YYY
     C                     MOVELYL0039    WN0048           Month (Char) US
     C                     MOVELYL0040    WN0049           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0047    CAT  WN0048:ZQ WN0046    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0046    CAT  WN0049:ZQ WN0046    P      Date (Char-8) U
     C                     MOVE WN0046    WN0025           Date Out (8,0)
     C                     Z-ADDWBATTM    WN0026           PFS Load Sched
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0050  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0051  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0052  2        Month (Char) US
     C                     MOVEL*BLANK    WN0053  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WBKZDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0038
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WBKZDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0039
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WBKZDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0040
     C                     MOVEL*BLANK    WN0051           Year Alpha (YYY
     C                     MOVELYL0038    WN0051           Year Alpha (YYY
     C                     MOVELYL0039    WN0052           Month (Char) US
     C                     MOVELYL0040    WN0053           Day   (Char) US
     C                     Z-ADD0         ZQ      50
     C           WN0051    CAT  WN0052:ZQ WN0050    P      Date (Char-8) U
     C                     Z-ADD0         ZQ      50
     C           WN0050    CAT  WN0053:ZQ WN0050    P      Date (Char-8) U
     C                     MOVE WN0050    WN0027           Date Out (8,0)
     C                     Z-ADDWBAXTM    WN0028           PFS Load Deadli
      * RTV Federal ID         RT - Company Name and Address  * 
     C                     EXSR SORVGN
      * Rtv Min & Max Pounds  RT - Truck Size  * 
     C                     EXSR SPRVGN
     C                     Z-ADDWN0043    WN0031           PFS Estimated P
      * RTV Gross Weight Load  RT - Load Detail  * 
     C                     EXSR SQRVGN
      * Rtv ShipLine Info PFS RT - Order Header TRG  * change for TMS liv
     C                     EXSR SSRVGN
      * ** Calc average pallet tare
      * CASE: PAR.Number Pallets Loaded is Not zero
     C           WN0043    IFNE 0                          *IF
     C           WN0044    DIV  WN0043    WN0032    H      PFS Average Pal
     C                     END                             *FI
      * ** Test load status
      * CASE: DB1.Load Status is Unlock
     C           WBPKST    IFEQ 'U'                        *IF
     C                     MOVEL'D'       WN0042           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0042           PFS Record Stat
     C                     END                             *FI
     C                     MOVELWBPKST    WN0034           PFS Load Status
      * 07/11/19 DN R15161-Sent in PAR.PFS Load Unused Text 1.
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0001    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
      * ** Only process Plant Companies    DLY029 LJB 04/27/2007
      * *** MULTI COMPANY LOAD ***       ** Only process whs live with PF
      * CASE: DB1.Multi Company Load is yes
     C           WBRVSX    IFEQ 'Y'                        *IF
      * RMC 10/18/2016  Comment the above and do it this way:
      * ** Create PFS Load header for other plant company USR Company 10
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 10 is greater than zero
      *   |- c2    : LCL.USR Company Number 10 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0012    IFGT 0                          *IF
     C           YL0012    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0012    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UDSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 1 is greater than zero
      *   |- c2    : LCL.USR Company Number 1 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFGT 0                          *IF
     C           YL0003    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0003    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UESUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 2
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 2 is greater than zero
      *   |- c2    : LCL.USR Company Number 2 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFGT 0                          *IF
     C           YL0004    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0004    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UFSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 3
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 3 is greater than zero
      *   |- c2    : LCL.USR Company Number 3 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFGT 0                          *IF
     C           YL0005    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0005    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UGSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 4
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 4 is greater than zero
      *   |- c2    : LCL.USR Company Number 4 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFGT 0                          *IF
     C           YL0006    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0006    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UHSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 5
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 5 is greater than zero
      *   |- c2    : LCL.USR Company Number 5 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFGT 0                          *IF
     C           YL0007    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0007    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UISUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 6
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 6 is greater than zero
      *   |- c2    : LCL.USR Company Number 6 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFGT 0                          *IF
     C           YL0008    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0008    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UJSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 7
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 7 is greater than zero
      *   |- c2    : LCL.USR Company Number 7 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFGT 0                          *IF
     C           YL0009    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0009    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UKSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 8
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 8 is greater than zero
      *   |- c2    : LCL.USR Company Number 8 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFGT 0                          *IF
     C           YL0010    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0010    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR ULSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
      * ** Create PFS Load header for other plant company USR Company 9
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number 9 is greater than zero
      *   |- c2    : LCL.USR Company Number 9 NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFGT 0                          *IF
     C           YL0011    IFNE WBAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0011    WUAIC3           Company Number
      * Get Next PFS Sequence No         -- RMC 03/14/07
     C                     EXSR UMSUBR                     Get Next PFS Se
      * Upd Load Header       RT - PFS Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0012           PFS Company Num
     C                     Z-ADDWN0002    WL0013           PFS Load ID
     C                     Z-ADDWN0003    WL0014           PFS Sched Seque
     C                     MOVELWN0004    WL0015    P      PFS Carrier Cod
     C                     MOVELWN0005    WL0016    P      PFS Carrier Nam
     C                     MOVELWN0006    WL0017    P      PFS Export Stat
     C                     MOVELWN0007    WL0018    P      PFS Shipping Li
     C                     MOVELWN0008    WL0019    P      PFS Shipping Li
     C                     MOVELWN0009    WL0020    P      PFS Shipping Li
     C                     MOVELWN0010    WL0021    P      PFS Shipping Li
     C                     MOVELWN0011    WL0022    P      PFS Shipping Li
     C                     MOVELWN0012    WL0023    P      PFS Shipping Li
     C                     MOVELWN0013    WL0024    P      PFS Shipping LI
     C                     MOVELWN0014    WL0025    P      PFS Vessel Name
     C                     MOVELWN0015    WL0026    P      PFS Voyage
     C                     MOVELWN0016    WL0027    P      PFS Discharge P
     C                     MOVELWN0017    WL0028    P      PFS Booking Num
     C                     MOVELWN0018    WL0029    P      PFS Shipping Me
     C                     MOVELWN0019    WL0030    P      PFS Load Shag F
     C                     MOVELWN0020    WL0031    P      PFS Load Wash F
     C                     Z-ADDWN0021    WL0032           PFS Load Total
     C                     Z-ADDWN0022    WL0033           PFS Load Total
     C                     Z-ADDWN0023    WL0034           PFS Reefer Temp
     C                     MOVELWN0024    WL0035    P      PFS Reefer Temp
     C                     Z-ADDWN0025    WL0036           PFS Load Sched
     C                     Z-ADDWN0026    WL0037           PFS Load Sched
     C                     Z-ADDWN0027    WL0038           PFS Load Deadli
     C                     Z-ADDWN0028    WL0039           PFS Load Deadli
     C                     Z-ADDWN0029    WL0040           PFS Maximum Loa
     C                     MOVELWN0030    WL0041    P      PFS Federal Tax
     C                     Z-ADDWN0031    WL0042           PFS Estimated P
     C                     Z-ADDWN0032    WL0043           PFS Average Pal
     C                     Z-ADDWN0033    WL0044           PFS Predicted L
     C                     MOVELWN0034    WL0045    P      PFS Load Status
     C                     MOVELWN0035    WL0046    P      PFS Trailer Id
     C                     Z-ADDYL0033    WL0047           PFS Sequence No
     C                     MOVELWN0036    WL0048    P      PFS Load Unused
     C                     MOVELWN0037    WL0049    P      PFS Load Unused
     C                     MOVELWN0038    WL0050    P      PFS Load Unused
     C                     MOVELWN0039    WL0051    P      PFS Load Unused
     C                     MOVELWN0040    WL0052    P      PFS Load Unused
     C                     MOVELWN0041    WL0053    P      PFS Load Unused
     C                     MOVELWN0042    WL0054    P      PFS Record Stat
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0027  30       Company Number
     C                     PARM @CN,001   WQ0028 10        Company Value C
     C                     PARM YL0033    WQ0029 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0030  30       Company Number
     C                     PARM @CN,001   WQ0031 10        Company Value C
     C                     PARM YL0033    WQ0032 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0033  30       Company Number
     C                     PARM @CN,001   WQ0034 10        Company Value C
     C                     PARM YL0033    WQ0035 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0036  30       Company Number
     C                     PARM @CN,001   WQ0037 10        Company Value C
     C                     PARM YL0033    WQ0038 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0039  30       Company Number
     C                     PARM @CN,001   WQ0040 10        Company Value C
     C                     PARM YL0033    WQ0041 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0042  30       Company Number
     C                     PARM @CN,001   WQ0043 10        Company Value C
     C                     PARM YL0033    WQ0044 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0045  30       Company Number
     C                     PARM @CN,001   WQ0046 10        Company Value C
     C                     PARM YL0033    WQ0047 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0048  30       Company Number
     C                     PARM @CN,001   WQ0049 10        Company Value C
     C                     PARM YL0033    WQ0050 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0051  30       Company Number
     C                     PARM @CN,001   WQ0052 10        Company Value C
     C                     PARM YL0033    WQ0053 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Get Next PFS Sequence No         -- RMC 03/14/07
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     MOVEL@CN,001   WL0010    P      Company Value C
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0033           System Value Nu
     C                     ADD  1         YL0033           PFS Sequence No
      * Increment if -0-
      * CASE: LCL.PFS Sequence No. is eq 0
     C           YL0033    IFEQ 0                          *IF
     C                     ADD  1         YL0033           PFS Sequence No
     C                     END                             *FI
      * Rtv Chg Comp Val Num   XF - Company Values  * 
     C                     CALL 'PPW2XFR'              90  Rtv Chg Comp Va
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0054  30       Company Number
     C                     PARM @CN,001   WQ0055 10        Company Value C
     C                     PARM YL0033    WQ0056 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AIC3           Company Number
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGR5NB           Deliver after t
     C                     Z-ADD*ZERO     WGR6NB           Deliver before
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WGW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    WURRSX  1
      * Define work field WHS PFS Interface
     C                     MOVEL*BLANK    WURSSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHM8NB           System Value Nu
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WIEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WINRVA           Pallet Balance
     C                     Z-ADD*ZERO     WINSVA           Long hook balan
     C                     Z-ADD*ZERO     WINTVA           Short hook bala
     C                     Z-ADD*ZERO     WINUVA           Tub Balance
     C                     Z-ADD*ZERO     WIS8NB           Home Phone
     C                     Z-ADD*ZERO     WIS9NB           Other Phone
     C                     Z-ADD*ZERO     WINMVA           Flat Rate
     C                     Z-ADD*ZERO     WINOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WINPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WINQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WIQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WIRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WIBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WIB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WIAAC7           Contact Number
     C                     Z-ADD*ZERO     WITENO           Carrier Unused
     C                     Z-ADD*ZERO     WIAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WIAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WIKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WLRTNB           Maximum Units
     C                     Z-ADD*ZERO     WLTANB           Minimum pounds
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSRMNB           Load ID
     C                     Z-ADD*ZERO     WSRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WSQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WSQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WSQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WSGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WSHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WSHGVL           Transload Termi
     C                     Z-ADD*ZERO     WSQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WSQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WSQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WSQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WSITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WSQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WSQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WSQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WSP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WSP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WSQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WSQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WSQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WSQENY           Original Appoin
     C                     Z-ADD*ZERO     WSQFNY           Original Appoin
     C                     Z-ADD*ZERO     WSQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WSQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WSQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WSW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WVZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WVAWNY           PFS Sched Seque
     C                     Z-ADD*ZERO     WVZMNX           PFS Load Total
     C                     Z-ADD*ZERO     WVZNNX           PFS Load Total
     C                     Z-ADD*ZERO     WVZONX           PFS Reefer Temp
     C                     Z-ADD*ZERO     WVZHNX           PFS Load Sched
     C                     Z-ADD*ZERO     WVZINX           PFS Load Sched
     C                     Z-ADD*ZERO     WVZJNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WVZKNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WVBLNY           PFS Maximum Loa
     C                     Z-ADD*ZERO     WVBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WVATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WVB4NY           PFS Predicted L
     C                     Z-ADD*ZERO     WVF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WVUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WVAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WVAINY           PFS Create Time
     C                     Z-ADD*ZERO     WVAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WVAKNY           PFS Change time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     Z-ADD*ZERO     WL0002  30
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0005  3
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010 10
     C                     Z-ADD*ZERO     WL0011 155
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016 30
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 30
     C                     MOVEL*BLANK    WL0021 30
     C                     MOVEL*BLANK    WL0022 20
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 11
     C                     MOVEL*BLANK    WL0025 30
     C                     MOVEL*BLANK    WL0026 15
     C                     MOVEL*BLANK    WL0027 20
     C                     MOVEL*BLANK    WL0028 15
     C                     MOVEL*BLANK    WL0029  2
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     Z-ADD*ZERO     WL0032  20
     C                     Z-ADD*ZERO     WL0033  50
     C                     Z-ADD*ZERO     WL0034  52
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036  80
     C                     Z-ADD*ZERO     WL0037  60
     C                     Z-ADD*ZERO     WL0038  80
     C                     Z-ADD*ZERO     WL0039  60
     C                     Z-ADD*ZERO     WL0040  82
     C                     MOVEL*BLANK    WL0041 20
     C                     Z-ADD*ZERO     WL0042  50
     C                     Z-ADD*ZERO     WL0043  52
     C                     Z-ADD*ZERO     WL0044  82
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046 20
     C                     Z-ADD*ZERO     WL0047  90
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  2
     C                     MOVEL*BLANK    WL0052  2
     C                     MOVEL*BLANK    WL0053 15
     C                     MOVEL*BLANK    WL0054  1
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field PFS Send Sts USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field USR Company Number 1
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field USR Company Number 2
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field USR Company Number 3
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field USR Company Number 4
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field USR Company Number 5
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field USR Company Number 6
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field USR Company Number 7
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field USR Company Number 8
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field USR Company Number 9
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field USR Company Number 10
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field USR Warehouse Code
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field USR CDE Parm 1
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field USR CDE Parm 2
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field USR CDE Parm 3
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field USR CDE Parm 4
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field USR CDE Parm 5
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field USR CDE Parm 6
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field USR CDE Parm 7
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field USR CDE Parm 8
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field USR CDE Parm 9
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0026  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field USR Check Y/N Status
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Hold Order
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field PFS Sequence No.
     C                     Z-ADD*ZERO     YL0033  90
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0035 20
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Fax Number
     C                     MOVEL*BLANK    YN0002 25
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0037  60
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0038  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0039  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0040  20
      * Define local work field Minimum pounds
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0042  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0043  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0044  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0045 112
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0046  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0047 20
      * Define null work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field OHE Arrival Date
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YN0006  3
      * Define null work field OHE Ship Status
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field OHE Container Number
     C                     MOVEL*BLANK    YN0008 12
      * Define null work field OHE Comment 1
     C                     MOVEL*BLANK    YN0009 35
      * Define null work field OHE Comment 2
     C                     MOVEL*BLANK    YN0010 75
      * Define local work field TMS Country Code
     C                     MOVEL*BLANK    YL0048 10
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0049 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0050 25
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PFSSEQNO
