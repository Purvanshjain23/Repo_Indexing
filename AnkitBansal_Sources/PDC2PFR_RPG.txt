     H/TITLE PRT Bill of Lading-GUY PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 09/30/24  Time  : 01:37:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDJYREL1IF  E           K        DISK
      * RTV : Company Defaults Internal Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer Master           Active Only
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line_Port        Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FPBBTREL1IF  E           K        DISK
      * RTV : Item Default Extension    Retrieval index
      *
     FPUC8REL2IF  E           K        DISK
      * RSQ : Regulation Code Mst       Reg Code Mst By Regul ID
      *
     FPUB7CPL1IF  E           K        DISK
      * RTV : OH Pallet Table Shipped   Retrieval index
      *
     FPUB6CPL1IF  E           K        DISK
      * RTV : Pallet Master             Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPPB1REL1IF  E           K        DISK
      * RTV : Country Comment           Retrieval index
      *
     FPOAVCPL1IF  E           K        DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPOAVCPL2IF  E           K        DISK
      * RSQ : Customer Comment          Cust/Type/Seq(D)
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCAB7CPLYIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Order/LbDt,Trans Sl I
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar Master           RSQ Co/Date Descending
      *
     FPPAQREL2IF  E           K        DISK
      * RSQ : Company Document Defaults Co#/Dept/Type
      *
     FPDC2PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Bill of Lading-GUY PF Print file
      *
     E                    UAD         5 34               Name/Address
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WBAIC3
     I              JYZ9ST                          WBZ9ST
     I              JYCSST                          WBCSST
     I              JYZ8ST                          WBZ8ST
     I              JYCXST                          WBCXST
     I              JYSWST                          WBSWST
     I              JYXXTM                          WBXXTM
     I              JYUECD                          WBUECD
     I              JYHSST                          WBHSST
     I              JYAMEO                          WBAMEO
     I              JYSSDF                          WBSSDF
     I              JYPDFT                          WBPDFT
     I              JYYISX                          WBYISX
     I              JYYJSX                          WBYJSX
     I              JYYKSX                          WBYKSX
     I              JYYLSX                          WBYLSX
     I              JYYMSX                          WBYMSX
     I              JYYNSX                          WBYNSX
     I              JYUVST                          WBUVST
     I              JYUWST                          WBUWST
     I              JYUXST                          WBUXST
     I              JYVSST                          WBVSST
     I              JYAATM                          WBAATM
     I              JYAYNA                          WBAYNA
     I              JYA0NA                          WBA0NA
     I              JYAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@AVCPG5
      * Customer Comment          Cust/Type/Seq(D)
      * Renamed input format fields
     I              AVBKC7                          WDBKC7
     I              AVI1SX                          WDI1SX
     I              AVM5NX                          WDM5NX
     I              AVXRTX                          WDXRTX
     I              AVUVST                          WDUVST
     I              AVUWST                          WDUWST
     I              AVUXST                          WDUXST
     I              AVVSST                          WDVSST
     I              AVAATM                          WDAATM
     I              AVAYNA                          WDAYNA
     I              AVA0NA                          WDA0NA
     I              AVAXDT                          WDAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@B7CPJS
      * Item Transaction Detail   Co/Order/LbDt,Trans Sl I
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@AFREPU
      * Calendar Master           RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WGAIC3
     I              AFBCDT                          WGBCDT
     I              AFCQNB                          WGCQNB
     I              AFESNB                          WGESNB
     I              AFETNB                          WGETNB
     I              AFBZNB                          WGBZNB
     I              AFA9ST                          WGA9ST
     I              AFEINB                          WGEINB
     I              AFC5ST                          WGC5ST
     I              AFAQNB                          WGAQNB
     I              AFCMST                          WGCMST
     I              AFV9ST                          WGV9ST
     I              AFWAST                          WGWAST
     I              AFX2ST                          WGX2ST
     I              AFOJDT                          WGOJDT
     I              AFNQNX                          WGNQNX
     I              AFNRNX                          WGNRNX
     I              AFI9SX                          WGI9SX
     I              AFJASX                          WGJASX
     I              AFOKDT                          WGOKDT
     I              AFOLDT                          WGOLDT
     I              AFUVST                          WGUVST
     I              AFUWST                          WGUWST
     I              AFUXST                          WGUXST
     I              AFAATM                          WGAATM
     I              AFAYNA                          WGAYNA
     I              AFA0NA                          WGA0NA
     I              AFAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     I            DS
     I                                    B   1   20WUXFNX
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I : RST Load ID
     I                                    P   1   40P1RMNB
      * I : RST Company Number
     I                                    P   5   60P1AIC3
      * N :  Reefer Temperature
     I                                    P   7   92P1RNNB
      * N :  Seal 1
     I                                       10  24 P1DMTX
      * N :  Seal 2
     I                                       25  39 P1DNTX
      * N :  Seal 3
     I                                       40  54 P1DOTX
      * N :  Total Stops
     I                                    P  55  570P1RRNB
      * N :  Trailer Id
     I                                       58  77 P1DXTX
      * N :  BOL Time
     I                                    P  78  800P1SBNB
      * N :  Number Pallets Received
     I                                    P  81  830P1SDNB
      * N :  Number Pallets Loaded
     I                                    P  84  860P1PAOU
      * N :  Load Carrier Pay Amt
     I                                    P  87  922P1DGWG
      * N :  Product Temperature
     I                                    P  93  952P1PRTM
      * N :  Number Spacers Loaded
     I                                    P  96  980P1NPSV
      * N :  Car_Veh_Initials
     I                                       99 110 P1J8TX
      * N :  Recorder ID
     I                                      111 122 P1J9TX
      * N :  Shipping Method
     I                                      123 124 P1Q2CD
     IP2PARM      DS
      * N :  Record Found USR
     I                                        1   1 P2WXST
     IP3PARM      DS
      * B :  Unused Status USR
     I                                        1   1 P3AZSX
     IP4PARM      DS
      * N :  USR Page Number 3.0
     I                                    P   1   20P4PGNU
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P3AZSX    PARM P3AZSX    WP0003  1        Unused Status U
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Bill of Lading-GUY PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$RENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Bill of Lading-GUY PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJRMNB    WQKA01           Load ID
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQKA01           Load ID
      * Establish starting position
     C           KRSA      SETLL@FJCPBN                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFJAIC3    $CAIC3           Company Number
     C                     Z-ADDFJRMNB    $CRMNB           Load ID
     C                     Z-ADDFJAODT    $CAODT           Scheduled Ship
     C                     MOVELFJPJST    $CPJST           LTL Flag
     C                     MOVELFJPKST    $CPKST           Load Status
     C                     Z-ADDFJRNNB    $CRNNB           Reefer Temperat
     C                     MOVELFJDMTX    $CDMTX           Seal 1
     C                     MOVELFJDNTX    $CDNTX           Seal 2
     C                     MOVELFJDOTX    $CDOTX           Seal 3
     C                     MOVELFJWTTX    $CWTTX           Seal 4
     C                     MOVELFJWUTX    $CWUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    $CRPNB           Total Load Orde
     C                     Z-ADDFJFLAM    $CFLAM           Flat Amount
     C                     MOVELFJXQST    $CXQST           Allocate Pounds
     C                     Z-ADDFJRRNB    $CRRNB           Total Stops
     C                     MOVELFJDXTX    $CDXTX           Trailer Id
     C                     MOVELFJDYTX    $CDYTX           Transloader Car
     C                     Z-ADDFJSBNB    $CSBNB           BOL Time
     C                     MOVELFJBZNA    $CBZNA           Carrier Code
     C                     MOVELFJRONB    $CRONB           Truck Size
     C                     Z-ADDFJSQNB    $CSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    $CR1NB           Rated Freight
     C                     MOVELFJVCST    $CVCST           Ship Status
     C                     MOVELFJVDST    $CVDST           Load Type
     C                     Z-ADDFJSDNB    $CSDNB           Number Pallets
     C                     Z-ADDFJPAOU    $CPAOU           Number Pallets
     C                     Z-ADDFJDGWG    $CDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    $CSXNB           Estimated Arriv
     C                     Z-ADDFJHADT    $CHADT           Actual Arrival
     C                     Z-ADDFJAART    $CAART           Actual Arrival
     C                     Z-ADDFJDHWG    $CDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    $CDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    $CAQDT           Actual Departur
     C                     Z-ADDFJS6NB    $CS6NB           Departure Time
     C                     Z-ADDFJT4NB    $CT4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    $CPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $CNPSV           Number Spacers
     C                     MOVELFJJ8TX    $CJ8TX           Car_Veh_Initial
     C                     Z-ADDFJTLMI    $CTLMI           Total Load Mile
     C                     MOVELFJJ9TX    $CJ9TX           Recorder ID
     C                     MOVELFJQ2CD    $CQ2CD           Shipping Method
     C                     MOVELFJVPCD    $CVPCD           Ship From Wareh
     C                     MOVELFJDBCD    $CDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $CGRWE           Gross Weight
     C                     MOVELFJXCCD    $CXCCD           Carrier Broker
     C                     MOVELFJU2ST    $CU2ST           Export Status
     C                     Z-ADDFJF9DT    $CF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $CONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    $CJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $CTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $CJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $CSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $CJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $CLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $CJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $CBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $CJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $CBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $CKIDT           Truck Departure
     C                     Z-ADDFJASTM    $CASTM           Truck Departure
     C                     Z-ADDFJKADT    $CKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $CAJCM           Adjusted Depart
     C                     MOVELFJXACD    $CXACD           Shipping Line
     C                     MOVELFJOANA    $COANA           Port Delv Termi
     C                     MOVELFJK4TX    $CK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $CVOAG           Voyage
     C                     Z-ADDFJKBDT    $CKBDT           Sail Date
     C                     MOVELFJNBBO    $CNBBO           Booking Number
     C                     MOVELFJW4CD    $CW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $CEFDT           Arrival Date
     C                     MOVELFJCNTN    $CCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $CKCDT           Date In
     C                     Z-ADDFJTMIN    $CTMIN           Time In
     C                     Z-ADDFJKDDT    $CKDDT           Date Out
     C                     Z-ADDFJVMNB    $CVMNB           Time Out
     C                     Z-ADDFJOCFR    $COCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $CKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $CATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $COTRS           LH Unused Sts
     C                     MOVELFJRNST    $CRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $CBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $CEIDT           Requested Deliv
     C                     MOVELFJRMST    $CRMST           Load Acceptance
     C                     MOVELFJAJCD    $CAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $CKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $CAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $CKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $CAXTM           Deadline Depart
     C                     MOVELFJLHOS    $CLHOS           Load Held Over
     C                     MOVELFJLHOR    $CLHOR           Load Held Over
     C                     MOVELFJWNTX    $CWNTX           Load Held Over
     C                     MOVELFJOITX    $COITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $COJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $CLLDT           Express Mail Da
     C                     MOVELFJLSHG    $CLSHG           Load Shag Flag
     C                     MOVELFJYPST    $CYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $CK0DT           Product Complet
     C                     Z-ADDFJAYTM    $CAYTM           Product Complet
     C                     Z-ADDFJKNNX    $CKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $CICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $CIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $CH9SX           Load Confirmed
     C                     MOVELFJWOTX    $CWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $CK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $CAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $CK2DT           Override Total
     C                     Z-ADDFJA0TM    $CA0TM           Load Door 2
     C                     MOVELFJROST    $CROST           Partial Load
     C                     MOVELFJRPST    $CRPST           Load Confirmati
     C                     MOVELFJRQST    $CRQST           Export Load USD
     C                     MOVELFJRRST    $CRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $CZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $CWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $CWQTX           Late Billing Em
     C                     MOVELFJWRTX    $CWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $CWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $CRVSX           Multi Company L
     C                     MOVELFJRUSX    $CRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $CRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $CRXSX           LH Power Only L
     C                     MOVELFJRYSX    $CRYSX           MG Created Load
     C                     MOVELFJRZSX    $CRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $CR0SX           Load U_M
     C                     MOVELFJR1SX    $CR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $CR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $CR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $CR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $CPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $CCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $CPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $CCLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $CP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $CCMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $CP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $CCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $CP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $CCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $CP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $CCQTM           LH Unused Time
     C                     MOVELFJUVST    $CUVST           EDI Status 1
     C                     MOVELFJUWST    $CUWST           EDI Status 2
     C                     MOVELFJUXST    $CUXST           EDI Status 3
     C                     Z-ADDFJAATM    $CAATM           Job Time
     C                     MOVELFJAYNA    $CAYNA           User Id
     C                     MOVELFJA0NA    $CA0NA           Job Name
     C                     Z-ADDFJAXDT    $CAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT BOL Dtl - GUY      PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@FJCPBN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFA    IFEQ '1'
      * PRTOBJ calls before print of final totals format
      * Embedded PRTOBJ : Prt Document Comment  PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * USER: On print of final totals format
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Bill of Lading Dtl PO: Mainline
      *================================================================
      * PRT Bill of Lading Dtl PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKB02           Load ID
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQKB02           Load ID
      * Establish starting position
     C           KRSB      SETLL@FLCPEB                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop_Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $PRRNB           Total Stops
     C                     Z-ADD*ZERO     $PUQ70           USR Quantity 7,
     C                     Z-ADD*ZERO     $PFBWG           USR Weight 9.1
     C                     Z-ADD*ZERO     $PFCWG           USR Weight 9.1
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $NJNNA           USR Description
     C                     MOVEL*BLANK    $NDPNA           USR Description
     C                     Z-ADD*ZERO     $NF0WG           Gross Weight US
     C                     Z-ADD*ZERO     $NF4QT           USR Quantity Sh
     C                     Z-ADD*ZERO     $NCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     $NCPWG           USR Weight   9.
     C                     Z-ADDFLRMNB    $NRMNB           Load ID
     C                     Z-ADD*ZERO     $NUQ70           USR Quantity 7,
     C                     Z-ADD*ZERO     $NE9WG           Gross Weight US
     C                     Z-ADD*ZERO     $NFBWG           USR Weight 9.1
     C                     Z-ADD*ZERO     $NFCWG           USR Weight 9.1
     C                     Z-ADDFLAIC3    $NAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDFLAIC3    $LAIC3           Company Number
     C                     Z-ADDFLRVNB    $LRVNB           Stop_Drop
     C                     Z-ADD*ZERO     $LF4QT           USR Quantity Sh
     C                     Z-ADD*ZERO     $LCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     $LCPWG           USR Weight   9.
     C                     MOVEL*BLANK    $LVAU1           Non-Compliant S
     C                     MOVEL*BLANK    $LGIU1           @Text 80
     C                     Z-ADD*ZERO     $LUQ70           USR Quantity 7,
     C                     Z-ADD*ZERO     $LFCWG           USR Weight 9.1
     C                     Z-ADD*ZERO     $LFBWG           USR Weight 9.1
     C                     Z-ADDFLRMNB    $LRMNB           Load ID
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load key header format
     C                     MOVEL*BLANK    $DU2ST           Export Status
     C                     Z-ADDFLAIC3    $DAIC3           Company Number
     C                     Z-ADDFLRMNB    $DRMNB           Load ID
     C                     MOVEL*BLANK    $DYMSX           CDI Shipper
     C                     MOVEL*BLANK    $DPGTX           City/State/Zip
     C                     MOVEL*BLANK    $DA2NA           Federal Tax Id
     C                     MOVEL*BLANK    $DFUNA           USR Value Alpha
     C                     Z-ADD*ZERO     $DTINB           USR Transportat
     C                     Z-ADD*ZERO     $DPCNX           USR Temperature
     C                     MOVEL*BLANK    $DOINA           USR Blank Field
     C                     Z-ADD*ZERO     $DRNNB           Reefer Temperat
     C                     MOVEL*BLANK    $DFRSX           Shipping Temp C
     C                     Z-ADD*ZERO     $DPDNX           Temperature Cel
     C                     Z-ADD*ZERO     $DBBNX           Temperature Cel
     C                     MOVEL*BLANK    $DZ4TX           Seal 1 USR Alph
     C                     MOVEL*BLANK    $DZ5TX           Seal 2 USR Alph
     C                     MOVEL*BLANK    $DZ6TX           Seal 3 USR Alph
     C                     Z-ADD*ZERO     $DTGNB           USR Minimum Tem
     C                     Z-ADD*ZERO     $DSEA1           Seal 1 USR
     C                     Z-ADD*ZERO     $DSEA2           Seal 2 USR
     C                     Z-ADD*ZERO     $DSEA3           Seal 3 USR
     C                     Z-ADD*ZERO     $DPAOU           Number Pallets
     C                     Z-ADD*ZERO     $DSDNB           Number Pallets
     C                     Z-ADD*ZERO     $DNPSV           Number Spacers
     C                     MOVEL*BLANK    $DJ9TX           Recorder ID
     C                     MOVEL*BLANK    $DJ8TX           Car_Veh_Initial
     C                     MOVEL*BLANK    $DLSHG           Load Shag Flag
     C                     MOVEL*BLANK    $DYPST           Load Wash Flag
     C                     MOVEL*BLANK    $DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    $DHKNA           Status Descript
     C                     Z-ADD*ZERO     $DPGNU           USR Page Number
     C                     MOVEL*BLANK    $DULSP           USR Line Space
     C                     Z-ADD*ZERO     $DFADT           USR Date Shippe
     C                     Z-ADD*ZERO     $DWENB           USR Time
     C                     MOVEL*BLANK    $DIGTX           AS Trucking Com
     C                     Z-ADDFLKJDT    $DKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $DATTM           Scheduled Deliv
     C                     MOVEL*BLANK    $DCJT1           Time AM/PM
     C                     Z-ADD*ZERO     $DTLMI           Total Load Mile
     C                     MOVEL*BLANK    $DAWAA           Delivery Termin
     C                     MOVEL*BLANK    $DJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    $DXACD           Shipping Line
     C                     MOVEL*BLANK    $DK4TX           Vessel Name
     C                     Z-ADD*ZERO     $DVOAG           Voyage
     C                     MOVEL*BLANK    $DGENY           OHE Voyage_Flig
     C                     MOVEL*BLANK    $DNBBO           Booking Number
     C                     MOVEL*BLANK    $DW4CD           Discharge Port
     C                     Z-ADDFLC4NB    $DC4NB           Order Number
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVEL*BLANK    $DBCNA           Customer Purcha
     C                     Z-ADDFLRVNB    $DRVNB           Stop_Drop
     C                     MOVEL*BLANK    $DGNNA           USR Compressed
     C                     MOVEL*BLANK    $DLMT1           Delivery P_O  N
     C                     MOVEL*BLANK    $DGONA           USR Compressed
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     Z-ADD*ZERO     $DRRNB           Total Stops
     C                     MOVEL*BLANK    $DGPNA           USR Compressed
     C                     MOVEL*BLANK    $DGQNA           USR Compressed
     C                     MOVEL*BLANK    $DGRNA           USR Compressed
     C                     Z-ADD*ZERO     $DEIDT           Requested Deliv
     C                     Z-ADD*ZERO     $DAFTM           Requested Deliv
     C                     MOVEL*BLANK    $DCKT1           Time AM/PM 2
     C                     MOVEL*BLANK    $DB6NA           Special Instruc
     C                     MOVEL*BLANK    $DBYNA           Special Instruc
      * Load related totals format
     C                     Z-ADDFLAIC3    $GAIC3           Company Number
     C                     Z-ADDFLRMNB    $GRMNB           Load ID
     C                     Z-ADDFLRVNB    $GRVNB           Stop_Drop
     C                     MOVEL*BLANK    $GQUU1           Pallet Type/Qty
     C                     Z-ADD*ZERO     $GF4QT           USR Quantity Sh
     C                     Z-ADD*ZERO     $GCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     $GCPWG           USR Weight   9.
     C                     Z-ADDFLC4NB    $GC4NB           Order Number
      * USER: Process before print of Order Number format
     C                     MOVEL'N'       WUDLST           USR Overflow
     C                     MOVEL'Y'       WUGGST           USR Display fie
      * display req delv time - sts may be no for some custs
     C                     MOVEL'Y'       WUZ2SX           USR Display 11
      * ** Load Order Heading Fields
      * ** Change shipping line fields to wrk context, these will come fr
      * ** the Order Header Extension file       FP1101 LJB 04/11/2007
      * RTV BOL Shipping dtls  RT - Load Header  * 
     C                     EXSR SFRVGN
      * Date Shipped
      * CASE: WRK.BOL Complete Date is not entered
     C           WUJ7DT    IFEQ *ZERO                      *IF
     C                     Z-ADD##JDT     $DFADT           USR Date Shippe
     C                     Z-ADD##JTM     $DWENB           USR Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUJ7DT    $DFADT           USR Date Shippe
     C                     Z-ADDWUBOTM    $DWENB           USR Time
     C                     END                             *FI
      * RTV Name, Status       RT - Carrier  * 
     C                     EXSR SGRVGN
      * ** Total Load Miles will have Override miles, if they were entere
     C                     Z-ADD$CTLMI    $DTLMI           Total Load Mile
      * NOTE:  PAR ship to fields hold LAST STOP information
      *        WRK ship to fields hold THIS STOP information
      * ** Put export status in CUR and PAR instead of LCL context
      * RTV for B.O.L. Print 2 RT - Order Header TRG  * 
     C                     EXSR SHRVGN
     C                     MOVEL$DU2ST    WN0012           Export Status
      * RTV Phone/ItemRefSts  RT - Customer  * 
     C                     EXSR SIRVGN
      * ** 04/24/2007 LJB FP1101 Export Information will now come from
      * ** the Order Header Extension file not the Load Header
      * Check Export Status -- for the Order, not for the Load  2/4/2002
      * CASE: CUR.Export Status is yes
     C           $DU2ST    IFEQ 'Y'                        *IF
      * ** check PAR context instead of LCL for export status  03/01/2007
      * ** check CUR context instead of PAR for export status  04/11/2007
      * If Export replace address information with Sail Port information
      * ** Shipping line fields now come from the Order Header Extension
      * R15161 DN 07/23/19-Replaced Voyage w/ OHE Voyage/Flight & Booking
      *   Number w/ OHE Booking Number from OHE File.
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0004           Company Number
     C                     Z-ADD$DC4NB    WL0005           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    $DXACD    P      Shipping Line
     C                     MOVELWL0007    WN0001    P      Port Delv Termi
     C                     MOVELWL0008    YL0004    P      OHE City
     C                     MOVELWL0009    $DK4TX    P      OHE Vessel_Airl
     C                     MOVELWL0010    $DGENY    P      OHE Voyage_Flig
     C                     MOVELWL0011    $DJ1T1    P      OHE Booking Num
     C                     MOVELWL0012    $DW4CD    P      OHE Discharge P
     C                     Z-ADDWL0013    YL0005           OHE Sail_Flight
     C                     Z-ADDWL0014    YL0006           OHE Port Cut Da
     C                     Z-ADDWL0015    YL0007           OHE Arrival Dat
     C                     MOVELWL0016    YL0008    P      OHE Late Delive
     C                     MOVELWL0017    YL0009    P      OHE Ship Status
     C                     MOVELWL0018    YL0010    P      OHE Container N
     C                     MOVELWL0019    YL0011    P      OHE Comment 1
     C                     MOVELWL0020    YL0012    P      OHE Comment 2
     C                     MOVELWN0001    $DAWAA           Delivery Termin
     C                     MOVEL*BLANK    $DGNNA           USR Compressed
     C                     MOVEL*BLANK    $DGONA           USR Compressed
     C                     MOVEL*BLANK    $DGPNA           USR Compressed
     C                     MOVEL*BLANK    $DGQNA           USR Compressed
     C                     MOVEL*BLANK    $DGRNA           USR Compressed
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.MG Created Load is Yes
      *   |- c2    : PAR.Port Delv Terminal is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $CRYSX    IFEQ 'Y'                        *IF
     C           WN0001    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Exc Rtv Shpng Ln /PFS XF - TMS International Shipmnt  * 
     C                     CALL 'PBXUXFR'              90  Exc Rtv Shpng L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM FLC4NB    WQ0001  70       TMS Order ID
     C           YL0013    PARM *BLANK    WQ0002 50        TMS Address Nam
     C           YL0014    PARM *BLANK    WQ0003 50        TMS Address Lin
     C           YL0015    PARM *BLANK    WQ0004 50        TMS Address Lin
     C           YL0016    PARM *BLANK    WQ0005 50        TMS City
     C           YL0017    PARM *BLANK    WQ0006 50        TMS State Provi
     C           YL0018    PARM *BLANK    WQ0007 20        TMS Postal Code
     C           YL0019    PARM *BLANK    WQ0008 10        TMS Country Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Compressd Name/Add US - /UT User Source  * 
      * Use this function to compress name/address information
      *
     C                     MOVELWUBRTX    UUADTX           Name
     C                     MOVELYL0013    UUACNA           Address 1
     C                     MOVELYL0014    UUADNA           Address 2
     C                     MOVELWUGSTX    UUAENA           Address 3
     C                     MOVELYL0016    UUAJNA           City
     C                     MOVELYL0017    UUEINA           State
     C                     MOVELYL0018    UUBTTX           Zip
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $DGNNA
     C                     MOVELUAD,2     $DGONA
     C                     MOVELUAD,3     $DGPNA
     C                     MOVELUAD,4     $DGQNA
     C                     MOVELUAD,5     $DGRNA
     C                     ELSE
      * CASE: PAR.Port Delv Terminal is Entered
     C           WN0001    IFNE *BLANK                     *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR SKRVGN
      * RTV Compressd Name/Add US - /UT User Source  * 
     C                     MOVELWUBRTX    UUADTX           Name
     C                     MOVELWULBTX    UUACNA           Address 1
     C                     MOVELWULATX    UUADNA           Address 2
     C                     MOVELWUGSTX    UUAENA           Address 3
     C                     MOVELWUOKTX    UUAJNA           City
     C                     MOVELWUXBCD    UUEINA           State
     C                     MOVELWULCTX    UUBTTX           Zip
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $DGNNA
     C                     MOVELUAD,2     $DGONA
     C                     MOVELUAD,3     $DGPNA
     C                     MOVELUAD,4     $DGQNA
     C                     MOVELUAD,5     $DGRNA
     C                     MOVELWUSPPN    WUF6NA           Value Alpha 13
     C                     Z-ADD3         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUNZCD    P  90  USR Reason Code
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD3         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD4         YRSW00
     C                     Z-ADD8         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00011
     C           ZQ        ORGT 00011
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUF6NA:ZQ WUN5CD    P  90  USR To Format
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUNZCD    CAT  '-':ZQ    WUJUTX    P      CMS Contact Pho
     C                     Z-ADD*ZERO     ZQ      50
     C           WUEZTX    CAT  '-':ZQ    WUJWTX    P      CMS Primary SIC
     C                     Z-ADD*ZERO     ZQ      50
     C           WUJUTX    CAT  WUJWTX:ZQ WUN7NA    P      @Alpha 8
     C                     Z-ADD*ZERO     ZQ      50
     C           WUN7NA    CAT  WUN5CD:ZQ WULETX    P      @Alpha 12
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVELWULETX    $DBVTX           Telephone Numbe
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Compressd Name/Add US - /UT User Source  * 
     C                     MOVELWUBRTX    UUADTX           Name
     C                     MOVELWUHMNA    UUACNA           Address 1
     C                     MOVELWUHONA    UUADNA           Address 2
     C                     MOVELWUHPNA    UUAENA           Address 3
     C                     MOVELWUHNNA    UUAJNA           City
     C                     MOVELWUDBCD    UUEINA           State
     C                     MOVELWUCKTX    UUBTTX           Zip
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $DGNNA
     C                     MOVELUAD,2     $DGONA
     C                     MOVELUAD,3     $DGPNA
     C                     MOVELUAD,4     $DGQNA
     C                     MOVELUAD,5     $DGRNA
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Compressd Name/Add US - /UT User Source  * 
     C                     MOVELWUBRTX    UUADTX           Name
     C                     MOVELWUHMNA    UUACNA           Address 1
     C                     MOVELWUHONA    UUADNA           Address 2
     C                     MOVELWUHPNA    UUAENA           Address 3
     C                     MOVELWUHNNA    UUAJNA           City
     C                     MOVELWUDBCD    UUEINA           State
     C                     MOVELWUCKTX    UUBTTX           Zip
     C                     EXSR UJ1UF
     C                     MOVELUAD,1     $DGNNA
     C                     MOVELUAD,2     $DGONA
     C                     MOVELUAD,3     $DGPNA
     C                     MOVELUAD,4     $DGQNA
     C                     MOVELUAD,5     $DGRNA
     C                     END                             *FI
      * ** 01/15/2009 LJB FP1303  Rtv Delivery PO from Order Hdr Ext file
      * RTV OHE Delv,intend    RT - Order Header Extension  * 
     C                     EXSR SLRVGN
      * ** Retrieve the warehouse for this order detail record
     C                     Z-ADD*ZERO     YL0020           Order Sequence
     C                     Z-ADD*ZERO     YL0021           Order Secondary
      * RTV Whse and Reason    RT - Order Detail  * 
     C                     EXSR SMRVGN
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
     C                     EXSR SNRVGN
      * Scheduled Deliv Time
      * CASE: CUR.Scheduled Delivery Time is Entered
     C           $DATTM    IFGT *ZERO                      *IF
      * Print Sched Delv Time as AM/PM
      * CASE: CUR.Scheduled Delivery Time is GE 12:00:00
     C           $DATTM    IFGE 120000                     *IF
      * CASE: CUR.Scheduled Delivery Time is GT 12:59
     C           $DATTM    IFGT 125959                     *IF
      * CUR.Scheduled Delivery Time = CUR.Scheduled Delivery Time + CON.-
     C                     Z-ADD$DATTM    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           3600      MULT -12       XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     $DATTM
     C                     END                             *FI
     C                     MOVEL'PM'      $DCJT1           Time AM/PM
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.Scheduled Delivery Time is LT 1:00:00
     C           $DATTM    IFLT 010000                     *IF
      * CUR.Scheduled Delivery Time = CUR.Scheduled Delivery Time + CON.1
     C                     Z-ADD$DATTM    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           3600      MULT 12        XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     $DATTM
     C                     END                             *FI
     C                     MOVEL'AM'      $DCJT1           Time AM/PM
     C                     END                             *FI
     C                     END                             *FI
      * Requested Deliv time
      * CASE: CUR.Requested Delivery Time is Zero
     C           $DAFTM    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: LCL.Print Req Delv Tm on Docs is No
     C           YL0023    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUZ2SX           USR Display 11
     C                     ELSE
      * CASE: *OTHERWISE
      * Print Req Delv Time as AM/PM
      * CASE: CUR.Requested Delivery Time is GE 12:00
     C           $DAFTM    IFGE 1200                       *IF
      * CASE: CUR.Requested Delivery Time is GT 12:59
     C           $DAFTM    IFGT 1259                       *IF
     C                     SUB  1200      $DAFTM           Requested Deliv
     C                     END                             *FI
     C                     MOVEL'PM'      $DCKT1           Time AM/PM 2
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CUR.Requested Delivery Time is LT 1:00
     C           $DAFTM    IFLT 0100                       *IF
     C                     ADD  1200      $DAFTM           Requested Deliv
     C                     END                             *FI
     C                     MOVEL'AM'      $DCKT1           Time AM/PM 2
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Force print of top of page headings
      * CASE: WRK.USR First Time is No
     C           WUTMST    IFEQ 'N'                        *IF
      * Prt Next Page Format   US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP00
     C                     MOVEL'Y'       W0NEWP
     C                     EXSR Q0PRNT
      * ** Set starting line number for the Order heading
      * SET Number of Rows     UP - /UT User Source  * 
     C                     Z-ADD26        @$CLN
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
      * PRTOBJ calls after print of Order Number format
      * Embedded PRTOBJ : PRT B.O.L. Details     PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * USER: Process after print of Order Number format
     C                     MOVEL'N'       WN0017           USR Display 2
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $FCPWG           USR Weight   9.
     C                     Z-ADD*ZERO     $FCOWG           USR Weight   9.
     C                     Z-ADD*ZERO     $FF4QT           USR Quantity Sh
     C                     Z-ADDFLAIC3    $FAIC3           Company Number
     C                     Z-ADDFLRMNB    $FRMNB           Load ID
     C                     Z-ADDFLRUNB    $FRUNB           Stop_Drop Seque
     C                     Z-ADDFLRVNB    $FRVNB           Stop_Drop
     C                     MOVELFLDQTX    $FDQTX           Comments for Pi
     C                     Z-ADDFLRWNB    $FRWNB           Miles to next s
     C                     Z-ADDFLRXNB    $FRXNB           Freight Charge
     C                     Z-ADDFLSQNB    $FSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFLT0NB    $FT0NB           Freight Misc_Ch
     C                     Z-ADDFLT1NB    $FT1NB           Freight Stop Ch
     C                     Z-ADDFLR1NB    $FR1NB           Rated Freight
     C                     Z-ADDFLC4NB    $FC4NB           Order Number
     C                     Z-ADDFLKEDT    $FKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $FSXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $FKFDT           Appointment Con
     C                     Z-ADDFLACTM    $FACTM           Appointment Con
     C                     MOVELFLK5TX    $FK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $FW5CD           Confirmation Nu
     C                     Z-ADDFLEJDT    $FEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $FAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $FKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $FATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $FHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $FAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $FKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $FAVTM           On Yard Time
     C                     Z-ADDFLZ4NB    $FZ4NB           MPC Number
     C                     MOVELFLY7ST    $FY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $FY2ST           On Time Addl Rs
     C                     MOVELFLWHTX    $FWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $FWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $FWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $FWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $FWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $FN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $FN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $FN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $FB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $FB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $FB5TM           LD Unused Time
     C                     MOVELFLIASX    $FIASX           Miles Error Sts
     C                     MOVELFLIBSX    $FIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $FICSX           HPB Transload S
     C                     MOVELFLWVTX    $FWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $FWWTX           Carrier Ref PRO
     C                     MOVELFLWXTX    $FWXTX           Cust Assigned A
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZB001           Load ID
     C                     Z-ADDFLRMNB    WZB001
     C           *LIKE     DEFN FLRVNB    WZB002           Stop_Drop
     C                     Z-ADDFLRVNB    WZB002
     C           *LIKE     DEFN FLC4NB    WZB003           Order Number
     C                     Z-ADDFLC4NB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FLCPEB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * RTV Order Status       RT - Order Header TRG  * 
     C                     EXSR SZRVGN
      * Check header status
      * CASE: PAR.Header Status is Not Comp/Canc/Conf
     C           WN0011    IFEQ 'L'                        *IF
     C           WN0011    OREQ 'A'
     C           WN0011    OREQ 'E'
     C           WN0011    OREQ 'H'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR TARVGN
      *
     C                     MOVEL*BLANK    WN0029  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0030  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0031  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0032  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0033  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0034  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0035  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0036  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0037  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0038  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0039  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0040  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0041  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0042  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0043  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0044  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0045  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0046  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0047  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0048 10        User Code Model
     C                     MOVEL*BLANK    WN0049  1        Record Found US
      *
      * Rtv User Whs Access   IF
     C                     MOVEL'N'       WN0019           Access Denied (
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR TBRVGN
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0048    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0026    P      User Profile Na
     C                     MOVELWN0002    WL0027    P      Warehouse Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WN0029    P      UWA Inventory T
     C                     MOVELWL0029    WN0030    P      UWA Lot Loc Tra
     C                     MOVELWL0030    WN0031    P      UWA Shipping Tr
     C                     MOVELWL0031    WN0032    P      UWA Cross Appli
     C                     MOVELWL0032    WN0033    P      UWA Unused Stat
     C                     MOVELWL0033    WN0034    P      UWA Unused Stat
     C                     MOVELWL0034    WN0035    P      UWA Unused Sts
     C                     MOVELWL0035    WN0036    P      UWA Unused Sts
     C                     MOVELWL0036    WN0037    P      UWA Unused Sts
     C                     MOVELWL0037    WN0038    P      UWA Unused Sts
     C                     MOVELWL0038    WN0039    P      UWA Unused Sts
     C                     MOVELWL0039    WN0040    P      UWA Unused Sts
     C                     MOVELWL0040    WN0041    P      UWA Unused Sts
     C                     MOVELWL0041    WN0042    P      UWA Unused Sts
     C                     MOVELWL0042    WN0043    P      UWA Unused Sts
     C                     MOVELWL0043    WN0044    P      UWA Unused Sts
     C                     MOVELWL0044    WN0045    P      UWA Unused Sts
     C                     MOVELWL0045    WN0046    P      UWA Unused Sts
     C                     MOVELWL0046    WN0047    P      UWA Unused Sts
     C                     MOVELWL0047    WN0049    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0048    WL0026    P      User Profile Na
     C                     MOVELWN0002    WL0027    P      Warehouse Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WN0029    P      UWA Inventory T
     C                     MOVELWL0029    WN0030    P      UWA Lot Loc Tra
     C                     MOVELWL0030    WN0031    P      UWA Shipping Tr
     C                     MOVELWL0031    WN0032    P      UWA Cross Appli
     C                     MOVELWL0032    WN0033    P      UWA Unused Stat
     C                     MOVELWL0033    WN0034    P      UWA Unused Stat
     C                     MOVELWL0034    WN0035    P      UWA Unused Sts
     C                     MOVELWL0035    WN0036    P      UWA Unused Sts
     C                     MOVELWL0036    WN0037    P      UWA Unused Sts
     C                     MOVELWL0037    WN0038    P      UWA Unused Sts
     C                     MOVELWL0038    WN0039    P      UWA Unused Sts
     C                     MOVELWL0039    WN0040    P      UWA Unused Sts
     C                     MOVELWL0040    WN0041    P      UWA Unused Sts
     C                     MOVELWL0041    WN0042    P      UWA Unused Sts
     C                     MOVELWL0042    WN0043    P      UWA Unused Sts
     C                     MOVELWL0043    WN0044    P      UWA Unused Sts
     C                     MOVELWL0044    WN0045    P      UWA Unused Sts
     C                     MOVELWL0045    WN0046    P      UWA Unused Sts
     C                     MOVELWL0046    WN0047    P      UWA Unused Sts
     C                     MOVELWL0047    WN0049    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0049    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'S'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0029    IFEQ 'N'                        *IF
     C           WN0029    OREQ 'R'
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0029    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'S'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0030    IFEQ 'N'                        *IF
     C           WN0030    OREQ 'R'
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0030    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0031    IFEQ 'N'                        *IF
     C           WN0031    OREQ 'R'
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0031    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'S'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Cross Applications is *Not Update
     C           WN0032    IFEQ 'N'                        *IF
     C           WN0032    OREQ 'R'
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Cross Applications is None
     C           WN0032    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WN0019           Access Denied (
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If access is denied for whse, Do not select record.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : PAR.Warehouse Code is Warehouse Code not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0019    IFEQ 'Y'                        *IF
     C           WN0002    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Load ID
     C                     MOVEL*BLANK    W0BL01  1        Stop_Drop
     C                     MOVEL*BLANK    W0BL02  1        Order Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop_Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZB001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FLRVNB    IFNE WZB002                     Stop_Drop
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FLC4NB    IFNE WZB003                     Order Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * USER: Process before print of Order Number format
      * So that total will use the Overflow #, the # passed in here must
      * the ovrflw # set for program
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD69        @$PGL
      * sets flag so the heading information will print if goes to next p
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
     C                     Z-ADDWN0015    $GF4QT           USR Quantity Sh
     C                     Z-ADDWN0013    $GCOWG           USR Weight   9.
     C                     Z-ADDWN0014    $GCPWG           USR Weight   9.
     C                     Z-ADD*ZERO     WN0015           USR Quantity Sh
     C                     Z-ADD*ZERO     WN0013           USR Weight   9.
     C                     Z-ADD*ZERO     WN0014           USR Weight   9.
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0001           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0001    P      Plant Company S
     C                     MOVELWL0003    YL0003    P      Company Organiz
      * CASE: LCL.Company Organization is Daily's
     C           YL0003    IFEQ 'D'                        *IF
     C                     MOVEL'Y'       YL0041           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0041           Display Flag
     C                     END                             *FI
      * If Company Organization is Foods, get Pallet Types if they exist
      * CASE: LCL.Company Organization is Seaboard
     C           YL0003    IFEQ 'S'                        *IF
     C                     MOVEL'N'       YL0042           Display Pallet
     C                     MOVEL*BLANK    $GQUU1           Pallet Type/Qty
      * Rtv OH Shipped Pallet RT - OH Pallet Table Shipped  * 
     C                     EXSR TDRVGN
      * CASE: LCL.Pallet Type 1 is None
     C           YL0043    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0043    WL0048    P      PM Pallet Type
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    YL0052    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0048    P      PM Pallet Type
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    YL0053    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0047    WL0048    P      PM Pallet Type
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    YL0054    P      PM Description
      * Rtv Pallet Desc       RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0049    WL0048    P      PM Pallet Type
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0049    YL0055    P      PM Description
      * Bld Pallet Typ/Qty Str UP - OH Pallet Table Shipped  * 
     C                     CALL 'PUVLUPR'              90  Bld Pallet Typ/
     C                     PARM YL0044    WQ0009  50       Pallet Qty 1
     C                     PARM YL0046    WQ0010  50       Pallet Qty 2
     C                     PARM YL0048    WQ0011  50       Pallet Qty 3
     C                     PARM YL0050    WQ0012  50       Pallet Qty 4
     C                     PARM YL0052    WQ0013  6        Pallet type 1 D
     C                     PARM YL0053    WQ0014  6        Pallet type 2 D
     C                     PARM YL0054    WQ0015  6        Pallet type 3 D
     C                     PARM YL0055    WQ0016  6        Pallet type 4 D
     C           $GQUU1    PARM *BLANK    WQ0017 60        Pallet Type/Qty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUVLUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       YL0042           Display Pallet
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0042           Display Pallet
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0042    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$GKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
      * PRTOBJ calls after print of Order Number format
      * Embedded PRTOBJ : PRT Header comments    PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Country Comment   PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      * USER: Process after print of Order Number format
      * Reset the page size so the forms will scroll properly.
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD88        @$PGL
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     ADD  $GF4QT    $LUQ70           USR Quantity 7,
     C                     ADD  $GCPWG    $LFCWG           USR Weight 9.1
     C                     ADD  $GCOWG    $LFBWG           USR Weight 9.1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * USER: Process before print of Stop/Drop format
      * So that total will use the Overflow #, the # passed in here must
      * the ovrflw # set for program
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD69        @$PGL
      * sets flag so the heading information will print if goes to next p
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Stop/Drop format
      * Call 11039 - Print Order Total -- add this   6/27/00
     C                     Z-ADD$LUQ70    $LF4QT           USR Quantity Sh
     C                     Z-ADD$LFBWG    $LCOWG           USR Weight   9.
     C                     Z-ADD$LFCWG    $LCPWG           USR Weight   9.
      * WI572 - Check to see which statement to print
      * - Always print 'Non-Compliant stmt'
      * Chk which Stmt to Prt XF - Load Detail  * 
     C                     CALL 'PVAAXFR'              90  Chk which Stmt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUOJSC    WQ0018  2        IDE Regul Code
     C                     PARM YL0032    WQ0019  70       Ship To Custome
     C                     PARM $NAIC3    WQ0020  30       Company Number
     C           $LVAU1    PARM *BLANK    WQ0021 80        Non-Compliant S
     C           $LGIU1    PARM *BLANK    WQ0022 80        @Text 80
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ===============================================================
      * WI572 - Check to see which statement to print
      * Do not print load number on stop total if last stop; use in Comme
      * CASE: CUR.Stop/Drop EQ PAR.USR Stop/Drop
     C           $LRVNB    IFEQ WN0018                     *IF
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           YL0040    IFNE 'CAN'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * PRTOBJ calls after print of Stop/Drop format
      * Embedded PRTOBJ : Prt Cust Comment      PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * USER: Process after print of Stop/Drop format
      * Reset the page size so the forms will scroll properly.
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD88        @$PGL
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     ADD  $LF4QT    $NUQ70           USR Quantity 7,
     C                     ADD  $LCPWG    $NFCWG           USR Weight 9.1
     C                     ADD  $LCOWG    $NFBWG           USR Weight 9.1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * USER: Process before print of Load ID format
      * So that total will use the Overflow #, the # passed in here must
      * the ovrflw # set for program
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD69        @$PGL
      * sets flag so the heading information will print if goes to next p
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
      * ** If final order was an export, skip to new page for load totals
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Export Status is yes
      *   |- c2    : LCL.Company Organization is Daily's
      *   '-
     C           WN0012    IFEQ 'Y'                        *IF
     C           YL0003    OREQ 'D'                        *OR
     C                     MOVEL'Y'       W0NEWP           *new page flag
      * ** Pass Export Status back to the Load Header format
     C                     MOVELWN0012    P3AZSX           Unused Status U
      * ** Force print of 2nd header when last order is an Export Order
      * Prt Load Hdr Format    US - /UT User Source  * 
     C                     MOVE 'Y'       W0BP00  1
     C           WUGSTX    CAT  @CN,01:ZQ $DGNNA    P
     C                     EXSR Q0PRNT
     C                     MOVEL'Y'       YL0002           Print (Yes/No)
     C                     END                             *FI
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
     C                     Z-ADD$NUQ70    $NF4QT           USR Quantity Sh
     C                     Z-ADD$NFBWG    $NCOWG           USR Weight   9.
     C                     Z-ADD$NFCWG    $NCPWG           USR Weight   9.
     C                     Z-ADDWN0020    $NF0WG           Gross Weight US
     C                     ADD  $NF0WG    $NCPWG           USR Weight   9.
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 6
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
      * PRTOBJ calls after print of Load ID format
      * Embedded PRTOBJ : Prt Cust Comment BD   PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * USER: Process after print of Load ID format
      * SET Page Length        UP - /UT User Source  * 
     C                     Z-ADD88        @$PGL
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     ADD  $NUQ70    $PUQ70           USR Quantity 7,
     C                     ADD  $NFBWG    $PFBWG           USR Weight 9.1
     C                     ADD  $NFCWG    $PFCWG           USR Weight 9.1
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDP1RRNB    $PRRNB           Total Stops
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$PFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT B.O.L. Details     PO: Mainline
      *================================================================
      * PRT B.O.L. Details     PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQKC02           Order Number
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQKC01           Company Number
     C                     Z-ADD$DC4NB    WQKC02           Order Number
      * Establish starting position
     C           KRSC      SETLL@BGWKAE                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWCAIC3    $EAIC3           Company Number
     C                     Z-ADDWCC4NB    $EC4NB           Order Number
     C                     Z-ADDWCDPNB    $EDPNB           Order Sequence
     C                     Z-ADDWCUENB    $EUENB           Order Secondary
     C                     MOVELWCAJCD    $EAJCD           Warehouse Code
     C                     Z-ADDWCAVQT    $EAVQT           Quantity Ordere
     C                     Z-ADDWCD0WG    $ED0WG           Weight Ordered
     C                     Z-ADDWCALPR    $EALPR           Unit Price_Cred
     C                     MOVELWCAGCD    $EAGCD           U_M_Ordered
     C                     Z-ADDWCAUPR    $EAUPR           Unit Price Orde
     C                     Z-ADDWCAGCS    $EAGCS           Unit Cost Per P
     C                     Z-ADDWCAQCS    $EAQCS           Unit Cost Prici
     C                     Z-ADDWCAVWG    $EAVWG           Unit Weight Ord
     C                     MOVELWCCRCD    $ECRCD           U_M_Base Price
     C                     MOVELWCAMST    $EAMST           Affect Inventor
     C                     MOVELWCANST    $EANST           Affect Sales Do
     C                     MOVELWCVAST    $EVAST           Affect Sales Pn
     C                     Z-ADDWCL6NB    $EL6NB           Contract Number
     C                     Z-ADDWCCBQT    $ECBQT           Quantity Shippe
     C                     Z-ADD*ZERO     $EFOQT           Case Quantity
     C                     Z-ADDWCHGCD    $EHGCD           Item Code
     C                     MOVELWCG7NA    $EG7NA           Order Desc_Line
     C                     Z-ADD*ZERO     $EFZWG           Net Weight USR
     C                     Z-ADD*ZERO     $EF0WG           Gross Weight US
     C                     MOVELWCG8NA    $EG8NA           Order Desc_Line
     C                     MOVEL*BLANK    $ECOAA           CIR Resource No
     C                     MOVEL*BLANK    $EUZU1           Compliancy Stm1
     C                     MOVEL*BLANK    $EU0U1           Compliancy Stm2
     C                     Z-ADDWCATWG    $EATWG           Weight Shipped
     C                     Z-ADDWCCCQT    $ECCQT           Quantity Schedu
     C                     Z-ADDWCAUWG    $EAUWG           Weight Schedule
     C                     Z-ADDWCBKC7    $EBKC7           Ship To Custome
     C                     Z-ADDWCCFC7    $ECFC7           Order Group Cod
     C                     MOVELWCFZST    $EFZST           Production Date
     C                     MOVELWCAVST    $EAVST           Catch Weight St
     C                     MOVELWCGMST    $EGMST           Detail Line Sta
     C                     MOVELWCGNST    $EGNST           Detail Line Sta
     C                     MOVELWCR4CD    $ER4CD           Sales Route Cod
     C                     MOVELWCGTST    $EGTST           Comment Print A
     C                     MOVELWCGVST    $EGVST           Comment Print I
     C                     MOVELWCGUST    $EGUST           Comment Print P
     C                     MOVELWCQFST    $EQFST           Comment Print S
     C                     MOVELWCKXCD    $EKXCD           Country Code
     C                     Z-ADDWCR1NB    $ER1NB           Rated Freight
     C                     MOVELWCRZST    $ERZST           Work Confirm St
     C                     MOVELWCR0ST    $ER0ST           Work Over_Short
     C                     MOVELWCR1ST    $ER1ST           OD Production P
     C                     Z-ADDWCEXDT    $EEXDT           Market Pricing
     C                     Z-ADDWCBZPR    $EBZPR           Price Overage O
     C                     MOVELWCU1ST    $EU1ST           Price Status
     C                     MOVELWCU0ST    $EU0ST           Price Audit
     C                     MOVELWCRFCD    $ERFCD           Price Audit Rea
     C                     MOVELWCRPCD    $ERPCD           Age Code
     C                     MOVELWCVEST    $EVEST           Palletize
     C                     Z-ADDWCMAVA    $EMAVA           Billing Detail
     C                     Z-ADDWCKDVA    $EKDVA           Billing Detail
     C                     MOVELWCVGST    $EVGST           Slip Sheet
     C                     Z-ADDWCL8VA    $EL8VA           Billing Detail
     C                     Z-ADDWCL9VA    $EL9VA           Quantity to Sub
     C                     Z-ADDWCA4WG    $EA4WG           Tare Weight Tot
     C                     MOVELWCRDCD    $ERDCD           Date Method Cod
     C                     MOVELWCQ7CD    $EQ7CD           Price Method Co
     C                     MOVELWCLQCD    $ELQCD           Commodity Marke
     C                     MOVELWCCQCD    $ECQCD           Reason Code
     C                     MOVELWCHICD    $EHICD           Quality Level
     C                     MOVELWCRNCD    $ERNCD           Pricing Product
     C                     MOVELWCROCD    $EROCD           Season Product
     C                     Z-ADDWCCXDT    $ECXDT           Date of Origina
     C                     MOVELWCAJVN    $EAJVN           User Profile Na
     C                     MOVELWCRBCD    $ERBCD           Item Level
     C                     Z-ADDWCRGNB    $ERGNB           Item Structure
     C                     Z-ADDWCRHNB    $ERHNB           Item Structure
     C                     Z-ADDWCRINB    $ERINB           Item Structure
     C                     Z-ADDWCGIDT    $EGIDT           Pricing Date Us
     C                     Z-ADDWCGNDT    $EGNDT           Actual Shipped
     C                     Z-ADDWCA5DT    $EA5DT           Requested Ship
     C                     MOVELWCJPCD    $EJPCD           Event Code
     C                     MOVELWCZ1ST    $EZ1ST           Modified Flag
     C                     Z-ADDWCAODT    $EAODT           Scheduled Ship
     C                     MOVELWCZ3ST    $EZ3ST           Substituted Fla
     C                     MOVELWCZ4ST    $EZ4ST           OD Schedule Ove
     C                     Z-ADDWCDUPR    $EDUPR           Invoice Unit Pr
     C                     Z-ADDWCB6VL    $EB6VL           Invoice Extende
     C                     Z-ADDWCA1AA    $EA1AA           Ham Group Numbe
     C                     MOVELWCFZSX    $EFZSX           OD Adj Type Ove
     C                     MOVELWCF0SX    $EF0SX           Affect Trade Fu
     C                     MOVELWCF1SX    $EF1SX           Affect Commissi
     C                     MOVELWCF2SX    $EF2SX           Affect Pricing
     C                     MOVELWCF3SX    $EF3SX           Released by Use
     C                     MOVELWCF4SX    $EF4SX           Ord TF Exempt C
     C                     MOVELWCF5SX    $EF5SX           OD Pallet Type
     C                     MOVELWCF6SX    $EF6SX           Production Ware
     C                     MOVELWCF7SX    $EF7SX           OD Price Type
     C                     Z-ADDWCNTDT    $ENTDT           Warehouse Palle
     C                     Z-ADDWCNUDT    $ENUDT           Consumed Item C
     C                     Z-ADDWCNVDT    $ENVDT           Deadline Depart
     C                     Z-ADDWCNWDT    $ENWDT           OD Price Type R
     C                     Z-ADDWCNXDT    $ENXDT           OD Firm Date
     C                     Z-ADDWCBUTM    $EBUTM           Deadline Depart
     C                     Z-ADDWCBVTM    $EBVTM           Price Code
     C                     Z-ADDWCBWTM    $EBWTM           Maximum Net Wei
     C                     Z-ADDWCBXTM    $EBXTM           Substitution Li
     C                     Z-ADDWCBYTM    $EBYTM           Max Qty to sche
     C                     Z-ADDWCH5NX    $EH5NX           Warehouse Palle
     C                     Z-ADDWCH6NX    $EH6NX           Warehouse Avg P
     C                     Z-ADDWCH7NX    $EH7NX           OD Item Target
     C                     Z-ADDWCH8NX    $EH8NX           OD Estimated Gr
     C                     Z-ADDWCH9NX    $EH9NX           OD Maximum Unit
     C                     Z-ADDWCDVPR    $EDVPR           Order Gate_Fina
     C                     Z-ADDWCDWPR    $EDWPR           OD Ceiling Pric
     C                     Z-ADDWCDXPR    $EDXPR           OD Gate_Final P
     C                     Z-ADDWCDYPR    $EDYPR           OD Weighted Avg
     C                     Z-ADDWCDZPR    $EDZPR           OD Original Ord
     C                     Z-ADDWCGSPR    $EGSPR           OD Cancel Date
     C                     Z-ADDWCGTPR    $EGTPR           OD Unused Prc 7
     C                     Z-ADDWCGUPR    $EGUPR           OD Unused Prc 8
     C                     MOVELWCHOST    $EHOST           OD MPR Sent to
     C                     MOVELWCHPST    $EHPST           OD MPR Prc Read
     C                     MOVELWCIOST    $EIOST           OD UnUsed Price
     C                     Z-ADDWCPEWG    $EPEWG           Weight Amount E
     C                     Z-ADDWCRINY    $ERINY           Item Age Days
     C                     Z-ADDWCTIDT    $ETIDT           Production Ovr
     C                     Z-ADDWCTJDT    $ETJDT           Production Ovr
     C                     MOVELWCH2ST    $EH2ST           OD Spot Buy
     C                     MOVELWCH0ST    $EH0ST           OD Clm Full Ret
     C                     MOVELWCH1ST    $EH1ST           Order Line Erro
     C                     Z-ADDWCTKDT    $ETKDT           OD Market Begin
     C                     Z-ADDWCTLDT    $ETLDT           OD Market Endin
     C                     Z-ADDWCTMDT    $ETMDT           OD Atch to Ord
     C                     MOVELWCUVST    $EUVST           EDI Status 1
     C                     MOVELWCUWST    $EUWST           EDI Status 2
     C                     MOVELWCUXST    $EUXST           EDI Status 3
     C                     Z-ADDWCAATM    $EAATM           Job Time
     C                     MOVELWCAYNA    $EAYNA           User Id
     C                     MOVELWCA0NA    $EA0NA           Job Name
     C                     Z-ADDWCAXDT    $EAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: DB1.Weight Shipped Total is Equal to zero
     C           WCATWG    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     MOVEL*BLANK    YL0030           Compliancy Stm1
     C                     MOVEL*BLANK    YL0031           Compliancy Stm2
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WCAIC3    WZC001           Company Number
     C                     Z-ADDWCAIC3    WZC001
     C           *LIKE     DEFN WCC4NB    WZC002           Order Number
     C                     Z-ADDWCC4NB    WZC002
     C           *LIKE     DEFN WCDPNB    WZC003           Order Sequence
     C                     Z-ADDWCDPNB    WZC003
     C           *LIKE     DEFN WCUENB    WZC004           Order Secondary
     C                     Z-ADDWCUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BGWKAE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           WCAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WCC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WCDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WCUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Header comments    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN COAIC3    WQKD01           Company Number
     C           *LIKE     DEFN COC4NB    WQKD02           Order Number
     C           *LIKE     DEFN COI1SX    WQKD03           Comment Type
      * Define keylist
     C           KPSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Comment Type
     C                     KFLD           CODXNB           Sequence Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
     C                     KFLD           WQKD02           Order Number
     C                     KFLD           WQKD03           Comment Type
      * Setup key
     C                     Z-ADD$LAIC3    WQKD01           Company Number
     C                     Z-ADD$GC4NB    WQKD02           Order Number
     C                     MOVEL'BL'      WQKD03           Comment Type
     C                     Z-ADD*ZERO     CODXNB           Sequence Number
      * Establish starting position
     C           KPSD      SETLL@COCPNU                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCOAIC3    $HAIC3           Company Number
     C                     Z-ADDCOC4NB    $HC4NB           Order Number
     C                     MOVELCOI1SX    $HI1SX           Comment Type
     C                     MOVEL*BLANK    $HHLTX           Condition Desc.
     C                     MOVEL*BLANK    $HSHTX           Text USR 40
      * Load related totals format
     C                     Z-ADDCOAIC3    $JAIC3           Company Number
     C                     Z-ADDCOC4NB    $JC4NB           Order Number
     C                     MOVELCOI1SX    $JI1SX           Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1603273   Y2LSNO  70       List number
     C                     PARM $HI1SX    W0INVL 25        Comment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $HSHTX    PARM           W0CNNM 25        Text USR 40
      *
     C                     Z-ADD1         ZQ      50
     C           $HSHTX    CAT  @CN,006:ZQ$HSHTX    P      Text USR 40
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCOAIC3    $IAIC3           Company Number
     C                     Z-ADDCOC4NB    $IC4NB           Order Number
     C                     MOVELCOI1SX    $II1SX           Comment Type
     C                     MOVELCOG4NA    $IG4NA           Comment Text
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN COAIC3    WZD001           Company Number
     C                     Z-ADDCOAIC3    WZD001
     C           *LIKE     DEFN COC4NB    WZD002           Order Number
     C                     Z-ADDCOC4NB    WZD002
     C           *LIKE     DEFN COI1SX    WZD003           Comment Type
     C                     MOVELCOI1SX    WZD003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@COCPNU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        Company Number
     C                     MOVEL*BLANK    W0DL01  1        Order Number
     C                     MOVEL*BLANK    W0DL02  1        Comment Type
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        Company Number
     C                     MOVEL'Y'       W0DL01  1        Order Number
     C                     MOVEL'Y'       W0DL02  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           COAIC3    IFNE WZD001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           COC4NB    IFNE WZD002                     Order Number
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           COI1SX    IFNE WZD003                     Comment Type
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt Country Comment   PO: Mainline
      *================================================================
      * Prt Country Comment   PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1KXCD    WQKE01           Country Code
     C           *LIKE     DEFN B1I1SX    WQKE02           Comment Type
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Country Code
     C                     KFLD           WQKE02           Comment Type
      * Setup key
     C                     MOVELWN0022    WQKE01           Country Code
     C                     MOVELYL0056    WQKE02           Comment Type
      * Establish starting position
     C           KRSE      SETLL@B1REED                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Country Code
     C                     MOVEL'Y'       W0EL01  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVELB1KXCD    $KKXCD           Country Code
     C                     MOVELB1I1SX    $KI1SX           Comment Type
     C                     Z-ADDB1M5NX    $KM5NX           Comment Sequenc
     C                     MOVELB1Q6NA    $KQ6NA           Comment
     C                     MOVELB1UVST    $KUVST           EDI Status 1
     C                     MOVELB1UWST    $KUWST           EDI Status 2
     C                     MOVELB1UXST    $KUXST           EDI Status 3
     C                     MOVELB1VSST    $KVSST           Record Status
     C                     Z-ADDB1AATM    $KAATM           Job Time
     C                     MOVELB1AYNA    $KAYNA           User Id
     C                     MOVELB1A0NA    $KA0NA           Job Name
     C                     Z-ADDB1AXDT    $KAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0058    IFEQ 'Y'                        *IF
     C           W0FSUM    ADD  YL0061    YL0060           USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
     C           YL0060    IFGE YL0059                     *IF
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     END                             *FI
     C                     MOVEL'N'       YL0058           First time flag
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B1KXCD    WZE001           Country Code
     C                     MOVELB1KXCD    WZE001
     C           *LIKE     DEFN B1I1SX    WZE002           Comment Type
     C                     MOVELB1I1SX    WZE002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@B1REED                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Country Code
     C                     MOVEL*BLANK    W0EL01  1        Comment Type
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Country Code
     C                     MOVEL'Y'       W0EL01  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           B1KXCD    IFNE WZE001                     Country Code
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           B1I1SX    IFNE WZE002                     Comment Type
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt Cust Comment      PO: Mainline
      *================================================================
      * Prt Cust Comment      PO: Initialise
     C                     EXSR ZFINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AVBKC7    WQKF01           Ship To Custome
     C           *LIKE     DEFN AVI1SX    WQKF02           Comment Type
      * Define keylist
     C           KPSF      KLIST
     C                     KFLD           WQKF01           Ship To Custome
     C                     KFLD           WQKF02           Comment Type
     C                     KFLD           AVM5NX           Comment Sequenc
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           Ship To Custome
     C                     KFLD           WQKF02           Comment Type
      * Setup key
     C                     Z-ADDWUBKC7    WQKF01           Ship To Custome
     C                     MOVEL'BL'      WQKF02           Comment Type
     C                     Z-ADD1         AVM5NX           Comment Sequenc
      * Establish starting position
     C           KPSF      SETLL@AVCPG4                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        Ship To Custome
     C                     MOVEL'Y'       W0FL01  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAVBKC7    $MBKC7           Ship To Custome
     C                     MOVELAVI1SX    $MI1SX           Comment Type
     C                     Z-ADDAVM5NX    $MM5NX           Comment Sequenc
     C                     MOVELAVXRTX    $MXRTX           Customer Commen
     C                     MOVELAVUVST    $MUVST           EDI Status 1
     C                     MOVELAVUWST    $MUWST           EDI Status 2
     C                     MOVELAVUXST    $MUXST           EDI Status 3
     C                     MOVELAVVSST    $MVSST           Record Status
     C                     Z-ADDAVAATM    $MAATM           Job Time
     C                     MOVELAVAYNA    $MAYNA           User Id
     C                     MOVELAVA0NA    $MA0NA           Job Name
     C                     Z-ADDAVAXDT    $MAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0063    IFEQ 'Y'                        *IF
     C           W0FSUM    ADD  YL0062    YL0065           USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
     C           YL0065    IFGE YL0064                     *IF
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     END                             *FI
     C                     MOVEL'N'       YL0063           First time flag
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AVBKC7    WZF001           Ship To Custome
     C                     Z-ADDAVBKC7    WZF001
     C           *LIKE     DEFN AVI1SX    WZF002           Comment Type
     C                     MOVELAVI1SX    WZF002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@AVCPG4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        Ship To Custome
     C                     MOVEL*BLANK    W0FL01  1        Comment Type
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        Ship To Custome
     C                     MOVEL'Y'       W0FL01  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           AVBKC7    IFNE WZF001                     Ship To Custome
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           AVI1SX    IFNE WZF002                     Comment Type
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         G0MAIN    BEGSR
      *================================================================
      * Prt Cust Comment BD   PO: Mainline
      *================================================================
      * Prt Cust Comment BD   PO: Initialise
     C                     EXSR ZGINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN AVBKC7    WQKG01           Ship To Custome
     C           *LIKE     DEFN AVI1SX    WQKG02           Comment Type
      * Define keylist
     C           KPSG      KLIST
     C                     KFLD           WQKG01           Ship To Custome
     C                     KFLD           WQKG02           Comment Type
     C                     KFLD           AVM5NX           Comment Sequenc
      * Define keylist
     C           KRSG      KLIST
     C                     KFLD           WQKG01           Ship To Custome
     C                     KFLD           WQKG02           Comment Type
      * Setup key
     C                     Z-ADDWUBKC7    WQKG01           Ship To Custome
     C                     MOVEL'BD'      WQKG02           Comment Type
     C                     Z-ADD1         AVM5NX           Comment Sequenc
      * Establish starting position
     C           KPSG      SETLL@AVCPG4                    *
      * Read first record with user selection
     C                     EXSR G3READ
     C           W0EOFG    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0GL1P  1        First page
     C                     MOVEL'Y'       W0GL00  1        Ship To Custome
     C                     MOVEL'Y'       W0GL01  1        Comment Type
      * Set column headings flag
     C                     MOVE 'Y'       W0GCDT
      * Print report body
     C           W0EOFG    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR G1PHDR
      * Print report detail line
     C                     EXSR G2PDTL
      * Read next record with user selection
     C                     EXSR G3READ
      * Print totals
     C                     EXSR G4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         G0EXIT    ENDSR
      /EJECT
     CSR         G1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0GL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP1P  1
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP00  1
     C                     END
      *
     C           W0GL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GP01  1
     C                     END
      *
      *================================================================
     CSR         G1EXIT    ENDSR
      /EJECT
     CSR         G2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAVBKC7    $OBKC7           Ship To Custome
     C                     MOVELAVI1SX    $OI1SX           Comment Type
     C                     Z-ADDAVM5NX    $OM5NX           Comment Sequenc
     C                     MOVELAVXRTX    $OXRTX           Customer Commen
     C                     MOVELAVUVST    $OUVST           EDI Status 1
     C                     MOVELAVUWST    $OUWST           EDI Status 2
     C                     MOVELAVUXST    $OUXST           EDI Status 3
     C                     MOVELAVVSST    $OVSST           Record Status
     C                     Z-ADDAVAATM    $OAATM           Job Time
     C                     MOVELAVAYNA    $OAYNA           User Id
     C                     MOVELAVA0NA    $OA0NA           Job Name
     C                     Z-ADDAVAXDT    $OAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C           W0FSUM    ADD  YL0066    YL0069           USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
     C           YL0069    IFGE YL0068                     *IF
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'Y'       W0BP03  1
     C                     ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                     MOVEL'N'       W0BP03  1
     C                     END                             *FI
     C                     MOVEL'N'       YL0067           First time flag
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0GPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C           WUTMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDLST           USR Overflow
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         G2EXIT    ENDSR
      /EJECT
     CSR         G3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AVBKC7    WZG001           Ship To Custome
     C                     Z-ADDAVBKC7    WZG001
     C           *LIKE     DEFN AVI1SX    WZG002           Comment Type
     C                     MOVELAVI1SX    WZG002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFG    OREQ '1'
     C           KRSG      READE@AVCPG4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFG  1
      * Quit if no record read
     C           W0EOFG    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0GL00  1        Ship To Custome
     C                     MOVEL*BLANK    W0GL01  1        Comment Type
     C           W0EOFG    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0GL00  1        Ship To Custome
     C                     MOVEL'Y'       W0GL01  1        Comment Type
     C                     ELSE
      * Next record - Detect level breaks
     C           AVBKC7    IFNE WZG001                     Ship To Custome
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL00
     C                     END
     C           AVI1SX    IFNE WZG002                     Comment Type
     C           W0GL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0GL01
     C                     END
     C                     END
      *================================================================
     CSR         G3EXIT    ENDSR
      /EJECT
     CSR         G4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0GL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP01
     C                     END
      *
     C           W0GL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0GP00
     C                     END
      *
     C           W0EOFG    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         G4EXIT    ENDSR
      /EJECT
     CSR         H0MAIN    BEGSR
      *================================================================
      * Prt Document Comment  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN AQAIC3    WQKH01           Company Number
     C           *LIKE     DEFN AQFPAA    WQKH02           CDD Department
     C           *LIKE     DEFN AQESTX    WQKH03           CDD Type
      * Define keylist
     C           KRSH      KLIST
     C                     KFLD           WQKH01           Company Number
     C                     KFLD           WQKH02           CDD Department
     C                     KFLD           WQKH03           CDD Type
      * Setup key
     C                     Z-ADDP1AIC3    WQKH01           Company Number
     C                     MOVEL'TRAFF'   WQKH02           CDD Department
     C                     MOVEL'BL'      WQKH03           CDD Type
      * Establish starting position
     C           KRSH      SETLL@AQREJ5                    *
      * Read first record with user selection
     C                     EXSR H3READ
     C           W0EOFH    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0HL1P  1        First page
     C                     MOVEL'Y'       W0HL00  1        Company Number
     C                     MOVEL'Y'       W0HL01  1        CDD Department
     C                     MOVEL'Y'       W0HL02  1        CDD Type
      * Set column headings flag
     C                     MOVE 'Y'       W0HCDT
      * Print report body
     C           W0EOFH    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR H1PHDR
      * Print report detail line
     C                     EXSR H2PDTL
      * Read next record with user selection
     C                     EXSR H3READ
      * Print totals
     C                     EXSR H4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         H0EXIT    ENDSR
      /EJECT
     CSR         H1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0HL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP1P  1
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP00  1
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP01  1
     C                     END
      *
     C           W0HL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HP02  1
     C                     END
      *
      *================================================================
     CSR         H1EXIT    ENDSR
      /EJECT
     CSR         H2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAQAIC3    $QAIC3           Company Number
     C                     MOVELAQESTX    $QESTX           CDD Type
     C                     MOVELAQFPAA    $QFPAA           CDD Department
     C                     MOVELAQRPNA    $QRPNA           CDD Name of Ove
     C                     MOVELAQDTVN    $QDTVN           CDD Program Nam
     C                     MOVELAQDUVN    $QDUVN           CDD Printer Fil
     C                     MOVELAQDVVN    $QDVVN           CDD Additional
     C                     MOVELAQEWT1    $QEWT1           CDD Sender Phon
     C                     MOVELAQEXT1    $QEXT1           CDD Sender Fax
     C                     MOVELAQDXVN    $QDXVN           Output Queue
     C                     MOVELAQKMT1    $QKMT1           Hold File
     C                     MOVELAQKNT1    $QKNT1           Save File
     C                     Z-ADDAQGXNY    $QGXNY           Source Drawer
     C                     MOVELAQDWVN    $QDWVN           Printer Device
     C                     Z-ADDAQGZNY    $QGZNY           Page Length 2
     C                     Z-ADDAQG0NY    $QG0NY           Page Width 2
     C                     Z-ADDAQG1NY    $QG1NY           Page LPI
     C                     Z-ADDAQG2NY    $QG2NY           Page CPI
     C                     Z-ADDAQGYNY    $QGYNY           Page Overflow
     C                     MOVELAQKOT1    $QKOT1           Page Rotation
     C                     MOVELAQDYVN    $QDYVN           CDD Valid Name
     C                     MOVELAQDZVN    $QDZVN           CDD Valid Name
     C                     MOVELAQD0VN    $QD0VN           CDD Valid Name
     C                     Z-ADDAQG3NY    $QG3NY           CDD Copies
     C                     Z-ADDAQG4NY    $QG4NY           CDD Number 2 Un
     C                     Z-ADDAQG5NY    $QG5NY           CDD Number 3 Un
     C                     Z-ADDAQG6NY    $QG6NY           CDD Number 4 Un
     C                     Z-ADDAQG7NY    $QG7NY           CDD Number 5 Un
     C                     MOVELAQEYT1    $QEYT1           CDD Comment 1
     C                     MOVELAQEZT1    $QEZT1           CDD Comment 2
     C                     MOVELAQKBT1    $QKBT1           CDD Comment 3
     C                     MOVELAQKCT1    $QKCT1           CDD Comment 4
     C                     MOVELAQKDT1    $QKDT1           CDD Comment 5
     C                     MOVELAQETTX    $QETTX           CDD Unused Sts
     C                     MOVELAQEXTX    $QEXTX           CDD Unused Sts
     C                     MOVELAQE0TX    $QE0TX           CDD Unused Sts
     C                     MOVELAQE3TX    $QE3TX           CDD Unused Sts
     C                     MOVELAQE0T1    $QE0T1           CDD Unused Text
     C                     MOVELAQE1T1    $QE1T1           CDD Unused Text
     C                     MOVELAQKET1    $QKET1           CDD Unused Text
     C                     MOVELAQKFT1    $QKFT1           CDD Unused Text
     C                     MOVELAQKGT1    $QKGT1           CDD Unused Text
     C                     Z-ADDAQQ4DT    $QQ4DT           CDD Unused Date
     C                     Z-ADDAQQ5DT    $QQ5DT           CDD Unused Date
     C                     Z-ADDAQQ7DT    $QQ7DT           CDD Unused Date
     C                     Z-ADDAQCYTM    $QCYTM           CDD Unused Time
     C                     Z-ADDAQCWTM    $QCWTM           CDD Unused Time
     C                     Z-ADDAQCXTM    $QCXTM           CDD Unused Time
     C                     MOVELAQVSST    $QVSST           Record Status
     C                     Z-ADDAQMJDT    $QMJDT           Create Date
     C                     Z-ADDAQBETM    $QBETM           Create Time
     C                     MOVELAQCCVN    $QCCVN           Create User
     C                     MOVELAQCDVN    $QCDVN           Create Program
     C                     Z-ADDAQMKDT    $QMKDT           Change Date
     C                     Z-ADDAQBFTM    $QBFTM           Change Time
     C                     MOVELAQCEVN    $QCEVN           Change User
     C                     MOVELAQCFVN    $QCFVN           Change Program
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0HPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         H2EXIT    ENDSR
      /EJECT
     CSR         H3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AQAIC3    WZH001           Company Number
     C                     Z-ADDAQAIC3    WZH001
     C           *LIKE     DEFN AQFPAA    WZH002           CDD Department
     C                     MOVELAQFPAA    WZH002
     C           *LIKE     DEFN AQESTX    WZH003           CDD Type
     C                     MOVELAQESTX    WZH003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFH    OREQ '1'
     C           KRSH      READE@AQREJ5                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFH  1
      * Quit if no record read
     C           W0EOFH    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0HL00  1        Company Number
     C                     MOVEL*BLANK    W0HL01  1        CDD Department
     C                     MOVEL*BLANK    W0HL02  1        CDD Type
     C           W0EOFH    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0HL00  1        Company Number
     C                     MOVEL'Y'       W0HL01  1        CDD Department
     C                     MOVEL'Y'       W0HL02  1        CDD Type
     C                     ELSE
      * Next record - Detect level breaks
     C           AQAIC3    IFNE WZH001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL00
     C                     END
     C           AQFPAA    IFNE WZH002                     CDD Department
     C           W0HL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL01
     C                     END
     C           AQESTX    IFNE WZH003                     CDD Type
     C           W0HL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0HL02
     C                     END
     C                     END
      *================================================================
     CSR         H3EXIT    ENDSR
      /EJECT
     CSR         H4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0HL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP02
     C                     END
      *
     C           W0HL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP01
     C                     END
      *
     C           W0HL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0HP00
     C                     END
      *
     C           W0EOFH    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         H4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Bill of Lading-GUY PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Bill of Lading-GUY PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Detail line. of PRT Bill of Lading-GUY PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    $CTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    $CTLMI           Total Load Mile
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$CDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Bill of Lading Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Load ID of PRT Bill of Lading Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Stop_Drop of PRT Bill of Lading Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * USER: On print of Stop/Drop format
      * Total Number of Stops
     C                     ADD  1         WN0016           USR number
     C                     MOVEL*BLANK    WUOJSC           IDE Regul Code
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Number of PRT Bill of Lading Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * Set up "continued"
      * CASE: WRK.USR Overflow is Yes
     C           WUDLST    IFEQ *BLANK                     *IF
     C                     Z-ADD22        ZQ      50
     C           WUGSTX    CAT  @CN,005:ZQ$DGNNA    P      USR Compressed
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert USR Date Shipped to display format
      * Convert date
     C           1000000   ADD  $DFADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFADT
      * Convert Scheduled Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DKJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKJDT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
     C                     MOVEL'0'       *IN79
     C           WN0017    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0012    IFEQ *BLANK                     *IF
     C           WN0012    OREQ 'N'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0011    IFEQ 'C'                        *IF
     C           WN0011    OREQ 'R'
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUZ2SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0BP02
     C                     END                             FI
      * Print First Page Format of PRT B.O.L. Details     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT B.O.L. Details     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT B.O.L. Details     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT B.O.L. Details     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT B.O.L. Details     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT B.O.L. Details     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * --------------------------------------------------------------
      * 08/15/01 PKP PK0334 Print Item Resource No in Desc Line 2
      * 09/11/09 SAZ E00456 Changed Yes (Y) condition to Invoice (I).
      * Retrieve Customer Item Reference Information
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Reference Status is Invoice
      *   |- c2    : PAR.Item Reference Status is Both
      *   '-
     C           WN0021    IFEQ 'I'                        *IF
     C           WN0021    OREQ 'B'                        *OR
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
     C                     EXSR SORVGN
     C                     MOVELYL0024    $ECOAA           CIR Resource No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $ECOAA           CIR Resource No
     C                     END                             *FI
      * --------------------------------------------------------------
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     Z-ADD*ZERO     $EFZWG           Net Weight USR
     C                     Z-ADD*ZERO     $EF0WG           Gross Weight US
     C                     Z-ADD*ZERO     WUFZWG           Net Weight USR
     C                     Z-ADD*ZERO     WUF0WG           Gross Weight US
     C                     Z-ADD*ZERO     WN0024           Misc Tare Weigh
      * Case Quantity/Net Weight/Gross Weight
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0011    IFEQ 'C'                        *IF
     C           WN0011    OREQ 'R'
     C           WCCBQT    MULT 1         $EFOQT    H      Case Quantity
     C           WCATWG    MULT 1         $EFZWG    H      Net Weight USR
     C           WCATWG    MULT 1         $EF0WG    H      Gross Weight US
     C                     ELSE
      * CASE: *OTHERWISE
     C           WCCCQT    MULT 1         $EFOQT    H      Case Quantity
     C           WCAUWG    MULT 1         $EFZWG    H      Net Weight USR
     C           WCAUWG    MULT 1         $EF0WG    H      Gross Weight US
     C                     END                             *FI
      * Calculate Gross Weight
      * Rtv Tare Weight        RT - Company Item  * 
     C                     EXSR SPRVGN
      * Misc Tare Weight
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0011    IFEQ 'C'                        *IF
     C           WN0011    OREQ 'R'
     C                     MULT WCCBQT    WN0024           Misc Tare Weigh
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MULT WCCCQT    WN0024           Misc Tare Weigh
     C                     END                             *FI
      * Find Box weight for the Item and Subtract for final tare weight
     C                     Z-ADD*ZERO     WN0023           Unit Weight
      * Gross Weight
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0011    IFEQ 'C'                        *IF
     C           WN0011    OREQ 'R'
      * Calculate Gross Weight
      * CASE: DB1.Weight Shipped Total NE WRK.ZERO
     C           WCATWG    IFNE WUW0NB                     *IF
     C                     ADD  WN0024    $EF0WG           Gross Weight US
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0021           Company Number
     C                     Z-ADD$EHGCD    WL0022           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0023           Unit Weight
     C           WCCBQT    MULT WN0023    WN0023    H      Unit Weight
     C                     ADD  WN0023    $EF0WG           Gross Weight US
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate Gross Weight
      * CASE: DB1.Weight Scheduled NE WRK.ZERO
     C           WCAUWG    IFNE WUW0NB                     *IF
     C                     ADD  WN0024    $EF0WG           Gross Weight US
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0021           Company Number
     C                     Z-ADD$EHGCD    WL0022           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0023           Unit Weight
     C           WCCCQT    MULT WN0023    WN0023    H      Unit Weight
     C                     ADD  WN0023    $EF0WG           Gross Weight US
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  $EFZWG    WN0013           USR Weight   9.
     C                     ADD  $EF0WG    WN0014           USR Weight   9.
     C                     ADD  $EFOQT    WN0015           USR Quantity Sh
     C                     Z-ADD$EFZWG    WUFZWG           Net Weight USR
     C                     Z-ADD$EF0WG    WUF0WG           Gross Weight US
     C                     Z-ADD$EFOQT    WUFOQT           Case Quantity
      * WI572 - Check if Item is compliant
      * RTV if Compliant RT - Item Default Extension  * 
     C                     EXSR SSRVGN
      * Reg Code Found
      * CASE: LCL.IDE Regulation Code ID is Blank
     C           YL0029    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Compl Stmts RT - Regulation Code Mst  * 
     C                     EXSR STRVGN
      * If Stmt 1 Entered Print it
      * CASE: LCL.Compliancy Stm1 Item is Not Blank
     C           YL0030    IFNE *BLANK                     *IF
     C                     MOVELYL0030    $EUZU1           Compliancy Stm1
     C                     END                             *FI
      * If Stmt 2 Entered Print it
      * CASE: LCL.Compliancy Stm2 Item is Not Blank
     C           YL0031    IFNE *BLANK                     *IF
     C                     MOVELYL0031    $EU0U1           Compliancy Stm2
     C                     END                             *FI
     C                     MOVELYL0029    WUOJSC           IDE Regul Code
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           $EG8NA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           $ECOAA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0030    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0031    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print Detail line. of PRT Bill of Lading Dtl PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * USER: On print of detail format
      * W464 get pallet weight from OH pallet shipped
      * OD isnt update with pallet wt so the below RTV  didnt get a weigh
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SURVGN
      * Rtv Tot Pallet Tare   RT - Order Detail  * 
     C                     EXSR SVRVGN
      * CASE: LCL.Warehouse Pallet Tare is not entered
     C           YL0035    IFEQ 0                          *IF
      * Rtv OH Ship Plt Wgts  RT - OH Pallet Table Shipped  * 
     C                     EXSR SWRVGN
     C                     Z-ADDYL0037    YL0035           Warehouse Palle
     C                     END                             *FI
     C                     ADD  YL0035    WN0020           Gross Weight US
      * 02/26/04 RMC
      * RTV Country Code only  RT - Order Detail  * 
     C                     EXSR SYRVGN
      * CASE: LCL.Country Code is Canada
     C           YL0040    IFEQ 'CAN'                      *IF
      * Print 'Requires USDA Seals' in stop/drop totals
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Company Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print Order Number of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print Comment Type of PRT Header comments    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Print format
     C                     WRITE$HKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print Detail line. of PRT Header comments    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Country Code of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Comment Type of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print Detail line. of Prt Country Comment   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt Cust Comment      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print Ship To Customer of Prt Cust Comment      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print Comment Type of Prt Cust Comment      PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print Detail line. of Prt Cust Comment      PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Print First Page Format of Prt Cust Comment BD   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0GL1P
     C                     END                             FI
      * Print Ship To Customer of Prt Cust Comment BD   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP00
     C                     END                             FI
      * Print Comment Type of Prt Cust Comment BD   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0GP01
     C                     END                             FI
      * Print Detail line. of Prt Cust Comment BD   PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0GCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0GPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0GPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Format Slaughter Dates on Line 2 of comment section
      * CASE: DB1.Comment Sequence Number EQ WRK.Numeral 1             US
     C           AVM5NX    IFEQ WUHKNX                     *IF
      * RTV Loads label dates  RT - Order Header TRG  * 
     C                     EXSR TGRVGN
      * RTV Kill Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$NAIC3    WL0053           Company Number
     C                     Z-ADDYL0070    WL0054           Post to G_L Dat
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0075    P      Kill Day Status
      * Is oldest label date a kill day?
      * CASE: LCL.Kill Day Status is no
     C           YL0075    IFEQ 'N'                        *IF
      * Rtv Prev Kill Date    RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$NAIC3    WL0056           Company Number
     C                     Z-ADDYL0070    WL0057           Post to G_L Dat
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0076           Kill Date PRV U
     C                     Z-ADDYL0076    YL0070           Date From
     C                     END                             *FI
      * RTV Kill Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$NAIC3    WL0053           Company Number
     C                     Z-ADDYL0071    WL0054           Post to G_L Dat
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0075    P      Kill Day Status
      * Is latest label date a kill day?
      * CASE: LCL.Kill Day Status is no
     C           YL0075    IFEQ 'N'                        *IF
      * Rtv Prev Kill Date    RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$NAIC3    WL0056           Company Number
     C                     Z-ADDYL0071    WL0057           Post to G_L Dat
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0076           Kill Date PRV U
     C                     Z-ADDYL0076    YL0071           Date To
     C                     END                             *FI
      * Format dates
      * CASE: LCL.Date From             USR is Not zeros
     C           YL0070    IFNE *ZERO                      *IF
      * CLC Format Date Range  XF - Export Doc Defaults  * 
     C                     CALL 'PDP4XFR'              90  CLC Format Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0070    WQ0023  70       Date From
     C                     PARM YL0071    WQ0024  70       Date To
     C           YL0077    PARM YL0077    WQ0025 40        Text USR 40
     C                     PARM 'MD'      WQ0026  2        ED Slg_Proc Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0077           Text USR 40
     C                     END                             *FI
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  YL0077:ZQ $OXRTX    P      Customer Commen
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0GCDT    IFEQ 'Y'
     C                     WRITE$OCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0GCDT
     C                     END                             FI
      * Print format
     C                     WRITE$ODTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0GPDT
     C                     END                             FI
      * Print First Page Format of Prt Document Comment  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0HL1P
     C                     END                             FI
      * Print Company Number of Prt Document Comment  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP00
     C                     END                             FI
      * Print CDD Department Code of Prt Document Comment  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP01
     C                     END                             FI
      * Print CDD Type of Prt Document Comment  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0HP02
     C                     END                             FI
      * Print Detail line. of Prt Document Comment  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0HCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0HPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0HPDT    ANDEQ'P'
      * Print column headings if required
     C           W0HCDT    IFEQ 'Y'
     C                     WRITE$QCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0HCDT
     C                     END                             FI
      * Print format
     C                     WRITE$QDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0HPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Bill of Lading-GUY PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Bill of Lading-GUY PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Bill of Lading Dtl PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Bill of Lading Dtl PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Stop_Drop of PRT Bill of Lading Dtl PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Bill of Lading Dtl PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  20        W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Bill of Lading Dtl PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT B.O.L. Details     PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT B.O.L. Details     PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT B.O.L. Details     PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT B.O.L. Details     PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT B.O.L. Details     PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT B.O.L. Details     PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD5         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Header comments    PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Header comments    PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Header comments    PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of PRT Header comments    PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Header comments    PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Country Comment   PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Country Code of Prt Country Comment   PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of Prt Country Comment   PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Country Comment   PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Cust Comment      PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Cust Comment      PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of Prt Cust Comment      PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Cust Comment      PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Cust Comment BD   PO
     C           W0GP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of Prt Cust Comment BD   PO
     C           W0GP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Comment Type of Prt Cust Comment BD   PO
     C           W0GP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Cust Comment BD   PO
     C           W0GPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0GCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Document Comment  PO
     C           W0HP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Document Comment  PO
     C           W0HP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * CDD Department Code of Prt Document Comment  PO
     C           W0HP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * CDD Type of Prt Document Comment  PO
     C           W0HP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Document Comment  PO
     C           W0HPDT    IFEQ 'Y'
     C                     Z-ADD9         W0DTLN
     C           W0HCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDFJRMNB    $BRMNB           Load ID
      * Rtv Co. Shipper        RT - Company Defaults Internal  * 
     C                     EXSR SARVGN
      * CASE: TOP.CDI Shipper is Triumph
     C           $BYMSX    IFEQ 'TF'                       *IF
     C                     MOVEL@CN,001   $BLLU1           @Text 14
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BLLU1           @Text 14
     C                     MOVEL$BYMSX    $BLLU1           @Text 14
     C                     END                             *FI
      * RTV Federal ID,City,St RT - Company Name and Address  * 
     C                     EXSR SBRVGN
     C                     Z-ADD1         ZQ      50
     C           WUAJNA    CAT  WUBGCD:ZQ $BPGTX    P      City/State/Zip
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SCRVGN
      * CASE: TOP.CDI Shipper is Triumph
     C           $BYMSX    IFEQ 'TF'                       *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,003   CAT  'M':ZQ    WUD7U1    P      Text usr 14
     C                     Z-ADD*ZERO     ZQ      50
     C           WUD7U1    CAT  WUZNCD:ZQ WUD7U1    P      Text usr 14
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           @CN,003   CAT  WUZNCD:ZQ WUD7U1    P      Text usr 14
     C                     END                             *FI
     C                     Z-ADD2         ZQ      50
     C           $BPGTX    CAT  WUD7U1:ZQ $BPGTX    P      City/State/Zip
     C                     Z-ADDFJRNNB    $BRNNB           Reefer Temperat
     C                     MOVELFJWRTX    $BFRSX           Shipping Temp C
      * ** Leave Seal as character. Move 15 char to new 8 char print fiel
     C                     EXSR UASUBR                     ** Leave Seal a
     C                     MOVELFJDMTX    $BZ4TX           Seal 1 USR Alph
      * ** Format Seal 1
      * CASE: TOP.Seal 1 USR Alpha is ALL ZEROS
     C           $BZ4TX    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    $BZ4TX           Seal 1 USR Alph
     C                     END                             *FI
     C                     MOVELFJDNTX    $BZ5TX           Seal 2 USR Alph
      * ** Format Seal 2
      * CASE: TOP.Seal 2 USR Alpha is ALL ZEROS
     C           $BZ5TX    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    $BZ5TX           Seal 2 USR Alph
     C                     END                             *FI
     C                     MOVELFJDOTX    $BZ6TX           Seal 3 USR Alph
      * ** Format Seal 3
      * CASE: TOP.Seal 3 USR Alpha is ALL ZEROS
     C           $BZ6TX    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    $BZ6TX           Seal 3 USR Alph
     C                     END                             *FI
     C                     MOVELFJLSHG    $BLSHG           Load Shag Flag
     C                     MOVELFJYPST    $BYPST           Load Wash Flag
     C                     MOVELFJDXTX    $BMUTX           Trailer Id
      * WRK.Status Description = Condition name of DB1.Shipping Method
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM FJQ2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUHKNA    PARM           W0CNNM 25        Status Descript
      *
     C                     Z-ADD7         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUHKNA:ZQ $BHKNA    P  90  Status Descript
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ADD  1         WUXFNX           Page Number USR
     C                     Z-ADDWUXFNX    $BPGNU           USR Page Number
      * Convert fields to external form
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Co. Shipper        RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDFJAIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@JYREB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BYMSX           CDI Shipper
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELJYYMSX    $BYMSX           CDI Shipper
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Federal ID,City,St RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDFJAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABAJNA    WUAJNA           City
     C                     MOVELABA2NA    $BA2NA           Federal Tax Id
     C                     MOVELABBGCD    WUBGCD           State Code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDFJAIC3    KMAIC3           Company Number
     C                     MOVEL@CN,002   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WUZNCD           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Last Stop on Load  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSD02           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSD02           Load ID
      * Establish starting position
     C           KRSSD     SETLL@FLCPE8                    *
     C           KRSSD     READE@FLCPE8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0018           Stop_Drop
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARVNB    WN0018           Stop_Drop
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    WBAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Plant Company S
     C                     MOVEL*BLANK    WL0003           Company Organiz
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBYISX    WL0002           Plant Company S
     C                     MOVELWBYJSX    WL0003           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV BOL Shipping dtls  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DRRNB           Total Stops
     C                     MOVEL*BLANK    WUDXTX           Trailer Id
     C                     Z-ADD*ZERO     WUJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WUBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     $DKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     $DATTM           Scheduled Deliv
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDFJRRNB    $DRRNB           Total Stops
     C                     MOVELFJDXTX    WUDXTX           Trailer Id
     C                     Z-ADDFJJ7DT    WUJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    WUBOTM           BOL Complete Ti
     C                     Z-ADDFJKJDT    $DKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $DATTM           Scheduled Deliv
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$CBZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSG     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DIGTX           Name
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $DIGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print 2 RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    BEAIC3           Company Number
     C                     Z-ADD$DC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHMNA    WUHMNA           Ship To Address
     C                     MOVELBEHONA    WUHONA           Ship To Address
     C                     MOVELBEHPNA    WUHPNA           Ship To Address
     C                     MOVELBEHNNA    WUHNNA           Ship To City
     C                     MOVELBEDBCD    WUDBCD           Ship To State C
     C                     MOVELBECKTX    WUCKTX           Ship To Zip_Pos
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     MOVELBEB6NA    $DB6NA           Special Instruc
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Phone/ItemRefSts  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWUBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DBVTX           Telephone Numbe
     C                     MOVEL*BLANK    WN0021           Item Reference
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBBVTX    $DBVTX           Telephone Numbe
     C                     MOVELBBQYST    WN0021           Item Reference
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0004    AMAIC3           Company Number
     C                     Z-ADDWL0005    AMC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Shipping Line
     C                     MOVEL*BLANK    WL0007           Port Delv Termi
     C                     MOVEL*BLANK    WL0008           OHE City
     C                     MOVEL*BLANK    WL0009           OHE Vessel_Airl
     C                     MOVEL*BLANK    WL0010           OHE Voyage_Flig
     C                     MOVEL*BLANK    WL0011           OHE Booking Num
     C                     MOVEL*BLANK    WL0012           OHE Discharge P
     C                     Z-ADD*ZERO     WL0013           OHE Sail_Flight
     C                     Z-ADD*ZERO     WL0014           OHE Port Cut Da
     C                     Z-ADD*ZERO     WL0015           OHE Arrival Dat
     C                     MOVEL*BLANK    WL0016           OHE Late Delive
     C                     MOVEL*BLANK    WL0017           OHE Ship Status
     C                     MOVEL*BLANK    WL0018           OHE Container N
     C                     MOVEL*BLANK    WL0019           OHE Comment 1
     C                     MOVEL*BLANK    WL0020           OHE Comment 2
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMXACD    WL0006           Shipping Line
     C                     MOVELAMOANA    WL0007           Port Delv Termi
     C                     MOVELAMHBAA    WL0008           OHE City
     C                     MOVELAMJ0T1    WL0009           OHE Vessel_Airl
     C                     MOVELAMGENY    WL0010           OHE Voyage_Flig
     C                     MOVELAMJ1T1    WL0011           OHE Booking Num
     C                     MOVELAMHCAA    WL0012           OHE Discharge P
     C                     Z-ADDAMQWDT    WL0013           OHE Sail_Flight
     C                     Z-ADDAMQXDT    WL0014           OHE Port Cut Da
     C                     Z-ADDAMQYDT    WL0015           OHE Arrival Dat
     C                     MOVELAMHDAA    WL0016           OHE Late Delive
     C                     MOVELAMCCTX    WL0017           OHE Ship Status
     C                     MOVELAMJ2T1    WL0018           OHE Container N
     C                     MOVELAMRLNA    WL0019           OHE Comment 1
     C                     MOVELAMRMNA    WL0020           OHE Comment 2
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVEL$DXACD    LCXACD           Shipping Line
     C                     MOVELWN0001    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSK     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUOKTX           Port City
     C                     MOVEL*BLANK    WULBTX           Port Address Li
     C                     MOVEL*BLANK    WULATX           Port Address Li
     C                     MOVEL*BLANK    WUXBCD           Sail Port State
     C                     MOVEL*BLANK    WULCTX           Port Zip_Postal
     C                     Z-ADD*ZERO     WUSPPN           Port Phone Numb
     C                     MOVEL*BLANK    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    WUOKTX           Port City
     C                     MOVELLCLBTX    WULBTX           Port Address Li
     C                     MOVELLCLATX    WULATX           Port Address Li
     C                     MOVELLCXBCD    WUXBCD           Sail Port State
     C                     MOVELLCLCTX    WULCTX           Port Zip_Postal
     C                     Z-ADDLCSPPN    WUSPPN           Port Phone Numb
     C                     MOVELLCLDTX    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV OHE Delv,intend    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    AMAIC3           Company Number
     C                     Z-ADD$DC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $DLMT1           Delivery P_O  N
     C                     MOVEL*BLANK    WN0022           OHE Intended fo
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMLMT1    $DLMT1           Delivery P_O  N
     C                     MOVELAMLWAA    WN0022           OHE Intended fo
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Whse and Reason    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADD$DAIC3    WQSM01           Company Number
     C                     Z-ADD$DC4NB    WQSM02           Order Number
     C                     Z-ADDYL0020    OMDPNB           Order Sequence
     C                     Z-ADDYL0021    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0020           Order Sequence
     C                     Z-ADD*ZERO     YL0021           Order Secondary
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVEL*BLANK    YL0022           Reason Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     Z-ADDOMDPNB    YL0020           Order Sequence
     C                     Z-ADDOMUENB    YL0021           Order Secondary
     C                     MOVELOMAJCD    $DAJCD           Warehouse Code
     C                     MOVELOMCQCD    YL0022           Reason Code
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DAIC3    NIAIC3           Company Number
     C                     Z-ADDWUBKC7    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           Print Req Delv
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNIHLST    YL0023           Print Req Delv
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BIBKC7           Ship To Custome
     C                     KFLD           BIHGCD           Item Code
      * Setup key
     C                     Z-ADDWCBKC7    BIBKC7           Ship To Custome
     C                     Z-ADD$EHGCD    BIHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0024           CIR Resource No
     C                     MOVEL*BLANK    YL0025           CIR Item No
     C                     MOVEL*BLANK    YL0026           CIR Description
     C                     MOVEL*BLANK    YL0027           CIR Description
     C                     MOVEL*BLANK    YL0028           CIR Description
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBICOAA    YL0024           CIR Resource No
     C                     MOVELBICPAA    YL0025           CIR Item No
     C                     MOVELBIPSNA    YL0026           CIR Description
     C                     MOVELBIPTNA    YL0027           CIR Description
     C                     MOVELBIPUNA    YL0028           CIR Description
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Tare Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$EAIC3    BZAIC3           Company Number
     C                     Z-ADD$EHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSP     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     Z-ADDBZA3WG    WN0024           Misc Tare Weigh
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Item Box Tare Wgt  RT - PD Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0026  3        Item Type Code
     C                     MOVEL*BLANK    WN0027  1        Package Type Co
     C                     Z-ADD*ZERO     WN0028 112       Unit Weight USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0023           Unit Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSQ02           Item Code
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Item Code
      * Setup key
     C                     Z-ADDWL0021    WQSQ01           Company Number
     C                     Z-ADDWL0022    WQSQ02           Item Code
      * Establish starting position
     C           KRSSQ     SETLL@IORETI                    *
     C           KRSSQ     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WL0023           Unit Weight
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
     C                     EXSR SRRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Packaging and Supplies
      *   |- c2    : PAR.Package Type Code is Box
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0026    IFEQ 'PS'                       *IF
     C           WN0027    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SQEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WL0023           Unit Weight
     C                     END                             *FI
     C           KRSSQ     READE@IORETI                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDWN0028    WL0023           Unit Weight
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Type/Pack/Unit Wgt RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    BZAIC3           Company Number
     C                     Z-ADDIOC9NB    BZHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WL0023           Unit Weight
     C                     MOVELBZN0CD    WN0026           Item Type Code
     C                     MOVELBZX4ST    WN0027           Package Type Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV if Compliant RT - Item Default Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0029           IDE Regulation
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BTHGCD           Item Code
      * Setup key
     C                     Z-ADD$EHGCD    BTHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BTRETK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4745' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBTAOSC    YL0029           IDE Regulation
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Compl Stmts RT - Regulation Code Mst  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN C8CBAB    WQST01           Regulation ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Regulation ID
      * Setup key
     C                     MOVELYL0029    WQST01           Regulation ID
      * Establish starting position
     C           KRSST     SETLL@C8REMY                    *
     C           KRSST     READE@C8REMY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5316' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0030           Compliancy Stm1
     C                     MOVEL*BLANK    YL0031           Compliancy Stm2
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           C8VSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELC8UZU1    YL0030           Compliancy Stm1
     C                     MOVELC8U0U1    YL0031           Compliancy Stm2
     C                     END                             *FI
     C           KRSST     READE@C8REMY                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSU     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0032           Ship To Custome
     C                     MOVEL*BLANK    YL0033           Ship To State C
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    YL0032           Ship To Custome
     C                     MOVELBEDBCD    YL0033           Ship To State C
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Tot Pallet Tare   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSV01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSV02           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSV01           Company Number
     C                     Z-ADDFLC4NB    WQSV02           Order Number
      * Establish starting position
     C           KRSSV     SETLL@BGWKL1                    *
     C           KRSSV     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0034           Warehouse Palle
     C                     Z-ADD*ZERO     YL0035           Warehouse Palle
     C                     Z-ADD*ZERO     YL0036           Warehouse Avg P
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     Z-ADDOMNTDT    YL0034           Warehouse Palle
     C                     Z-ADDOMH5NX    YL0035           Warehouse Palle
     C                     Z-ADDOMH6NX    YL0036           Warehouse Avg P
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv OH Ship Plt Wgts  RT - OH Pallet Table Shipped  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * sum (pallets shipped*pallet weight) for the order
     C                     Z-ADD*ZERO     YL0037           Tare Weight Tot
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           B7AIC3           Company Number
     C                     KFLD           B7C4NB           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    B7AIC3           Company Number
     C                     Z-ADD$FC4NB    B7C4NB           Order Number
      * Establish starting position
     C           KRSSW     CHAIN@B7CPH7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5205' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0037           Tare Weight Tot
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Pallet Type 1 is None
     C           B7LZSC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Weight     RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELB7LZSC    WL0024    P      PM Pallet Type
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0038           Misc Tare Weigh
     C           B7S3QT    MULT YL0038    YL0039           Tare Weight Tot
     C                     ADD  YL0039    YL0037           Tare Weight Tot
     C                     END                             *FI
      * pallet type 2
      * CASE: DB1.Pallet Type 2 is None
     C           B7L0SC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Weight     RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELB7L0SC    WL0024    P      PM Pallet Type
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0038           Misc Tare Weigh
     C           B7S4QT    MULT YL0038    YL0039           Tare Weight Tot
     C                     ADD  YL0039    YL0037           Tare Weight Tot
     C                     END                             *FI
      * pallet type 3
      * CASE: DB1.Pallet Type 3 is None
     C           B7L1SC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Weight     RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELB7L1SC    WL0024    P      PM Pallet Type
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0038           Misc Tare Weigh
     C           B7S5QT    MULT YL0038    YL0039           Tare Weight Tot
     C                     ADD  YL0039    YL0037           Tare Weight Tot
     C                     END                             *FI
      * pallet type 4
      * CASE: DB1.Pallet Type 4 is None
     C           B7L2SC    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Pallet Weight     RT - Pallet Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELB7L2SC    WL0024    P      PM Pallet Type
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0038           Misc Tare Weigh
     C           B7S6QT    MULT YL0038    YL0039           Tare Weight Tot
     C                     ADD  YL0039    YL0037           Tare Weight Tot
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Pallet Weight     RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVELWL0024    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSSX     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0025           Misc Tare Weigh
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB6A3WG    WL0025           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSY02           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
      * Setup key
     C                     Z-ADD$FAIC3    WQSY01           Company Number
     C                     Z-ADD$FC4NB    WQSY02           Order Number
      * Establish starting position
     C           KRSSY     SETLL@BGWKAE                    *
     C           KRSSY     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0040           Country Code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELWCKXCD    YL0040           Country Code
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSY     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Order Status       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSZ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WN0011           Header Status
     C                     MOVELBEGXST    WUGXST           Header Status L
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTA02           Order Number
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQTA01           Company Number
     C                     Z-ADDFLC4NB    WQTA02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSTA     SETLL@BGWKL1                    *
     C           KRSTA     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0002           Warehouse Code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WN0002           Warehouse Code
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0048           User Code Model
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WN0048           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           L1AJVN           User Profile Na
     C                     KFLD           L1AJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0026    L1AJVN           User Profile Na
     C                     MOVELWL0027    L1AJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0028           UWA Inventory T
     C                     MOVEL*BLANK    WL0029           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0030           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0031           UWA Cross Appli
     C                     MOVEL*BLANK    WL0032           UWA Unused Stat
     C                     MOVEL*BLANK    WL0033           UWA Unused Stat
     C                     MOVEL*BLANK    WL0034           UWA Unused Sts
     C                     MOVEL*BLANK    WL0035           UWA Unused Sts
     C                     MOVEL*BLANK    WL0036           UWA Unused Sts
     C                     MOVEL*BLANK    WL0037           UWA Unused Sts
     C                     MOVEL*BLANK    WL0038           UWA Unused Sts
     C                     MOVEL*BLANK    WL0039           UWA Unused Sts
     C                     MOVEL*BLANK    WL0040           UWA Unused Sts
     C                     MOVEL*BLANK    WL0041           UWA Unused Sts
     C                     MOVEL*BLANK    WL0042           UWA Unused Sts
     C                     MOVEL*BLANK    WL0043           UWA Unused Sts
     C                     MOVEL*BLANK    WL0044           UWA Unused Sts
     C                     MOVEL*BLANK    WL0045           UWA Unused Sts
     C                     MOVEL*BLANK    WL0046           UWA Unused Sts
     C                     MOVEL*BLANK    WL0047           Record Found US
     C                     MOVEL'N'       WL0047           Record Found US
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL1UWAS    WL0028           UWA Inventory T
     C                     MOVELL1EPSX    WL0029           UWA Lot Loc Tra
     C                     MOVELL1EQSX    WL0030           UWA Shipping Tr
     C                     MOVELL1ERSX    WL0031           UWA Cross Appli
     C                     MOVELL1UWAT    WL0032           UWA Unused Stat
     C                     MOVELL1EKSX    WL0033           UWA Unused Stat
     C                     MOVELL1ECSX    WL0034           UWA Unused Sts
     C                     MOVELL1EDSX    WL0035           UWA Unused Sts
     C                     MOVELL1EESX    WL0036           UWA Unused Sts
     C                     MOVELL1EFSX    WL0037           UWA Unused Sts
     C                     MOVELL1EGSX    WL0038           UWA Unused Sts
     C                     MOVELL1EHSX    WL0039           UWA Unused Sts
     C                     MOVELL1EISX    WL0040           UWA Unused Sts
     C                     MOVELL1EJSX    WL0041           UWA Unused Sts
     C                     MOVELL1UWAU    WL0042           UWA Unused Sts
     C                     MOVELL1ELSX    WL0043           UWA Unused Sts
     C                     MOVELL1EMSX    WL0044           UWA Unused Sts
     C                     MOVELL1ENSX    WL0045           UWA Unused Sts
     C                     MOVELL1EOSX    WL0046           UWA Unused Sts
     C                     MOVEL'Y'       WL0047           Record Found US
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv OH Shipped Pallet RT - OH Pallet Table Shipped  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           B7AIC3           Company Number
     C                     KFLD           B7C4NB           Order Number
      * Setup key
     C                     Z-ADD$GAIC3    B7AIC3           Company Number
     C                     Z-ADD$GC4NB    B7C4NB           Order Number
      * Establish starting position
     C           KRSTD     CHAIN@B7CPH7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5205' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0043           Pallet Type 1
     C                     Z-ADD*ZERO     YL0044           Pallet Qty 1
     C                     MOVEL*BLANK    YL0045           Pallet Type 2
     C                     Z-ADD*ZERO     YL0046           Pallet Qty 2
     C                     MOVEL*BLANK    YL0047           Pallet Type 3
     C                     Z-ADD*ZERO     YL0048           Pallet Qty 3
     C                     MOVEL*BLANK    YL0049           Pallet Type 4
     C                     Z-ADD*ZERO     YL0050           Pallet Qty 4
     C                     MOVEL*BLANK    YL0051           Record Status
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB7LZSC    YL0043           Pallet Type 1
     C                     Z-ADDB7S3QT    YL0044           Pallet Qty 1
     C                     MOVELB7L0SC    YL0045           Pallet Type 2
     C                     Z-ADDB7S4QT    YL0046           Pallet Qty 2
     C                     MOVELB7L1SC    YL0047           Pallet Type 3
     C                     Z-ADDB7S5QT    YL0048           Pallet Qty 3
     C                     MOVELB7L2SC    YL0049           Pallet Type 4
     C                     Z-ADDB7S6QT    YL0050           Pallet Qty 4
     C                     MOVELB7VSST    YL0051           Record Status
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Pallet Desc       RT - Pallet Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           B6LWSC           PM Pallet Type
      * Setup key
     C                     MOVELWL0048    B6LWSC           PM Pallet Type
      * Establish starting position
     C           KRSTE     CHAIN@B6CPH3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5203' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0049           PM Description
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB6QJU1    WL0049           PM Description
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Record count      RT - Customer Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBKC7    WQTF01           Ship To Custome
     C           *LIKE     DEFN WDI1SX    WQTF02           Comment Type
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Ship To Custome
     C                     KFLD           WQTF02           Comment Type
      * Setup key
     C                     Z-ADDWL0050    WQTF01           Ship To Custome
     C                     MOVELWL0051    WQTF02           Comment Type
      * Establish starting position
     C           KRSTF     SETLL@AVCPG5                    *
     C           KRSTF     READE@AVCPG5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2993' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         WL0052           USR Count
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WL0052           USR Count
     C           KRSTF     READE@AVCPG5                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Loads label dates  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD*ZERO     YL0070           Date From
     C                     Z-ADD*ZERO     YL0071           Date To
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTG02           Load ID
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG02           Load ID
      * Setup key
     C                     Z-ADD$NRMNB    WQTG02           Load ID
      * Establish starting position
     C           KRSTG     SETLL@BFCPD9                    *
     C           KRSTG     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv LabelDt Range f/Or RT - Item Transaction Detail  * 
     C                     EXSR THRVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.From Date             USR LT PAR.Date From
      *   |- c2    : PAR.Date From             USR is Not Entered
      *   '-
     C           YL0072    IFLT YL0070                     *IF
     C           YL0070    OREQ 0                          *OR
     C                     Z-ADDYL0072    YL0070           Date From
     C                     END                             *FI
      * CASE: LCL.To Date               USR GT PAR.Date To
     C           YL0073    IFGT YL0071                     *IF
     C                     Z-ADDYL0073    YL0071           Date To
     C                     END                             *FI
     C           KRSTG     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv LabelDt Range f/Or RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTH01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTH02           Order Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTH01           Company Number
     C                     Z-ADDWEC4NB    WQTH02           Order Number
      * Establish starting position
     C           KRSTH     SETLL@B7CPJS                    *
     C           KRSTH     READE@B7CPJS                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.U/M - Transaction is Combos
     C           WFHVCD    IFEQ 'CB'                       *IF
      * LCL.From Date             USR = DB1.Label Date + CON.-1 *DAYS
     C           WFK7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0074
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0074
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.From Date             USR = DB1.Label Date + CON.-2 *DAYS
     C           WFK7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0074
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0074
     C                     END
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.From Date             USR LT PAR.From Date
      *   |- c2    : PAR.From Date             USR is Zero
      *   '-
     C           YL0074    IFLT YL0072                     *IF
     C           YL0072    OREQ 0                          *OR
     C                     Z-ADDYL0074    YL0072           From Date
     C                     END                             *FI
     C           KRSTH     READE@B7CPJS                  90*
     C                     ENDDO
      * USER: Exit processing
      * Last date is latest LABEL date
      * CASE: DB1.U/M - Transaction is Combos
     C           WFHVCD    IFEQ 'CB'                       *IF
      * PAR.To Date               USR = DB1.Label Date + CON.-1 *DAYS
     C           WFK7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0073
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0073
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR.To Date               USR = DB1.Label Date + CON.-2 *DAYS
     C           WFK7DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0073
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0073
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Kill Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADDWL0053    AFAIC3           Company Number
     C                     Z-ADDWL0054    AFBCDT           Post to G_L Dat
      * Establish starting position
     C           KRSTI     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0055           Kill Day Status
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFV9ST    WL0055           Kill Day Status
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Prev Kill Date    RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQTJ01           Company Number
      * Define keylist
     C           KPSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WGBCDT           Post to G_L Dat
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
      * Setup key
     C                     Z-ADDWL0056    WQTJ01           Company Number
     C                     Z-ADDWL0057    WGBCDT           Post to G_L Dat
      * Establish starting position
     C           KPSTJ     SETLL@AFREPU                    *
     C           KRSTJ     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0058           Kill Date PRV U
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date EQ PAR.Post to G/L Date
     C           WGBCDT    IFEQ WL0057                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Kill Day Status is yes
     C           WGV9ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWGBCDT    WL0058           Kill Date PRV U
     C                     GOTO TJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTJ     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Val Comment Exists    RT - Company Document Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0078           Record Created
      * Declare restrictor key work fields
     C           *LIKE     DEFN AQAIC3    WQTK01           Company Number
     C           *LIKE     DEFN AQFPAA    WQTK02           CDD Department
     C           *LIKE     DEFN AQESTX    WQTK03           CDD Type
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           CDD Department
     C                     KFLD           WQTK03           CDD Type
      * Setup key
     C                     Z-ADDP1AIC3    WQTK01           Company Number
     C                     MOVE *BLANK    WQTK02           CDD Department
     C                     MOVEL'TRAFF'   WQTK02           CDD Department
     C                     MOVEL'BL'      WQTK03           CDD Type
      * Establish starting position
     C           KRSTK     SETLL@AQREJ5                    *
     C           KRSTK     READE@AQREJ5                  90*
      * Data record not found
     C   90                MOVEL'USR3410' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : DB1.CDD Comment 1 is Entered
      *   |- c2    : DB1.CDD Comment 2 is Entered
      *   |- c3    : DB1.CDD Comment 3 is Entered
      *   |- c4    : DB1.CDD Comment 4 is Entered
      *   |- c5    : DB1.CDD Comment 5 is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           AQEYT1    IFNE *BLANK                     *IF
     C           AQEZT1    IFNE *BLANK                     *IF
     C           AQKBT1    IFNE *BLANK                     *IF
     C           AQKCT1    IFNE *BLANK                     *IF
     C           AQKDT1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0078           Record Created
     C                     END                             *FI
     C           KRSTK     READE@AQREJ5                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Leave Seal as character. Move 15 char to new 8 char print fie
      *================================================================
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT BOL Dtl - GUY      PO
      *================================================================
      * ** Total load miles will be Override miles, if entered   E00207
      * ** PAR.Unused Status USR will receive export sts from order hdr
      *
     C                     MOVEL*BLANK    WN0001 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0002  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip_Pos
     C                     MOVEL*BLANK    WN0011  1        Header Status
     C                     MOVEL*BLANK    WN0012  1        Export Status
     C                     Z-ADD*ZERO     WN0013  91       USR Weight   9.
     C                     Z-ADD*ZERO     WN0014  91       USR Weight   9.
     C                     Z-ADD*ZERO     WN0015  70       USR Quantity Sh
     C                     Z-ADD*ZERO     WN0016  60       USR number
     C                     MOVEL*BLANK    WN0017  1        USR Display 2
     C                     Z-ADD*ZERO     WN0018  50       USR Stop/Drop
     C                     MOVEL*BLANK    WN0019  1        Access Denied (
     C                     Z-ADD*ZERO     WN0020  91       Gross Weight US
     C                     MOVEL*BLANK    WN0021  1        Item Reference
     C                     MOVEL*BLANK    WN0022  6        OHE Intended fo
      *
      * PRT Bill of Lading Dtl PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT B.O.L. Details     PO
      *================================================================
      * CASE: LCL.Print (Yes/No) USR is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     GOTO UCEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0023 112       Unit Weight
     C                     Z-ADD*ZERO     WN0024  52       Misc Tare Weigh
     C                     Z-ADD*ZERO     WN0025  70       BOL Number of P
      *
      * PRT B.O.L. Details     PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Header comments    PO
      *================================================================
      * Added PO to print Order Comments for BOL SAZ 2/13/08
      * PRT Header comments    PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Country Comment   PO
      *================================================================
      * E0657 -  print country comments if...
      * CASE: PAR.OHE Intended for ExportCC is Blank
     C           WN0022    IFEQ *BLANK                     *IF
      * CASE: LCL.Country Code is Blank
     C           YL0040    IFEQ *BLANK                     *IF
     C                     GOTO UEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BL'      YL0056           Comment Type
     C                     MOVELYL0040    WN0022           OHE Intended fo
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BI'      YL0056           Comment Type
     C                     END                             *FI
      * Prt Country Comment   PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Cust Comment      PO
      *================================================================
      * Prt Cust Comment      PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Cust Comment BD   PO
      *================================================================
      * Prt Cust Comment BD   PO: Mainline
     C                     EXSR G0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Document Comment  PO
      *================================================================
      * Val Comment Exists    RT - Company Document Defaults  * 
     C                     EXSR TKRVGN
      * CASE: LCL.Record Created        USR is No
     C           YL0078    IFEQ 'N'                        *IF
     C                     GOTO UHEXIT                     *QUIT
     C                     END                             *FI
      * Prt Document Comment  PO: Mainline
     C                     EXSR H0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
     C           UJ1UF     BEGSR
      *=============================================================
      * UJ1UF - COMPRESS NAME/ADDRESS INFORMATION
      *=============================================================
      *
     C           *LIKE     DEFN WUBRTX    UUADTX
     C           *LIKE     DEFN YL0013    UUACNA
     C           *LIKE     DEFN YL0014    UUADNA
     C           *LIKE     DEFN WUGSTX    UUAENA
     C           *LIKE     DEFN YL0016    UUAJNA
     C           *LIKE     DEFN YL0017    UUEINA
     C           *LIKE     DEFN YL0018    UUBTTX- 1
      * CLEAR OUTPUT ARRAY
     C                     MOVE *BLANK    UAD
     C                     Z-ADD1         UX      20
     C                     MOVELUUADTX    UAD,UX
     C                     ADD  1         UX
     C           UUACNA    IFNE *BLANK
     C                     MOVELUUACNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUADNA    IFNE *BLANK
     C                     MOVELUUADNA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C           UUAENA    IFNE *BLANK
     C                     MOVELUUAENA    UAD,UX
     C                     ADD  1         UX
     C                     END
     C                     MOVE *BLANK    UUCSTZ 34
     C                     MOVELUUAJNA    UUCST  23
     C                     MOVE UUEINA    UUCST
     C                     MOVELUUCST     UUCSTZ
     C                     MOVE UUBTTX    UUCSTZ
     C                     MOVELUUCSTZ    UAD,UX
      *============================================================
     C                     ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Bill of Lading Dtl PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUZ2SX           USR Display 11
      * CASE: PAR.Shipping Method is Buyers Truck
     C           $CQ2CD    IFEQ 'CR'                       *IF
     C           $CQ2CD    OREQ 'CT'
     C                     MOVEL'N'       WN0017           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0017           USR Display 2
     C                     END                             *FI
      * NOTE:  PAR ship to fields hold LAST STOP information
      * RTV Last Stop on Load  RT - OM Load Detail  * 
     C                     EXSR SDRVGN
     C                     Z-ADD*ZERO     P4PGNU           USR Page Number
     C                     MOVEL'N'       YL0001           Record Found US
     C                     Z-ADD*ZERO     WN0020           Gross Weight US
     C                     MOVEL'N'       YL0002           Print (Yes/No)
     C                     MOVEL'Y'       WUTMST           USR First Time
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0001    P      Plant Company S
     C                     MOVELWL0003    YL0003    P      Company Organiz
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT B.O.L. Details     PO: Initialise
      *================================================================
      * USER: Initialize program
      * 05/09/23 WI572 CA Prop 12
      * E.L.           Adding Verbiage for Regul ITEMS
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * Prt Country Comment   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       YL0058           First time flag
     C                     Z-ADD69        YL0059           Page Length
     C                     MOVEL'Y'       WUTMST           USR First Time
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZFINIT    BEGSR
      *================================================================
      * Prt Cust Comment      PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Record count      RT - Customer Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUBKC7    WL0050           Ship To Custome
     C                     MOVEL'BL'      WL0051    P      Comment Type
     C                     Z-ADDYL0062    WL0052           USR Count
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    YL0062           USR Count
      * If last stop, add 4 lines for Total Load lines
      * CASE: PAR.USR Display 1 is No
     C           WUTIST    IFEQ 'N'                        *IF
     C                     ADD  5         YL0062           USR Count
     C                     END                             *FI
     C                     MOVEL'Y'       YL0063           First time flag
     C                     Z-ADD69        YL0064           Page Length
      *================================================================
     CSR         ZFEXIT    ENDSR
      /EJECT
     CSR         ZGINIT    BEGSR
      *================================================================
      * Prt Cust Comment BD   PO: Initialise
      *================================================================
      * USER: Initialize program
      * ********************************
      * Print BOL Slaughter Dates on line 2 of comments
     C                     Z-ADD2         WUHKNX           Numeral 1
      * ********************************
      * Rtv Record count      RT - Customer Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUBKC7    WL0050           Ship To Custome
     C                     MOVEL'BD'      WL0051    P      Comment Type
     C                     Z-ADDYL0066    WL0052           USR Count
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0052    YL0066           USR Count
     C                     MOVEL'Y'       YL0067           First time flag
     C                     Z-ADD69        YL0068           Page Length
      *================================================================
     CSR         ZGEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P1DMTX           Seal 1
     C                     MOVEL*BLANK    P1DNTX           Seal 2
     C                     MOVEL*BLANK    P1DOTX           Seal 3
     C                     Z-ADD*ZERO     P1RRNB           Total Stops
     C                     MOVEL*BLANK    P1DXTX           Trailer Id
     C                     Z-ADD*ZERO     P1SBNB           BOL Time
     C                     Z-ADD*ZERO     P1SDNB           Number Pallets
     C                     Z-ADD*ZERO     P1PAOU           Number Pallets
     C                     Z-ADD*ZERO     P1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     P1PRTM           Product Tempera
     C                     Z-ADD*ZERO     P1NPSV           Number Spacers
     C                     MOVEL*BLANK    P1J8TX           Car_Veh_Initial
     C                     MOVEL*BLANK    P1J9TX           Recorder ID
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2WXST           Record Found US
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4PGNU           USR Page Number
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Page Number USR
     C                     Z-ADD*ZERO     WUXFNX
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FJRMNB           Load ID
      * Define work field City
     C                     MOVEL*BLANK    WUAJNA 20
      * Define work field State Code
     C                     MOVEL*BLANK    WUBGCD  2
      * Define work field ED Plant Number
     C                     MOVEL*BLANK    WUZNCD 10
      * Define work field Text usr 14
     C                     MOVEL*BLANK    WUD7U1 14
      * Define work field Status Description
     C                     MOVEL*BLANK    WUHKNA 12
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field USR Display 11
     C                     MOVEL*BLANK    WUZ2SX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop_Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR First Time
     C                     MOVEL*BLANK    WUTMST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBXXTM           Departure Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*LOVAL    FLRVNB           Stop_Drop
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field IDE Regul Code ID Saved
     C                     MOVEL*BLANK    WUOJSC  2
      * Define work field USR Overflow
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field Trailer Id
     C                     MOVEL*BLANK    WUDXTX 20
      * Define work field BOL Complete Date
     C                     Z-ADD*ZERO     WUJ7DT  70
      * Define work field BOL Complete Time
     C                     Z-ADD*ZERO     WUBOTM  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Port City
     C                     MOVEL*BLANK    WUOKTX 25
      * Define work field Port Address Line 1
     C                     MOVEL*BLANK    WULBTX 25
      * Define work field Port Address Line 2
     C                     MOVEL*BLANK    WULATX 25
      * Define work field Sail Port State
     C                     MOVEL*BLANK    WUXBCD  2
      * Define work field Port Zip_Postal Code
     C                     MOVEL*BLANK    WULCTX 11
      * Define work field Port Phone Number
     C                     Z-ADD*ZERO     WUSPPN 110
      * Define work field Port Fax Number
     C                     MOVEL*BLANK    WULDTX 25
      * Define work field Value Alpha 13  (11)
     C                     MOVEL*BLANK    WUF6NA 11
      * Define work field USR Reason Code 3
     C                     MOVEL*BLANK    WUNZCD  3
      * Define work field USR Work Field 3A
     C                     MOVEL*BLANK    WUEZTX  3
      * Define work field USR To Format
     C                     MOVEL*BLANK    WUN5CD  4
      * Define work field CMS Contact Phone ext
     C                     MOVEL*BLANK    WUJUTX  4
      * Define work field CMS Primary SIC
     C                     MOVEL*BLANK    WUJWTX  4
      * Define work field @Alpha 8
     C                     MOVEL*BLANK    WUN7NA  8
      * Define work field @Alpha 12
     C                     MOVEL*BLANK    WULETX 12
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WCAIC3           Company Number
     C                     MOVEL*LOVAL    WCC4NB           Order Number
     C                     MOVEL*LOVAL    WCDPNB           Order Sequence
     C                     MOVEL*LOVAL    WCUENB           Order Secondary
      * Define work field Net Weight USR 9.1
     C                     Z-ADD*ZERO     WUFZWG  91
      * Define work field Gross Weight USR 9.1
     C                     Z-ADD*ZERO     WUF0WG  91
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Case Quantity
     C                     Z-ADD*ZERO     WUFOQT  50
      * Define work field Header Status Last
     C                     MOVEL*BLANK    WUGXST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    COAIC3           Company Number
     C                     MOVEL*LOVAL    COC4NB           Order Number
     C                     MOVEL*LOVAL    COI1SX           Comment Type
     C                     MOVEL*LOVAL    CODXNB           Sequence Number
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B1KXCD           Country Code
     C                     MOVEL*LOVAL    B1I1SX           Comment Type
     C                     MOVEL*LOVAL    B1M5NX           Comment Sequenc
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AVBKC7           Ship To Custome
     C                     MOVEL*LOVAL    AVI1SX           Comment Type
     C                     MOVEL*LOVAL    AVM5NX           Comment Sequenc
      * Define work field Numeral 1             USR
     C                     Z-ADD*ZERO     WUHKNX  10
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AVBKC7           Ship To Custome
     C                     MOVEL*LOVAL    AVI1SX           Comment Type
     C                     MOVEL*LOVAL    AVM5NX           Comment Sequenc
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A_R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WFC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WFAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WFAKCS           USR Transaction
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFCKNB           GL Document Num
     C                     Z-ADD*ZERO     WFTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WFTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFAWTM           Production Time
     C                     Z-ADD*ZERO     WFK7DT           Label Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBCDT           Post to G_L Dat
     C                     Z-ADD*ZERO     WGCQNB           Julian Date
     C                     Z-ADD*ZERO     WGESNB           Accounting Year
     C                     Z-ADD*ZERO     WGETNB           Accounting Peri
     C                     Z-ADD*ZERO     WGBZNB           OM Week
     C                     Z-ADD*ZERO     WGEINB           Week Number
     C                     Z-ADD*ZERO     WGAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WGOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WGNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WGNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WGOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WGOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AQAIC3           Company Number
     C                     MOVEL*LOVAL    AQFPAA           CDD Department
     C                     MOVEL*LOVAL    AQESTX           CDD Type
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007 20
     C                     MOVEL*BLANK    WL0008 25
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010 15
     C                     MOVEL*BLANK    WL0011 15
     C                     MOVEL*BLANK    WL0012 20
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018 12
     C                     MOVEL*BLANK    WL0019 35
     C                     MOVEL*BLANK    WL0020 75
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023 112
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0024  2
     C                     Z-ADD*ZERO     WL0025  52
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0026 10
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043  2
     C                     MOVEL*BLANK    WL0044  2
     C                     MOVEL*BLANK    WL0045  2
     C                     MOVEL*BLANK    WL0046  2
     C                     MOVEL*BLANK    WL0047  1
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0048  2
     C                     MOVEL*BLANK    WL0049 15
      * Define local variables for subroutine TFRVGN.
     C                     Z-ADD*ZERO     WL0050  70
     C                     MOVEL*BLANK    WL0051  2
     C                     Z-ADD*ZERO     WL0052  30
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  1
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Print (Yes/No) USR
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0004 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0006  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0008 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0010  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0011 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0012  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0013  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0015  60
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0016  1
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0004 25
      * Define local work field OHE Sail_Flight Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0010 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0011 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0012 75
      * Define local work field PFS Shipping Line Name
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field PFS Shipping Line Addr 1
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field PFS Shipping Line Addr 2
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field PFS Shipping Line City
     C                     MOVEL*BLANK    YL0016 20
      * Define local work field PFS Shipping Line State
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field PFS Shipping LIne Zip
     C                     MOVEL*BLANK    YL0018 11
      * Define local work field TMS Country Code
     C                     MOVEL*BLANK    YL0019 10
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Reason Code
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Print Req Delv Tm on Docs
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field CIR Resource No
     C                     MOVEL*BLANK    YL0024 14
      * Define local work field CIR Item No
     C                     MOVEL*BLANK    YL0025 10
      * Define local work field CIR Description Line 1
     C                     MOVEL*BLANK    YL0026 30
      * Define local work field CIR Description Line 2
     C                     MOVEL*BLANK    YL0027 30
      * Define local work field CIR Description Line 3
     C                     MOVEL*BLANK    YL0028 30
      * Define local work field IDE Regulation Code ID
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field Compliancy Stm1 Item
     C                     MOVEL*BLANK    YL0030 50
      * Define local work field Compliancy Stm2 Item
     C                     MOVEL*BLANK    YL0031 50
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0018  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0032  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0019 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0021 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0022 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0023 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0033  2
      * Define null work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YN0024 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0026 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0027 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0030 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0031  2
      * Define null work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YN0032 11
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0033 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0035  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0036  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0037  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0038  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0039 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0040 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0041  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Comment Print Inv_Cr_Memo
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0046  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0051  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0052 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0053  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0054 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0055 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0060  40
      * Define null work field Accounts Receiv_Ent 1
     C                     MOVEL*BLANK    YN0061  4
      * Define null work field Accounts Receiv_Ent 2
     C                     MOVEL*BLANK    YN0062 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0063  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0064  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0065 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0069  2
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0074  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0076  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0078  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0080 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0081 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0083  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0084  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0085  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0086  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0087  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0088  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0089  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0090  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0091  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field A_R order Value Total
     C                     Z-ADD*ZERO     YN0094 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0095  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0097  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0098 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0100  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0101  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0102  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0103  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0104  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0105  1
      * Define null work field Export Docs Go w_Driver
     C                     MOVEL*BLANK    YN0106  1
      * Define null work field Shipping Temp Code C_F
     C                     MOVEL*BLANK    YN0107  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0108  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0109  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0110  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0111  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0112  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0113  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0114  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0115  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0116  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0117  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0118  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0119  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0120  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0121  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0122  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0123  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0124  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0125 112
      * Define null work field Act Non_Ref Frt Amount
     C                     Z-ADD*ZERO     YN0126 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0127 112
      * Define null work field OH Total Non_Ref Frt Amt
     C                     Z-ADD*ZERO     YN0128 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0129 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0130  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0131  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0132  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0133  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0134  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0135 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0136 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0137  70
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0034  50
      * Define local work field Warehouse Pallet Tare
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0036  92
      * Define local work field Tare Weight Total
     C                     Z-ADD*ZERO     YL0037 112
      * Define local work field Misc Tare Weight
     C                     Z-ADD*ZERO     YL0038  52
      * Define local work field Tare Weight Total
     C                     Z-ADD*ZERO     YL0039 112
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0040  6
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Display Pallet Type/Qty
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Pallet Type 1
     C                     MOVEL*BLANK    YL0043  2
      * Define local work field Pallet Qty 1
     C                     Z-ADD*ZERO     YL0044  50
      * Define local work field Pallet Type 2
     C                     MOVEL*BLANK    YL0045  2
      * Define local work field Pallet Qty 2
     C                     Z-ADD*ZERO     YL0046  50
      * Define local work field Pallet Type 3
     C                     MOVEL*BLANK    YL0047  2
      * Define local work field Pallet Qty 3
     C                     Z-ADD*ZERO     YL0048  50
      * Define local work field Pallet Type 4
     C                     MOVEL*BLANK    YL0049  2
      * Define local work field Pallet Qty 4
     C                     Z-ADD*ZERO     YL0050  50
      * Define null work field EDI ASN Status
     C                     MOVEL*BLANK    YN0138  1
      * Define null work field Unused Flag 1
     C                     MOVEL*BLANK    YN0139  1
      * Define null work field Unused Flag 2
     C                     MOVEL*BLANK    YN0140  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Pallet type 1 Desc
     C                     MOVEL*BLANK    YL0052  6
      * Define local work field Pallet type 2 Desc
     C                     MOVEL*BLANK    YL0053  6
      * Define local work field Pallet type 3 Desc
     C                     MOVEL*BLANK    YL0054  6
      * Define local work field Pallet type 4 Desc
     C                     MOVEL*BLANK    YL0055  6
      * Define local work field Comment Type
     C                     MOVEL*BLANK    YL0056  2
      * Define local work field USR Display 1
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Page Length
     C                     Z-ADD*ZERO     YL0059  30
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0060  50
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0061  30
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0062  30
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0063  1
      * Define local work field Page Length
     C                     Z-ADD*ZERO     YL0064  30
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0065  50
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0066  30
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Page Length
     C                     Z-ADD*ZERO     YL0068  30
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0069  50
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0070  70
      * Define local work field Date To               USR
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field From Date             USR
     C                     Z-ADD*ZERO     YL0072  70
      * Define local work field To Date               USR
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field From Date             USR
     C                     Z-ADD*ZERO     YL0074  70
      * Define local work field Kill Day Status
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field Kill Date PRV USR
     C                     Z-ADD*ZERO     YL0076  70
      * Define local work field Text USR 40
     C                     MOVEL*BLANK    YL0077 40
      * Define local work field Record Created        USR
     C                     MOVEL*BLANK    YL0078  1
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
     C                     Z-ADD*ZERO     WUXFNX           Page Number USR
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Triumph Foods
00002 PLTESTNO
00003 Est #:
00004 0000000
00005 (Continued)
00006 Comments
00007 Slaughter Dates:
