/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PKQGUPC                                       */
/*  PROGRAM NAME:    END TRUCK SCALE JOB                           */
/*  PROGRAMMER:      PURVA DROGE                                   */
/*  CREATE DATE:     01/22/99                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL ENDS THE TRUCK SCALE JOB              */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*  RMC 03/28/07 WITH NEW OPERATING SYSTEM RELEASE - THE ENDJOB   */
/*               SENDS COMPLETION MSG CPF1362 -- THIS CANNOT BE   */
/*               MONITORED! SO RTVJOBSTS INSTEAD.               */
/*                                                                 */
/*  RMC 01/03/22 WITH NEW OPERATING SYSTEM RELEASE - THE ENDJOB   */
/*               SENDS COMPLETION MSG CPF1321 -- IT CAN NOW BE     */
/*               MONITORED AGAIN.                                */
/*******************************************************************/
             PGM

/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Print Options                                                   */

/* Function Specific                                               */
             DCL        VAR(&DTAARA) TYPE(*CHAR) LEN(26)
             DCL        VAR(&JOB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&NBR) TYPE(*CHAR) LEN(6)

/*-----------------------------------------------------------------*/
/*                    PROGRAM VARIABLES                            */
/*-----------------------------------------------------------------*/
             DCL        VAR(&FINI) TYPE(*CHAR) LEN(10)

/*-----------------------------------------------------------------*/
/*                     INITIALIZATION                              */
/*-----------------------------------------------------------------*/

             RTVDTAARA  DTAARA(HPELIVESCL) RTNVAR(&DTAARA)
             CHGVAR     VAR(&JOB) VALUE(%SST(&DTAARA 1 10))
             CHGVAR     VAR(&USER) VALUE(%SST(&DTAARA 11 10))
             CHGVAR     VAR(&NBR) VALUE(%SST(&DTAARA 21 6))

/*-----------------------------------------------------------------*/
/*                           MAIN                                  */
/*-----------------------------------------------------------------*/
LOOP:
             ENDJOB     JOB(&NBR/&USER/&JOB) OPTION(*IMMED)
             MONMSG     MSGID(CPF1321) EXEC(GOTO CMDLBL(ENDPGM))
             RTVJOBSTS  JOB(&NBR/&USER/&JOB) RTNSTATUS(&FINI)
             IF         COND(&FINI *EQ '*OUTQ') THEN(GOTO +
                          CMDLBL(ENDPGM))
    /*       MONMSG     MSGID(CPF1361) EXEC(GOTO CMDLBL(ENDPGM))   +
             MONMSG     MSGID(CPF1362) EXEC(GOTO CMDLBL(ENDPGM))   */
             DLYJOB     DLY(5)
             GOTO LOOP

 ENDPGM:
             SNDMSG     MSG('Truck Scale Device has ended.') +
                          TOUSR(*REQUESTER)
             ENDPGM
