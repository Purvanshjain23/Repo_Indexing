     H/TITLE EDT Claim Products    EF  Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
     H* - Program functions in two modes : *ADD and *CHANGE
     H* - Multiple new records may be added by changing to add mode
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/11/21  Time  : 14:53:33
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPK4EFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Claim Products    EF  Edit file
      *
     FPDMOCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : A/R Claim Product         Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FPPAUREL1IF  E           K        DISK
      * RTV : A/R Claim Department Rsn  Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPCXREL1IF  E           K        DISK
      * RTV : OP Reason Codes           Retrieval index
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FPPATREL1IF  E           K        DISK
      * RTV : A/R Claim Department      Retrieval index
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDMOCPL0UF  E           K        DISK                      A
      * UPD : A/R Claim Product         Update index
      *
     E                    #L7         7  1
     E                    #L3         3  1
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 031  5 0A
     E                    W0END   7 031  5 0A
     E                    W0NAM   7 031 10
      * Long constants
     E                    @CN#    1  13  6   @CN    25
     I@BGWKZL
      * Order Detail              Co/Order/Item
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPDMOCPL0
      * UPD : A/R Claim Product         Update index
      * Current/previous master file format fields for change control
      *
      * Outward parameters
     IPARC        DS                            510
      * RCD : A/R Claim                 Retrieval index
      * I :  Claim Number
     I                                    P   1   40PAC0C7
      * B :  Claim Type
     I                                       52  53 PACHSX
      * B :  Claim Amount
     I                                    P  55  602PAAYVL
      * B :  Claim Net Loss
     I                                    P  61  662PAAZVL
      *
      * Outward parameters
     IPBRC        DS                             18
      * KEY : Order Detail              ShpTo/Co/Ord/Item
      * I : RST Ship To Customer
     I                                    P   1   40PBBKC7
      * I : RST Company Number
     I                                    P   5   60PBAIC3
      * I :  Order Number
     I                                    P   7  100PBC4NB
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYARDCS      DS                            186
      * Outward parameters
     IPCRC        DS                              6
      * KEY : A/R Claim Product         Retrieval index
      * I :  Claim Number
     I                                    P   1   40PCC0C7
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Claim Product
      * I : RST Claim Number
     I                                    P   1   40P1C0C7
      * N :  Claim Item Line Number
     I                                    P   5   60P1AFNX
      * N :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * N :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
     IP2PARM      DS
      * FLD: A/R Claim
      * I : MAP Claim Company Number
     I                                    P   1   20P2BIC3
      * I : MAP Claim Order Number
     I                                    P   3   60P2ALNX
      * I : MAP Load ID
     I                                    P   7  100P2RMNB
      * I : MAP Claim Ship to Customer
     I                                    P  11  140P2C3C7
      * I : MAP Claim Customer Name
     I                                       15  44 P2RFTX
      * B :  Claim Type
     I                                       45  46 P2CHSX
      * B :  Claim Amount
     I                                    P  47  522P2AYVL
      * B :  Claim Net Loss
     I                                    P  53  582P2AZVL
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P3AJCD
      * N :  Company Number
     I                                    P   4   50P3AIC3
      * N :  Application Code
     I                                        6  11 P3DNCD
      * N :  Salesperson Code
     I                                       12  14 P3BCCD
      * N :  Allow Multi-Company
     I                                       15  15 P3I6ST
      * N :  Default Printer
     I                                       16  25 P3MPNA
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Change Modes          USR
     I                                        1   1 P4DISX
      * N :  Quantity Shipped Total
     I                                    P   2   72P4CBQT
      * N :  Weight Shipped Total
     I                                    P   8  132P4ATWG
      * N :  Average Weight USR
     I                                    P  14  194P4H0WG
      * N :  Details Remaining USR
     I                                       20  20 P4FESX
     IP5PARM      DS
      * B :  Clm Program USR
     I                                        1   3 P5T6SX
     IP6PARM      DS
      * I :  Accounting Company
     I                                    P   1   20P6BTC3
     IP7PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P7G3TX
      * N :  PRT Printer Device
     I                                       26  35 P7WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P7WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P7WTST
      * N :  PRT Number of Copies
     I                                       44  450P7DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P7WUST
      * N :  PRT Night Queue
     I                                       47  56 P7BVVN
      * N :  System Value Numeric
     I                                    P  57  645P7M8NB
     IP8PARM      DS
      * FLD: *Arrays
      * I :  Claim Audit Selection Usr
     I                                        1   1 P8L9TX
      * I :  Claim Audit Co Value Usr
     I                                        2  11 P8JDAA
      * I :  Approval Claim Audit Eml
     I                                       12  61 P8N9T1
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'ShipToCust N=Claim ShipTo'
      * Claim Ship to Customer
     I                                        1   7 ZA0001
      * Claim Order Number
     I                                        8  14 ZA0002
      * Ship To Customer
     I                                       15  21 ZA0003
      * Message data for 'Company/Item are Req.'
      * Claim Company Number
     I                                        1   3 ZA0004
      * Claim Item Code
     I                                        4  10 ZA0005
      * Message data for 'Company Item           NF'
      * Company Number CDE
     I                                    P   1   20ZA0006
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0007
      * Message data for 'Item type cant be WP'
      * Claim Item Code
     I                                        1   7 ZA0008
      * Message data for 'A/R Claim Department R IN'
      * Claim Department Code USR
     I                                        1   3 ZA0009
      * Reason Code Usr
     I                                        4   6 ZA0010
      * Message data for 'Claim U/M invalid'
      * U/M - Primary Dft
     I                                        1   2 ZA0011
      * Message data for 'Weight,Price,Amt must be'
      * Claim Item Weight
     I                                    P   1   62ZA0012
      * Claim Item Unit Price
     I                                    P   7  124ZA0013
      * Claim Item Amount
     I                                    P  13  182ZA0014
      * Message data for 'Qty,Price,Amt must be'
      * Claim Item Quantity
     I                                    P   1   62ZA0015
      * Claim Item Unit Price
     I                                    P   7  124ZA0016
      * Claim Item Amount
     I                                    P  13  182ZA0017
      * Message data for 'Weight,Price,Amt must be'
      * Claim Item Weight
     I                                    P   1   62ZA0018
      * Claim Item Unit Price
     I                                    P   7  124ZA0019
      * Claim Item Amount
     I                                    P  13  182ZA0020
      * Message data for 'Order Number must be ente'
      * Order Number
     I                                        1   7 ZA0021
      * Message data for 'Tf Exempt -err'
      * Item TF Exempt Code
     I                                        1   2 ZA0022
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'ShipToCust N=Claim ShipTo'
      * Claim Ship to Customer
     I                                        1   7 ZA0023
      * Claim Order Number
     I                                        8  14 ZA0024
      * Ship To Customer
     I                                       15  21 ZA0025
      * Message data for 'Company/Item are Req.'
      * Claim Company Number
     I                                        1   3 ZA0026
      * Claim Item Code
     I                                        4  10 ZA0027
      * Message data for 'Company Item           NF'
      * Company Number CDE
     I                                    P   1   20ZA0028
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0029
      * Message data for 'Item type cant be WP'
      * Claim Item Code
     I                                        1   7 ZA0030
      * Message data for 'Claim U/M invalid'
      * U/M - Primary Dft
     I                                        1   2 ZA0031
      * Message data for 'Weight,Price,Amt must be'
      * Claim Item Weight
     I                                    P   1   62ZA0032
      * Claim Item Unit Price
     I                                    P   7  124ZA0033
      * Claim Item Amount
     I                                    P  13  182ZA0034
      * Message data for 'Qty,Price,Amt must be'
      * Claim Item Quantity
     I                                    P   1   62ZA0035
      * Claim Item Unit Price
     I                                    P   7  124ZA0036
      * Claim Item Amount
     I                                    P  13  182ZA0037
      * Message data for 'Qty,Price,Amt must be'
      * Claim Item Quantity
     I                                    P   1   62ZA0038
      * Claim Item Unit Price
     I                                    P   7  124ZA0039
      * Claim Item Amount
     I                                    P  13  182ZA0040
      * Message data for 'Qty,Price,Amt must be'
      * Claim Item Quantity
     I                                    P   1   62ZA0041
      * Claim Item Unit Price
     I                                    P   7  124ZA0042
      * Claim Item Amount
     I                                    P  13  182ZA0043
      * Message data for 'Weight,Price,Amt must be'
      * Claim Item Weight
     I                                    P   1   62ZA0044
      * Claim Item Unit Price
     I                                    P   7  124ZA0045
      * Claim Item Amount
     I                                    P  13  182ZA0046
      * Message data for 'Pounds is Required'
      * Weight Ordered
     I                                    P   1   62ZA0047
      * Message data for 'A/R Claim Department R IN'
      * Claim Department Code USR
     I                                        1   3 ZA0048
      * Reason Code Usr
     I                                        4   6 ZA0049
      * Message data for 'Reason Code must match'
      * Reason Code
     I                                        1   3 ZA0050
      * Message data for 'Order Number must be ente'
      * Order Number
     I                                        1   7 ZA0051
      * Message data for 'Tf Exempt -err'
      * Item TF Exempt Code
     I                                        1   2 ZA0052
      * Message data for 'Ord AcctCo N= Rcd AcctCo'
      * Claim Company Number
     I                                        1   3 ZA0053
      * Claim Order Number
     I                                        4  10 ZA0054
      * Accounting Company
     I                                       11  13 ZA0055
      * Order Number
     I                                       14  20 ZA0056
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0057
      * Application Code
     I                                       11  16 ZA0058
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0059
      * Application Code
     I                                       11  16 ZA0060
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C0C7    PARM           WP0001  70       Claim Number
     C           P2BIC3    PARM           WP0002  30       Claim Company N
     C           P2ALNX    PARM           WP0003  70       Claim Order Num
     C           P2RMNB    PARM           WP0004  70       Load ID
     C           P2C3C7    PARM           WP0005  70       Claim Ship to C
     C           P2RFTX    PARM           WP0006 30        Claim Customer
     C           P2CHSX    PARM P2CHSX    WP0007  2        Claim Type
     C           P2AYVL    PARM P2AYVL    WP0008 112       Claim Amount
     C           P2AZVL    PARM P2AZVL    WP0009 112       Claim Net Loss
     C           P5T6SX    PARM P5T6SX    WP0010  3        Clm Program USR
     C           P6BTC3    PARM           WP0011  30       Accounting Comp
     C           P8L9TX    PARM           WP0012  1        Claim Audit Sel
     C           P8JDAA    PARM           WP0013 10        Claim Audit Co
     C           P8N9T1    PARM           WP0014 50        Approval Claim
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * CASE: PGM.*Program mode is *ADD
     C           W0PMD     IFEQ 'ADD'                      *IF
      * RTV Last Prod Line No  RT - A/R Claim Product  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
     C                     MOVEL*BLANK    WUCQCD           Reason Code
     C                     END                             *FI
      * EDT Calc Claim Amts    XF - A/R Claim  * 
     C                     CLEARPARC
     C                     Z-ADD#2C0C7    PAC0C7           Claim Number
     C                     MOVELP2CHSX    PACHSX    P      Claim Type
     C                     Z-ADD#CAYVL    PAAYVL           Claim Amount
     C                     Z-ADDP2AZVL    PAAZVL           Claim Net Loss
      *
     C                     CALL 'PPOCXFR'              90  EDT Calc Claim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: A/R Claim
      *
     C                     MOVELPACHSX    P2CHSX           Claim Type
     C                     Z-ADDPAAYVL    #CAYVL           Claim Amount
     C                     Z-ADDPAAZVL    P2AZVL           Claim Net Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPOCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDP2BIC3    #PBIC3           Claim Company N
     C                     Z-ADDP2C3C7    #PC3C7           Claim Ship to C
     C                     MOVELP2RFTX    #PRFTX           Claim Customer
      * E3387 JJH 09/09/14 - Output Shipping Method from Order Header TRG
      * RTV ShipCust,BiilTpTF RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2BIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CSQTX    P      Name
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #CQ2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
     C                     END
      *................................................................
      * If CHANGE mode, then position file:
     C           W0PMD     IFNE 'ADD'
     C           KPOS      KLIST
     C                     KFLD           MOC0C7           Claim Number
     C                     KFLD           MOAFNX           Claim Item Line
      * Setup key
     C                     Z-ADD#2C0C7    MOC0C7
     C                     MOVEL*ZERO     MOAFNX           Claim Item Line
      * 82=EOF
     C           KPOS      SETLL@MOCPWK              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           MOC0C7           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    MOC0C7
     C  N82      KRST      READE@MOCPWK                9182*
     C                     ELSE
     C                     SETOF                     82    *
     C                     END
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page (write empty page if add mode)
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27      W0PMD     IFNE 'ADD'
     C  N82                READP@MOCPWK                  90*
     C  N82                READ @MOCPWK                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  9
     C                     MOVE *ALL'1'   WKIND1  9
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * If CHANGE mode, load subfile fields
     C           W0PMD     IFNE 'ADD'
     C                     EXSR MBFL#1
      * Calculate function fields
     C                     EXSR DG#2FN
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     MOVELMOCQCD    #RG6AA           Reason Code Usr
      * E4057 JJH 04/09/15 - Revised Department Code procesing
     C                     MOVELMOFUAA    #RTPAA           Claim Departmen
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     END                             *FI
      * E4057 JJH 04/09/15 - Revised Reason Code procesing
      * If DP or PS Reason is used, they all must be the same reason code
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.Reason Code Usr is Deviated Pricing Adj
      *   |- c2    : RCD.Reason Code Usr is Profit Sharing Adj
      *   '-
     C           #RG6AA    IFEQ 'DP'                       *IF
     C           #RG6AA    OREQ 'PS'                       *OR
      * CASE: WRK.Status Flag 1  Y/N is No
     C           WUQ1ST    IFEQ 'N'                        *IF
      * E4057 JJH 04/09/15 - Revised Reason  Code procesing
     C                     MOVEL#RG6AA    WUCQCD           Reason Code
     C                     MOVEL'Y'       WUQ1ST           Status Flag 1
     C                     END                             *FI
     C                     END                             *FI
      * Val existing recd that could have missing uom because crt elsewhe
     C                     EXSR UASUBR                     Val existing re
      * OVERRIDE: Claim Responsibility
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : RCD.Clm Item TF Exempt Code is Exempt Customer
      *   |- c2    : RCD.Clm Item TF Exempt Code is Exempt Product
      *   |- c3    : RCD.Clm Item TF Exempt Code is Pre Commencement
      *   |- c4    : PAR.Accounting Company is Seaboard Triumph Foods
      *   '-
     C           #1Q0SX    IFEQ 'EC'                       *IF
     C           #1Q0SX    OREQ 'EP'                       *OR
     C           #1Q0SX    OREQ 'PC'                       *OR
     C           P6BTC3    OREQ 440                        *OR
      * RMC 11/11/2021 Missed this change below:  its in the CRTOBJ  -->
      * RMC            : Change to check ACCTNG CO = STF 11/16/18 S13578
     C                     MOVEL'C'       #1TNSX           Claim Responsib
     C                     ELSE
      * CASE: *OTHERWISE
      * Affect Sales Pounds = Y
      * CASE: RCD.Affect Sales Pnds Status is yes
     C           #1VAST    IFEQ 'Y'                        *IF
     C                     MOVEL'C'       #1TNSX           Claim Responsib
     C                     END                             *FI
      * TFS037:  If the Item is Co-Owned, the responsibility is always
      *          Shared.
      * Item Co-Ownership = S or T
      * CASE: RCD.TF Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
     C                     MOVEL'S'       #1TNSX           Claim Responsib
     C                     END                             *FI
     C                     END                             *FI
      * Set Cursor to Claim Department Code USR
      * CASE: LCL.First Time Flag is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * *Set Cursor: RCD.Claim Department Code USR  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  014       W0ROW0
     C                     Z-ADD035       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'N'       YL0006           First Time Flag
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
     C                     ELSE
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile record (new record)
     C                     Z-ADDP2BIC3    #1BIC3           Claim Company N
     C                     Z-ADD*ZERO     #1ALNX           Claim Order Num
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     ADD  1         P1AFNX           Claim Item Line
     C                     Z-ADDP1AFNX    #1AFNX           Claim Item Line
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     MOVEL*BLANK    #RG6AA           Reason Code Usr
      * E4057 JJH 04/09/15 - Revised Claim Department Code procesing
     C                     MOVEL*BLANK    #RTPAA           Claim Departmen
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1FUAA           Claim Departmen
     C                     MOVEL*BLANK    #RG6AA           Reason Code Usr
      * slm 8/22/2006
      * This should not be of any value so * out the user
      * has not entered any values for the pull down
     C                     END
     C                     END
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
     C           W0PMD     IFNE 'ADD'
      * 82=EOF
     C           KRST      READE@MOCPWK                  82*
     C                     END
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2BIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CSQTX    P      Name
      * E3387 JJH 09/10/14 - Display Shipping Method
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
      * ACR Shipping Method DRV
      * PAR.ACR Shipping Method DRV = Condition name of PAR.ACR Shipping
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #CQ2CD    W0INVL 25        ACR Shipping Me
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CDGU1    PARM           W0CNNM 25        ACR Shipping Me
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
     C                     MOVEL'N'       P4DISX           Change Modes
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      * Switch between *ADD/*CHANGE modes
     C   09                EXSR FACHMD
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * F10=Select Items from Order.
     C                     EXSR UQSUBR                     F10=Select Item
     C                     END                             *FI
      * F8=NEXT
      * CASE: CTL.*CMD key is SUBMIT/NEXT
     C           *IN08     IFEQ '1'                        *IF
     C                     MOVEL'ECC'     P5T6SX           Clm Program USR
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F7=BACK
      * CASE: CTL.*CMD key is BACK
     C           *IN07     IFEQ '1'                        *IF
     C                     MOVEL'ECL'     P5T6SX           Clm Program USR
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * No SFLNXTCHG
     C                     SETOF                     84
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           W0PMD     IFEQ 'ADD'
      * Check for null record
     C                     EXSR DDNLRC
     C           W0NLR     IFEQ 'Y'
     C           ##RR      ANDNEYPMRRN
      * Clear all record fields
     C                     EXSR MAIZ#1
     C                     GOTO DCEXIT
     C                     END
      * If not null record, continue
     C                     END
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * If delete request, bypass validation
     C           #1SEL     IFEQ '4'
     C                     GOTO DCEXIT
     C                     END
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DDNLRC    BEGSR
      *================================================================
      * Check for null record
      *================================================================
     C                     MOVEL'N'       W0NLR   1
     C           V1ALNX    CABNE*BLANK    DDEXIT           Claim Order Num
     C           V1C1C7    CABNE*BLANK    DDEXIT           Claim Item Code
     C           #RTPAA    CABNE*BLANK    DDEXIT           Claim Departmen
     C           #RG6AA    CABNE*BLANK    DDEXIT           Reason Code Usr
     C           #1KUQT    CABNE*ZERO     DDEXIT           Claim Item Quan
     C           #1HHWG    CABNE*ZERO     DDEXIT           Claim Item Weig
     C           #1DIPR    CABNE*ZERO     DDEXIT           Claim Item Unit
     C           #1BNVL    CABNE*ZERO     DDEXIT           Claim Item Amou
     C                     MOVEL'Y'       W0NLR
      *================================================================
     CSR         DDEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate Claim Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1ALNX    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD*ZERO     #1ALNX           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1ALNX           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Claim Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C1C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD*ZERO     #1C1C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C1C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * RTV Load ID            RT - Order Header TRG  * 
     C                     EXSR SMRVGN
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.*SFLSEL is *Delete#1
      *   |- c2    : RCD.*SFLSEL is *Delete#2
      *   '-
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'                       *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * IF not F10, THEN continue validations.
     C                     EXSR URSUBR                     IF not F10, THE
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      * Claim Department Code USR required
     C           #RTPAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9834  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to OP Reason Codes
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to A/R Claim Department
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Calculate function fields
     C                     EXSR DG#2FN
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * Rtv Claim Department   RT - A/R Claim Department  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1FUAA    WL0053    P      Claim Departmen
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YN0008    P      Claim Departmen
     C                     MOVELWL0055    #1TNSX    P      Claim Responsib
     C                     MOVELWL0056    YN0009    P      Record Status
      * OVERRIDE: Claim Responsibility
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : RCD.Clm Item TF Exempt Code is Exempt Customer
      *   |- c2    : RCD.Clm Item TF Exempt Code is Exempt Product
      *   |- c3    : RCD.Clm Item TF Exempt Code is Pre Commencement
      *   |- c4    : PAR.Accounting Company is Seaboard Triumph Foods
      *   '-
     C           #1Q0SX    IFEQ 'EC'                       *IF
     C           #1Q0SX    OREQ 'EP'                       *OR
     C           #1Q0SX    OREQ 'PC'                       *OR
     C           P6BTC3    OREQ 440                        *OR
      * RMC 11/11/2021 Missed this change above to hchk accounting co for
     C                     MOVEL'C'       #1TNSX           Claim Responsib
     C                     ELSE
      * CASE: *OTHERWISE
      * Affect Sales Pounds = Y, the Company
      * CASE: RCD.Affect Sales Pnds Status is yes
     C           #1VAST    IFEQ 'Y'                        *IF
     C                     MOVEL'C'       #1TNSX           Claim Responsib
     C                     END                             *FI
      * TFS037:  If the Item is Co-Owned, the responsibility is always
      *          Shared.
      * Item Co-Ownership = S or T, then Shared
      * CASE: RCD.TF Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
     C                     MOVEL'S'       #1TNSX           Claim Responsib
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DG#2FN    BEGSR
      *================================================================
      * Calculate subfile record function fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
      * SELRCD for Claim Order Number
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Cursor field <IS> RCD.Claim Order Number
      *   |- c2    : CTL.*CMD key is CF04
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V1ALNX'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Order/Load Id/Invo SR - Order Header TRG  * 
     C                     CALL 'PBBHSRR'              90  SEL Order/Load
     C                     PARM *BLANK    W0RTN   7
     C           P3AIC3    PARM P3AIC3    WQ0020  30       Company Number
     C           #1ALNX    PARM #1ALNX    WQ0021  70       Order Number
     C           YL0009    PARM YL0009    WQ0022 15        Customer Purcha
     C           #1RMNB    PARM #1RMNB    WQ0023  70       Load ID
     C           #CQ2CD    PARM #CQ2CD    WQ0024  2        Shipping Method
     C           YL0010    PARM YL0010    WQ0025  70       Invoice Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     END                             *FI
      * E4057 JJH 04/09/15 - New SELRCD for Claim Department and Reason
      * SELRCD for Claim Department and Reason
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : PGM.*Cursor field <IS> RCD.Claim Department Code USR
      *   |- c2    : CTL.*CMD key is CF04
      *   |- c3    : PGM.*Cursor field <IS> RCD.Reason Code Usr
      *   |- c4    : CTL.*CMD key is CF04
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RTPAA'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RG6AA'                   *IF
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel A/R Claim Dpt/Rsn  SR - A/R Claim Reason  * 
     C                     CALL 'PBQVSRR'              90  Sel A/R Claim D
     C                     PARM *BLANK    W0RTN   7
     C           #RTPAA    PARM #RTPAA    WQ0026  3        Claim Departmen
     C           #RG6AA    PARM #RG6AA    WQ0027  3        Reason Code
     C           #1ANST    PARM *BLANK    WQ0028  1        Affect Sales Do
     C           #1VAST    PARM *BLANK    WQ0029  1        Affect Sales Pn
     C           #1QZSX    PARM *BLANK    WQ0030  1        Require CM Appr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBQVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983435*
     C                     END
     C                     MOVEL#RTPAA    #1FUAA           Claim Departmen
     C                     MOVEL#RG6AA    #1CQCD           Reason Code
     C                     END                             *FI
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 9/24/2007 slm placed in a wrapper on the extended amount
      * Calculate Extended Amount
     C                     EXSR NJSUBR                     Calculate Exten
     C                     END
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'Y'       W0RSF
     C                     ELSE
     C                     MOVEL'N'       W0RSF
     C                     END
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
     C           W0PMD     IFEQ 'ADD'
      * Process add request
     C           #1SEL     IFNE '4'
     C                     EXSR DDNLRC
     C           W0NLR     IFNE 'Y'
     C                     EXSR ECADRQ
     C                     END
     C                     END
     C                     ELSE
     C           #1SEL     IFEQ '4'
      * Process delete request
     C                     EXSR EDDLRQ
     C                     ELSE
      * Process change request
     C                     EXSR EECHRQ
     C                     END
     C                     END
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
     C                     MOVEL'Y'       P4DISX           Change Modes
      * EDT Calc Claim Amts    XF - A/R Claim  * 
     C                     CLEARPARC
     C                     Z-ADD#1C0C7    PAC0C7           Claim Number
     C                     MOVELP2CHSX    PACHSX    P      Claim Type
     C                     Z-ADDP2AYVL    PAAYVL           Claim Amount
     C                     Z-ADDP2AZVL    PAAZVL           Claim Net Loss
      *
     C                     CALL 'PPOCXFR'              90  EDT Calc Claim
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: A/R Claim
      *
     C                     MOVELPACHSX    P2CHSX           Claim Type
     C                     Z-ADDPAAYVL    P2AYVL           Claim Amount
     C                     Z-ADDPAAZVL    P2AZVL           Claim Net Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPOCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADDP2AYVL    #CAYVL           Claim Amount
     C                     MOVEL#1CQCD    #RG6AA           Reason Code Usr
      * E4057 JJH 04/09/15 - Revised Department Code procesing
     C                     MOVEL#1FUAA    #RTPAA           Claim Departmen
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT A/R Claim ProductSACR - A/R Claim Product  * 
     C                     EXSR SSCRRC
     C           W0RTN     IFNE *BLANK
      * Write error detected
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
     C                     ELSE
      * DBF write successful
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * DLT A/R Claim ProductSADL - A/R Claim Product  * 
     C                     EXSR STDLRC
     C           W0RTN     IFNE *BLANK
      * Delete unsuccessful
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * If record altered, reset subfile record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF delete successful
      * Blank out record and protect from entry
     C                     EXSR MAIZ#1
      * disable entry
     C                     SETON                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
      * Reload subfile
     C                     MOVEL'Y'       W0RSF   1
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG A/R Claim ProductSACH - A/R Claim Product  * 
     C                     EXSR SUCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C                     MOVEL'ADD'     W0PMD
     C                     ELSE
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     EXSR FBRQRL
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
     C                     MOVEL'0'       *IN79
     C           ##USR     IFEQ @CN,008                    *IF
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1C0C7    #1C0C7           Claim Number
     C                     Z-ADD*ZERO     #1AFNX           Claim Item Line
     C                     Z-ADDP2BIC3    #1BIC3           Claim Company N
     C                     MOVEL*BLANK    #RP3ST           TF Co-Ownership
     C                     MOVEL*BLANK    #1FUAA           Claim Departmen
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1CISX           Responsible Dep
     C                     MOVEL*BLANK    #REZAA           Department Code
     C                     MOVEL*BLANK    #1AMST           Affect Inventor
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     MOVEL*BLANK    #1F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #1F1SX           Affect Commissi
     C                     MOVEL*BLANK    #1F2SX           Affect Pricing
     C                     Z-ADD*ZERO     #1FXPR           Inventory Value
     C                     Z-ADD*ZERO     #1YTNX           Claim Memo Numb
     C                     MOVEL*BLANK    #1QYSX           Claim Product R
     C                     MOVEL*BLANK    #1UCSX           CP Unused Sts 4
     C                     MOVEL*BLANK    #1UDSX           CP Unused Sts 5
     C                     MOVEL*BLANK    #1UESX           CP Unused Sts 6
     C                     Z-ADD*ZERO     #1FYPR           CP Unused Price
     C                     Z-ADD*ZERO     #1FZPR           CP Unused Price
     C                     Z-ADD*ZERO     #1F0PR           CP Unused Price
     C                     Z-ADD*ZERO     #1F1PR           CP Unused Price
     C                     Z-ADD*ZERO     #1F2PR           CP Unused Price
     C                     Z-ADD*ZERO     #1EUVL           CP Unused Value
     C                     Z-ADD*ZERO     #1EVVL           CP Unused Value
     C                     Z-ADD*ZERO     #1EWVL           CP Unused Value
     C                     Z-ADD*ZERO     #1EXVL           CP Unused Value
     C                     Z-ADD*ZERO     #1EYVL           CP Unused Value
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1MJDT           Create Date
     C                     Z-ADD*ZERO     #1BETM           Create Time
     C                     MOVEL*BLANK    #1CCVN           Create User
     C                     MOVEL*BLANK    #1CDVN           Create Program
     C                     Z-ADD*ZERO     #1MKDT           Change Date
     C                     Z-ADD*ZERO     #1BFTM           Change Time
     C                     MOVEL*BLANK    #1CEVN           Change User
     C                     MOVEL*BLANK    #1CFVN           Change Program
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADDP2ALNX    #1ALNX           Claim Order Num
      * Clear external version also
     C                     MOVEL*BLANK    V1ALNX
     C                     Z-ADDP2RMNB    #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1C1C7           Claim Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1C1C7
     C                     MOVEL*BLANK    #1N0CD           Item Type Code
     C                     MOVEL*BLANK    #RTPAA           Claim Departmen
     C                     MOVEL*BLANK    #RG6AA           Reason Code Usr
     C                     MOVEL*BLANK    #1TNSX           Claim Responsib
     C                     MOVEL*BLANK    #1QZSX           CP Require CM A
     C                     Z-ADD*ZERO     #1KUQT           Claim Item Quan
     C                     MOVEL*BLANK    #1VAST           Affect Sales Pn
     C                     Z-ADD*ZERO     #1HHWG           Claim Item Weig
     C                     MOVEL*BLANK    #1ANST           Affect Sales Do
     C                     Z-ADD*ZERO     #1DIPR           Claim Item Unit
     C                     MOVEL*BLANK    #1HHCD           U/M - Primary D
     C                     Z-ADD*ZERO     #1BNVL           Claim Item Amou
     C                     MOVEL*BLANK    #1Q0SX           Clm Item TF Exe
     C                     MOVEL*BLANK    #RXUSX           Cst TF Exempt C
     C                     MOVEL*BLANK    #RXVSX           Itm TF Exempt C
     C                     MOVEL*BLANK    #RXWSX           Ord TF Exempt C
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @MOCPWK fields to subfile
      *================================================================
     C                     Z-ADDMOC0C7    #1C0C7           Claim Number
     C                     Z-ADDMOAFNX    #1AFNX           Claim Item Line
     C                     Z-ADDMOBIC3    #1BIC3           Claim Company N
     C                     MOVELMOFUAA    #1FUAA           Claim Departmen
     C                     MOVELMOCQCD    #1CQCD           Reason Code
     C                     MOVELMOCISX    #1CISX           Responsible Dep
     C                     MOVELMOAMST    #1AMST           Affect Inventor
     C                     Z-ADDMODPNB    #1DPNB           Order Sequence
     C                     Z-ADDMOUENB    #1UENB           Order Secondary
     C                     MOVELMOF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELMOF1SX    #1F1SX           Affect Commissi
     C                     MOVELMOF2SX    #1F2SX           Affect Pricing
     C                     Z-ADDMOFXPR    #1FXPR           Inventory Value
     C                     Z-ADDMOYTNX    #1YTNX           Claim Memo Numb
     C                     MOVELMOQYSX    #1QYSX           Claim Product R
     C                     MOVELMOUCSX    #1UCSX           CP Unused Sts 4
     C                     MOVELMOUDSX    #1UDSX           CP Unused Sts 5
     C                     MOVELMOUESX    #1UESX           CP Unused Sts 6
     C                     Z-ADDMOFYPR    #1FYPR           CP Unused Price
     C                     Z-ADDMOFZPR    #1FZPR           CP Unused Price
     C                     Z-ADDMOF0PR    #1F0PR           CP Unused Price
     C                     Z-ADDMOF1PR    #1F1PR           CP Unused Price
     C                     Z-ADDMOF2PR    #1F2PR           CP Unused Price
     C                     Z-ADDMOEUVL    #1EUVL           CP Unused Value
     C                     Z-ADDMOEVVL    #1EVVL           CP Unused Value
     C                     Z-ADDMOEWVL    #1EWVL           CP Unused Value
     C                     Z-ADDMOEXVL    #1EXVL           CP Unused Value
     C                     Z-ADDMOEYVL    #1EYVL           CP Unused Value
     C                     MOVELMOVSST    #1VSST           Record Status
     C                     Z-ADDMOMJDT    #1MJDT           Create Date
     C                     Z-ADDMOBETM    #1BETM           Create Time
     C                     MOVELMOCCVN    #1CCVN           Create User
     C                     MOVELMOCDVN    #1CDVN           Create Program
     C                     Z-ADDMOMKDT    #1MKDT           Change Date
     C                     Z-ADDMOBFTM    #1BFTM           Change Time
     C                     MOVELMOCEVN    #1CEVN           Change User
     C                     MOVELMOCFVN    #1CFVN           Change Program
     C                     Z-ADDMOALNX    #1ALNX           Claim Order Num
     C                     Z-ADDMORMNB    #1RMNB           Load ID
     C                     Z-ADDMOC1C7    #1C1C7           Claim Item Code
     C                     MOVELMON0CD    #1N0CD           Item Type Code
     C                     MOVELMOTNSX    #1TNSX           Claim Responsib
     C                     MOVELMOQZSX    #1QZSX           CP Require CM A
     C                     Z-ADDMOKUQT    #1KUQT           Claim Item Quan
     C                     MOVELMOVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDMOHHWG    #1HHWG           Claim Item Weig
     C                     MOVELMOANST    #1ANST           Affect Sales Do
     C                     Z-ADDMODIPR    #1DIPR           Claim Item Unit
     C                     MOVELMOHHCD    #1HHCD           U/M - Primary D
     C                     Z-ADDMOBNVL    #1BNVL           Claim Item Amou
     C                     MOVELMOQ0SX    #1Q0SX           Clm Item TF Exe
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP2BIC3    #PBIC3           Claim Company N
      * Clear external version also
     C                     MOVEL*BLANK    VPBIC3
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
     C                     Z-ADDP1C0C7    #2C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C0C7
     C                     Z-ADD*ZERO     #CAYVL           Claim Amount
     C                     Z-ADDP2ALNX    #PALNX           Claim Order Num
      * Clear external version also
     C                     MOVEL*BLANK    VPALNX
     C                     Z-ADDP2RMNB    #PRMNB           Load ID
     C                     Z-ADDP2C3C7    #PC3C7           Claim Ship to C
      * Clear external version also
     C                     MOVEL*BLANK    VPC3C7
     C                     MOVELP2RFTX    #PRFTX           Claim Customer
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     MOVEL*BLANK    #CDGU1           ACR Shipping Me
      * Check restriction within
     C                     EXSR VDCKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1ALNX           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1ALNX           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C1C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C1C7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #PBIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#PBIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VPBIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPBIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPALNX           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPALNX           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Ship to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PC3C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PC3C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VPC3C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VPC3C7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Calculate the average weight for "order" item.
      *================================================================
      * *** Get shipped weight and quantity from order detail. ***
      * RTV Qty/Weight Shipped RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0034           Company Number
     C                     Z-ADDP2ALNX    WL0035           Order Number
     C                     Z-ADD#1DPNB    WL0036           Order Sequence
     C                     Z-ADD#1UENB    WL0037           Order Secondary
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    P4CBQT           Quantity Shippe
     C                     Z-ADDWL0039    P4ATWG           Weight Shipped
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Quantity Shipped Total is not equal zero
      *   |- c3    : PAR.Weight Shipped Total is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           P4CBQT    IFNE *ZERO                      *IF
     C           P4ATWG    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *** Calculate the average weight of each item on order detail. **
     C           P4ATWG    DIV  P4CBQT    P4H0WG    H      Average Weight
      * *** Calculate the total weight for item on claim. ***
     C           #1KUQT    MULT P4H0WG    #1HHWG    H      Claim Item Weig
      * CASE: RCD.U/M - Primary Dft is Head Set
     C           #1HHCD    IFEQ 'HS'                       *IF
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Validate required fields.
      *================================================================
      * CASE: RCD.U/M - Primary Dft is Pounds
     C           #1HHCD    IFEQ 'LB'                       *IF
      * Pounds required fields.
     C                     EXSR NCSUBR                     Pounds required
     C                     ELSE
      * CASE: RCD.U/M - Primary Dft is Head Set
     C           #1HHCD    IFEQ 'HS'                       *IF
      * Head Set required fields.
     C                     EXSR NDSUBR                     Head Set requir
     C                     ELSE
      * CASE: RCD.U/M - Primary Dft is Cases
     C           #1HHCD    IFEQ 'CS'                       *IF
      * Cases required fields.
     C                     EXSR NESUBR                     Cases required
     C                     ELSE
      * CASE: RCD.U/M - Primary Dft is Each
     C           #1HHCD    IFEQ 'EA'                       *IF
      * Each required fields.
     C                     EXSR NFSUBR                     Each required f
     C                     ELSE
      * CASE: *OTHERWISE
      * All other unit of measure required fields.
     C                     EXSR NGSUBR                     All other unit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCSUBR    BEGSR
      *================================================================
      * Pounds required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HHWG    ZA0032           Claim Item Weig
     C                     Z-ADD#1DIPR    ZA0033           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0034           Claim Item Amou
      * Send message 'Weight,Price,Amt must be'
     C                     MOVEL'USR2779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983738*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDSUBR    BEGSR
      *================================================================
      * Head Set required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Quantity is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1KUQT    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1KUQT    ZA0035           Claim Item Quan
     C                     Z-ADD#1DIPR    ZA0036           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0037           Claim Item Amou
      * Send message 'Qty,Price,Amt must be'
     C                     MOVEL'USR2899' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983638*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NESUBR    BEGSR
      *================================================================
      * Cases required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Quantity is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1KUQT    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1KUQT    ZA0038           Claim Item Quan
     C                     Z-ADD#1DIPR    ZA0039           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0040           Claim Item Amou
      * Send message 'Qty,Price,Amt must be'
     C                     MOVEL'USR2899' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983638*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFSUBR    BEGSR
      *================================================================
      * Each required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Quantity is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1KUQT    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1KUQT    ZA0041           Claim Item Quan
     C                     Z-ADD#1DIPR    ZA0042           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0043           Claim Item Amou
      * Send message 'Qty,Price,Amt must be'
     C                     MOVEL'USR2899' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983638*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGSUBR    BEGSR
      *================================================================
      * All other unit of measure required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HHWG    ZA0044           Claim Item Weig
     C                     Z-ADD#1DIPR    ZA0045           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0046           Claim Item Amou
      * Send message 'Weight,Price,Amt must be'
     C                     MOVEL'USR2779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983738*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHSUBR    BEGSR
      *================================================================
      * Validate Department and Reason code
      *================================================================
      * Reason & department must be found in the A/R Claim Reason
      * Vry A/R Claim Dept/Rsn RT - A/R Claim Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTPAA    WL0024    P      Claim Departmen
     C                     MOVEL#RG6AA    WL0025    P      Reason Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0005    P      Valid Item Type
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Send message 'A/R Claim Department R NF'
     C                     MOVEL'USR3423' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
      * E4057 JJH 10/13/15 - Do not allow Inactive Department/Reason
     C                     ELSE
      * CASE: PGM.*Return code is *Record is inactive
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
     C                     MOVEL#RTPAA    ZA0048           Claim Departmen
     C                     MOVEL#RG6AA    ZA0049           Reason Code Usr
      * Send message 'A/R Claim Department R IN'
     C                     MOVEL'USR4856' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983435*
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NISUBR    BEGSR
      *================================================================
      * Move TF Exempt Code and Validate TF Exempt Code
      *================================================================
      * CASE: LCL.ORG TF Exempt Cde Usr is Pre Commencement
     C           YL0003    IFEQ 'PC'                       *IF
      * If the TF from the ORG ORDER IS A PC then all records will be a p
     C                     MOVELYL0003    #RXWSX           Ord TF Exempt C
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Ord TF Exempt Cde Usr EQ WRK.BLANK
      *   |- c2    : RCD.Itm TF Exempt Cde Usr is Exempt Product
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RXWSX    IFEQ WUGSTX                     *IF
     C           #RXVSX    IFEQ 'EP'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If the TF from the Order is blank then get the TF from the Item
     C                     MOVEL#RXVSX    #RXWSX           Ord TF Exempt C
     C                     ELSE
      * CASE: RCD.Ord TF Exempt Cde Usr EQ WRK.BLANK
     C           #RXWSX    IFEQ WUGSTX                     *IF
      * If the TF from the Order is blank then get the TF from Order On I
      * Rtv Order TF-Exempt   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0040           Company Number
     C                     Z-ADD#1ALNX    WL0041           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    #RXWSX    P      OH TF Exempt Co
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move the TF from the Order, then if Order not found then move fro
      * the item code.
      * Move the values to the claim product TF EXEMPT
      * CASE: RCD.Ord TF Exempt Cde Usr NE WRK.BLANK
     C           #RXWSX    IFNE WUGSTX                     *IF
     C                     MOVEL#RXWSX    #1Q0SX           Clm Item TF Exe
     C                     ELSE
      * CASE: RCD.Cst TF Exempt Cde Usr is Exempt Customer
     C           #RXUSX    IFEQ 'EC'                       *IF
      * Ord TF is blank and now check the customer, if exempt
      * CASE: RCD.Itm TF Exempt Cde Usr is Exempt Product
     C           #RXVSX    IFEQ 'EP'                       *IF
      * Check the Item
     C                     MOVEL#RXVSX    #1Q0SX           Clm Item TF Exe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#RXUSX    #1Q0SX           Clm Item TF Exe
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.Cst TF Exempt Cde Usr is Not Exempt
     C           #RXUSX    IFEQ 'NE'                       *IF
      * Ord TF is blank and now check the customer, if not exempt
     C                     MOVEL#RXVSX    #1Q0SX           Clm Item TF Exe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate the TF Exempt
      * CASE: RCD.Clm Item TF Exempt Code EQ WRK.BLANK
     C           #1Q0SX    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q0SX    ZA0052           Clm Item TF Exe
      * Send message 'Tf Exempt -err'
     C                     MOVEL'USR3585' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
      * If the claim TF Exempt is blank, then this is a required field.
      * The IS group would have to review this data to know what has
      * happened.
     C                     END                             *FI
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJSUBR    BEGSR
      *================================================================
      * Calculate Extended Amount
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   '-
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
      * If Item Weight or Item price = zero then extend amount will
      * stays as the user entered the total amount.
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           #1BNVL    PARM *ZERO     WQ0031 112       Extended Amount
     C                     PARM #1HHCD    WQ0032  2        U/M - Base Pric
     C                     PARM #1KUQT    WQ0033 112       Quantity Shippe
     C                     PARM #1HHWG    WQ0034 112       Weight Shipped
     C                     PARM #1DIPR    WQ0035 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983936*
     C                     SETON                     3738  *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * 11/11/21 W87162 RMC added to existing rcd section ->chk ACCTNG CO
      * 11/16/18 S13578 RMC Force 440 claims to be Co Resp- for ACCTNG CO
      * 08/10/18 S13578 RMC Force 440 claims to be Company Responsibility
      * 01/09/18 R12011A RMC Force 440 claims to be Company Responsibilit
      * E7293 JJH 09/20/16 - Ship To Customer
      * - Change the access path on the 'VAL Ext Co/Ord/Item ShpRT - Orde
      *   Detail" function to "Co/Order#/Item/Whse Not X OPBGWKLD" so
      *   Cancelled Order Detail lines will be excluded.
      * - This will allow the validation of the Ship To Customer on the
      *   Edit Claim Product function to work properly.
      * E4057 JJH 10/13/15 - Price Credit Memo Fixes
      * - Do not allow Inactive (I) Department/Reason Codes to be entered
      * E4057 JJH 04/06/15 - Price Credit Memo Fixes
      * - Change postion of Reason and Dept on display screen
      * - Affect Sales Pnds Status (Afft Lbs) - Changed to Output
      * - Remove Affect Inventory Status (Afft Inv) from display screen
      * - Add Require Credit Manager Approval (Req CM Apv) field to displ
      * - Deparment Code and Reason changed from Optional to Required
      * - F4=SELRCD calls the PBQVSRR SELRCD which is I/RST by Deparment
      *   and Claim Reason.  Same SELRCD used for Department and Reason.
      * - Default for Affect Flags and Required CM Approval based on
      *   default values in A/R Claim Reason - Department/Reason.
      * - Add GL (Gallon) as a valid UOM.  Required for HPB.
      * 03/26/15  RMC chg HS to not zerout the wt, allow PC= Pieces
      * ** 02/27/2008 LJB E00094
      * ** Prompt to email the claim with text message to St Joe
      * ** only email if "Yes" is selected.
      * slm 8/24/2006 Add the following, open the Aff flg on the Sls Pnds
      *               Only default in from the Reason if blank or changed
      * 9/25/2007 slm Add additional rule on the extended amount
      * 10/09/07  slm Claim Responsibility was using LCL and not RCD
      * 10/11/07  slm Cases was zero out weight reviewed with Purva
      *               and * out this code
      * 11/07/07 slm  Pulled in the logic from the change object
      *               on when to change from company to shared
      *               these changes were not being displayed to the user
      * E3387 JJH 09/09/14 - Display Shipping Method, correct call to
      *  Order Number SELRCD which requires Shipping Method.
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Last Prod Line No  RT - A/R Claim Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Template version identifier - Edit to reflect current version.
      * Template version identifier - Edit to reflect current version.
      * Declare restrictor key work fields
     C           *LIKE     DEFN MOC0C7    WQSA01           Claim Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    WQSA01           Claim Number
      * Establish starting position
     C           KRSSA     SETLL@MOCPWK                    *
     C           KRSSA     READE@MOCPWK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2737' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1AFNX           Claim Item Line
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDMOAFNX    P1AFNX           Claim Item Line
     C           KRSSA     READE@MOCPWK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV ShipCust,BiilTpTF RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEC4NB    WQSB01           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Order Number
      * Setup key
     C                     Z-ADDP2ALNX    WQSB01           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPY2                    *
     C           KRSSB     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     Z-ADD*ZERO     YL0001           Ship To Custome
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     MOVEL*BLANK    YL0002           Billing Activit
     C                     MOVEL*BLANK    YL0003           OH TF Exempt Co
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEAIC3    P3AIC3           Company Number
     C                     Z-ADDBEBKC7    YL0001           Ship To Custome
     C                     MOVELBEQ2CD    #CQ2CD           Shipping Method
     C                     MOVELBEOBST    YL0002           Billing Activit
     C                     MOVELBEFYSX    YL0003           OH TF Exempt Co
     C           KRSSB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * VAL Ext Co/Ord/Item ShpRT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Template version identifier - Edit to reflect current version.
      * Template version identifier - Edit to reflect current version.
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
     C           *LIKE     DEFN OMHGCD    WQSD03           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Item Code
      * Setup key
     C                     Z-ADDWL0003    WQSD01           Company Number
     C                     Z-ADDWL0004    WQSD02           Order Number
     C                     Z-ADDWL0007    WQSD03           Item Code
      * Establish starting position
     C           KRSSD     SETLL@BGWKFW                    *
     C           KRSSD     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Order Sequence
     C                     Z-ADD*ZERO     WL0006           Order Secondary
     C                     Z-ADD*ZERO     WL0008           Ship To Custome
     C                     MOVEL*BLANK    WL0009           Ord TF Exempt C
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDOMDPNB    WL0005           Order Sequence
     C                     Z-ADDOMUENB    WL0006           Order Secondary
     C                     Z-ADDOMBKC7    WL0008           Ship To Custome
     C                     MOVELOMF4SX    WL0009           Ord TF Exempt C
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Ship Cust,Bill Tp RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEC4NB    WQSE01           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Order Number
      * Setup key
     C                     Z-ADDWL0011    WQSE01           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BFCPY2                    *
     C           KRSSE     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0010           Company Number
     C                     Z-ADD*ZERO     WL0012           Ship To Custome
     C                     MOVEL*BLANK    WL0013           Billing Activit
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEAIC3    WL0010           Company Number
     C                     Z-ADDBEBKC7    WL0012           Ship To Custome
     C                     MOVELBEOBST    WL0013           Billing Activit
     C           KRSSE     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Item Type/TF Exemp RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0014    BZAIC3           Company Number
     C                     Z-ADDWL0015    BZHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           Item Type Code
     C                     MOVEL*BLANK    WL0017           TF Co-Ownership
     C                     MOVEL*BLANK    WL0018           Item TF Exempt
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZN0CD    WL0016           Item Type Code
     C                     MOVELBZP3ST    WL0017           TF Co-Ownership
     C                     MOVELBZS9ST    WL0018           Item TF Exempt
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Exist co/ord/item  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Template version identifier - Edit to reflect current version.
      * Template version identifier - Edit to reflect current version.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WAHGCD    WQSG03           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Item Code
      * Setup key
     C                     Z-ADDWL0019    WQSG01           Company Number
     C                     Z-ADDWL0020    WQSG02           Order Number
     C                     Z-ADDWL0023    WQSG03           Item Code
      * Establish starting position
     C           KRSSG     SETLL@BGWKZL                    *
     C           KRSSG     READE@BGWKZL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0021           Order Sequence
     C                     Z-ADD*ZERO     WL0022           Order Secondary
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWADPNB    WL0021           Order Sequence
     C                     Z-ADDWAUENB    WL0022           Order Secondary
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Vry A/R Claim Dept/Rsn RT - A/R Claim Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           AUFUAA           Claim Departmen
     C                     KFLD           AUCQCD           Reason Code
      * Setup key
     C                     MOVELWL0024    AUFUAA           Claim Departmen
     C                     MOVELWL0025    AUCQCD           Reason Code
      * Establish starting position
     C           KRSSH     CHAIN@AUREW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3423' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           AUVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ELSE
      * CASE: DB1.Record Status is Inactive
     C           AUVSST    IFEQ 'I'                        *IF
     C                     MOVEL'USR4855' W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Prc Unit of Meas   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0027    BZAIC3           Company Number
     C                     Z-ADDWL0028    BZHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0029           U/M - Pricing
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAICD    WL0029           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0030    BZAIC3           Company Number
     C                     Z-ADDWL0031    BZHGCD           Item Code
      * Establish starting position
     C           KRSSJ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0032           Unit Weight
     C                     MOVEL*BLANK    WL0033           Quality Level
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WL0032           Unit Weight
     C                     MOVELBZHICD    WL0033           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Qty/Weight Shipped RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0034    WBAIC3           Company Number
     C                     Z-ADDWL0035    WBC4NB           Order Number
     C                     Z-ADDWL0036    WBDPNB           Order Sequence
     C                     Z-ADDWL0037    WBUENB           Order Secondary
      * Establish starting position
     C           KRSSK     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0038           Quantity Shippe
     C                     Z-ADD*ZERO     WL0039           Weight Shipped
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBCBQT    WL0038           Quantity Shippe
     C                     Z-ADDWBATWG    WL0039           Weight Shipped
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Order TF-Exempt   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0040    WCAIC3           Company Number
     C                     Z-ADDWL0041    WCC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0042           OH TF Exempt Co
     C                     GOTO SLEXIT                     *QUIT
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCFYSX    WL0042           OH TF Exempt Co
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADD#1BIC3    WCAIC3           Company Number
     C                     Z-ADD#1ALNX    WCC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCRMNB    #1RMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Vry TFExmp - Customer - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#PC3C7    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RXUSX           Customer TF Exe
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEP3SX    #RXUSX           Customer TF Exe
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv A/R Claim Rsn Aff RT - A/R Claim Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AUFUAA           Claim Departmen
     C                     KFLD           AUCQCD           Reason Code
      * Setup key
     C                     MOVELWL0043    AUFUAA           Claim Departmen
     C                     MOVELWL0044    AUCQCD           Reason Code
      * Establish starting position
     C           KRSSO     CHAIN@AUREW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3423' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0045           Affect Inventor
     C                     MOVEL*BLANK    WL0046           Affect Sales Do
     C                     MOVEL*BLANK    WL0047           Affect Sales Pn
     C                     MOVEL*BLANK    WL0048           Affect Trade Fu
     C                     MOVEL*BLANK    WL0049           Affect Commissi
     C                     MOVEL*BLANK    WL0050           Affect Pricing
     C                     MOVEL*BLANK    WL0051           Valid Item Type
     C                     MOVEL*BLANK    WL0052           Require CM Appr
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAUAMST    WL0045           Affect Inventor
     C                     MOVELAUANST    WL0046           Affect Sales Do
     C                     MOVELAUVAST    WL0047           Affect Sales Pn
     C                     MOVELAUF0SX    WL0048           Affect Trade Fu
     C                     MOVELAUF1SX    WL0049           Affect Commissi
     C                     MOVELAUF2SX    WL0050           Affect Pricing
     C                     MOVELAUTYSX    WL0051           Valid Item Type
     C                     MOVELAUUOSX    WL0052           Require CM Appr
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * Get the Accounting C
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADD#1BIC3    WQSP01           Company Number
     C                     Z-ADD#1ALNX    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SQRVGN
     C                     MOVELWBAJCD    YN0006           Warehouse Code
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0007           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Claim Department   RT - A/R Claim Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           ATFUAA           Claim Departmen
      * Setup key
     C                     MOVELWL0053    ATFUAA           Claim Departmen
      * Establish starting position
     C           KRSSR     CHAIN@ATREW0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3421' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0054           Claim Departmen
     C                     MOVEL*BLANK    WL0055           Claim Responsib
     C                     MOVEL*BLANK    WL0056           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELATTXTX    WL0054           Claim Departmen
     C                     MOVELATTNSX    WL0055           Claim Responsib
     C                     MOVELATVSST    WL0056           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * CRT A/R Claim ProductSACR - A/R Claim Product  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Record Status
     C                     Z-ADD*ZERO     WN0002  70       Create Date
     C                     Z-ADD*ZERO     WN0003  60       Create Time
     C                     MOVEL*BLANK    WN0004 10        Create User
     C                     MOVEL*BLANK    WN0005 10        Create Program
     C                     Z-ADD*ZERO     WN0006  70       Change Date
     C                     Z-ADD*ZERO     WN0007  60       Change Time
     C                     MOVEL*BLANK    WN0008 10        Change User
     C                     MOVEL*BLANK    WN0009 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @MOCPWJ
     C                     Z-ADD#1C0C7    MOC0C7           Claim Number
     C                     Z-ADD#1AFNX    MOAFNX           Claim Item Line
     C                     Z-ADD#1BIC3    MOBIC3           Claim Company N
     C                     Z-ADD#1C1C7    MOC1C7           Claim Item Code
     C                     MOVEL#RG6AA    MOCQCD           Reason Code
     C                     MOVEL#1HHCD    MOHHCD           U/M - Primary D
     C                     MOVEL#1CISX    MOCISX           Responsible Dep
     C                     MOVEL#RTPAA    MOFUAA           Claim Departmen
     C                     Z-ADD#1DPNB    MODPNB           Order Sequence
     C                     Z-ADD#1UENB    MOUENB           Order Secondary
     C                     Z-ADD#1KUQT    MOKUQT           Claim Item Quan
     C                     Z-ADD#1HHWG    MOHHWG           Claim Item Weig
     C                     Z-ADD#1DIPR    MODIPR           Claim Item Unit
     C                     Z-ADD#1BNVL    MOBNVL           Claim Item Amou
     C                     MOVEL#1F0SX    MOF0SX           Affect Trade Fu
     C                     MOVEL#1F1SX    MOF1SX           Affect Commissi
     C                     MOVEL#1F2SX    MOF2SX           Affect Pricing
     C                     Z-ADD#1FXPR    MOFXPR           Inventory Value
     C                     MOVEL#1AMST    MOAMST           Affect Inventor
     C                     MOVEL#1ANST    MOANST           Affect Sales Do
     C                     MOVEL#1VAST    MOVAST           Affect Sales Pn
     C                     MOVEL#1TNSX    MOTNSX           Claim Responsib
     C                     Z-ADD#1ALNX    MOALNX           Claim Order Num
     C                     Z-ADD#1RMNB    MORMNB           Load ID
     C                     Z-ADD#1YTNX    MOYTNX           Claim Memo Numb
     C                     MOVEL#1N0CD    MON0CD           Item Type Code
     C                     MOVEL#1QYSX    MOQYSX           Claim Product R
     C                     MOVEL#1QZSX    MOQZSX           CP Require CM A
     C                     MOVEL#1Q0SX    MOQ0SX           Clm Item TF Exe
     C                     MOVEL#1UCSX    MOUCSX           CP Unused Sts 4
     C                     MOVEL#1UDSX    MOUDSX           CP Unused Sts 5
     C                     MOVEL#1UESX    MOUESX           CP Unused Sts 6
     C                     Z-ADD#1FYPR    MOFYPR           CP Unused Price
     C                     Z-ADD#1FZPR    MOFZPR           CP Unused Price
     C                     Z-ADD#1F0PR    MOF0PR           CP Unused Price
     C                     Z-ADD#1F1PR    MOF1PR           CP Unused Price
     C                     Z-ADD#1F2PR    MOF2PR           CP Unused Price
     C                     Z-ADD#1EUVL    MOEUVL           CP Unused Value
     C                     Z-ADD#1EVVL    MOEVVL           CP Unused Value
     C                     Z-ADD#1EWVL    MOEWVL           CP Unused Value
     C                     Z-ADD#1EXVL    MOEXVL           CP Unused Value
     C                     Z-ADD#1EYVL    MOEYVL           CP Unused Value
      *
      * USER: Processing before Data update
      * Rtv Claim Department   RT - A/R Claim Department  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELMOFUAA    WL0053    P      Claim Departmen
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YN0010    P      Claim Departmen
     C                     MOVELWL0055    MOTNSX    P      Claim Responsib
     C                     MOVELWL0056    YN0011    P      Record Status
      * OVERRIDE: Claim Responsibility
      * CASE:
      *  - c1 OR c2 OR c3 ORc4
      *   |- c1    : DB1.Clm Item TF Exempt Code is Exempt Customer
      *   |- c2    : DB1.Clm Item TF Exempt Code is Exempt Product
      *   |- c3    : DB1.Clm Item TF Exempt Code is Pre Commencement
      *   |- c4    : PAR.Accounting Company is Seaboard Triumph Foods
      *   '-
     C           MOQ0SX    IFEQ 'EC'                       *IF
     C           MOQ0SX    OREQ 'EP'                       *OR
     C           MOQ0SX    OREQ 'PC'                       *OR
     C           P6BTC3    OREQ 440                        *OR
      * RMC Change to check ACCTNG CO = STF 11/16/18 S13578
      * RMC Added STF 9/10/18 S13578
     C                     MOVEL'C'       MOTNSX           Claim Responsib
     C                     ELSE
      * CASE: *OTHERWISE
      * Affect Sales Pounds = Y
      * CASE: DB1.Affect Sales Pnds Status is yes
     C           MOVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'C'       MOTNSX           Claim Responsib
     C                     END                             *FI
      * TFS037:  If the Item is Co-Owned, the responsibility is always
      *          Shared.
      * Item Co-Ownership = S or T
      * CASE: PAR.Item Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
     C                     MOVEL'S'       MOTNSX           Claim Responsib
     C                     END                             *FI
     C                     END                             *FI
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       MOVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     MOMJDT           Create Date
     C                     Z-ADD##JTM     MOBETM           Create Time
     C                     MOVEL##USR     MOCCVN           Create User
     C                     MOVEL##PGM     MOCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     MOMKDT           Change Date
     C                     Z-ADD*ZERO     MOBFTM           Change Time
     C                     MOVEL*BLANK    MOCEVN           Change User
     C                     MOVEL*BLANK    MOCFVN           Change Program
     C           KLCRSS    KLIST
     C                     KFLD           MOC0C7           Claim Number
     C                     KFLD           MOAFNX           Claim Item Line
      * Check for duplicate primary key
     C           KLCRSS    SETLL@MOCPWJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2738' W0RTN   7
      * Send message 'A/R Claim Product      EX'
     C                     MOVEL'USR2738' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@MOCPWJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: PAR.Claim Audit Selection Usr is yes
     C           P8L9TX    IFEQ 'Y'                        *IF
      * System generated action notes
      * Claim product was created
      * Crt A/R Claim ExpComSG XF - A/R Claim Explanation  * 
     C                     CALL 'PMTNXFR'              90  Crt A/R Claim E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C0C7    WQ0036  70       Claim Number
     C                     PARM @CN,004   WQ0037 70        Claim Explanati
     C                     PARM 'S'       WQ0038  1        Claim Expl Type
     C                     PARM @CN,005   WQ0039 10        Claim Expl Acti
     C                     PARM *ZERO     WQ0040  70       Claim Expl Acti
     C                     PARM *ZERO     WQ0041  60       Claim Expl Acti
     C                     PARM 'CAR'     WQ0042  4        Claim Departmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMTNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STDLRC    BEGSR
      *================================================================
      * DLT A/R Claim ProductSADL - A/R Claim Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MOCPWJ
     C                     Z-ADD#1C0C7    MOC0C7           Claim Number
     C                     Z-ADD#1AFNX    MOAFNX           Claim Item Line
      *
     C           KLDLST    KLIST
     C                     KFLD           MOC0C7           Claim Number
     C                     KFLD           MOAFNX           Claim Item Line
     C           KLDLST    CHAIN@MOCPWJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMOCPL0'MDACP
     C                     MOVEL'@MOCPWJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C           KLDLST    SETLL@MOCPWJ              9091  *
     C                     GOTO STEXIT
     C                     ENDIF                           FI #1DBRC
      *................................................................
     C                     DELET@MOCPWJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      * CASE: PAR.Claim Audit Selection Usr is yes
     C           P8L9TX    IFEQ 'Y'                        *IF
      * System generated action notes
      * Claim product was deleted
      * Crt A/R Claim ExpComSG XF - A/R Claim Explanation  * 
     C                     CALL 'PMTNXFR'              90  Crt A/R Claim E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C0C7    WQ0043  70       Claim Number
     C                     PARM @CN,006   WQ0044 70        Claim Explanati
     C                     PARM 'S'       WQ0045  1        Claim Expl Type
     C                     PARM @CN,005   WQ0046 10        Claim Expl Acti
     C                     PARM *ZERO     WQ0047  70       Claim Expl Acti
     C                     PARM *ZERO     WQ0048  60       Claim Expl Acti
     C                     PARM 'CAR'     WQ0049  4        Claim Departmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMTNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG A/R Claim ProductSACH - A/R Claim Product  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  70       Create Date
     C                     Z-ADD*ZERO     WN0011  60       Create Time
     C                     MOVEL*BLANK    WN0012 10        Create User
     C                     MOVEL*BLANK    WN0013 10        Create Program
     C                     Z-ADD*ZERO     WN0014  70       Change Date
     C                     Z-ADD*ZERO     WN0015  60       Change Time
     C                     MOVEL*BLANK    WN0016 10        Change User
     C                     MOVEL*BLANK    WN0017 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @MOCPWJ
     C                     Z-ADD#1C0C7    MOC0C7           Claim Number
     C                     Z-ADD#1AFNX    MOAFNX           Claim Item Line
      *
     C           KLCHSU    KLIST
     C                     KFLD           MOC0C7           Claim Number
     C                     KFLD           MOAFNX           Claim Item Line
     C           KLCHSU    CHAIN@MOCPWJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMOCPL0'MDACP
     C                     MOVEL'@MOCPWJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPDMOCPL0               91  *
     C                     GOTO SUEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @MOCPWJ
     C                     Z-ADD#1BIC3    MOBIC3           Claim Company N
     C                     Z-ADD#1C1C7    MOC1C7           Claim Item Code
     C                     MOVEL#RG6AA    MOCQCD    P      Reason Code
     C                     MOVEL#1HHCD    MOHHCD    P      U/M - Primary D
     C                     MOVEL#1CISX    MOCISX    P      Responsible Dep
     C                     MOVEL#RTPAA    MOFUAA    P      Claim Departmen
     C                     Z-ADD#1DPNB    MODPNB           Order Sequence
     C                     Z-ADD#1UENB    MOUENB           Order Secondary
     C                     Z-ADD#1KUQT    MOKUQT           Claim Item Quan
     C                     Z-ADD#1HHWG    MOHHWG           Claim Item Weig
     C                     Z-ADD#1DIPR    MODIPR           Claim Item Unit
     C                     Z-ADD#1BNVL    MOBNVL           Claim Item Amou
     C                     MOVEL#1F0SX    MOF0SX    P      Affect Trade Fu
     C                     MOVEL#1F1SX    MOF1SX    P      Affect Commissi
     C                     MOVEL#1F2SX    MOF2SX    P      Affect Pricing
     C                     Z-ADD#1FXPR    MOFXPR           Inventory Value
     C                     MOVEL#1AMST    MOAMST    P      Affect Inventor
     C                     MOVEL#1ANST    MOANST    P      Affect Sales Do
     C                     MOVEL#1VAST    MOVAST    P      Affect Sales Pn
     C                     MOVEL#1TNSX    MOTNSX    P      Claim Responsib
     C                     Z-ADD#1ALNX    MOALNX           Claim Order Num
     C                     Z-ADD#1RMNB    MORMNB           Load ID
     C                     Z-ADD#1YTNX    MOYTNX           Claim Memo Numb
     C                     MOVEL#1N0CD    MON0CD    P      Item Type Code
     C                     MOVEL#1QYSX    MOQYSX    P      Claim Product R
     C                     MOVEL#1QZSX    MOQZSX    P      CP Require CM A
     C                     MOVEL#1Q0SX    MOQ0SX    P      Clm Item TF Exe
     C                     MOVEL#1UCSX    MOUCSX    P      CP Unused Sts 4
     C                     MOVEL#1UDSX    MOUDSX    P      CP Unused Sts 5
     C                     MOVEL#1UESX    MOUESX    P      CP Unused Sts 6
     C                     Z-ADD#1FYPR    MOFYPR           CP Unused Price
     C                     Z-ADD#1FZPR    MOFZPR           CP Unused Price
     C                     Z-ADD#1F0PR    MOF0PR           CP Unused Price
     C                     Z-ADD#1F1PR    MOF1PR           CP Unused Price
     C                     Z-ADD#1F2PR    MOF2PR           CP Unused Price
     C                     Z-ADD#1EUVL    MOEUVL           CP Unused Value
     C                     Z-ADD#1EVVL    MOEVVL           CP Unused Value
     C                     Z-ADD#1EWVL    MOEWVL           CP Unused Value
     C                     Z-ADD#1EXVL    MOEXVL           CP Unused Value
     C                     Z-ADD#1EYVL    MOEYVL           CP Unused Value
     C                     MOVEL#1VSST    MOVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Claim Department   RT - A/R Claim Department  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELMOFUAA    WL0053    P      Claim Departmen
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YN0012    P      Claim Departmen
     C                     MOVELWL0055    MOTNSX    P      Claim Responsib
     C                     MOVELWL0056    YN0013    P      Record Status
      * OVERRIDE: Claim Responsibility
      * CASE:
      *  - c1 OR c2 OR c3 ORc4
      *   |- c1    : DB1.Clm Item TF Exempt Code is Exempt Customer
      *   |- c2    : DB1.Clm Item TF Exempt Code is Exempt Product
      *   |- c3    : DB1.Clm Item TF Exempt Code is Pre Commencement
      *   |- c4    : PAR.Accounting Company is Seaboard Triumph Foods
      *   '-
     C           MOQ0SX    IFEQ 'EC'                       *IF
     C           MOQ0SX    OREQ 'EP'                       *OR
     C           MOQ0SX    OREQ 'PC'                       *OR
     C           P6BTC3    OREQ 440                        *OR
      * RMC Change to check ACCTNG CO = STF 11/16/18 S13578
      * RMC added stf 8/10/18
     C                     MOVEL'C'       MOTNSX           Claim Responsib
     C                     ELSE
      * CASE: *OTHERWISE
      * Affect Sales Pounds = Y, the Company
      * CASE: DB1.Affect Sales Pnds Status is yes
     C           MOVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'C'       MOTNSX           Claim Responsib
     C                     END                             *FI
      * TFS037:  If the Item is Co-Owned, the responsibility is always
      *          Shared.
      * Item Co-Ownership = S or T, then Shared
      * CASE: PAR.Item Co-Ownership Sts is Co-Owned
     C           #RP3ST    IFEQ 'S'                        *IF
     C           #RP3ST    OREQ 'T'
     C                     MOVEL'S'       MOTNSX           Claim Responsib
     C                     END                             *FI
     C                     END                             *FI
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     MOMKDT           Change Date
     C                     Z-ADD##JTM     MOBFTM           Change Time
     C                     MOVEL##USR     MOCEVN           Change User
     C                     MOVEL##PGM     MOCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@MOCPWJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMOCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * CASE: PAR.Claim Audit Selection Usr is yes
     C           P8L9TX    IFEQ 'Y'                        *IF
      * System generated action notes
      * Claim product was changed
      * Crt A/R Claim ExpComSG XF - A/R Claim Explanation  * 
     C                     CALL 'PMTNXFR'              90  Crt A/R Claim E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C0C7    WQ0050  70       Claim Number
     C                     PARM @CN,007   WQ0051 70        Claim Explanati
     C                     PARM 'S'       WQ0052  1        Claim Expl Type
     C                     PARM @CN,005   WQ0053 10        Claim Expl Acti
     C                     PARM *ZERO     WQ0054  70       Claim Expl Acti
     C                     PARM *ZERO     WQ0055  60       Claim Expl Acti
     C                     PARM 'CAR'     WQ0056  4        Claim Departmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMTNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0018    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSV     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P3I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P3MPNA           Default Printer
     C                     MOVELDRBCCD    P3BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0011           Company Number
     C                     MOVELDRBUVN    WN0019           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0057    DTAJVN           User Profile Na
     C                     MOVELWL0058    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSW     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0059           Company Number
     C                     MOVELDTAJCD    WL0060           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSX01           Application Cod
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Application Cod
      * Setup key
     C                     MOVELP3DNCD    WQSX01           Application Cod
      * Establish starting position
     C           KRSSX     SETLL@DNRESF                    *
     C           KRSSX     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C           KRSSX     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Val existing recd that could have missing uom because crt elsewh
      *================================================================
      * Validate company, item, Ship To and TF Exempt
     C                     EXSR UBSUBR                     Validate compan
      * E4057 JJH 04/09/15 - Revised Department / Reason Code procesing
      * Validate Department and Reason code
     C                     EXSR UGSUBR                     Validate Depart
      * E4057 JJH 04/09/15 - Revised Department / Reason Code procesing
      * 03/11/04 SLM OMS012A
      * Remove the reason department validation and add the
      * A/R Claim Department
      * Validate unit of measure.
     C                     EXSR UHSUBR                     Validate unit o
      * CASE: RCD.U/M - Primary Dft is Head Set
     C           #1HHCD    IFEQ 'HS'                       *IF
     C                     Z-ADD*ZERO     #1HHWG           Claim Item Weig
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate quantity & weight.
     C                     EXSR UISUBR                     Validate quanti
     C                     END                             *FI
      * Validate required fields.
     C                     EXSR ULSUBR                     Validate requir
      * 031604 slm OMS012 -- Item Type is EX, Order number is optional
      * CASE: RCD.Item Type Code is Finished Good
     C           #1N0CD    IFEQ 'FG'                       *IF
      * CASE: RCD.Claim Order Number is Equal to zeros
     C           #1ALNX    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0021           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0021           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Number must be ente'
     C                     MOVEL'USR1936' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.Item Type Code is Expense
     C           #1N0CD    IFEQ 'EX'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Move TF Exempt Code and Validate TF Exempt Code
     C                     EXSR UPSUBR                     Move TF Exempt
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Validate company, item, Ship To and TF Exempt
      *================================================================
      * 03/11/05 Add the validation of Valid Item type and item type from
      * the Company Item file.
      * The org Check file was * out and a new one created
      * Company & Item must exist in the Company/Item file
      * and bring back the item type for additional validation.
      * 03/16/05 OMS012A - Only allow items from one company.
      * 03/16/05 OMS012A - Bring back the item type
     C                     MOVELWUGSTX    #RXUSX           Cst TF Exempt C
     C                     MOVELWUGSTX    #RXVSX           Itm TF Exempt C
     C                     MOVELWUGSTX    #RXWSX           Ord TF Exempt C
     C                     MOVELWUGSTX    #1Q0SX           Clm Item TF Exe
      * F4 = Prompt for Company/Item.
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : CTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> RCD.Claim Company Number
      *   |- c3    : PGM.*Cursor field <IS> RCD.Claim Item Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V1BIC3'                   *IF
     C           W0CSRR    OREQ ##RR                       *
     C           W0CFL     ANDEQ'V1C1C7'                   *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP2BIC3    #1BIC3           Claim Company N
      * SEL Actv Item by Co    SR - Company Item  * 
     C                     CALL 'PDL9SRR'              90  SEL Actv Item b
     C                     PARM *BLANK    W0RTN   7
     C           P3AIC3    PARM P3AIC3    WQ0001  30       Company Number
     C           #1C1C7    PARM #1C1C7    WQ0002  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     END                             *FI
      * Load Default Value for Single Company Users.
      * CASE: PAR.Allow Multi-Company is no
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP3AIC3    #1BIC3           Claim Company N
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * VAL Ext Co/Ord/Item ShpRT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0003           Company Number
     C                     Z-ADD#1ALNX    WL0004           Order Number
     C                     Z-ADD#1C1C7    WL0007           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #1DPNB           Order Sequence
     C                     Z-ADDWL0006    #1UENB           Order Secondary
     C                     Z-ADDWL0008    YL0001           Ship To Custome
     C                     MOVELWL0009    #RXWSX    P      Ord TF Exempt C
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Was not on the Orginial Order get ship to customer and
      * the TF will be set to the value of blanks.
      * RTV Ship Cust,Bill Tp RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ALNX    WL0011           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WUAIC3           Company Number
     C                     Z-ADDWL0012    YL0001           Ship To Custome
     C                     MOVELWL0013    YL0002    P      Billing Activit
     C                     MOVELWUGSTX    #RXWSX           Ord TF Exempt C
     C                     END                             *FI
      * CASE: CTL.Claim Ship to Customer EQ LCL.Ship To Customer
     C           #PC3C7    IFEQ YL0001                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Claim Ship to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PC3C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PC3C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0001    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0001    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'ShipToCust N=Claim ShipTo'
     C                     MOVEL'USR3463' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * Rtv Cust Tf Exempt    XF - Customer EXT  * 
     C                     CALL 'PPSMXFR'              90  Rtv Cust Tf Exe
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0003  70       Ship To Custome
     C           #RXUSX    PARM *BLANK    WQ0004  2        Customer TF Exe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPSMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Company & Item are required.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Claim Company Number is Equal to zero
      *   |- c2    : RCD.Claim Item Code is Not Entered
      *   '-
     C           #1BIC3    IFEQ *ZERO                      *IF
     C           #1C1C7    OREQ *ZERO                      *OR
      * Setup message data for message
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0004           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company/Item are Req.'
     C                     MOVEL'USR2765' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * check file
     C                     EXSR UCSUBR                     check file
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * check file
      *================================================================
      * 03/11/05 Add the validation of Valid Item type and item type from
      * the Company Item file.
      * The org Check file was * out and a new one created
      * Company & Item must exists in the Company/Item file.
      * and bring back the item type for additional validation.
      * Rtv Item Type/TF Exemp RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3AIC3    WL0014           Company Number
     C                     Z-ADD#1C1C7    WL0015           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0004    P      Item Type Code
     C                     MOVELWL0017    #RP3ST    P      TF Co-Ownership
     C                     MOVELWL0018    #RXVSX    P      Item TF Exempt
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0006           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Item Type Code is Equal Blanks
     C           #1N0CD    IFEQ *BLANK                     *IF
     C                     MOVELYL0004    #1N0CD           Item Type Code
     C                     END                             *FI
      * CASE: LCL.Item Type Code is Work in Process
     C           YL0004    IFEQ 'WP'                       *IF
      * Setup message data for message
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item type cant be WP'
     C                     MOVEL'USR3050' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Determine if Item is on the Order, if not give warning.
     C                     EXSR UDSUBR                     Determine if It
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Determine if Item is on the Order, if not give warning.
      *================================================================
      * VAL Exist co/ord/item  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0019           Company Number
     C                     Z-ADDP2ALNX    WL0020           Order Number
     C                     Z-ADD#1C1C7    WL0023           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    P1DPNB           Order Sequence
     C                     Z-ADDWL0022    P1UENB           Order Secondary
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Load Sequence Numbers, If not already loaded.
     C                     EXSR UESUBR                     Load Sequence N
     C                     ELSE
      * CASE: *OTHERWISE
      * Zero Sequence Numbers.
     C                     EXSR UFSUBR                     Zero Sequence N
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Load Sequence Numbers, If not already loaded.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Order Sequence Number is Equal to zero
      *   |- c2    : RCD.Order Secondary Line Seq is ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           #1UENB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1DPNB    #1DPNB           Order Sequence
     C                     Z-ADDP1UENB    #1UENB           Order Secondary
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Zero Sequence Numbers.
      *================================================================
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Validate Department and Reason code
      *================================================================
      * Reason & department must be found in the A/R Claim Reason
      * Vry A/R Claim Dept/Rsn RT - A/R Claim Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTPAA    WL0024    P      Claim Departmen
     C                     MOVEL#RG6AA    WL0025    P      Reason Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0005    P      Valid Item Type
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Send message 'A/R Claim Department R NF'
     C                     MOVEL'USR3423' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
      * E4057 JJH 10/13/15 - Do not allow Inactive Department/Reason
     C                     ELSE
      * CASE: PGM.*Return code is *Record is inactive
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
     C                     MOVEL#RTPAA    ZA0009           Claim Departmen
     C                     MOVEL#RG6AA    ZA0010           Reason Code Usr
      * Send message 'A/R Claim Department R IN'
     C                     MOVEL'USR4856' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983435*
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Validate unit of measure.
      *================================================================
      * Company & Item are required.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Claim Company Number is Equal to zero
      *   |- c2    : RCD.Claim Item Code is Not Entered
      *   '-
     C           #1BIC3    IFEQ *ZERO                      *IF
     C           #1C1C7    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Prc Unit of Meas   RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0027           Company Number
     C                     Z-ADD#1C1C7    WL0028           Item Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #1HHCD    P      U/M - Pricing
      * E4057 JJH 05/27/15 - Add GL (Gallons) as valid U/M
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8
      *   |- c1    : RCD.U/M - Primary Dft is Head Set
      *   |- c2    : RCD.U/M - Primary Dft is Pounds
      *   |- c3    : RCD.U/M - Primary Dft is Each
      *   |- c4    : RCD.U/M - Primary Dft is Cases
      *   |- c5    : RCD.U/M - Primary Dft is Carcass Hundred Weight
      *   |- c6    : RCD.U/M - Primary Dft is Tons
      *   |- c7    : RCD.U/M - Primary Dft is Pieces
      *   |- c8    : RCD.U/M - Primary Dft is Gallon
      *   '-
     C           #1HHCD    IFEQ 'HS'                       *IF
     C           #1HHCD    OREQ 'LB'                       *OR
     C           #1HHCD    OREQ 'EA'                       *OR
     C           #1HHCD    OREQ 'CS'                       *OR
     C           #1HHCD    OREQ 'CW'                       *OR
     C           #1HHCD    OREQ 'TN'                       *OR
     C           #1HHCD    OREQ 'PC'                       *OR
     C           #1HHCD    OREQ 'GL'                       *OR
      * added pieces
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1HHCD    ZA0011           U/M - Primary D
      * Send message 'Claim U/M invalid'
     C                     MOVEL'USR2897' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Validate quantity & weight.
      *================================================================
      * Quantity is Negative --> Weight must be Negative.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Claim Item Quantity is Less than zero
      *   |- c2    : RCD.Claim Item Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KUQT    IFLT *ZERO                      *IF
     C           #1HHWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MULT -1        #1HHWG           Claim Item Weig
     C                     END                             *FI
      * Calculate Average Weight.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Quantity is not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1KUQT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Order Sequence Number is Equal to zero
      *   |- c2    : RCD.Order Secondary Line Seq is ZERO
      *   '-
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           #1UENB    OREQ *ZERO                      *OR
      * Calculate the average weight for "non-order" item.
     C                     EXSR UJSUBR                     Calculate the a
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate the average weight for "order" item.
     C                     EXSR UKSUBR                     Calculate the a
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Calculate the average weight for "non-order" item.
      *================================================================
      * RTV Unit Weight        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0030           Company Number
     C                     Z-ADD#1C1C7    WL0031           Item Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    P4H0WG           Unit Weight
     C                     MOVELWL0033    WUA6AA    P      Quality Level
     C           #1KUQT    MULT P4H0WG    #1HHWG    H      Claim Item Weig
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Calculate the average weight for "order" item.
      *================================================================
      * *** Get shipped weight and quantity from order detail. ***
      * RTV Qty/Weight Shipped RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0034           Company Number
     C                     Z-ADDP2ALNX    WL0035           Order Number
     C                     Z-ADD#1DPNB    WL0036           Order Sequence
     C                     Z-ADD#1UENB    WL0037           Order Secondary
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    P4CBQT           Quantity Shippe
     C                     Z-ADDWL0039    P4ATWG           Weight Shipped
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Quantity Shipped Total is not equal zero
      *   |- c3    : PAR.Weight Shipped Total is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           P4CBQT    IFNE *ZERO                      *IF
     C           P4ATWG    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * *** Calculate the average weight of each item on order detail. **
     C           P4ATWG    DIV  P4CBQT    P4H0WG    H      Average Weight
      * *** Calculate the total weight for item on claim. ***
     C           #1KUQT    MULT P4H0WG    #1HHWG    H      Claim Item Weig
      * CASE: RCD.U/M - Primary Dft is Head Set
     C           #1HHCD    IFEQ 'HS'                       *IF
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Validate required fields.
      *================================================================
      * CASE: RCD.U/M - Primary Dft is Pounds
     C           #1HHCD    IFEQ 'LB'                       *IF
      * Pounds required fields.
     C                     EXSR UMSUBR                     Pounds required
     C                     ELSE
      * CASE: RCD.U/M - Primary Dft is Head Set
     C           #1HHCD    IFEQ 'HS'                       *IF
      * Head Set required fields.
     C                     EXSR UNSUBR                     Head Set requir
     C                     ELSE
      * CASE: *OTHERWISE
      * All other unit of measure required fields.
     C                     EXSR UOSUBR                     All other unit
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Pounds required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HHWG    ZA0012           Claim Item Weig
     C                     Z-ADD#1DIPR    ZA0013           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0014           Claim Item Amou
      * Send message 'Weight,Price,Amt must be'
     C                     MOVEL'USR2779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983738*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Head Set required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Quantity is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1KUQT    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1KUQT    ZA0015           Claim Item Quan
     C                     Z-ADD#1DIPR    ZA0016           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0017           Claim Item Amou
      * Send message 'Qty,Price,Amt must be'
     C                     MOVEL'USR2899' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983638*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * All other unit of measure required fields.
      *================================================================
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Unit Price is Equal zero
      *   |- c3    : RCD.Claim Item Amount is equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1DIPR    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1BNVL    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HHWG    ZA0018           Claim Item Weig
     C                     Z-ADD#1DIPR    ZA0019           Claim Item Unit
     C                     Z-ADD#1BNVL    ZA0020           Claim Item Amou
      * Send message 'Weight,Price,Amt must be'
     C                     MOVEL'USR2779' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     983738*
     C                     SETON                     39    *
      *
     C                     END                             *FI
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Move TF Exempt Code and Validate TF Exempt Code
      *================================================================
      * CASE: LCL.ORG TF Exempt Cde Usr is Pre Commencement
     C           YL0003    IFEQ 'PC'                       *IF
      * If the TF from the ORG ORDER IS A PC then all records will be a p
     C                     MOVELYL0003    #RXWSX           Ord TF Exempt C
     C                     ELSE
      * CASE: RCD.Ord TF Exempt Cde Usr EQ WRK.BLANK
     C           #RXWSX    IFEQ WUGSTX                     *IF
      * If the TF from the Order is blank then get the TF from the Item
      * If THE ITEM IS an EP
      * CASE: RCD.Itm TF Exempt Cde Usr is Exempt Product
     C           #RXVSX    IFEQ 'EP'                       *IF
     C                     MOVEL#RXVSX    #RXWSX           Ord TF Exempt C
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Order TF-Exempt   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0040           Company Number
     C                     Z-ADD#1ALNX    WL0041           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    #RXWSX    P      OH TF Exempt Co
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move the TF from the Order, then if Order not found then move fro
      * the item code.
      * Move the values to the claim product TF EXEMPT
      * CASE: RCD.Ord TF Exempt Cde Usr NE WRK.BLANK
     C           #RXWSX    IFNE WUGSTX                     *IF
     C                     MOVEL#RXWSX    #1Q0SX           Clm Item TF Exe
     C                     ELSE
      * CASE: RCD.Cst TF Exempt Cde Usr is Exempt Customer
     C           #RXUSX    IFEQ 'EC'                       *IF
      * CASE: RCD.Itm TF Exempt Cde Usr is Exempt Product
     C           #RXVSX    IFEQ 'EP'                       *IF
     C                     MOVEL#RXVSX    #1Q0SX           Clm Item TF Exe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#RXUSX    #1Q0SX           Clm Item TF Exe
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.Cst TF Exempt Cde Usr is Not Exempt
     C           #RXUSX    IFEQ 'NE'                       *IF
     C                     MOVEL#RXVSX    #1Q0SX           Clm Item TF Exe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate the TF Exempt
      * CASE: RCD.Clm Item TF Exempt Code EQ WRK.BLANK
     C           #1Q0SX    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q0SX    ZA0022           Clm Item TF Exe
      * Send message 'Tf Exempt -err'
     C                     MOVEL'USR3585' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
      * If the claim TF Exempt is blank, then this is a required field.
      * The IS group would have to review this data to know what has
      * happened.
     C                     END                             *FI
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * F10=Select Items from Order.
      *================================================================
      * CUSTOMER NOT FOUND BECAUSE OF NO SUB FILE RECORDS
      * CASE: LCL.Ship To Customer is equal to zero
     C           YL0001    IFEQ *ZERO                      *IF
     C                     Z-ADDP2C3C7    YL0001           Ship To Custome
     C                     END                             *FI
      * SEL Item for Order Clm DF - Order Detail  * 
     C                     CLEARPBRC
     C                     Z-ADDYL0001    PBBKC7           Ship To Custome
     C                     Z-ADDP2BIC3    PBAIC3           Company Number
     C                     Z-ADDP2ALNX    PBC4NB           Order Number
      *
     C                     CALL 'PPLHDFR'              90  SEL Item for Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
     C                     PARM P1C0C7    WQ0005  70       Claim Number
     C                     PARM #PC3C7    WQ0006  70       Claim Ship to C
     C                     PARM 'P'       WQ0007  1        Product or Resa
     C           P5T6SX    PARM P5T6SX    WQ0008  3        Clm Program USR
     C                     PARM P8L9TX    WQ0009  1        Claim Audit Sel
     C                     PARM P8JDAA    WQ0010 10        Claim Audit Co
     C                     PARM P8N9T1    WQ0011 50        Approval Claim
     C                     PARM P6BTC3    WQ0012  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPLHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * IF not F10, THEN continue validations.
      *================================================================
      * Validate company & item.  Pull down TF from the Order, and Ship t
     C                     EXSR USSUBR                     Validate compan
      * E4057 JJH 04/09/15 - Revised Reason Code procesing
      * Validate reason code
     C                     EXSR UWSUBR                     Validate reason
      * E4057 JJH 04/09/15 - Revised Department & Reason Code procesing
      * E4057 Move this logic after it sets the Department and Reason Cod
      * 03/11/04 SLM OMS012A
      * Remove the reason department validation and add the
      * A/R Claim Department
      * 08/02/04 SLM OMS012A  Add Cases to Unit of Measure for claims
      *                  Allow this to flow through
      * Validate unit of measure.
     C                     EXSR UXSUBR                     Validate unit o
      * 10/11/07 SLM Cases was zero out weight * this out
      * Validate quantity & weight.  ALL Uoms now - 3/26/15
     C                     EXSR UYSUBR                     Validate quanti
      * Validate required fields.
     C                     EXSR NBSUBR                     Validate requir
      * 9/12/2006 slm If Affect Sales Pounds is a Y, then Weight is requi
      * CASE: RCD.Affect Sales Pnds Status is yes
     C           #1VAST    IFEQ 'Y'                        *IF
      * CASE: RCD.Claim Item Weight is Equal to zero
     C           #1HHWG    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#1HHWG    ZA0047           Claim Item Weig
      * Send message 'Pounds is Required'
     C                     MOVEL'USR2255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9837  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * E4057 JJH 04/09/15 - Revised Reason Code procesing
      * Validate Department and Reason code
     C                     EXSR NHSUBR                     Validate Depart
      * If DP or PS Reason is used, set a flag and save it.  10/6/04
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.Reason Code Usr is Deviated Pricing Adj
      *   |- c2    : RCD.Reason Code Usr is Profit Sharing Adj
      *   '-
     C           #RG6AA    IFEQ 'DP'                       *IF
     C           #RG6AA    OREQ 'PS'                       *OR
      * CASE: WRK.Status Flag 1  Y/N is No
     C           WUQ1ST    IFEQ 'N'                        *IF
     C                     MOVEL#RG6AA    WUCQCD           Reason Code
     C                     MOVEL'Y'       WUQ1ST           Status Flag 1
     C                     END                             *FI
     C                     END                             *FI
      * If a DP/PS exists, all reasons must match it.     10/6/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Status Flag 1  Y/N is Yes
      *   |- c2    : RCD.Reason Code Usr NE WRK.Reason Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUQ1ST    IFEQ 'Y'                        *IF
     C           #RG6AA    IFNE WUCQCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWUCQCD    ZA0050           Reason Code
      * Send message 'Reason Code must match'
     C                     MOVEL'USR3391' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * 031604 slm OMS012 -- Item Type is EX, Order number is optional
      * CASE: RCD.Item Type Code is Finished Good
     C           #1N0CD    IFEQ 'FG'                       *IF
      * CASE: RCD.Claim Order Number is Equal to zeros
     C           #1ALNX    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0051           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0051           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Number must be ente'
     C                     MOVEL'USR1936' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.Item Type Code is Expense
     C           #1N0CD    IFEQ 'EX'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Move TF Exempt Code and Validate TF Exempt Code
     C                     EXSR NISUBR                     Move TF Exempt
      * ************
      * RMC 01/08/07  Moved here from the Init New REcord spot
      * slm 112806 - PK0040 Add the validation for Accounting company
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * Get the Accounting Co
     C                     EXSR SPRVGN
      * Val Accounting Co must match between orders
      * CASE: LCL.Accounting Company NE PAR.Accounting Company
     C           YL0007    IFNE P6BTC3                     *IF
      * Issue message that this rcd Accounting Company does not match
      * the order accounting company.
      * Setup message data for message
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0053           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0053           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0054           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0054           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Accounting Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           P6BTC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELP6BTC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0055           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0055           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           P2ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELP2ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0056           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0056           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Ord AcctCo N= Rcd AcctCo'
     C                     MOVEL'USR3665' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * ************
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Validate company & item.  Pull down TF from the Order, and Ship
      *================================================================
      * 03/11/05 Add the validation of Valid Item type and item type from
      * the Company Item file.
      * The org Check file was * out and a new one created
      * Company & Item must exists in the Company/Item file.
      * and bring back the item type for additional validation.
      * 03/16/05 OMS012A - Only allow items from one company.
      * 03/16/05 OMS012A - Bring back the item type
     C                     MOVELWUGSTX    #RXUSX           Cst TF Exempt C
     C                     MOVELWUGSTX    #RXVSX           Itm TF Exempt C
     C                     MOVELWUGSTX    #RXWSX           Ord TF Exempt C
     C                     MOVELWUGSTX    #1Q0SX           Clm Item TF Exe
      * F4 = Prompt for Company/Item.
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : CTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> RCD.Claim Company Number
      *   |- c3    : PGM.*Cursor field <IS> RCD.Claim Item Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'V1BIC3'                   *IF
     C           W0CSRR    OREQ ##RR                       *
     C           W0CFL     ANDEQ'V1C1C7'                   *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP2BIC3    #1BIC3           Claim Company N
      * SEL Actv Item by Co    SR - Company Item  * 
     C                     CALL 'PDL9SRR'              90  SEL Actv Item b
     C                     PARM *BLANK    W0RTN   7
     C           P3AIC3    PARM P3AIC3    WQ0013  30       Company Number
     C           #1C1C7    PARM #1C1C7    WQ0014  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     END                             *FI
      * Load Default Value for Single Company Users.
      * CASE: PAR.Allow Multi-Company is no
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP3AIC3    #1BIC3           Claim Company N
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * VAL Ext Co/Ord/Item ShpRT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0003           Company Number
     C                     Z-ADD#1ALNX    WL0004           Order Number
     C                     Z-ADD#1C1C7    WL0007           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #1DPNB           Order Sequence
     C                     Z-ADDWL0006    #1UENB           Order Secondary
     C                     Z-ADDWL0008    YL0001           Ship To Custome
     C                     MOVELWL0009    #RXWSX    P      Ord TF Exempt C
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Was not on the Orginial Order get ship to customer and
      * the TF will be set to the value of blanks.
      * RTV Ship Cust,Bill Tp RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ALNX    WL0011           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WUAIC3           Company Number
     C                     Z-ADDWL0012    YL0001           Ship To Custome
     C                     MOVELWL0013    YL0002    P      Billing Activit
     C                     MOVELWUGSTX    #RXWSX           Ord TF Exempt C
     C                     END                             *FI
      * CASE: CTL.Claim Ship to Customer EQ LCL.Ship To Customer
     C           #PC3C7    IFEQ YL0001                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Claim Ship to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #PC3C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#PC3C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0023           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0023           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0024           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0024           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0001    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0001    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0025           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0025           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'ShipToCust N=Claim ShipTo'
     C                     MOVEL'USR3463' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * Vry TFExmp - Customer - Customer EXT  * 
     C                     EXSR SNRVGN
      * Company & Item are required.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Claim Company Number is Equal to zero
      *   |- c2    : RCD.Claim Item Code is Not Entered
      *   '-
     C           #1BIC3    IFEQ *ZERO                      *IF
     C           #1C1C7    OREQ *ZERO                      *OR
      * Setup message data for message
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0026           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0026           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0027           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0027           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company/Item are Req.'
     C                     MOVEL'USR2765' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * check file
     C                     EXSR UTSUBR                     check file
     C                     END                             *FI
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * check file
      *================================================================
      * 03/11/05 Add the validation of Valid Item type and item type from
      * the Company Item file.
      * The org Check file was * out and a new one created
      * Company & Item must exists in the Company/Item file.
      * and bring back the item type for additional validation.
      * Rtv Item Type/TF Exemp RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3AIC3    WL0014           Company Number
     C                     Z-ADD#1C1C7    WL0015           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0004    P      Item Type Code
     C                     MOVELWL0017    #RP3ST    P      TF Co-Ownership
     C                     MOVELWL0018    #RXVSX    P      Item TF Exempt
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0028           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0028           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0029           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0029           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Item Type Code is Equal Blanks
     C           #1N0CD    IFEQ *BLANK                     *IF
     C                     MOVELYL0004    #1N0CD           Item Type Code
     C                     END                             *FI
      * CASE: LCL.Item Type Code is Work in Process
     C           YL0004    IFEQ 'WP'                       *IF
      * Setup message data for message
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0030           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0030           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item type cant be WP'
     C                     MOVEL'USR3050' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Determine if Item is on the Order, if not give warning.
     C                     EXSR UUSUBR                     Determine if It
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Determine if Item is on the Order, if not give warning.
      *================================================================
      * VAL Exist co/ord/item  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0019           Company Number
     C                     Z-ADD#1ALNX    WL0020           Order Number
     C                     Z-ADD#1C1C7    WL0023           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    #1DPNB           Order Sequence
     C                     Z-ADDWL0022    #1UENB           Order Secondary
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Zero Sequence Numbers.
     C                     EXSR UVSUBR                     Zero Sequence N
     C                     END                             *FI
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Zero Sequence Numbers.
      *================================================================
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * Validate reason code
      *================================================================
      * Reason & department must be found in the A/R Claim Reason
      * Rtv A/R Claim Rsn Aff RT - A/R Claim Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RTPAA    WL0043    P      Claim Departmen
     C                     MOVEL#RG6AA    WL0044    P      Reason Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0045    YN0001    P      Affect Inventor
     C                     MOVELWL0046    #1ANST    P      Affect Sales Do
     C                     MOVELWL0047    #1VAST    P      Affect Sales Pn
     C                     MOVELWL0048    YN0002    P      Affect Trade Fu
     C                     MOVELWL0049    YN0003    P      Affect Commissi
     C                     MOVELWL0050    YN0004    P      Affect Pricing
     C                     MOVELWL0051    YN0005    P      Valid Item Type
     C                     MOVELWL0052    #1QZSX    P      Require CM Appr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL#RTPAA    #1FUAA           Claim Departmen
     C                     MOVEL#RG6AA    #1CQCD           Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'A/R Claim Department R NF'
     C                     MOVEL'USR3423' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Validate unit of measure.
      *================================================================
      * Company & Item are required.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Claim Company Number is Equal to zero
      *   |- c2    : RCD.Claim Item Code is Not Entered
      *   '-
     C           #1BIC3    IFEQ *ZERO                      *IF
     C           #1C1C7    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Prc Unit of Meas   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0027           Company Number
     C                     Z-ADD#1C1C7    WL0028           Item Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #1HHCD    P      U/M - Pricing
      * E4057 JJH 05/28/15 - Add GL (Gallon) as valid UOM.
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 ORc6 OR c7 OR c8
      *   |- c1    : RCD.U/M - Primary Dft is Head Set
      *   |- c2    : RCD.U/M - Primary Dft is Pounds
      *   |- c3    : RCD.U/M - Primary Dft is Cases
      *   |- c4    : RCD.U/M - Primary Dft is Each
      *   |- c5    : RCD.U/M - Primary Dft is Carcass Hundred Weight
      *   |- c6    : RCD.U/M - Primary Dft is Tons
      *   |- c7    : RCD.U/M - Primary Dft is Pieces
      *   |- c8    : RCD.U/M - Primary Dft is Gallon
      *   '-
     C           #1HHCD    IFEQ 'HS'                       *IF
     C           #1HHCD    OREQ 'LB'                       *OR
     C           #1HHCD    OREQ 'CS'                       *OR
     C           #1HHCD    OREQ 'EA'                       *OR
     C           #1HHCD    OREQ 'CW'                       *OR
     C           #1HHCD    OREQ 'TN'                       *OR
     C           #1HHCD    OREQ 'PC'                       *OR
     C           #1HHCD    OREQ 'GL'                       *OR
      * added pieces
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1HHCD    ZA0031           U/M - Primary D
      * Send message 'Claim U/M invalid'
     C                     MOVEL'USR2897' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Validate quantity & weight.  ALL Uoms now - 3/26/15
      *================================================================
      * Quantity is Negative --> Weight must be Negative.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Claim Item Quantity is Less than zero
      *   |- c2    : RCD.Claim Item Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KUQT    IFLT *ZERO                      *IF
     C           #1HHWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MULT -1        #1HHWG           Claim Item Weig
     C                     END                             *FI
      * Calculate Average Weight.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Claim Item Weight is Equal to zero
      *   |- c2    : RCD.Claim Item Quantity is not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HHWG    IFEQ *ZERO                      *IF
     C           #1KUQT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Order Sequence Number is Equal to zero
      *   |- c2    : RCD.Order Secondary Line Seq is ZERO
      *   '-
     C           #1DPNB    IFEQ *ZERO                      *IF
     C           #1UENB    OREQ *ZERO                      *OR
      * Calculate the average weight for "non-order" item.
     C                     EXSR UZSUBR                     Calculate the a
     C                     ELSE
      * CASE: *OTHERWISE
      * Calculate the average weight for "order" item.
     C                     EXSR NASUBR                     Calculate the a
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Calculate the average weight for "non-order" item.
      *================================================================
      * RTV Unit Weight        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BIC3    WL0030           Company Number
     C                     Z-ADD#1C1C7    WL0031           Item Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    P4H0WG           Unit Weight
     C                     MOVELWL0033    WUA6AA    P      Quality Level
     C           #1KUQT    MULT P4H0WG    #1HHWG    H      Claim Item Weig
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1CQCD' defaulted for 'Reason Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Order Number'.
      * Field '(LCL) YL0008' defaulted for 'Header Status'.
     C                     CALL 'PDG8SRR'              90  SEL for Order R
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0015  3        Reason Code
     C                     PARM *ZERO     WQ0016  70       Order Number
     C                     PARM YL0008    WQ0017  1        Header Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG8SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVACX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVACX    CHAIN@CXRENA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1HHCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HHCD' defaulted for 'U/M - Primary Dft'.
     C                     CALL 'PDQWSRR'              90  SEL UM for Clai
     C                     PARM *BLANK    W0RTN   7
     C           #1HHCD    PARM #1HHCD    WQ0018  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1HHCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HHCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1HHCD    AMHHCD
     C           KLVBAM    CHAIN@AMREB0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to A/R Claim Department
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1FUAA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Claim Departmen
     C           YPMTFD    OREQ '#1FUAA'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1FUAA' defaulted for 'Claim Department Code'.
     C                     CALL 'PPJ0SRR'              90  Sel A/R Claim D
     C                     PARM *BLANK    W0RTN   7
     C           #1FUAA    PARM #1FUAA    WQ0019  3        Claim Departmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1FUAA    IFNE *BLANK                     Claim Departmen
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1FUAA    IFEQ *BLANK                     Claim Departmen
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAT    KLIST
     C                     KFLD           ATFUAA           Claim Departmen
      * Setup key
     C                     MOVEL#1FUAA    ATFUAA
     C           KLVCAT    CHAIN@ATREW0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'A/R Claim Department   NF'
     C                     MOVEL'USR3421' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR3421' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2C0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Claim Number
     C           YPMTFD    OREQ '#2C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2C0C7' defaulted for 'Claim Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #PBIC3' defaulted for 'Claim Company Number'.
      * Field '(CTL) #PC3C7' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #2C0C7    PARM #2C0C7    WQ0057  70       Claim Number
     C           #PBIC3    PARM #PBIC3    WQ0058  30       Claim Company N
     C           #PC3C7    PARM #PC3C7    WQ0059  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VD999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVDMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    MKC0C7
     C           KLVDMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
     C           VD999     TAG
      * Restrictor relation not satisfied
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03584
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  14        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  14        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
      * USER: Exit program processing
      * DLT incomplete itemsShlEX - A/R Claim Product  * 
     C                     CLEARPCRC
     C                     Z-ADD#2C0C7    PCC0C7           Claim Number
      *
     C                     CALL 'PPLIXFR'              90  DLT incomplete
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: A/R Claim
     C           P4FESX    PARM *BLANK    WQ0060  1        Details Remaini
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPLIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * F3=Exit
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'EXT'     P5T6SX           Clm Program USR
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AFNX           Claim Item Line
     C                     Z-ADD*ZERO     P1DPNB           Order Sequence
     C                     Z-ADD*ZERO     P1UENB           Order Secondary
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P4DISX           Change Modes
     C                     Z-ADD*ZERO     P4CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     P4ATWG           Weight Shipped
     C                     Z-ADD*ZERO     P4H0WG           Average Weight
     C                     MOVEL*BLANK    P4FESX           Details Remaini
     C                     MOVEL*BLANK    P7G3TX           PRT Description
     C                     MOVEL*BLANK    P7WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P7WSST           PRT Hold Output
     C                     MOVEL*BLANK    P7WTST           PRT Save Output
     C                     Z-ADD*ZERO     P7DYNB           PRT Number of C
     C                     MOVEL*BLANK    P7WUST           PRT Night Queue
     C                     MOVEL*BLANK    P7BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P7M8NB           System Value Nu
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Define work field Reason Code
     C                     MOVEL*BLANK    WUCQCD  3
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Unused Parm - CD9     USR
     C                     MOVEL*BLANK    WUA6AA  9
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Clear all neither parameters
      * CRT A/R Claim ProductSACR - A/R Claim Product  * 
     C                     Z-ADD*ZERO     MOMJDT           Create Date
     C                     Z-ADD*ZERO     MOBETM           Create Time
     C                     Z-ADD*ZERO     MOMKDT           Change Date
     C                     Z-ADD*ZERO     MOBFTM           Change Time
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  2
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0024  3
     C                     MOVEL*BLANK    WL0025  3
     C                     MOVEL*BLANK    WL0026  3
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  2
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032 112
     C                     MOVEL*BLANK    WL0033  2
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038 112
     C                     Z-ADD*ZERO     WL0039 112
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  3
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0043  3
     C                     MOVEL*BLANK    WL0044  3
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  3
     C                     MOVEL*BLANK    WL0052  1
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054 20
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0057 10
     C                     MOVEL*BLANK    WL0058  6
     C                     Z-ADD*ZERO     WL0059  30
     C                     MOVEL*BLANK    WL0060  3
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field ORG TF Exempt Cde Usr
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Valid Item Type
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Valid Item Type
     C                     MOVEL*BLANK    YN0005  3
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0006  3
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0007  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Claim Department Desc
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0009  1
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0009 15
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0010  70
      * Define null work field Claim Department Desc
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Claim Department Desc
     C                     MOVEL*BLANK    YN0012 20
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0012  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR NKSUBR                     ***** Change Lo
      * *** Setup Security & Company Title ***
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL'OMS'     P3DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0018 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0018           User Profile Na
      *
     C                     MOVEL*BLANK    WN0019 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SVRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0018    ZA0057           User Profile Na
     C                     MOVELP3DNCD    ZA0058           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0019    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0018    WL0057    P      User Profile Na
     C                     MOVELP3DNCD    WL0058    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    P3AIC3           Company Number
     C                     MOVELWL0060    YL0012    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0019    WL0057    P      User Profile Na
     C                     MOVELP3DNCD    WL0058    P      Application Cod
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    P3AIC3           Company Number
     C                     MOVELWL0060    YL0012    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0012    P3AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0018    ZA0059           User Profile Na
     C                     MOVELP3DNCD    ZA0060           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0011    IFNE 0                          *IF
     C                     Z-ADDYL0011    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0012    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P3AJCD    PARM *BLANK    WQ0061  3        Warehouse Code
     C                     PARM YL0011    WQ0062  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SXRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
     C                     MOVEL'Y'       YL0006           First Time Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01052010600130801334015640159001820
01828020760208402562035860358803596
03605036140361903625036300363503638
03653036570367303676036900369303708
039440395103958
** W0END
01054010890131401346015700159601826
01857020770209602691035860359403603
03611036160362103627036300363503650
03653036690367303688036910370503709
039450395203959
** W0NAM
VPBIC3    #CSQTX    V2C0C7    #CAYVL    VPALNX    #PRMNB    VPC3C7
#PRFTX    #CQ2CD    #CDGU1    #2ST1     #1SEL     V1ALNX    #1RMNB
V1C1C7    #1N0CD    #RTPAA    #RG6AA    #1TNSX    #1QZSX    #1KUQT
#1VAST    #1HHWG    #1ANST    #1DIPR    #1HHCD    #1BNVL    #1Q0SX
#RXUSX    #RXVSX    #RXWSX
** @CN
00001 Y2U0005
00002 USR4855
00003 USR0752
00004 Claim Product Created
00005 CLMCHANGE
00006 Claim Product was deleted
00007 Claim Product was changed
00008 ISSMASO
00009 ALICEB
00010 PRKTEST
00011 ISPPATE
00012 ISRCENT
00013 ISLBUSE
