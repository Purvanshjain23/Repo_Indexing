      *****************  RPG PROGRAM HEADING  ************************
      *                                                              *
      * PROGRAM NUMBER..... - STATERET                               *
      *          DATE....... - 01/28/97                              *
      *          AUTHOR..... - BARB GUTIERREZ                        *
      *          DESCRIPTION - THIS PROGRAM IS CALLED FROM THE HPE   *
      *                        (HOG PROCUREMENT) SYSTEM.  IT IS      *
      *                        USED TO RETRIEVE THE STATE DESCRIPTION*
      *                        FROM THE STATE CODE THAT IS PASSED IN.*
      ****************************************************************
      *  REVISIONS                                                   *
      ****************************************************************
      *                                                              *
      *  7/31/2020 JBB - SDN465 - JDE World to Enterprise 1          *
      *                           Replace F0005 with OMS file        *
      *                           CAACREP to retrieve the State      *
      *                           Code Description using a 2-byte    *
      *                           State Code.                        *
      *  10/19/20 RMC DONT CHAIN OR ERROR IF STATE IS BLANK           *
      ****************************************************************
      /EJECT
      ****************************************************************
      *   F :             FILE SPECIFICATIONS                        *
      ****************************************************************
      /SPACE 2
     F*F0005   IF  E           K        DISK
      * JDE USER DEFINED CODES FILE   (KEY: DRSY,DRRT, DRKY)
      *
     FCAACREL1IF  E           K        DISK
      * OMS - State (Retrieval index) (KEY: ACBGC)
      *
      ****************************************************************
      *   C :             CALC SPECIFICATIONS                        *
      ****************************************************************
      *
      *   CHAIN TO USER DEFINED CODE FILE
      *
     C*          KEY       CHAINI0005                50
     C           STATE2    IFNE '  '
     C           STATE2    CHAINCAACREL1             50
     C           *IN50     IFEQ *OFF                       50 = OFF
     C                     MOVE *BLANKS   WKRETN  7
      *
     C*                    MOVELDRDL01    DESCR
     C                     MOVELACAUNA    DESCR
     C*
     C*  IF THE STATE PASSED IN DOES NOT EXIST IN JDE, MOVE ERR IN
     C*  RETURN FIELD AND BLANKS OUT PARMS.
     C*
     C                     ELSE                            50 = ON
     C                     MOVEL'ERR'     WKRETN
     C                     MOVE *BLANKS   DESCR
     C                     ENDIF                           50 = OFF
     C                     ENDIF                           50 = OFF
      *
      *  SETUP PARM FIELDS TO PASS BACK TO CALLING PROGRAM.
      *
     C                     MOVE WKRETN    RETRN
      *
     C                     MOVE *ON       *INLR
      *
      *--------------------------------------------------------------*
      *   *INZSR   INITIALIZATION ROUTINE                            *
      *--------------------------------------------------------------*
      *
     C           *INZSR    BEGSR
     C           *ENTRY    PLIST
     C                     PARM           RETRN   7
     C                     PARM           STATE   3
     C                     PARM           DESCR  30
      *
     C                     MOVEL'00'      WKSY    4
     C                     MOVEL'S '      WKRT    2
     C                     MOVE STATE     WKKY   10
     C                     MOVE *BLANKS   WKRETN  7
      *
     C           KEY       KLIST
     C                     KFLD           WKSY
     C                     KFLD           WKRT
     C                     KFLD           WKKY
      *
     C                     MOVELSTATE     STATE2  2
      *
     C                     ENDSR
