     H/TITLE Bld SAC/G72 Rcds/INV  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/25/18  Time  : 15:03:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPDICCPLEIF  E           K        DISK
      * RSQ : History Dtl Accrual       Co/Ord/Inpty/accde/ordse
      *
     FPBAWREL1IF  E           K        DISK
      * RTV : EDI Accrual Cde x-ref     Retrieval index
      *
     FPBAVCPL1IF  E           K        DISK
      * RTV : EDI Seg/Elem Map Values   Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FECP002D0IF  E           K        DISK                      A
      * UPD : EDI SAC/G72 Allow/Chg DTL Update index
      *
     FECP001D0IF  E           K        DISK                      A
      * UPD : EDI SAC/G72 Allow/Chg HDR Update index
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                          WAB0C7
     I              GQM4AA                          WAM4AA
     I              GQM7AA                          WAM7AA
     I              GQJ5NX                          WAJ5NX
     I              GQA8U1                          WAA8U1
     I              GQA9U1                          WAA9U1
     I              GQBAU1                          WABAU1
     I              GQBBU1                          WABBU1
     I              GQY4NY                          WAY4NY
     I              GQY5NY                          WAY5NY
     I              GQBFU1                          WABFU1
     I              GQBGU1                          WABGU1
     I              GQBHU1                          WABHU1
     I              GQBIU1                          WABIU1
     I              GQSIAA                          WASIAA
     I              GQSJAA                          WASJAA
     I              GQVSST                          WAVSST
     I              GQMJDT                          WAMJDT
     I              GQBETM                          WABETM
     I              GQCCVN                          WACCVN
     I              GQCDVN                          WACDVN
     I              GQMKDT                          WAMKDT
     I              GQBFTM                          WABFTM
     I              GQCEVN                          WACEVN
     I              GQCFVN                          WACFVN
      *
     I@ICCPPM
      * History Dtl Accrual       Co/Ord/Inpty/accde/ordse
      * Renamed input format fields
     I              ICAIC3                          WBAIC3
     I              ICC4NB                          WBC4NB
     I              ICDPNB                          WBDPNB
     I              ICUENB                          WBUENB
     I              ICDXNB                          WBDXNB
     I              ICBKPR                          WBBKPR
     I              ICAYVA                          WBAYVA
     I              ICEDVL                          WBEDVL
     I              ICHGCD                          WBHGCD
     I              ICBKC7                          WBBKC7
     I              ICPTDT                          WBPTDT
     I              ICBYWG                          WBBYWG
     I              ICBVST                          WBBVST
     I              ICP7SX                          WBP7SX
     I              ICOKCD                          WBOKCD
     I              ICQQSX                          WBQQSX
     I              ICQRSX                          WBQRSX
     I              ICFLTX                          WBFLTX
     I              ICQSSX                          WBQSSX
     I              ICPRDT                          WBPRDT
     I              ICPSDT                          WBPSDT
     I              ICEGVL                          WBEGVL
     I              ICEHVL                          WBEHVL
     I              ICAVNB                          WBAVNB
     I              ICDSCD                          WBDSCD
     I              ICFMTX                          WBFMTX
     I              ICFNTX                          WBFNTX
     I              ICQ9DT                          WBQ9DT
     I              ICFOTX                          WBFOTX
     I              ICH1NY                          WBH1NY
     I              ICKRT1                          WBKRT1
     I              ICKST1                          WBKST1
     I              ICHJAA                          WBHJAA
     I              ICHKAA                          WBHKAA
     I              ICHHAA                          WBHHAA
     I              ICOJCD                          WBOJCD
     I              ICAATM                          WBAATM
     I              ICAYNA                          WBAYNA
     I              ICA0NA                          WBA0NA
     I              ICAXDT                          WBAXDT
      *
     I@AWREPF
      * EDI Accrual Cde x-ref     Retrieval index
      * Renamed input format fields
     I              AWOJCD                          WCOJCD
     I              AWQBAA                          WCQBAA
     I              AWQCAA                          WCQCAA
     I              AWQDAA                          WCQDAA
      *
     I@AVCPPC
      * EDI Seg/Elem Map Values   Retrieval index
      * Renamed input format fields
     I              AVQBAA                          WDQBAA
     I              AVQCAA                          WDQCAA
     I              AVQDAA                          WDQDAA
     I              AVZ6T1                          WDZ6T1
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WEOJCD
     I              HLLENA                          WELENA
     I              HLTOST                          WETOST
     I              HLTQST                          WETQST
     I              HLTRST                          WETRST
     I              HLTSST                          WETSST
     I              HLOKCD                          WEOKCD
     I              HLTYST                          WETYST
     I              HLOQCD                          WEOQCD
     I              HLHHCD                          WEHHCD
     I              HLI2TX                          WEI2TX
     I              HLJFTX                          WEJFTX
     I              HLI3TX                          WEI3TX
     I              HLJGTX                          WEJGTX
     I              HLLEDG                          WELEDG
     I              HLTTST                          WETTST
     I              HLBKPR                          WEBKPR
     I              HLSHSX                          WESHSX
     I              HLQFSX                          WEQFSX
     I              HLFDTX                          WEFDTX
     I              HLFETX                          WEFETX
     I              HLFFTX                          WEFFTX
     I              HLFGTX                          WEFGTX
     I              HLHQVL                          WEHQVL
     I              HLFHTX                          WEFHTX
     I              HLUVST                          WEUVST
     I              HLUWST                          WEUWST
     I              HLUXST                          WEUXST
     I              HLVSST                          WEVSST
     I              HLAATM                          WEAATM
     I              HLAYNA                          WEAYNA
     I              HLA0NA                          WEA0NA
     I              HLAXDT                          WEAXDT
      *
     I@AYCPPK
      * EDI SAC/G72 Allow/Chg DTL Update index
      * Renamed input format fields
     I              AYH9NY                          WFH9NY
     I              AYIJNY                          WFIJNY
     I              AYIKNY                          WFIKNY
     I              AYC4NY                          WFC4NY
     I              AYQVST                          WFQVST
     I              AYQHAA                          WFQHAA
     I              AYQIAA                          WFQIAA
     I              AYZ8T1                          WFZ8T1
     I              AYMQVL                          WFMQVL
     I              AYQKAA                          WFQKAA
     I              AYG6PC                          WFG6PC
     I              AYMTVL                          WFMTVL
     I              AYC2C3                          WFC2C3
     I              AYMSVL                          WFMSVL
     I              AYQXQT                          WFQXQT
     I              AYQEAA                          WFQEAA
     I              AYZ9T1                          WFZ9T1
     I              AYZ9T2                          WFZ9T2
     I              AYZ7T1                          WFZ7T1
     I              AYUINA                          WFUINA
     I              AYXHNY                          WFXHNY
     I              AYXINY                          WFXINY
     I              AYMUVL                          WFMUVL
      *
     I@AXCPPH
      * EDI SAC/G72 Allow/Chg HDR Update index
      * Renamed input format fields
     I              AXH9NY                          WGH9NY
     I              AXQHAA                          WGQHAA
     I              AXQEAA                          WGQEAA
     I              AXUONY                          WGUONY
     I              AXQVST                          WGQVST
     I              AXQIAA                          WGQIAA
     I              AXZ8T1                          WGZ8T1
     I              AXMQVL                          WGMQVL
     I              AXQKAA                          WGQKAA
     I              AXG6PC                          WGG6PC
     I              AXMTVL                          WGMTVL
     I              AXC2C3                          WGC2C3
     I              AXMSVL                          WGMSVL
     I              AXQXQT                          WGQXQT
     I              AXUHNA                          WGUHNA
     I              AXZ9T1                          WGZ9T1
     I              AXZ9T2                          WGZ9T2
     I              AXUINA                          WGUINA
     I              AXXHNY                          WGXHNY
     I              AXXINY                          WGXINY
     I              AXMUVL                          WGMUVL
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQECP01    E DSECP002D0
      * UPD : EDI SAC/G72 Allow/Chg DTL Update index
      * Renamed input format fields
     I              AYH9NY                          WFH9NY
     I              AYIJNY                          WFIJNY
     I              AYIKNY                          WFIKNY
     I              AYC4NY                          WFC4NY
     I              AYQVST                          WFQVST
     I              AYQHAA                          WFQHAA
     I              AYQIAA                          WFQIAA
     I              AYZ8T1                          WFZ8T1
     I              AYMQVL                          WFMQVL
     I              AYQKAA                          WFQKAA
     I              AYG6PC                          WFG6PC
     I              AYMTVL                          WFMTVL
     I              AYC2C3                          WFC2C3
     I              AYMSVL                          WFMSVL
     I              AYQXQT                          WFQXQT
     I              AYQEAA                          WFQEAA
     I              AYZ9T1                          WFZ9T1
     I              AYZ9T2                          WFZ9T2
     I              AYZ7T1                          WFZ7T1
     I              AYUINA                          WFUINA
     I              AYXHNY                          WFXHNY
     I              AYXINY                          WFXINY
     I              AYMUVL                          WFMUVL
      *
     IQECP02    E DSECP001D0
      * UPD : EDI SAC/G72 Allow/Chg HDR Update index
      * Renamed input format fields
     I              AXH9NY                          WGH9NY
     I              AXQHAA                          WGQHAA
     I              AXQEAA                          WGQEAA
     I              AXUONY                          WGUONY
     I              AXQVST                          WGQVST
     I              AXQIAA                          WGQIAA
     I              AXZ8T1                          WGZ8T1
     I              AXMQVL                          WGMQVL
     I              AXQKAA                          WGQKAA
     I              AXG6PC                          WGG6PC
     I              AXMTVL                          WGMTVL
     I              AXC2C3                          WGC2C3
     I              AXMSVL                          WGMSVL
     I              AXQXQT                          WGQXQT
     I              AXUHNA                          WGUHNA
     I              AXZ9T1                          WGZ9T1
     I              AXZ9T2                          WGZ9T2
     I              AXUINA                          WGUINA
     I              AXXHNY                          WGXHNY
     I              AXXINY                          WGXINY
     I              AXMUVL                          WGMUVL
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I : RST Order Number
     I                                    P   1   40P2C4NB
     IP3PARM      DS
      * I :  EDI SURROGATE NUMBER
     I                                    P   1   50P3H9NY
     IP4PARM      DS
      * I :  Bill to Customer
     I                                    P   1   40P4B0C7
     IP5PARM      DS
      * B :  EDI File Set
     I                                        1  10 P5A8U1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2C4NB    PARM           WP0002  70       Order Number
     C           P3H9NY    PARM           WP0003  90       EDI SURROGATE N
     C           P4B0C7    PARM           WP0004  70       Bill to Custome
     C           P5A8U1    PARM P5A8U1    WP0005 10        EDI File Set
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld SAC/G72 Rcds/INV  XF
      * Get EDI Invoice Class for BT Customer
      * RTV BT Intrchg Class  RT - EDI Bill To Interchange  * 
     C                     EXSR SARVGN
      * Process all Item line Accruals  Invoice Print type = "IT"
      * Rtv Accrual Type/Cde  RT - History Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP2C4NB    WL0002           Order Number
     C                     MOVEL'IT'      WL0003    P      HDA Invoice Pri
     C                     Z-ADDP3H9NY    WL0004           EDI SURROGATE N
     C                     Z-ADDP4B0C7    WL0005           Bill to Custome
     C                     MOVELYL0001    WL0006    P      Class Code
     C                     EXSR SBRVGN
      * Process all Invoice Total Accruals  Invoice print type = "IN"
      * Rtv Accrual Type/Cde  RT - History Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP2C4NB    WL0002           Order Number
     C                     MOVEL'IN'      WL0003    P      HDA Invoice Pri
     C                     Z-ADDP3H9NY    WL0004           EDI SURROGATE N
     C                     Z-ADDP4B0C7    WL0005           Bill to Custome
     C                     MOVELYL0001    WL0006    P      Class Code
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV BT Intrchg Class  RT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAB0C7           Bill to Custome
     C                     KFLD           WAM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDP4B0C7    WAB0C7           Bill to Custome
     C                     MOVE *BLANK    WAM4AA           Interchange Cod
     C                     MOVEL'IN'      WAM4AA           Interchange Cod
      * Establish starting position
     C           KRSSA     CHAIN@GQREH2              90    *
      * Data record not found
     C   90                MOVEL'USR4373' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAM7AA    YL0001           Class Code
     C                     MOVELWAA8U1    P5A8U1           EDI File Set
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Accrual Type/Cde  RT - History Dtl Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Order Sequence
     C                     Z-ADD*ZERO     WN0002  30       Order Secondary
     C                     Z-ADD*ZERO     WN0003  30       Sequence Number
     C                     Z-ADD*ZERO     WN0004  30       IT101-PO LINE I
     C                     Z-ADD*ZERO     WN0005  30       IT101-PO LINE I
     C                     Z-ADD*ZERO     WN0006  50       ITD Sequence Nu
     C                     MOVEL*BLANK    WN0007  1        S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0008  4        S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0009  2        S3 Agency Quali
     C                     MOVEL*BLANK    WN0010 10        S4 Agency Servc
     C                     Z-ADD*ZERO     WN0011 152       S5/G8 Amount
     C                     MOVEL*BLANK    WN0012  6        S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0013  52       S7/G9 Percent
     C                     Z-ADD*ZERO     WN0014 112       S8/G5 Rate
     C                     Z-ADD*ZERO     WN0015  30       S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0016 150       S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0017 150       S11 Quantity
     C                     MOVEL*BLANK    WN0018  2        S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0019 30        S13 Ref ID
     C                     MOVEL*BLANK    WN0020 20        S14/G11 Option
     C                     MOVEL*BLANK    WN0021 25        S15 Description
     C                     MOVEL*BLANK    WN0022  3        S16 Language Co
     C                     MOVEL*BLANK    WN0023 16        G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0024 160       G4 Exception Nb
     C                     Z-ADD*ZERO     WN0025  90       G10 Dollar Basi
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Maintenance:
      * 6/19/18 SZ Fixed parm to rtv the G73 description
      * 7/15/16 SZ changed pgm to rtv the S1 Allow/Chg Indicator
      * 4/12/16 SZ Added the rate to update the Allow/Chg detail
      * 4/11/16 SZ Fixed parms to rtv the 880 codes.
      * 6/3/15 SZ add parm Element val to EDI Seg/Elem Map Values to get
      *           the description.
     C                     MOVEL'Y'       YL0002           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
     C           *LIKE     DEFN WBQSSX    WQSB03           HDA Invoice Pri
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           HDA Invoice Pri
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WQSB02           Order Number
     C                     MOVELWL0003    WQSB03           HDA Invoice Pri
      * Establish starting position
     C           KRSSB     SETLL@ICCPPM                    *
     C           KRSSB     READE@ICCPPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1655' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Order Sequence
     C                     Z-ADD*ZERO     WN0002           Order Secondary
     C                     Z-ADD*ZERO     WN0003           Sequence Number
     C                     Z-ADD*ZERO     WN0004           IT101-PO LINE I
     C                     Z-ADD*ZERO     WN0005           IT101-PO LINE I
     C                     Z-ADD*ZERO     WN0006           ITD Sequence Nu
     C                     MOVEL*BLANK    WN0007           S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0008           S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0009           S3 Agency Quali
     C                     MOVEL*BLANK    WN0010           S4 Agency Servc
     C                     Z-ADD*ZERO     WN0011           S5/G8 Amount
     C                     MOVEL*BLANK    WN0012           S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0013           S7/G9 Percent
     C                     Z-ADD*ZERO     WN0014           S8/G5 Rate
     C                     Z-ADD*ZERO     WN0015           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0016           S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0017           S11 Quantity
     C                     MOVEL*BLANK    WN0018           S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0019           S13 Ref ID
     C                     MOVEL*BLANK    WN0020           S14/G11 Option
     C                     MOVEL*BLANK    WN0021           S15 Description
     C                     MOVEL*BLANK    WN0022           S16 Language Co
     C                     MOVEL*BLANK    WN0023           G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0024           G4 Exception Nb
     C                     Z-ADD*ZERO     WN0025           G10 Dollar Basi
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PROCESS IF ITEM ACCRUAL
     C                     EXSR UASUBR                     PROCESS IF ITEM
      * Process IF Invoice Total Accruals
     C                     EXSR UCSUBR                     Process IF Invo
     C           KRSSB     READE@ICCPPM                  90*
     C                     ENDDO
      * USER: Exit processing
      * LAST RECORD PROCESSING Header Accruals
      * CASE: LCL.First Time Flag is NO
     C           YL0002    IFEQ 'N'                        *IF
      * CASE: PAR.HDA Invoice Print Type is Invoice Total
     C           WL0003    IFEQ 'IN'                       *IF
      * Populate the 880 Invoice G72 fields
      * CASE: PAR.Class Code is Grocery Invoice
     C           WL0006    IFEQ '880'                      *IF
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD1         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'G72'     WL0011    P      Segment
     C                     Z-ADD1         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0007           ENT01-SEQUENCE
     C                     Z-ADDYL0006    WN0011           S5/G8 Amount
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0049           EDI SURROGATE N
     C                     MOVELWN0008    WL0050    P      S2/G1 Allow/Chg
     C                     MOVELWN0018    WL0051    P      S12/G2 All/Chg
     C                     Z-ADDYL0007    WL0052           ENT01-SEQUENCE
     C                     MOVELWN0007    WL0053    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0054           S3 Agency Quali
     C                     MOVEL*BLANK    WL0055           S4 Agency Servc
     C                     Z-ADDWN0011    WL0056           S5/G8 Amount
     C                     MOVEL*BLANK    WL0057           S6 Allow/Chrge
     C                     Z-ADD0         WL0058           S7/G9 Percent
     C                     Z-ADD0         WL0059           S8/G5 Rate
     C                     Z-ADD0         WL0060           S9/G7 Unit or B
     C                     Z-ADD0         WL0061           S10/G6 Quantity
     C                     Z-ADD0         WL0062           S11 Quantity
     C                     MOVELYL0003    WL0063    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0064           S13 Ref ID
     C                     MOVEL*BLANK    WL0065           S14/G11 Option
     C                     MOVEL*BLANK    WL0066           S16 Language Co
     C                     MOVEL*BLANK    WL0067           G3 Allow/Chg NB
     C                     Z-ADD0         WL0068           G4 Exception Nb
     C                     Z-ADD0         WL0069           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Populate the 810 Invoice SAC fields
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0011    P      Segment
     C                     Z-ADD2         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD12        WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
      * Get Allow or Charge Indicator
     C                     EXSR UFSUBR                     Get Allow or Ch
     C                     ADD  1         YL0007           ENT01-SEQUENCE
     C                     Z-ADDYL0006    WN0011           S5/G8 Amount
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0049           EDI SURROGATE N
     C                     MOVELWN0008    WL0050    P      S2/G1 Allow/Chg
     C                     MOVELWN0018    WL0051    P      S12/G2 All/Chg
     C                     Z-ADDYL0007    WL0052           ENT01-SEQUENCE
     C                     MOVELWN0007    WL0053    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0054           S3 Agency Quali
     C                     MOVEL*BLANK    WL0055           S4 Agency Servc
     C                     Z-ADDWN0011    WL0056           S5/G8 Amount
     C                     MOVEL*BLANK    WL0057           S6 Allow/Chrge
     C                     Z-ADD0         WL0058           S7/G9 Percent
     C                     Z-ADD0         WL0059           S8/G5 Rate
     C                     Z-ADD0         WL0060           S9/G7 Unit or B
     C                     Z-ADD0         WL0061           S10/G6 Quantity
     C                     Z-ADD0         WL0062           S11 Quantity
     C                     MOVELYL0003    WL0063    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0064           S13 Ref ID
     C                     MOVEL*BLANK    WL0065           S14/G11 Option
     C                     MOVEL*BLANK    WL0066           S16 Language Co
     C                     MOVEL*BLANK    WL0067           G3 Allow/Chg NB
     C                     Z-ADD0         WL0068           G4 Exception Nb
     C                     Z-ADD0         WL0069           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCOJCD    WQSC01           Accrual Code
     C           *LIKE     DEFN WCQBAA    WQSC02           Segment
     C           *LIKE     DEFN WCQCAA    WQSC03           Element Positio
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Accrual Code
     C                     KFLD           WQSC02           Segment
     C                     KFLD           WQSC03           Element Positio
      * Setup key
     C                     MOVELWL0007    WQSC01           Accrual Code
     C                     MOVELWL0008    WQSC02           Segment
     C                     Z-ADDWL0009    WQSC03           Element Positio
      * Establish starting position
     C           KRSSC     SETLL@AWREPF                    *
     C           KRSSC     READE@AWREPF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4577' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Element Value
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCQDAA    WL0010           Element Value
     C           KRSSC     READE@AWREPF                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDQBAA           Segment
     C                     KFLD           WDQCAA           Element Positio
     C                     KFLD           WDQDAA           Element Value
      * Setup key
     C                     MOVELWL0011    WDQBAA           Segment
     C                     Z-ADDWL0012    WDQCAA           Element Positio
     C                     MOVELWL0013    WDQDAA           Element Value
      * Establish starting position
     C           KRSSD     CHAIN@AVCPPC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4573' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Element Value D
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDZ6T1    WL0014           Element Value D
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0015    WEOJCD           Accrual Code
      * Establish starting position
     C           KRSSE     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           Accrual Descrip
     C                     MOVEL*BLANK    WL0017           Automatic Accru
     C                     MOVEL*BLANK    WL0018           Print On Invoic
     C                     MOVEL*BLANK    WL0019           Rate Usage
     C                     MOVEL*BLANK    WL0020           Add-on/Allowanc
     C                     MOVEL*BLANK    WL0021           Accrual Type
     C                     MOVEL*BLANK    WL0022           Sub Ledger Code
     C                     MOVEL*BLANK    WL0023           Reverse Accrual
     C                     MOVEL*BLANK    WL0024           U/M - Primary D
     C                     MOVEL*BLANK    WL0025           Affect Invoice
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWELENA    WL0016           Accrual Descrip
     C                     MOVELWETOST    WL0017           Automatic Accru
     C                     MOVELWETQST    WL0018           Print On Invoic
     C                     MOVELWETRST    WL0019           Rate Usage
     C                     MOVELWETSST    WL0020           Add-on/Allowanc
     C                     MOVELWEOKCD    WL0021           Accrual Type
     C                     MOVELWETYST    WL0022           Sub Ledger Code
     C                     MOVELWEOQCD    WL0023           Reverse Accrual
     C                     MOVELWEHHCD    WL0024           U/M - Primary D
     C                     MOVELWEFFTX    WL0025           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg DTL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AYCPPK
     C                     Z-ADDWL0026    WFH9NY           EDI SURROGATE N
     C                     Z-ADDWL0027    WFIJNY           IT101-PO LINE I
     C                     Z-ADDWL0028    WFIKNY           IT101-PO LINE I
     C                     Z-ADDWL0029    WFC4NY           ITD Sequence Nu
     C                     MOVELWL0030    WFQVST           S1 Allow/Chg In
     C                     MOVELWL0031    WFQHAA           S2/G1 Allow/Chg
     C                     MOVELWL0032    WFQIAA           S3 Agency Quali
     C                     MOVELWL0033    WFZ8T1           S4 Agency Servc
     C                     Z-ADDWL0034    WFMQVL           S5/G8 Amount
     C                     MOVELWL0035    WFQKAA           S6 Allow/Chrge
     C                     Z-ADDWL0036    WFG6PC           S7/G9 Percent
     C                     Z-ADDWL0037    WFMTVL           S8/G5 Rate
     C                     Z-ADDWL0038    WFC2C3           S9/G7 Unit or B
     C                     Z-ADDWL0039    WFMSVL           S10/G6 Quantity
     C                     Z-ADDWL0040    WFQXQT           S11 Quantity
     C                     MOVELWL0041    WFQEAA           S12/G2 All/Chg
     C                     MOVELWL0042    WFZ9T1           S13 Ref ID
     C                     MOVELWL0043    WFZ9T2           S14/G11 Option
     C                     MOVELWL0044    WFZ7T1           S15 Description
     C                     MOVELWL0045    WFUINA           S16 Language Co
     C                     MOVELWL0046    WFXHNY           G3 Allow/Chg NB
     C                     Z-ADDWL0047    WFXINY           G4 Exception Nb
     C                     Z-ADDWL0048    WFMUVL           G10 Dollar Basi
      *
     C           KLCRSF    KLIST
     C                     KFLD           WFH9NY           EDI SURROGATE N
     C                     KFLD           WFIJNY           IT101-PO LINE I
     C                     KFLD           WFIKNY           IT101-PO LINE I
     C                     KFLD           WFC4NY           ITD Sequence Nu
      * Check for duplicate primary key
     C           KLCRSF    SETLL@AYCPPK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4582' W0RTN   7
      * Send message 'EDI SAC/G72 All2061619'
     C                     MOVEL'USR4582' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@AYCPPK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AXCPPH
     C                     Z-ADDWL0049    WGH9NY           EDI SURROGATE N
     C                     MOVELWL0050    WGQHAA           S2/G1 Allow/Chg
     C                     MOVELWL0051    WGQEAA           S12/G2 All/Chg
     C                     Z-ADDWL0052    WGUONY           ENT01-SEQUENCE
     C                     MOVELWL0053    WGQVST           S1 Allow/Chg In
     C                     MOVELWL0054    WGQIAA           S3 Agency Quali
     C                     MOVELWL0055    WGZ8T1           S4 Agency Servc
     C                     Z-ADDWL0056    WGMQVL           S5/G8 Amount
     C                     MOVELWL0057    WGQKAA           S6 Allow/Chrge
     C                     Z-ADDWL0058    WGG6PC           S7/G9 Percent
     C                     Z-ADDWL0059    WGMTVL           S8/G5 Rate
     C                     Z-ADDWL0060    WGC2C3           S9/G7 Unit or B
     C                     Z-ADDWL0061    WGMSVL           S10/G6 Quantity
     C                     Z-ADDWL0062    WGQXQT           S11 Quantity
     C                     MOVELWL0063    WGUHNA           S15 Allow/Chg D
     C                     MOVELWL0064    WGZ9T1           S13 Ref ID
     C                     MOVELWL0065    WGZ9T2           S14/G11 Option
     C                     MOVELWL0066    WGUINA           S16 Language Co
     C                     MOVELWL0067    WGXHNY           G3 Allow/Chg NB
     C                     Z-ADDWL0068    WGXINY           G4 Exception Nb
     C                     Z-ADDWL0069    WGMUVL           G10 Dollar Basi
      *
     C           KLCRSG    KLIST
     C                     KFLD           WGH9NY           EDI SURROGATE N
     C                     KFLD           WGQHAA           S2/G1 Allow/Chg
     C                     KFLD           WGQEAA           S12/G2 All/Chg
      * Check for duplicate primary key
     C           KLCRSG    SETLL@AXCPPH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4580' W0RTN   7
      * Send message 'EDI SAC/G72 Allow/Chg  EX'
     C                     MOVEL'USR4580' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@AXCPPH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * PROCESS IF ITEM ACCRUAL
      *================================================================
      * CASE: PAR.HDA Invoice Print Type is Item
     C           WL0003    IFEQ 'IT'                       *IF
      * Populate the 880 Invoice G72 fields
      * CASE: PAR.Class Code is Grocery Invoice
     C           WL0006    IFEQ '880'                      *IF
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD1         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Get the Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'G72'     WL0011    P      Segment
     C                     Z-ADD1         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * Retrieve allow/chg Indicator
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBAYVA    WN0011           S5/G8 Amount
     C                     Z-ADDWBBKPR    WN0014           S8/G5 Rate
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg DTL  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0026           EDI SURROGATE N
     C                     Z-ADDWBDPNB    WL0027           IT101-PO LINE I
     C                     Z-ADDWBUENB    WL0028           IT101-PO LINE I
     C                     Z-ADDWBDXNB    WL0029           ITD Sequence Nu
     C                     MOVELWN0007    WL0030    P      S1 Allow/Chg In
     C                     MOVELWN0008    WL0031    P      S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WL0032           S3 Agency Quali
     C                     MOVEL*BLANK    WL0033           S4 Agency Servc
     C                     Z-ADDWN0011    WL0034           S5/G8 Amount
     C                     MOVEL*BLANK    WL0035           S6 Allow/Chrge
     C                     Z-ADD0         WL0036           S7/G9 Percent
     C                     Z-ADDWBBKPR    WL0037           S8/G5 Rate
     C                     Z-ADD0         WL0038           S9/G7 Unit or B
     C                     Z-ADD0         WL0039           S10/G6 Quantity
     C                     Z-ADD0         WL0040           S11 Quantity
     C                     MOVELWN0018    WL0041    P      S12/G2 All/Chg
     C                     MOVEL*BLANK    WL0042           S13 Ref ID
     C                     MOVEL*BLANK    WL0043           S14/G11 Option
     C                     MOVELYL0003    WL0044    P      S15 Description
     C                     MOVEL*BLANK    WL0045           S16 Language Co
     C                     MOVEL*BLANK    WL0046           G3 Allow/Chg NB
     C                     Z-ADD0         WL0047           G4 Exception Nb
     C                     Z-ADD0         WL0048           G10 Dollar Basi
     C                     EXSR SFCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Populate the 810 Invoice SAC fields
      * Class code is Invoice 810
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Get the Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0011    P      Segment
     C                     Z-ADD2         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD12        WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
     C                     Z-ADDWBAYVA    WN0011           S5/G8 Amount
      * Get Allow or Charge Indicator
     C                     EXSR UBSUBR                     Get Allow or Ch
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg DTL  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0026           EDI SURROGATE N
     C                     Z-ADDWBDPNB    WL0027           IT101-PO LINE I
     C                     Z-ADDWBUENB    WL0028           IT101-PO LINE I
     C                     Z-ADDWBDXNB    WL0029           ITD Sequence Nu
     C                     MOVELWN0007    WL0030    P      S1 Allow/Chg In
     C                     MOVELWN0008    WL0031    P      S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WL0032           S3 Agency Quali
     C                     MOVEL*BLANK    WL0033           S4 Agency Servc
     C                     Z-ADDWN0011    WL0034           S5/G8 Amount
     C                     MOVEL*BLANK    WL0035           S6 Allow/Chrge
     C                     Z-ADD0         WL0036           S7/G9 Percent
     C                     Z-ADDWBBKPR    WL0037           S8/G5 Rate
     C                     Z-ADD0         WL0038           S9/G7 Unit or B
     C                     Z-ADD0         WL0039           S10/G6 Quantity
     C                     Z-ADD0         WL0040           S11 Quantity
     C                     MOVELWN0018    WL0041    P      S12/G2 All/Chg
     C                     MOVEL*BLANK    WL0042           S13 Ref ID
     C                     MOVEL*BLANK    WL0043           S14/G11 Option
     C                     MOVELYL0003    WL0044    P      S15 Description
     C                     MOVEL*BLANK    WL0045           S16 Language Co
     C                     MOVEL*BLANK    WL0046           G3 Allow/Chg NB
     C                     Z-ADD0         WL0047           G4 Exception Nb
     C                     Z-ADD0         WL0048           G10 Dollar Basi
     C                     EXSR SFCRRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get Allow or Charge Indicator
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Process IF Invoice Total Accruals
      *================================================================
      * CASE: PAR.HDA Invoice Print Type is Invoice Total
     C           WL0003    IFEQ 'IN'                       *IF
      * First time processing
      * CASE: LCL.First Time Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVELWBOJCD    YL0005           Accrual Code
     C                     MOVEL'N'       YL0002           First Time Flag
     C                     END                             *FI
      * Break on the Accrual code
      * CASE: LCL.Accrual Code NE DB1.Accrual Code
     C           YL0005    IFNE WBOJCD                     *IF
      * Populate the 880 Invoice G72 fields
      * CASE: PAR.Class Code is Grocery Invoice
     C           WL0006    IFEQ '880'                      *IF
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD1         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Get Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'G72'     WL0011    P      Segment
     C                     Z-ADD1         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'G72'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
      * Get Allow or Charge Indicator
     C                     EXSR UDSUBR                     Get Allow or Ch
     C                     Z-ADDYL0006    WN0011           S5/G8 Amount
     C                     ADD  1         YL0007           ENT01-SEQUENCE
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0049           EDI SURROGATE N
     C                     MOVELWN0008    WL0050    P      S2/G1 Allow/Chg
     C                     MOVELWN0018    WL0051    P      S12/G2 All/Chg
     C                     Z-ADDYL0007    WL0052           ENT01-SEQUENCE
     C                     MOVELWN0007    WL0053    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0054           S3 Agency Quali
     C                     MOVEL*BLANK    WL0055           S4 Agency Servc
     C                     Z-ADDWN0011    WL0056           S5/G8 Amount
     C                     MOVEL*BLANK    WL0057           S6 Allow/Chrge
     C                     Z-ADD0         WL0058           S7/G9 Percent
     C                     Z-ADD0         WL0059           S8/G5 Rate
     C                     Z-ADD0         WL0060           S9/G7 Unit or B
     C                     Z-ADD0         WL0061           S10/G6 Quantity
     C                     Z-ADD0         WL0062           S11 Quantity
     C                     MOVELYL0003    WL0063    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0064           S13 Ref ID
     C                     MOVEL*BLANK    WL0065           S14/G11 Option
     C                     MOVEL*BLANK    WL0066           S16 Language Co
     C                     MOVEL*BLANK    WL0067           G3 Allow/Chg NB
     C                     Z-ADD0         WL0068           G4 Exception Nb
     C                     Z-ADD0         WL0069           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     Z-ADD0         YL0006           Extended Amount
     C                     MOVELWBOJCD    YL0005           Accrual Code
     C                     ELSE
      * CASE: *OTHERWISE
      * Populate the 810 Invoice SAC fields
      * Class code is Invoice 810
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD2         WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0008    P      Element Value
      * Get Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0011    P      Segment
     C                     Z-ADD2         WL0012           Element Positio
     C                     MOVELWN0008    WL0013    P      Element Value
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0003    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0007    P      Accrual Code
     C                     MOVEL'SAC'     WL0008    P      Segment
     C                     Z-ADD12        WL0009           Element Positio
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0018    P      Element Value
      * Get Allow or Charge Indicator
     C                     EXSR UESUBR                     Get Allow or Ch
     C                     ADD  1         YL0007           ENT01-SEQUENCE
     C                     Z-ADDYL0006    WN0011           S5/G8 Amount
      * CRT EDI SAC/G72 Allow/CR - EDI SAC/G72 Allow/Chg HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0004    WL0049           EDI SURROGATE N
     C                     MOVELWN0008    WL0050    P      S2/G1 Allow/Chg
     C                     MOVELWN0018    WL0051    P      S12/G2 All/Chg
     C                     Z-ADDYL0007    WL0052           ENT01-SEQUENCE
     C                     MOVELWN0007    WL0053    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0054           S3 Agency Quali
     C                     MOVEL*BLANK    WL0055           S4 Agency Servc
     C                     Z-ADDWN0011    WL0056           S5/G8 Amount
     C                     MOVEL*BLANK    WL0057           S6 Allow/Chrge
     C                     Z-ADD0         WL0058           S7/G9 Percent
     C                     Z-ADD0         WL0059           S8/G5 Rate
     C                     Z-ADD0         WL0060           S9/G7 Unit or B
     C                     Z-ADD0         WL0061           S10/G6 Quantity
     C                     Z-ADD0         WL0062           S11 Quantity
     C                     MOVELYL0003    WL0063    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0064           S13 Ref ID
     C                     MOVEL*BLANK    WL0065           S14/G11 Option
     C                     MOVEL*BLANK    WL0066           S16 Language Co
     C                     MOVEL*BLANK    WL0067           G3 Allow/Chg NB
     C                     Z-ADD0         WL0068           G4 Exception Nb
     C                     Z-ADD0         WL0069           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     Z-ADD0         YL0006           Extended Amount
     C                     MOVELWBOJCD    YL0005           Accrual Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WBAYVA    YL0006           Extended Amount
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Get Allow or Charge Indicator
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get Allow or Charge Indicator
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Get Allow or Charge Indicator
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBOJCD    WL0015    P      Accrual Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YN0001    P      Accrual Descrip
     C                     MOVELWL0017    YN0002    P      Automatic Accru
     C                     MOVELWL0018    YN0003    P      Print On Invoic
     C                     MOVELWL0019    YN0004    P      Rate Usage
     C                     MOVELWL0020    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0021    YN0005    P      Accrual Type
     C                     MOVELWL0022    YN0006    P      Sub Ledger Code
     C                     MOVELWL0023    YN0007    P      Reverse Accrual
     C                     MOVELWL0024    YN0008    P      U/M - Primary D
     C                     MOVELWL0025    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WN0007           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       WN0007           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAY4NY           EDI Alt ST Cust
     C                     Z-ADD*ZERO     WAY5NY           EDI unused nbr
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBPTDT           HDA Actual Ship
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBPRDT           HDA SA Week End
     C                     Z-ADD*ZERO     WBPSDT           HDA Atch to Ord
     C                     Z-ADD*ZERO     WBEGVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WBEHVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WBQ9DT           HDA Invoice Dat
     C                     Z-ADD*ZERO     WBH1NY           HDA G/L Sub Led
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCQCAA           Element Positio
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDQCAA           Element Positio
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WEHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WFIJNY           IT101-PO LINE I
     C                     Z-ADD*ZERO     WFIKNY           IT101-PO LINE I
     C                     Z-ADD*ZERO     WFC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WFMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WFG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WFMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WFC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WFMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WFQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WFXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WFMUVL           G10 Dollar Basi
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WGUONY           ENT01-SEQUENCE
     C                     Z-ADD*ZERO     WGMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WGG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WGMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WGC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WGMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WGQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WGXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WGMUVL           G10 Dollar Basi
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  90
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  3
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  6
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0011  3
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  6
     C                     MOVEL*BLANK    WL0014 50
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0015  3
     C                     MOVEL*BLANK    WL0016 30
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024  2
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0026  90
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  50
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  4
     C                     MOVEL*BLANK    WL0032  2
     C                     MOVEL*BLANK    WL0033 10
     C                     Z-ADD*ZERO     WL0034 152
     C                     MOVEL*BLANK    WL0035  6
     C                     Z-ADD*ZERO     WL0036  52
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039 150
     C                     Z-ADD*ZERO     WL0040 150
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042 30
     C                     MOVEL*BLANK    WL0043 20
     C                     MOVEL*BLANK    WL0044 25
     C                     MOVEL*BLANK    WL0045  3
     C                     MOVEL*BLANK    WL0046 16
     C                     Z-ADD*ZERO     WL0047 160
     C                     Z-ADD*ZERO     WL0048  90
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0049  90
     C                     MOVEL*BLANK    WL0050  4
     C                     MOVEL*BLANK    WL0051  2
     C                     Z-ADD*ZERO     WL0052  60
     C                     MOVEL*BLANK    WL0053  1
     C                     MOVEL*BLANK    WL0054  2
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056 152
     C                     MOVEL*BLANK    WL0057  6
     C                     Z-ADD*ZERO     WL0058  52
     C                     Z-ADD*ZERO     WL0059 112
     C                     Z-ADD*ZERO     WL0060  30
     C                     Z-ADD*ZERO     WL0061 150
     C                     Z-ADD*ZERO     WL0062 150
     C                     MOVEL*BLANK    WL0063 25
     C                     MOVEL*BLANK    WL0064 30
     C                     MOVEL*BLANK    WL0065 20
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067 16
     C                     Z-ADD*ZERO     WL0068 160
     C                     Z-ADD*ZERO     WL0069  90
      * Define local work field Class Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Element Value Definition
     C                     MOVEL*BLANK    YL0003 50
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Affect Invoice Price
     C                     MOVEL*BLANK    YN0009  1
      * Define local work field Accrual Code
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field ENT01-SEQUENCE #
     C                     Z-ADD*ZERO     YL0007  60
      *================================================================
     CSR         ZZEXIT    ENDSR
