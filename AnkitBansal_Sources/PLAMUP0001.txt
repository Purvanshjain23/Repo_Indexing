/*********************************************************************/
/* PROGRAM    : PLAMUPC                                              */
/* TITLE      : EMAIL LOAD COMFIRMATION TO CARRIER                   */
/* DATE       : 08/21/2006                                           */
/* Description: EXECUTE THE ESNDNMAIL COMMAND TO SEND A LOAD         */
/*                CONFIRMATION TO THE CARRIER                        */
/*                                                                   */
/*  Parameters:                                                      */
/*  Usage   Field       Field Description                            */
/*  -----   ---------   ------------------------------------------   */
/*    I     &PRTF       PRINTER FILE BEING EMAILED                   */
/*    I     &DESC       TEXT FOR MESSAGE DESCRIPTION                 */
/*    I     &INTRNET    EMAIL ADDRESS BEING EMAILE TO                */
/*********************************************************************/
/* Modifications:                                                    */
/*-------------------------------------------------------------------*/
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/*                                                                   */
/*********************************************************************/
 PLAMUPC:    PGM        PARM(&PRTF &DESC &INTRNET)

/*-------------------------------------------------------------------*/
/* Declare Variables                                                 */
/*-------------------------------------------------------------------*/
             DCL        VAR(&PRTF)     TYPE(*CHAR) LEN(10)
             DCL        VAR(&DESC)     TYPE(*CHAR) LEN(25)
             DCL        VAR(&INTRNET)  TYPE(*CHAR) LEN(50)

/* ERROR MESSAGE FIELDS                                                       */
             DCL        VAR(&MSG)   TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)  TYPE(*DEC) LEN(5 0)
             DCL        VAR(&MSG2)  TYPE(*CHAR) LEN(512)

/*-------------------------------------------------------------------*/
/* SEND A COPY OF THE SPOOLED FILE AS A .PDF ATTACHMENT TO THE       */
/* EMAIL ADDRESS IN THE COMPANY CARRIER FILE (PLAAREP)               */
/*-------------------------------------------------------------------*/

             ESNDMAIL   RECIPIENT(&INTRNET) SUBJECT(&DESC) +
                          MSG(&DESC) MSGTYPE(*TEXT) ATTLIST((* *PDF +
                          *N &PRTF))
             MONMSG     MSGID(CPF9999 EML9999) EXEC(GOTO +
                          CMDLBL(MSGTRAP))

             GOTO       CMDLBL(ENDPGM)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ENDPGM))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000)

 ENDPGM:     ENDPGM
