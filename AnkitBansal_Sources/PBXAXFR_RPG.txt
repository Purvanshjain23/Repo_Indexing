     H/TITLE EXC Bld Lds fr TMS Upl XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/23/21  Time  : 11:05:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBCRCPL2IF  E           K        DISK
      * RSQ : TMS Load                  Load/ExtDtTm/Sel Unproc
      *
     FPBCSCPL1IF  E           K        DISK
      * RTV : TMS Load Event            Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPBCUCPL1IF  E           K        DISK
      * RTV : TMS Load Event Shipment   Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FPBCUCPL2IF  E           K        DISK
      * RSQ : TMS Load Event Shipment   Ld/Extract/ExtFile/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMCARR  IF  E           K        DISK
      * RSQ : Carrier                   Ship to Name
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FPBCSCPL2IF  E           K        DISK
      * RSQ : TMS Load Event            Load/Extract/sel Drop
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event   N
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPDLHCPLJIF  E           K        DISK
      * RSQ : Load Order Change Log     Create Date(D)/Time/Seq
      *
     FPDLHCPL9IF  E           K        DISK
      * RSQ : Load Order Change Log     Load ID/Seg Num-1
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FPBCUCPL0UF  E           K        DISK
      * UPD : TMS Load Event Shipment   Update index
      *
     FOMFFREL1UF  E           K        DISK                      A
      * UPD : Carrier                   Update index
      *
     FOMFJCPL1UF  E           K        DISK                      A
      * UPD : Load Header               Update index
      *
     FPBCSCPL0UF  E           K        DISK
      * UPD : TMS Load Event            Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMFLCPL0UF  E           K        DISK                      A
      * UPD : Load Detail               Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDLHCPL0IF  E           K        DISK                      A
      * UPD : Load Order Change Log     Update index
      *
     FPBCRCPL0UF  E           K        DISK
      * UPD : TMS Load                  Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Long constants
     E                    @CN#    1  20  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@CRCPX0
      * TMS Load                  Load/ExtDtTm/Sel Unproc
      * Renamed input format fields
     I              CRTMLD                          WATMLD
     I              CRAYD8                          WAAYD8
     I              CRAFTH                          WAAFTH
     I              CRFSU1                          WAFSU1
     I              CRUPAA                          WAUPAA
     I              CRLTMP                          WALTMP
     I              CRDFSC                          WADFSC
     I              CRDGSC                          WADGSC
     I              CRDHSC                          WADHSC
     I              CRDISC                          WADISC
     I              CRDJSC                          WADJSC
     I              CRDKSC                          WADKSC
     I              CRUQAA                          WAUQAA
     I              CRURAA                          WAURAA
     I              CRUSAA                          WAUSAA
     I              CRCRDS                          WACRDS
     I              CRAZD8                          WAAZD8
     I              CRAGTH                          WAAGTH
     I              CRUTAA                          WAUTAA
     I              CRUUAA                          WAUUAA
     I              CRUVAA                          WAUVAA
     I              CRUWAA                          WAUWAA
     I              CRUXAA                          WAUXAA
     I              CRFJU1                          WAFJU1
     I              CRFKU1                          WAFKU1
     I              CRFLU1                          WAFLU1
     I              CRFMU1                          WAFMU1
     I              CRFNU1                          WAFNU1
     I              CRFOU1                          WAFOU1
     I              CRFPU1                          WAFPU1
     I              CRFQU1                          WAFQU1
     I              CRA7D8                          WAA7D8
     I              CRA8D8                          WAA8D8
     I              CRP4U1                          WAP4U1
     I              CRDLSC                          WADLSC
     I              CRTPRC                          WATPRC
     I              CRUYAA                          WAUYAA
     I              CRA0D8                          WAA0D8
     I              CRD9TM                          WAD9TM
      *
     I@CSCPXP
      * TMS Load Event            Retrieval index
      * Renamed input format fields
     I              CSTMLD                          WBTMLD
     I              CSAYD8                          WBAYD8
     I              CSAFTH                          WBAFTH
     I              CSFSU1                          WBFSU1
     I              CSEVSQ                          WBEVSQ
     I              CSDMSC                          WBDMSC
     I              CSA1D8                          WBA1D8
     I              CSAHTH                          WBAHTH
     I              CSA2D8                          WBA2D8
     I              CSAITH                          WBAITH
     I              CSA3D8                          WBA3D8
     I              CSAJTH                          WBAJTH
     I              CSA4D8                          WBA4D8
     I              CSAKTH                          WBAKTH
     I              CSDNSC                          WBDNSC
     I              CSUZAA                          WBUZAA
     I              CSFFU1                          WBFFU1
     I              CSUGU1                          WBUGU1
     I              CSFHU1                          WBFHU1
     I              CSU0AA                          WBU0AA
     I              CSU1AA                          WBU1AA
     I              CSU3AA                          WBU3AA
     I              CSU4AA                          WBU4AA
     I              CSG1NB                          WBG1NB
     I              CSDOSC                          WBDOSC
     I              CSA6D8                          WBA6D8
     I              CSAMTH                          WBAMTH
     I              CSA9D8                          WBA9D8
     I              CSANTH                          WBANTH
     I              CSVBAA                          WBVBAA
     I              CSP5U1                          WBP5U1
     I              CSDLSC                          WBDLSC
     I              CSTPRC                          WBTPRC
     I              CSUYAA                          WBUYAA
     I              CSA0D8                          WBA0D8
     I              CSD9TM                          WBD9TM
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@CUCPXS
      * TMS Load Event Shipment   Retrieval index
      * Renamed input format fields
     I              CUTMLD                          WETMLD
     I              CUAYD8                          WEAYD8
     I              CUAFTH                          WEAFTH
     I              CUFSU1                          WEFSU1
     I              CUEVSQ                          WEEVSQ
     I              CUTMOR                          WETMOR
     I              CUHFNB                          WEHFNB
     I              CUDLSC                          WEDLSC
     I              CUTPRC                          WETPRC
     I              CUUYAA                          WEUYAA
     I              CUA0D8                          WEA0D8
     I              CUD9TM                          WED9TM
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@CUCPXR
      * TMS Load Event Shipment   Update index
      * Renamed input format fields
     I              CUTMLD                          WGTMLD
     I              CUAYD8                          WGAYD8
     I              CUAFTH                          WGAFTH
     I              CUFSU1                          WGFSU1
     I              CUEVSQ                          WGEVSQ
     I              CUTMOR                          WGTMOR
     I              CUHFNB                          WGHFNB
     I              CUDLSC                          WGDLSC
     I              CUTPRC                          WGTPRC
     I              CUUYAA                          WGUYAA
     I              CUA0D8                          WGA0D8
     I              CUD9TM                          WGD9TM
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@CUCPCT
      * TMS Load Event Shipment   Ld/Extract/ExtFile/Order
      * Renamed input format fields
     I              CUTMLD                          WITMLD
     I              CUAYD8                          WIAYD8
     I              CUAFTH                          WIAFTH
     I              CUFSU1                          WIFSU1
     I              CUEVSQ                          WIEVSQ
     I              CUTMOR                          WITMOR
     I              CUHFNB                          WIHFNB
     I              CUDLSC                          WIDLSC
     I              CUTPRC                          WITPRC
     I              CUUYAA                          WIUYAA
     I              CUA0D8                          WIA0D8
     I              CUD9TM                          WID9TM
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WKAJCD
     I              ADF8NA                          WKF8NA
     I              ADACNA                          WKACNA
     I              ADADNA                          WKADNA
     I              ADAENA                          WKAENA
     I              ADAJNA                          WKAJNA
     I              ADBTTX                          WKBTTX
     I              ADAOCD                          WKAOCD
     I              ADBGCD                          WKBGCD
     I              ADVHST                          WKVHST
     I              ADMPNA                          WKMPNA
     I              ADWPST                          WKWPST
     I              ADXUST                          WKXUST
     I              ADT0ST                          WKT0ST
     I              ADT1ST                          WKT1ST
     I              ADDBNB                          WKDBNB
     I              ADT2ST                          WKT2ST
     I              ADT3ST                          WKT3ST
     I              ADT4ST                          WKT4ST
     I              ADT6ST                          WKT6ST
     I              ADBWC3                          WKBWC3
     I              ADBTC3                          WKBTC3
     I              ADBUC3                          WKBUC3
     I              ADBVC3                          WKBVC3
     I              ADFCAA                          WKFCAA
     I              ADRQSX                          WKRQSX
     I              ADRRSX                          WKRRSX
     I              ADRSSX                          WKRSSX
     I              ADRTSX                          WKRTSX
     I              ADT7ST                          WKT7ST
     I              ADT8ST                          WKT8ST
     I              ADRNSX                          WKRNSX
     I              ADROSX                          WKROSX
     I              ADRPSX                          WKRPSX
     I              ADUVST                          WKUVST
     I              ADUWST                          WKUWST
     I              ADUXST                          WKUXST
     I              ADVSST                          WKVSST
     I              ADAATM                          WKAATM
     I              ADAYNA                          WKAYNA
     I              ADA0NA                          WKA0NA
     I              ADAXDT                          WKAXDT
      *
     I@OMCARR
      * Carrier                   Ship to Name
      * Renamed input format fields
     I              FFBZNA                          WLBZNA
     I              FFADTX                          WLADTX
     I              FFACNA                          WLACNA
     I              FFADNA                          WLADNA
     I              FFAENA                          WLAENA
     I              FFAJNA                          WLAJNA
     I              FFBTTX                          WLBTTX
     I              FFEZNB                          WLEZNB
     I              FFBGCD                          WLBGCD
     I              FFEEDT                          WLEEDT
     I              FFDUTX                          WLDUTX
     I              FFNRVA                          WLNRVA
     I              FFNSVA                          WLNSVA
     I              FFNTVA                          WLNTVA
     I              FFNUVA                          WLNUVA
     I              FFP1ST                          WLP1ST
     I              FFDVTX                          WLDVTX
     I              FFDWTX                          WLDWTX
     I              FFLVCD                          WLLVCD
     I              FFS8NB                          WLS8NB
     I              FFS9NB                          WLS9NB
     I              FFNMVA                          WLNMVA
     I              FFNOVA                          WLNOVA
     I              FFNPVA                          WLNPVA
     I              FFNQVA                          WLNQVA
     I              FFMFCD                          WLMFCD
     I              FFQXNB                          WLQXNB
     I              FFQ1NB                          WLQ1NB
     I              FFMRNG                          WLMRNG
     I              FFMRNE                          WLMRNE
     I              FFRFNB                          WLRFNB
     I              FFMREG                          WLMREG
     I              FFBQPR                          WLBQPR
     I              FFBRPR                          WLBRPR
     I              FFBSPR                          WLBSPR
     I              FFBTPR                          WLBTPR
     I              FFBUPR                          WLBUPR
     I              FFBVPR                          WLBVPR
     I              FFDJWG                          WLDJWG
     I              FFDKWG                          WLDKWG
     I              FFDLWG                          WLDLWG
     I              FFDMWG                          WLDMWG
     I              FFDNWG                          WLDNWG
     I              FFDOWG                          WLDOWG
     I              FFB2PR                          WLB2PR
     I              FFB3PR                          WLB3PR
     I              FFB4PR                          WLB4PR
     I              FFB5PR                          WLB5PR
     I              FFB6PR                          WLB6PR
     I              FFB7PR                          WLB7PR
     I              FFAAC7                          WLAAC7
     I              FFCOFI                          WLCOFI
     I              FFK6TX                          WLK6TX
     I              FFOCNA                          WLOCNA
     I              FFODNA                          WLODNA
     I              FFW7CD                          WLW7CD
     I              FFK7TX                          WLK7TX
     I              FFTENO                          WLTENO
     I              FFK8TX                          WLK8TX
     I              FFAOFC                          WLAOFC
     I              FFAOLI                          WLAOLI
     I              FFKHDT                          WLKHDT
     I              FFUNUS                          WLUNUS
     I              FFUNU2                          WLUNU2
     I              FFUNU3                          WLUNU3
     I              FFUVST                          WLUVST
     I              FFUWST                          WLUWST
     I              FFUXST                          WLUXST
     I              FFVSST                          WLVSST
     I              FFAATM                          WLAATM
     I              FFAYNA                          WLAYNA
     I              FFA0NA                          WLA0NA
     I              FFAXDT                          WLAXDT
      *
     I@FFREBG
      * Carrier                   Update index
      * Renamed input format fields
     I              FFBZNA                          WMBZNA
     I              FFADTX                          WMADTX
     I              FFACNA                          WMACNA
     I              FFADNA                          WMADNA
     I              FFAENA                          WMAENA
     I              FFAJNA                          WMAJNA
     I              FFBTTX                          WMBTTX
     I              FFEZNB                          WMEZNB
     I              FFBGCD                          WMBGCD
     I              FFEEDT                          WMEEDT
     I              FFDUTX                          WMDUTX
     I              FFNRVA                          WMNRVA
     I              FFNSVA                          WMNSVA
     I              FFNTVA                          WMNTVA
     I              FFNUVA                          WMNUVA
     I              FFP1ST                          WMP1ST
     I              FFDVTX                          WMDVTX
     I              FFDWTX                          WMDWTX
     I              FFLVCD                          WMLVCD
     I              FFS8NB                          WMS8NB
     I              FFS9NB                          WMS9NB
     I              FFNMVA                          WMNMVA
     I              FFNOVA                          WMNOVA
     I              FFNPVA                          WMNPVA
     I              FFNQVA                          WMNQVA
     I              FFMFCD                          WMMFCD
     I              FFQXNB                          WMQXNB
     I              FFQ1NB                          WMQ1NB
     I              FFMRNG                          WMMRNG
     I              FFMRNE                          WMMRNE
     I              FFRFNB                          WMRFNB
     I              FFMREG                          WMMREG
     I              FFBQPR                          WMBQPR
     I              FFBRPR                          WMBRPR
     I              FFBSPR                          WMBSPR
     I              FFBTPR                          WMBTPR
     I              FFBUPR                          WMBUPR
     I              FFBVPR                          WMBVPR
     I              FFDJWG                          WMDJWG
     I              FFDKWG                          WMDKWG
     I              FFDLWG                          WMDLWG
     I              FFDMWG                          WMDMWG
     I              FFDNWG                          WMDNWG
     I              FFDOWG                          WMDOWG
     I              FFB2PR                          WMB2PR
     I              FFB3PR                          WMB3PR
     I              FFB4PR                          WMB4PR
     I              FFB5PR                          WMB5PR
     I              FFB6PR                          WMB6PR
     I              FFB7PR                          WMB7PR
     I              FFAAC7                          WMAAC7
     I              FFCOFI                          WMCOFI
     I              FFK6TX                          WMK6TX
     I              FFOCNA                          WMOCNA
     I              FFODNA                          WMODNA
     I              FFW7CD                          WMW7CD
     I              FFK7TX                          WMK7TX
     I              FFTENO                          WMTENO
     I              FFK8TX                          WMK8TX
     I              FFAOFC                          WMAOFC
     I              FFAOLI                          WMAOLI
     I              FFKHDT                          WMKHDT
     I              FFUNUS                          WMUNUS
     I              FFUNU2                          WMUNU2
     I              FFUNU3                          WMUNU3
     I              FFUVST                          WMUVST
     I              FFUWST                          WMUWST
     I              FFUXST                          WMUXST
     I              FFVSST                          WMVSST
     I              FFAATM                          WMAATM
     I              FFAYNA                          WMAYNA
     I              FFA0NA                          WMA0NA
     I              FFAXDT                          WMAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WOBZNA
     I              FFADTX                          WOADTX
     I              FFACNA                          WOACNA
     I              FFADNA                          WOADNA
     I              FFAENA                          WOAENA
     I              FFAJNA                          WOAJNA
     I              FFBTTX                          WOBTTX
     I              FFEZNB                          WOEZNB
     I              FFBGCD                          WOBGCD
     I              FFEEDT                          WOEEDT
     I              FFDUTX                          WODUTX
     I              FFNRVA                          WONRVA
     I              FFNSVA                          WONSVA
     I              FFNTVA                          WONTVA
     I              FFNUVA                          WONUVA
     I              FFP1ST                          WOP1ST
     I              FFDVTX                          WODVTX
     I              FFDWTX                          WODWTX
     I              FFLVCD                          WOLVCD
     I              FFS8NB                          WOS8NB
     I              FFS9NB                          WOS9NB
     I              FFNMVA                          WONMVA
     I              FFNOVA                          WONOVA
     I              FFNPVA                          WONPVA
     I              FFNQVA                          WONQVA
     I              FFMFCD                          WOMFCD
     I              FFQXNB                          WOQXNB
     I              FFQ1NB                          WOQ1NB
     I              FFMRNG                          WOMRNG
     I              FFMRNE                          WOMRNE
     I              FFRFNB                          WORFNB
     I              FFMREG                          WOMREG
     I              FFBQPR                          WOBQPR
     I              FFBRPR                          WOBRPR
     I              FFBSPR                          WOBSPR
     I              FFBTPR                          WOBTPR
     I              FFBUPR                          WOBUPR
     I              FFBVPR                          WOBVPR
     I              FFDJWG                          WODJWG
     I              FFDKWG                          WODKWG
     I              FFDLWG                          WODLWG
     I              FFDMWG                          WODMWG
     I              FFDNWG                          WODNWG
     I              FFDOWG                          WODOWG
     I              FFB2PR                          WOB2PR
     I              FFB3PR                          WOB3PR
     I              FFB4PR                          WOB4PR
     I              FFB5PR                          WOB5PR
     I              FFB6PR                          WOB6PR
     I              FFB7PR                          WOB7PR
     I              FFAAC7                          WOAAC7
     I              FFCOFI                          WOCOFI
     I              FFK6TX                          WOK6TX
     I              FFOCNA                          WOOCNA
     I              FFODNA                          WOODNA
     I              FFW7CD                          WOW7CD
     I              FFK7TX                          WOK7TX
     I              FFTENO                          WOTENO
     I              FFK8TX                          WOK8TX
     I              FFAOFC                          WOAOFC
     I              FFAOLI                          WOAOLI
     I              FFKHDT                          WOKHDT
     I              FFUNUS                          WOUNUS
     I              FFUNU2                          WOUNU2
     I              FFUNU3                          WOUNU3
     I              FFUVST                          WOUVST
     I              FFUWST                          WOUWST
     I              FFUXST                          WOUXST
     I              FFVSST                          WOVSST
     I              FFAATM                          WOAATM
     I              FFAYNA                          WOAYNA
     I              FFA0NA                          WOA0NA
     I              FFAXDT                          WOAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WRRONB
     I              FKDPTX                          WRDPTX
     I              FKRSNB                          WRRSNB
     I              FKRTNB                          WRRTNB
     I              FKTANB                          WRTANB
     I              FKUVST                          WRUVST
     I              FKUWST                          WRUWST
     I              FKUXST                          WRUXST
     I              FKVSST                          WRVSST
     I              FKAATM                          WRAATM
     I              FKAYNA                          WRAYNA
     I              FKA0NA                          WRA0NA
     I              FKAXDT                          WRAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WSRMNB
     I              FJAIC3                          WSAIC3
     I              FJAODT                          WSAODT
     I              FJPJST                          WSPJST
     I              FJPKST                          WSPKST
     I              FJRNNB                          WSRNNB
     I              FJDMTX                          WSDMTX
     I              FJDNTX                          WSDNTX
     I              FJDOTX                          WSDOTX
     I              FJWTTX                          WSWTTX
     I              FJWUTX                          WSWUTX
     I              FJRPNB                          WSRPNB
     I              FJFLAM                          WSFLAM
     I              FJXQST                          WSXQST
     I              FJRRNB                          WSRRNB
     I              FJDXTX                          WSDXTX
     I              FJDYTX                          WSDYTX
     I              FJSBNB                          WSSBNB
     I              FJBZNA                          WSBZNA
     I              FJRONB                          WSRONB
     I              FJSQNB                          WSSQNB
     I              FJR1NB                          WSR1NB
     I              FJVCST                          WSVCST
     I              FJVDST                          WSVDST
     I              FJSDNB                          WSSDNB
     I              FJPAOU                          WSPAOU
     I              FJDGWG                          WSDGWG
     I              FJSXNB                          WSSXNB
     I              FJHADT                          WSHADT
     I              FJAART                          WSAART
     I              FJDHWG                          WSDHWG
     I              FJDIWG                          WSDIWG
     I              FJAQDT                          WSAQDT
     I              FJS6NB                          WSS6NB
     I              FJT4NB                          WST4NB
     I              FJPRTM                          WSPRTM
     I              FJNPSV                          WSNPSV
     I              FJJ8TX                          WSJ8TX
     I              FJTLMI                          WSTLMI
     I              FJJ9TX                          WSJ9TX
     I              FJQ2CD                          WSQ2CD
     I              FJVPCD                          WSVPCD
     I              FJDBCD                          WSDBCD
     I              FJGRWE                          WSGRWE
     I              FJXCCD                          WSXCCD
     I              FJU2ST                          WSU2ST
     I              FJF9DT                          WSF9DT
     I              FJONTM                          WSONTM
     I              FJJ4DT                          WSJ4DT
     I              FJTRTM                          WSTRTM
     I              FJJ5DT                          WSJ5DT
     I              FJSPTM                          WSSPTM
     I              FJJ6DT                          WSJ6DT
     I              FJLFTM                          WSLFTM
     I              FJJ7DT                          WSJ7DT
     I              FJBOTM                          WSBOTM
     I              FJJ8DT                          WSJ8DT
     I              FJBLTM                          WSBLTM
     I              FJKIDT                          WSKIDT
     I              FJASTM                          WSASTM
     I              FJKADT                          WSKADT
     I              FJAJCM                          WSAJCM
     I              FJXACD                          WSXACD
     I              FJOANA                          WSOANA
     I              FJK4TX                          WSK4TX
     I              FJVOAG                          WSVOAG
     I              FJKBDT                          WSKBDT
     I              FJNBBO                          WSNBBO
     I              FJW4CD                          WSW4CD
     I              FJEFDT                          WSEFDT
     I              FJCNTN                          WSCNTN
     I              FJKCDT                          WSKCDT
     I              FJTMIN                          WSTMIN
     I              FJKDDT                          WSKDDT
     I              FJVMNB                          WSVMNB
     I              FJOCFR                          WSOCFR
     I              FJKJDT                          WSKJDT
     I              FJATTM                          WSATTM
     I              FJOTRS                          WSOTRS
     I              FJRNST                          WSRNST
     I              FJBRBK                          WSBRBK
     I              FJEIDT                          WSEIDT
     I              FJRMST                          WSRMST
     I              FJAJCD                          WSAJCD
     I              FJKKDT                          WSKKDT
     I              FJAVTM                          WSAVTM
     I              FJKZDT                          WSKZDT
     I              FJAXTM                          WSAXTM
     I              FJLHOS                          WSLHOS
     I              FJLHOR                          WSLHOR
     I              FJWNTX                          WSWNTX
     I              FJOITX                          WSOITX
     I              FJOJTX                          WSOJTX
     I              FJLLDT                          WSLLDT
     I              FJLSHG                          WSLSHG
     I              FJYPST                          WSYPST
     I              FJK0DT                          WSK0DT
     I              FJAYTM                          WSAYTM
     I              FJKNNX                          WSKNNX
     I              FJICWG                          WSICWG
     I              FJIDWG                          WSIDWG
     I              FJH9SX                          WSH9SX
     I              FJWOTX                          WSWOTX
     I              FJK1DT                          WSK1DT
     I              FJAZTM                          WSAZTM
     I              FJK2DT                          WSK2DT
     I              FJA0TM                          WSA0TM
     I              FJROST                          WSROST
     I              FJRPST                          WSRPST
     I              FJRQST                          WSRQST
     I              FJRRST                          WSRRST
     I              FJZBVA                          WSZBVA
     I              FJWPTX                          WSWPTX
     I              FJWQTX                          WSWQTX
     I              FJWRTX                          WSWRTX
     I              FJWSTX                          WSWSTX
     I              FJRVSX                          WSRVSX
     I              FJRUSX                          WSRUSX
     I              FJRWSX                          WSRWSX
     I              FJRXSX                          WSRXSX
     I              FJRYSX                          WSRYSX
     I              FJRZSX                          WSRZSX
     I              FJR0SX                          WSR0SX
     I              FJR1SX                          WSR1SX
     I              FJR2SX                          WSR2SX
     I              FJR3SX                          WSR3SX
     I              FJR4SX                          WSR4SX
     I              FJPYDT                          WSPYDT
     I              FJCKTM                          WSCKTM
     I              FJPZDT                          WSPZDT
     I              FJCLTM                          WSCLTM
     I              FJP0DT                          WSP0DT
     I              FJCMTM                          WSCMTM
     I              FJP1DT                          WSP1DT
     I              FJCNTM                          WSCNTM
     I              FJP2DT                          WSP2DT
     I              FJCOTM                          WSCOTM
     I              FJP3DT                          WSP3DT
     I              FJCQTM                          WSCQTM
     I              FJUVST                          WSUVST
     I              FJUWST                          WSUWST
     I              FJUXST                          WSUXST
     I              FJAATM                          WSAATM
     I              FJAYNA                          WSAYNA
     I              FJA0NA                          WSA0NA
     I              FJAXDT                          WSAXDT
      *
     I@CSCPXO
      * TMS Load Event            Update index
      * Renamed input format fields
     I              CSTMLD                          WTTMLD
     I              CSAYD8                          WTAYD8
     I              CSAFTH                          WTAFTH
     I              CSFSU1                          WTFSU1
     I              CSEVSQ                          WTEVSQ
     I              CSDMSC                          WTDMSC
     I              CSA1D8                          WTA1D8
     I              CSAHTH                          WTAHTH
     I              CSA2D8                          WTA2D8
     I              CSAITH                          WTAITH
     I              CSA3D8                          WTA3D8
     I              CSAJTH                          WTAJTH
     I              CSA4D8                          WTA4D8
     I              CSAKTH                          WTAKTH
     I              CSDNSC                          WTDNSC
     I              CSUZAA                          WTUZAA
     I              CSFFU1                          WTFFU1
     I              CSUGU1                          WTUGU1
     I              CSFHU1                          WTFHU1
     I              CSU0AA                          WTU0AA
     I              CSU1AA                          WTU1AA
     I              CSU3AA                          WTU3AA
     I              CSU4AA                          WTU4AA
     I              CSG1NB                          WTG1NB
     I              CSDOSC                          WTDOSC
     I              CSA6D8                          WTA6D8
     I              CSAMTH                          WTAMTH
     I              CSA9D8                          WTA9D8
     I              CSANTH                          WTANTH
     I              CSVBAA                          WTVBAA
     I              CSP5U1                          WTP5U1
     I              CSDLSC                          WTDLSC
     I              CSTPRC                          WTTPRC
     I              CSUYAA                          WTUYAA
     I              CSA0D8                          WTA0D8
     I              CSD9TM                          WTD9TM
      *
     I@CSCPYL
      * TMS Load Event            Load/Extract/sel Drop
      * Renamed input format fields
     I              CSTMLD                          WVTMLD
     I              CSAYD8                          WVAYD8
     I              CSAFTH                          WVAFTH
     I              CSFSU1                          WVFSU1
     I              CSEVSQ                          WVEVSQ
     I              CSDMSC                          WVDMSC
     I              CSA1D8                          WVA1D8
     I              CSAHTH                          WVAHTH
     I              CSA2D8                          WVA2D8
     I              CSAITH                          WVAITH
     I              CSA3D8                          WVA3D8
     I              CSAJTH                          WVAJTH
     I              CSA4D8                          WVA4D8
     I              CSAKTH                          WVAKTH
     I              CSDNSC                          WVDNSC
     I              CSUZAA                          WVUZAA
     I              CSFFU1                          WVFFU1
     I              CSUGU1                          WVUGU1
     I              CSFHU1                          WVFHU1
     I              CSU0AA                          WVU0AA
     I              CSU1AA                          WVU1AA
     I              CSU3AA                          WVU3AA
     I              CSU4AA                          WVU4AA
     I              CSG1NB                          WVG1NB
     I              CSDOSC                          WVDOSC
     I              CSA6D8                          WVA6D8
     I              CSAMTH                          WVAMTH
     I              CSA9D8                          WVA9D8
     I              CSANTH                          WVANTH
     I              CSVBAA                          WVVBAA
     I              CSP5U1                          WVP5U1
     I              CSDLSC                          WVDLSC
     I              CSTPRC                          WVTPRC
     I              CSUYAA                          WVUYAA
     I              CSA0D8                          WVA0D8
     I              CSD9TM                          WVD9TM
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WWRMNB
     I              FLRUNB                          WWRUNB
     I              FLRVNB                          WWRVNB
     I              FLDQTX                          WWDQTX
     I              FLRWNB                          WWRWNB
     I              FLRXNB                          WWRXNB
     I              FLSQNB                          WWSQNB
     I              FLT0NB                          WWT0NB
     I              FLT1NB                          WWT1NB
     I              FLR1NB                          WWR1NB
     I              FLAIC3                          WWAIC3
     I              FLC4NB                          WWC4NB
     I              FLVCST                          WWVCST
     I              FLKEDT                          WWKEDT
     I              FLSXNB                          WWSXNB
     I              FLKFDT                          WWKFDT
     I              FLACTM                          WWACTM
     I              FLK5TX                          WWK5TX
     I              FLW5CD                          WWW5CD
     I              FLEJDT                          WWEJDT
     I              FLAGTM                          WWAGTM
     I              FLKJDT                          WWKJDT
     I              FLATTM                          WWATTM
     I              FLHDDT                          WWHDDT
     I              FLAUTM                          WWAUTM
     I              FLKKDT                          WWKKDT
     I              FLAVTM                          WWAVTM
     I              FLZ4NB                          WWZ4NB
     I              FLY7ST                          WWY7ST
     I              FLY2ST                          WWY2ST
     I              FLWHTX                          WWWHTX
     I              FLWITX                          WWWITX
     I              FLWJTX                          WWWJTX
     I              FLWKTX                          WWWKTX
     I              FLWLTX                          WWWLTX
     I              FLN7DT                          WWN7DT
     I              FLN8DT                          WWN8DT
     I              FLN9DT                          WWN9DT
     I              FLB3TM                          WWB3TM
     I              FLB4TM                          WWB4TM
     I              FLB5TM                          WWB5TM
     I              FLIASX                          WWIASX
     I              FLIBSX                          WWIBSX
     I              FLICSX                          WWICSX
     I              FLWVTX                          WWWVTX
     I              FLWWTX                          WWWWTX
     I              FLWXTX                          WWWXTX
     I              FLUVST                          WWUVST
     I              FLUWST                          WWUWST
     I              FLUXST                          WWUXST
     I              FLAATM                          WWAATM
     I              FLAYNA                          WWAYNA
     I              FLA0NA                          WWA0NA
     I              FLAXDT                          WWAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WXAIC3
     I              BEC4NB                          WXC4NB
     I              BEJNCD                          WXJNCD
     I              BEANC7                          WXANC7
     I              BEBKC7                          WXBKC7
     I              BEBRTX                          WXBRTX
     I              BEHMNA                          WXHMNA
     I              BEHONA                          WXHONA
     I              BEHPNA                          WXHPNA
     I              BEHNNA                          WXHNNA
     I              BEDBCD                          WXDBCD
     I              BECKTX                          WXCKTX
     I              BEB0C7                          WXB0C7
     I              BEAETX                          WXAETX
     I              BEB1NA                          WXB1NA
     I              BEB3NA                          WXB3NA
     I              BEB4NA                          WXB4NA
     I              BEB2NA                          WXB2NA
     I              BEBHCD                          WXBHCD
     I              BEC8TX                          WXC8TX
     I              BEBCNA                          WXBCNA
     I              BEA0DT                          WXA0DT
     I              BEA5DT                          WXA5DT
     I              BEGNDT                          WXGNDT
     I              BEACDT                          WXACDT
     I              BEAQCD                          WXAQCD
     I              BEB6NA                          WXB6NA
     I              BEBYNA                          WXBYNA
     I              BEBZNA                          WXBZNA
     I              BEGTST                          WXGTST
     I              BEGVST                          WXGVST
     I              BEGUST                          WXGUST
     I              BEQFST                          WXQFST
     I              BECQCD                          WXCQCD
     I              BEGJST                          WXGJST
     I              BEGWST                          WXGWST
     I              BEGXST                          WXGXST
     I              BEGYST                          WXGYST
     I              BEAODT                          WXAODT
     I              BEAIVN                          WXAIVN
     I              BECXDT                          WXCXDT
     I              BEJZVA                          WXJZVA
     I              BEA1WG                          WXA1WG
     I              BEXIST                          WXXIST
     I              BEXJST                          WXXJST
     I              BEXKST                          WXXKST
     I              BEEIDT                          WXEIDT
     I              BEAFTM                          WXAFTM
     I              BEE8CD                          WXE8CD
     I              BEE9CD                          WXE9CD
     I              BERMNB                          WXRMNB
     I              BETBNB                          WXTBNB
     I              BER1NB                          WXR1NB
     I              BEPJST                          WXPJST
     I              BEU0ST                          WXU0ST
     I              BEU1ST                          WXU1ST
     I              BEQ2CD                          WXQ2CD
     I              BEU2ST                          WXU2ST
     I              BEVEST                          WXVEST
     I              BEVFST                          WXVFST
     I              BEVGST                          WXVGST
     I              BERPCD                          WXRPCD
     I              BERNNB                          WXRNNB
     I              BEVDST                          WXVDST
     I              BEATIN                          WXATIN
     I              BEU4ST                          WXU4ST
     I              BEU5ST                          WXU5ST
     I              BERSRN                          WXRSRN
     I              BEMHNA                          WXMHNA
     I              BEMINA                          WXMINA
     I              BEWBST                          WXWBST
     I              BER4CD                          WXR4CD
     I              BEBFCD                          WXBFCD
     I              BEQ4CD                          WXQ4CD
     I              BET3NB                          WXT3NB
     I              BESICD                          WXSICD
     I              BECONB                          WXCONB
     I              BECEST                          WXCEST
     I              BEAWDT                          WXAWDT
     I              BEJPCD                          WXJPCD
     I              BEXUST                          WXXUST
     I              BEZ1ST                          WXZ1ST
     I              BEVRVA                          WXVRVA
     I              BEOBST                          WXOBST
     I              BEBCST                          WXBCST
     I              BEBDST                          WXBDST
     I              BEB7VL                          WXB7VL
     I              BEGASX                          WXGASX
     I              BEGBSX                          WXGBSX
     I              BEGCSX                          WXGCSX
     I              BEGDSX                          WXGDSX
     I              BEFNSX                          WXFNSX
     I              BEFOSX                          WXFOSX
     I              BEFPSX                          WXFPSX
     I              BEFQSX                          WXFQSX
     I              BEFRSX                          WXFRSX
     I              BEFSSX                          WXFSSX
     I              BEFTSX                          WXFTSX
     I              BEFUSX                          WXFUSX
     I              BEFVSX                          WXFVSX
     I              BEFWSX                          WXFWSX
     I              BEFXSX                          WXFXSX
     I              BEFYSX                          WXFYSX
     I              BENODT                          WXNODT
     I              BENPDT                          WXNPDT
     I              BENQDT                          WXNQDT
     I              BENRDT                          WXNRDT
     I              BENSDT                          WXNSDT
     I              BEBPTM                          WXBPTM
     I              BEBQTM                          WXBQTM
     I              BEBRTM                          WXBRTM
     I              BEBSTM                          WXBSTM
     I              BEBTTM                          WXBTTM
     I              BEH0NX                          WXH0NX
     I              BEH1NX                          WXH1NX
     I              BEH2NX                          WXH2NX
     I              BEH3NX                          WXH3NX
     I              BEH4NX                          WXH4NX
     I              BEC0C7                          WXC0C7
     I              BEUVST                          WXUVST
     I              BEUWST                          WXUWST
     I              BEUXST                          WXUXST
     I              BEAATM                          WXAATM
     I              BEAYNA                          WXAYNA
     I              BEA0NA                          WXA0NA
     I              BEAXDT                          WXAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WYAIC3
     I              AMC4NB                          WYC4NB
     I              AMRMNB                          WYRMNB
     I              AMRUNB                          WYRUNB
     I              AMXACD                          WYXACD
     I              AMOANA                          WYOANA
     I              AMHBAA                          WYHBAA
     I              AMJ0T1                          WYJ0T1
     I              AMGENY                          WYGENY
     I              AMJ1T1                          WYJ1T1
     I              AMHCAA                          WYHCAA
     I              AMQWDT                          WYQWDT
     I              AMQXDT                          WYQXDT
     I              AMQYDT                          WYQYDT
     I              AMHDAA                          WYHDAA
     I              AMCCTX                          WYCCTX
     I              AMJ2T1                          WYJ2T1
     I              AMRLNA                          WYRLNA
     I              AMRMNA                          WYRMNA
     I              AMGINY                          WYGINY
     I              AMGFNY                          WYGFNY
     I              AMGGNY                          WYGGNY
     I              AMGHNY                          WYGHNY
     I              AMHEVL                          WYHEVL
     I              AMHFVL                          WYHFVL
     I              AMHGVL                          WYHGVL
     I              AMQZDT                          WYQZDT
     I              AMQ0DT                          WYQ0DT
     I              AMQ1DT                          WYQ1DT
     I              AMQ2DT                          WYQ2DT
     I              AMC2TX                          WYC2TX
     I              AMC3TX                          WYC3TX
     I              AMC6TX                          WYC6TX
     I              AMCHTX                          WYCHTX
     I              AMCITX                          WYCITX
     I              AMCLTX                          WYCLTX
     I              AMB4TX                          WYB4TX
     I              AMCUTX                          WYCUTX
     I              AMCVTX                          WYCVTX
     I              AMB9TX                          WYB9TX
     I              AMJWSC                          WYJWSC
     I              AMITNY                          WYITNY
     I              AMLMT1                          WYLMT1
     I              AMLWAA                          WYLWAA
     I              AMFVST                          WYFVST
     I              AMF0ST                          WYF0ST
     I              AMF2ST                          WYF2ST
     I              AMF3ST                          WYF3ST
     I              AMJUSC                          WYJUSC
     I              AMJVSC                          WYJVSC
     I              AMV3T1                          WYV3T1
     I              AMV4T1                          WYV4T1
     I              AMV5T1                          WYV5T1
     I              AMV6T1                          WYV6T1
     I              AMV7T1                          WYV7T1
     I              AMV8T1                          WYV8T1
     I              AMV9T1                          WYV9T1
     I              AMWAT1                          WYWAT1
     I              AMWBT1                          WYWBT1
     I              AMWCT1                          WYWCT1
     I              AMWDT1                          WYWDT1
     I              AMQJNY                          WYQJNY
     I              AMQKNY                          WYQKNY
     I              AMQLNY                          WYQLNY
     I              AMP8NY                          WYP8NY
     I              AMP9NY                          WYP9NY
     I              AMQANY                          WYQANY
     I              AMQCNY                          WYQCNY
     I              AMQDNY                          WYQDNY
     I              AMQENY                          WYQENY
     I              AMQFNY                          WYQFNY
     I              AMQGNY                          WYQGNY
     I              AMQHNY                          WYQHNY
     I              AMQINY                          WYQINY
     I              AMQMNY                          WYQMNY
     I              AMMYU1                          WYMYU1
     I              AMJXSC                          WYJXSC
     I              AMJYSC                          WYJYSC
     I              AMJZSC                          WYJZSC
     I              AMJ0SC                          WYJ0SC
     I              AMMZU1                          WYMZU1
     I              AMM0U1                          WYM0U1
     I              AMM1U1                          WYM1U1
     I              AMM2U1                          WYM2U1
     I              AMM3U1                          WYM3U1
     I              AMW5DT                          WYW5DT
     I              AMW6DT                          WYW6DT
     I              AMUVST                          WYUVST
     I              AMUWST                          WYUWST
     I              AMUXST                          WYUXST
     I              AMVSST                          WYVSST
     I              AMAATM                          WYAATM
     I              AMAYNA                          WYAYNA
     I              AMA0NA                          WYA0NA
     I              AMAXDT                          WYAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          TAAIC3
     I              AMC4NB                          TAC4NB
     I              AMRMNB                          TARMNB
     I              AMRUNB                          TARUNB
     I              AMXACD                          TAXACD
     I              AMOANA                          TAOANA
     I              AMHBAA                          TAHBAA
     I              AMJ0T1                          TAJ0T1
     I              AMGENY                          TAGENY
     I              AMJ1T1                          TAJ1T1
     I              AMHCAA                          TAHCAA
     I              AMQWDT                          TAQWDT
     I              AMQXDT                          TAQXDT
     I              AMQYDT                          TAQYDT
     I              AMHDAA                          TAHDAA
     I              AMCCTX                          TACCTX
     I              AMJ2T1                          TAJ2T1
     I              AMRLNA                          TARLNA
     I              AMRMNA                          TARMNA
     I              AMGINY                          TAGINY
     I              AMGFNY                          TAGFNY
     I              AMGGNY                          TAGGNY
     I              AMGHNY                          TAGHNY
     I              AMHEVL                          TAHEVL
     I              AMHFVL                          TAHFVL
     I              AMHGVL                          TAHGVL
     I              AMQZDT                          TAQZDT
     I              AMQ0DT                          TAQ0DT
     I              AMQ1DT                          TAQ1DT
     I              AMQ2DT                          TAQ2DT
     I              AMC2TX                          TAC2TX
     I              AMC3TX                          TAC3TX
     I              AMC6TX                          TAC6TX
     I              AMCHTX                          TACHTX
     I              AMCITX                          TACITX
     I              AMCLTX                          TACLTX
     I              AMB4TX                          TAB4TX
     I              AMCUTX                          TACUTX
     I              AMCVTX                          TACVTX
     I              AMB9TX                          TAB9TX
     I              AMJWSC                          TAJWSC
     I              AMITNY                          TAITNY
     I              AMLMT1                          TALMT1
     I              AMLWAA                          TALWAA
     I              AMFVST                          TAFVST
     I              AMF0ST                          TAF0ST
     I              AMF2ST                          TAF2ST
     I              AMF3ST                          TAF3ST
     I              AMJUSC                          TAJUSC
     I              AMJVSC                          TAJVSC
     I              AMV3T1                          TAV3T1
     I              AMV4T1                          TAV4T1
     I              AMV5T1                          TAV5T1
     I              AMV6T1                          TAV6T1
     I              AMV7T1                          TAV7T1
     I              AMV8T1                          TAV8T1
     I              AMV9T1                          TAV9T1
     I              AMWAT1                          TAWAT1
     I              AMWBT1                          TAWBT1
     I              AMWCT1                          TAWCT1
     I              AMWDT1                          TAWDT1
     I              AMQJNY                          TAQJNY
     I              AMQKNY                          TAQKNY
     I              AMQLNY                          TAQLNY
     I              AMP8NY                          TAP8NY
     I              AMP9NY                          TAP9NY
     I              AMQANY                          TAQANY
     I              AMQCNY                          TAQCNY
     I              AMQDNY                          TAQDNY
     I              AMQENY                          TAQENY
     I              AMQFNY                          TAQFNY
     I              AMQGNY                          TAQGNY
     I              AMQHNY                          TAQHNY
     I              AMQINY                          TAQINY
     I              AMQMNY                          TAQMNY
     I              AMMYU1                          TAMYU1
     I              AMJXSC                          TAJXSC
     I              AMJYSC                          TAJYSC
     I              AMJZSC                          TAJZSC
     I              AMJ0SC                          TAJ0SC
     I              AMMZU1                          TAMZU1
     I              AMM0U1                          TAM0U1
     I              AMM1U1                          TAM1U1
     I              AMM2U1                          TAM2U1
     I              AMM3U1                          TAM3U1
     I              AMW5DT                          TAW5DT
     I              AMW6DT                          TAW6DT
     I              AMUVST                          TAUVST
     I              AMUWST                          TAUWST
     I              AMUXST                          TAUXST
     I              AMVSST                          TAVSST
     I              AMAATM                          TAAATM
     I              AMAYNA                          TAAYNA
     I              AMA0NA                          TAA0NA
     I              AMAXDT                          TAAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          TBRMNB
     I              FLRUNB                          TBRUNB
     I              FLRVNB                          TBRVNB
     I              FLDQTX                          TBDQTX
     I              FLRWNB                          TBRWNB
     I              FLRXNB                          TBRXNB
     I              FLSQNB                          TBSQNB
     I              FLT0NB                          TBT0NB
     I              FLT1NB                          TBT1NB
     I              FLR1NB                          TBR1NB
     I              FLAIC3                          TBAIC3
     I              FLC4NB                          TBC4NB
     I              FLVCST                          TBVCST
     I              FLKEDT                          TBKEDT
     I              FLSXNB                          TBSXNB
     I              FLKFDT                          TBKFDT
     I              FLACTM                          TBACTM
     I              FLK5TX                          TBK5TX
     I              FLW5CD                          TBW5CD
     I              FLEJDT                          TBEJDT
     I              FLAGTM                          TBAGTM
     I              FLKJDT                          TBKJDT
     I              FLATTM                          TBATTM
     I              FLHDDT                          TBHDDT
     I              FLAUTM                          TBAUTM
     I              FLKKDT                          TBKKDT
     I              FLAVTM                          TBAVTM
     I              FLZ4NB                          TBZ4NB
     I              FLY7ST                          TBY7ST
     I              FLY2ST                          TBY2ST
     I              FLWHTX                          TBWHTX
     I              FLWITX                          TBWITX
     I              FLWJTX                          TBWJTX
     I              FLWKTX                          TBWKTX
     I              FLWLTX                          TBWLTX
     I              FLN7DT                          TBN7DT
     I              FLN8DT                          TBN8DT
     I              FLN9DT                          TBN9DT
     I              FLB3TM                          TBB3TM
     I              FLB4TM                          TBB4TM
     I              FLB5TM                          TBB5TM
     I              FLIASX                          TBIASX
     I              FLIBSX                          TBIBSX
     I              FLICSX                          TBICSX
     I              FLWVTX                          TBWVTX
     I              FLWWTX                          TBWWTX
     I              FLWXTX                          TBWXTX
     I              FLUVST                          TBUVST
     I              FLUWST                          TBUWST
     I              FLUXST                          TBUXST
     I              FLAATM                          TBAATM
     I              FLAYNA                          TBAYNA
     I              FLA0NA                          TBA0NA
     I              FLAXDT                          TBAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          TCAIC3
     I              EYC4NB                          TCC4NB
     I              EYQ2NB                          TCQ2NB
     I              EYJPCD                          TCJPCD
     I              EYAUC3                          TCAUC3
     I              EYQ7NB                          TCQ7NB
     I              EYOMST                          TCOMST
     I              EYD2DT                          TCD2DT
     I              EYONST                          TCONST
     I              EYOOST                          TCOOST
     I              EYOPST                          TCOPST
     I              EYAWC3                          TCAWC3
     I              EYQ8NB                          TCQ8NB
     I              EYQ9NB                          TCQ9NB
     I              EYBKC7                          TCBKC7
     I              EYUVST                          TCUVST
     I              EYUWST                          TCUWST
     I              EYUXST                          TCUXST
     I              EYAATM                          TCAATM
     I              EYAYNA                          TCAYNA
     I              EYA0NA                          TCA0NA
     I              EYAXDT                          TCAXDT
      *
     I@EYCPZR
      * Order Events              Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          TDAIC3
     I              EYC4NB                          TDC4NB
     I              EYQ2NB                          TDQ2NB
     I              EYJPCD                          TDJPCD
     I              EYAUC3                          TDAUC3
     I              EYQ7NB                          TDQ7NB
     I              EYOMST                          TDOMST
     I              EYD2DT                          TDD2DT
     I              EYONST                          TDONST
     I              EYOOST                          TDOOST
     I              EYOPST                          TDOPST
     I              EYAWC3                          TDAWC3
     I              EYQ8NB                          TDQ8NB
     I              EYQ9NB                          TDQ9NB
     I              EYBKC7                          TDBKC7
     I              EYUVST                          TDUVST
     I              EYUWST                          TDUWST
     I              EYUXST                          TDUXST
     I              EYAATM                          TDAATM
     I              EYAYNA                          TDAYNA
     I              EYA0NA                          TDA0NA
     I              EYAXDT                          TDAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          TEAIC3
     I              EYC4NB                          TEC4NB
     I              EYQ2NB                          TEQ2NB
     I              EYJPCD                          TEJPCD
     I              EYAUC3                          TEAUC3
     I              EYQ7NB                          TEQ7NB
     I              EYOMST                          TEOMST
     I              EYD2DT                          TED2DT
     I              EYONST                          TEONST
     I              EYOOST                          TEOOST
     I              EYOPST                          TEOPST
     I              EYAWC3                          TEAWC3
     I              EYQ8NB                          TEQ8NB
     I              EYQ9NB                          TEQ9NB
     I              EYBKC7                          TEBKC7
     I              EYUVST                          TEUVST
     I              EYUWST                          TEUWST
     I              EYUXST                          TEUXST
     I              EYAATM                          TEAATM
     I              EYAYNA                          TEAYNA
     I              EYA0NA                          TEA0NA
     I              EYAXDT                          TEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          TFAIC3
     I              OMC4NB                          TFC4NB
     I              OMDPNB                          TFDPNB
     I              OMUENB                          TFUENB
     I              OMHGCD                          TFHGCD
     I              OMAJCD                          TFAJCD
     I              OMBKC7                          TFBKC7
     I              OMCFC7                          TFCFC7
     I              OMGMST                          TFGMST
     I              OMGNST                          TFGNST
     I              OMMAVA                          TFMAVA
     I              OMKDVA                          TFKDVA
     I              OML8VA                          TFL8VA
     I              OML9VA                          TFL9VA
     I              OMGTST                          TFGTST
     I              OMGVST                          TFGVST
     I              OMGUST                          TFGUST
     I              OMQFST                          TFQFST
     I              OMAYVA                          TFAYVA
     I              OMEXDT                          TFEXDT
     I              OMLQCD                          TFLQCD
     I              OMRDCD                          TFRDCD
     I              OMQ7CD                          TFQ7CD
     I              OMBZPR                          TFBZPR
     I              OML6NB                          TFL6NB
     I              OMU1ST                          TFU1ST
     I              OMGIDT                          TFGIDT
     I              OMCRCD                          TFCRCD
     I              OMAGCD                          TFAGCD
     I              OMRZST                          TFRZST
     I              OMR0ST                          TFR0ST
     I              OMR1ST                          TFR1ST
     I              OMG7NA                          TFG7NA
     I              OMG8NA                          TFG8NA
     I              OMRPCD                          TFRPCD
     I              OMVEST                          TFVEST
     I              OMVGST                          TFVGST
     I              OMAVST                          TFAVST
     I              OMU0ST                          TFU0ST
     I              OMRFCD                          TFRFCD
     I              OMFZST                          TFFZST
     I              OMR1NB                          TFR1NB
     I              OMAVQT                          TFAVQT
     I              OMD0WG                          TFD0WG
     I              OMCCQT                          TFCCQT
     I              OMAUWG                          TFAUWG
     I              OMCBQT                          TFCBQT
     I              OMATWG                          TFATWG
     I              OMAQCS                          TFAQCS
     I              OMAGCS                          TFAGCS
     I              OMAKPR                          TFAKPR
     I              OMALPR                          TFALPR
     I              OMAUPR                          TFAUPR
     I              OMAVWG                          TFAVWG
     I              OMA4WG                          TFA4WG
     I              OMA5DT                          TFA5DT
     I              OMAODT                          TFAODT
     I              OMGNDT                          TFGNDT
     I              OMAMST                          TFAMST
     I              OMANST                          TFANST
     I              OMVAST                          TFVAST
     I              OMRGNB                          TFRGNB
     I              OMRHNB                          TFRHNB
     I              OMRINB                          TFRINB
     I              OMRBCD                          TFRBCD
     I              OMHICD                          TFHICD
     I              OMRNCD                          TFRNCD
     I              OMROCD                          TFROCD
     I              OMCXDT                          TFCXDT
     I              OMAJVN                          TFAJVN
     I              OMKXCD                          TFKXCD
     I              OMJPCD                          TFJPCD
     I              OMCQCD                          TFCQCD
     I              OMR4CD                          TFR4CD
     I              OMZ1ST                          TFZ1ST
     I              OMZ3ST                          TFZ3ST
     I              OMZ4ST                          TFZ4ST
     I              OMDUPR                          TFDUPR
     I              OMB6VL                          TFB6VL
     I              OMA1AA                          TFA1AA
     I              OMFZSX                          TFFZSX
     I              OMF0SX                          TFF0SX
     I              OMF1SX                          TFF1SX
     I              OMF2SX                          TFF2SX
     I              OMF3SX                          TFF3SX
     I              OMF4SX                          TFF4SX
     I              OMF5SX                          TFF5SX
     I              OMF6SX                          TFF6SX
     I              OMF7SX                          TFF7SX
     I              OMNTDT                          TFNTDT
     I              OMNUDT                          TFNUDT
     I              OMNVDT                          TFNVDT
     I              OMNWDT                          TFNWDT
     I              OMNXDT                          TFNXDT
     I              OMBUTM                          TFBUTM
     I              OMBVTM                          TFBVTM
     I              OMBWTM                          TFBWTM
     I              OMBXTM                          TFBXTM
     I              OMBYTM                          TFBYTM
     I              OMH5NX                          TFH5NX
     I              OMH6NX                          TFH6NX
     I              OMH7NX                          TFH7NX
     I              OMH8NX                          TFH8NX
     I              OMH9NX                          TFH9NX
     I              OMDVPR                          TFDVPR
     I              OMDWPR                          TFDWPR
     I              OMDXPR                          TFDXPR
     I              OMDYPR                          TFDYPR
     I              OMDZPR                          TFDZPR
     I              OMGSPR                          TFGSPR
     I              OMGTPR                          TFGTPR
     I              OMGUPR                          TFGUPR
     I              OMHOST                          TFHOST
     I              OMHPST                          TFHPST
     I              OMIOST                          TFIOST
     I              OMPEWG                          TFPEWG
     I              OMRINY                          TFRINY
     I              OMTIDT                          TFTIDT
     I              OMTJDT                          TFTJDT
     I              OMH2ST                          TFH2ST
     I              OMH0ST                          TFH0ST
     I              OMH1ST                          TFH1ST
     I              OMTKDT                          TFTKDT
     I              OMTLDT                          TFTLDT
     I              OMTMDT                          TFTMDT
     I              OMUVST                          TFUVST
     I              OMUWST                          TFUWST
     I              OMUXST                          TFUXST
     I              OMAATM                          TFAATM
     I              OMAYNA                          TFAYNA
     I              OMA0NA                          TFA0NA
     I              OMAXDT                          TFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TGAIC3
     I              OMC4NB                          TGC4NB
     I              OMDPNB                          TGDPNB
     I              OMUENB                          TGUENB
     I              OMHGCD                          TGHGCD
     I              OMAJCD                          TGAJCD
     I              OMBKC7                          TGBKC7
     I              OMCFC7                          TGCFC7
     I              OMGMST                          TGGMST
     I              OMGNST                          TGGNST
     I              OMMAVA                          TGMAVA
     I              OMKDVA                          TGKDVA
     I              OML8VA                          TGL8VA
     I              OML9VA                          TGL9VA
     I              OMGTST                          TGGTST
     I              OMGVST                          TGGVST
     I              OMGUST                          TGGUST
     I              OMQFST                          TGQFST
     I              OMAYVA                          TGAYVA
     I              OMEXDT                          TGEXDT
     I              OMLQCD                          TGLQCD
     I              OMRDCD                          TGRDCD
     I              OMQ7CD                          TGQ7CD
     I              OMBZPR                          TGBZPR
     I              OML6NB                          TGL6NB
     I              OMU1ST                          TGU1ST
     I              OMGIDT                          TGGIDT
     I              OMCRCD                          TGCRCD
     I              OMAGCD                          TGAGCD
     I              OMRZST                          TGRZST
     I              OMR0ST                          TGR0ST
     I              OMR1ST                          TGR1ST
     I              OMG7NA                          TGG7NA
     I              OMG8NA                          TGG8NA
     I              OMRPCD                          TGRPCD
     I              OMVEST                          TGVEST
     I              OMVGST                          TGVGST
     I              OMAVST                          TGAVST
     I              OMU0ST                          TGU0ST
     I              OMRFCD                          TGRFCD
     I              OMFZST                          TGFZST
     I              OMR1NB                          TGR1NB
     I              OMAVQT                          TGAVQT
     I              OMD0WG                          TGD0WG
     I              OMCCQT                          TGCCQT
     I              OMAUWG                          TGAUWG
     I              OMCBQT                          TGCBQT
     I              OMATWG                          TGATWG
     I              OMAQCS                          TGAQCS
     I              OMAGCS                          TGAGCS
     I              OMAKPR                          TGAKPR
     I              OMALPR                          TGALPR
     I              OMAUPR                          TGAUPR
     I              OMAVWG                          TGAVWG
     I              OMA4WG                          TGA4WG
     I              OMA5DT                          TGA5DT
     I              OMAODT                          TGAODT
     I              OMGNDT                          TGGNDT
     I              OMAMST                          TGAMST
     I              OMANST                          TGANST
     I              OMVAST                          TGVAST
     I              OMRGNB                          TGRGNB
     I              OMRHNB                          TGRHNB
     I              OMRINB                          TGRINB
     I              OMRBCD                          TGRBCD
     I              OMHICD                          TGHICD
     I              OMRNCD                          TGRNCD
     I              OMROCD                          TGROCD
     I              OMCXDT                          TGCXDT
     I              OMAJVN                          TGAJVN
     I              OMKXCD                          TGKXCD
     I              OMJPCD                          TGJPCD
     I              OMCQCD                          TGCQCD
     I              OMR4CD                          TGR4CD
     I              OMZ1ST                          TGZ1ST
     I              OMZ3ST                          TGZ3ST
     I              OMZ4ST                          TGZ4ST
     I              OMDUPR                          TGDUPR
     I              OMB6VL                          TGB6VL
     I              OMA1AA                          TGA1AA
     I              OMFZSX                          TGFZSX
     I              OMF0SX                          TGF0SX
     I              OMF1SX                          TGF1SX
     I              OMF2SX                          TGF2SX
     I              OMF3SX                          TGF3SX
     I              OMF4SX                          TGF4SX
     I              OMF5SX                          TGF5SX
     I              OMF6SX                          TGF6SX
     I              OMF7SX                          TGF7SX
     I              OMNTDT                          TGNTDT
     I              OMNUDT                          TGNUDT
     I              OMNVDT                          TGNVDT
     I              OMNWDT                          TGNWDT
     I              OMNXDT                          TGNXDT
     I              OMBUTM                          TGBUTM
     I              OMBVTM                          TGBVTM
     I              OMBWTM                          TGBWTM
     I              OMBXTM                          TGBXTM
     I              OMBYTM                          TGBYTM
     I              OMH5NX                          TGH5NX
     I              OMH6NX                          TGH6NX
     I              OMH7NX                          TGH7NX
     I              OMH8NX                          TGH8NX
     I              OMH9NX                          TGH9NX
     I              OMDVPR                          TGDVPR
     I              OMDWPR                          TGDWPR
     I              OMDXPR                          TGDXPR
     I              OMDYPR                          TGDYPR
     I              OMDZPR                          TGDZPR
     I              OMGSPR                          TGGSPR
     I              OMGTPR                          TGGTPR
     I              OMGUPR                          TGGUPR
     I              OMHOST                          TGHOST
     I              OMHPST                          TGHPST
     I              OMIOST                          TGIOST
     I              OMPEWG                          TGPEWG
     I              OMRINY                          TGRINY
     I              OMTIDT                          TGTIDT
     I              OMTJDT                          TGTJDT
     I              OMH2ST                          TGH2ST
     I              OMH0ST                          TGH0ST
     I              OMH1ST                          TGH1ST
     I              OMTKDT                          TGTKDT
     I              OMTLDT                          TGTLDT
     I              OMTMDT                          TGTMDT
     I              OMUVST                          TGUVST
     I              OMUWST                          TGUWST
     I              OMUXST                          TGUXST
     I              OMAATM                          TGAATM
     I              OMAYNA                          TGAYNA
     I              OMA0NA                          TGA0NA
     I              OMAXDT                          TGAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          THRMNB
     I              FLRUNB                          THRUNB
     I              FLRVNB                          THRVNB
     I              FLDQTX                          THDQTX
     I              FLRWNB                          THRWNB
     I              FLRXNB                          THRXNB
     I              FLSQNB                          THSQNB
     I              FLT0NB                          THT0NB
     I              FLT1NB                          THT1NB
     I              FLR1NB                          THR1NB
     I              FLAIC3                          THAIC3
     I              FLC4NB                          THC4NB
     I              FLVCST                          THVCST
     I              FLKEDT                          THKEDT
     I              FLSXNB                          THSXNB
     I              FLKFDT                          THKFDT
     I              FLACTM                          THACTM
     I              FLK5TX                          THK5TX
     I              FLW5CD                          THW5CD
     I              FLEJDT                          THEJDT
     I              FLAGTM                          THAGTM
     I              FLKJDT                          THKJDT
     I              FLATTM                          THATTM
     I              FLHDDT                          THHDDT
     I              FLAUTM                          THAUTM
     I              FLKKDT                          THKKDT
     I              FLAVTM                          THAVTM
     I              FLZ4NB                          THZ4NB
     I              FLY7ST                          THY7ST
     I              FLY2ST                          THY2ST
     I              FLWHTX                          THWHTX
     I              FLWITX                          THWITX
     I              FLWJTX                          THWJTX
     I              FLWKTX                          THWKTX
     I              FLWLTX                          THWLTX
     I              FLN7DT                          THN7DT
     I              FLN8DT                          THN8DT
     I              FLN9DT                          THN9DT
     I              FLB3TM                          THB3TM
     I              FLB4TM                          THB4TM
     I              FLB5TM                          THB5TM
     I              FLIASX                          THIASX
     I              FLIBSX                          THIBSX
     I              FLICSX                          THICSX
     I              FLWVTX                          THWVTX
     I              FLWWTX                          THWWTX
     I              FLWXTX                          THWXTX
     I              FLUVST                          THUVST
     I              FLUWST                          THUWST
     I              FLUXST                          THUXST
     I              FLAATM                          THAATM
     I              FLAYNA                          THAYNA
     I              FLA0NA                          THA0NA
     I              FLAXDT                          THAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          TIRMNB
     I              FJAIC3                          TIAIC3
     I              FJAODT                          TIAODT
     I              FJPJST                          TIPJST
     I              FJPKST                          TIPKST
     I              FJRNNB                          TIRNNB
     I              FJDMTX                          TIDMTX
     I              FJDNTX                          TIDNTX
     I              FJDOTX                          TIDOTX
     I              FJWTTX                          TIWTTX
     I              FJWUTX                          TIWUTX
     I              FJRPNB                          TIRPNB
     I              FJFLAM                          TIFLAM
     I              FJXQST                          TIXQST
     I              FJRRNB                          TIRRNB
     I              FJDXTX                          TIDXTX
     I              FJDYTX                          TIDYTX
     I              FJSBNB                          TISBNB
     I              FJBZNA                          TIBZNA
     I              FJRONB                          TIRONB
     I              FJSQNB                          TISQNB
     I              FJR1NB                          TIR1NB
     I              FJVCST                          TIVCST
     I              FJVDST                          TIVDST
     I              FJSDNB                          TISDNB
     I              FJPAOU                          TIPAOU
     I              FJDGWG                          TIDGWG
     I              FJSXNB                          TISXNB
     I              FJHADT                          TIHADT
     I              FJAART                          TIAART
     I              FJDHWG                          TIDHWG
     I              FJDIWG                          TIDIWG
     I              FJAQDT                          TIAQDT
     I              FJS6NB                          TIS6NB
     I              FJT4NB                          TIT4NB
     I              FJPRTM                          TIPRTM
     I              FJNPSV                          TINPSV
     I              FJJ8TX                          TIJ8TX
     I              FJTLMI                          TITLMI
     I              FJJ9TX                          TIJ9TX
     I              FJQ2CD                          TIQ2CD
     I              FJVPCD                          TIVPCD
     I              FJDBCD                          TIDBCD
     I              FJGRWE                          TIGRWE
     I              FJXCCD                          TIXCCD
     I              FJU2ST                          TIU2ST
     I              FJF9DT                          TIF9DT
     I              FJONTM                          TIONTM
     I              FJJ4DT                          TIJ4DT
     I              FJTRTM                          TITRTM
     I              FJJ5DT                          TIJ5DT
     I              FJSPTM                          TISPTM
     I              FJJ6DT                          TIJ6DT
     I              FJLFTM                          TILFTM
     I              FJJ7DT                          TIJ7DT
     I              FJBOTM                          TIBOTM
     I              FJJ8DT                          TIJ8DT
     I              FJBLTM                          TIBLTM
     I              FJKIDT                          TIKIDT
     I              FJASTM                          TIASTM
     I              FJKADT                          TIKADT
     I              FJAJCM                          TIAJCM
     I              FJXACD                          TIXACD
     I              FJOANA                          TIOANA
     I              FJK4TX                          TIK4TX
     I              FJVOAG                          TIVOAG
     I              FJKBDT                          TIKBDT
     I              FJNBBO                          TINBBO
     I              FJW4CD                          TIW4CD
     I              FJEFDT                          TIEFDT
     I              FJCNTN                          TICNTN
     I              FJKCDT                          TIKCDT
     I              FJTMIN                          TITMIN
     I              FJKDDT                          TIKDDT
     I              FJVMNB                          TIVMNB
     I              FJOCFR                          TIOCFR
     I              FJKJDT                          TIKJDT
     I              FJATTM                          TIATTM
     I              FJOTRS                          TIOTRS
     I              FJRNST                          TIRNST
     I              FJBRBK                          TIBRBK
     I              FJEIDT                          TIEIDT
     I              FJRMST                          TIRMST
     I              FJAJCD                          TIAJCD
     I              FJKKDT                          TIKKDT
     I              FJAVTM                          TIAVTM
     I              FJKZDT                          TIKZDT
     I              FJAXTM                          TIAXTM
     I              FJLHOS                          TILHOS
     I              FJLHOR                          TILHOR
     I              FJWNTX                          TIWNTX
     I              FJOITX                          TIOITX
     I              FJOJTX                          TIOJTX
     I              FJLLDT                          TILLDT
     I              FJLSHG                          TILSHG
     I              FJYPST                          TIYPST
     I              FJK0DT                          TIK0DT
     I              FJAYTM                          TIAYTM
     I              FJKNNX                          TIKNNX
     I              FJICWG                          TIICWG
     I              FJIDWG                          TIIDWG
     I              FJH9SX                          TIH9SX
     I              FJWOTX                          TIWOTX
     I              FJK1DT                          TIK1DT
     I              FJAZTM                          TIAZTM
     I              FJK2DT                          TIK2DT
     I              FJA0TM                          TIA0TM
     I              FJROST                          TIROST
     I              FJRPST                          TIRPST
     I              FJRQST                          TIRQST
     I              FJRRST                          TIRRST
     I              FJZBVA                          TIZBVA
     I              FJWPTX                          TIWPTX
     I              FJWQTX                          TIWQTX
     I              FJWRTX                          TIWRTX
     I              FJWSTX                          TIWSTX
     I              FJRVSX                          TIRVSX
     I              FJRUSX                          TIRUSX
     I              FJRWSX                          TIRWSX
     I              FJRXSX                          TIRXSX
     I              FJRYSX                          TIRYSX
     I              FJRZSX                          TIRZSX
     I              FJR0SX                          TIR0SX
     I              FJR1SX                          TIR1SX
     I              FJR2SX                          TIR2SX
     I              FJR3SX                          TIR3SX
     I              FJR4SX                          TIR4SX
     I              FJPYDT                          TIPYDT
     I              FJCKTM                          TICKTM
     I              FJPZDT                          TIPZDT
     I              FJCLTM                          TICLTM
     I              FJP0DT                          TIP0DT
     I              FJCMTM                          TICMTM
     I              FJP1DT                          TIP1DT
     I              FJCNTM                          TICNTM
     I              FJP2DT                          TIP2DT
     I              FJCOTM                          TICOTM
     I              FJP3DT                          TIP3DT
     I              FJCQTM                          TICQTM
     I              FJUVST                          TIUVST
     I              FJUWST                          TIUWST
     I              FJUXST                          TIUXST
     I              FJAATM                          TIAATM
     I              FJAYNA                          TIAYNA
     I              FJA0NA                          TIA0NA
     I              FJAXDT                          TIAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          TJAIC3
     I              OMC4NB                          TJC4NB
     I              OMDPNB                          TJDPNB
     I              OMUENB                          TJUENB
     I              OMHGCD                          TJHGCD
     I              OMAJCD                          TJAJCD
     I              OMBKC7                          TJBKC7
     I              OMCFC7                          TJCFC7
     I              OMGMST                          TJGMST
     I              OMGNST                          TJGNST
     I              OMMAVA                          TJMAVA
     I              OMKDVA                          TJKDVA
     I              OML8VA                          TJL8VA
     I              OML9VA                          TJL9VA
     I              OMGTST                          TJGTST
     I              OMGVST                          TJGVST
     I              OMGUST                          TJGUST
     I              OMQFST                          TJQFST
     I              OMAYVA                          TJAYVA
     I              OMEXDT                          TJEXDT
     I              OMLQCD                          TJLQCD
     I              OMRDCD                          TJRDCD
     I              OMQ7CD                          TJQ7CD
     I              OMBZPR                          TJBZPR
     I              OML6NB                          TJL6NB
     I              OMU1ST                          TJU1ST
     I              OMGIDT                          TJGIDT
     I              OMCRCD                          TJCRCD
     I              OMAGCD                          TJAGCD
     I              OMRZST                          TJRZST
     I              OMR0ST                          TJR0ST
     I              OMR1ST                          TJR1ST
     I              OMG7NA                          TJG7NA
     I              OMG8NA                          TJG8NA
     I              OMRPCD                          TJRPCD
     I              OMVEST                          TJVEST
     I              OMVGST                          TJVGST
     I              OMAVST                          TJAVST
     I              OMU0ST                          TJU0ST
     I              OMRFCD                          TJRFCD
     I              OMFZST                          TJFZST
     I              OMR1NB                          TJR1NB
     I              OMAVQT                          TJAVQT
     I              OMD0WG                          TJD0WG
     I              OMCCQT                          TJCCQT
     I              OMAUWG                          TJAUWG
     I              OMCBQT                          TJCBQT
     I              OMATWG                          TJATWG
     I              OMAQCS                          TJAQCS
     I              OMAGCS                          TJAGCS
     I              OMAKPR                          TJAKPR
     I              OMALPR                          TJALPR
     I              OMAUPR                          TJAUPR
     I              OMAVWG                          TJAVWG
     I              OMA4WG                          TJA4WG
     I              OMA5DT                          TJA5DT
     I              OMAODT                          TJAODT
     I              OMGNDT                          TJGNDT
     I              OMAMST                          TJAMST
     I              OMANST                          TJANST
     I              OMVAST                          TJVAST
     I              OMRGNB                          TJRGNB
     I              OMRHNB                          TJRHNB
     I              OMRINB                          TJRINB
     I              OMRBCD                          TJRBCD
     I              OMHICD                          TJHICD
     I              OMRNCD                          TJRNCD
     I              OMROCD                          TJROCD
     I              OMCXDT                          TJCXDT
     I              OMAJVN                          TJAJVN
     I              OMKXCD                          TJKXCD
     I              OMJPCD                          TJJPCD
     I              OMCQCD                          TJCQCD
     I              OMR4CD                          TJR4CD
     I              OMZ1ST                          TJZ1ST
     I              OMZ3ST                          TJZ3ST
     I              OMZ4ST                          TJZ4ST
     I              OMDUPR                          TJDUPR
     I              OMB6VL                          TJB6VL
     I              OMA1AA                          TJA1AA
     I              OMFZSX                          TJFZSX
     I              OMF0SX                          TJF0SX
     I              OMF1SX                          TJF1SX
     I              OMF2SX                          TJF2SX
     I              OMF3SX                          TJF3SX
     I              OMF4SX                          TJF4SX
     I              OMF5SX                          TJF5SX
     I              OMF6SX                          TJF6SX
     I              OMF7SX                          TJF7SX
     I              OMNTDT                          TJNTDT
     I              OMNUDT                          TJNUDT
     I              OMNVDT                          TJNVDT
     I              OMNWDT                          TJNWDT
     I              OMNXDT                          TJNXDT
     I              OMBUTM                          TJBUTM
     I              OMBVTM                          TJBVTM
     I              OMBWTM                          TJBWTM
     I              OMBXTM                          TJBXTM
     I              OMBYTM                          TJBYTM
     I              OMH5NX                          TJH5NX
     I              OMH6NX                          TJH6NX
     I              OMH7NX                          TJH7NX
     I              OMH8NX                          TJH8NX
     I              OMH9NX                          TJH9NX
     I              OMDVPR                          TJDVPR
     I              OMDWPR                          TJDWPR
     I              OMDXPR                          TJDXPR
     I              OMDYPR                          TJDYPR
     I              OMDZPR                          TJDZPR
     I              OMGSPR                          TJGSPR
     I              OMGTPR                          TJGTPR
     I              OMGUPR                          TJGUPR
     I              OMHOST                          TJHOST
     I              OMHPST                          TJHPST
     I              OMIOST                          TJIOST
     I              OMPEWG                          TJPEWG
     I              OMRINY                          TJRINY
     I              OMTIDT                          TJTIDT
     I              OMTJDT                          TJTJDT
     I              OMH2ST                          TJH2ST
     I              OMH0ST                          TJH0ST
     I              OMH1ST                          TJH1ST
     I              OMTKDT                          TJTKDT
     I              OMTLDT                          TJTLDT
     I              OMTMDT                          TJTMDT
     I              OMUVST                          TJUVST
     I              OMUWST                          TJUWST
     I              OMUXST                          TJUXST
     I              OMAATM                          TJAATM
     I              OMAYNA                          TJAYNA
     I              OMA0NA                          TJA0NA
     I              OMAXDT                          TJAXDT
      *
     I@LGCPNM
      * Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      * Renamed input format fields
     I              LGMILE                          TKMILE
     I              LGHRRQ                          TKHRRQ
     I              LGAATM                          TKAATM
     I              LGAYNA                          TKAYNA
     I              LGA0NA                          TKA0NA
     I              LGAXDT                          TKAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          TLRMNB
     I              FLRUNB                          TLRUNB
     I              FLRVNB                          TLRVNB
     I              FLDQTX                          TLDQTX
     I              FLRWNB                          TLRWNB
     I              FLRXNB                          TLRXNB
     I              FLSQNB                          TLSQNB
     I              FLT0NB                          TLT0NB
     I              FLT1NB                          TLT1NB
     I              FLR1NB                          TLR1NB
     I              FLAIC3                          TLAIC3
     I              FLC4NB                          TLC4NB
     I              FLVCST                          TLVCST
     I              FLKEDT                          TLKEDT
     I              FLSXNB                          TLSXNB
     I              FLKFDT                          TLKFDT
     I              FLACTM                          TLACTM
     I              FLK5TX                          TLK5TX
     I              FLW5CD                          TLW5CD
     I              FLEJDT                          TLEJDT
     I              FLAGTM                          TLAGTM
     I              FLKJDT                          TLKJDT
     I              FLATTM                          TLATTM
     I              FLHDDT                          TLHDDT
     I              FLAUTM                          TLAUTM
     I              FLKKDT                          TLKKDT
     I              FLAVTM                          TLAVTM
     I              FLZ4NB                          TLZ4NB
     I              FLY7ST                          TLY7ST
     I              FLY2ST                          TLY2ST
     I              FLWHTX                          TLWHTX
     I              FLWITX                          TLWITX
     I              FLWJTX                          TLWJTX
     I              FLWKTX                          TLWKTX
     I              FLWLTX                          TLWLTX
     I              FLN7DT                          TLN7DT
     I              FLN8DT                          TLN8DT
     I              FLN9DT                          TLN9DT
     I              FLB3TM                          TLB3TM
     I              FLB4TM                          TLB4TM
     I              FLB5TM                          TLB5TM
     I              FLIASX                          TLIASX
     I              FLIBSX                          TLIBSX
     I              FLICSX                          TLICSX
     I              FLWVTX                          TLWVTX
     I              FLWWTX                          TLWWTX
     I              FLWXTX                          TLWXTX
     I              FLUVST                          TLUVST
     I              FLUWST                          TLUWST
     I              FLUXST                          TLUXST
     I              FLAATM                          TLAATM
     I              FLAYNA                          TLAYNA
     I              FLA0NA                          TLA0NA
     I              FLAXDT                          TLAXDT
      *
     I@LECPM7
      * Carrier Destination Rate  Retrieval index
      * Renamed input format fields
     I              LEBZNA                          TMBZNA
     I              LEAJCD                          TMAJCD
     I              LEXECD                          TMXECD
     I              LEBGCD                          TMBGCD
     I              LENMVA                          TMNMVA
     I              LEAVTX                          TMAVTX
     I              LEEPPR                          TMEPPR
     I              LEEQPR                          TMEQPR
     I              LEERPR                          TMERPR
     I              LELUSX                          TMLUSX
     I              LELVSX                          TMLVSX
     I              LEOQDT                          TMOQDT
     I              LEORDT                          TMORDT
     I              LEGXVL                          TMGXVL
     I              LEAATM                          TMAATM
     I              LEAYNA                          TMAYNA
     I              LEA0NA                          TMA0NA
     I              LEAXDT                          TMAXDT
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          TOY1NX
     I              BUGYAA                          TOGYAA
     I              BURENA                          TORENA
     I              BUWSSX                          TOWSSX
     I              BUWUSX                          TOWUSX
     I              BUQEDT                          TOQEDT
     I              BUCUTM                          TOCUTM
     I              BUB0NY                          TOB0NY
     I              BUB1NY                          TOB1NY
     I              BUWXSX                          TOWXSX
     I              BUWVSX                          TOWVSX
     I              BUWWSX                          TOWWSX
     I              BUUWSX                          TOUWSX
     I              BUUXSX                          TOUXSX
     I              BUV3SX                          TOV3SX
     I              BUAHNY                          TOAHNY
     I              BUAINY                          TOAINY
     I              BUAJNY                          TOAJNY
     I              BUAKNY                          TOAKNY
      *
     I@LHCPBN
      * Load Order Change Log     Create Date(D)/Time/Seq
      * Renamed input format fields
     I              LHK4DT                          TRK4DT
     I              LHA1TM                          TRA1TM
     I              LHDXNB                          TRDXNB
     I              LHRMNB                          TRRMNB
     I              LHRVNB                          TRRVNB
     I              LHRVST                          TRRVST
     I              LHUJST                          TRUJST
     I              LHMNTX                          TRMNTX
     I              LHMOTX                          TRMOTX
     I              LHAYNA                          TRAYNA
     I              LHA0NA                          TRA0NA
     I              LHBZNA                          TRBZNA
     I              LHXMCD                          TRXMCD
     I              LHAIC3                          TRAIC3
     I              LHC4NB                          TRC4NB
      *
     I@LHCPQR
      * Load Order Change Log     Load ID/Seg Num-1
      * Renamed input format fields
     I              LHK4DT                          TSK4DT
     I              LHA1TM                          TSA1TM
     I              LHDXNB                          TSDXNB
     I              LHRMNB                          TSRMNB
     I              LHRVNB                          TSRVNB
     I              LHRVST                          TSRVST
     I              LHUJST                          TSUJST
     I              LHMNTX                          TSMNTX
     I              LHMOTX                          TSMOTX
     I              LHAYNA                          TSAYNA
     I              LHA0NA                          TSA0NA
     I              LHBZNA                          TSBZNA
     I              LHXMCD                          TSXMCD
     I              LHAIC3                          TSAIC3
     I              LHC4NB                          TSC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          TTK4DT
     I              LHA1TM                          TTA1TM
     I              LHDXNB                          TTDXNB
     I              LHRMNB                          TTRMNB
     I              LHRVNB                          TTRVNB
     I              LHRVST                          TTRVST
     I              LHUJST                          TTUJST
     I              LHMNTX                          TTMNTX
     I              LHMOTX                          TTMOTX
     I              LHAYNA                          TTAYNA
     I              LHA0NA                          TTA0NA
     I              LHBZNA                          TTBZNA
     I              LHXMCD                          TTXMCD
     I              LHAIC3                          TTAIC3
     I              LHC4NB                          TTC4NB
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          TVDOCD
     I              DPAUNA                          TVAUNA
     I              DPI5ST                          TVI5ST
     I              DPBXTX                          TVBXTX
     I              DPM8NB                          TVM8NB
     I              DPUVST                          TVUVST
     I              DPUWST                          TVUWST
     I              DPUXST                          TVUXST
     I              DPVSST                          TVVSST
     I              DPAATM                          TVAATM
     I              DPAYNA                          TVAYNA
     I              DPA0NA                          TVA0NA
     I              DPAXDT                          TVAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          TWAIC3
     I              BEC4NB                          TWC4NB
     I              BEJNCD                          TWJNCD
     I              BEANC7                          TWANC7
     I              BEBKC7                          TWBKC7
     I              BEBRTX                          TWBRTX
     I              BEHMNA                          TWHMNA
     I              BEHONA                          TWHONA
     I              BEHPNA                          TWHPNA
     I              BEHNNA                          TWHNNA
     I              BEDBCD                          TWDBCD
     I              BECKTX                          TWCKTX
     I              BEB0C7                          TWB0C7
     I              BEAETX                          TWAETX
     I              BEB1NA                          TWB1NA
     I              BEB3NA                          TWB3NA
     I              BEB4NA                          TWB4NA
     I              BEB2NA                          TWB2NA
     I              BEBHCD                          TWBHCD
     I              BEC8TX                          TWC8TX
     I              BEBCNA                          TWBCNA
     I              BEA0DT                          TWA0DT
     I              BEA5DT                          TWA5DT
     I              BEGNDT                          TWGNDT
     I              BEACDT                          TWACDT
     I              BEAQCD                          TWAQCD
     I              BEB6NA                          TWB6NA
     I              BEBYNA                          TWBYNA
     I              BEBZNA                          TWBZNA
     I              BEGTST                          TWGTST
     I              BEGVST                          TWGVST
     I              BEGUST                          TWGUST
     I              BEQFST                          TWQFST
     I              BECQCD                          TWCQCD
     I              BEGJST                          TWGJST
     I              BEGWST                          TWGWST
     I              BEGXST                          TWGXST
     I              BEGYST                          TWGYST
     I              BEAODT                          TWAODT
     I              BEAIVN                          TWAIVN
     I              BECXDT                          TWCXDT
     I              BEJZVA                          TWJZVA
     I              BEA1WG                          TWA1WG
     I              BEXIST                          TWXIST
     I              BEXJST                          TWXJST
     I              BEXKST                          TWXKST
     I              BEEIDT                          TWEIDT
     I              BEAFTM                          TWAFTM
     I              BEE8CD                          TWE8CD
     I              BEE9CD                          TWE9CD
     I              BERMNB                          TWRMNB
     I              BETBNB                          TWTBNB
     I              BER1NB                          TWR1NB
     I              BEPJST                          TWPJST
     I              BEU0ST                          TWU0ST
     I              BEU1ST                          TWU1ST
     I              BEQ2CD                          TWQ2CD
     I              BEU2ST                          TWU2ST
     I              BEVEST                          TWVEST
     I              BEVFST                          TWVFST
     I              BEVGST                          TWVGST
     I              BERPCD                          TWRPCD
     I              BERNNB                          TWRNNB
     I              BEVDST                          TWVDST
     I              BEATIN                          TWATIN
     I              BEU4ST                          TWU4ST
     I              BEU5ST                          TWU5ST
     I              BERSRN                          TWRSRN
     I              BEMHNA                          TWMHNA
     I              BEMINA                          TWMINA
     I              BEWBST                          TWWBST
     I              BER4CD                          TWR4CD
     I              BEBFCD                          TWBFCD
     I              BEQ4CD                          TWQ4CD
     I              BET3NB                          TWT3NB
     I              BESICD                          TWSICD
     I              BECONB                          TWCONB
     I              BECEST                          TWCEST
     I              BEAWDT                          TWAWDT
     I              BEJPCD                          TWJPCD
     I              BEXUST                          TWXUST
     I              BEZ1ST                          TWZ1ST
     I              BEVRVA                          TWVRVA
     I              BEOBST                          TWOBST
     I              BEBCST                          TWBCST
     I              BEBDST                          TWBDST
     I              BEB7VL                          TWB7VL
     I              BEGASX                          TWGASX
     I              BEGBSX                          TWGBSX
     I              BEGCSX                          TWGCSX
     I              BEGDSX                          TWGDSX
     I              BEFNSX                          TWFNSX
     I              BEFOSX                          TWFOSX
     I              BEFPSX                          TWFPSX
     I              BEFQSX                          TWFQSX
     I              BEFRSX                          TWFRSX
     I              BEFSSX                          TWFSSX
     I              BEFTSX                          TWFTSX
     I              BEFUSX                          TWFUSX
     I              BEFVSX                          TWFVSX
     I              BEFWSX                          TWFWSX
     I              BEFXSX                          TWFXSX
     I              BEFYSX                          TWFYSX
     I              BENODT                          TWNODT
     I              BENPDT                          TWNPDT
     I              BENQDT                          TWNQDT
     I              BENRDT                          TWNRDT
     I              BENSDT                          TWNSDT
     I              BEBPTM                          TWBPTM
     I              BEBQTM                          TWBQTM
     I              BEBRTM                          TWBRTM
     I              BEBSTM                          TWBSTM
     I              BEBTTM                          TWBTTM
     I              BEH0NX                          TWH0NX
     I              BEH1NX                          TWH1NX
     I              BEH2NX                          TWH2NX
     I              BEH3NX                          TWH3NX
     I              BEH4NX                          TWH4NX
     I              BEC0C7                          TWC0C7
     I              BEUVST                          TWUVST
     I              BEUWST                          TWUWST
     I              BEUXST                          TWUXST
     I              BEAATM                          TWAATM
     I              BEAYNA                          TWAYNA
     I              BEA0NA                          TWA0NA
     I              BEAXDT                          TWAXDT
      *
     I@CRCPXL
      * TMS Load                  Update index
      * Renamed input format fields
     I              CRTMLD                          TXTMLD
     I              CRAYD8                          TXAYD8
     I              CRAFTH                          TXAFTH
     I              CRFSU1                          TXFSU1
     I              CRUPAA                          TXUPAA
     I              CRLTMP                          TXLTMP
     I              CRDFSC                          TXDFSC
     I              CRDGSC                          TXDGSC
     I              CRDHSC                          TXDHSC
     I              CRDISC                          TXDISC
     I              CRDJSC                          TXDJSC
     I              CRDKSC                          TXDKSC
     I              CRUQAA                          TXUQAA
     I              CRURAA                          TXURAA
     I              CRUSAA                          TXUSAA
     I              CRCRDS                          TXCRDS
     I              CRAZD8                          TXAZD8
     I              CRAGTH                          TXAGTH
     I              CRUTAA                          TXUTAA
     I              CRUUAA                          TXUUAA
     I              CRUVAA                          TXUVAA
     I              CRUWAA                          TXUWAA
     I              CRUXAA                          TXUXAA
     I              CRFJU1                          TXFJU1
     I              CRFKU1                          TXFKU1
     I              CRFLU1                          TXFLU1
     I              CRFMU1                          TXFMU1
     I              CRFNU1                          TXFNU1
     I              CRFOU1                          TXFOU1
     I              CRFPU1                          TXFPU1
     I              CRFQU1                          TXFQU1
     I              CRA7D8                          TXA7D8
     I              CRA8D8                          TXA8D8
     I              CRP4U1                          TXP4U1
     I              CRDLSC                          TXDLSC
     I              CRTPRC                          TXTPRC
     I              CRUYAA                          TXUYAA
     I              CRA0D8                          TXA0D8
     I              CRD9TM                          TXD9TM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBCU1    E DSPBCUCPL0
      * UPD : TMS Load Event Shipment   Update index
      * Renamed input format fields
     I              CUTMLD                          WGTMLD
     I              CUAYD8                          WGAYD8
     I              CUAFTH                          WGAFTH
     I              CUFSU1                          WGFSU1
     I              CUEVSQ                          WGEVSQ
     I              CUTMOR                          WGTMOR
     I              CUHFNB                          WGHFNB
     I              CUDLSC                          WGDLSC
     I              CUTPRC                          WGTPRC
     I              CUUYAA                          WGUYAA
     I              CUA0D8                          WGA0D8
     I              CUD9TM                          WGD9TM
      *
     IYARDCS      DS                             73
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFF1    E DSOMFFREL1
      * UPD : Carrier                   Update index
      * Renamed input format fields
     I              FFBZNA                          WMBZNA
     I              FFADTX                          WMADTX
     I              FFACNA                          WMACNA
     I              FFADNA                          WMADNA
     I              FFAENA                          WMAENA
     I              FFAJNA                          WMAJNA
     I              FFBTTX                          WMBTTX
     I              FFEZNB                          WMEZNB
     I              FFBGCD                          WMBGCD
     I              FFEEDT                          WMEEDT
     I              FFDUTX                          WMDUTX
     I              FFNRVA                          WMNRVA
     I              FFNSVA                          WMNSVA
     I              FFNTVA                          WMNTVA
     I              FFNUVA                          WMNUVA
     I              FFP1ST                          WMP1ST
     I              FFDVTX                          WMDVTX
     I              FFDWTX                          WMDWTX
     I              FFLVCD                          WMLVCD
     I              FFS8NB                          WMS8NB
     I              FFS9NB                          WMS9NB
     I              FFNMVA                          WMNMVA
     I              FFNOVA                          WMNOVA
     I              FFNPVA                          WMNPVA
     I              FFNQVA                          WMNQVA
     I              FFMFCD                          WMMFCD
     I              FFQXNB                          WMQXNB
     I              FFQ1NB                          WMQ1NB
     I              FFMRNG                          WMMRNG
     I              FFMRNE                          WMMRNE
     I              FFRFNB                          WMRFNB
     I              FFMREG                          WMMREG
     I              FFBQPR                          WMBQPR
     I              FFBRPR                          WMBRPR
     I              FFBSPR                          WMBSPR
     I              FFBTPR                          WMBTPR
     I              FFBUPR                          WMBUPR
     I              FFBVPR                          WMBVPR
     I              FFDJWG                          WMDJWG
     I              FFDKWG                          WMDKWG
     I              FFDLWG                          WMDLWG
     I              FFDMWG                          WMDMWG
     I              FFDNWG                          WMDNWG
     I              FFDOWG                          WMDOWG
     I              FFB2PR                          WMB2PR
     I              FFB3PR                          WMB3PR
     I              FFB4PR                          WMB4PR
     I              FFB5PR                          WMB5PR
     I              FFB6PR                          WMB6PR
     I              FFB7PR                          WMB7PR
     I              FFAAC7                          WMAAC7
     I              FFCOFI                          WMCOFI
     I              FFK6TX                          WMK6TX
     I              FFOCNA                          WMOCNA
     I              FFODNA                          WMODNA
     I              FFW7CD                          WMW7CD
     I              FFK7TX                          WMK7TX
     I              FFTENO                          WMTENO
     I              FFK8TX                          WMK8TX
     I              FFAOFC                          WMAOFC
     I              FFAOLI                          WMAOLI
     I              FFKHDT                          WMKHDT
     I              FFUNUS                          WMUNUS
     I              FFUNU2                          WMUNU2
     I              FFUNU3                          WMUNU3
     I              FFUVST                          WMUVST
     I              FFUWST                          WMUWST
     I              FFUXST                          WMUXST
     I              FFVSST                          WMVSST
     I              FFAATM                          WMAATM
     I              FFAYNA                          WMAYNA
     I              FFA0NA                          WMA0NA
     I              FFAXDT                          WMAXDT
      *
     IYBRDCS      DS                            641
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WSRMNB
     I              FJAIC3                          WSAIC3
     I              FJAODT                          WSAODT
     I              FJPJST                          WSPJST
     I              FJPKST                          WSPKST
     I              FJRNNB                          WSRNNB
     I              FJDMTX                          WSDMTX
     I              FJDNTX                          WSDNTX
     I              FJDOTX                          WSDOTX
     I              FJWTTX                          WSWTTX
     I              FJWUTX                          WSWUTX
     I              FJRPNB                          WSRPNB
     I              FJFLAM                          WSFLAM
     I              FJXQST                          WSXQST
     I              FJRRNB                          WSRRNB
     I              FJDXTX                          WSDXTX
     I              FJDYTX                          WSDYTX
     I              FJSBNB                          WSSBNB
     I              FJBZNA                          WSBZNA
     I              FJRONB                          WSRONB
     I              FJSQNB                          WSSQNB
     I              FJR1NB                          WSR1NB
     I              FJVCST                          WSVCST
     I              FJVDST                          WSVDST
     I              FJSDNB                          WSSDNB
     I              FJPAOU                          WSPAOU
     I              FJDGWG                          WSDGWG
     I              FJSXNB                          WSSXNB
     I              FJHADT                          WSHADT
     I              FJAART                          WSAART
     I              FJDHWG                          WSDHWG
     I              FJDIWG                          WSDIWG
     I              FJAQDT                          WSAQDT
     I              FJS6NB                          WSS6NB
     I              FJT4NB                          WST4NB
     I              FJPRTM                          WSPRTM
     I              FJNPSV                          WSNPSV
     I              FJJ8TX                          WSJ8TX
     I              FJTLMI                          WSTLMI
     I              FJJ9TX                          WSJ9TX
     I              FJQ2CD                          WSQ2CD
     I              FJVPCD                          WSVPCD
     I              FJDBCD                          WSDBCD
     I              FJGRWE                          WSGRWE
     I              FJXCCD                          WSXCCD
     I              FJU2ST                          WSU2ST
     I              FJF9DT                          WSF9DT
     I              FJONTM                          WSONTM
     I              FJJ4DT                          WSJ4DT
     I              FJTRTM                          WSTRTM
     I              FJJ5DT                          WSJ5DT
     I              FJSPTM                          WSSPTM
     I              FJJ6DT                          WSJ6DT
     I              FJLFTM                          WSLFTM
     I              FJJ7DT                          WSJ7DT
     I              FJBOTM                          WSBOTM
     I              FJJ8DT                          WSJ8DT
     I              FJBLTM                          WSBLTM
     I              FJKIDT                          WSKIDT
     I              FJASTM                          WSASTM
     I              FJKADT                          WSKADT
     I              FJAJCM                          WSAJCM
     I              FJXACD                          WSXACD
     I              FJOANA                          WSOANA
     I              FJK4TX                          WSK4TX
     I              FJVOAG                          WSVOAG
     I              FJKBDT                          WSKBDT
     I              FJNBBO                          WSNBBO
     I              FJW4CD                          WSW4CD
     I              FJEFDT                          WSEFDT
     I              FJCNTN                          WSCNTN
     I              FJKCDT                          WSKCDT
     I              FJTMIN                          WSTMIN
     I              FJKDDT                          WSKDDT
     I              FJVMNB                          WSVMNB
     I              FJOCFR                          WSOCFR
     I              FJKJDT                          WSKJDT
     I              FJATTM                          WSATTM
     I              FJOTRS                          WSOTRS
     I              FJRNST                          WSRNST
     I              FJBRBK                          WSBRBK
     I              FJEIDT                          WSEIDT
     I              FJRMST                          WSRMST
     I              FJAJCD                          WSAJCD
     I              FJKKDT                          WSKKDT
     I              FJAVTM                          WSAVTM
     I              FJKZDT                          WSKZDT
     I              FJAXTM                          WSAXTM
     I              FJLHOS                          WSLHOS
     I              FJLHOR                          WSLHOR
     I              FJWNTX                          WSWNTX
     I              FJOITX                          WSOITX
     I              FJOJTX                          WSOJTX
     I              FJLLDT                          WSLLDT
     I              FJLSHG                          WSLSHG
     I              FJYPST                          WSYPST
     I              FJK0DT                          WSK0DT
     I              FJAYTM                          WSAYTM
     I              FJKNNX                          WSKNNX
     I              FJICWG                          WSICWG
     I              FJIDWG                          WSIDWG
     I              FJH9SX                          WSH9SX
     I              FJWOTX                          WSWOTX
     I              FJK1DT                          WSK1DT
     I              FJAZTM                          WSAZTM
     I              FJK2DT                          WSK2DT
     I              FJA0TM                          WSA0TM
     I              FJROST                          WSROST
     I              FJRPST                          WSRPST
     I              FJRQST                          WSRQST
     I              FJRRST                          WSRRST
     I              FJZBVA                          WSZBVA
     I              FJWPTX                          WSWPTX
     I              FJWQTX                          WSWQTX
     I              FJWRTX                          WSWRTX
     I              FJWSTX                          WSWSTX
     I              FJRVSX                          WSRVSX
     I              FJRUSX                          WSRUSX
     I              FJRWSX                          WSRWSX
     I              FJRXSX                          WSRXSX
     I              FJRYSX                          WSRYSX
     I              FJRZSX                          WSRZSX
     I              FJR0SX                          WSR0SX
     I              FJR1SX                          WSR1SX
     I              FJR2SX                          WSR2SX
     I              FJR3SX                          WSR3SX
     I              FJR4SX                          WSR4SX
     I              FJPYDT                          WSPYDT
     I              FJCKTM                          WSCKTM
     I              FJPZDT                          WSPZDT
     I              FJCLTM                          WSCLTM
     I              FJP0DT                          WSP0DT
     I              FJCMTM                          WSCMTM
     I              FJP1DT                          WSP1DT
     I              FJCNTM                          WSCNTM
     I              FJP2DT                          WSP2DT
     I              FJCOTM                          WSCOTM
     I              FJP3DT                          WSP3DT
     I              FJCQTM                          WSCQTM
     I              FJUVST                          WSUVST
     I              FJUWST                          WSUWST
     I              FJUXST                          WSUXST
     I              FJAATM                          WSAATM
     I              FJAYNA                          WSAYNA
     I              FJA0NA                          WSA0NA
     I              FJAXDT                          WSAXDT
      *
     IQPBCS1    E DSPBCSCPL0
      * UPD : TMS Load Event            Update index
      * Renamed input format fields
     I              CSTMLD                          WTTMLD
     I              CSAYD8                          WTAYD8
     I              CSAFTH                          WTAFTH
     I              CSFSU1                          WTFSU1
     I              CSEVSQ                          WTEVSQ
     I              CSDMSC                          WTDMSC
     I              CSA1D8                          WTA1D8
     I              CSAHTH                          WTAHTH
     I              CSA2D8                          WTA2D8
     I              CSAITH                          WTAITH
     I              CSA3D8                          WTA3D8
     I              CSAJTH                          WTAJTH
     I              CSA4D8                          WTA4D8
     I              CSAKTH                          WTAKTH
     I              CSDNSC                          WTDNSC
     I              CSUZAA                          WTUZAA
     I              CSFFU1                          WTFFU1
     I              CSUGU1                          WTUGU1
     I              CSFHU1                          WTFHU1
     I              CSU0AA                          WTU0AA
     I              CSU1AA                          WTU1AA
     I              CSU3AA                          WTU3AA
     I              CSU4AA                          WTU4AA
     I              CSG1NB                          WTG1NB
     I              CSDOSC                          WTDOSC
     I              CSA6D8                          WTA6D8
     I              CSAMTH                          WTAMTH
     I              CSA9D8                          WTA9D8
     I              CSANTH                          WTANTH
     I              CSVBAA                          WTVBAA
     I              CSP5U1                          WTP5U1
     I              CSDLSC                          WTDLSC
     I              CSTPRC                          WTTPRC
     I              CSUYAA                          WTUYAA
     I              CSA0D8                          WTA0D8
     I              CSD9TM                          WTD9TM
      *
     IYCRDCS      DS                            485
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WXAIC3
     I              BEC4NB                          WXC4NB
     I              BEJNCD                          WXJNCD
     I              BEANC7                          WXANC7
     I              BEBKC7                          WXBKC7
     I              BEBRTX                          WXBRTX
     I              BEHMNA                          WXHMNA
     I              BEHONA                          WXHONA
     I              BEHPNA                          WXHPNA
     I              BEHNNA                          WXHNNA
     I              BEDBCD                          WXDBCD
     I              BECKTX                          WXCKTX
     I              BEB0C7                          WXB0C7
     I              BEAETX                          WXAETX
     I              BEB1NA                          WXB1NA
     I              BEB3NA                          WXB3NA
     I              BEB4NA                          WXB4NA
     I              BEB2NA                          WXB2NA
     I              BEBHCD                          WXBHCD
     I              BEC8TX                          WXC8TX
     I              BEBCNA                          WXBCNA
     I              BEA0DT                          WXA0DT
     I              BEA5DT                          WXA5DT
     I              BEGNDT                          WXGNDT
     I              BEACDT                          WXACDT
     I              BEAQCD                          WXAQCD
     I              BEB6NA                          WXB6NA
     I              BEBYNA                          WXBYNA
     I              BEBZNA                          WXBZNA
     I              BEGTST                          WXGTST
     I              BEGVST                          WXGVST
     I              BEGUST                          WXGUST
     I              BEQFST                          WXQFST
     I              BECQCD                          WXCQCD
     I              BEGJST                          WXGJST
     I              BEGWST                          WXGWST
     I              BEGXST                          WXGXST
     I              BEGYST                          WXGYST
     I              BEAODT                          WXAODT
     I              BEAIVN                          WXAIVN
     I              BECXDT                          WXCXDT
     I              BEJZVA                          WXJZVA
     I              BEA1WG                          WXA1WG
     I              BEXIST                          WXXIST
     I              BEXJST                          WXXJST
     I              BEXKST                          WXXKST
     I              BEEIDT                          WXEIDT
     I              BEAFTM                          WXAFTM
     I              BEE8CD                          WXE8CD
     I              BEE9CD                          WXE9CD
     I              BERMNB                          WXRMNB
     I              BETBNB                          WXTBNB
     I              BER1NB                          WXR1NB
     I              BEPJST                          WXPJST
     I              BEU0ST                          WXU0ST
     I              BEU1ST                          WXU1ST
     I              BEQ2CD                          WXQ2CD
     I              BEU2ST                          WXU2ST
     I              BEVEST                          WXVEST
     I              BEVFST                          WXVFST
     I              BEVGST                          WXVGST
     I              BERPCD                          WXRPCD
     I              BERNNB                          WXRNNB
     I              BEVDST                          WXVDST
     I              BEATIN                          WXATIN
     I              BEU4ST                          WXU4ST
     I              BEU5ST                          WXU5ST
     I              BERSRN                          WXRSRN
     I              BEMHNA                          WXMHNA
     I              BEMINA                          WXMINA
     I              BEWBST                          WXWBST
     I              BER4CD                          WXR4CD
     I              BEBFCD                          WXBFCD
     I              BEQ4CD                          WXQ4CD
     I              BET3NB                          WXT3NB
     I              BESICD                          WXSICD
     I              BECONB                          WXCONB
     I              BECEST                          WXCEST
     I              BEAWDT                          WXAWDT
     I              BEJPCD                          WXJPCD
     I              BEXUST                          WXXUST
     I              BEZ1ST                          WXZ1ST
     I              BEVRVA                          WXVRVA
     I              BEOBST                          WXOBST
     I              BEBCST                          WXBCST
     I              BEBDST                          WXBDST
     I              BEB7VL                          WXB7VL
     I              BEGASX                          WXGASX
     I              BEGBSX                          WXGBSX
     I              BEGCSX                          WXGCSX
     I              BEGDSX                          WXGDSX
     I              BEFNSX                          WXFNSX
     I              BEFOSX                          WXFOSX
     I              BEFPSX                          WXFPSX
     I              BEFQSX                          WXFQSX
     I              BEFRSX                          WXFRSX
     I              BEFSSX                          WXFSSX
     I              BEFTSX                          WXFTSX
     I              BEFUSX                          WXFUSX
     I              BEFVSX                          WXFVSX
     I              BEFWSX                          WXFWSX
     I              BEFXSX                          WXFXSX
     I              BEFYSX                          WXFYSX
     I              BENODT                          WXNODT
     I              BENPDT                          WXNPDT
     I              BENQDT                          WXNQDT
     I              BENRDT                          WXNRDT
     I              BENSDT                          WXNSDT
     I              BEBPTM                          WXBPTM
     I              BEBQTM                          WXBQTM
     I              BEBRTM                          WXBRTM
     I              BEBSTM                          WXBSTM
     I              BEBTTM                          WXBTTM
     I              BEH0NX                          WXH0NX
     I              BEH1NX                          WXH1NX
     I              BEH2NX                          WXH2NX
     I              BEH3NX                          WXH3NX
     I              BEH4NX                          WXH4NX
     I              BEC0C7                          WXC0C7
     I              BEUVST                          WXUVST
     I              BEUWST                          WXUWST
     I              BEUXST                          WXUXST
     I              BEAATM                          WXAATM
     I              BEAYNA                          WXAYNA
     I              BEA0NA                          WXA0NA
     I              BEAXDT                          WXAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          TAAIC3
     I              AMC4NB                          TAC4NB
     I              AMRMNB                          TARMNB
     I              AMRUNB                          TARUNB
     I              AMXACD                          TAXACD
     I              AMOANA                          TAOANA
     I              AMHBAA                          TAHBAA
     I              AMJ0T1                          TAJ0T1
     I              AMGENY                          TAGENY
     I              AMJ1T1                          TAJ1T1
     I              AMHCAA                          TAHCAA
     I              AMQWDT                          TAQWDT
     I              AMQXDT                          TAQXDT
     I              AMQYDT                          TAQYDT
     I              AMHDAA                          TAHDAA
     I              AMCCTX                          TACCTX
     I              AMJ2T1                          TAJ2T1
     I              AMRLNA                          TARLNA
     I              AMRMNA                          TARMNA
     I              AMGINY                          TAGINY
     I              AMGFNY                          TAGFNY
     I              AMGGNY                          TAGGNY
     I              AMGHNY                          TAGHNY
     I              AMHEVL                          TAHEVL
     I              AMHFVL                          TAHFVL
     I              AMHGVL                          TAHGVL
     I              AMQZDT                          TAQZDT
     I              AMQ0DT                          TAQ0DT
     I              AMQ1DT                          TAQ1DT
     I              AMQ2DT                          TAQ2DT
     I              AMC2TX                          TAC2TX
     I              AMC3TX                          TAC3TX
     I              AMC6TX                          TAC6TX
     I              AMCHTX                          TACHTX
     I              AMCITX                          TACITX
     I              AMCLTX                          TACLTX
     I              AMB4TX                          TAB4TX
     I              AMCUTX                          TACUTX
     I              AMCVTX                          TACVTX
     I              AMB9TX                          TAB9TX
     I              AMJWSC                          TAJWSC
     I              AMITNY                          TAITNY
     I              AMLMT1                          TALMT1
     I              AMLWAA                          TALWAA
     I              AMFVST                          TAFVST
     I              AMF0ST                          TAF0ST
     I              AMF2ST                          TAF2ST
     I              AMF3ST                          TAF3ST
     I              AMJUSC                          TAJUSC
     I              AMJVSC                          TAJVSC
     I              AMV3T1                          TAV3T1
     I              AMV4T1                          TAV4T1
     I              AMV5T1                          TAV5T1
     I              AMV6T1                          TAV6T1
     I              AMV7T1                          TAV7T1
     I              AMV8T1                          TAV8T1
     I              AMV9T1                          TAV9T1
     I              AMWAT1                          TAWAT1
     I              AMWBT1                          TAWBT1
     I              AMWCT1                          TAWCT1
     I              AMWDT1                          TAWDT1
     I              AMQJNY                          TAQJNY
     I              AMQKNY                          TAQKNY
     I              AMQLNY                          TAQLNY
     I              AMP8NY                          TAP8NY
     I              AMP9NY                          TAP9NY
     I              AMQANY                          TAQANY
     I              AMQCNY                          TAQCNY
     I              AMQDNY                          TAQDNY
     I              AMQENY                          TAQENY
     I              AMQFNY                          TAQFNY
     I              AMQGNY                          TAQGNY
     I              AMQHNY                          TAQHNY
     I              AMQINY                          TAQINY
     I              AMQMNY                          TAQMNY
     I              AMMYU1                          TAMYU1
     I              AMJXSC                          TAJXSC
     I              AMJYSC                          TAJYSC
     I              AMJZSC                          TAJZSC
     I              AMJ0SC                          TAJ0SC
     I              AMMZU1                          TAMZU1
     I              AMM0U1                          TAM0U1
     I              AMM1U1                          TAM1U1
     I              AMM2U1                          TAM2U1
     I              AMM3U1                          TAM3U1
     I              AMW5DT                          TAW5DT
     I              AMW6DT                          TAW6DT
     I              AMUVST                          TAUVST
     I              AMUWST                          TAUWST
     I              AMUXST                          TAUXST
     I              AMVSST                          TAVSST
     I              AMAATM                          TAAATM
     I              AMAYNA                          TAAYNA
     I              AMA0NA                          TAA0NA
     I              AMAXDT                          TAAXDT
      *
     IYERDCS      DS                            894
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          TBRMNB
     I              FLRUNB                          TBRUNB
     I              FLRVNB                          TBRVNB
     I              FLDQTX                          TBDQTX
     I              FLRWNB                          TBRWNB
     I              FLRXNB                          TBRXNB
     I              FLSQNB                          TBSQNB
     I              FLT0NB                          TBT0NB
     I              FLT1NB                          TBT1NB
     I              FLR1NB                          TBR1NB
     I              FLAIC3                          TBAIC3
     I              FLC4NB                          TBC4NB
     I              FLVCST                          TBVCST
     I              FLKEDT                          TBKEDT
     I              FLSXNB                          TBSXNB
     I              FLKFDT                          TBKFDT
     I              FLACTM                          TBACTM
     I              FLK5TX                          TBK5TX
     I              FLW5CD                          TBW5CD
     I              FLEJDT                          TBEJDT
     I              FLAGTM                          TBAGTM
     I              FLKJDT                          TBKJDT
     I              FLATTM                          TBATTM
     I              FLHDDT                          TBHDDT
     I              FLAUTM                          TBAUTM
     I              FLKKDT                          TBKKDT
     I              FLAVTM                          TBAVTM
     I              FLZ4NB                          TBZ4NB
     I              FLY7ST                          TBY7ST
     I              FLY2ST                          TBY2ST
     I              FLWHTX                          TBWHTX
     I              FLWITX                          TBWITX
     I              FLWJTX                          TBWJTX
     I              FLWKTX                          TBWKTX
     I              FLWLTX                          TBWLTX
     I              FLN7DT                          TBN7DT
     I              FLN8DT                          TBN8DT
     I              FLN9DT                          TBN9DT
     I              FLB3TM                          TBB3TM
     I              FLB4TM                          TBB4TM
     I              FLB5TM                          TBB5TM
     I              FLIASX                          TBIASX
     I              FLIBSX                          TBIBSX
     I              FLICSX                          TBICSX
     I              FLWVTX                          TBWVTX
     I              FLWWTX                          TBWWTX
     I              FLWXTX                          TBWXTX
     I              FLUVST                          TBUVST
     I              FLUWST                          TBUWST
     I              FLUXST                          TBUXST
     I              FLAATM                          TBAATM
     I              FLAYNA                          TBAYNA
     I              FLA0NA                          TBA0NA
     I              FLAXDT                          TBAXDT
      *
     IYFRDCS      DS                            894
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          TEAIC3
     I              EYC4NB                          TEC4NB
     I              EYQ2NB                          TEQ2NB
     I              EYJPCD                          TEJPCD
     I              EYAUC3                          TEAUC3
     I              EYQ7NB                          TEQ7NB
     I              EYOMST                          TEOMST
     I              EYD2DT                          TED2DT
     I              EYONST                          TEONST
     I              EYOOST                          TEOOST
     I              EYOPST                          TEOPST
     I              EYAWC3                          TEAWC3
     I              EYQ8NB                          TEQ8NB
     I              EYQ9NB                          TEQ9NB
     I              EYBKC7                          TEBKC7
     I              EYUVST                          TEUVST
     I              EYUWST                          TEUWST
     I              EYUXST                          TEUXST
     I              EYAATM                          TEAATM
     I              EYAYNA                          TEAYNA
     I              EYA0NA                          TEA0NA
     I              EYAXDT                          TEAXDT
      *
     IYGRDCS      DS                            779
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TGAIC3
     I              OMC4NB                          TGC4NB
     I              OMDPNB                          TGDPNB
     I              OMUENB                          TGUENB
     I              OMHGCD                          TGHGCD
     I              OMAJCD                          TGAJCD
     I              OMBKC7                          TGBKC7
     I              OMCFC7                          TGCFC7
     I              OMGMST                          TGGMST
     I              OMGNST                          TGGNST
     I              OMMAVA                          TGMAVA
     I              OMKDVA                          TGKDVA
     I              OML8VA                          TGL8VA
     I              OML9VA                          TGL9VA
     I              OMGTST                          TGGTST
     I              OMGVST                          TGGVST
     I              OMGUST                          TGGUST
     I              OMQFST                          TGQFST
     I              OMAYVA                          TGAYVA
     I              OMEXDT                          TGEXDT
     I              OMLQCD                          TGLQCD
     I              OMRDCD                          TGRDCD
     I              OMQ7CD                          TGQ7CD
     I              OMBZPR                          TGBZPR
     I              OML6NB                          TGL6NB
     I              OMU1ST                          TGU1ST
     I              OMGIDT                          TGGIDT
     I              OMCRCD                          TGCRCD
     I              OMAGCD                          TGAGCD
     I              OMRZST                          TGRZST
     I              OMR0ST                          TGR0ST
     I              OMR1ST                          TGR1ST
     I              OMG7NA                          TGG7NA
     I              OMG8NA                          TGG8NA
     I              OMRPCD                          TGRPCD
     I              OMVEST                          TGVEST
     I              OMVGST                          TGVGST
     I              OMAVST                          TGAVST
     I              OMU0ST                          TGU0ST
     I              OMRFCD                          TGRFCD
     I              OMFZST                          TGFZST
     I              OMR1NB                          TGR1NB
     I              OMAVQT                          TGAVQT
     I              OMD0WG                          TGD0WG
     I              OMCCQT                          TGCCQT
     I              OMAUWG                          TGAUWG
     I              OMCBQT                          TGCBQT
     I              OMATWG                          TGATWG
     I              OMAQCS                          TGAQCS
     I              OMAGCS                          TGAGCS
     I              OMAKPR                          TGAKPR
     I              OMALPR                          TGALPR
     I              OMAUPR                          TGAUPR
     I              OMAVWG                          TGAVWG
     I              OMA4WG                          TGA4WG
     I              OMA5DT                          TGA5DT
     I              OMAODT                          TGAODT
     I              OMGNDT                          TGGNDT
     I              OMAMST                          TGAMST
     I              OMANST                          TGANST
     I              OMVAST                          TGVAST
     I              OMRGNB                          TGRGNB
     I              OMRHNB                          TGRHNB
     I              OMRINB                          TGRINB
     I              OMRBCD                          TGRBCD
     I              OMHICD                          TGHICD
     I              OMRNCD                          TGRNCD
     I              OMROCD                          TGROCD
     I              OMCXDT                          TGCXDT
     I              OMAJVN                          TGAJVN
     I              OMKXCD                          TGKXCD
     I              OMJPCD                          TGJPCD
     I              OMCQCD                          TGCQCD
     I              OMR4CD                          TGR4CD
     I              OMZ1ST                          TGZ1ST
     I              OMZ3ST                          TGZ3ST
     I              OMZ4ST                          TGZ4ST
     I              OMDUPR                          TGDUPR
     I              OMB6VL                          TGB6VL
     I              OMA1AA                          TGA1AA
     I              OMFZSX                          TGFZSX
     I              OMF0SX                          TGF0SX
     I              OMF1SX                          TGF1SX
     I              OMF2SX                          TGF2SX
     I              OMF3SX                          TGF3SX
     I              OMF4SX                          TGF4SX
     I              OMF5SX                          TGF5SX
     I              OMF6SX                          TGF6SX
     I              OMF7SX                          TGF7SX
     I              OMNTDT                          TGNTDT
     I              OMNUDT                          TGNUDT
     I              OMNVDT                          TGNVDT
     I              OMNWDT                          TGNWDT
     I              OMNXDT                          TGNXDT
     I              OMBUTM                          TGBUTM
     I              OMBVTM                          TGBVTM
     I              OMBWTM                          TGBWTM
     I              OMBXTM                          TGBXTM
     I              OMBYTM                          TGBYTM
     I              OMH5NX                          TGH5NX
     I              OMH6NX                          TGH6NX
     I              OMH7NX                          TGH7NX
     I              OMH8NX                          TGH8NX
     I              OMH9NX                          TGH9NX
     I              OMDVPR                          TGDVPR
     I              OMDWPR                          TGDWPR
     I              OMDXPR                          TGDXPR
     I              OMDYPR                          TGDYPR
     I              OMDZPR                          TGDZPR
     I              OMGSPR                          TGGSPR
     I              OMGTPR                          TGGTPR
     I              OMGUPR                          TGGUPR
     I              OMHOST                          TGHOST
     I              OMHPST                          TGHPST
     I              OMIOST                          TGIOST
     I              OMPEWG                          TGPEWG
     I              OMRINY                          TGRINY
     I              OMTIDT                          TGTIDT
     I              OMTJDT                          TGTJDT
     I              OMH2ST                          TGH2ST
     I              OMH0ST                          TGH0ST
     I              OMH1ST                          TGH1ST
     I              OMTKDT                          TGTKDT
     I              OMTLDT                          TGTLDT
     I              OMTMDT                          TGTMDT
     I              OMUVST                          TGUVST
     I              OMUWST                          TGUWST
     I              OMUXST                          TGUXST
     I              OMAATM                          TGAATM
     I              OMAYNA                          TGAYNA
     I              OMA0NA                          TGA0NA
     I              OMAXDT                          TGAXDT
      *
     IYHRDCS      DS                            525
     IYIRDCS      DS                            894
     IYJRDCS      DS                            793
     IYKRDCS      DS                            793
     IYLRDCS      DS                            367
     IYMRDCS      DS                            779
     IYNRDCS      DS                            793
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PCRMNB
      *
     IYORDCS      DS                            793
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYPRDCS      DS                            793
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          TTK4DT
     I              LHA1TM                          TTA1TM
     I              LHDXNB                          TTDXNB
     I              LHRMNB                          TTRMNB
     I              LHRVNB                          TTRVNB
     I              LHRVST                          TTRVST
     I              LHUJST                          TTUJST
     I              LHMNTX                          TTMNTX
     I              LHMOTX                          TTMOTX
     I              LHAYNA                          TTAYNA
     I              LHA0NA                          TTA0NA
     I              LHBZNA                          TTBZNA
     I              LHXMCD                          TTXMCD
     I              LHAIC3                          TTAIC3
     I              LHC4NB                          TTC4NB
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IYQRDCS      DS                            793
     IYRRDCS      DS                            367
     IYSRDCS      DS                            779
     IYTRDCS      DS                            525
     IQPBCR1    E DSPBCRCPL0
      * UPD : TMS Load                  Update index
      * Renamed input format fields
     I              CRTMLD                          TXTMLD
     I              CRAYD8                          TXAYD8
     I              CRAFTH                          TXAFTH
     I              CRFSU1                          TXFSU1
     I              CRUPAA                          TXUPAA
     I              CRLTMP                          TXLTMP
     I              CRDFSC                          TXDFSC
     I              CRDGSC                          TXDGSC
     I              CRDHSC                          TXDHSC
     I              CRDISC                          TXDISC
     I              CRDJSC                          TXDJSC
     I              CRDKSC                          TXDKSC
     I              CRUQAA                          TXUQAA
     I              CRURAA                          TXURAA
     I              CRUSAA                          TXUSAA
     I              CRCRDS                          TXCRDS
     I              CRAZD8                          TXAZD8
     I              CRAGTH                          TXAGTH
     I              CRUTAA                          TXUTAA
     I              CRUUAA                          TXUUAA
     I              CRUVAA                          TXUVAA
     I              CRUWAA                          TXUWAA
     I              CRUXAA                          TXUXAA
     I              CRFJU1                          TXFJU1
     I              CRFKU1                          TXFKU1
     I              CRFLU1                          TXFLU1
     I              CRFMU1                          TXFMU1
     I              CRFNU1                          TXFNU1
     I              CRFOU1                          TXFOU1
     I              CRFPU1                          TXFPU1
     I              CRFQU1                          TXFQU1
     I              CRA7D8                          TXA7D8
     I              CRA8D8                          TXA8D8
     I              CRP4U1                          TXP4U1
     I              CRDLSC                          TXDLSC
     I              CRTPRC                          TXTPRC
     I              CRUYAA                          TXUYAA
     I              CRA0D8                          TXA0D8
     I              CRD9TM                          TXD9TM
      *
     IYURDCS      DS                            610
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0001
      * USR CDE Parm 1
     I                                        4   6 ZA0002
      * USR CDE Parm 2
     I                                        7   9 ZA0003
      * USR CDE Parm 3
     I                                       10  12 ZA0004
      * USR CDE Parm 4
     I                                       13  15 ZA0005
      * USR CDE Parm 5
     I                                       16  18 ZA0006
      * USR CDE Parm 6
     I                                       19  21 ZA0007
      * USR CDE Parm 7
     I                                       22  24 ZA0008
      * USR CDE Parm 8
     I                                       25  27 ZA0009
      * USR CDE Parm 9
     I                                       28  30 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC Bld Lds fr TMS Upl XF
      * ** Process Loads from TMS Load uploaded file
      * Rtv Bld Lds fr TMS Upl RT - TMS Load  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv Ckh Load Dtl      RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQNA01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQNA02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQNA03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQNA04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQNA05           TMS Event Seque
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           TMS Load ID
     C                     KFLD           WQNA02           TMS Extract Dat
     C                     KFLD           WQNA03           TMS Extract Tim
     C                     KFLD           WQNA04           TMS Extract Fil
     C                     KFLD           WQNA05           TMS Event Seque
      * Setup key
     C                     Z-ADDWBTMLD    WQNA01           TMS Load ID
     C                     Z-ADDWBAYD8    WQNA02           TMS Extract Dat
     C                     Z-ADDWBAFTH    WQNA03           TMS Extract Tim
     C                     MOVELWBFSU1    WQNA04           TMS Extract Fil
     C                     Z-ADDWBEVSQ    WQNA05           TMS Event Seque
      * Establish starting position
     C           KRSNA     SETLL@CUCPXS                    *
     C           KRSNA     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order is on a different load, or no load
      * RTV Load/LdSts/Ord Sts RT - Order Header TRG  * 
     C                     EXSR NBRVGN
      * CASE: PAR.TMS Load ID NE LCL.Load ID
     C           WBTMLD    IFNE YL0110                     *IF
     C                     MOVEL'Y'       WN0042           Status Flag 1
     C                     END                             *FI
      * If stop number changed
      * RTV Chk for Unlck TMS RT - Load Detail  * 
     C                     EXSR NCRVGN
      * CASE: LCL.Stop/Drop NE DB1.TMS Event Sequence
     C           YL0111    IFNE WEEVSQ                     *IF
     C                     MOVEL'Y'       WN0042           Status Flag 1
     C                     END                             *FI
      * LATE REASON CHANGED
      * CASE: PAR.TMS Late Reason Code is Entered
     C           WBVBAA    IFGT *BLANK                     *IF
      * CASE: LCL.Load Dtl On Time Flag is On Time
     C           YL0112    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WN0047           Status Flag 2
     C                     END                             *FI
     C                     END                             *FI
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0115    PARM *ZERO     WQ0017  70       Date
     C                     PARM WBA6D8    WQ0018  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           WBAMTH    MULT 100       YL0116           Time
      * has appt date/time changed?
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.LD Carrier Appt Date NE LCL.Date
      *   |- c2    : LCL.LD Carrier Appt Time NE LCL.Time
      *   '-
     C           YL0113    IFNE YL0115                     *IF
     C           YL0114    ORNE YL0116                     *OR
      * unlock not req
     C                     MOVEL'Y'       WN0047           Status Flag 2
     C                     END                             *FI
      * CASE: If not chgs that req unlock, reset event err reasn
      *  - c2ANDc1
      *   |- c2    : PAR.Status Flag 1  Y/N is No
      *   |- c1    : DB1.TMS Error Reason is Order Event is >=03
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0042    IFEQ 'N'                        *IF
     C           WEUYAA    IFEQ @CN,016                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD1         WL0009           TMS Process Sta
     C                     MOVEL*BLANK    WL0010           TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     END                             *FI
     C           KRSNA     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV Load/LdSts/Ord Sts RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQNB01           Order Number
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQNB01           Order Number
      * Establish starting position
     C           KRSNB     SETLL@BFCPY2                    *
     C           KRSNB     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL*BLANK    YL0106           Load Status
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAIC3    YL0105           Company Number
     C                     Z-ADDWFGNDT    YL0107           Actual Shipped
     C                     MOVELWFGWST    YL0108           Header Status
     C                     Z-ADDWFAODT    YL0109           Scheduled Ship
     C                     Z-ADDWFRMNB    YL0110           Load ID
      * CASE: DB1.Header Status is Confirmed & Complete
     C           WFGWST    IFEQ 'C'                        *IF
     C           WFGWST    OREQ 'R'
     C                     MOVEL'L'       YL0106           Load Status
     C                     ELSE
      * CASE: DB1.Load ID NE WRK.ZERO
     C           WFRMNB    IFNE WUW0NB                     *IF
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFRMNB    WL0200           Load ID
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0201    YL0106    P      Load Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0106           Load Status
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSNB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Chk for Unlck TMS RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQNC02           Load ID
     C           *LIKE     DEFN WWC4NB    WQNC03           Order Number
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC02           Load ID
     C                     KFLD           WQNC03           Order Number
      * Setup key
     C                     Z-ADDWETMLD    WQNC02           Load ID
     C                     Z-ADDWETMOR    WQNC03           Order Number
      * Establish starting position
     C           KRSNC     SETLL@FLCPKF                    *
     C           KRSNC     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWRVNB    YL0111           Stop/Drop
     C                     MOVELWWY7ST    YL0112           Load Dtl On Tim
     C                     Z-ADDWWN7DT    YL0113           LD Carrier Appt
     C                     Z-ADDWWB3TM    YL0114           LD Carrier Appt
     C           KRSNC     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Chk for Ord RmTMS RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQND02           Load ID
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND02           Load ID
      * Setup key
     C                     Z-ADDWN0006    WQND02           Load ID
      * Establish starting position
     C           KRSND     SETLL@FLCPKF                    *
     C           KRSND     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Ckk for Ord Rmv   RT - TMS Load Event Shipment  * 
     C                     EXSR NERVGN
     C           KRSND     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv Ckk for Ord Rmv   RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WETMLD           TMS Load ID
     C                     KFLD           WEAYD8           TMS Extract Dat
     C                     KFLD           WEAFTH           TMS Extract Tim
     C                     KFLD           WEFSU1           TMS Extract Fil
     C                     KFLD           WEEVSQ           TMS Event Seque
     C                     KFLD           WETMOR           TMS Order ID
      * Setup key
     C                     Z-ADDWWRMNB    WETMLD           TMS Load ID
     C                     Z-ADDWAAYD8    WEAYD8           TMS Extract Dat
     C                     Z-ADDWAAFTH    WEAFTH           TMS Extract Tim
     C                     MOVELWAFSU1    WEFSU1           TMS Extract Fil
     C                     Z-ADD*ZERO     WEEVSQ           TMS Event Seque
     C                     Z-ADDWWC4NB    WETMOR           TMS Order ID
      * Establish starting position
     C           KRSNE     CHAIN@CUCPXS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4936' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y'       WN0042           Status Flag 1
     C                     GOTO NEEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV Chg from TMS      RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TIRMNB    WQNF02           Load ID
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF02           Load ID
      * Setup key
     C                     Z-ADDWN0006    WQNF02           Load ID
      * Establish starting position
     C           KRSNF     SETLL@FJCPSB                    *
     C           KRSNF     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc11ORc12ORc13ORc14ORc15OR
      *  - c16ORc17ORc18
      *   |- c1    : PAR.Company Number NE DB1.Company Number
      *   |- c2    : PAR.Scheduled Ship Date NE DB1.Scheduled Ship Date
      *   |- c3    : PAR.Total Load Order Weight NE DB1.Total Load Order
      *   |- c4    : PAR.Total Stops NE DB1.Total Stops
      *   |- c5    : PAR.TMS Trailer Number NE DB1.Trailer Id
      *   |- c6    : PAR.Carrier Code NE DB1.Carrier Code
      *   |- c7    : PAR.Total Load Miles NE DB1.Total Load Miles
      *   |- c8    : PAR.Ship From Warehouse NE DB1.Ship From Warehouse
      *   |- c9    : PAR.Ship To State Code NE DB1.Ship To State Code
      *   |- c11   : PAR.Multi Company Load NE DB1.Multi Company Load
      *   |- c12   : PAR.Total Load Order Weight NE DB1.Total Load Order
      *   |- c13   : PAR.Deadline Departure Date NE DB1.Deadline Departur
      *   |- c14   : PAR.Deadline Departure Time NE DB1.Deadline Departur
      *   |- c15   : DB1.Reefer Temperature NE PAR.Reefer Temperature
      *   |- c16   : DB1.Shipping Temp C/F txt NE PAR.Shipping Temp C/F t
      *   |- c17   : PAR.Gross Weight NE DB1.Gross Weight
      *   |- c18   : PAR.LH On-Time Reason Code NE DB1.LH On-Time Reason
      *   '-
     C           WN0007    IFNE TIAIC3                     *IF
     C           WN0008    ORNE TIAODT                     *OR
     C           YL0117    ORNE TIRPNB                     *OR
     C           WN0012    ORNE TIRRNB                     *OR
     C           WAUTAA    ORNE TIDXTX                     *OR
     C           YL0104    ORNE TIBZNA                     *OR
     C           WACRDS    ORNE TITLMI                     *OR
     C           WN0020    ORNE TIVPCD                     *OR
     C           WN0021    ORNE TIDBCD                     *OR
     C           WN0033    ORNE TIRVSX                     *OR
     C           YL0117    ORNE TIRPNB                     *OR
     C           WN0028    ORNE TIKZDT                     *OR
     C           YL0040    ORNE TIAXTM                     *OR
     C           TIRNNB    ORNE WALTMP                     *OR
     C           TIWRTX    ORNE WADFSC                     *OR
     C           WN0022    ORNE TIGRWE                     *OR
     C           YL0002    ORNE TIR3SX                     *OR
      * RMC 1/23/20 added on time reason check and update below
      * Carrier Change - output change log
      * CASE: DB1.Carrier Code NE PAR.Carrier Code
     C           TIBZNA    IFNE YL0104                     *IF
      * Output the Load Header changes to Load order change log
     C                     EXSR UGSUBR                     Output the Load
     C                     END                             *FI
      * CASE: DB1.Load Status is Shipped or Invoiced
     C           TIPKST    IFEQ 'I'                        *IF
     C           TIPKST    OREQ 'S'
      * dont change if S/I already
     C                     Z-ADDTIRPNB    WURPNB           Total Load Orde
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0117    WURPNB           Total Load Orde
     C                     END                             *FI
      * Dont update LH Trailer with a blank from MG
      * CASE: PAR.TMS Trailer Number is Not Entered
     C           WAUTAA    IFEQ *BLANK                     *IF
     C                     MOVELTIDXTX    YL0120           Trailer Id
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0120           Trailer Id
     C                     MOVELWAUTAA    YL0120           Trailer Id
     C                     END                             *FI
      * CHG For TMS           CH - Load Header  * 
     C                     EXSR NGCHRC
     C                     MOVEL'Y'       WN0047           Status Flag 2
     C                     END                             *FI
     C           KRSNF     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * CHG For TMS           CH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0677 15        Seal 1
     C                     MOVEL*BLANK    WN0678 15        Seal 2
     C                     MOVEL*BLANK    WN0679 15        Seal 3
     C                     MOVEL*BLANK    WN0680 15        Seal 4
     C                     MOVEL*BLANK    WN0681 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0682 112       Flat Amount
     C                     MOVEL*BLANK    WN0683  3        Transloader Car
     C                     Z-ADD*ZERO     WN0684  40       BOL Time
     C                     Z-ADD*ZERO     WN0685  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0686 112       Rated Freight
     C                     Z-ADD*ZERO     WN0687  50       Number Pallets
     C                     Z-ADD*ZERO     WN0688  50       Number Pallets
     C                     Z-ADD*ZERO     WN0689 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0690  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0691  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0692  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0693 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0694 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0695  52       Product Tempera
     C                     Z-ADD*ZERO     WN0696  50       Number Spacers
     C                     MOVEL*BLANK    WN0697 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0698 12        Recorder ID
     C                     Z-ADD*ZERO     WN0699  70       Actual Ship Dat
     C                     Z-ADD*ZERO     WN0700  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0701  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0702  70       Spotted Date
     C                     Z-ADD*ZERO     WN0703  60       Spotted Time
     C                     Z-ADD*ZERO     WN0704  70       Load Finished D
     C                     Z-ADD*ZERO     WN0705  60       Load Finished T
     C                     Z-ADD*ZERO     WN0706  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0707  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0708  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0709  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0710  70       Truck Departure
     C                     Z-ADD*ZERO     WN0711  60       Truck Departure
     C                     Z-ADD*ZERO     WN0712  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0713  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0714  3        Shipping Line
     C                     MOVEL*BLANK    WN0715 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0716 30        Vessel Name
     C                     Z-ADD*ZERO     WN0717  50       Voyage
     C                     Z-ADD*ZERO     WN0718  70       Sail Date
     C                     MOVEL*BLANK    WN0719 12        Booking Number
     C                     MOVEL*BLANK    WN0720 20        Discharge Port
     C                     Z-ADD*ZERO     WN0721  70       Arrival Date
     C                     MOVEL*BLANK    WN0722 12        Container Numbe
     C                     Z-ADD*ZERO     WN0723  70       Date In
     C                     Z-ADD*ZERO     WN0724  60       Time In
     C                     Z-ADD*ZERO     WN0725  70       Date Out
     C                     Z-ADD*ZERO     WN0726  60       Time Out
     C                     Z-ADD*ZERO     WN0727 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0728  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0729  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0730  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0731  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0732  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0733  70       Requested Deliv
     C                     MOVEL*BLANK    WN0734  1        Load Acceptance
     C                     MOVEL*BLANK    WN0735  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0736  70       On Yard Date
     C                     Z-ADD*ZERO     WN0737  60       On Yard Time
     C                     MOVEL*BLANK    WN0738  1        Load Held Over
     C                     MOVEL*BLANK    WN0739  1        Load Held Over
     C                     MOVEL*BLANK    WN0740 15        Load Held Over
     C                     MOVEL*BLANK    WN0741 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0742 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0743  70       Express Mail Da
     C                     Z-ADD*ZERO     WN0744  70       Product Complet
     C                     Z-ADD*ZERO     WN0745  60       Product Complet
     C                     Z-ADD*ZERO     WN0746  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0747  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0748  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0749  1        Load Confirmed
     C                     MOVEL*BLANK    WN0750 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0751  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0752  60       Load Door 1
     C                     Z-ADD*ZERO     WN0753  70       Override Total
     C                     Z-ADD*ZERO     WN0754  60       Load Door 2
     C                     MOVEL*BLANK    WN0755  1        Partial Load
     C                     MOVEL*BLANK    WN0756  1        Load Confirmati
     C                     MOVEL*BLANK    WN0757  1        Export Load USD
     C                     MOVEL*BLANK    WN0758  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0759 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0760 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0761 15        Late Billing Em
     C                     MOVEL*BLANK    WN0762 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0763  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0764  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0765  1        LH Power Only L
     C                     MOVEL*BLANK    WN0766  1        MG Created Load
     C                     MOVEL*BLANK    WN0767  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0768  2        Load U/M
     C                     MOVEL*BLANK    WN0769  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0770  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0771  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0772  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0773  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0774  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0775  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0776  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0777  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0778  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0779  60       LH Unused Time
     C                     MOVEL*BLANK    WN0780  1        EDI Status 1
     C                     MOVEL*BLANK    WN0781  1        EDI Status 2
     C                     MOVEL*BLANK    WN0782  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0783  60       Job Time
     C                     MOVEL*BLANK    WN0784 10        User Id
     C                     MOVEL*BLANK    WN0785 10        Job Name
     C                     Z-ADD*ZERO     WN0786  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDTIRMNB    WSRMNB           Load ID
      *
     C           KLCHNG    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHNG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YKRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDTIAIC3    WSAIC3           Company Number
     C                     Z-ADDWN0008    WSAODT           Scheduled Ship
     C                     MOVELYL0038    WSPJST    P      LTL Flag
     C                     MOVELWN0009    WSPKST    P      Load Status
     C                     Z-ADDWALTMP    WSRNNB           Reefer Temperat
     C                     Z-ADDWURPNB    WSRPNB           Total Load Orde
     C                     MOVELTIXQST    WSXQST    P      Allocate Pounds
     C                     Z-ADDWN0012    WSRRNB           Total Stops
     C                     MOVELYL0120    WSDXTX    P      Trailer Id
     C                     MOVELYL0104    WSBZNA    P      Carrier Code
     C                     MOVELTIRONB    WSRONB    P      Truck Size
     C                     MOVELTIVCST    WSVCST    P      Ship Status
     C                     MOVELWN0017    WSVDST    P      Load Type
     C                     Z-ADDTIAQDT    WSAQDT           Actual Departur
     C                     Z-ADDTIS6NB    WSS6NB           Departure Time
     C                     Z-ADDTIT4NB    WST4NB           Schedule Sequen
     C                     Z-ADDWACRDS    WSTLMI           Total Load Mile
     C                     MOVELWN0019    WSQ2CD    P      Shipping Method
     C                     MOVELWN0020    WSVPCD    P      Ship From Wareh
     C                     MOVELWN0021    WSDBCD    P      Ship To State C
     C                     Z-ADDWN0022    WSGRWE           Gross Weight
     C                     MOVELYL0104    WSXCCD    P      Carrier Broker
     C                     MOVELWN0024    WSU2ST    P      Export Status
     C                     MOVELYL0041    WSONTM    P      On Time - (Y/N)
     C                     Z-ADDWN0028    WSKZDT           Deadline Depart
     C                     Z-ADDYL0040    WSAXTM           Deadline Depart
     C                     MOVELWN0030    WSLSHG    P      Load Shag Flag
     C                     MOVELWN0031    WSYPST    P      Load Wash Flag
     C                     MOVELWADFSC    WSWRTX    P      Shipping Temp C
     C                     MOVELWN0033    WSRVSX    P      Multi Company L
     C                     MOVELTIR1SX    WSR1SX    P      TPM Shipment St
     C                     MOVELYL0002    WSR3SX    P      LH On-Time Reas
     C                     Z-ADDWN0035    WSP0DT           LPT Load Plan S
     C                     Z-ADDWN0036    WSCMTM           LPT Load Plan S
     C                     Z-ADDYL0121    WSP1DT           TPM Planned Shi
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv Chg Load Dtl      RT - TMS Load Event  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0787  50       Stop/Drop Seque
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQNH01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQNH02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQNH03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQNH04           TMS Extract Fil
      * Define keylist
     C           KPSNH     KLIST
     C                     KFLD           WQNH01           TMS Load ID
     C                     KFLD           WQNH02           TMS Extract Dat
     C                     KFLD           WQNH03           TMS Extract Tim
     C                     KFLD           WQNH04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           TMS Load ID
     C                     KFLD           WQNH02           TMS Extract Dat
     C                     KFLD           WQNH03           TMS Extract Tim
     C                     KFLD           WQNH04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWATMLD    WQNH01           TMS Load ID
     C                     Z-ADDWAAYD8    WQNH02           TMS Extract Dat
     C                     Z-ADDWAAFTH    WQNH03           TMS Extract Tim
     C                     MOVELWAFSU1    WQNH04           TMS Extract Fil
     C                     Z-ADD0         WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSNH     SETLL@CSCPXP                    *
     C           KRSNH     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Pickup
     C           WBDMSC    IFEQ @CN,014                    *IF
      * CASE: DB1.TMS Address Type is Warehouse
     C           WBDNSC    IFEQ @CN,004                    *IF
      * Change TMS Load Event - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBTMLD    WL0160           TMS Load ID
     C                     Z-ADDWBAYD8    WL0161           TMS Extract Dat
     C                     Z-ADDWBAFTH    WL0162           TMS Extract Tim
     C                     MOVELWBFSU1    WL0163    P      TMS Extract Fil
     C                     Z-ADDWBEVSQ    WL0164           TMS Event Seque
     C                     MOVELWBDMSC    WL0165    P      TMS Event Type
     C                     Z-ADDWBA1D8    WL0166           TMS Earliest Da
     C                     Z-ADDWBAHTH    WL0167           TMS Earliest Ti
     C                     Z-ADDWBA2D8    WL0168           TMS Latest Date
     C                     Z-ADDWBAITH    WL0169           TMS Latest Time
     C                     Z-ADDWBA3D8    WL0170           TMS Planned Dat
     C                     Z-ADDWBAJTH    WL0171           TMS Planned Tim
     C                     Z-ADDWBA4D8    WL0172           TMS Actual Date
     C                     Z-ADDWBAKTH    WL0173           TMS Actual Time
     C                     MOVELWBDNSC    WL0174    P      TMS Address Typ
     C                     MOVELWBUZAA    WL0175    P      TMS Location Co
     C                     MOVELWBFFU1    WL0176    P      TMS Address Nam
     C                     MOVELWBUGU1    WL0177    P      TMS Address Lin
     C                     MOVELWBFHU1    WL0178    P      TMS Address Lin
     C                     MOVELWBU0AA    WL0179    P      TMS City
     C                     MOVELWBU1AA    WL0180    P      TMS State Provi
     C                     MOVELWBU3AA    WL0181    P      TMS Postal Code
     C                     MOVELWBU4AA    WL0182    P      TMS Country Cod
     C                     Z-ADDWBG1NB    WL0183           TMS Weight
     C                     MOVELWBDOSC    WL0184    P      TMS Weight UOM
     C                     Z-ADDWBA6D8    WL0185           TMS Appointment
     C                     Z-ADDWBAMTH    WL0186           TMS Appointment
     C                     Z-ADDWBA9D8    WL0187           TMS Actual Car
     C                     Z-ADDWBANTH    WL0188           TMS Actual Car
     C                     MOVELWBVBAA    WL0189    P      TMS Late Reason
     C                     MOVELWBP5U1    WL0190    P      TMS Cust Assign
     C                     MOVELWBDLSC    WL0191    P      TMS Record Stat
     C                     Z-ADD1         WL0192           TMS Process Sta
     C                     MOVEL*BLANK    WL0193           TMS Error Reaso
     C                     Z-ADDWBA0D8    WL0194           TMS Change Date
     C                     Z-ADDWBD9TM    WL0195           TMS Change time
     C                     EXSR TBCHRC
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv.
      * Rtv Drops to Chg LD   RT - TMS Load Event  * 
     C                     EXSR NIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNH     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * Rtv Drops to Chg LD   RT - TMS Load Event  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0788  50       Stop/Drop Seque
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0788           Stop/Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVTMLD    WQNI01           TMS Load ID
     C           *LIKE     DEFN WVAYD8    WQNI02           TMS Extract Dat
     C           *LIKE     DEFN WVAFTH    WQNI03           TMS Extract Tim
     C           *LIKE     DEFN WVFSU1    WQNI04           TMS Extract Fil
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WQNI01           TMS Load ID
     C                     KFLD           WQNI02           TMS Extract Dat
     C                     KFLD           WQNI03           TMS Extract Tim
     C                     KFLD           WQNI04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWBTMLD    WQNI01           TMS Load ID
     C                     Z-ADDWBAYD8    WQNI02           TMS Extract Dat
     C                     Z-ADDWBAFTH    WQNI03           TMS Extract Tim
     C                     MOVELWBFSU1    WQNI04           TMS Extract Fil
      * Establish starting position
     C           KRSNI     SETLL@CSCPYL                    *
     C           KRSNI     READE@CSCPYL                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv & TMS Cust A
      * Rtv Chg Load Dtl      RT - TMS Load Event Shipment  * 
     C                     EXSR NJRVGN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WVP5U1' defaulted for 'TMS Cust Assigned Appt #'.
      * Change TMS Load Event - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVTMLD    WL0160           TMS Load ID
     C                     Z-ADDWVAYD8    WL0161           TMS Extract Dat
     C                     Z-ADDWVAFTH    WL0162           TMS Extract Tim
     C                     MOVELWVFSU1    WL0163    P      TMS Extract Fil
     C                     Z-ADDWVEVSQ    WL0164           TMS Event Seque
     C                     MOVELWVDMSC    WL0165    P      TMS Event Type
     C                     Z-ADDWVA1D8    WL0166           TMS Earliest Da
     C                     Z-ADDWVAHTH    WL0167           TMS Earliest Ti
     C                     Z-ADDWVA2D8    WL0168           TMS Latest Date
     C                     Z-ADDWVAITH    WL0169           TMS Latest Time
     C                     Z-ADDWVA3D8    WL0170           TMS Planned Dat
     C                     Z-ADDWVAJTH    WL0171           TMS Planned Tim
     C                     Z-ADDWVA4D8    WL0172           TMS Actual Date
     C                     Z-ADDWVAKTH    WL0173           TMS Actual Time
     C                     MOVELWVDNSC    WL0174    P      TMS Address Typ
     C                     MOVELWVUZAA    WL0175    P      TMS Location Co
     C                     MOVELWVFFU1    WL0176    P      TMS Address Nam
     C                     MOVELWVUGU1    WL0177    P      TMS Address Lin
     C                     MOVELWVFHU1    WL0178    P      TMS Address Lin
     C                     MOVELWVU0AA    WL0179    P      TMS City
     C                     MOVELWVU1AA    WL0180    P      TMS State Provi
     C                     MOVELWVU3AA    WL0181    P      TMS Postal Code
     C                     MOVELWVU4AA    WL0182    P      TMS Country Cod
     C                     Z-ADDWVG1NB    WL0183           TMS Weight
     C                     MOVELWVDOSC    WL0184    P      TMS Weight UOM
     C                     Z-ADDWVA6D8    WL0185           TMS Appointment
     C                     Z-ADDWVAMTH    WL0186           TMS Appointment
     C                     Z-ADDWVA9D8    WL0187           TMS Actual Car
     C                     Z-ADDWVANTH    WL0188           TMS Actual Car
     C                     MOVELWVVBAA    WL0189    P      TMS Late Reason
     C                     MOVELWVP5U1    WL0190    P      TMS Cust Assign
     C                     MOVELWVDLSC    WL0191    P      TMS Record Stat
     C                     Z-ADD1         WL0192           TMS Process Sta
     C                     MOVEL*BLANK    WL0193           TMS Error Reaso
     C                     Z-ADDWVA0D8    WL0194           TMS Change Date
     C                     Z-ADDWVD9TM    WL0195           TMS Change time
     C                     EXSR TBCHRC
     C           KRSNI     READE@CSCPYL                  90*
     C                     ENDDO
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Rtv Chg Load Dtl      RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Changes and comments
     C                     EXSR UHSUBR                     Changes and com
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQNJ01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQNJ02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQNJ03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQNJ04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQNJ05           TMS Event Seque
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WQNJ01           TMS Load ID
     C                     KFLD           WQNJ02           TMS Extract Dat
     C                     KFLD           WQNJ03           TMS Extract Tim
     C                     KFLD           WQNJ04           TMS Extract Fil
     C                     KFLD           WQNJ05           TMS Event Seque
      * Setup key
     C                     Z-ADDWVTMLD    WQNJ01           TMS Load ID
     C                     Z-ADDWVAYD8    WQNJ02           TMS Extract Dat
     C                     Z-ADDWVAFTH    WQNJ03           TMS Extract Tim
     C                     MOVELWVFSU1    WQNJ04           TMS Extract Fil
     C                     Z-ADDWVEVSQ    WQNJ05           TMS Event Seque
      * Establish starting position
     C           KRSNJ     SETLL@CUCPXS                    *
     C           KRSNJ     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     YL0122           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0123           Actual Delivery
     C                     Z-ADD*ZERO     YL0124           LD Unused Date
      * CASE: PAR.TMS Appointment Date is entered
     C           WVA6D8    IFGT 0                          *IF
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0122    PARM *ZERO     WQ0023  70       Date
     C                     PARM WVA6D8    WQ0024  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           WVAMTH    MULT 100       YL0125           LD Carrier Appt
      * If TMS Appointment Date is entered                    E009492
      * CASE: PAR.TMS Appointment Date is entered
     C           WVA6D8    IFGT 0                          *IF
      * Rtv Co and Load       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMOR    WL0197           Order Number
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0126           Company Number
     C                     Z-ADDWL0198    YN0001           Load ID
     C                     MOVELWL0199    YN0002    P      Event Code
      * RTV Orig Appt Dte/Tme  XF - Order Header Extension  * 
     C                     CALL 'PUA4XFR'              90  RTV Orig Appt D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0126    WQ0025  30       Company Number
     C                     PARM WETMOR    WQ0026  70       Order Number
     C           WUQENY    PARM *ZERO     WQ0027  60       Original Appoin
     C           WUQFNY    PARM *ZERO     WQ0028  60       Original Appoin
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUA4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Only update Orig Appt date/time if it is zeros      E009492
      * CASE: WRK.Original Appointment Date is Equal to zero
     C           WUQENY    IFEQ 0                          *IF
      * * Convert tms appt date from 8.0 to 6.0
      *
     C                     MOVEL*BLANK    WN0789  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0790  6        Date (Char-6) U
      *
      * CVT *YYMD to *YMD     IF
      * ** Convert incoming date to alpha
     C                     MOVELWVA6D8    WN0789           Date (Char-8) U
      * ** Retrieve yymmdd into another alpha field
     C                     Z-ADD6         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0789:ZQ WN0790    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** Convert 6 char date to 6.0 and put in par to return
     C                     MOVE WN0790    YL0127           Date Out (6,0)
      * * Save carrier appt date in original appointment date in OHE E009
     C                     Z-ADDYL0127    YL0128           Original Appoin
      * * Save carrier appt time in original appointment time in OHE  E00
     C           WVAMTH    MULT 100       YL0129           Original Appoin
      * * Update OHE original date & time                     E009492
      * CHG Orig Appt Dt/Tm   CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0126    WL0403           Company Number
     C                     Z-ADDWETMOR    WL0404           Order Number
     C                     Z-ADDYL0128    WL0405           Original Appoin
     C                     Z-ADDYL0129    WL0406           Original Appoin
     C                     EXSR TNCHRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.TMS Actual Car Arrival Dt is entered
     C           WVA9D8    IFGT 0                          *IF
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0123    PARM *ZERO     WQ0029  70       Date
     C                     PARM WVA9D8    WQ0030  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           WVANTH    MULT 100       YL0130           Actual Delivery
     C           WAAGTH    MULT 100       YL0131           Deadline Depart
      * CASE: PAR.TMS Late Reason Code is Entered
     C           WVVBAA    IFGT *BLANK                     *IF
      * CASE: PAR.TMS Late Reason Code is NS
     C           WVVBAA    IFEQ 'NS'                       *IF
     C                     MOVEL*BLANK    YL0132           Load Dtl On Tim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0132           Load Dtl On Tim
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0132           Load Dtl On Tim
     C                     END                             *FI
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv & TMS Cust A
      * RTV Chg LD for TMS chg RT - Load Detail  * 
     C                     EXSR NKRVGN
      * RTV Chg TMS Load Late XF - Order Header Extension  * 
     C                     CALL 'PBYJXFR'              90  RTV Chg TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WETMOR    WQ0031  70       Order Number
     C                     PARM WETMLD    WQ0032  70       Load ID
     C                     PARM WVVBAA    WQ0033  3        OHE Late Delive
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBYJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg OH Carrier ONLY  12/20/16
      * RTV Chg Carrier       RT - Order Header TRG  * 
     C                     EXSR NMRVGN
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD1         WL0009           TMS Process Sta
     C                     MOVEL*BLANK    WL0010           TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C           KRSNJ     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * RTV Chg LD for TMS chg RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQNK02           Load ID
     C           *LIKE     DEFN WWC4NB    WQNK03           Order Number
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK02           Load ID
     C                     KFLD           WQNK03           Order Number
      * Setup key
     C                     Z-ADDWETMLD    WQNK02           Load ID
     C                     Z-ADDWETMOR    WQNK03           Order Number
      * Establish starting position
     C           KRSNK     SETLL@FLCPKF                    *
     C           KRSNK     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R17040 DN 03/01/21-Don't Blank Out if TMS Carrier Ref PRO/Inv Exi
      * CASE: DB1.Carrier Ref PRO/Inv is Not Entered
     C           WWWWTX    IFEQ *BLANK                     *IF
     C                     MOVELWAP4U1    YL0133           Carrier Ref PRO
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWWWWTX    YL0133           Carrier Ref PRO
     C                     END                             *FI
      * R17040 DN 03/01/21-Don't Blank Out if TMS Cust Assigned Appt # Ex
      * CASE: DB1.Cust Assigned Appt # is Not Entered
     C           WWWXTX    IFEQ *BLANK                     *IF
     C                     MOVELWVP5U1    YL0134           Cust Assigned A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWWWXTX    YL0134           Cust Assigned A
     C                     END                             *FI
      * R17040 DN 03/01/21-Update Carrier Ref PRO/Inv & Cust Assigned App
      * CHG LD for TMS chg    CH - Load Detail  * 
     C                     EXSR NLCHRC
      * added 1/10/17
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0429           Company Number
     C                     Z-ADDWWC4NB    WL0430           Order Number
     C                     Z-ADDWN0028    WL0431           Deadline Depart
     C                     Z-ADDYL0131    WL0432           Deadline Depart
     C                     EXSR TTRVGN
     C           KRSNK     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * CHG LD for TMS chg    CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0791 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0792  72       Freight Charge
     C                     Z-ADD*ZERO     WN0793  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0794 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0795  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0796 112       Rated Freight
     C                     Z-ADD*ZERO     WN0797  30       Company Number
     C                     MOVEL*BLANK    WN0798  1        Ship Status
     C                     Z-ADD*ZERO     WN0799  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0800  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0801  70       Appointment Con
     C                     Z-ADD*ZERO     WN0802  60       Appointment Con
     C                     MOVEL*BLANK    WN0803 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0804 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0805  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0806  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0807  70       On Yard Date
     C                     Z-ADD*ZERO     WN0808  60       On Yard Time
     C                     Z-ADD*ZERO     WN0809  70       MPC Number
     C                     MOVEL*BLANK    WN0810  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0811 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0812 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0813 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0814 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0815 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0816  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0817  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0818  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0819  60       LD Unused Time
     C                     MOVEL*BLANK    WN0820  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0821  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0822  2        HPB Transload S
     C                     MOVEL*BLANK    WN0823 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0824  1        EDI Status 1
     C                     MOVEL*BLANK    WN0825  1        EDI Status 2
     C                     MOVEL*BLANK    WN0826  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0827  60       Job Time
     C                     MOVEL*BLANK    WN0828 10        User Id
     C                     MOVEL*BLANK    WN0829 10        Job Name
     C                     Z-ADD*ZERO     WN0830  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWWRMNB    TBRMNB           Load ID
     C                     Z-ADDWWRUNB    TBRUNB           Stop/Drop Seque
      *
     C           KLCHNL    KLIST
     C                     KFLD           TBRMNB           Load ID
     C                     KFLD           TBRUNB           Stop/Drop Seque
     C           KLCHNL    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YLRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWWRVNB    TBRVNB           Stop/Drop
     C                     Z-ADDWEHFNB    TBRWNB           Miles to next s
     C                     Z-ADDWWC4NB    TBC4NB           Order Number
     C                     Z-ADDYL0123    TBEJDT           Actual Delivery
     C                     Z-ADDYL0130    TBAGTM           Actual Delivery
     C                     Z-ADDWN0028    TBHDDT           Deadline Depart
     C                     Z-ADDYL0131    TBAUTM           Deadline Depart
     C                     MOVELYL0132    TBY7ST    P      Load Dtl On Tim
     C                     Z-ADDYL0122    TBN7DT           LD Carrier Appt
     C                     Z-ADDYL0125    TBB3TM           LD Carrier Appt
     C                     MOVELYL0133    TBWWTX    P      Carrier Ref PRO
     C                     MOVELYL0134    TBWXTX    P      Cust Assigned A
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * RTV Chg Carrier       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQNM01           Order Number
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WQNM01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQNM01           Order Number
      * Establish starting position
     C           KRSNM     SETLL@BFCPY2                    *
     C           KRSNM     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Carrier Code NE PAR.Carrier Code Usr
     C           WFBZNA    IFNE YL0104                     *IF
      * CHG Carrier only      CH - Order Header TRG  * 
     C                     EXSR NNCHRC
     C                     END                             *FI
     C           KRSNM     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNCHRC    BEGSR
      *================================================================
      * CHG Carrier only      CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0831  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0832  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0833  70       Ship To Custome
     C                     MOVEL*BLANK    WN0834 30        Ship To Name
     C                     MOVEL*BLANK    WN0835 30        Ship To Address
     C                     MOVEL*BLANK    WN0836 30        Ship To Address
     C                     MOVEL*BLANK    WN0837 30        Ship To Address
     C                     MOVEL*BLANK    WN0838 20        Ship To City
     C                     MOVEL*BLANK    WN0839  2        Ship To State C
     C                     MOVEL*BLANK    WN0840 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0841  70       Bill to Custome
     C                     MOVEL*BLANK    WN0842 30        Bill to Name
     C                     MOVEL*BLANK    WN0843 30        Bill to Address
     C                     MOVEL*BLANK    WN0844 30        Bill to Address
     C                     MOVEL*BLANK    WN0845 30        Bill to Address
     C                     MOVEL*BLANK    WN0846 20        Bill to City
     C                     MOVEL*BLANK    WN0847  2        Bill to State C
     C                     MOVEL*BLANK    WN0848 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0849 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0850  70       Order Date
     C                     Z-ADD*ZERO     WN0851  70       Requested Ship
     C                     Z-ADD*ZERO     WN0852  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0853  70       Cancel Date
     C                     MOVEL*BLANK    WN0854  2        Terms Code
     C                     MOVEL*BLANK    WN0855 40        Special Instruc
     C                     MOVEL*BLANK    WN0856 40        Special Instruc
     C                     MOVEL*BLANK    WN0857  1        Comment Print A
     C                     MOVEL*BLANK    WN0858  1        Comment Print I
     C                     MOVEL*BLANK    WN0859  1        Comment Print P
     C                     MOVEL*BLANK    WN0860  1        Comment Print S
     C                     MOVEL*BLANK    WN0861  3        Reason Code
     C                     MOVEL*BLANK    WN0862  1        Order in Use
     C                     MOVEL*BLANK    WN0863  1        Header Status
     C                     MOVEL*BLANK    WN0864  1        Header Status L
     C                     MOVEL*BLANK    WN0865  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0866  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0867 10        User Original E
     C                     Z-ADD*ZERO     WN0868  70       Date of Origina
     C                     Z-ADD*ZERO     WN0869 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0870 112       Order Weight To
     C                     MOVEL*BLANK    WN0871  1        Credit Hold
     C                     MOVEL*BLANK    WN0872  1        Production Hold
     C                     MOVEL*BLANK    WN0873  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0874  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0875  40       Requested Deliv
     C                     MOVEL*BLANK    WN0876  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0877 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0878  70       Load ID
     C                     Z-ADD*ZERO     WN0879  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0880 112       Rated Freight
     C                     MOVEL*BLANK    WN0881  1        LTL Flag
     C                     MOVEL*BLANK    WN0882  1        Price Audit
     C                     MOVEL*BLANK    WN0883  1        Price Status
     C                     MOVEL*BLANK    WN0884  2        Shipping Method
     C                     MOVEL*BLANK    WN0885  1        Export Status
     C                     MOVEL*BLANK    WN0886  1        Palletize
     C                     MOVEL*BLANK    WN0887  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0888  1        Slip Sheet
     C                     MOVEL*BLANK    WN0889  1        Age Code
     C                     Z-ADD*ZERO     WN0890  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0891  1        Load Type
     C                     Z-ADD*ZERO     WN0892  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0893  1        Load Plan Order
     C                     MOVEL*BLANK    WN0894  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0895  70       Resell Referenc
     C                     MOVEL*BLANK    WN0896 30        Special Comment
     C                     MOVEL*BLANK    WN0897 30        Special Comment
     C                     MOVEL*BLANK    WN0898  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0899  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0900  2        Manager Level C
     C                     MOVEL*BLANK    WN0901  3        VP Level Code
     C                     Z-ADD*ZERO     WN0902  70       Attach to Order
     C                     MOVEL*BLANK    WN0903  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0904  70       Invoice Number
     C                     MOVEL*BLANK    WN0905  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0906  70       Invoice Date
     C                     MOVEL*BLANK    WN0907  2        Event Code
     C                     MOVEL*BLANK    WN0908  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0909  1        Modified Flag
     C                     Z-ADD*ZERO     WN0910 112       A/R order Value
     C                     MOVEL*BLANK    WN0911  1        Billing Activit
     C                     MOVEL*BLANK    WN0912  1        Block Order Fla
     C                     MOVEL*BLANK    WN0913  1        Order Certifica
     C                     Z-ADD*ZERO     WN0914 112       Invoice Order V
     C                     MOVEL*BLANK    WN0915  1        Process Sts for
     C                     MOVEL*BLANK    WN0916  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0917  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0918  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0919  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0920  1        Email Cust On O
     C                     MOVEL*BLANK    WN0921  1        Order Emailed
     C                     MOVEL*BLANK    WN0922  1        Export Docs Go
     C                     MOVEL*BLANK    WN0923  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0924  1        Broker Order St
     C                     MOVEL*BLANK    WN0925  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0926  2        Order Requires
     C                     MOVEL*BLANK    WN0927  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0928  2        Export USDA App
     C                     MOVEL*BLANK    WN0929  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0930  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0931  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0932  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0933  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0934  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0935  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0936  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0937  60       Time of Origina
     C                     Z-ADD*ZERO     WN0938  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0939  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0940  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0941 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0942 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0943 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0944 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0945 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0946  70       Claim Number
     C                     MOVEL*BLANK    WN0947  1        EDI Status 1
     C                     MOVEL*BLANK    WN0948  1        EDI Status 2
     C                     MOVEL*BLANK    WN0949  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0950  60       Job Time
     C                     MOVEL*BLANK    WN0951 10        User Id
     C                     MOVEL*BLANK    WN0952 10        Job Name
     C                     Z-ADD*ZERO     WN0953  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWFAIC3    WXAIC3           Company Number
     C                     Z-ADDWFC4NB    WXC4NB           Order Number
      *
     C           KLCHNN    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C           KLCHNN    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YMRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELYL0104    WXBZNA    P      Carrier Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWXAIC3    PAAIC3           Company Number
     C                     Z-ADDWXC4NB    PAC4NB           Order Number
     C                     MOVELWXJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWXANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWXBKC7    PABKC7           Ship To Custome
     C                     MOVELWXBRTX    PABRTX    P      Ship To Name
     C                     MOVELWXHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWXHONA    PAHONA    P      Ship To Address
     C                     MOVELWXHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWXHNNA    PAHNNA    P      Ship To City
     C                     MOVELWXDBCD    PADBCD    P      Ship To State C
     C                     MOVELWXCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWXB0C7    PAB0C7           Bill to Custome
     C                     MOVELWXAETX    PAAETX    P      Bill to Name
     C                     MOVELWXB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWXB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWXB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWXB2NA    PAB2NA    P      Bill to City
     C                     MOVELWXBHCD    PABHCD    P      Bill to State C
     C                     MOVELWXC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWXBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWXA0DT    PAA0DT           Order Date
     C                     Z-ADDWXA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWXGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWXACDT    PAACDT           Cancel Date
     C                     MOVELWXAQCD    PAAQCD    P      Terms Code
     C                     MOVELWXB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWXBYNA    PABYNA    P      Special Instruc
     C                     MOVELWXBZNA    PABZNA    P      Carrier Code
     C                     MOVELWXGTST    PAGTST    P      Comment Print A
     C                     MOVELWXGVST    PAGVST    P      Comment Print I
     C                     MOVELWXGUST    PAGUST    P      Comment Print P
     C                     MOVELWXQFST    PAQFST    P      Comment Print S
     C                     MOVELWXCQCD    PACQCD    P      Reason Code
     C                     MOVELWXGJST    PAGJST    P      Order in Use
     C                     MOVELWXGWST    PAGWST    P      Header Status
     C                     MOVELWXGXST    PAGXST    P      Header Status L
     C                     MOVELWXGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWXAODT    PAAODT           Scheduled Ship
     C                     MOVELWXAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWXCXDT    PACXDT           Date of Origina
     C                     Z-ADDWXJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWXA1WG    PAA1WG           Order Weight To
     C                     MOVELWXXIST    PAXIST    P      Credit Hold
     C                     MOVELWXXJST    PAXJST    P      Production Hold
     C                     MOVELWXXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWXEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWXAFTM    PAAFTM           Requested Deliv
     C                     MOVELWXE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWXE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWXRMNB    PARMNB           Load ID
     C                     Z-ADDWXTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWXR1NB    PAR1NB           Rated Freight
     C                     MOVELWXPJST    PAPJST    P      LTL Flag
     C                     MOVELWXU0ST    PAU0ST    P      Price Audit
     C                     MOVELWXU1ST    PAU1ST    P      Price Status
     C                     MOVELWXQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWXU2ST    PAU2ST    P      Export Status
     C                     MOVELWXVEST    PAVEST    P      Palletize
     C                     MOVELWXVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWXVGST    PAVGST    P      Slip Sheet
     C                     MOVELWXRPCD    PARPCD    P      Age Code
     C                     Z-ADDWXRNNB    PARNNB           Reefer Temperat
     C                     MOVELWXVDST    PAVDST    P      Load Type
     C                     Z-ADDWXATIN    PAATIN           Attach to Invoi
     C                     MOVELWXU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWXU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWXRSRN    PARSRN           Resell Referenc
     C                     MOVELWXMHNA    PAMHNA    P      Special Comment
     C                     MOVELWXMINA    PAMINA    P      Special Comment
     C                     MOVELWXWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWXR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWXBFCD    PABFCD    P      Manager Level C
     C                     MOVELWXQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWXT3NB    PAT3NB           Attach to Order
     C                     MOVELWXSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWXCONB    PACONB           Invoice Number
     C                     MOVELWXCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWXAWDT    PAAWDT           Invoice Date
     C                     MOVELWXJPCD    PAJPCD    P      Event Code
     C                     MOVELWXXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWXZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWXVRVA    PAVRVA           A/R order Value
     C                     MOVELWXOBST    PAOBST    P      Billing Activit
     C                     MOVELWXBCST    PABCST    P      Block Order Fla
     C                     MOVELWXBDST    PABDST    P      Order Certifica
     C                     Z-ADDWXB7VL    PAB7VL           Invoice Order V
     C                     MOVELWXGASX    PAGASX    P      Process Sts for
     C                     MOVELWXGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWXGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWXGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWXFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWXFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWXFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWXFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWXFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWXFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWXFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWXFUSX    PAFUSX    P      Order Requires
     C                     MOVELWXFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWXFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWXFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWXFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWXNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWXNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWXNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWXNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWXNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWXBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWXBQTM    PABQTM           Time of Origina
     C                     Z-ADDWXBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWXBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWXBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWXH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWXH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWXH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWXH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWXH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWXC0C7    PAC0C7           Claim Number
     C                     MOVELWXUVST    PAUVST    P      EDI Status 1
     C                     MOVELWXUWST    PAUWST    P      EDI Status 2
     C                     MOVELWXUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWXAATM    PAAATM           Job Time
     C                     MOVELWXAYNA    PAAYNA    P      User Id
     C                     MOVELWXA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWXAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * RTV DLT for TMS Chg   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQNO02           Load ID
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO02           Load ID
      * Setup key
     C                     Z-ADDWL0533    WQNO02           Load ID
      * Establish starting position
     C           KRSNO     SETLL@FLCPKF                    *
     C           KRSNO     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Zero out load id
      * RTV Chg Ld for TMS    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0202           Company Number
     C                     Z-ADDWWC4NB    WL0203           Order Number
     C                     MOVEL*BLANK    WL0204           Carrier Code
     C                     Z-ADD*ZERO     WL0205           Load ID
     C                     Z-ADD*ZERO     WL0206           Rated Freight
     C                     MOVEL'Y'       WL0207    P      OH Load Plan Re
     C                     EXSR THRVGN
      * Zero out load id ; reset load plan ready to ReSweep
      * RTV Chg for TMS Delet RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0208           Company Number
     C                     Z-ADDWWC4NB    WL0209           Order Number
     C                     Z-ADDWWRMNB    WL0210           Load ID
     C                     EXSR TJRVGN
     C                     MOVEL*BLANK    WUKGTX           @Blank for 5
     C                     MOVELWWRVNB    WUKGTX           @Blank for 5
     C                     MOVEL*BLANK    YL0135           Change Log Prio
     C                     MOVELWUKGTX    YL0135           Change Log Prio
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWWRMNB    PBRMNB           Load ID
     C                     Z-ADDWWRVNB    PBRVNB           Stop/Drop
     C                     MOVEL'DELORD'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVELYL0135    PBMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##JOB     PBA0NA    P      Job Name
     C                     MOVELWL0534    PBBZNA    P      Carrier Code
     C                     Z-ADDWWAIC3    PBAIC3           Company Number
     C                     Z-ADDWWC4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWRMNB    WL0401           Load ID
     C                     Z-ADDWWRUNB    WL0402           Stop/Drop Seque
     C                     EXSR TMDLRC
     C           KRSNO     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * RTV No. of Stops      RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0954  30       USR Stop
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0954           USR Stop
     C                     MOVEL'N'       WN0033           Multi Company L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQNP02           Load ID
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WQNP02           Load ID
      * Setup key
     C                     Z-ADDWN0006    WQNP02           Load ID
      * Establish starting position
     C           KRSNP     SETLL@FLCPEB                    *
     C           KRSNP     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop NE PAR.USR Stop
     C           WHRVNB    IFNE WN0954                     *IF
     C                     ADD  1         WN0012           Total Stops
     C                     Z-ADDWHRVNB    WN0954           USR Stop
     C                     END                             *FI
      * CASE: WRK.Company Number     041405 is Equal to zero
     C           WUBQC3    IFEQ 0                          *IF
     C                     Z-ADDWHAIC3    WUBQC3           Company Number
     C                     END                             *FI
      * Multi Company Load?               PKTR01 8/5/04
      * CASE: DB1.Company Number NE WRK.Company Number     041405
     C           WHAIC3    IFNE WUBQC3                     *IF
     C                     MOVEL'Y'       WN0033           Multi Company L
     C                     END                             *FI
     C           KRSNP     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCHRC    BEGSR
      *================================================================
      * CHG For TMS Stp/Mult  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0955  30       Company Number
     C                     Z-ADD*ZERO     WN0956  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0957  1        LTL Flag
     C                     MOVEL*BLANK    WN0958  1        Load Status
     C                     Z-ADD*ZERO     WN0959  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0960 15        Seal 1
     C                     MOVEL*BLANK    WN0961 15        Seal 2
     C                     MOVEL*BLANK    WN0962 15        Seal 3
     C                     MOVEL*BLANK    WN0963 15        Seal 4
     C                     MOVEL*BLANK    WN0964 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0965  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0966 112       Flat Amount
     C                     MOVEL*BLANK    WN0967  1        Allocate Pounds
     C                     MOVEL*BLANK    WN0968 20        Trailer Id
     C                     MOVEL*BLANK    WN0969  3        Transloader Car
     C                     Z-ADD*ZERO     WN0970  40       BOL Time
     C                     MOVEL*BLANK    WN0971  3        Carrier Code
     C                     MOVEL*BLANK    WN0972  7        Truck Size
     C                     Z-ADD*ZERO     WN0973  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0974 112       Rated Freight
     C                     MOVEL*BLANK    WN0975  1        Ship Status
     C                     MOVEL*BLANK    WN0976  1        Load Type
     C                     Z-ADD*ZERO     WN0977  50       Number Pallets
     C                     Z-ADD*ZERO     WN0978  50       Number Pallets
     C                     Z-ADD*ZERO     WN0979 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0980  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0981  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0982  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0983 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0984 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0985  70       Actual Departur
     C                     Z-ADD*ZERO     WN0986  40       Departure Time
     C                     Z-ADD*ZERO     WN0987  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0988  52       Product Tempera
     C                     Z-ADD*ZERO     WN0989  50       Number Spacers
     C                     MOVEL*BLANK    WN0990 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0991  70       Total Load Mile
     C                     MOVEL*BLANK    WN0992 12        Recorder ID
     C                     MOVEL*BLANK    WN0993  2        Shipping Method
     C                     MOVEL*BLANK    WN0994  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0995  2        Ship To State C
     C                     Z-ADD*ZERO     WN0996  70       Gross Weight
     C                     MOVEL*BLANK    WN0997  3        Carrier Broker
     C                     MOVEL*BLANK    WN0998  1        Export Status
     C                     Z-ADD*ZERO     WN0999  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1000  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1001  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1002  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1003  70       Spotted Date
     C                     Z-ADD*ZERO     WN1004  60       Spotted Time
     C                     Z-ADD*ZERO     WN1005  70       Load Finished D
     C                     Z-ADD*ZERO     WN1006  60       Load Finished T
     C                     Z-ADD*ZERO     WN1007  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1008  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1009  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1010  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1011  70       Truck Departure
     C                     Z-ADD*ZERO     WN1012  60       Truck Departure
     C                     Z-ADD*ZERO     WN1013  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1014  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1015  3        Shipping Line
     C                     MOVEL*BLANK    WN1016 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1017 30        Vessel Name
     C                     Z-ADD*ZERO     WN1018  50       Voyage
     C                     Z-ADD*ZERO     WN1019  70       Sail Date
     C                     MOVEL*BLANK    WN1020 12        Booking Number
     C                     MOVEL*BLANK    WN1021 20        Discharge Port
     C                     Z-ADD*ZERO     WN1022  70       Arrival Date
     C                     MOVEL*BLANK    WN1023 12        Container Numbe
     C                     Z-ADD*ZERO     WN1024  70       Date In
     C                     Z-ADD*ZERO     WN1025  60       Time In
     C                     Z-ADD*ZERO     WN1026  70       Date Out
     C                     Z-ADD*ZERO     WN1027  60       Time Out
     C                     Z-ADD*ZERO     WN1028 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1029  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1030  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1031  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1032  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1033  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1034  70       Requested Deliv
     C                     MOVEL*BLANK    WN1035  1        Load Acceptance
     C                     MOVEL*BLANK    WN1036  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1037  70       On Yard Date
     C                     Z-ADD*ZERO     WN1038  60       On Yard Time
     C                     Z-ADD*ZERO     WN1039  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1040  60       Deadline Depart
     C                     MOVEL*BLANK    WN1041  1        Load Held Over
     C                     MOVEL*BLANK    WN1042  1        Load Held Over
     C                     MOVEL*BLANK    WN1043 15        Load Held Over
     C                     MOVEL*BLANK    WN1044 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1045 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1046  70       Express Mail Da
     C                     MOVEL*BLANK    WN1047  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1048  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1049  70       Product Complet
     C                     Z-ADD*ZERO     WN1050  60       Product Complet
     C                     Z-ADD*ZERO     WN1051  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1052  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1053  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1054  1        Load Confirmed
     C                     MOVEL*BLANK    WN1055 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1056  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1057  60       Load Door 1
     C                     Z-ADD*ZERO     WN1058  70       Override Total
     C                     Z-ADD*ZERO     WN1059  60       Load Door 2
     C                     MOVEL*BLANK    WN1060  1        Partial Load
     C                     MOVEL*BLANK    WN1061  1        Load Confirmati
     C                     MOVEL*BLANK    WN1062  1        Export Load USD
     C                     MOVEL*BLANK    WN1063  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1064 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1065 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1066 15        Late Billing Em
     C                     MOVEL*BLANK    WN1067 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1068 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1069  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1070  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1071  1        LH Power Only L
     C                     MOVEL*BLANK    WN1072  1        MG Created Load
     C                     MOVEL*BLANK    WN1073  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1074  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1075  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1076  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1077  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1078  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1079  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1080  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1081  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1082  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1083  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1084  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1085  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1086  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1087  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1088  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1089  60       LH Unused Time
     C                     MOVEL*BLANK    WN1090  1        EDI Status 1
     C                     MOVEL*BLANK    WN1091  1        EDI Status 2
     C                     MOVEL*BLANK    WN1092  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1093  60       Job Time
     C                     MOVEL*BLANK    WN1094 10        User Id
     C                     MOVEL*BLANK    WN1095 10        Job Name
     C                     Z-ADD*ZERO     WN1096  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWN0006    WSRMNB           Load ID
      *
     C           KLCHNQ    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHNQ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YNRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0012    WSRRNB           Total Stops
     C                     MOVELWN0033    WSRVSX    P      Multi Company L
     C                     MOVELYL0049    WSR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WCRMNB           Load ID
      * Establish starting position
     C           KRSNR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    WN1097           Scheduled Ship
     C                     MOVELWCPJST    WUG0TX           LTL Flag
     C                     MOVELWCPKST    WUG0TX           Load Status
     C                     Z-ADDWCRNNB    WUNFNN           Reefer Temperat
     C                     MOVELWCDMTX    WUG0TX           Seal 1
     C                     MOVELWCDNTX    WUG0TX           Seal 2
     C                     MOVELWCDOTX    WUG0TX           Seal 3
     C                     Z-ADDWCRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDWCFLAM    WN1098           Flat Amount
     C                     MOVELWCXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDWCRRNB    WN1099           Total Stops
     C                     MOVELWCDXTX    WUG0TX           Trailer Id
     C                     MOVELWCDYTX    WUG0TX           Transloader Car
     C                     Z-ADDWCSBNB    WUNFNN           BOL Time
     C                     MOVELWCBZNA    WUG0TX           Carrier Code
     C                     MOVELWCRONB    WUG0TX           Truck Size
     C                     Z-ADDWCSQNB    WUNFNN           Ld Hdr/Ld Dtl U
     C                     Z-ADDWCR1NB    WUNFNN           Rated Freight
     C                     MOVELWCVCST    WUG0TX           Ship Status
     C                     MOVELWCVDST    WUG0TX           Load Type
     C                     Z-ADDWCSDNB    WUNFNN           Number Pallets
     C                     Z-ADDWCPAOU    WUNFNN           Number Pallets
     C                     Z-ADDWCDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDWCSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDWCHADT    WUNFNN           Actual Arrival
     C                     Z-ADDWCAART    WUNFNN           Actual Arrival
     C                     Z-ADDWCDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDWCDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWCAQDT    WUNFNN           Actual Departur
     C                     Z-ADDWCS6NB    WUNFNN           Departure Time
     C                     Z-ADDWCT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDWCPRTM    WUNFNN           Product Tempera
     C                     Z-ADDWCNPSV    WUNFNN           Number Spacers
     C                     MOVELWCJ8TX    WUG0TX           Car/Veh. Initia
     C                     Z-ADDWCTLMI    WN1100           Total Load Mile
     C                     MOVELWCJ9TX    WUG0TX           Recorder ID
     C                     MOVELWCQ2CD    WUG0TX           Shipping Method
     C                     MOVELWCVPCD    WN1101           Ship From Wareh
     C                     MOVELWCDBCD    WN1102           Ship To State C
     C                     Z-ADDWCGRWE    WUNFNN           Gross Weight
     C                     MOVELWCXCCD    WN1103           Carrier Broker
     C                     MOVELWCU2ST    WN1104           Export Status
     C                     Z-ADDWCF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELWCONTM    WUG0TX           On Time - (Y/N)
     C                     Z-ADDWCJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDWCTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDWCJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDWCSPTM    WUNFNN           Spotted Time
     C                     Z-ADDWCJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDWCLFTM    WUNFNN           Load Finished T
     C                     Z-ADDWCJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDWCBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDWCJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDWCBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDWCKIDT    WUNFNN           Truck Departure
     C                     Z-ADDWCASTM    WUNFNN           Truck Departure
     C                     Z-ADDWCKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDWCAJCM    WUNFNN           Adjusted Depart
     C                     MOVELWCXACD    WUG0TX           Shipping Line
     C                     MOVELWCOANA    WUG0TX           Port Delv Termi
     C                     MOVELWCK4TX    WUG0TX           Vessel Name
     C                     Z-ADDWCVOAG    WUNFNN           Voyage
     C                     Z-ADDWCKBDT    WUNFNN           Sail Date
     C                     MOVELWCNBBO    WUG0TX           Booking Number
     C                     MOVELWCW4CD    WUG0TX           Discharge Port
     C                     Z-ADDWCEFDT    WUNFNN           Arrival Date
     C                     MOVELWCCNTN    WUG0TX           Container Numbe
     C                     Z-ADDWCKCDT    WUNFNN           Date In
     C                     Z-ADDWCTMIN    WUNFNN           Time In
     C                     Z-ADDWCKDDT    WUNFNN           Date Out
     C                     Z-ADDWCVMNB    WUNFNN           Time Out
     C                     Z-ADDWCOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDWCKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDWCATTM    WUNFNN           Scheduled Deliv
     C                     MOVELWCOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDWCKKDT    WUNFNN           On Yard Date
     C                     Z-ADDWCAVTM    WUNFNN           On Yard Time
     C                     Z-ADDWCKZDT    WN1107           Deadline Depart
     C                     Z-ADDWCAXTM    WN1108           Deadline Depart
     C                     MOVELWCRYSX    WN1109           MG Created Load
     C                     GOTO NREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1129  70       Total Load Mile
     C                     MOVEL*BLANK    WN1130  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1131  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1132  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WCRMNB           Load ID
      * Establish starting position
     C           KRSNS     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR NTRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           WCAJCD    IFEQ WN1130                     *IF
     C                     MOVEL*BLANK    WN1131           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWCAJCD    WN1131           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           WCRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDWCTLMI    WN1129           Total Load Mile
     C                     Z-ADDWCK2DT    WN1132           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDWCRMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WN1129    PARM WN1129    WQ0051  70       Total Load Mile
     C           WN1132    PARM WN1132    WQ0052  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR NWCHRC
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQNT02           Load ID
      * Define keylist
     C           KPSNT     KLIST
     C                     KFLD           WQNT02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT02           Load ID
      * Setup key
     C                     Z-ADDWCRMNB    WQNT02           Load ID
     C                     Z-ADD1         WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSNT     SETLL@FLCPEB                    *
     C           KRSNT     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR NURVGN
     C                     GOTO NTEXIT                     *QUIT
     C           KRSNT     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TJAIC3    WQNU01           Company Number
     C           *LIKE     DEFN TJC4NB    WQNU02           Order Number
      * Define keylist
     C           KPSNU     KLIST
     C                     KFLD           WQNU01           Company Number
     C                     KFLD           WQNU02           Order Number
     C                     KFLD           TJDPNB           Order Sequence
     C                     KFLD           TJUENB           Order Secondary
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           WQNU01           Company Number
     C                     KFLD           WQNU02           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WQNU01           Company Number
     C                     Z-ADDWHC4NB    WQNU02           Order Number
     C                     Z-ADD*ZERO     TJDPNB           Order Sequence
     C                     Z-ADD*ZERO     TJUENB           Order Secondary
      * Establish starting position
     C           KPSNU     SETLL@BGWKAE                    *
     C           KRSNU     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN1130           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR NVRVGN
      * PAR = DB1 By name
     C                     MOVELTJAJCD    WN1130           Warehouse Code
     C                     GOTO NUEXIT                     *QUIT
     C           KRSNU     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELTJAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSNV     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1133  30       Company Number
     C                     Z-ADD*ZERO     WN1134  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1135  1        LTL Flag
     C                     MOVEL*BLANK    WN1136  1        Load Status
     C                     Z-ADD*ZERO     WN1137  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1138 15        Seal 1
     C                     MOVEL*BLANK    WN1139 15        Seal 2
     C                     MOVEL*BLANK    WN1140 15        Seal 3
     C                     MOVEL*BLANK    WN1141 15        Seal 4
     C                     MOVEL*BLANK    WN1142 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1143  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1144 112       Flat Amount
     C                     MOVEL*BLANK    WN1145  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1146  50       Total Stops
     C                     MOVEL*BLANK    WN1147 20        Trailer Id
     C                     MOVEL*BLANK    WN1148  3        Transloader Car
     C                     Z-ADD*ZERO     WN1149  40       BOL Time
     C                     MOVEL*BLANK    WN1150  3        Carrier Code
     C                     MOVEL*BLANK    WN1151  7        Truck Size
     C                     Z-ADD*ZERO     WN1152  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1153 112       Rated Freight
     C                     MOVEL*BLANK    WN1154  1        Ship Status
     C                     MOVEL*BLANK    WN1155  1        Load Type
     C                     Z-ADD*ZERO     WN1156  50       Number Pallets
     C                     Z-ADD*ZERO     WN1157  50       Number Pallets
     C                     Z-ADD*ZERO     WN1158 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1159  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1160  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1161  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1162 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1163 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1164  70       Actual Departur
     C                     Z-ADD*ZERO     WN1165  40       Departure Time
     C                     Z-ADD*ZERO     WN1166  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1167  52       Product Tempera
     C                     Z-ADD*ZERO     WN1168  50       Number Spacers
     C                     MOVEL*BLANK    WN1169 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN1170 12        Recorder ID
     C                     MOVEL*BLANK    WN1171  2        Shipping Method
     C                     MOVEL*BLANK    WN1172  2        Ship To State C
     C                     Z-ADD*ZERO     WN1173  70       Gross Weight
     C                     MOVEL*BLANK    WN1174  3        Carrier Broker
     C                     MOVEL*BLANK    WN1175  1        Export Status
     C                     Z-ADD*ZERO     WN1176  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1177  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1178  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1179  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1180  70       Spotted Date
     C                     Z-ADD*ZERO     WN1181  60       Spotted Time
     C                     Z-ADD*ZERO     WN1182  70       Load Finished D
     C                     Z-ADD*ZERO     WN1183  60       Load Finished T
     C                     Z-ADD*ZERO     WN1184  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1185  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1186  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1187  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1188  70       Truck Departure
     C                     Z-ADD*ZERO     WN1189  60       Truck Departure
     C                     Z-ADD*ZERO     WN1190  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1191  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1192  3        Shipping Line
     C                     MOVEL*BLANK    WN1193 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1194 30        Vessel Name
     C                     Z-ADD*ZERO     WN1195  50       Voyage
     C                     Z-ADD*ZERO     WN1196  70       Sail Date
     C                     MOVEL*BLANK    WN1197 12        Booking Number
     C                     MOVEL*BLANK    WN1198 20        Discharge Port
     C                     Z-ADD*ZERO     WN1199  70       Arrival Date
     C                     MOVEL*BLANK    WN1200 12        Container Numbe
     C                     Z-ADD*ZERO     WN1201  70       Date In
     C                     Z-ADD*ZERO     WN1202  60       Time In
     C                     Z-ADD*ZERO     WN1203  70       Date Out
     C                     Z-ADD*ZERO     WN1204  60       Time Out
     C                     Z-ADD*ZERO     WN1205 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1206  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1207  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1208  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1209  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1210  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1211  70       Requested Deliv
     C                     MOVEL*BLANK    WN1212  1        Load Acceptance
     C                     Z-ADD*ZERO     WN1213  70       On Yard Date
     C                     Z-ADD*ZERO     WN1214  60       On Yard Time
     C                     Z-ADD*ZERO     WN1215  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1216  60       Deadline Depart
     C                     MOVEL*BLANK    WN1217  1        Load Held Over
     C                     MOVEL*BLANK    WN1218  1        Load Held Over
     C                     MOVEL*BLANK    WN1219 15        Load Held Over
     C                     MOVEL*BLANK    WN1220 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1221 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1222  70       Express Mail Da
     C                     MOVEL*BLANK    WN1223  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1224  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1225  70       Product Complet
     C                     Z-ADD*ZERO     WN1226  60       Product Complet
     C                     Z-ADD*ZERO     WN1227  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1228  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1229  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1230  1        Load Confirmed
     C                     MOVEL*BLANK    WN1231 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1232  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1233  60       Load Door 1
     C                     Z-ADD*ZERO     WN1234  60       Load Door 2
     C                     MOVEL*BLANK    WN1235  1        Partial Load
     C                     MOVEL*BLANK    WN1236  1        Load Confirmati
     C                     MOVEL*BLANK    WN1237  1        Export Load USD
     C                     MOVEL*BLANK    WN1238  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1239 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1240 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1241 15        Late Billing Em
     C                     MOVEL*BLANK    WN1242 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1243 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1244  1        Multi Company L
     C                     MOVEL*BLANK    WN1245  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1246  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1247  1        LH Power Only L
     C                     MOVEL*BLANK    WN1248  1        MG Created Load
     C                     MOVEL*BLANK    WN1249  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1250  2        Load U/M
     C                     MOVEL*BLANK    WN1251  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1252  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1253  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1254  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1255  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1256  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1257  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1258  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1259  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1260  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1261  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1262  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1263  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1264  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1265  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1266  60       LH Unused Time
     C                     MOVEL*BLANK    WN1267  1        EDI Status 1
     C                     MOVEL*BLANK    WN1268  1        EDI Status 2
     C                     MOVEL*BLANK    WN1269  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1270  60       Job Time
     C                     MOVEL*BLANK    WN1271 10        User Id
     C                     MOVEL*BLANK    WN1272 10        Job Name
     C                     Z-ADD*ZERO     WN1273  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWCRMNB    WSRMNB           Load ID
      *
     C           KLCHNW    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHNW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YORDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN1129    WSTLMI           Total Load Mile
     C                     MOVELWN1130    WSVPCD    P      Ship From Wareh
     C                     MOVELWN1131    WSAJCD    P      Warehouse Code
     C                     Z-ADDWN1132    WSK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQNX02           Load ID
      * Define keylist
     C           KPSNX     KLIST
     C                     KFLD           WQNX02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX02           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WQNX02           Load ID
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSNX     SETLL@FLCPEB                    *
     C           KRSNX     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDWHB3TM    WN1108           LD Carrier Appt
     C                     GOTO NXEXIT                     *QUIT
     C           KRSNX     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQNY02           Load ID
      * Define keylist
     C           KPSNY     KLIST
     C                     KFLD           WQNY02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY02           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WQNY02           Load ID
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
      * Establish starting position
     C           KPSNY     SETLL@FLCPEB                    *
     C           KRSNY     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR NZRVGN
     C                     GOTO NYEXIT                     *QUIT
     C           KRSNY     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WJAIC3           Company Number
     C                     Z-ADDWHC4NB    WJC4NB           Order Number
      * Establish starting position
     C           KRSNZ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN1107           Requested Deliv
     C                     Z-ADD*ZERO     WN1127           Requested Deliv
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJBRTX    WUBRTX           Ship To Name
     C                     MOVELWJHNNA    WUHNNA           Ship To City
     C                     Z-ADDWJEIDT    WN1107           Requested Deliv
     C                     Z-ADDWJAFTM    WN1127           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WCRMNB           Load ID
      * Establish starting position
     C           KRSOA     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCQ2CD    YL0138           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQOB02           Load ID
      * Define keylist
     C           KPSOB     KLIST
     C                     KFLD           WQOB02           Load ID
     C                     KFLD           WHRVNB           Stop/Drop
     C                     KFLD           WHC4NB           Order Number
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WQOB02           Load ID
      * Setup key
     C                     Z-ADDWL0535    WQOB02           Load ID
     C                     Z-ADDWL0536    WHRVNB           Stop/Drop
     C                     Z-ADDWL0537    WHC4NB           Order Number
      * Establish starting position
     C           KPSOB     SETLL@FLCPEB                    *
     C           KRSOB     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHRWNB    WL0538           Miles to next s
     C                     GOTO OBEXIT                     *QUIT
     C           KRSOB     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSOC     KLIST
     C                     KFLD           TKMILE           Miles to First
      * Setup key
     C                     Z-ADDWN1275    TKMILE           Miles to First
      * Establish starting position
     C           KPSOC     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTKHRRQ    YL0139           Hours Required
     C                     GOTO OCEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WCRMNB           Load ID
      * Establish starting position
     C           KRSOD     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCPKST    WUG0TX           Load Status
     C                     Z-ADDWCTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDWCK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OERVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TLRMNB    WQOE02           Load ID
      * Define keylist
     C           KRSOE     KLIST
     C                     KFLD           WQOE02           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WQOE02           Load ID
      * Establish starting position
     C           KRSOE     SETLL@FLCPE8                    *
     C           KRSOE     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR OFRVGN
     C                     GOTO OEEXIT                     *QUIT
     C           KRSOE     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
      * Setup key
     C                     Z-ADDTLAIC3    WJAIC3           Company Number
     C                     Z-ADDTLC4NB    WJC4NB           Order Number
      * Establish starting position
     C           KRSOF     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJBKC7    WUBKC7           Ship To Custome
     C                     MOVELWJBRTX    WUBRTX           Ship To Name
     C                     MOVELWJHMNA    WUHMNA           Ship To Address
     C                     MOVELWJHONA    WUHONA           Ship To Address
     C                     MOVELWJHPNA    WUHPNA           Ship To Address
     C                     MOVELWJHNNA    WUHNNA           Ship To City
     C                     MOVELWJDBCD    WN1102           Ship To State C
     C                     MOVELWJCKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELWJBCNA    WUG0TX           Customer Purcha
     C                     MOVELWJB6NA    WUG0TX           Special Instruc
     C                     MOVELWJBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWJEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWJAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQOG02           Load ID
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           WQOG02           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WQOG02           Load ID
      * Establish starting position
     C           KRSOG     SETLL@BFCPD9                    *
     C           KRSOG     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDHNNA    WN1112           Ship To City
     C                     MOVELWDDBCD    WN1113           Ship To State C
     C                     GOTO OGEXIT                     *QUIT
     C           KRSOG     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           TMBZNA           Carrier Code
     C                     KFLD           TMAJCD           Warehouse Code
     C                     KFLD           TMXECD           Destination Cit
     C                     KFLD           TMBGCD           State Code
      * Setup key
     C                     MOVELWN1103    TMBZNA           Carrier Code
     C                     MOVELWN1101    TMAJCD           Warehouse Code
     C                     MOVELWN1112    TMXECD           Destination Cit
     C                     MOVELWN1113    TMBGCD           State Code
      * Establish starting position
     C           KRSOH     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           TMAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDTMNMVA    WN1098           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OICHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1283  30       Company Number
     C                     MOVEL*BLANK    WN1284  1        LTL Flag
     C                     Z-ADD*ZERO     WN1285  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1286 15        Seal 1
     C                     MOVEL*BLANK    WN1287 15        Seal 2
     C                     MOVEL*BLANK    WN1288 15        Seal 3
     C                     MOVEL*BLANK    WN1289 15        Seal 4
     C                     MOVEL*BLANK    WN1290 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1291  70       Total Load Orde
     C                     MOVEL*BLANK    WN1292  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1293  50       Total Stops
     C                     MOVEL*BLANK    WN1294 20        Trailer Id
     C                     MOVEL*BLANK    WN1295  3        Transloader Car
     C                     Z-ADD*ZERO     WN1296  40       BOL Time
     C                     MOVEL*BLANK    WN1297  3        Carrier Code
     C                     MOVEL*BLANK    WN1298  7        Truck Size
     C                     Z-ADD*ZERO     WN1299  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1300 112       Rated Freight
     C                     MOVEL*BLANK    WN1301  1        Ship Status
     C                     MOVEL*BLANK    WN1302  1        Load Type
     C                     Z-ADD*ZERO     WN1303  50       Number Pallets
     C                     Z-ADD*ZERO     WN1304  50       Number Pallets
     C                     Z-ADD*ZERO     WN1305 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1306  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1307  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1308  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1309 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1310 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1311  70       Actual Departur
     C                     Z-ADD*ZERO     WN1312  40       Departure Time
     C                     Z-ADD*ZERO     WN1313  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1314  52       Product Tempera
     C                     Z-ADD*ZERO     WN1315  50       Number Spacers
     C                     MOVEL*BLANK    WN1316 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1317  70       Total Load Mile
     C                     MOVEL*BLANK    WN1318 12        Recorder ID
     C                     MOVEL*BLANK    WN1319  2        Shipping Method
     C                     Z-ADD*ZERO     WN1320  70       Gross Weight
     C                     MOVEL*BLANK    WN1321  3        Carrier Broker
     C                     MOVEL*BLANK    WN1322  1        Export Status
     C                     Z-ADD*ZERO     WN1323  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1324  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1325  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1326  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1327  70       Spotted Date
     C                     Z-ADD*ZERO     WN1328  60       Spotted Time
     C                     Z-ADD*ZERO     WN1329  70       Load Finished D
     C                     Z-ADD*ZERO     WN1330  60       Load Finished T
     C                     Z-ADD*ZERO     WN1331  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1332  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1333  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1334  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1335  70       Truck Departure
     C                     Z-ADD*ZERO     WN1336  60       Truck Departure
     C                     Z-ADD*ZERO     WN1337  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1338  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1339  3        Shipping Line
     C                     MOVEL*BLANK    WN1340 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1341 30        Vessel Name
     C                     Z-ADD*ZERO     WN1342  50       Voyage
     C                     Z-ADD*ZERO     WN1343  70       Sail Date
     C                     MOVEL*BLANK    WN1344 12        Booking Number
     C                     MOVEL*BLANK    WN1345 20        Discharge Port
     C                     Z-ADD*ZERO     WN1346  70       Arrival Date
     C                     MOVEL*BLANK    WN1347 12        Container Numbe
     C                     Z-ADD*ZERO     WN1348  70       Date In
     C                     Z-ADD*ZERO     WN1349  60       Time In
     C                     Z-ADD*ZERO     WN1350  70       Date Out
     C                     Z-ADD*ZERO     WN1351  60       Time Out
     C                     Z-ADD*ZERO     WN1352 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1353  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1354  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1355  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1356  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1357  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1358  70       Requested Deliv
     C                     MOVEL*BLANK    WN1359  1        Load Acceptance
     C                     MOVEL*BLANK    WN1360  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1361  70       On Yard Date
     C                     Z-ADD*ZERO     WN1362  60       On Yard Time
     C                     MOVEL*BLANK    WN1363  1        Load Held Over
     C                     MOVEL*BLANK    WN1364  1        Load Held Over
     C                     MOVEL*BLANK    WN1365 15        Load Held Over
     C                     MOVEL*BLANK    WN1366 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1367 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1368  70       Express Mail Da
     C                     MOVEL*BLANK    WN1369  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1370  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1371  70       Product Complet
     C                     Z-ADD*ZERO     WN1372  60       Product Complet
     C                     Z-ADD*ZERO     WN1373  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1374  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1375  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1376  1        Load Confirmed
     C                     MOVEL*BLANK    WN1377 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1378  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1379  60       Load Door 1
     C                     Z-ADD*ZERO     WN1380  70       Override Total
     C                     Z-ADD*ZERO     WN1381  60       Load Door 2
     C                     MOVEL*BLANK    WN1382  1        Partial Load
     C                     MOVEL*BLANK    WN1383  1        Load Confirmati
     C                     MOVEL*BLANK    WN1384  1        Export Load USD
     C                     MOVEL*BLANK    WN1385  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1386 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1387 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1388 15        Late Billing Em
     C                     MOVEL*BLANK    WN1389 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1390 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1391  1        Multi Company L
     C                     MOVEL*BLANK    WN1392  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1393  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1394  1        LH Power Only L
     C                     MOVEL*BLANK    WN1395  1        MG Created Load
     C                     MOVEL*BLANK    WN1396  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1397  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1398  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1399  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1400  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1401  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1402  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1403  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1404  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1405  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1406  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1407  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1408  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1409  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1410  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1411  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1412  60       LH Unused Time
     C                     MOVEL*BLANK    WN1413  1        EDI Status 1
     C                     MOVEL*BLANK    WN1414  1        EDI Status 2
     C                     MOVEL*BLANK    WN1415  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1416  60       Job Time
     C                     MOVEL*BLANK    WN1417 10        User Id
     C                     MOVEL*BLANK    WN1418 10        Job Name
     C                     Z-ADD*ZERO     WN1419  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWATMLD    WSRMNB           Load ID
      *
     C           KLCHOI    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHOI    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YPRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN1097    WSAODT           Scheduled Ship
     C                     MOVEL'L'       WSPKST    P      Load Status
     C                     Z-ADDWN1098    WSFLAM           Flat Amount
     C                     MOVELWN1101    WSVPCD    P      Ship From Wareh
     C                     MOVELWN1102    WSDBCD    P      Ship To State C
     C                     Z-ADDWN1107    WSKZDT           Deadline Depart
     C                     Z-ADDWN1108    WSAXTM           Deadline Depart
     C                     MOVELWN1110    WSR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN1114           USR Warehouse C
     C                     MOVEL*BLANK    WN1115           USR CDE Parm 1
     C                     MOVEL*BLANK    WN1116           USR CDE Parm 2
     C                     MOVEL*BLANK    WN1117           USR CDE Parm 3
     C                     MOVEL*BLANK    WN1118           USR CDE Parm 4
     C                     MOVEL*BLANK    WN1119           USR CDE Parm 5
     C                     MOVEL*BLANK    WN1120           USR CDE Parm 6
     C                     MOVEL*BLANK    WN1121           USR CDE Parm 7
     C                     MOVEL*BLANK    WN1122           USR CDE Parm 8
     C                     MOVEL*BLANK    WN1123           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQOJ02           Load ID
      * Define keylist
     C           KRSOJ     KLIST
     C                     KFLD           WQOJ02           Load ID
      * Setup key
     C                     Z-ADDWATMLD    WQOJ02           Load ID
      * Establish starting position
     C           KRSOJ     SETLL@FLCPKF                    *
     C           KRSOJ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR OKRVGN
     C           KRSOJ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TJAIC3    WQOK01           Company Number
     C           *LIKE     DEFN TJC4NB    WQOK02           Order Number
      * Define keylist
     C           KPSOK     KLIST
     C                     KFLD           WQOK01           Company Number
     C                     KFLD           WQOK02           Order Number
     C                     KFLD           TJDPNB           Order Sequence
     C                     KFLD           TJUENB           Order Secondary
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           WQOK01           Company Number
     C                     KFLD           WQOK02           Order Number
      * Setup key
     C                     Z-ADDWWAIC3    WQOK01           Company Number
     C                     Z-ADDWWC4NB    WQOK02           Order Number
     C                     Z-ADD*ZERO     TJDPNB           Order Sequence
     C                     Z-ADD*ZERO     TJUENB           Order Secondary
      * Establish starting position
     C           KPSOK     SETLL@BGWKAE                    *
     C           KRSOK     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           TJAJCD    IFEQ WN1114                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           TJAJCD    IFEQ WN1115                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           TJAJCD    IFEQ WN1116                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           TJAJCD    IFEQ WN1117                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           TJAJCD    IFEQ WN1118                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           TJAJCD    IFEQ WN1119                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           TJAJCD    IFEQ WN1120                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           TJAJCD    IFEQ WN1121                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           TJAJCD    IFEQ WN1122                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           TJAJCD    IFEQ WN1123                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN1114    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1114           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN1115    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1115           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN1116    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1116           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN1117    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1117           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN1118    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1118           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN1119    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1119           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN1120    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1120           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN1121    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1121           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN1122    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1122           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN1123    IFEQ WUGSTX                     *IF
     C                     MOVELTJAJCD    WN1123           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSOK     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN THRMNB    WQOL01           Load ID
      * Define keylist
     C           KRSOL     KLIST
     C                     KFLD           WQOL01           Load ID
      * Setup key
     C                     Z-ADDWL0539    WQOL01           Load ID
      * Establish starting position
     C           KRSOL     SETLL@FLCPBW                    *
     C           KRSOL     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR OMRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0540           Trans Contol AS
     C                     GOTO OLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOL     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOM     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
      * Setup key
     C                     Z-ADDTHAIC3    WJAIC3           Company Number
     C                     Z-ADDTHC4NB    WJC4NB           Order Number
      * Establish starting position
     C           KRSOM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR ONRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO OMEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQON01           Company Number
     C           *LIKE     DEFN TFC4NB    WQON02           Order Number
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           WQON01           Company Number
     C                     KFLD           WQON02           Order Number
      * Setup key
     C                     Z-ADDWJAIC3    WQON01           Company Number
     C                     Z-ADDWJC4NB    WQON02           Order Number
      * Establish starting position
     C           KRSON     SETLL@BGWKL1                    *
     C           KRSON     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           TFGMST    IFEQ 'L'                        *IF
     C           TFGMST    OREQ 'A'
     C           TFGMST    OREQ 'C'
     C           TFGMST    OREQ 'R'
     C           TFGMST    OREQ 'E'
     C           TFGMST    OREQ 'H'
     C           TFGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR OORVGN
     C                     GOTO ONEXIT                     *QUIT
     C                     END                             *FI
     C           KRSON     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OORVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOO     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELTFAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSOO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWKXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           TOY1NX           PFS Company Num
     C                     KFLD           TOGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0541    TOY1NX           PFS Company Num
     C                     MOVELWL0542    TOGYAA           PFS Interface C
      * Establish starting position
     C           KRSOP     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0543           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0544           PFS Carlisle Ac
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTOWSSX    WL0543           PFS AccuSort Ac
     C                     MOVELTOWUSX    WL0544           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQRVGN    BEGSR
      *================================================================
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WL0547           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN TRK4DT    WQOQ01           Created Date
     C           *LIKE     DEFN TRA1TM    WQOQ02           Created Time
      * Define keylist
     C           KRSOQ     KLIST
     C                     KFLD           WQOQ01           Created Date
     C                     KFLD           WQOQ02           Created Time
      * Setup key
     C                     Z-ADDWL0545    WQOQ01           Created Date
     C                     Z-ADDWL0546    WQOQ02           Created Time
      * Establish starting position
     C           KRSOQ     SETLL@LHCPBN                    *
     C           KRSOQ     READE@LHCPBN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0547           Sequence Number
     C                     GOTO OQEXIT                     *QUIT
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           TRDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           TRDXNB    ADD  1         WL0547           Sequence Number
     C                     GOTO OQEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOQ     READE@LHCPBN                  90*
     C                     ENDDO
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WL0549           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN TSRMNB    WQOR02           Load ID
      * Define keylist
     C           KRSOR     KLIST
     C                     KFLD           WQOR02           Load ID
      * Setup key
     C                     Z-ADDWL0548    WQOR02           Load ID
      * Establish starting position
     C           KRSOR     SETLL@LHCPQR                    *
     C           KRSOR     READE@LHCPQR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0549           Sequence Number
     C                     GOTO OREXIT                     *QUIT
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           TSDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           TSDXNB    ADD  1         WL0549           Sequence Number
     C                     GOTO OREXIT                     *QUIT
     C                     END                             *FI
     C           KRSOR     READE@LHCPQR                  90*
     C                     ENDDO
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSCRRC    BEGSR
      *================================================================
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LHCPN6
     C                     Z-ADDWL0550    TTK4DT           Created Date
     C                     Z-ADDWL0551    TTA1TM           Created Time
     C                     Z-ADDWL0552    TTDXNB           Sequence Number
     C                     Z-ADDWL0553    TTRMNB           Load ID
     C                     Z-ADDWL0554    TTRVNB           Stop/Drop
     C                     MOVELWL0555    TTRVST           Load Change Typ
     C                     MOVELWL0556    TTUJST           Department Cont
     C                     MOVELWL0557    TTMNTX           Change Log Prio
     C                     MOVELWL0558    TTMOTX           Change Log New
     C                     MOVELWL0559    TTAYNA           User Id
     C                     MOVELWL0560    TTA0NA           Job Name
     C                     MOVELWL0561    TTBZNA           Carrier Code
     C                     MOVELWL0562    TTXMCD           Carrier Broker
     C                     Z-ADDWL0563    TTAIC3           Company Number
     C                     Z-ADDWL0564    TTC4NB           Order Number
      *
     C           KLCROS    KLIST
     C                     KFLD           TTK4DT           Created Date
     C                     KFLD           TTA1TM           Created Time
     C                     KFLD           TTDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCROS    SETLL@LHCPN6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2472' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C                     WRITE@LHCPN6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1425  30       Company Number
     C                     Z-ADD*ZERO     WN1426  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1427  1        LTL Flag
     C                     Z-ADD*ZERO     WN1428  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1429 15        Seal 1
     C                     MOVEL*BLANK    WN1430 15        Seal 2
     C                     MOVEL*BLANK    WN1431 15        Seal 3
     C                     MOVEL*BLANK    WN1432 15        Seal 4
     C                     MOVEL*BLANK    WN1433 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1434  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1435 112       Flat Amount
     C                     MOVEL*BLANK    WN1436  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1437  50       Total Stops
     C                     MOVEL*BLANK    WN1438 20        Trailer Id
     C                     MOVEL*BLANK    WN1439  3        Transloader Car
     C                     Z-ADD*ZERO     WN1440  40       BOL Time
     C                     MOVEL*BLANK    WN1441  3        Carrier Code
     C                     MOVEL*BLANK    WN1442  7        Truck Size
     C                     Z-ADD*ZERO     WN1443  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN1444  1        Ship Status
     C                     MOVEL*BLANK    WN1445  1        Load Type
     C                     Z-ADD*ZERO     WN1446  50       Number Pallets
     C                     Z-ADD*ZERO     WN1447  50       Number Pallets
     C                     Z-ADD*ZERO     WN1448 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1449  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1450  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1451  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1452 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1453 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1454  70       Actual Departur
     C                     Z-ADD*ZERO     WN1455  40       Departure Time
     C                     Z-ADD*ZERO     WN1456  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1457  52       Product Tempera
     C                     Z-ADD*ZERO     WN1458  50       Number Spacers
     C                     MOVEL*BLANK    WN1459 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1460  70       Total Load Mile
     C                     MOVEL*BLANK    WN1461 12        Recorder ID
     C                     MOVEL*BLANK    WN1462  2        Shipping Method
     C                     MOVEL*BLANK    WN1463  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1464  2        Ship To State C
     C                     Z-ADD*ZERO     WN1465  70       Gross Weight
     C                     MOVEL*BLANK    WN1466  3        Carrier Broker
     C                     MOVEL*BLANK    WN1467  1        Export Status
     C                     Z-ADD*ZERO     WN1468  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1469  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1470  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1471  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1472  70       Spotted Date
     C                     Z-ADD*ZERO     WN1473  60       Spotted Time
     C                     Z-ADD*ZERO     WN1474  70       Load Finished D
     C                     Z-ADD*ZERO     WN1475  60       Load Finished T
     C                     Z-ADD*ZERO     WN1476  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1477  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1478  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1479  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1480  70       Truck Departure
     C                     Z-ADD*ZERO     WN1481  60       Truck Departure
     C                     Z-ADD*ZERO     WN1482  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1483  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1484  3        Shipping Line
     C                     MOVEL*BLANK    WN1485 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1486 30        Vessel Name
     C                     Z-ADD*ZERO     WN1487  50       Voyage
     C                     Z-ADD*ZERO     WN1488  70       Sail Date
     C                     MOVEL*BLANK    WN1489 12        Booking Number
     C                     MOVEL*BLANK    WN1490 20        Discharge Port
     C                     Z-ADD*ZERO     WN1491  70       Arrival Date
     C                     MOVEL*BLANK    WN1492 12        Container Numbe
     C                     Z-ADD*ZERO     WN1493  70       Date In
     C                     Z-ADD*ZERO     WN1494  60       Time In
     C                     Z-ADD*ZERO     WN1495  70       Date Out
     C                     Z-ADD*ZERO     WN1496  60       Time Out
     C                     Z-ADD*ZERO     WN1497 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1498  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1499  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1500  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1501  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1502  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1503  70       Requested Deliv
     C                     MOVEL*BLANK    WN1504  1        Load Acceptance
     C                     MOVEL*BLANK    WN1505  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1506  70       On Yard Date
     C                     Z-ADD*ZERO     WN1507  60       On Yard Time
     C                     Z-ADD*ZERO     WN1508  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1509  60       Deadline Depart
     C                     MOVEL*BLANK    WN1510  1        Load Held Over
     C                     MOVEL*BLANK    WN1511  1        Load Held Over
     C                     MOVEL*BLANK    WN1512 15        Load Held Over
     C                     MOVEL*BLANK    WN1513 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1514 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1515  70       Express Mail Da
     C                     MOVEL*BLANK    WN1516  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1517  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1518  70       Product Complet
     C                     Z-ADD*ZERO     WN1519  60       Product Complet
     C                     Z-ADD*ZERO     WN1520  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1521  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1522  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1523  1        Load Confirmed
     C                     MOVEL*BLANK    WN1524 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1525  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1526  60       Load Door 1
     C                     Z-ADD*ZERO     WN1527  70       Override Total
     C                     Z-ADD*ZERO     WN1528  60       Load Door 2
     C                     MOVEL*BLANK    WN1529  1        Partial Load
     C                     MOVEL*BLANK    WN1530  1        Load Confirmati
     C                     MOVEL*BLANK    WN1531  1        Export Load USD
     C                     MOVEL*BLANK    WN1532  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1533 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1534 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1535 15        Late Billing Em
     C                     MOVEL*BLANK    WN1536 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1537 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1538  1        Multi Company L
     C                     MOVEL*BLANK    WN1539  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1540  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1541  1        LH Power Only L
     C                     MOVEL*BLANK    WN1542  1        MG Created Load
     C                     MOVEL*BLANK    WN1543  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1544  2        Load U/M
     C                     MOVEL*BLANK    WN1545  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1546  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1547  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1548  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1549  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1550  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1551  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1552  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1553  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1554  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1555  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1556  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1557  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1558  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1559  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1560  60       LH Unused Time
     C                     MOVEL*BLANK    WN1561  1        EDI Status 1
     C                     MOVEL*BLANK    WN1562  1        EDI Status 2
     C                     MOVEL*BLANK    WN1563  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1564  60       Job Time
     C                     MOVEL*BLANK    WN1565 10        User Id
     C                     MOVEL*BLANK    WN1566 10        Job Name
     C                     Z-ADD*ZERO     WN1567  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0565    WSRMNB           Load ID
      *
     C           KLCHOT    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHOT    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YQRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0566    WSPKST    P      Load Status
     C                     Z-ADDWL0567    WSR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OURVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOU     KLIST
     C                     KFLD           TVDOCD           System Value Co
      * Setup key
     C                     MOVELWL0568    TVDOCD           System Value Co
      * Establish starting position
     C           KRSOU     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0569           System Value Al
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTVBXTX    WL0569           System Value Al
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQOV02           Load ID
      * Define keylist
     C           KRSOV     KLIST
     C                     KFLD           WQOV02           Load ID
      * Setup key
     C                     Z-ADDWL0570    WQOV02           Load ID
      * Establish starting position
     C           KRSOV     SETLL@FLCPEB                    *
     C           KRSOV     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR OWCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR OXRVGN
     C           KRSOV     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1572  50       Stop/Drop
     C                     MOVEL*BLANK    WN1573 30        Comments for Pi
     C                     Z-ADD*ZERO     WN1574  72       Freight Charge
     C                     Z-ADD*ZERO     WN1575  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1576  30       Company Number
     C                     Z-ADD*ZERO     WN1577  70       Order Number
     C                     MOVEL*BLANK    WN1578  1        Ship Status
     C                     Z-ADD*ZERO     WN1579  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN1580  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1581  70       Appointment Con
     C                     Z-ADD*ZERO     WN1582  60       Appointment Con
     C                     MOVEL*BLANK    WN1583 30        Confirmation Ma
     C                     MOVEL*BLANK    WN1584 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN1585  70       Actual Delivery
     C                     Z-ADD*ZERO     WN1586  60       Actual Delivery
     C                     Z-ADD*ZERO     WN1587  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1588  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1589  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1590  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1591  70       On Yard Date
     C                     Z-ADD*ZERO     WN1592  60       On Yard Time
     C                     Z-ADD*ZERO     WN1593  70       MPC Number
     C                     MOVEL*BLANK    WN1594  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN1595  1        On Time Add'l R
     C                     MOVEL*BLANK    WN1596 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN1597 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN1598 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN1599 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN1600 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN1601  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1602  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1603  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1604  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1605  60       LD Unused Time
     C                     Z-ADD*ZERO     WN1606  60       LD Unused Time
     C                     MOVEL*BLANK    WN1607  1        Miles Error Sts
     C                     MOVEL*BLANK    WN1608  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN1609  2        HPB Transload S
     C                     MOVEL*BLANK    WN1610 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN1611 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN1612 25        Cust Assigned A
     C                     MOVEL*BLANK    WN1613  1        EDI Status 1
     C                     MOVEL*BLANK    WN1614  1        EDI Status 2
     C                     MOVEL*BLANK    WN1615  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1616  60       Job Time
     C                     MOVEL*BLANK    WN1617 10        User Id
     C                     MOVEL*BLANK    WN1618 10        Job Name
     C                     Z-ADD*ZERO     WN1619  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWHRMNB    TBRMNB           Load ID
     C                     Z-ADDWHRUNB    TBRUNB           Stop/Drop Seque
      *
     C           KLCHOW    KLIST
     C                     KFLD           TBRMNB           Load ID
     C                     KFLD           TBRUNB           Stop/Drop Seque
     C           KLCHOW    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YRRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWHRWNB    TBRWNB           Miles to next s
     C                     Z-ADD*ZERO     TBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     TBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     TBR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TBAATM' defaulted for 'Job Time'.
      * Field '(DB1) TBAYNA' defaulted for 'User Id'.
      * Field '(DB1) TBA0NA' defaulted for 'Job Name'.
      * Field '(DB1) TBAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN TWRMNB    WQOX02           Load ID
     C           *LIKE     DEFN TWC4NB    WQOX03           Order Number
      * Define keylist
     C           KRSOX     KLIST
     C                     KFLD           WQOX02           Load ID
     C                     KFLD           WQOX03           Order Number
      * Setup key
     C                     Z-ADDWHRMNB    WQOX02           Load ID
     C                     Z-ADDWHC4NB    WQOX03           Order Number
      * Establish starting position
     C           KRSOX     SETLL@BFCPNQ                    *
     C           KRSOX     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR OYCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR OZRVGN
     C           KRSOX     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1620  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1621  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1622  70       Ship To Custome
     C                     MOVEL*BLANK    WN1623 30        Ship To Name
     C                     MOVEL*BLANK    WN1624 30        Ship To Address
     C                     MOVEL*BLANK    WN1625 30        Ship To Address
     C                     MOVEL*BLANK    WN1626 30        Ship To Address
     C                     MOVEL*BLANK    WN1627 20        Ship To City
     C                     MOVEL*BLANK    WN1628  2        Ship To State C
     C                     MOVEL*BLANK    WN1629 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1630  70       Bill to Custome
     C                     MOVEL*BLANK    WN1631 30        Bill to Name
     C                     MOVEL*BLANK    WN1632 30        Bill to Address
     C                     MOVEL*BLANK    WN1633 30        Bill to Address
     C                     MOVEL*BLANK    WN1634 30        Bill to Address
     C                     MOVEL*BLANK    WN1635 20        Bill to City
     C                     MOVEL*BLANK    WN1636  2        Bill to State C
     C                     MOVEL*BLANK    WN1637 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1638 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1639  70       Order Date
     C                     Z-ADD*ZERO     WN1640  70       Requested Ship
     C                     Z-ADD*ZERO     WN1641  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1642  70       Cancel Date
     C                     MOVEL*BLANK    WN1643  2        Terms Code
     C                     MOVEL*BLANK    WN1644 40        Special Instruc
     C                     MOVEL*BLANK    WN1645 40        Special Instruc
     C                     MOVEL*BLANK    WN1646  3        Carrier Code
     C                     MOVEL*BLANK    WN1647  1        Comment Print A
     C                     MOVEL*BLANK    WN1648  1        Comment Print I
     C                     MOVEL*BLANK    WN1649  1        Comment Print P
     C                     MOVEL*BLANK    WN1650  1        Comment Print S
     C                     MOVEL*BLANK    WN1651  3        Reason Code
     C                     MOVEL*BLANK    WN1652  1        Order in Use
     C                     MOVEL*BLANK    WN1653  1        Header Status
     C                     MOVEL*BLANK    WN1654  1        Header Status L
     C                     MOVEL*BLANK    WN1655  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1656  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1657 10        User Original E
     C                     Z-ADD*ZERO     WN1658  70       Date of Origina
     C                     Z-ADD*ZERO     WN1659 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1660 112       Order Weight To
     C                     MOVEL*BLANK    WN1661  1        Credit Hold
     C                     MOVEL*BLANK    WN1662  1        Production Hold
     C                     MOVEL*BLANK    WN1663  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1664  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1665  40       Requested Deliv
     C                     MOVEL*BLANK    WN1666  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1667 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1668  70       Load ID
     C                     Z-ADD*ZERO     WN1669  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN1670  1        LTL Flag
     C                     MOVEL*BLANK    WN1671  1        Price Audit
     C                     MOVEL*BLANK    WN1672  1        Price Status
     C                     MOVEL*BLANK    WN1673  2        Shipping Method
     C                     MOVEL*BLANK    WN1674  1        Export Status
     C                     MOVEL*BLANK    WN1675  1        Palletize
     C                     MOVEL*BLANK    WN1676  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1677  1        Slip Sheet
     C                     MOVEL*BLANK    WN1678  1        Age Code
     C                     Z-ADD*ZERO     WN1679  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1680  1        Load Type
     C                     Z-ADD*ZERO     WN1681  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1682  1        Load Plan Order
     C                     MOVEL*BLANK    WN1683  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1684  70       Resell Referenc
     C                     MOVEL*BLANK    WN1685 30        Special Comment
     C                     MOVEL*BLANK    WN1686 30        Special Comment
     C                     MOVEL*BLANK    WN1687  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1688  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1689  2        Manager Level C
     C                     MOVEL*BLANK    WN1690  3        VP Level Code
     C                     Z-ADD*ZERO     WN1691  70       Attach to Order
     C                     MOVEL*BLANK    WN1692  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1693  70       Invoice Number
     C                     MOVEL*BLANK    WN1694  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1695  70       Invoice Date
     C                     MOVEL*BLANK    WN1696  2        Event Code
     C                     MOVEL*BLANK    WN1697  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1698  1        Modified Flag
     C                     Z-ADD*ZERO     WN1699 112       A/R order Value
     C                     MOVEL*BLANK    WN1700  1        Billing Activit
     C                     MOVEL*BLANK    WN1701  1        Block Order Fla
     C                     MOVEL*BLANK    WN1702  1        Order Certifica
     C                     Z-ADD*ZERO     WN1703 112       Invoice Order V
     C                     MOVEL*BLANK    WN1704  1        Process Sts for
     C                     MOVEL*BLANK    WN1705  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1706  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1707  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1708  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1709  1        Email Cust On O
     C                     MOVEL*BLANK    WN1710  1        Order Emailed
     C                     MOVEL*BLANK    WN1711  1        Export Docs Go
     C                     MOVEL*BLANK    WN1712  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1713  1        Broker Order St
     C                     MOVEL*BLANK    WN1714  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1715  2        Order Requires
     C                     MOVEL*BLANK    WN1716  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1717  2        Export USDA App
     C                     MOVEL*BLANK    WN1718  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1719  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1720  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1721  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1722  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1723  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1724  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1725  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1726  60       Time of Origina
     C                     Z-ADD*ZERO     WN1727  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1728  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1729  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1730 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1731 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1732 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1733 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1734 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1735  70       Claim Number
     C                     MOVEL*BLANK    WN1736  1        EDI Status 1
     C                     MOVEL*BLANK    WN1737  1        EDI Status 2
     C                     MOVEL*BLANK    WN1738  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1739  60       Job Time
     C                     MOVEL*BLANK    WN1740 10        User Id
     C                     MOVEL*BLANK    WN1741 10        Job Name
     C                     Z-ADD*ZERO     WN1742  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDTWAIC3    WXAIC3           Company Number
     C                     Z-ADDTWC4NB    WXC4NB           Order Number
      *
     C           KLCHOY    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C           KLCHOY    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YSRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WXR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWXAIC3    PAAIC3           Company Number
     C                     Z-ADDWXC4NB    PAC4NB           Order Number
     C                     MOVELWXJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWXANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWXBKC7    PABKC7           Ship To Custome
     C                     MOVELWXBRTX    PABRTX    P      Ship To Name
     C                     MOVELWXHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWXHONA    PAHONA    P      Ship To Address
     C                     MOVELWXHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWXHNNA    PAHNNA    P      Ship To City
     C                     MOVELWXDBCD    PADBCD    P      Ship To State C
     C                     MOVELWXCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWXB0C7    PAB0C7           Bill to Custome
     C                     MOVELWXAETX    PAAETX    P      Bill to Name
     C                     MOVELWXB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWXB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWXB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWXB2NA    PAB2NA    P      Bill to City
     C                     MOVELWXBHCD    PABHCD    P      Bill to State C
     C                     MOVELWXC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWXBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWXA0DT    PAA0DT           Order Date
     C                     Z-ADDWXA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWXGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWXACDT    PAACDT           Cancel Date
     C                     MOVELWXAQCD    PAAQCD    P      Terms Code
     C                     MOVELWXB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWXBYNA    PABYNA    P      Special Instruc
     C                     MOVELWXBZNA    PABZNA    P      Carrier Code
     C                     MOVELWXGTST    PAGTST    P      Comment Print A
     C                     MOVELWXGVST    PAGVST    P      Comment Print I
     C                     MOVELWXGUST    PAGUST    P      Comment Print P
     C                     MOVELWXQFST    PAQFST    P      Comment Print S
     C                     MOVELWXCQCD    PACQCD    P      Reason Code
     C                     MOVELWXGJST    PAGJST    P      Order in Use
     C                     MOVELWXGWST    PAGWST    P      Header Status
     C                     MOVELWXGXST    PAGXST    P      Header Status L
     C                     MOVELWXGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWXAODT    PAAODT           Scheduled Ship
     C                     MOVELWXAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWXCXDT    PACXDT           Date of Origina
     C                     Z-ADDWXJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWXA1WG    PAA1WG           Order Weight To
     C                     MOVELWXXIST    PAXIST    P      Credit Hold
     C                     MOVELWXXJST    PAXJST    P      Production Hold
     C                     MOVELWXXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWXEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWXAFTM    PAAFTM           Requested Deliv
     C                     MOVELWXE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWXE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWXRMNB    PARMNB           Load ID
     C                     Z-ADDWXTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWXR1NB    PAR1NB           Rated Freight
     C                     MOVELWXPJST    PAPJST    P      LTL Flag
     C                     MOVELWXU0ST    PAU0ST    P      Price Audit
     C                     MOVELWXU1ST    PAU1ST    P      Price Status
     C                     MOVELWXQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWXU2ST    PAU2ST    P      Export Status
     C                     MOVELWXVEST    PAVEST    P      Palletize
     C                     MOVELWXVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWXVGST    PAVGST    P      Slip Sheet
     C                     MOVELWXRPCD    PARPCD    P      Age Code
     C                     Z-ADDWXRNNB    PARNNB           Reefer Temperat
     C                     MOVELWXVDST    PAVDST    P      Load Type
     C                     Z-ADDWXATIN    PAATIN           Attach to Invoi
     C                     MOVELWXU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWXU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWXRSRN    PARSRN           Resell Referenc
     C                     MOVELWXMHNA    PAMHNA    P      Special Comment
     C                     MOVELWXMINA    PAMINA    P      Special Comment
     C                     MOVELWXWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWXR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWXBFCD    PABFCD    P      Manager Level C
     C                     MOVELWXQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWXT3NB    PAT3NB           Attach to Order
     C                     MOVELWXSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWXCONB    PACONB           Invoice Number
     C                     MOVELWXCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWXAWDT    PAAWDT           Invoice Date
     C                     MOVELWXJPCD    PAJPCD    P      Event Code
     C                     MOVELWXXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWXZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWXVRVA    PAVRVA           A/R order Value
     C                     MOVELWXOBST    PAOBST    P      Billing Activit
     C                     MOVELWXBCST    PABCST    P      Block Order Fla
     C                     MOVELWXBDST    PABDST    P      Order Certifica
     C                     Z-ADDWXB7VL    PAB7VL           Invoice Order V
     C                     MOVELWXGASX    PAGASX    P      Process Sts for
     C                     MOVELWXGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWXGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWXGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWXFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWXFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWXFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWXFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWXFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWXFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWXFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWXFUSX    PAFUSX    P      Order Requires
     C                     MOVELWXFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWXFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWXFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWXFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWXNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWXNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWXNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWXNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWXNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWXBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWXBQTM    PABQTM           Time of Origina
     C                     Z-ADDWXBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWXBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWXBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWXH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWXH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWXH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWXH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWXH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWXC0C7    PAC0C7           Claim Number
     C                     MOVELWXUVST    PAUVST    P      EDI Status 1
     C                     MOVELWXUWST    PAUWST    P      EDI Status 2
     C                     MOVELWXUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWXAATM    PAAATM           Job Time
     C                     MOVELWXAYNA    PAAYNA    P      User Id
     C                     MOVELWXA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWXAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1743  30       Order Sequence
     C                     Z-ADD*ZERO     WN1744  30       Order Secondary
     C                     Z-ADD*ZERO     WN1745 112       Rated Freight
     C                     Z-ADD*ZERO     WN1746 112       @Rated Freight
     C                     MOVEL*BLANK    WN1747  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN1746           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN1747           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQOZ01           Company Number
     C           *LIKE     DEFN TFC4NB    WQOZ02           Order Number
      * Define keylist
     C           KRSOZ     KLIST
     C                     KFLD           WQOZ01           Company Number
     C                     KFLD           WQOZ02           Order Number
      * Setup key
     C                     Z-ADDTWAIC3    WQOZ01           Company Number
     C                     Z-ADDTWC4NB    WQOZ02           Order Number
      * Establish starting position
     C           KRSOZ     SETLL@BGWKL1                    *
     C           KRSOZ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           TFGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTFAIC3    WL0572           Company Number
     C                     Z-ADDTFC4NB    WL0573           Order Number
     C                     Z-ADDTFDPNB    WL0574           Order Sequence
     C                     Z-ADDTFUENB    WL0575           Order Secondary
     C                     Z-ADD*ZERO     WL0576           Rated Freight
     C                     EXSR PACHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN1747           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           TWA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN1745           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           TFGMST    IFEQ 'C'                        *IF
     C           TFGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           TFATWG    DIV  TWA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           TFAVQT    MULT TFAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  TWA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN1745    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTFAIC3    WL0572           Company Number
     C                     Z-ADDTFC4NB    WL0573           Order Number
     C                     Z-ADDTFDPNB    WL0574           Order Sequence
     C                     Z-ADDTFUENB    WL0575           Order Secondary
     C                     Z-ADDWN1745    WL0576           Rated Freight
     C                     EXSR PACHRC
     C                     ADD  WN1745    WN1746           @Rated Freight
     C                     Z-ADDTFDPNB    WN1743           Order Sequence
     C                     Z-ADDTFUENB    WN1744           Order Secondary
     C                     END                             *FI
     C           KRSOZ     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1746    IFNE *ZERO                      *IF
     C           WN1747    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN1746    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN1745           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTWAIC3    WL0572           Company Number
     C                     Z-ADDTWC4NB    WL0573           Order Number
     C                     Z-ADDWN1743    WL0574           Order Sequence
     C                     Z-ADDWN1744    WL0575           Order Secondary
     C                     Z-ADDWN1745    WL0576           Rated Freight
     C                     EXSR PACHRC
     C                     END                             *FI
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PACHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1748  70       Item Code
     C                     MOVEL*BLANK    WN1749  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1750  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1751  70       Order Group Cod
     C                     MOVEL*BLANK    WN1752  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1753  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1754 112       Billing Detail
     C                     Z-ADD*ZERO     WN1755 112       Billing Detail
     C                     Z-ADD*ZERO     WN1756 112       Billing Detail
     C                     Z-ADD*ZERO     WN1757 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1758  1        Comment Print A
     C                     MOVEL*BLANK    WN1759  1        Comment Print I
     C                     MOVEL*BLANK    WN1760  1        Comment Print P
     C                     MOVEL*BLANK    WN1761  1        Comment Print S
     C                     Z-ADD*ZERO     WN1762 112       Extended Amount
     C                     Z-ADD*ZERO     WN1763  70       Market Pricing
     C                     MOVEL*BLANK    WN1764  3        Commodity Marke
     C                     MOVEL*BLANK    WN1765  3        Date Method Cod
     C                     MOVEL*BLANK    WN1766  3        Price Method Co
     C                     Z-ADD*ZERO     WN1767 114       Price Overage O
     C                     Z-ADD*ZERO     WN1768  70       Contract Number
     C                     MOVEL*BLANK    WN1769  1        Price Status
     C                     Z-ADD*ZERO     WN1770  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1771  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1772  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1773  1        Work Confirm St
     C                     MOVEL*BLANK    WN1774  1        Work Over/Short
     C                     MOVEL*BLANK    WN1775  1        OD Production P
     C                     MOVEL*BLANK    WN1776 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1777 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1778  1        Age Code
     C                     MOVEL*BLANK    WN1779  1        Palletize
     C                     MOVEL*BLANK    WN1780  1        Slip Sheet
     C                     MOVEL*BLANK    WN1781  1        Catch Weight St
     C                     MOVEL*BLANK    WN1782  1        Price Audit
     C                     MOVEL*BLANK    WN1783  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1784  1        Production Date
     C                     Z-ADD*ZERO     WN1785 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1786 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1787 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1788 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1789 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1790 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1791 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1792 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1793 114       Unit Price
     C                     Z-ADD*ZERO     WN1794 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1795 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1796 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1797 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1798  70       Requested Ship
     C                     Z-ADD*ZERO     WN1799  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1800  70       Actual Shipped
     C                     MOVEL*BLANK    WN1801  1        Affect Inventor
     C                     MOVEL*BLANK    WN1802  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1803  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1804  30       Item Structure
     C                     Z-ADD*ZERO     WN1805  30       Item Structure
     C                     Z-ADD*ZERO     WN1806  30       Item Structure
     C                     MOVEL*BLANK    WN1807  2        Item Level
     C                     MOVEL*BLANK    WN1808  2        Quality Level
     C                     MOVEL*BLANK    WN1809  2        Pricing Product
     C                     MOVEL*BLANK    WN1810  2        Season Product
     C                     Z-ADD*ZERO     WN1811  70       Date of Origina
     C                     MOVEL*BLANK    WN1812 10        User Profile Na
     C                     MOVEL*BLANK    WN1813  6        Country Code
     C                     MOVEL*BLANK    WN1814  2        Event Code
     C                     MOVEL*BLANK    WN1815  3        Reason Code
     C                     MOVEL*BLANK    WN1816  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1817  1        Modified Flag
     C                     MOVEL*BLANK    WN1818  1        Substituted Fla
     C                     MOVEL*BLANK    WN1819  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1820 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1821 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1822  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1823  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1824  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1825  1        Affect Commissi
     C                     MOVEL*BLANK    WN1826  1        Affect Pricing
     C                     MOVEL*BLANK    WN1827  1        Released by Use
     C                     MOVEL*BLANK    WN1828  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1829  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1830  3        Production Ware
     C                     MOVEL*BLANK    WN1831  3        OD Price Type
     C                     Z-ADD*ZERO     WN1832  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1833  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1834  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1835  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1836  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1837  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1838  60       Price Code
     C                     Z-ADD*ZERO     WN1839  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1840  60       Substitution Li
     C                     Z-ADD*ZERO     WN1841  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1842 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1843 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1844 112       OD Item Target
     C                     Z-ADD*ZERO     WN1845 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1846 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1847 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1848 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1849 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1850 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1851 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1852 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1853 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1854 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1855  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1856  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1857  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1858 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1859  40       Item Age Days
     C                     Z-ADD*ZERO     WN1860  70       Production Ovr
     C                     Z-ADD*ZERO     WN1861  70       Production Ovr
     C                     MOVEL*BLANK    WN1862  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1863  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1864  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1865  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1866  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1867  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1868  1        EDI Status 1
     C                     MOVEL*BLANK    WN1869  1        EDI Status 2
     C                     MOVEL*BLANK    WN1870  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1871  60       Job Time
     C                     MOVEL*BLANK    WN1872 10        User Id
     C                     MOVEL*BLANK    WN1873 10        Job Name
     C                     Z-ADD*ZERO     WN1874  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0572    TGAIC3           Company Number
     C                     Z-ADDWL0573    TGC4NB           Order Number
     C                     Z-ADDWL0574    TGDPNB           Order Sequence
     C                     Z-ADDWL0575    TGUENB           Order Secondary
      *
     C           KLCHPA    KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGC4NB           Order Number
     C                     KFLD           TGDPNB           Order Sequence
     C                     KFLD           TGUENB           Order Secondary
     C           KLCHPA    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YTRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0576    TGR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TGAATM           Job Time
     C                     MOVEL##USR     TGAYNA           User Id
     C                     MOVEL##JOB     TGA0NA           Job Name
     C                     Z-ADD##JDT     TGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBDLRC    BEGSR
      *================================================================
      * DLT Load Header        DL - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPBO
     C                     Z-ADDWN0006    WSRMNB           Load ID
      *
     C           KLDLPB    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLDLPB    CHAIN@FJCPBO              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPBO                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCCHRC    BEGSR
      *================================================================
      * Chg TMS Load          CH - TMS Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @CRCPXL
     C                     Z-ADDWATMLD    TXTMLD           TMS Load ID
     C                     Z-ADDWAAYD8    TXAYD8           TMS Extract Dat
     C                     Z-ADDWAAFTH    TXAFTH           TMS Extract Tim
     C                     MOVELWAFSU1    TXFSU1    P      TMS Extract Fil
      *
     C           KLCHPC    KLIST
     C                     KFLD           TXTMLD           TMS Load ID
     C                     KFLD           TXAYD8           TMS Extract Dat
     C                     KFLD           TXAFTH           TMS Extract Tim
     C                     KFLD           TXFSU1           TMS Extract Fil
     C           KLCHPC    CHAIN@CRCPXL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCRCPL0'MDACP
     C                     MOVEL'@CRCPXL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCR1    YURDCS
      * Move non-key fields to @CRCPXL
     C                     MOVELWAUPAA    TXUPAA    P      TMS Customer Lo
     C                     Z-ADDWALTMP    TXLTMP           TMS Temperature
     C                     MOVELWADFSC    TXDFSC    P      TMS Temperature
     C                     MOVELWADGSC    TXDGSC    P      TMS Movement Ty
     C                     MOVELWADHSC    TXDHSC    P      TMS Shipment Ty
     C                     MOVELWADISC    TXDISC    P      TMS Payment Met
     C                     MOVELWADJSC    TXDJSC    P      TMS POD Receive
     C                     MOVELWADKSC    TXDKSC    P      TMS Load Status
     C                     MOVELWAUQAA    TXUQAA    P      TMS Load Owner
     C                     MOVELWAURAA    TXURAA    P      TMS Carrier SCA
     C                     MOVELWAUSAA    TXUSAA    P      TMS Carrier Mod
     C                     Z-ADDWACRDS    TXCRDS           TMS Carrier Dis
     C                     Z-ADDWAAZD8    TXAZD8           TMS Deadline De
     C                     Z-ADDWAAGTH    TXAGTH           TMS Deadline De
     C                     MOVELWAUTAA    TXUTAA    P      TMS Trailer Num
     C                     MOVELWAUUAA    TXUUAA    P      TMS Container N
     C                     MOVELWAUVAA    TXUVAA    P      TMS Move Type
     C                     MOVELWAUWAA    TXUWAA    P      TMS Vessel Name
     C                     MOVELWAUXAA    TXUXAA    P      TMS Voyage Numb
     C                     MOVELWAFJU1    TXFJU1    P      TMS Booking Num
     C                     MOVELWAFKU1    TXFKU1    P      TMS OTR Destina
     C                     MOVELWAFLU1    TXFLU1    P      TMS OTR Destina
     C                     MOVELWAFMU1    TXFMU1    P      TMS OTR Destina
     C                     MOVELWAFNU1    TXFNU1    P      TMS OTR Destina
     C                     MOVELWAFOU1    TXFOU1    P      TMS OTR Destina
     C                     MOVELWAFPU1    TXFPU1    P      TMS OTR Destina
     C                     MOVELWAFQU1    TXFQU1    P      TMS OTR Destina
     C                     Z-ADDWAA7D8    TXA7D8           TMS Vessel ETD
     C                     Z-ADDWAA8D8    TXA8D8           TMS Vessel ETA
     C                     MOVELWAP4U1    TXP4U1    P      TMS Carrier Ref
     C                     MOVELWADLSC    TXDLSC    P      TMS Record Stat
     C                     Z-ADDWN0002    TXTPRC           TMS Process Sta
     C                     MOVELWN0003    TXUYAA    P      TMS Error Reaso
     C                     Z-ADD##JDT     TXA0D8           TMS Change Date
     C                     Z-ADD##JTM     TXD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCR1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set TMS Record Stampp IF
     C                     Z-ADD##JTM     TXD9TM           TMS Change time
     C                     Z-ADD##JDT     TXA0D8           TMS Change Date
      * Set PGM.*Record Data Changed flag
     C           QPBCR1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@CRCPXL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCRCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Bld Lds fr TMS Upl RT - TMS Load  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 15        TMS Load Status
     C                     Z-ADD*ZERO     WN0002  30       TMS Process Sta
     C                     MOVEL*BLANK    WN0003  6        TMS Error Reaso
     C                     Z-ADD*ZERO     WN0004  80       TMS Change Date
     C                     Z-ADD*ZERO     WN0005  60       TMS Change time
     C                     Z-ADD*ZERO     WN0006  70       Load ID
     C                     Z-ADD*ZERO     WN0007  30       Company Number
     C                     Z-ADD*ZERO     WN0008  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0009  1        Load Status
     C                     Z-ADD*ZERO     WN0010  52       Reefer Temperat
     C                     Z-ADD*ZERO     WN0011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0012  50       Total Stops
     C                     MOVEL*BLANK    WN0013 20        Trailer Id
     C                     MOVEL*BLANK    WN0014  3        Carrier Code
     C                     Z-ADD*ZERO     WN0015 112       Rated Freight
     C                     MOVEL*BLANK    WN0016  1        Ship Status
     C                     MOVEL*BLANK    WN0017  1        Load Type
     C                     Z-ADD*ZERO     WN0018  52       Product Tempera
     C                     MOVEL*BLANK    WN0019  2        Shipping Method
     C                     MOVEL*BLANK    WN0020  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0021  2        Ship To State C
     C                     Z-ADD*ZERO     WN0022  70       Gross Weight
     C                     MOVEL*BLANK    WN0023  3        Carrier Broker
     C                     MOVEL*BLANK    WN0024  1        Export Status
     C                     MOVEL*BLANK    WN0025  1        On Time - (Y/N)
     C                     MOVEL*BLANK    WN0026  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0027  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0028  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0029  60       Deadline Depart
     C                     MOVEL*BLANK    WN0030  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0031  1        Load Wash Flag
     C                     MOVEL*BLANK    WN0032 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0033  1        Multi Company L
     C                     MOVEL*BLANK    WN0034  3        LH On-Time Reas
     C                     Z-ADD*ZERO     WN0035  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0036  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0037  60       Job Time
     C                     MOVEL*BLANK    WN0038 10        User Id
     C                     MOVEL*BLANK    WN0039 10        Job Name
     C                     Z-ADD*ZERO     WN0040  70       Job Date
     C                     MOVEL*BLANK    WN0041  1        Add/Change/Dele
     C                     MOVEL*BLANK    WN0042  1        Status Flag 1
     C                     MOVEL*BLANK    WN0043  1        TMS Extra Leg L
     C                     MOVEL*BLANK    WN0044  1        TONU Process On
     C                     MOVEL*BLANK    WN0045  2        Event Code SavU
     C                     MOVEL*BLANK    WN0046  1        Export Status D
     C                     MOVEL*BLANK    WN0047  1        Status Flag 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@CRCPX0                    *
     C                     READ @CRCPX0                  90*
      * Data record not found
     C   90                MOVEL'USR4928' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create LH/LD/Upd OH for:  Domestic&Export Pickups from a Warehous
      * Create Intl Legs for:  Everything not pickuped from a Warehouse
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           TMS Load Status
     C                     Z-ADD*ZERO     WN0002           TMS Process Sta
     C                     MOVEL*BLANK    WN0003           TMS Error Reaso
     C                     Z-ADD*ZERO     WN0004           TMS Change Date
     C                     Z-ADD*ZERO     WN0005           TMS Change time
     C                     Z-ADD*ZERO     WN0006           Load ID
     C                     Z-ADD*ZERO     WN0007           Company Number
     C                     Z-ADD*ZERO     WN0008           Scheduled Ship
     C                     MOVEL*BLANK    WN0009           Load Status
     C                     Z-ADD*ZERO     WN0010           Reefer Temperat
     C                     Z-ADD*ZERO     WN0011           Total Load Orde
     C                     Z-ADD*ZERO     WN0012           Total Stops
     C                     MOVEL*BLANK    WN0013           Trailer Id
     C                     MOVEL*BLANK    WN0014           Carrier Code
     C                     Z-ADD*ZERO     WN0015           Rated Freight
     C                     MOVEL*BLANK    WN0016           Ship Status
     C                     MOVEL*BLANK    WN0017           Load Type
     C                     Z-ADD*ZERO     WN0018           Product Tempera
     C                     MOVEL*BLANK    WN0019           Shipping Method
     C                     MOVEL*BLANK    WN0020           Ship From Wareh
     C                     MOVEL*BLANK    WN0021           Ship To State C
     C                     Z-ADD*ZERO     WN0022           Gross Weight
     C                     MOVEL*BLANK    WN0023           Carrier Broker
     C                     MOVEL*BLANK    WN0024           Export Status
     C                     MOVEL*BLANK    WN0025           On Time - (Y/N)
     C                     MOVEL*BLANK    WN0026           LH Carrier Paym
     C                     Z-ADD*ZERO     WN0027           Requested Deliv
     C                     Z-ADD*ZERO     WN0028           Deadline Depart
     C                     Z-ADD*ZERO     WN0029           Deadline Depart
     C                     MOVEL*BLANK    WN0030           Load Shag Flag
     C                     MOVEL*BLANK    WN0031           Load Wash Flag
     C                     MOVEL*BLANK    WN0032           Shipping Temp C
     C                     MOVEL*BLANK    WN0033           Multi Company L
     C                     MOVEL*BLANK    WN0034           LH On-Time Reas
     C                     Z-ADD*ZERO     WN0035           LPT Load Plan S
     C                     Z-ADD*ZERO     WN0036           LPT Load Plan S
     C                     Z-ADD*ZERO     WN0037           Job Time
     C                     MOVEL*BLANK    WN0038           User Id
     C                     MOVEL*BLANK    WN0039           Job Name
     C                     Z-ADD*ZERO     WN0040           Job Date
     C                     MOVEL*BLANK    WN0041           Add/Change/Dele
     C                     MOVEL*BLANK    WN0042           Status Flag 1
     C                     MOVEL*BLANK    WN0043           TMS Extra Leg L
     C                     MOVEL*BLANK    WN0044           TONU Process On
     C                     MOVEL*BLANK    WN0045           Event Code SavU
     C                     MOVEL*BLANK    WN0046           Export Status D
     C                     MOVEL*BLANK    WN0047           Status Flag 2
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADD0         WN0002           TMS Process Sta
     C                     Z-ADDWATMLD    WN0006           Load ID
     C                     MOVELWADKSC    WN0001           TMS Load Status
     C                     MOVEL'02'      WN0045           Event Code SavU
      * unlock is req if this is Yes
     C                     MOVEL'N'       WN0042           Status Flag 1
      * unlock not req if this is Yes
     C                     MOVEL'N'       WN0047           Status Flag 2
     C                     MOVEL*BLANK    YL0001           TMS Late Reason
     C                     MOVEL*BLANK    YL0002           LH On-Time Reas
      * R17040 DN 03/01/21-Initialize Check 856 Ready Flag.
     C                     MOVEL'N'       YL0003           Check 856 Ready
      * Do not update the carrier if status is TENDER REJ  RMC 3/24/2021
     C                     MOVELWAURAA    YL0004           TMS Carrier SCA
      * 06/23/21 DN W80459-Added Condition 'TENDER EXP'.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TMS Load Status is Tender Reject
      *   |- c2    : DB1.TMS Load Status is TENDER EXP
      *   '-
     C           WADKSC    IFEQ @CN,001                    *IF
     C           WADKSC    OREQ @CN,002                    *OR
     C                     MOVEL*BLANK    YL0004           TMS Carrier SCA
     C                     END                             *FI
      * Validate
     C                     EXSR UASUBR                     Validate
      * Process for DOMESTIC and EXPORTS Picking up from a Warehouse
      * CASE: PAR.TMS Extra Leg Load Sts is Domestic
     C           WN0043    IFEQ 'D'                        *IF
      * Process ADD
     C                     EXSR UBSUBR                     Process ADD
      * Process CHANGE  if picked/shipped/invoiced, just chg LH,LD
     C                     EXSR UFSUBR                     Process CHANGE
      * Do whenever charges come up on the extract:
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RMC 12.05.16 added to crt TNU charges even if ord already invoice
      * If load inv charges exist  then do special routine to alloc $$
      * 07/23/18 DN S13418-Removed 'TONU' conditions & in PBXIXFR.
      * Exc Crt Load Frt Chg  XF - TMS Load Invoice Charge  * 
     C                     CALL 'PBXIXFR'              90  Exc Crt Load Fr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0034  70       TMS Load ID
     C                     PARM WAAYD8    WQ0035  80       TMS Extract Dat
     C                     PARM WAAFTH    WQ0036  40       TMS Extract Tim
     C                     PARM WAFSU1    WQ0037 25        TMS Extract Fil
     C                     PARM WN0006    WQ0038  70       Load ID
     C                     PARM WN0014    WQ0039  3        Carrier Code
     C                     PARM WN0015    WQ0040 112       Rated Freight
     C                     PARM WN0041    WQ0041  1        Add/Change/Dele
     C                     PARM YL0004    WQ0042 10        TMS Carrier SCA
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WN0002           TMS Process Sta
     C                     END                             *FI
      * Change # of stops, Lock Load edit, Write pfs
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Add/Change/Delete USR is Add/Change/Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WN0041    IFEQ 'A'                        *IF
     C           WN0041    OREQ 'C'
     C           WN0041    OREQ 'D'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Only if any change was made  9.21.16
      * Chg total number of Stops, and lock load IF not shipped/invoiced
      * CASE:
      *  - c1AND(c2ORc3ORc5)ANDc4
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Add/Change/Delete USR is Add
      *   |- c3    : PAR.Status Flag 1  Y/N is Yes
      *   |- c5    : PAR.Status Flag 2  Y/N is Yes
      *   |- c4    : PAR.Load Status is Entered,Comb,Unlck,Locked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WN0041    IFEQ 'A'                        *IF
     C           WN0042    OREQ 'Y'                        *OR
     C           WN0047    OREQ 'Y'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           WN0009    IFEQ 'C'                        *IF
     C           WN0009    OREQ 'E'
     C           WN0009    OREQ 'L'
     C           WN0009    OREQ 'U'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Add/Change/Delete USR is Add
      *   |- c2    : PAR.Status Flag 1  Y/N is Yes
      *   '-
     C           WN0041    IFEQ 'A'                        *IF
     C           WN0042    OREQ 'Y'                        *OR
     C                     Z-ADD*ZERO     WN0012           Total Stops
     C                     Z-ADD*ZERO     WUBQC3           Company Number
      * RTV No. of Stops      RT - Load Detail  * 
     C                     EXSR NPRVGN
      * Calc Load U/M           -- RMC 9/30/16 e4119
     C                     EXSR UISUBR                     Calc Load U/M
      * CHG For TMS Stp/Mult  CH - Load Header  * 
     C                     EXSR NQCHRC
     C                     END                             *FI
      * CAN LOAD BE LOCKED?? IF IT IS UNLOCKED
      * ** If possible Lock Load when not on hold,pass NO for lock opt ov
      * Lock option override sts='N' wont lock loads shipping > current j
      * CASE: PAR.Load Status is Entered,Combined,Unlock
     C           WN0009    IFEQ 'C'                        *IF
     C           WN0009    OREQ 'E'
     C           WN0009    OREQ 'U'
     C                     MOVEL'N'       WUATUS           STATUS
      * EDT Lock Load Edit/INF XF - Load Header  * 
     C                     CALL 'PBXHXFR'              90  EDT Lock Load E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0045  70       Load ID
     C                     PARM WN0007    WQ0046  30       Company Number
     C                     PARM YL0136    WQ0047  1        *SFLSEL
     C                     PARM WUATUS    WQ0048  1        STATUS
     C           YL0137    PARM *BLANK    WQ0049  1        Error Status
     C                     PARM 'Y'       WQ0050  1        Lock option ove
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *  Lock Load if no errors
      * CASE: LCL.Error Status is no
     C           YL0137    IFEQ 'N'                        *IF
      * CASE: PAR.Load Status is Unlock
     C           WN0009    IFEQ 'U'                        *IF
      *
     C                     Z-ADD*ZERO     WN1097  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1098 112       Flat Amount
     C                     Z-ADD*ZERO     WN1099  50       Total Stops
     C                     Z-ADD*ZERO     WN1100  70       Total Load Mile
     C                     MOVEL*BLANK    WN1101  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1102  2        Ship To State C
     C                     MOVEL*BLANK    WN1103  3        Carrier Broker
     C                     MOVEL*BLANK    WN1104  1        Export Status
     C                     MOVEL*BLANK    WN1105  3        Shipping Line
     C                     MOVEL*BLANK    WN1106 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN1107  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1108  60       Deadline Depart
     C                     MOVEL*BLANK    WN1109  1        MG Created Load
     C                     MOVEL*BLANK    WN1110  2        Load U/M
     C                     MOVEL*BLANK    WN1111  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1112 20        Destination Cit
     C                     MOVEL*BLANK    WN1113  2        State Code
     C                     MOVEL*BLANK    WN1114  3        USR Warehouse C
     C                     MOVEL*BLANK    WN1115  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN1116  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN1117  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN1118  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN1119  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN1120  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN1121  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN1122  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN1123  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN1124 155       Company Number
     C                     Z-ADD*ZERO     WN1125 155       Date 1
     C                     Z-ADD*ZERO     WN1126 155       Order Number 1
     C                     Z-ADD*ZERO     WN1127  40       Requested Deliv
     C                     MOVEL*BLANK    WN1128  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR NRRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN1101    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR NSRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN1109    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR NXRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN1107           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR NYRVGN
     C           WN1127    MULT 100       WN1108           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN1274  51       Hours Required
     C                     Z-ADD*ZERO     WN1275  50       Miles to next s
     C                     Z-ADD*ZERO     WN1276  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN1277  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN1278  50       @Days 5
     C                     Z-ADD*ZERO     WN1279  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1280  20       USR Period
     C                     Z-ADD*ZERO     WN1281  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1282  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UJSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR OARVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0138    IFEQ 'CT'                       *IF
     C           YL0138    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0535           Load ID
     C                     Z-ADD*ZERO     WL0536           Stop/Drop
     C                     Z-ADD*ZERO     WL0537           Order Number
     C                     EXSR OBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0538    WN1275           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1275    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDWATMLD    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0053  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0054  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0535           Load ID
     C                     Z-ADD*ZERO     WL0536           Stop/Drop
     C                     Z-ADD*ZERO     WL0537           Order Number
     C                     EXSR OBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0538    WN1275           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1275    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN1107           Scheduled Deliv
     C                     Z-ADD*ZERO     WN1108           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN1274           Hours Required
     C                     Z-ADD*ZERO     YL0139           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR OCRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0055  70       Load ID
     C           YL0140    PARM YL0140    WQ0056  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0139    ADD  YL0140    WN1274           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN1274    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN1274    DIV  24        WN1278           @Days 5
     C           WN1278    MULT 24        WU               USR Hours 5.0
     C           WN1274    SUB  WU        WN1276           USR Hours 5.0
     C           WN1276    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN1278    IFGT 0                          *IF
     C                     MULT -1        WN1278           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN1107    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1278    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN1107
     C                     ELSE
     C           XDINDT    SUB  1000000   WN1107
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN1108                     *IF
     C                     SUB  WN1108    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN1278           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN1107    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1278    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN1107
     C                     ELSE
     C           XDINDT    SUB  1000000   WN1107
     C                     END
     C           240000    SUB  WUPINB    WN1108           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN1108           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR ODRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
     C                     EXSR OERVGN
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1099    IFEQ 1                          *IF
     C           WN1098    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR OGRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN1112    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN1112           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR OHRVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UKSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR OICHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN1097    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR OJRVGN
     C                     Z-ADDWN0007    WN1124           Company Number
     C                     Z-ADDWATMLD    WN1126           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN1097    WN1125           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1114    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN1128    PARM *BLANK    WQ0059  7        Return Code Usr
     C                     PARM 'OMS'     WQ0060  6        Application Cod
     C                     PARM @CN,017   WQ0061 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0062  1        USR Detail or S
     C                     PARM @CN,018   WQ0063 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0064 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0065  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0066  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0067  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0068 10        PRT Night Queue
     C           WN1124    PARM WN1124    WQ0069 155       Company Number
     C           WN1125    PARM WN1125    WQ0070 155       Date 1
     C           WN1126    PARM WN1126    WQ0071 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0072 155       System Value Nu
     C           WN1114    PARM WN1114    WQ0073  3        USR Warehouse C
     C           WN1115    PARM WN1115    WQ0074  3        USR CDE Parm 1
     C           WN1116    PARM WN1116    WQ0075  3        USR CDE Parm 2
     C           WN1117    PARM WN1117    WQ0076  3        USR CDE Parm 3
     C           WN1118    PARM WN1118    WQ0077  3        USR CDE Parm 4
     C           WN1119    PARM WN1119    WQ0078  3        USR CDE Parm 5
     C           WN1120    PARM WN1120    WQ0079  3        USR CDE Parm 6
     C           WN1121    PARM WN1121    WQ0080  3        USR CDE Parm 7
     C           WN1122    PARM WN1122    WQ0081  3        USR CDE Parm 8
     C           WN1123    PARM WN1123    WQ0082  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0083  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0084  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN1420  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0539           Load ID
     C                     EXSR OLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0540    WN1420    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0007    WL0541           PFS Company Num
     C                     MOVEL'LDORDD'  WL0542    P      PFS Interface C
     C                     EXSR OPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0543    YL0141    P      PFS AccuSort Ac
     C                     MOVELWL0544    YL0142    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0141    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1420    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0085  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0086  70       Load ID
     C                     PARM WN0007    WQ0087  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0088  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0142    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0089  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0090  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,019                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN1097    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1114    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN1114    WQ0091  3        Warehouse Code
     C                     PARM *BLANK    WQ0092 10        Default Printer
     C           YL0143    PARM *BLANK    WQ0093  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0143    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN1114    ZA0001           USR Warehouse C
     C                     MOVELWN1115    ZA0002           USR CDE Parm 1
     C                     MOVELWN1116    ZA0003           USR CDE Parm 2
     C                     MOVELWN1117    ZA0004           USR CDE Parm 3
     C                     MOVELWN1118    ZA0005           USR CDE Parm 4
     C                     MOVELWN1119    ZA0006           USR CDE Parm 5
     C                     MOVELWN1120    ZA0007           USR CDE Parm 6
     C                     MOVELWN1121    ZA0008           USR CDE Parm 7
     C                     MOVELWN1122    ZA0009           USR CDE Parm 8
     C                     MOVELWN1123    ZA0010           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR ULSUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log IF
      * CASE: PAR.Load ID is Blank
     C           WATMLD    IFEQ 0                          *IF
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD##JDT     WL0545           Created Date
     C                     Z-ADD##JTM     WL0546           Created Time
     C                     EXSR OQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0547    YL0144           Sequence Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Key           RT - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0548           Load ID
     C                     EXSR ORRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0549    YL0144           Sequence Number
     C                     END                             *FI
      * Use system date/time to minimize dup record creation
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0145    PARM *ZERO     WQ0094 155       Current System
     C           YL0146    PARM *ZERO     WQ0095 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0145    WL0550           Created Date
     C                     Z-ADDYL0146    WL0551           Created Time
     C                     Z-ADDYL0144    WL0552           Sequence Number
     C                     Z-ADDWATMLD    WL0553           Load ID
     C                     Z-ADD*ZERO     WL0554           Stop/Drop
     C                     MOVELWURVST    WL0555    P      Load Change Typ
     C                     MOVELWUUJST    WL0556    P      Department Cont
     C                     MOVELWN0009    WL0557    P      Change Log Prio
     C                     MOVEL'L'       WL0558    P      Change Log New
     C                     MOVEL##USR     WL0559    P      User Id
     C                     MOVEL##PGM     WL0560    P      Job Name
     C                     MOVEL*BLANK    WL0561           Carrier Code
     C                     MOVEL*BLANK    WL0562           Carrier Broker
     C                     Z-ADDWN0007    WL0563           Company Number
     C                     Z-ADD*ZERO     WL0564           Order Number
     C                     EXSR OSCRRC
      * Add seconds until it can be added successfully
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,015                    *IF
      * LCL.Created Time = LCL.Current System Time
     C                     Z-ADDYL0146    YL0147           Created Time
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,015                    *DOW
      * LCL.Created Time = LCL.Created Time + CON.1 *SECONDS
     C                     Z-ADDYL0147    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C                     ADD  1         XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     YL0147
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0145    WL0550           Created Date
     C                     Z-ADDYL0147    WL0551           Created Time
     C                     Z-ADDYL0144    WL0552           Sequence Number
     C                     Z-ADDWATMLD    WL0553           Load ID
     C                     Z-ADD*ZERO     WL0554           Stop/Drop
     C                     MOVELWURVST    WL0555    P      Load Change Typ
     C                     MOVELWUUJST    WL0556    P      Department Cont
     C                     MOVELWN0009    WL0557    P      Change Log Prio
     C                     MOVEL'L'       WL0558    P      Change Log New
     C                     MOVEL##USR     WL0559    P      User Id
     C                     MOVEL##PGM     WL0560    P      Job Name
     C                     MOVEL*BLANK    WL0561           Carrier Code
     C                     MOVEL*BLANK    WL0562           Carrier Broker
     C                     Z-ADDWN0007    WL0563           Company Number
     C                     Z-ADD*ZERO     WL0564           Order Number
     C                     EXSR OSCRRC
     C                     END                             *ITR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send LOCK to Carlisle if  already locked and chg made
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Status Flag 2  Y/N is Yes
      *   |- c2    : PAR.Status Flag 1  Y/N is Yes
      *   '-
     C           WN0047    IFEQ 'Y'                        *IF
     C           WN0042    OREQ 'Y'                        *OR
      * if a chg was made                         9/21/16
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0096  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         WN0002           TMS Process Sta
     C                     END                             *FI
      * R17040 DN 03/02/21-Verify/Create EDI 856 Advice Shipping Notice (
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load Status is Shipped or Invoiced
      *   |- c2    : LCL.Check 856 Ready Y/N USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFEQ 'I'                        *IF
     C           WN0009    OREQ 'S'
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Exc Crt EDI 856 f/TMS XF - Order Header Extension  * 
     C                     CALL 'PUSVXFR'              90  Exc Crt EDI 856
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0006    WQ0097  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUSVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Process for Extra Legs
      * CASE: PAR.TMS Extra Leg Load Sts is Extra leg
     C           WN0043    IFEQ 'E'                        *IF
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * 07/23/18 DN S13418-Removed 'TONU' Processing, call to PBXIXFR.
      * Exc Maint Intl Legs   XF - TMS International Legs  * 
     C                     CALL 'PBXEXFR'              90  Exc Maint Intl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0098  70       TMS Load ID
     C                     PARM WAAYD8    WQ0099  80       TMS Extract Dat
     C                     PARM WAAFTH    WQ0100  40       TMS Extract Tim
     C                     PARM WAFSU1    WQ0101 25        TMS Extract Fil
     C                     PARM WAUPAA    WQ0102 10        TMS Customer Lo
     C                     PARM WALTMP    WQ0103  31       TMS Temperature
     C                     PARM WADFSC    WQ0104  1        TMS Temperature
     C                     PARM WADGSC    WQ0105 10        TMS Movement Ty
     C                     PARM WADHSC    WQ0106 10        TMS Shipment Ty
     C                     PARM WADISC    WQ0107 10        TMS Payment Met
     C                     PARM WADJSC    WQ0108  1        TMS POD Receive
     C                     PARM WN0001    WQ0109 15        TMS Load Status
     C                     PARM WAUQAA    WQ0110  4        TMS Load Owner
     C                     PARM YL0004    WQ0111 10        TMS Carrier SCA
     C                     PARM WAUSAA    WQ0112 10        TMS Carrier Mod
     C                     PARM WACRDS    WQ0113  71       TMS Carrier Dis
     C                     PARM WAAZD8    WQ0114  80       TMS Deadline De
     C                     PARM WAAGTH    WQ0115  40       TMS Deadline De
     C                     PARM WAUTAA    WQ0116 15        TMS Trailer Num
     C                     PARM WAUUAA    WQ0117 20        TMS Container N
     C                     PARM WAUVAA    WQ0118 15        TMS Move Type
     C                     PARM WAUWAA    WQ0119 30        TMS Vessel Name
     C                     PARM WAUXAA    WQ0120 20        TMS Voyage Numb
     C                     PARM WAFJU1    WQ0121 30        TMS Booking Num
     C                     PARM WAFKU1    WQ0122 50        TMS OTR Destina
     C                     PARM WAFLU1    WQ0123 50        TMS OTR Destina
     C                     PARM WAFMU1    WQ0124 50        TMS OTR Destina
     C                     PARM WAFNU1    WQ0125 50        TMS OTR Destina
     C                     PARM WAFOU1    WQ0126 50        TMS OTR Destina
     C                     PARM WAFPU1    WQ0127 20        TMS OTR Destina
     C                     PARM WAFQU1    WQ0128 10        TMS OTR Destina
     C                     PARM WAA7D8    WQ0129  80       TMS Vessel ETD
     C                     PARM WAA8D8    WQ0130  80       TMS Vessel ETA
     C                     PARM WADLSC    WQ0131  1        TMS Record Stat
     C                     PARM WATPRC    WQ0132  30       TMS Process Sta
     C                     PARM WAUYAA    WQ0133  6        TMS Error Reaso
     C                     PARM WAA0D8    WQ0134  80       TMS Change Date
     C                     PARM WAD9TM    WQ0135  60       TMS Change time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WN0002           TMS Process Sta
     C                     END                             *FI
     C                     END                             *FI
      * Process DELETE
     C                     EXSR UMSUBR                     Process DELETE
      * Upd rcd as processed or error or no change
      * Chg TMS Load          CH - TMS Load  * 
     C                     EXSR PCCHRC
     C                     READ @CRCPX0                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Pickup/Drop Exist RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y2U0016' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSB01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSB02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSB03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSB04           TMS Extract Fil
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           TMS Load ID
     C                     KFLD           WQSB02           TMS Extract Dat
     C                     KFLD           WQSB03           TMS Extract Tim
     C                     KFLD           WQSB04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWATMLD    WQSB01           TMS Load ID
     C                     Z-ADDWAAYD8    WQSB02           TMS Extract Dat
     C                     Z-ADDWAAFTH    WQSB03           TMS Extract Tim
     C                     MOVELWAFSU1    WQSB04           TMS Extract Fil
      * Establish starting position
     C           KRSSB     SETLL@CSCPXP                    *
     C           KRSSB     READE@CSCPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4932' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type EQ PAR.TMS Event Type
     C           WBDMSC    IFEQ 'PICKUP'                   *IF
      * CASE: DB1.TMS Address Type EQ PAR.TMS Address Type
     C           WBDNSC    IFEQ @CN,004                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * VAL Load Exists - TMS  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0007           Company Number
     C                     MOVEL*BLANK    WN0009           Load Status
     C                     MOVEL*BLANK    WN0013           Trailer Id
     C                     MOVEL*BLANK    WN0014           Carrier Code
     C                     Z-ADD*ZERO     WN0015           Rated Freight
     C                     MOVEL*BLANK    WN0025           On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0028           Deadline Depart
     C                     Z-ADD*ZERO     WN0029           Deadline Depart
     C                     MOVEL*BLANK    WN0030           Load Shag Flag
     C                     MOVEL*BLANK    WN0031           Load Wash Flag
     C                     MOVEL*BLANK    WN0033           Multi Company L
     C                     MOVEL*BLANK    WN0034           LH On-Time Reas
     C                     Z-ADD*ZERO     WN0035           LPT Load Plan S
     C                     Z-ADD*ZERO     WN0036           LPT Load Plan S
     C                     MOVEL*BLANK    YL0005           Record Found US
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWN0006    WCRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    WN0007           Company Number
     C                     MOVELWCPKST    WN0009           Load Status
     C                     MOVELWCDXTX    WN0013           Trailer Id
     C                     MOVELWCBZNA    WN0014           Carrier Code
     C                     Z-ADDWCR1NB    WN0015           Rated Freight
     C                     MOVELWCONTM    WN0025           On Time - (Y/N)
     C                     Z-ADDWCKZDT    WN0028           Deadline Depart
     C                     Z-ADDWCAXTM    WN0029           Deadline Depart
     C                     MOVELWCLSHG    WN0030           Load Shag Flag
     C                     MOVELWCYPST    WN0031           Load Wash Flag
     C                     MOVELWCRVSX    WN0033           Multi Company L
     C                     MOVELWCR3SX    WN0034           LH On-Time Reas
     C                     Z-ADDWCP0DT    WN0035           LPT Load Plan S
     C                     Z-ADDWCCMTM    WN0036           LPT Load Plan S
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Chk Ord Picked    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0006           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD02           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
      * Setup key
     C                     Z-ADDWN0006    WQSD02           Load ID
      * Establish starting position
     C           KRSSD     SETLL@BFCPD9                    *
     C           KRSSD     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Event Code is Picked Thru History
     C           WDJPCD    IFGE '03'                       *IF
     C           WDJPCD    ANDLE'07'
     C                     MOVEL'Y'       YL0006           Status - Y or N
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Chk for Order Val RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0046           Export Status D
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSE01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSE02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSE03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSE04           TMS Extract Fil
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           TMS Load ID
     C                     KFLD           WQSE02           TMS Extract Dat
     C                     KFLD           WQSE03           TMS Extract Tim
     C                     KFLD           WQSE04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           TMS Load ID
     C                     KFLD           WQSE02           TMS Extract Dat
     C                     KFLD           WQSE03           TMS Extract Tim
     C                     KFLD           WQSE04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWATMLD    WQSE01           TMS Load ID
     C                     Z-ADDWAAYD8    WQSE02           TMS Extract Dat
     C                     Z-ADDWAAFTH    WQSE03           TMS Extract Tim
     C                     MOVELWAFSU1    WQSE04           TMS Extract Fil
     C                     Z-ADD*ZERO     WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSE     SETLL@CSCPXP                    *
     C           KRSSE     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R17040 DN 03/01/21-Set 856 Ready Flag to Yes.
      * CASE: DB1.TMS Cust Assigned Appt # is Entered
     C           WBP5U1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0003           Check 856 Ready
     C                     END                             *FI
      * CASE: DB1.TMS Event Type is Drop
     C           WBDMSC    IFEQ 'DROP'                     *IF
      * Val Order Nos         RT - TMS Load Event Shipment  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C           KRSSE     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Order Nos         RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQSF01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQSF02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQSF03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQSF04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQSF05           TMS Event Seque
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           TMS Load ID
     C                     KFLD           WQSF02           TMS Extract Dat
     C                     KFLD           WQSF03           TMS Extract Tim
     C                     KFLD           WQSF04           TMS Extract Fil
     C                     KFLD           WQSF05           TMS Event Seque
      * Setup key
     C                     Z-ADDWBTMLD    WQSF01           TMS Load ID
     C                     Z-ADDWBAYD8    WQSF02           TMS Extract Dat
     C                     Z-ADDWBAFTH    WQSF03           TMS Extract Tim
     C                     MOVELWBFSU1    WQSF04           TMS Extract Fil
     C                     Z-ADDWBEVSQ    WQSF05           TMS Event Seque
      * Establish starting position
     C           KRSSF     SETLL@CUCPXS                    *
     C           KRSSF     READE@CUCPXS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4936' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Order for TMS Shp RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * Order not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDNF'   WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     END                             *FI
      * Header sts
      * CASE: LCL.Header Status is Cancelled
     C           YL0007    IFEQ 'X'                        *IF
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDSTS'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     END                             *FI
      * order is blocked
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0012    IFEQ 'B'                        *IF
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDBLK'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     END                             *FI
      * Order on another load
      * CASE:
      *  - (c1ANDc2)
      *   |- c1    : LCL.Load ID is Entered
      *   |- c2    : LCL.Load ID NE PAR.TMS Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFNE 0                          *IF
     C           YL0009    IFNE WBTMLD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * check header status and event code
      * CASE: LCL.Header Status is Conf/Comp/Canc
     C           YL0007    IFEQ 'X'                        *IF
     C           YL0007    OREQ 'C'
     C           YL0007    OREQ 'R'
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDSTS'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      * 07/23/18 DN S13418-Removed 'TONU' Processing.
      * CASE: LCL.Event Code is Picked Thru History
     C           YL0011    IFGE '03'                       *IF
     C           YL0011    ANDLE'07'
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDEVT'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Order on another load, or no load for a Delete
      * CASE:
      *  - (c3ANDc4)
      *   |- c3    : LCL.Load ID NE PAR.TMS Load ID
      *   |- c4    : PAR.Add/Change/Delete USR is Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFNE WBTMLD                     *IF
     C           WN0041    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDLOD'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'ERROR'   W0RTN            *Return code
     C                     END                             *FI
      * Order Event >= 03    not error but save event
      * CASE: LCL.Event Code is Picked Thru History
     C           YL0011    IFGE '03'                       *IF
     C           YL0011    ANDLE'07'
      * error out if picked 8/16/16
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD2         WL0009           TMS Process Sta
     C                     MOVEL'ORDEVT'  WL0010    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C                     MOVELYL0011    WN0045           Event Code SavU
     C                     END                             *FI
      * Save export sts if any order is Export
      * CASE: LCL.Export Status is yes
     C           YL0010    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WN0046           Export Status D
     C                     END                             *FI
     C           KRSSF     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Val Order for TMS Shp RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQSG01           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQSG01           Order Number
      * Establish starting position
     C           KRSSG     SETLL@BFCPY2                    *
     C           KRSSG     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Header Status
     C                     Z-ADD*ZERO     YL0008           Scheduled Ship
     C                     Z-ADD*ZERO     YL0009           Load ID
     C                     MOVEL*BLANK    YL0010           Export Status
     C                     MOVEL*BLANK    YL0011           Event Code
     C                     MOVEL*BLANK    YL0012           Block Order Fla
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFGWST    YL0007           Header Status
     C                     Z-ADDWFAODT    YL0008           Scheduled Ship
     C                     Z-ADDWFRMNB    YL0009           Load ID
     C                     MOVELWFU2ST    YL0010           Export Status
     C                     MOVELWFJPCD    YL0011           Event Code
     C                     MOVELWFBCST    YL0012           Block Order Fla
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           KRSSG     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CUCPXR
     C                     Z-ADDWL0001    WGTMLD           TMS Load ID
     C                     Z-ADDWL0002    WGAYD8           TMS Extract Dat
     C                     Z-ADDWL0003    WGAFTH           TMS Extract Tim
     C                     MOVELWL0004    WGFSU1    P      TMS Extract Fil
     C                     Z-ADDWL0005    WGEVSQ           TMS Event Seque
     C                     Z-ADDWL0006    WGTMOR           TMS Order ID
      *
     C           KLCHSH    KLIST
     C                     KFLD           WGTMLD           TMS Load ID
     C                     KFLD           WGAYD8           TMS Extract Dat
     C                     KFLD           WGAFTH           TMS Extract Tim
     C                     KFLD           WGFSU1           TMS Extract Fil
     C                     KFLD           WGEVSQ           TMS Event Seque
     C                     KFLD           WGTMOR           TMS Order ID
     C           KLCHSH    CHAIN@CUCPXR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCUCPL0'MDACP
     C                     MOVEL'@CUCPXR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCU1    YARDCS
      * Move non-key fields to @CUCPXR
     C                     Z-ADDWL0007    WGHFNB           TMS Miles from
     C                     MOVELWL0008    WGDLSC    P      TMS Record Stat
     C                     Z-ADDWL0009    WGTPRC           TMS Process Sta
     C                     MOVELWL0010    WGUYAA    P      TMS Error Reaso
     C                     Z-ADDWL0011    WGA0D8           TMS Change Date
     C                     Z-ADDWL0012    WGD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCU1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set TMS Record Stampp IF
     C                     Z-ADD##JTM     WGD9TM           TMS Change time
     C                     Z-ADD##JDT     WGA0D8           TMS Change Date
      * Set PGM.*Record Data Changed flag
     C           QPBCU1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CUCPXR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCUCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV TMS-Val Ordr cancl RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0013           Status Flag 10
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADDWN0006    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@FLCPEB                    *
     C           KRSSI     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Chk for OrdSts-RmvRT - TMS Load Event Shipment  * 
     C                     EXSR SJRVGN
      * CASE: LCL.Status Flag 10 Y/N is Yes
     C           YL0013    IFEQ 'Y'                        *IF
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Header Status is Confirmed & Complete
     C           YL0014    IFEQ 'C'                        *IF
     C           YL0014    OREQ 'R'
     C                     MOVEL'ORDEVT'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Chk for OrdSts-RmvRT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WITMLD    WQSJ01           TMS Load ID
     C           *LIKE     DEFN WIAYD8    WQSJ02           TMS Extract Dat
     C           *LIKE     DEFN WIAFTH    WQSJ03           TMS Extract Tim
     C           *LIKE     DEFN WIFSU1    WQSJ04           TMS Extract Fil
     C           *LIKE     DEFN WITMOR    WQSJ05           TMS Order ID
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           TMS Load ID
     C                     KFLD           WQSJ02           TMS Extract Dat
     C                     KFLD           WQSJ03           TMS Extract Tim
     C                     KFLD           WQSJ04           TMS Extract Fil
     C                     KFLD           WQSJ05           TMS Order ID
      * Setup key
     C                     Z-ADDWATMLD    WQSJ01           TMS Load ID
     C                     Z-ADDWAAYD8    WQSJ02           TMS Extract Dat
     C                     Z-ADDWAAFTH    WQSJ03           TMS Extract Tim
     C                     MOVELWAFSU1    WQSJ04           TMS Extract Fil
     C                     Z-ADDWHC4NB    WQSJ05           TMS Order ID
      * Establish starting position
     C           KRSSJ     SETLL@CUCPCT                    *
     C           KRSSJ     READE@CUCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4936' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y'       YL0013           Status Flag 10
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WJAIC3           Company Number
     C                     Z-ADDWHC4NB    WJC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJGWST    YL0014           Header Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv 1st Order Co      RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQSL01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQSL02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQSL03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQSL04           TMS Extract Fil
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           TMS Load ID
     C                     KFLD           WQSL02           TMS Extract Dat
     C                     KFLD           WQSL03           TMS Extract Tim
     C                     KFLD           WQSL04           TMS Extract Fil
     C                     KFLD           WEEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           TMS Load ID
     C                     KFLD           WQSL02           TMS Extract Dat
     C                     KFLD           WQSL03           TMS Extract Tim
     C                     KFLD           WQSL04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0013    WQSL01           TMS Load ID
     C                     Z-ADDWL0014    WQSL02           TMS Extract Dat
     C                     Z-ADDWL0015    WQSL03           TMS Extract Tim
     C                     MOVELWL0016    WQSL04           TMS Extract Fil
     C                     Z-ADDWL0017    WEEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSL     SETLL@CUCPXS                    *
     C           KRSSL     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for TMS for LH    RT - Order Header TRG  * 
     C                     EXSR SMRVGN
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV for TMS for LH    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQSM01           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQSM01           Order Number
      * Establish starting position
     C           KRSSM     SETLL@BFCPY2                    *
     C           KRSSM     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAIC3    WL0018           Company Number
     C                     Z-ADDWFAODT    WL0020           Scheduled Ship
     C                     Z-ADDWFEIDT    WL0019           Requested Deliv
     C           KRSSM     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv 1st Pickup for LH RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0026           TMS Planned Dat
     C                     MOVEL*BLANK    WL0027           TMS Location Co
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSN01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSN02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSN03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSN04           TMS Extract Fil
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           TMS Load ID
     C                     KFLD           WQSN02           TMS Extract Dat
     C                     KFLD           WQSN03           TMS Extract Tim
     C                     KFLD           WQSN04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           TMS Load ID
     C                     KFLD           WQSN02           TMS Extract Dat
     C                     KFLD           WQSN03           TMS Extract Tim
     C                     KFLD           WQSN04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0021    WQSN01           TMS Load ID
     C                     Z-ADDWL0022    WQSN02           TMS Extract Dat
     C                     Z-ADDWL0023    WQSN03           TMS Extract Tim
     C                     MOVELWL0024    WQSN04           TMS Extract Fil
     C                     Z-ADDWL0025    WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSN     SETLL@CSCPXP                    *
     C           KRSSN     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Pickup
     C           WBDMSC    IFEQ @CN,014                    *IF
      * PAR = DB1 By name
     C                     Z-ADDWBA3D8    WL0026           TMS Planned Dat
     C                     MOVELWBUZAA    WL0027           TMS Location Co
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Tot Wt for LH     RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0033           Gross Weight
     C                     Z-ADD*ZERO     WL0034           Total Load Orde
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSO01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSO02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSO03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSO04           TMS Extract Fil
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           TMS Load ID
     C                     KFLD           WQSO02           TMS Extract Dat
     C                     KFLD           WQSO03           TMS Extract Tim
     C                     KFLD           WQSO04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           TMS Load ID
     C                     KFLD           WQSO02           TMS Extract Dat
     C                     KFLD           WQSO03           TMS Extract Tim
     C                     KFLD           WQSO04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0028    WQSO01           TMS Load ID
     C                     Z-ADDWL0029    WQSO02           TMS Extract Dat
     C                     Z-ADDWL0030    WQSO03           TMS Extract Tim
     C                     MOVELWL0031    WQSO04           TMS Extract Fil
     C                     Z-ADDWL0032    WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSO     SETLL@CSCPXP                    *
     C           KRSSO     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Pickup
     C           WBDMSC    IFEQ @CN,014                    *IF
     C                     ADD  WBG1NB    WL0033           Gross Weight
      * Rtv for TMS Load      RT - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBTMLD    WL0035           TMS Load ID
     C                     Z-ADDWBAYD8    WL0036           TMS Extract Dat
     C                     Z-ADDWBAFTH    WL0037           TMS Extract Tim
     C                     MOVELWBFSU1    WL0038    P      TMS Extract Fil
     C                     Z-ADDWBEVSQ    WL0039           TMS Event Seque
     C                     Z-ADDYL0017    WL0040           Order Weight To
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0040    YL0017           Order Weight To
     C                     ADD  YL0017    WL0034           Total Load Orde
     C                     END                             *FI
     C           KRSSO     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv for TMS Load      RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0040           Order Weight To
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQSP01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQSP02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQSP03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQSP04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQSP05           TMS Event Seque
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           TMS Load ID
     C                     KFLD           WQSP02           TMS Extract Dat
     C                     KFLD           WQSP03           TMS Extract Tim
     C                     KFLD           WQSP04           TMS Extract Fil
     C                     KFLD           WQSP05           TMS Event Seque
      * Setup key
     C                     Z-ADDWL0035    WQSP01           TMS Load ID
     C                     Z-ADDWL0036    WQSP02           TMS Extract Dat
     C                     Z-ADDWL0037    WQSP03           TMS Extract Tim
     C                     MOVELWL0038    WQSP04           TMS Extract Fil
     C                     Z-ADDWL0039    WQSP05           TMS Event Seque
      * Establish starting position
     C           KRSSP     SETLL@CUCPXS                    *
     C           KRSSP     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Order Weight TMS  RT - Order Header TRG  * 
     C                     EXSR SQRVGN
     C                     ADD  YL0018    WL0040           Order Weight To
     C           KRSSP     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Order Weight TMS  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQSQ01           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQSQ01           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BFCPY2                    *
     C           KRSSQ     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0018           Order Weight To
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFA1WG    YL0018           Order Weight To
     C           KRSSQ     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Drop Shp St f LH  RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0046           TMS State Provi
     C                     MOVEL*BLANK    WL0047           TMS Late Reason
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSR01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSR02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSR03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSR04           TMS Extract Fil
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           TMS Load ID
     C                     KFLD           WQSR02           TMS Extract Dat
     C                     KFLD           WQSR03           TMS Extract Tim
     C                     KFLD           WQSR04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           TMS Load ID
     C                     KFLD           WQSR02           TMS Extract Dat
     C                     KFLD           WQSR03           TMS Extract Tim
     C                     KFLD           WQSR04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0041    WQSR01           TMS Load ID
     C                     Z-ADDWL0042    WQSR02           TMS Extract Dat
     C                     Z-ADDWL0043    WQSR03           TMS Extract Tim
     C                     MOVELWL0044    WQSR04           TMS Extract Fil
     C                     Z-ADDWL0045    WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSR     SETLL@CSCPXP                    *
     C           KRSSR     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Drop
     C           WBDMSC    IFEQ 'DROP'                     *IF
      * PAR = DB1 By name
     C                     MOVELWBU1AA    WL0046           TMS State Provi
     C                     MOVELWBVBAA    WL0047           TMS Late Reason
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Drop Count f/stps RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0053           Total Stops
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSS01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQSS02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQSS03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQSS04           TMS Extract Fil
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           TMS Load ID
     C                     KFLD           WQSS02           TMS Extract Dat
     C                     KFLD           WQSS03           TMS Extract Tim
     C                     KFLD           WQSS04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           TMS Load ID
     C                     KFLD           WQSS02           TMS Extract Dat
     C                     KFLD           WQSS03           TMS Extract Tim
     C                     KFLD           WQSS04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0048    WQSS01           TMS Load ID
     C                     Z-ADDWL0049    WQSS02           TMS Extract Dat
     C                     Z-ADDWL0050    WQSS03           TMS Extract Tim
     C                     MOVELWL0051    WQSS04           TMS Extract Fil
     C                     Z-ADDWL0052    WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSSS     SETLL@CSCPXP                    *
     C           KRSSS     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * accum number of drops -- which equates to a stop
      * CASE: DB1.TMS Event Type is Drop
     C           WBDMSC    IFEQ 'DROP'                     *IF
     C                     ADD  1         WL0053           Total Stops
     C                     END                             *FI
     C           KRSSS     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Dft Load Seq,Loc   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           Warehouse Locat
     C                     MOVEL*BLANK    YL0021           Default Load Se
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0020    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSST     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKT0ST    YL0020           Warehouse Locat
     C                     MOVELWKT4ST    YL0021           Default Load Se
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Carr from TPM SCAC RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0056           Carrier Code Us
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WLADTX           Name
      * Setup key
     C                     MOVELWL0054    WLADTX           Name
      * Establish starting position
     C           KPSSU     SETLL@OMCARR                    *
     C                     READ @OMCARR                  90*
      * Data record not found
     C   90                MOVEL'USR1180' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00030
     C           ZQ        ORGT 00030
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWLADTX:ZQ YL0023    P  90  SCAC
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * CASE: PAR.SCAC EQ LCL.SCAC
     C           WL0055    IFEQ YL0023                     *IF
      * CASE: DB1.Record Status is Active
     C           WLVSST    IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * reactivate it
      * CHG OM Carrier         CH - Carrier  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
     C                     MOVELWLBZNA    WL0056           Carrier Code Us
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @OMCARR                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG OM Carrier         CH - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FFREBG
     C                     MOVELWLBZNA    WMBZNA    P      Carrier Code
      *
     C           KLCHSV    KLIST
     C                     KFLD           WMBZNA           Carrier Code
     C           KLCHSV    CHAIN@FFREBG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFFREL1'MDACP
     C                     MOVEL'@FFREBG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFF1    YBRDCS
      * Move non-key fields to @FFREBG
     C                     MOVELWLADTX    WMADTX    P      Name
     C                     MOVELWLACNA    WMACNA    P      Address Line 1
     C                     MOVELWLADNA    WMADNA    P      Address Line 2
     C                     MOVELWLAENA    WMAENA    P      Address Line 3
     C                     MOVELWLAJNA    WMAJNA    P      City
     C                     MOVELWLBTTX    WMBTTX    P      Zip/Postal Code
     C                     Z-ADDWLEZNB    WMEZNB           Telephone Numbe
     C                     MOVELWLBGCD    WMBGCD    P      State Code
     C                     Z-ADDWLEEDT    WMEEDT           Carrier Last Us
     C                     MOVELWLDUTX    WMDUTX    P      Fax Number
     C                     Z-ADDWLNRVA    WMNRVA           Pallet Balance
     C                     Z-ADDWLNSVA    WMNSVA           Long hook balan
     C                     Z-ADDWLNTVA    WMNTVA           Short hook bala
     C                     Z-ADDWLNUVA    WMNUVA           Tub Balance
     C                     MOVELWLP1ST    WMP1ST    P      OM Carrier Stat
     C                     MOVELWLDVTX    WMDVTX    P      OM Carrier Comm
     C                     MOVELWLDWTX    WMDWTX    P      OM Carrier Comm
     C                     MOVELWLLVCD    WMLVCD    P      AP Vendor Numbe
     C                     Z-ADDWLS8NB    WMS8NB           Home Phone
     C                     Z-ADDWLS9NB    WMS9NB           Other Phone
     C                     Z-ADDWLNMVA    WMNMVA           Flat Rate
     C                     Z-ADDWLNOVA    WMNOVA           Rate Per Pound
     C                     Z-ADDWLNPVA    WMNPVA           Unused Rate Per
     C                     Z-ADDWLNQVA    WMNQVA           Miscellaneous C
     C                     MOVELWLMFCD    WMMFCD    P      Unused Carrier
     C                     Z-ADDWLQXNB    WMQXNB           Unused Mile Ran
     C                     Z-ADDWLQ1NB    WMQ1NB           Unused Mile Ran
     C                     Z-ADDWLMRNG    WMMRNG           Unused Mile Ran
     C                     Z-ADDWLMRNE    WMMRNE           Unused Mile Ran
     C                     Z-ADDWLRFNB    WMRFNB           Unused Mile Ran
     C                     Z-ADDWLMREG    WMMREG           Unused Mile Ran
     C                     Z-ADDWLBQPR    WMBQPR           Unused Mile Rat
     C                     Z-ADDWLBRPR    WMBRPR           Unused Mile Rat
     C                     Z-ADDWLBSPR    WMBSPR           Unused Mile Rat
     C                     Z-ADDWLBTPR    WMBTPR           Unused Mile Rat
     C                     Z-ADDWLBUPR    WMBUPR           Unused Mile Rat
     C                     Z-ADDWLBVPR    WMBVPR           Unused Mile Rat
     C                     Z-ADDWLDJWG    WMDJWG           Unused Weight R
     C                     Z-ADDWLDKWG    WMDKWG           Unused Weight R
     C                     Z-ADDWLDLWG    WMDLWG           Unused Weight R
     C                     Z-ADDWLDMWG    WMDMWG           Unused Weight R
     C                     Z-ADDWLDNWG    WMDNWG           Unused Weight R
     C                     Z-ADDWLDOWG    WMDOWG           Unused Weight R
     C                     Z-ADDWLB2PR    WMB2PR           Unused Weight R
     C                     Z-ADDWLB3PR    WMB3PR           Unused Weight R
     C                     Z-ADDWLB4PR    WMB4PR           Unused Weight R
     C                     Z-ADDWLB5PR    WMB5PR           Unused Weight R
     C                     Z-ADDWLB6PR    WMB6PR           Unused Weight R
     C                     Z-ADDWLB7PR    WMB7PR           Unused Weight R
     C                     Z-ADDWLAAC7    WMAAC7           Contact Number
     C                     MOVELWLCOFI    WMCOFI    P      Certificate of
     C                     MOVELWLK6TX    WMK6TX    P      Carrier Unused
     C                     MOVELWLOCNA    WMOCNA    P      Carrier Unused
     C                     MOVELWLODNA    WMODNA    P      Carrier DOT Num
     C                     MOVELWLW7CD    WMW7CD    P      Carrier Unused
     C                     MOVELWLK7TX    WMK7TX    P      Carrier Unused
     C                     Z-ADDWLTENO    WMTENO           Carrier Unused
     C                     MOVELWLK8TX    WMK8TX    P      Carrier Fed ID
     C                     Z-ADDWLAOFC    WMAOFC           Amount of Cargo
     C                     Z-ADDWLAOLI    WMAOLI           Amount of Liabi
     C                     Z-ADDWLKHDT    WMKHDT           Date of Expirat
     C                     MOVELWLUNUS    WMUNUS    P      SSI Download Fl
     C                     MOVELWLUNU2    WMUNU2    P      unused status 2
     C                     MOVELWLUNU3    WMUNU3    P      unused status 3
     C                     MOVELWLUVST    WMUVST    P      EDI Status 1
     C                     MOVELWLUWST    WMUWST    P      EDI Status 2
     C                     MOVELWLUXST    WMUXST    P      EDI Status 3
     C                     MOVEL'A'       WMVSST    P      Record Status
     C                     Z-ADDWLAATM    WMAATM           Job Time
     C                     MOVELWLAYNA    WMAYNA    P      User Id
     C                     MOVELWLA0NA    WMA0NA    P      Job Name
     C                     Z-ADDWLAXDT    WMAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FFREBG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFFREL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val Carrier NF        RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WOBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0057    WOBZNA           Carrier Code
      * Establish starting position
     C           KRSSW     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * CRT OM Carrier         CR - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FFREBG
     C                     MOVELWL0058    WMBZNA           Carrier Code
     C                     MOVELWL0059    WMADTX           Name
     C                     MOVELWL0060    WMACNA           Address Line 1
     C                     MOVELWL0061    WMADNA           Address Line 2
     C                     MOVELWL0062    WMAENA           Address Line 3
     C                     MOVELWL0063    WMAJNA           City
     C                     MOVELWL0064    WMBTTX           Zip/Postal Code
     C                     Z-ADDWL0065    WMEZNB           Telephone Numbe
     C                     MOVELWL0066    WMBGCD           State Code
     C                     Z-ADDWL0067    WMEEDT           Carrier Last Us
     C                     MOVELWL0068    WMDUTX           Fax Number
     C                     Z-ADDWL0069    WMNRVA           Pallet Balance
     C                     Z-ADDWL0070    WMNSVA           Long hook balan
     C                     Z-ADDWL0071    WMNTVA           Short hook bala
     C                     Z-ADDWL0072    WMNUVA           Tub Balance
     C                     MOVELWL0073    WMP1ST           OM Carrier Stat
     C                     MOVELWL0074    WMDVTX           OM Carrier Comm
     C                     MOVELWL0075    WMDWTX           OM Carrier Comm
     C                     MOVELWL0076    WMLVCD           AP Vendor Numbe
     C                     Z-ADDWL0077    WMS8NB           Home Phone
     C                     Z-ADDWL0078    WMS9NB           Other Phone
     C                     Z-ADDWL0079    WMNMVA           Flat Rate
     C                     Z-ADDWL0080    WMNOVA           Rate Per Pound
     C                     Z-ADDWL0081    WMNPVA           Unused Rate Per
     C                     Z-ADDWL0082    WMNQVA           Miscellaneous C
     C                     MOVELWL0083    WMMFCD           Unused Carrier
     C                     Z-ADDWL0084    WMQXNB           Unused Mile Ran
     C                     Z-ADDWL0085    WMQ1NB           Unused Mile Ran
     C                     Z-ADDWL0086    WMMRNG           Unused Mile Ran
     C                     Z-ADDWL0087    WMMRNE           Unused Mile Ran
     C                     Z-ADDWL0088    WMRFNB           Unused Mile Ran
     C                     Z-ADDWL0089    WMMREG           Unused Mile Ran
     C                     Z-ADDWL0090    WMBQPR           Unused Mile Rat
     C                     Z-ADDWL0091    WMBRPR           Unused Mile Rat
     C                     Z-ADDWL0092    WMBSPR           Unused Mile Rat
     C                     Z-ADDWL0093    WMBTPR           Unused Mile Rat
     C                     Z-ADDWL0094    WMBUPR           Unused Mile Rat
     C                     Z-ADDWL0095    WMBVPR           Unused Mile Rat
     C                     Z-ADDWL0096    WMDJWG           Unused Weight R
     C                     Z-ADDWL0097    WMDKWG           Unused Weight R
     C                     Z-ADDWL0098    WMDLWG           Unused Weight R
     C                     Z-ADDWL0099    WMDMWG           Unused Weight R
     C                     Z-ADDWL0100    WMDNWG           Unused Weight R
     C                     Z-ADDWL0101    WMDOWG           Unused Weight R
     C                     Z-ADDWL0102    WMB2PR           Unused Weight R
     C                     Z-ADDWL0103    WMB3PR           Unused Weight R
     C                     Z-ADDWL0104    WMB4PR           Unused Weight R
     C                     Z-ADDWL0105    WMB5PR           Unused Weight R
     C                     Z-ADDWL0106    WMB6PR           Unused Weight R
     C                     Z-ADDWL0107    WMB7PR           Unused Weight R
     C                     Z-ADDWL0108    WMAAC7           Contact Number
     C                     MOVELWL0109    WMCOFI           Certificate of
     C                     MOVELWL0110    WMK6TX           Carrier Unused
     C                     MOVELWL0111    WMOCNA           Carrier Unused
     C                     MOVELWL0112    WMODNA           Carrier DOT Num
     C                     MOVELWL0113    WMW7CD           Carrier Unused
     C                     MOVELWL0114    WMK7TX           Carrier Unused
     C                     Z-ADDWL0115    WMTENO           Carrier Unused
     C                     MOVELWL0116    WMK8TX           Carrier Fed ID
     C                     Z-ADDWL0117    WMAOFC           Amount of Cargo
     C                     Z-ADDWL0118    WMAOLI           Amount of Liabi
     C                     Z-ADDWL0119    WMKHDT           Date of Expirat
     C                     MOVELWL0120    WMUNUS           SSI Download Fl
     C                     MOVELWL0121    WMUNU2           unused status 2
     C                     MOVELWL0122    WMUNU3           unused status 3
     C                     MOVELWL0123    WMUVST           EDI Status 1
     C                     MOVELWL0124    WMUWST           EDI Status 2
     C                     MOVELWL0125    WMUXST           EDI Status 3
     C                     MOVELWL0126    WMVSST           Record Status
     C                     Z-ADDWL0127    WMAATM           Job Time
     C                     MOVELWL0128    WMAYNA           User Id
     C                     MOVELWL0129    WMA0NA           Job Name
     C                     Z-ADDWL0130    WMAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WMBZNA           Carrier Code
      * Check for duplicate primary key
     C           KLCRSX    SETLL@FFREBG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1181' W0RTN   7
      * Send message 'Carrier                EX'
     C                     MOVEL'USR1181' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@FFREBG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Rtv Init Car w/TierStp XF - Carrier Freight Charge  * 
     C                     CALL 'PMCUXFR'              90  Rtv Init Car w/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WMBZNA    WQ0001  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WRRONB           Truck Size
      * Setup key
     C                     MOVELWL0131    WRRONB           Truck Size
      * Establish starting position
     C           KRSSY     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0132           Maximum pounds
     C                     Z-ADD*ZERO     WL0133           Minimum pounds
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRRSNB    WL0132           Maximum pounds
     C                     Z-ADDWRTANB    WL0133           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * CRT Load Header TMS    CR - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0048  50       Number Pallets
     C                     Z-ADD*ZERO     WN0049  50       Number Pallets
     C                     Z-ADD*ZERO     WN0050  60       Job Time
     C                     MOVEL*BLANK    WN0051 10        User Id
     C                     MOVEL*BLANK    WN0052 10        Job Name
     C                     Z-ADD*ZERO     WN0053  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FJCPBO
     C                     Z-ADDWN0006    WSRMNB           Load ID
     C                     Z-ADDWN0007    WSAIC3           Company Number
     C                     Z-ADDWN0008    WSAODT           Scheduled Ship
     C                     MOVELYL0038    WSPJST           LTL Flag
     C                     MOVELWN0009    WSPKST           Load Status
     C                     Z-ADDWALTMP    WSRNNB           Reefer Temperat
     C                     MOVEL*BLANK    WSDMTX           Seal 1
     C                     MOVEL*BLANK    WSDNTX           Seal 2
     C                     MOVEL*BLANK    WSDOTX           Seal 3
     C                     MOVEL*BLANK    WSWTTX           Seal 4
     C                     MOVEL*BLANK    WSWUTX           Seal 2 Unused
     C                     Z-ADDWN0011    WSRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WSFLAM           Flat Amount
     C                     MOVEL'M'       WSXQST           Allocate Pounds
     C                     Z-ADDWN0012    WSRRNB           Total Stops
     C                     MOVELWAUTAA    WSDXTX           Trailer Id
     C                     MOVEL*BLANK    WSDYTX           Transloader Car
     C                     Z-ADD*ZERO     WSSBNB           BOL Time
     C                     MOVELWN0014    WSBZNA           Carrier Code
     C                     MOVE *BLANK    WSRONB           Truck Size
     C                     MOVEL'T'       WSRONB           Truck Size
     C                     Z-ADD*ZERO     WSSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WSR1NB           Rated Freight
     C                     MOVEL'O'       WSVCST           Ship Status
     C                     MOVELWN0017    WSVDST           Load Type
     C                     Z-ADD*ZERO     WSDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WSSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WSHADT           Actual Arrival
     C                     Z-ADD*ZERO     WSAART           Actual Arrival
     C                     Z-ADD*ZERO     WSDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WSDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WSAQDT           Actual Departur
     C                     Z-ADD*ZERO     WSS6NB           Departure Time
     C                     Z-ADDYL0022    WST4NB           Schedule Sequen
     C                     Z-ADDWN0018    WSPRTM           Product Tempera
     C                     Z-ADD*ZERO     WSNPSV           Number Spacers
     C                     MOVEL*BLANK    WSJ8TX           Car/Veh. Initia
     C                     Z-ADDWACRDS    WSTLMI           Total Load Mile
     C                     MOVEL*BLANK    WSJ9TX           Recorder ID
     C                     MOVELWN0019    WSQ2CD           Shipping Method
     C                     MOVELWN0020    WSVPCD           Ship From Wareh
     C                     MOVELWN0021    WSDBCD           Ship To State C
     C                     Z-ADDWN0022    WSGRWE           Gross Weight
     C                     MOVELWN0014    WSXCCD           Carrier Broker
     C                     MOVELWN0024    WSU2ST           Export Status
     C                     Z-ADD*ZERO     WSF9DT           Actual Ship Dat
     C                     MOVELYL0041    WSONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     WSJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WSTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WSJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WSSPTM           Spotted Time
     C                     Z-ADD*ZERO     WSJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WSLFTM           Load Finished T
     C                     Z-ADD*ZERO     WSJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WSBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WSJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WSBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WSKIDT           Truck Departure
     C                     Z-ADD*ZERO     WSASTM           Truck Departure
     C                     Z-ADD*ZERO     WSKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WSAJCM           Adjusted Depart
     C                     MOVEL*BLANK    WSXACD           Shipping Line
     C                     MOVEL*BLANK    WSOANA           Port Delv Termi
     C                     MOVEL*BLANK    WSK4TX           Vessel Name
     C                     Z-ADD*ZERO     WSVOAG           Voyage
     C                     Z-ADD*ZERO     WSKBDT           Sail Date
     C                     MOVELWAFJU1    WSNBBO           Booking Number
     C                     MOVEL*BLANK    WSW4CD           Discharge Port
     C                     Z-ADD*ZERO     WSEFDT           Arrival Date
     C                     MOVELWAUUAA    WSCNTN           Container Numbe
     C                     Z-ADD*ZERO     WSKCDT           Date In
     C                     Z-ADD*ZERO     WSTMIN           Time In
     C                     Z-ADD*ZERO     WSKDDT           Date Out
     C                     Z-ADD*ZERO     WSVMNB           Time Out
     C                     Z-ADD*ZERO     WSOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WSKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WSATTM           Scheduled Deliv
     C                     MOVELYL0042    WSOTRS           LH Unused Sts
     C                     MOVELWN0026    WSRNST           LH Carrier Paym
     C                     Z-ADD*ZERO     WSBRBK           Bring Back Mile
     C                     Z-ADDWN0027    WSEIDT           Requested Deliv
     C                     MOVEL'A'       WSRMST           Load Acceptance
     C                     MOVEL*BLANK    WSAJCD           Warehouse Code
     C                     Z-ADD*ZERO     WSKKDT           On Yard Date
     C                     Z-ADD*ZERO     WSAVTM           On Yard Time
     C                     Z-ADDWN0028    WSKZDT           Deadline Depart
     C                     Z-ADDYL0040    WSAXTM           Deadline Depart
     C                     MOVEL*BLANK    WSLHOS           Load Held Over
     C                     MOVEL*BLANK    WSLHOR           Load Held Over
     C                     MOVEL*BLANK    WSWNTX           Load Held Over
     C                     MOVEL*BLANK    WSOITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    WSOJTX           Express Mail Nu
     C                     Z-ADD*ZERO     WSLLDT           Express Mail Da
     C                     MOVELWN0030    WSLSHG           Load Shag Flag
     C                     MOVELWN0031    WSYPST           Load Wash Flag
     C                     Z-ADD*ZERO     WSK0DT           Product Complet
     C                     Z-ADD*ZERO     WSAYTM           Product Complet
     C                     Z-ADD*ZERO     WSKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WSICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WSIDWG           Tot Pallet Tare
     C                     MOVEL'N'       WSH9SX           Load Confirmed
     C                     MOVEL*BLANK    WSWOTX           Load Confirmed
     C                     Z-ADD*ZERO     WSK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WSAZTM           Load Door 1
     C                     Z-ADD*ZERO     WSK2DT           Override Total
     C                     Z-ADD*ZERO     WSA0TM           Load Door 2
     C                     MOVELYL0043    WSROST           Partial Load
     C                     MOVELYL0044    WSRPST           Load Confirmati
     C                     MOVEL'N'       WSRQST           Export Load USD
     C                     MOVELYL0045    WSRRST           Late Delivery E
     C                     Z-ADD*ZERO     WSZBVA           Load Actual Fre
     C                     MOVEL*BLANK    WSWPTX           Hide on WW Load
     C                     MOVELYL0046    WSWQTX           Late Billing Em
     C                     MOVELWADFSC    WSWRTX           Shipping Temp C
     C                     MOVEL*BLANK    WSWSTX           LH Held Over Rs
     C                     MOVEL'N'       WSRVSX           Multi Company L
     C                     MOVEL*BLANK    WSRUSX           Fax Sent to SSI
     C                     MOVELYL0047    WSRWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    WSRXSX           LH Power Only L
     C                     MOVEL'Y'       WSRYSX           MG Created Load
     C                     MOVELYL0048    WSRZSX           LH Unused Sts 5
     C                     MOVELYL0049    WSR0SX           Load U/M
     C                     MOVELYL0050    WSR1SX           TPM Shipment St
     C                     MOVELYL0051    WSR2SX           LH Unused Sts 8
     C                     MOVELYL0002    WSR3SX           LH On-Time Reas
     C                     MOVELYL0052    WSR4SX           LH Held Over Re
     C                     Z-ADD*ZERO     WSPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WSCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WSPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WSCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WSP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WSCMTM           LPT Load Plan S
     C                     Z-ADDYL0053    WSP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WSCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WSP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WSCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WSP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WSCQTM           LH Unused Time
     C                     MOVELYL0054    WSUVST           EDI Status 1
     C                     MOVELYL0055    WSUWST           EDI Status 2
     C                     MOVELYL0056    WSUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
     C           KLCRSZ    KLIST
     C                     KFLD           WSRMNB           Load ID
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@FJCPBO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1189' W0RTN   7
      * Send message 'Load Header            EX'
     C                     MOVEL'USR1189' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@FJCPBO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Crt Load Dtl      RT - TMS Load Event  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0054  50       Stop/Drop Seque
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQTA01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQTA02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQTA03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQTA04           TMS Extract Fil
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           TMS Load ID
     C                     KFLD           WQTA02           TMS Extract Dat
     C                     KFLD           WQTA03           TMS Extract Tim
     C                     KFLD           WQTA04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           TMS Load ID
     C                     KFLD           WQTA02           TMS Extract Dat
     C                     KFLD           WQTA03           TMS Extract Tim
     C                     KFLD           WQTA04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0134    WQTA01           TMS Load ID
     C                     Z-ADDWL0135    WQTA02           TMS Extract Dat
     C                     Z-ADDWL0136    WQTA03           TMS Extract Tim
     C                     MOVELWL0137    WQTA04           TMS Extract Fil
     C                     Z-ADDWL0138    WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSTA     SETLL@CSCPXP                    *
     C           KRSTA     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Pickup
     C           WBDMSC    IFEQ @CN,014                    *IF
      * CASE: DB1.TMS Address Type is Warehouse
     C           WBDNSC    IFEQ @CN,004                    *IF
      * Change TMS Load Event - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBTMLD    WL0160           TMS Load ID
     C                     Z-ADDWBAYD8    WL0161           TMS Extract Dat
     C                     Z-ADDWBAFTH    WL0162           TMS Extract Tim
     C                     MOVELWBFSU1    WL0163    P      TMS Extract Fil
     C                     Z-ADDWBEVSQ    WL0164           TMS Event Seque
     C                     MOVELWBDMSC    WL0165    P      TMS Event Type
     C                     Z-ADDWBA1D8    WL0166           TMS Earliest Da
     C                     Z-ADDWBAHTH    WL0167           TMS Earliest Ti
     C                     Z-ADDWBA2D8    WL0168           TMS Latest Date
     C                     Z-ADDWBAITH    WL0169           TMS Latest Time
     C                     Z-ADDWBA3D8    WL0170           TMS Planned Dat
     C                     Z-ADDWBAJTH    WL0171           TMS Planned Tim
     C                     Z-ADDWBA4D8    WL0172           TMS Actual Date
     C                     Z-ADDWBAKTH    WL0173           TMS Actual Time
     C                     MOVELWBDNSC    WL0174    P      TMS Address Typ
     C                     MOVELWBUZAA    WL0175    P      TMS Location Co
     C                     MOVELWBFFU1    WL0176    P      TMS Address Nam
     C                     MOVELWBUGU1    WL0177    P      TMS Address Lin
     C                     MOVELWBFHU1    WL0178    P      TMS Address Lin
     C                     MOVELWBU0AA    WL0179    P      TMS City
     C                     MOVELWBU1AA    WL0180    P      TMS State Provi
     C                     MOVELWBU3AA    WL0181    P      TMS Postal Code
     C                     MOVELWBU4AA    WL0182    P      TMS Country Cod
     C                     Z-ADDWBG1NB    WL0183           TMS Weight
     C                     MOVELWBDOSC    WL0184    P      TMS Weight UOM
     C                     Z-ADDWBA6D8    WL0185           TMS Appointment
     C                     Z-ADDWBAMTH    WL0186           TMS Appointment
     C                     Z-ADDWBA9D8    WL0187           TMS Actual Car
     C                     Z-ADDWBANTH    WL0188           TMS Actual Car
     C                     MOVELWBVBAA    WL0189    P      TMS Late Reason
     C                     MOVELWBP5U1    WL0190    P      TMS Cust Assign
     C                     MOVELWBDLSC    WL0191    P      TMS Record Stat
     C                     Z-ADD1         WL0192           TMS Process Sta
     C                     MOVEL*BLANK    WL0193           TMS Error Reaso
     C                     Z-ADDWBA0D8    WL0194           TMS Change Date
     C                     Z-ADDWBD9TM    WL0195           TMS Change time
     C                     EXSR TBCHRC
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv.
      * Rtv Drops to Crt LD   RT - TMS Load Event  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Change TMS Load Event - TMS Load Event  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @CSCPXO
     C                     Z-ADDWL0160    WTTMLD           TMS Load ID
     C                     Z-ADDWL0161    WTAYD8           TMS Extract Dat
     C                     Z-ADDWL0162    WTAFTH           TMS Extract Tim
     C                     MOVELWL0163    WTFSU1    P      TMS Extract Fil
     C                     Z-ADDWL0164    WTEVSQ           TMS Event Seque
      *
     C           KLCHTB    KLIST
     C                     KFLD           WTTMLD           TMS Load ID
     C                     KFLD           WTAYD8           TMS Extract Dat
     C                     KFLD           WTAFTH           TMS Extract Tim
     C                     KFLD           WTFSU1           TMS Extract Fil
     C                     KFLD           WTEVSQ           TMS Event Seque
     C           KLCHTB    CHAIN@CSCPXO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCSCPL0'MDACP
     C                     MOVEL'@CSCPXO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCS1    YCRDCS
      * Move non-key fields to @CSCPXO
     C                     MOVELWL0165    WTDMSC    P      TMS Event Type
     C                     Z-ADDWL0166    WTA1D8           TMS Earliest Da
     C                     Z-ADDWL0167    WTAHTH           TMS Earliest Ti
     C                     Z-ADDWL0168    WTA2D8           TMS Latest Date
     C                     Z-ADDWL0169    WTAITH           TMS Latest Time
     C                     Z-ADDWL0170    WTA3D8           TMS Planned Dat
     C                     Z-ADDWL0171    WTAJTH           TMS Planned Tim
     C                     Z-ADDWL0172    WTA4D8           TMS Actual Date
     C                     Z-ADDWL0173    WTAKTH           TMS Actual Time
     C                     MOVELWL0174    WTDNSC    P      TMS Address Typ
     C                     MOVELWL0175    WTUZAA    P      TMS Location Co
     C                     MOVELWL0176    WTFFU1    P      TMS Address Nam
     C                     MOVELWL0177    WTUGU1    P      TMS Address Lin
     C                     MOVELWL0178    WTFHU1    P      TMS Address Lin
     C                     MOVELWL0179    WTU0AA    P      TMS City
     C                     MOVELWL0180    WTU1AA    P      TMS State Provi
     C                     MOVELWL0181    WTU3AA    P      TMS Postal Code
     C                     MOVELWL0182    WTU4AA    P      TMS Country Cod
     C                     Z-ADDWL0183    WTG1NB           TMS Weight
     C                     MOVELWL0184    WTDOSC    P      TMS Weight UOM
     C                     Z-ADDWL0185    WTA6D8           TMS Appointment
     C                     Z-ADDWL0186    WTAMTH           TMS Appointment
     C                     Z-ADDWL0187    WTA9D8           TMS Actual Car
     C                     Z-ADDWL0188    WTANTH           TMS Actual Car
     C                     MOVELWL0189    WTVBAA    P      TMS Late Reason
     C                     MOVELWL0190    WTP5U1    P      TMS Cust Assign
     C                     MOVELWL0191    WTDLSC    P      TMS Record Stat
     C                     Z-ADDWL0192    WTTPRC           TMS Process Sta
     C                     MOVELWL0193    WTUYAA    P      TMS Error Reaso
     C                     Z-ADDWL0194    WTA0D8           TMS Change Date
     C                     Z-ADDWL0195    WTD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@CSCPXO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Drops to Crt LD   RT - TMS Load Event  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0055  50       Stop/Drop Seque
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0055           Stop/Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVTMLD    WQTC01           TMS Load ID
     C           *LIKE     DEFN WVAYD8    WQTC02           TMS Extract Dat
     C           *LIKE     DEFN WVAFTH    WQTC03           TMS Extract Tim
     C           *LIKE     DEFN WVFSU1    WQTC04           TMS Extract Fil
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           TMS Load ID
     C                     KFLD           WQTC02           TMS Extract Dat
     C                     KFLD           WQTC03           TMS Extract Tim
     C                     KFLD           WQTC04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWBTMLD    WQTC01           TMS Load ID
     C                     Z-ADDWBAYD8    WQTC02           TMS Extract Dat
     C                     Z-ADDWBAFTH    WQTC03           TMS Extract Tim
     C                     MOVELWBFSU1    WQTC04           TMS Extract Fil
      * Establish starting position
     C           KRSTC     SETLL@CSCPYL                    *
     C           KRSTC     READE@CSCPYL                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv & TMS Cust A
      * Rtv Crt Load Dtl      RT - TMS Load Event Shipment  * 
     C                     EXSR TDRVGN
      * Change TMS Load Event - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVTMLD    WL0160           TMS Load ID
     C                     Z-ADDWVAYD8    WL0161           TMS Extract Dat
     C                     Z-ADDWVAFTH    WL0162           TMS Extract Tim
     C                     MOVELWVFSU1    WL0163    P      TMS Extract Fil
     C                     Z-ADDWVEVSQ    WL0164           TMS Event Seque
     C                     MOVELWVDMSC    WL0165    P      TMS Event Type
     C                     Z-ADDWVA1D8    WL0166           TMS Earliest Da
     C                     Z-ADDWVAHTH    WL0167           TMS Earliest Ti
     C                     Z-ADDWVA2D8    WL0168           TMS Latest Date
     C                     Z-ADDWVAITH    WL0169           TMS Latest Time
     C                     Z-ADDWVA3D8    WL0170           TMS Planned Dat
     C                     Z-ADDWVAJTH    WL0171           TMS Planned Tim
     C                     Z-ADDWVA4D8    WL0172           TMS Actual Date
     C                     Z-ADDWVAKTH    WL0173           TMS Actual Time
     C                     MOVELWVDNSC    WL0174    P      TMS Address Typ
     C                     MOVELWVUZAA    WL0175    P      TMS Location Co
     C                     MOVELWVFFU1    WL0176    P      TMS Address Nam
     C                     MOVELWVUGU1    WL0177    P      TMS Address Lin
     C                     MOVELWVFHU1    WL0178    P      TMS Address Lin
     C                     MOVELWVU0AA    WL0179    P      TMS City
     C                     MOVELWVU1AA    WL0180    P      TMS State Provi
     C                     MOVELWVU3AA    WL0181    P      TMS Postal Code
     C                     MOVELWVU4AA    WL0182    P      TMS Country Cod
     C                     Z-ADDWVG1NB    WL0183           TMS Weight
     C                     MOVELWVDOSC    WL0184    P      TMS Weight UOM
     C                     Z-ADDWVA6D8    WL0185           TMS Appointment
     C                     Z-ADDWVAMTH    WL0186           TMS Appointment
     C                     Z-ADDWVA9D8    WL0187           TMS Actual Car
     C                     Z-ADDWVANTH    WL0188           TMS Actual Car
     C                     MOVELWVVBAA    WL0189    P      TMS Late Reason
     C                     MOVELWVP5U1    WL0190    P      TMS Cust Assign
     C                     MOVELWVDLSC    WL0191    P      TMS Record Stat
     C                     Z-ADD1         WL0192           TMS Process Sta
     C                     MOVEL*BLANK    WL0193           TMS Error Reaso
     C                     Z-ADDWVA0D8    WL0194           TMS Change Date
     C                     Z-ADDWVD9TM    WL0195           TMS Change time
     C                     EXSR TBCHRC
     C           KRSTC     READE@CSCPYL                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Crt Load Dtl      RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQTD01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQTD02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQTD03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQTD04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQTD05           TMS Event Seque
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           TMS Load ID
     C                     KFLD           WQTD02           TMS Extract Dat
     C                     KFLD           WQTD03           TMS Extract Tim
     C                     KFLD           WQTD04           TMS Extract Fil
     C                     KFLD           WQTD05           TMS Event Seque
      * Setup key
     C                     Z-ADDWVTMLD    WQTD01           TMS Load ID
     C                     Z-ADDWVAYD8    WQTD02           TMS Extract Dat
     C                     Z-ADDWVAFTH    WQTD03           TMS Extract Tim
     C                     MOVELWVFSU1    WQTD04           TMS Extract Fil
     C                     Z-ADDWVEVSQ    WQTD05           TMS Event Seque
      * Establish starting position
     C           KRSTD     SETLL@CUCPXS                    *
     C           KRSTD     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Comments and changes
     C                     EXSR UESUBR                     Comments and ch
      * Rtv Co and Load       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMOR    WL0197           Order Number
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0057           Company Number
     C                     Z-ADDWL0198    YL0058           Load ID
     C                     MOVELWL0199    YL0059    P      Event Code
      * Process for Orig load on order if different
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load ID USR is entered
      *   |- c2    : LCL.Load ID USR NE DB1.TMS Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0058    IFNE 0                          *IF
     C           YL0058    IFNE WETMLD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV DLT ORd f/TMS Chg  RT - Load Detail  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C                     ADD  1         WN0055           Stop/Drop Seque
     C                     Z-ADD*ZERO     YL0062           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0063           Actual Delivery
     C                     Z-ADD*ZERO     YL0064           LD Unused Date
      * If TMS Appointment Date is entered                    E009492
      * CASE: PAR.TMS Appointment Date is entered
     C           WVA6D8    IFGT 0                          *IF
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0062    PARM *ZERO     WQ0005  70       Date
     C                     PARM WVA6D8    WQ0006  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *****
      * RTV Orig Appt Dte/Tme  XF - Order Header Extension  * 
     C                     CALL 'PUA4XFR'              90  RTV Orig Appt D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0057    WQ0007  30       Company Number
     C                     PARM WETMOR    WQ0008  70       Order Number
     C           WUQENY    PARM *ZERO     WQ0009  60       Original Appoin
     C           WUQFNY    PARM *ZERO     WQ0010  60       Original Appoin
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUA4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Only update Orig Appt date/time if it is zeros      E009492
      * CASE: WRK.Original Appointment Date is Equal to zero
     C           WUQENY    IFEQ 0                          *IF
      * * Convert tms appt date from 8.0 to 6.0
      *
     C                     MOVEL*BLANK    WN0177  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0178  6        Date (Char-6) U
      *
      * CVT *YYMD to *YMD     IF
      * ** Convert incoming date to alpha
     C                     MOVELWVA6D8    WN0177           Date (Char-8) U
      * ** Retrieve yymmdd into another alpha field
     C                     Z-ADD6         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0177:ZQ WN0178    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** Convert 6 char date to 6.0 and put in par to return
     C                     MOVE WN0178    YL0065           Date Out (6,0)
      * * Save carrier appt date in original appointment date in OHE E009
     C                     Z-ADDYL0065    YL0066           Original Appoin
      * * Save carrier appt time in original appointment time in OHE  E00
     C           WVAMTH    MULT 100       YL0067           Original Appoin
      * * Update OHE original date & time                     E009492
      * CHG Orig Appt Dt/Tm   CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0403           Company Number
     C                     Z-ADDWETMOR    WL0404           Order Number
     C                     Z-ADDYL0066    WL0405           Original Appoin
     C                     Z-ADDYL0067    WL0406           Original Appoin
     C                     EXSR TNCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           WVAMTH    MULT 100       YL0068           LD Carrier Appt
      * CASE: PAR.TMS Actual Car Arrival Dt is entered
     C           WVA9D8    IFGT 0                          *IF
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0063    PARM *ZERO     WQ0011  70       Date
     C                     PARM WVA9D8    WQ0012  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           WVANTH    MULT 100       YL0069           Actual Delivery
     C           WL0158    MULT 100       YL0070           Deadline Depart
      * TMS Late Reason Code
      * CASE: PAR.TMS Late Reason Code is Entered
     C           WVVBAA    IFGT *BLANK                     *IF
      * CASE: PAR.TMS Late Reason Code is NS
     C           WVVBAA    IFEQ 'NS'                       *IF
     C                     MOVEL*BLANK    YL0071           Load Dtl On Tim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0071           Load Dtl On Tim
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0071           Load Dtl On Tim
     C                     END                             *FI
      * R17040 DN 03/01/21-Set TMS Carrier Ref PRO/Inv & TMS Cust Assigne
      * CRT Load Detail        CR - Load Detail  * 
     C                     EXSR TOCRRC
      * Event Code Last is 01 Order Entry
      * CASE: LCL.Event Code Last is 01 Order Entry
     C           YL0059    IFEQ '01'                       *IF
     C                     MOVEL'02'      YL0059           Event Code Last
      * Crt Load Plan Event    RT - Order Events  * 
     C                     EXSR TPRVGN
     C                     END                             *FI
      * Chg Load Info - TMS    CH - Order Header TRG  * 
     C                     EXSR TSCHRC
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0429           Company Number
     C                     Z-ADDWETMOR    WL0430           Order Number
     C                     Z-ADDWL0157    WL0431           Deadline Depart
     C                     Z-ADDYL0070    WL0432           Deadline Depart
     C                     EXSR TTRVGN
      * Order Event to 02
      * Log add to load   -- if in add mode only
      * Create Log if ADD or CHG
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Add/Change/Delete USR is Add
      *   |- c2    : PAR.Add/Change/Delete USR is Change
      *   '-
     C           WL0159    IFEQ 'A'                        *IF
     C           WL0159    OREQ 'C'                        *OR
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWETMLD    PBRMNB           Load ID
     C                     Z-ADDWEEVSQ    PBRVNB           Stop/Drop
     C                     MOVEL'ADDORD'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVEL*BLANK    PBMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWL0156    PBBZNA    P      Carrier Code
     C                     Z-ADDYL0057    PBAIC3           Company Number
     C                     Z-ADDWETMOR    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Order header Ext updates    *NOTE OHE get upd again frm Intl Leg
      *  with Carrier Mode = "OCEAN"   -- except for the load id, stop#
      * 07/24/19 DN R15161-Set OHE Voyage/Flight.
      * CASE: *OTHERWISE
      * OHE Voyage/Flight field type was changed from NBR (5) to TXT (15)
      * No longer need to check if value is numeric.
     C                     MOVELWL0144    YL0076           OHE Voyage/Flig
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0077    PARM *ZERO     WQ0013  70       Date
     C                     PARM WL0153    WQ0014  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0078    PARM *ZERO     WQ0015  70       Date
     C                     PARM WL0154    WQ0016  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Added update original appointment date/time       E009492
      * 07/24/19 DN R15161-Replaced PAR.Voyage with OHE Voyage/Flight &
      *   PAR.Booking Number with OHE Booking Number.
      * RTV Chg TMS Load Flds RT - Order Header Extension  * 
     C                     EXSR TVRVGN
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWETMLD    WL0001           TMS Load ID
     C                     Z-ADDWEAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWEAFTH    WL0003           TMS Extract Tim
     C                     MOVELWEFSU1    WL0004    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WL0005           TMS Event Seque
     C                     Z-ADDWETMOR    WL0006           TMS Order ID
     C                     Z-ADDWEHFNB    WL0007           TMS Miles from
     C                     MOVELWEDLSC    WL0008    P      TMS Record Stat
     C                     Z-ADD1         WL0009           TMS Process Sta
     C                     MOVEL*BLANK    WL0010           TMS Error Reaso
     C                     Z-ADDWEA0D8    WL0011           TMS Change Date
     C                     Z-ADDWED9TM    WL0012           TMS Change time
     C                     EXSR SHCHRC
     C           KRSTD     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Co and Load       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFC4NB    WQTE01           Order Number
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Order Number
      * Setup key
     C                     Z-ADDWL0197    WQTE01           Order Number
      * Establish starting position
     C           KRSTE     SETLL@BFCPY2                    *
     C           KRSTE     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0196           Company Number
     C                     Z-ADD*ZERO     WL0198           Load ID
     C                     MOVEL*BLANK    WL0199           Event Code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAIC3    WL0196           Company Number
     C                     Z-ADDWFRMNB    WL0198           Load ID
     C                     MOVELWFJPCD    WL0199           Event Code
     C           KRSTE     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV DLT ORd f/TMS Chg  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQTF02           Load ID
     C           *LIKE     DEFN WWC4NB    WQTF03           Order Number
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF02           Load ID
     C                     KFLD           WQTF03           Order Number
      * Setup key
     C                     Z-ADDYL0058    WQTF02           Load ID
     C                     Z-ADDWETMOR    WQTF03           Order Number
      * Establish starting position
     C           KRSTF     SETLL@FLCPKF                    *
     C           KRSTF     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWRMNB    WL0200           Load ID
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0201    YL0060    P      Load Status
      * Zero out load id
      * RTV Chg Ld for TMS    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0202           Company Number
     C                     Z-ADDWWC4NB    WL0203           Order Number
     C                     MOVEL*BLANK    WL0204           Carrier Code
     C                     Z-ADD*ZERO     WL0205           Load ID
     C                     Z-ADD*ZERO     WL0206           Rated Freight
     C                     MOVEL'Y'       WL0207    P      OH Load Plan Re
     C                     EXSR THRVGN
      * Zero out load id ; reset load plan ready to ReSweep
      * RTV Chg for TMS Delet RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0208           Company Number
     C                     Z-ADDWWC4NB    WL0209           Order Number
     C                     Z-ADDWWRMNB    WL0210           Load ID
     C                     EXSR TJRVGN
     C                     MOVEL*BLANK    WUKGTX           @Blank for 5
     C                     MOVELWWRVNB    WUKGTX           @Blank for 5
     C                     MOVEL*BLANK    YL0061           Change Log Prio
     C                     MOVELWUKGTX    YL0061           Change Log Prio
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWWRMNB    PBRMNB           Load ID
     C                     Z-ADDWWRVNB    PBRVNB           Stop/Drop
     C                     MOVEL'DELORD'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVELYL0061    PBMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##JOB     PBA0NA    P      Job Name
     C                     MOVELWL0156    PBBZNA    P      Carrier Code
     C                     Z-ADDWWAIC3    PBAIC3           Company Number
     C                     Z-ADDWWC4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DLT Load Detail        DL - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWRMNB    WL0401           Load ID
     C                     Z-ADDWWRUNB    WL0402           Stop/Drop Seque
     C                     EXSR TMDLRC
      * CASE: LCL.Load Status New is Lock
     C           YL0060    IFEQ 'L'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WWRMNB    WQ0004  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSTF     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0200    WCRMNB           Load ID
      * Establish starting position
     C           KRSTG     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0201           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWCPKST    WL0201           Load Status
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Chg Ld for TMS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0202    WJAIC3           Company Number
     C                     Z-ADDWL0203    WJC4NB           Order Number
      * Establish starting position
     C           KRSTH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Load to Untied TMS CH - Order Header TRG  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Load to Untied TMS CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0056  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0057  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0058  70       Ship To Custome
     C                     MOVEL*BLANK    WN0059 30        Ship To Name
     C                     MOVEL*BLANK    WN0060 30        Ship To Address
     C                     MOVEL*BLANK    WN0061 30        Ship To Address
     C                     MOVEL*BLANK    WN0062 30        Ship To Address
     C                     MOVEL*BLANK    WN0063 20        Ship To City
     C                     MOVEL*BLANK    WN0064  2        Ship To State C
     C                     MOVEL*BLANK    WN0065 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0066  70       Bill to Custome
     C                     MOVEL*BLANK    WN0067 30        Bill to Name
     C                     MOVEL*BLANK    WN0068 30        Bill to Address
     C                     MOVEL*BLANK    WN0069 30        Bill to Address
     C                     MOVEL*BLANK    WN0070 30        Bill to Address
     C                     MOVEL*BLANK    WN0071 20        Bill to City
     C                     MOVEL*BLANK    WN0072  2        Bill to State C
     C                     MOVEL*BLANK    WN0073 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0074 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0075  70       Order Date
     C                     Z-ADD*ZERO     WN0076  70       Requested Ship
     C                     Z-ADD*ZERO     WN0077  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0078  70       Cancel Date
     C                     MOVEL*BLANK    WN0079  2        Terms Code
     C                     MOVEL*BLANK    WN0080 40        Special Instruc
     C                     MOVEL*BLANK    WN0081 40        Special Instruc
     C                     MOVEL*BLANK    WN0082  3        Carrier Code
     C                     MOVEL*BLANK    WN0083  1        Comment Print A
     C                     MOVEL*BLANK    WN0084  1        Comment Print I
     C                     MOVEL*BLANK    WN0085  1        Comment Print P
     C                     MOVEL*BLANK    WN0086  1        Comment Print S
     C                     MOVEL*BLANK    WN0087  3        Reason Code
     C                     MOVEL*BLANK    WN0088  1        Order in Use
     C                     MOVEL*BLANK    WN0089  1        Header Status
     C                     MOVEL*BLANK    WN0090  1        Header Status L
     C                     MOVEL*BLANK    WN0091  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0092  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0093 10        User Original E
     C                     Z-ADD*ZERO     WN0094  70       Date of Origina
     C                     Z-ADD*ZERO     WN0095 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0096 112       Order Weight To
     C                     MOVEL*BLANK    WN0097  1        Credit Hold
     C                     MOVEL*BLANK    WN0098  1        Production Hold
     C                     MOVEL*BLANK    WN0099  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0100  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0101  40       Requested Deliv
     C                     MOVEL*BLANK    WN0102  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0103 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0104  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0105 112       Rated Freight
     C                     MOVEL*BLANK    WN0106  1        LTL Flag
     C                     MOVEL*BLANK    WN0107  1        Price Audit
     C                     MOVEL*BLANK    WN0108  1        Price Status
     C                     MOVEL*BLANK    WN0109  2        Shipping Method
     C                     MOVEL*BLANK    WN0110  1        Export Status
     C                     MOVEL*BLANK    WN0111  1        Palletize
     C                     MOVEL*BLANK    WN0112  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0113  1        Slip Sheet
     C                     MOVEL*BLANK    WN0114  1        Age Code
     C                     Z-ADD*ZERO     WN0115  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0116  1        Load Type
     C                     Z-ADD*ZERO     WN0117  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0118  1        Load Plan Order
     C                     MOVEL*BLANK    WN0119  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0120  70       Resell Referenc
     C                     MOVEL*BLANK    WN0121 30        Special Comment
     C                     MOVEL*BLANK    WN0122 30        Special Comment
     C                     MOVEL*BLANK    WN0123  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0124  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0125  2        Manager Level C
     C                     MOVEL*BLANK    WN0126  3        VP Level Code
     C                     Z-ADD*ZERO     WN0127  70       Attach to Order
     C                     MOVEL*BLANK    WN0128  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0129  70       Invoice Number
     C                     MOVEL*BLANK    WN0130  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0131  70       Invoice Date
     C                     MOVEL*BLANK    WN0132  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0133  1        Modified Flag
     C                     Z-ADD*ZERO     WN0134 112       A/R order Value
     C                     MOVEL*BLANK    WN0135  1        Billing Activit
     C                     MOVEL*BLANK    WN0136  1        Block Order Fla
     C                     MOVEL*BLANK    WN0137  1        Order Certifica
     C                     Z-ADD*ZERO     WN0138 112       Invoice Order V
     C                     MOVEL*BLANK    WN0139  1        Process Sts for
     C                     MOVEL*BLANK    WN0140  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0141  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0142  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0143  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0144  1        Email Cust On O
     C                     MOVEL*BLANK    WN0145  1        Order Emailed
     C                     MOVEL*BLANK    WN0146  1        Export Docs Go
     C                     MOVEL*BLANK    WN0147  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0148  1        Broker Order St
     C                     MOVEL*BLANK    WN0149  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0150  2        Order Requires
     C                     MOVEL*BLANK    WN0151  2        Export USDA App
     C                     MOVEL*BLANK    WN0152  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0153  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0154  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0155  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0156  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0157  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0158  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0159  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0160  60       Time of Origina
     C                     Z-ADD*ZERO     WN0161  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0162  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0163  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0164 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0165 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0166 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0167 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0168 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0169  70       Claim Number
     C                     MOVEL*BLANK    WN0170  1        EDI Status 1
     C                     MOVEL*BLANK    WN0171  1        EDI Status 2
     C                     MOVEL*BLANK    WN0172  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0173  60       Job Time
     C                     MOVEL*BLANK    WN0174 10        User Id
     C                     MOVEL*BLANK    WN0175 10        Job Name
     C                     Z-ADD*ZERO     WN0176  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWJAIC3    WXAIC3           Company Number
     C                     Z-ADDWJC4NB    WXC4NB           Order Number
      *
     C           KLCHTI    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C           KLCHTI    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0205    WXRMNB           Load ID
     C                     MOVELWJJPCD    WXJPCD    P      Event Code
     C                     MOVELWL0207    WXFVSX    P      OH Load Plan Re
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWXAIC3    PAAIC3           Company Number
     C                     Z-ADDWXC4NB    PAC4NB           Order Number
     C                     MOVELWXJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWXANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWXBKC7    PABKC7           Ship To Custome
     C                     MOVELWXBRTX    PABRTX    P      Ship To Name
     C                     MOVELWXHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWXHONA    PAHONA    P      Ship To Address
     C                     MOVELWXHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWXHNNA    PAHNNA    P      Ship To City
     C                     MOVELWXDBCD    PADBCD    P      Ship To State C
     C                     MOVELWXCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWXB0C7    PAB0C7           Bill to Custome
     C                     MOVELWXAETX    PAAETX    P      Bill to Name
     C                     MOVELWXB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWXB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWXB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWXB2NA    PAB2NA    P      Bill to City
     C                     MOVELWXBHCD    PABHCD    P      Bill to State C
     C                     MOVELWXC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWXBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWXA0DT    PAA0DT           Order Date
     C                     Z-ADDWXA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWXGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWXACDT    PAACDT           Cancel Date
     C                     MOVELWXAQCD    PAAQCD    P      Terms Code
     C                     MOVELWXB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWXBYNA    PABYNA    P      Special Instruc
     C                     MOVELWXBZNA    PABZNA    P      Carrier Code
     C                     MOVELWXGTST    PAGTST    P      Comment Print A
     C                     MOVELWXGVST    PAGVST    P      Comment Print I
     C                     MOVELWXGUST    PAGUST    P      Comment Print P
     C                     MOVELWXQFST    PAQFST    P      Comment Print S
     C                     MOVELWXCQCD    PACQCD    P      Reason Code
     C                     MOVELWXGJST    PAGJST    P      Order in Use
     C                     MOVELWXGWST    PAGWST    P      Header Status
     C                     MOVELWXGXST    PAGXST    P      Header Status L
     C                     MOVELWXGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWXAODT    PAAODT           Scheduled Ship
     C                     MOVELWXAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWXCXDT    PACXDT           Date of Origina
     C                     Z-ADDWXJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWXA1WG    PAA1WG           Order Weight To
     C                     MOVELWXXIST    PAXIST    P      Credit Hold
     C                     MOVELWXXJST    PAXJST    P      Production Hold
     C                     MOVELWXXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWXEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWXAFTM    PAAFTM           Requested Deliv
     C                     MOVELWXE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWXE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWXRMNB    PARMNB           Load ID
     C                     Z-ADDWXTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWXR1NB    PAR1NB           Rated Freight
     C                     MOVELWXPJST    PAPJST    P      LTL Flag
     C                     MOVELWXU0ST    PAU0ST    P      Price Audit
     C                     MOVELWXU1ST    PAU1ST    P      Price Status
     C                     MOVELWXQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWXU2ST    PAU2ST    P      Export Status
     C                     MOVELWXVEST    PAVEST    P      Palletize
     C                     MOVELWXVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWXVGST    PAVGST    P      Slip Sheet
     C                     MOVELWXRPCD    PARPCD    P      Age Code
     C                     Z-ADDWXRNNB    PARNNB           Reefer Temperat
     C                     MOVELWXVDST    PAVDST    P      Load Type
     C                     Z-ADDWXATIN    PAATIN           Attach to Invoi
     C                     MOVELWXU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWXU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWXRSRN    PARSRN           Resell Referenc
     C                     MOVELWXMHNA    PAMHNA    P      Special Comment
     C                     MOVELWXMINA    PAMINA    P      Special Comment
     C                     MOVELWXWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWXR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWXBFCD    PABFCD    P      Manager Level C
     C                     MOVELWXQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWXT3NB    PAT3NB           Attach to Order
     C                     MOVELWXSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWXCONB    PACONB           Invoice Number
     C                     MOVELWXCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWXAWDT    PAAWDT           Invoice Date
     C                     MOVELWXJPCD    PAJPCD    P      Event Code
     C                     MOVELWXXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWXZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWXVRVA    PAVRVA           A/R order Value
     C                     MOVELWXOBST    PAOBST    P      Billing Activit
     C                     MOVELWXBCST    PABCST    P      Block Order Fla
     C                     MOVELWXBDST    PABDST    P      Order Certifica
     C                     Z-ADDWXB7VL    PAB7VL           Invoice Order V
     C                     MOVELWXGASX    PAGASX    P      Process Sts for
     C                     MOVELWXGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWXGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWXGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWXFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWXFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWXFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWXFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWXFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWXFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWXFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWXFUSX    PAFUSX    P      Order Requires
     C                     MOVELWXFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWXFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWXFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWXFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWXNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWXNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWXNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWXNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWXNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWXBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWXBQTM    PABQTM           Time of Origina
     C                     Z-ADDWXBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWXBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWXBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWXH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWXH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWXH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWXH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWXH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWXC0C7    PAC0C7           Claim Number
     C                     MOVELWXUVST    PAUVST    P      EDI Status 1
     C                     MOVELWXUWST    PAUWST    P      EDI Status 2
     C                     MOVELWXUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWXAATM    PAAATM           Job Time
     C                     MOVELWXAYNA    PAAYNA    P      User Id
     C                     MOVELWXA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWXAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Chg for TMS Delet RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0208    WYAIC3           Company Number
     C                     Z-ADDWL0209    WYC4NB           Order Number
      * Establish starting position
     C           KRSTJ     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * R15161 DN  07/23/19-Set Voyage to *BLANK.
      * CHG Order Header Exten CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWYAIC3    WL0211           Company Number
     C                     Z-ADDWYC4NB    WL0212           Order Number
     C                     Z-ADD*ZERO     WL0213           Load ID
     C                     Z-ADD*ZERO     WL0214           Stop/Drop Seque
     C                     MOVELWYXACD    WL0215    P      Shipping Line
     C                     MOVELWYOANA    WL0216    P      Port Delv Termi
     C                     MOVELWYHBAA    WL0217    P      OHE City
     C                     MOVEL*BLANK    WL0218           OHE Vessel/Airl
     C                     MOVEL*BLANK    WL0219           OHE Voyage/Flig
     C                     MOVEL*BLANK    WL0220           OHE Booking Num
     C                     MOVELWYHCAA    WL0221    P      OHE Discharge P
     C                     Z-ADDWYQWDT    WL0222           OHE Sail/Flight
     C                     Z-ADDWYQXDT    WL0223           OHE Port Cut Da
     C                     Z-ADDWYQYDT    WL0224           OHE Arrival Dat
     C                     MOVELWYHDAA    WL0225    P      OHE Late Delive
     C                     MOVELWUUAT1    WL0226    P      OHE Ship Status
     C                     MOVEL*BLANK    WL0227           OHE Container N
     C                     MOVELWYRLNA    WL0228    P      OHE Comment 1
     C                     MOVELWYRMNA    WL0229    P      OHE Comment 2
     C                     Z-ADDWYGINY    WL0230           OHE Unused Numb
     C                     Z-ADDWYGFNY    WL0231           OHE Unused Numb
     C                     Z-ADDWYGGNY    WL0232           OHE Unused Numb
     C                     Z-ADDWYGHNY    WL0233           OHE Unused Numb
     C                     Z-ADDWYHEVL    WL0234           OHE HPB RIN Equ
     C                     Z-ADDWYHFVL    WL0235           OHE HPB RIN Pri
     C                     Z-ADDWYHGVL    WL0236           Transload Termi
     C                     Z-ADDWYQZDT    WL0237           OHE Est Arrv at
     C                     Z-ADDWYQ0DT    WL0238           OHE Backhaul ET
     C                     Z-ADDWYQ1DT    WL0239           OHE Port/Pier P
     C                     Z-ADDWYQ2DT    WL0240           OHE Actual Ship
     C                     MOVELWYC2TX    WL0241    P      OHE Carrier SCA
     C                     MOVELWYC3TX    WL0242    P      OHE Spot Buy
     C                     MOVELWYC6TX    WL0243    P      OHE PO ACK Flag
     C                     MOVELWYCHTX    WL0244    P      OHE Override Ty
     C                     MOVELWYCITX    WL0245    P      OHE Backhaul St
     C                     MOVELWYCLTX    WL0246    P      OHE Backhaul ET
     C                     MOVELWYB4TX    WL0247    P      OHE Load Haul T
     C                     MOVELWYCUTX    WL0248    P      OHE Backhaul Ca
     C                     MOVELWYCVTX    WL0249    P      OHE Bookings Co
     C                     MOVELWYB9TX    WL0250    P      OHE EDI Error R
     C                     MOVELWYJWSC    WL0251    P      OHE EDI Error R
     C                     Z-ADDWYITNY    WL0252           HPB COA Batch N
     C                     MOVELWYLMT1    WL0253    P      Delivery P.O. N
     C                     MOVELWYLWAA    WL0254    P      OHE Intended fo
     C                     MOVELWYFVST    WL0255    P      OHE EDI 943 Act
     C                     MOVELWYF0ST    WL0256    P      OHE EDI 944 Act
     C                     MOVELWYF2ST    WL0257    P      OHE EDI 940 Act
     C                     MOVELWYF3ST    WL0258    P      OHE EDI 945 Act
     C                     MOVELWYJUSC    WL0259    P      OHE EDI 856 Act
     C                     MOVELWYJVSC    WL0260    P      OHE EDI 824 Act
     C                     MOVELWYV3T1    WL0261    P      OHE Transload S
     C                     MOVELWYV4T1    WL0262    P      OHE Abs Rate Ov
     C                     MOVELWYV5T1    WL0263    P      OHE Appt Confir
     C                     MOVELWYV6T1    WL0264    P      OHE Backhaul Co
     C                     MOVELWYV7T1    WL0265    P      OHE Backhaul Ch
     C                     MOVELWYV8T1    WL0266    P      OHE Transload C
     C                     MOVELWYV9T1    WL0267    P      OHE Pier Pass I
     C                     MOVELWYWAT1    WL0268    P      OHE Carrier Nm
     C                     MOVELWYWBT1    WL0269    P      OHE Appt Confir
     C                     MOVELWYWCT1    WL0270    P      OHE Backhaul Co
     C                     MOVELWYWDT1    WL0271    P      Letter of Credi
     C                     Z-ADDWYQJNY    WL0272           OHE Backhaul Re
     C                     Z-ADDWYQKNY    WL0273           LD Stop/Drop
     C                     Z-ADDWYQLNY    WL0274           OHE Unused Numb
     C                     Z-ADDWYP8NY    WL0275           OHE Pier Pass F
     C                     Z-ADDWYP9NY    WL0276           OHE Port Check
     C                     Z-ADDWYQANY    WL0277           OHE Port Cut Ti
     C                     Z-ADDWYQCNY    WL0278           OHE Backhaul Tr
     C                     Z-ADDWYQDNY    WL0279           OHE Load Sched
     C                     Z-ADDWYQENY    WL0280           Original Appoin
     C                     Z-ADDWYQFNY    WL0281           Original Appoin
     C                     Z-ADDWYQGNY    WL0282           OHE PowerPro Lo
     C                     Z-ADDWYQHNY    WL0283           OHE PowerPro Lo
     C                     Z-ADDWYQINY    WL0284           OHE Unused Nume
     C                     Z-ADDWYQMNY    WL0285           OHE Orig ABS Fr
     C                     MOVELWYMYU1    WL0286    P      OHE Genset Numb
     C                     MOVELWYJXSC    WL0287    P      OHE Email BOL/S
     C                     MOVELWYJYSC    WL0288    P      OHE EDI Order A
     C                     MOVELWYJZSC    WL0289    P      OHE Unused Stat
     C                     MOVELWYJ0SC    WL0290    P      OHE Unused Stat
     C                     MOVELWYMZU1    WL0291    P      OHE Unused Text
     C                     MOVELWYM0U1    WL0292    P      OHE Unused Text
     C                     MOVELWYM1U1    WL0293    P      OHE Customer Ve
     C                     MOVELWYM2U1    WL0294    P      OHE Unused Text
     C                     MOVELWYM3U1    WL0295    P      OHE Unused Text
     C                     Z-ADDWYW5DT    WL0296           OHE Unused Date
     C                     Z-ADDWYW6DT    WL0297           OHE Unused Date
     C                     MOVELWYUVST    WL0298    P      EDI Status 1
     C                     MOVELWYUWST    WL0299    P      EDI Status 2
     C                     MOVELWYUXST    WL0300    P      EDI Status 3
     C                     MOVELWYVSST    WL0301    P      Record Status
     C                     Z-ADDWYAATM    WL0302           Job Time
     C                     MOVELWYAYNA    WL0303    P      User Id
     C                     MOVELWYA0NA    WL0304    P      Job Name
     C                     Z-ADDWYAXDT    WL0305           Job Date
     C                     EXSR TKCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * CHG Order Header Exten CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0211    TAAIC3           Company Number
     C                     Z-ADDWL0212    TAC4NB           Order Number
      *
     C           KLCHTK    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
     C           KLCHTK    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Existing OHE       CR - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0211    WL0306           Company Number
     C                     Z-ADDWL0212    WL0307           Order Number
     C                     Z-ADDWL0213    WL0308           Load ID
     C                     Z-ADDWL0214    WL0309           Stop/Drop Seque
     C                     MOVELWL0215    WL0310    P      Shipping Line
     C                     MOVELWL0216    WL0311    P      Port Delv Termi
     C                     MOVELWL0217    WL0312    P      OHE City
     C                     MOVELWL0218    WL0313    P      OHE Vessel/Airl
     C                     MOVELWL0219    WL0314    P      OHE Voyage/Flig
     C                     MOVELWL0220    WL0315    P      OHE Booking Num
     C                     MOVELWL0221    WL0316    P      OHE Discharge P
     C                     Z-ADDWL0222    WL0317           OHE Sail/Flight
     C                     Z-ADDWL0223    WL0318           OHE Port Cut Da
     C                     Z-ADDWL0224    WL0319           OHE Arrival Dat
     C                     MOVELWL0225    WL0320    P      OHE Late Delive
     C                     MOVELWL0226    WL0321    P      OHE Ship Status
     C                     MOVELWL0227    WL0322    P      OHE Container N
     C                     MOVELWL0228    WL0323    P      OHE Comment 1
     C                     MOVELWL0229    WL0324    P      OHE Comment 2
     C                     Z-ADDWL0230    WL0325           OHE Unused Numb
     C                     Z-ADDWL0231    WL0326           OHE Unused Numb
     C                     Z-ADDWL0232    WL0327           OHE Unused Numb
     C                     Z-ADDWL0233    WL0328           OHE Unused Numb
     C                     Z-ADDWL0234    WL0329           OHE HPB RIN Equ
     C                     Z-ADDWL0235    WL0330           OHE HPB RIN Pri
     C                     Z-ADDWL0236    WL0331           Transload Termi
     C                     Z-ADDWL0237    WL0332           OHE Est Arrv at
     C                     Z-ADDWL0238    WL0333           OHE Backhaul ET
     C                     Z-ADDWL0239    WL0334           OHE Port/Pier P
     C                     Z-ADDWL0240    WL0335           OHE Actual Ship
     C                     MOVELWL0241    WL0336    P      OHE Carrier SCA
     C                     MOVELWL0242    WL0337    P      OHE Spot Buy
     C                     MOVELWL0243    WL0338    P      OHE PO ACK Flag
     C                     MOVELWL0244    WL0339    P      OHE Override Ty
     C                     MOVELWL0245    WL0340    P      OHE Backhaul St
     C                     MOVELWL0246    WL0341    P      OHE Backhaul ET
     C                     MOVELWL0247    WL0342    P      OHE Load Haul T
     C                     MOVELWL0248    WL0343    P      OHE Backhaul Ca
     C                     MOVELWL0249    WL0344    P      OHE Bookings Co
     C                     MOVELWL0250    WL0345    P      OHE EDI Error R
     C                     MOVELWL0251    WL0346    P      OHE EDI Error R
     C                     Z-ADDWL0252    WL0347           HPB COA Batch N
     C                     MOVELWL0253    WL0348    P      Delivery P.O. N
     C                     MOVELWL0254    WL0349    P      OHE Intended fo
     C                     MOVELWL0255    WL0350    P      OHE EDI 943 Act
     C                     MOVELWL0256    WL0351    P      OHE EDI 944 Act
     C                     MOVELWL0257    WL0352    P      OHE EDI 940 Act
     C                     MOVELWL0258    WL0353    P      OHE EDI 945 Act
     C                     MOVELWL0259    WL0354    P      OHE EDI 856 Act
     C                     MOVELWL0260    WL0355    P      OHE EDI 824 Act
     C                     MOVELWL0261    WL0356    P      OHE Transload S
     C                     MOVELWL0262    WL0357    P      OHE Abs Rate Ov
     C                     MOVELWL0263    WL0358    P      OHE Appt Confir
     C                     MOVELWL0264    WL0359    P      OHE Backhaul Co
     C                     MOVELWL0265    WL0360    P      OHE Backhaul Ch
     C                     MOVELWL0266    WL0361    P      OHE Transload C
     C                     MOVELWL0267    WL0362    P      OHE Pier Pass I
     C                     MOVELWL0268    WL0363    P      OHE Carrier Nm
     C                     MOVELWL0269    WL0364    P      OHE Appt Confir
     C                     MOVELWL0270    WL0365    P      OHE Backhaul Co
     C                     MOVELWL0271    WL0366    P      Letter of Credi
     C                     Z-ADDWL0272    WL0367           OHE Backhaul Re
     C                     Z-ADDWL0273    WL0368           LD Stop/Drop
     C                     Z-ADDWL0274    WL0369           OHE Unused Numb
     C                     Z-ADDWL0275    WL0370           OHE Pier Pass F
     C                     Z-ADDWL0276    WL0371           OHE Port Check
     C                     Z-ADDWL0277    WL0372           OHE Port Cut Ti
     C                     Z-ADDWL0278    WL0373           OHE Backhaul Tr
     C                     Z-ADDWL0279    WL0374           OHE Load Sched
     C                     Z-ADDWL0280    WL0375           Original Appoin
     C                     Z-ADDWL0281    WL0376           Original Appoin
     C                     Z-ADDWL0282    WL0377           OHE PowerPro Lo
     C                     Z-ADDWL0283    WL0378           OHE PowerPro Lo
     C                     Z-ADDWL0284    WL0379           OHE Unused Nume
     C                     Z-ADDWL0285    WL0380           OHE Orig ABS Fr
     C                     MOVELWL0286    WL0381    P      OHE Genset Numb
     C                     MOVELWL0287    WL0382    P      OHE Email BOL/S
     C                     MOVELWL0288    WL0383    P      OHE EDI Order A
     C                     MOVELWL0289    WL0384    P      OHE Unused Stat
     C                     MOVELWL0290    WL0385    P      OHE Unused Stat
     C                     MOVELWL0291    WL0386    P      OHE Unused Text
     C                     MOVELWL0292    WL0387    P      OHE Unused Text
     C                     MOVELWL0293    WL0388    P      OHE Customer Ve
     C                     MOVELWL0294    WL0389    P      OHE Unused Text
     C                     MOVELWL0295    WL0390    P      OHE Unused Text
     C                     Z-ADDWL0296    WL0391           OHE Unused Date
     C                     Z-ADDWL0297    WL0392           OHE Unused Date
     C                     MOVELWL0298    WL0393    P      EDI Status 1
     C                     MOVELWL0299    WL0394    P      EDI Status 2
     C                     MOVELWL0300    WL0395    P      EDI Status 3
     C                     MOVELWL0301    WL0396    P      Record Status
     C                     Z-ADDWL0302    WL0397           Job Time
     C                     MOVELWL0303    WL0398    P      User Id
     C                     MOVELWL0304    WL0399    P      Job Name
     C                     Z-ADDWL0305    WL0400           Job Date
     C                     EXSR TLCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YERDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0213    TARMNB           Load ID
     C                     Z-ADDWL0214    TARUNB           Stop/Drop Seque
     C                     MOVELWL0215    TAXACD    P      Shipping Line
     C                     MOVELWL0216    TAOANA    P      Port Delv Termi
     C                     MOVELWL0217    TAHBAA    P      OHE City
     C                     MOVELWL0218    TAJ0T1    P      OHE Vessel/Airl
     C                     MOVELWL0219    TAGENY    P      OHE Voyage/Flig
     C                     MOVELWL0220    TAJ1T1    P      OHE Booking Num
     C                     MOVELWL0221    TAHCAA    P      OHE Discharge P
     C                     Z-ADDWL0222    TAQWDT           OHE Sail/Flight
     C                     Z-ADDWL0223    TAQXDT           OHE Port Cut Da
     C                     Z-ADDWL0224    TAQYDT           OHE Arrival Dat
     C                     MOVELWL0225    TAHDAA    P      OHE Late Delive
     C                     MOVELWL0226    TACCTX    P      OHE Ship Status
     C                     MOVELWL0227    TAJ2T1    P      OHE Container N
     C                     MOVELWL0228    TARLNA    P      OHE Comment 1
     C                     MOVELWL0229    TARMNA    P      OHE Comment 2
     C                     Z-ADDWL0230    TAGINY           OHE Unused Numb
     C                     Z-ADDWL0231    TAGFNY           OHE Unused Numb
     C                     Z-ADDWL0232    TAGGNY           OHE Unused Numb
     C                     Z-ADDWL0233    TAGHNY           OHE Unused Numb
     C                     Z-ADDWL0234    TAHEVL           OHE HPB RIN Equ
     C                     Z-ADDWL0235    TAHFVL           OHE HPB RIN Pri
     C                     Z-ADDWL0236    TAHGVL           Transload Termi
     C                     Z-ADDWL0237    TAQZDT           OHE Est Arrv at
     C                     Z-ADDWL0238    TAQ0DT           OHE Backhaul ET
     C                     Z-ADDWL0239    TAQ1DT           OHE Port/Pier P
     C                     Z-ADDWL0240    TAQ2DT           OHE Actual Ship
     C                     MOVELWL0241    TAC2TX    P      OHE Carrier SCA
     C                     MOVELWL0242    TAC3TX    P      OHE Spot Buy
     C                     MOVELWL0243    TAC6TX    P      OHE PO ACK Flag
     C                     MOVELWL0244    TACHTX    P      OHE Override Ty
     C                     MOVELWL0245    TACITX    P      OHE Backhaul St
     C                     MOVELWL0246    TACLTX    P      OHE Backhaul ET
     C                     MOVELWL0247    TAB4TX    P      OHE Load Haul T
     C                     MOVELWL0248    TACUTX    P      OHE Backhaul Ca
     C                     MOVELWL0249    TACVTX    P      OHE Bookings Co
     C                     MOVELWL0250    TAB9TX    P      OHE EDI Error R
     C                     MOVELWL0251    TAJWSC    P      OHE EDI Error R
     C                     Z-ADDWL0252    TAITNY           HPB COA Batch N
     C                     MOVELWL0253    TALMT1    P      Delivery P.O. N
     C                     MOVELWL0254    TALWAA    P      OHE Intended fo
     C                     MOVELWL0255    TAFVST    P      OHE EDI 943 Act
     C                     MOVELWL0256    TAF0ST    P      OHE EDI 944 Act
     C                     MOVELWL0257    TAF2ST    P      OHE EDI 940 Act
     C                     MOVELWL0258    TAF3ST    P      OHE EDI 945 Act
     C                     MOVELWL0259    TAJUSC    P      OHE EDI 856 Act
     C                     MOVELWL0260    TAJVSC    P      OHE EDI 824 Act
     C                     MOVELWL0261    TAV3T1    P      OHE Transload S
     C                     MOVELWL0262    TAV4T1    P      OHE Abs Rate Ov
     C                     MOVELWL0263    TAV5T1    P      OHE Appt Confir
     C                     MOVELWL0264    TAV6T1    P      OHE Backhaul Co
     C                     MOVELWL0265    TAV7T1    P      OHE Backhaul Ch
     C                     MOVELWL0266    TAV8T1    P      OHE Transload C
     C                     MOVELWL0267    TAV9T1    P      OHE Pier Pass I
     C                     MOVELWL0268    TAWAT1    P      OHE Carrier Nm
     C                     MOVELWL0269    TAWBT1    P      OHE Appt Confir
     C                     MOVELWL0270    TAWCT1    P      OHE Backhaul Co
     C                     MOVELWL0271    TAWDT1    P      Letter of Credi
     C                     Z-ADDWL0272    TAQJNY           OHE Backhaul Re
     C                     Z-ADDWL0273    TAQKNY           LD Stop/Drop
     C                     Z-ADDWL0274    TAQLNY           OHE Unused Numb
     C                     Z-ADDWL0275    TAP8NY           OHE Pier Pass F
     C                     Z-ADDWL0276    TAP9NY           OHE Port Check
     C                     Z-ADDWL0277    TAQANY           OHE Port Cut Ti
     C                     Z-ADDWL0278    TAQCNY           OHE Backhaul Tr
     C                     Z-ADDWL0279    TAQDNY           OHE Load Sched
     C                     Z-ADDWL0280    TAQENY           Original Appoin
     C                     Z-ADDWL0281    TAQFNY           Original Appoin
     C                     Z-ADDWL0282    TAQGNY           OHE PowerPro Lo
     C                     Z-ADDWL0283    TAQHNY           OHE PowerPro Lo
     C                     Z-ADDWL0284    TAQINY           OHE Unused Nume
     C                     Z-ADDWL0285    TAQMNY           OHE Orig ABS Fr
     C                     MOVELWL0286    TAMYU1    P      OHE Genset Numb
     C                     MOVELWL0287    TAJXSC    P      OHE Email BOL/S
     C                     MOVELWL0288    TAJYSC    P      OHE EDI Order A
     C                     MOVELWL0289    TAJZSC    P      OHE Unused Stat
     C                     MOVELWL0290    TAJ0SC    P      OHE Unused Stat
     C                     MOVELWL0291    TAMZU1    P      OHE Unused Text
     C                     MOVELWL0292    TAM0U1    P      OHE Unused Text
     C                     MOVELWL0293    TAM1U1    P      OHE Customer Ve
     C                     MOVELWL0294    TAM2U1    P      OHE Unused Text
     C                     MOVELWL0295    TAM3U1    P      OHE Unused Text
     C                     Z-ADDWL0296    TAW5DT           OHE Unused Date
     C                     Z-ADDWL0297    TAW6DT           OHE Unused Date
     C                     MOVELWL0298    TAUVST    P      EDI Status 1
     C                     MOVELWL0299    TAUWST    P      EDI Status 2
     C                     MOVELWL0300    TAUXST    P      EDI Status 3
     C                     MOVELWL0301    TAVSST    P      Record Status
     C                     Z-ADDWL0302    TAAATM           Job Time
     C                     MOVELWL0303    TAAYNA    P      User Id
     C                     MOVELWL0304    TAA0NA    P      Job Name
     C                     Z-ADDWL0305    TAAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     MOVEL##USR     TAAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWL0306    TAAIC3           Company Number
     C                     Z-ADDWL0307    TAC4NB           Order Number
     C                     Z-ADDWL0308    TARMNB           Load ID
     C                     Z-ADDWL0309    TARUNB           Stop/Drop Seque
     C                     MOVELWL0310    TAXACD           Shipping Line
     C                     MOVELWL0311    TAOANA           Port Delv Termi
     C                     MOVELWL0312    TAHBAA           OHE City
     C                     MOVELWL0313    TAJ0T1           OHE Vessel/Airl
     C                     MOVELWL0314    TAGENY           OHE Voyage/Flig
     C                     MOVELWL0315    TAJ1T1           OHE Booking Num
     C                     MOVELWL0316    TAHCAA           OHE Discharge P
     C                     Z-ADDWL0317    TAQWDT           OHE Sail/Flight
     C                     Z-ADDWL0318    TAQXDT           OHE Port Cut Da
     C                     Z-ADDWL0319    TAQYDT           OHE Arrival Dat
     C                     MOVELWL0320    TAHDAA           OHE Late Delive
     C                     MOVELWL0321    TACCTX           OHE Ship Status
     C                     MOVELWL0322    TAJ2T1           OHE Container N
     C                     MOVELWL0323    TARLNA           OHE Comment 1
     C                     MOVELWL0324    TARMNA           OHE Comment 2
     C                     Z-ADDWL0325    TAGINY           OHE Unused Numb
     C                     Z-ADDWL0326    TAGFNY           OHE Unused Numb
     C                     Z-ADDWL0327    TAGGNY           OHE Unused Numb
     C                     Z-ADDWL0328    TAGHNY           OHE Unused Numb
     C                     Z-ADDWL0329    TAHEVL           OHE HPB RIN Equ
     C                     Z-ADDWL0330    TAHFVL           OHE HPB RIN Pri
     C                     Z-ADDWL0331    TAHGVL           Transload Termi
     C                     Z-ADDWL0332    TAQZDT           OHE Est Arrv at
     C                     Z-ADDWL0333    TAQ0DT           OHE Backhaul ET
     C                     Z-ADDWL0334    TAQ1DT           OHE Port/Pier P
     C                     Z-ADDWL0335    TAQ2DT           OHE Actual Ship
     C                     MOVELWL0336    TAC2TX           OHE Carrier SCA
     C                     MOVELWL0337    TAC3TX           OHE Spot Buy
     C                     MOVELWL0338    TAC6TX           OHE PO ACK Flag
     C                     MOVELWL0339    TACHTX           OHE Override Ty
     C                     MOVELWL0340    TACITX           OHE Backhaul St
     C                     MOVELWL0341    TACLTX           OHE Backhaul ET
     C                     MOVELWL0342    TAB4TX           OHE Load Haul T
     C                     MOVELWL0343    TACUTX           OHE Backhaul Ca
     C                     MOVELWL0344    TACVTX           OHE Bookings Co
     C                     MOVELWL0345    TAB9TX           OHE EDI Error R
     C                     MOVELWL0346    TAJWSC           OHE EDI Error R
     C                     Z-ADDWL0347    TAITNY           HPB COA Batch N
     C                     MOVELWL0348    TALMT1           Delivery P.O. N
     C                     MOVELWL0349    TALWAA           OHE Intended fo
     C                     MOVELWL0350    TAFVST           OHE EDI 943 Act
     C                     MOVELWL0351    TAF0ST           OHE EDI 944 Act
     C                     MOVELWL0352    TAF2ST           OHE EDI 940 Act
     C                     MOVELWL0353    TAF3ST           OHE EDI 945 Act
     C                     MOVELWL0354    TAJUSC           OHE EDI 856 Act
     C                     MOVELWL0355    TAJVSC           OHE EDI 824 Act
     C                     MOVELWL0356    TAV3T1           OHE Transload S
     C                     MOVELWL0357    TAV4T1           OHE Abs Rate Ov
     C                     MOVELWL0358    TAV5T1           OHE Appt Confir
     C                     MOVELWL0359    TAV6T1           OHE Backhaul Co
     C                     MOVELWL0360    TAV7T1           OHE Backhaul Ch
     C                     MOVELWL0361    TAV8T1           OHE Transload C
     C                     MOVELWL0362    TAV9T1           OHE Pier Pass I
     C                     MOVELWL0363    TAWAT1           OHE Carrier Nm
     C                     MOVELWL0364    TAWBT1           OHE Appt Confir
     C                     MOVELWL0365    TAWCT1           OHE Backhaul Co
     C                     MOVELWL0366    TAWDT1           Letter of Credi
     C                     Z-ADDWL0367    TAQJNY           OHE Backhaul Re
     C                     Z-ADDWL0368    TAQKNY           LD Stop/Drop
     C                     Z-ADDWL0369    TAQLNY           OHE Unused Numb
     C                     Z-ADDWL0370    TAP8NY           OHE Pier Pass F
     C                     Z-ADDWL0371    TAP9NY           OHE Port Check
     C                     Z-ADDWL0372    TAQANY           OHE Port Cut Ti
     C                     Z-ADDWL0373    TAQCNY           OHE Backhaul Tr
     C                     Z-ADDWL0374    TAQDNY           OHE Load Sched
     C                     Z-ADDWL0375    TAQENY           Original Appoin
     C                     Z-ADDWL0376    TAQFNY           Original Appoin
     C                     Z-ADDWL0377    TAQGNY           OHE PowerPro Lo
     C                     Z-ADDWL0378    TAQHNY           OHE PowerPro Lo
     C                     Z-ADDWL0379    TAQINY           OHE Unused Nume
     C                     Z-ADDWL0380    TAQMNY           OHE Orig ABS Fr
     C                     MOVELWL0381    TAMYU1           OHE Genset Numb
     C                     MOVELWL0382    TAJXSC           OHE Email BOL/S
     C                     MOVELWL0383    TAJYSC           OHE EDI Order A
     C                     MOVELWL0384    TAJZSC           OHE Unused Stat
     C                     MOVELWL0385    TAJ0SC           OHE Unused Stat
     C                     MOVELWL0386    TAMZU1           OHE Unused Text
     C                     MOVELWL0387    TAM0U1           OHE Unused Text
     C                     MOVELWL0388    TAM1U1           OHE Customer Ve
     C                     MOVELWL0389    TAM2U1           OHE Unused Text
     C                     MOVELWL0390    TAM3U1           OHE Unused Text
     C                     Z-ADDWL0391    TAW5DT           OHE Unused Date
     C                     Z-ADDWL0392    TAW6DT           OHE Unused Date
     C                     MOVELWL0393    TAUVST           EDI Status 1
     C                     MOVELWL0394    TAUWST           EDI Status 2
     C                     MOVELWL0395    TAUXST           EDI Status 3
     C                     MOVELWL0396    TAVSST           Record Status
     C                     Z-ADDWL0397    TAAATM           Job Time
     C                     MOVELWL0398    TAAYNA           User Id
     C                     MOVELWL0399    TAA0NA           Job Name
     C                     Z-ADDWL0400    TAAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     MOVEL##USR     TAAYNA           User Id
     C           KLCRTL    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRTL    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMDLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0401    TBRMNB           Load ID
     C                     Z-ADDWL0402    TBRUNB           Stop/Drop Seque
      *
     C           KLDLTM    KLIST
     C                     KFLD           TBRMNB           Load ID
     C                     KFLD           TBRUNB           Stop/Drop Seque
     C           KLDLTM    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * CHG Orig Appt Dt/Tm   CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0179  70       Load ID
     C                     Z-ADD*ZERO     WN0180  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0181  3        Shipping Line
     C                     MOVEL*BLANK    WN0182 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0183 25        OHE City
     C                     MOVEL*BLANK    WN0184 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0185 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0186 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0187 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0188  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0189  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0190  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0191  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0192  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0193 12        OHE Container N
     C                     MOVEL*BLANK    WN0194 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0195 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0196 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0197 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0198 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0199 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0200 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0201 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0202 112       Transload Termi
     C                     Z-ADD*ZERO     WN0203  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0204  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0205  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0206  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0207  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0208  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0209  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0210  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0211  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0212  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0213  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0214  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0215  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0216  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0217  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0218  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0219 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0220  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0221  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0222  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0223  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0224  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0225  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0226  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0227 10        OHE Transload S
     C                     MOVEL*BLANK    WN0228 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0229 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0230 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0231 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0232 15        OHE Transload C
     C                     MOVEL*BLANK    WN0233 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0234 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0235 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0236 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0237 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0238  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0239  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0240  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0241  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0242  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0243  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0244  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0245  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0246  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0247  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0248  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0249  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0250 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0251  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0252  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0253  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0254  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0255  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0256  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0257 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0258 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0259 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0260  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0261  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0262  1        EDI Status 1
     C                     MOVEL*BLANK    WN0263  1        EDI Status 2
     C                     MOVEL*BLANK    WN0264  1        EDI Status 3
     C                     MOVEL*BLANK    WN0265  1        Record Status
     C                     Z-ADD*ZERO     WN0266  60       Job Time
     C                     MOVEL*BLANK    WN0267 10        User Id
     C                     MOVEL*BLANK    WN0268 10        Job Name
     C                     Z-ADD*ZERO     WN0269  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0403    TAAIC3           Company Number
     C                     Z-ADDWL0404    TAC4NB           Order Number
      *
     C           KLCHTN    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
     C           KLCHTN    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YFRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0405    TAQENY           Original Appoin
     C                     Z-ADDWL0406    TAQFNY           Original Appoin
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     MOVEL##USR     TAAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * CRT Load Detail        CR - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0270  1        EDI Status 1
     C                     MOVEL*BLANK    WN0271  1        EDI Status 2
     C                     MOVEL*BLANK    WN0272  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0273  60       Job Time
     C                     MOVEL*BLANK    WN0274 10        User Id
     C                     MOVEL*BLANK    WN0275 10        Job Name
     C                     Z-ADD*ZERO     WN0276  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FLCPBM
     C                     Z-ADDWETMLD    TBRMNB           Load ID
     C                     Z-ADDWN0055    TBRUNB           Stop/Drop Seque
     C                     Z-ADDWEEVSQ    TBRVNB           Stop/Drop
     C                     MOVEL*BLANK    TBDQTX           Comments for Pi
     C                     Z-ADDWEHFNB    TBRWNB           Miles to next s
     C                     Z-ADD*ZERO     TBRXNB           Freight Charge
     C                     Z-ADD*ZERO     TBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     TBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     TBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     TBR1NB           Rated Freight
     C                     Z-ADDYL0057    TBAIC3           Company Number
     C                     Z-ADDWETMOR    TBC4NB           Order Number
     C                     MOVEL'O'       TBVCST           Ship Status
     C                     Z-ADD*ZERO     TBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     TBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     TBKFDT           Appointment Con
     C                     Z-ADD*ZERO     TBACTM           Appointment Con
     C                     MOVEL*BLANK    TBK5TX           Confirmation Ma
     C                     MOVEL*BLANK    TBW5CD           Confirmation Nu
     C                     Z-ADDYL0063    TBEJDT           Actual Delivery
     C                     Z-ADDYL0069    TBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     TBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     TBATTM           Scheduled Deliv
     C                     Z-ADDWL0157    TBHDDT           Deadline Depart
     C                     Z-ADDYL0070    TBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     TBKKDT           On Yard Date
     C                     Z-ADD*ZERO     TBAVTM           On Yard Time
     C                     Z-ADD*ZERO     TBZ4NB           MPC Number
     C                     MOVELYL0071    TBY7ST           Load Dtl On Tim
     C                     MOVELYL0072    TBY2ST           On Time Add'l R
     C                     MOVEL*BLANK    TBWHTX           Seal Nbr 1
     C                     MOVEL*BLANK    TBWITX           Seal Nbr 2
     C                     MOVEL*BLANK    TBWJTX           Seal Nbr 3
     C                     MOVEL*BLANK    TBWKTX           Seal Nbr 4
     C                     MOVEL*BLANK    TBWLTX           Seal Nbr 5
     C                     Z-ADDYL0062    TBN7DT           LD Carrier Appt
     C                     Z-ADDYL0064    TBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     TBN9DT           LD Unused Date
     C                     Z-ADDYL0068    TBB3TM           LD Carrier Appt
     C                     Z-ADDYL0073    TBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     TBB5TM           LD Unused Time
     C                     MOVEL*BLANK    TBIASX           Miles Error Sts
     C                     MOVELYL0074    TBIBSX           LD Unused Sts 2
     C                     MOVELYL0075    TBICSX           HPB Transload S
     C                     MOVEL*BLANK    TBWVTX           LD Cst Svc Trac
     C                     MOVELWL0155    TBWWTX           Carrier Ref PRO
     C                     MOVELWVP5U1    TBWXTX           Cust Assigned A
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
     C           KLCRTO    KLIST
     C                     KFLD           TBRMNB           Load ID
     C                     KFLD           TBRUNB           Stop/Drop Seque
      * Check for duplicate primary key
     C           KLCRTO    SETLL@FLCPBM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1193' W0RTN   7
      * Send message 'Load Detail            EX'
     C                     MOVEL'USR1193' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@FLCPBM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Crt Load Plan Event    RT - Order Events  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0277  50       Event Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0277           Event Number
      * RTV Latest Event/Date  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0407           Company Number
     C                     Z-ADDWETMOR    WL0408           Order Number
     C                     Z-ADDWN0277    WL0409           Event Number
     C                     Z-ADDWUNFNN    WL0413           Ship To Custome
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0409    WN0277           Event Number
     C                     MOVELWL0410    WUG0TX    P      Event Code
     C                     Z-ADDWL0411    WUNFNN           Event Date
     C                     MOVELWL0412    WUG0TX    P      Activity Hold
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTP01           Company Number
     C           *LIKE     DEFN TCC4NB    WQTP02           Order Number
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
      * Setup key
     C                     Z-ADDYL0057    WQTP01           Company Number
     C                     Z-ADDWETMOR    WQTP02           Order Number
      * Establish starting position
     C           KRSTP     SETLL@EYCPY2                    *
     C           KRSTP     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0414           Company Number
     C                     Z-ADDWETMOR    WL0415           Order Number
     C                     Z-ADDWUQ2NB    WL0416           Event Number
     C                     MOVEL'01'      WL0417    P      Event Code
     C                     Z-ADDYL0057    WL0418           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0419           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0420           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0421           Event Date
     C                     MOVEL'Y'       WL0422    P      Activity Comple
     C                     MOVEL'N'       WL0423    P      Activity Hold
     C                     MOVEL'Y'       WL0424    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0425           Cross Event Ref
     C                     Z-ADD*ZERO     WL0426           Cross Event Ref
     C                     Z-ADD*ZERO     WL0427           Cross Event Ref
     C                     Z-ADD*ZERO     WL0428           Ship To Custome
     C                     EXSR TRCRRC
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0414           Company Number
     C                     Z-ADDWETMOR    WL0415           Order Number
     C                     Z-ADDWUQ2NB    WL0416           Event Number
     C                     MOVEL'02'      WL0417    P      Event Code
     C                     Z-ADDYL0057    WL0418           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0419           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0420           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0421           Event Date
     C                     MOVEL'Y'       WL0422    P      Activity Comple
     C                     MOVEL'N'       WL0423    P      Activity Hold
     C                     MOVEL'Y'       WL0424    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0425           Cross Event Ref
     C                     Z-ADD*ZERO     WL0426           Cross Event Ref
     C                     Z-ADD*ZERO     WL0427           Cross Event Ref
     C                     Z-ADD*ZERO     WL0428           Ship To Custome
     C                     EXSR TRCRRC
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0277           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTCAIC3    WL0414           Company Number
     C                     Z-ADDTCC4NB    WL0415           Order Number
     C                     Z-ADDWN0277    WL0416           Event Number
     C                     MOVEL'02'      WL0417    P      Event Code
     C                     Z-ADDTCAUC3    WL0418           Invoice/Memo Co
     C                     Z-ADDTCQ7NB    WL0419           Invoice/Memo Nu
     C                     MOVELTCOMST    WL0420    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0421           Event Date
     C                     MOVELTCONST    WL0422    P      Activity Comple
     C                     MOVELTCOOST    WL0423    P      Activity Hold
     C                     MOVELTCOPST    WL0424    P      Post Cash Compl
     C                     Z-ADDTCAWC3    WL0425           Cross Event Ref
     C                     Z-ADDTCQ8NB    WL0426           Cross Event Ref
     C                     Z-ADDTCQ9NB    WL0427           Cross Event Ref
     C                     Z-ADDTCBKC7    WL0428           Ship To Custome
     C                     EXSR TRCRRC
     C                     GOTO TPEXIT                     *QUIT
     C           KRSTP     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN TDC4NB    WQTQ02           Order Number
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Order Number
      * Setup key
     C                     Z-ADDWL0407    WQTQ01           Company Number
     C                     Z-ADDWL0408    WQTQ02           Order Number
      * Establish starting position
     C           KRSTQ     SETLL@EYCPZR                    *
     C           KRSTQ     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTDQ2NB    WL0409           Event Number
     C                     MOVELTDJPCD    WL0410           Event Code
     C                     Z-ADDTDD2DT    WL0411           Event Date
     C                     MOVELTDOOST    WL0412           Activity Hold
     C           KRSTQ     READE@EYCPZR                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0278  1        EDI Status 1
     C                     MOVEL*BLANK    WN0279  1        EDI Status 2
     C                     MOVEL*BLANK    WN0280  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0281  60       Job Time
     C                     MOVEL*BLANK    WN0282 10        User Id
     C                     MOVEL*BLANK    WN0283 10        Job Name
     C                     Z-ADD*ZERO     WN0284  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0414    TEAIC3           Company Number
     C                     Z-ADDWL0415    TEC4NB           Order Number
     C                     Z-ADDWL0416    TEQ2NB           Event Number
     C                     MOVELWL0417    TEJPCD           Event Code
     C                     Z-ADDWL0418    TEAUC3           Invoice/Memo Co
     C                     Z-ADDWL0419    TEQ7NB           Invoice/Memo Nu
     C                     MOVELWL0420    TEOMST           Invoice/Memo Su
     C                     Z-ADDWL0421    TED2DT           Event Date
     C                     MOVELWL0422    TEONST           Activity Comple
     C                     MOVELWL0423    TEOOST           Activity Hold
     C                     MOVELWL0424    TEOPST           Post Cash Compl
     C                     Z-ADDWL0425    TEAWC3           Cross Event Ref
     C                     Z-ADDWL0426    TEQ8NB           Cross Event Ref
     C                     Z-ADDWL0427    TEQ9NB           Cross Event Ref
     C                     Z-ADDWL0428    TEBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TEAATM           Job Time
     C                     MOVEL##USR     TEAYNA           User Id
     C                     MOVEL##JOB     TEA0NA           Job Name
     C                     Z-ADD##JDT     TEAXDT           Job Date
     C           KLCRTR    KLIST
     C                     KFLD           TEAIC3           Company Number
     C                     KFLD           TEC4NB           Order Number
     C                     KFLD           TEQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRTR    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCHRC    BEGSR
      *================================================================
      * Chg Load Info - TMS    CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0285  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0286  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0287  70       Ship To Custome
     C                     MOVEL*BLANK    WN0288 30        Ship To Name
     C                     MOVEL*BLANK    WN0289 30        Ship To Address
     C                     MOVEL*BLANK    WN0290 30        Ship To Address
     C                     MOVEL*BLANK    WN0291 30        Ship To Address
     C                     MOVEL*BLANK    WN0292 20        Ship To City
     C                     MOVEL*BLANK    WN0293  2        Ship To State C
     C                     MOVEL*BLANK    WN0294 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0295  70       Bill to Custome
     C                     MOVEL*BLANK    WN0296 30        Bill to Name
     C                     MOVEL*BLANK    WN0297 30        Bill to Address
     C                     MOVEL*BLANK    WN0298 30        Bill to Address
     C                     MOVEL*BLANK    WN0299 30        Bill to Address
     C                     MOVEL*BLANK    WN0300 20        Bill to City
     C                     MOVEL*BLANK    WN0301  2        Bill to State C
     C                     MOVEL*BLANK    WN0302 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0303 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0304  70       Order Date
     C                     Z-ADD*ZERO     WN0305  70       Requested Ship
     C                     Z-ADD*ZERO     WN0306  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0307  70       Cancel Date
     C                     MOVEL*BLANK    WN0308  2        Terms Code
     C                     MOVEL*BLANK    WN0309 40        Special Instruc
     C                     MOVEL*BLANK    WN0310 40        Special Instruc
     C                     MOVEL*BLANK    WN0311  1        Comment Print A
     C                     MOVEL*BLANK    WN0312  1        Comment Print I
     C                     MOVEL*BLANK    WN0313  1        Comment Print P
     C                     MOVEL*BLANK    WN0314  1        Comment Print S
     C                     MOVEL*BLANK    WN0315  3        Reason Code
     C                     MOVEL*BLANK    WN0316  1        Order in Use
     C                     MOVEL*BLANK    WN0317  1        Header Status
     C                     MOVEL*BLANK    WN0318  1        Header Status L
     C                     MOVEL*BLANK    WN0319  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0320  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0321 10        User Original E
     C                     Z-ADD*ZERO     WN0322  70       Date of Origina
     C                     Z-ADD*ZERO     WN0323 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0324 112       Order Weight To
     C                     MOVEL*BLANK    WN0325  1        Credit Hold
     C                     MOVEL*BLANK    WN0326  1        Production Hold
     C                     MOVEL*BLANK    WN0327  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0328  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0329  40       Requested Deliv
     C                     MOVEL*BLANK    WN0330  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0331 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0332  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0333 112       Rated Freight
     C                     MOVEL*BLANK    WN0334  1        LTL Flag
     C                     MOVEL*BLANK    WN0335  1        Price Audit
     C                     MOVEL*BLANK    WN0336  1        Price Status
     C                     MOVEL*BLANK    WN0337  2        Shipping Method
     C                     MOVEL*BLANK    WN0338  1        Export Status
     C                     MOVEL*BLANK    WN0339  1        Palletize
     C                     MOVEL*BLANK    WN0340  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0341  1        Slip Sheet
     C                     MOVEL*BLANK    WN0342  1        Age Code
     C                     Z-ADD*ZERO     WN0343  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0344  1        Load Type
     C                     Z-ADD*ZERO     WN0345  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0346  1        Load Plan Order
     C                     MOVEL*BLANK    WN0347  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0348  70       Resell Referenc
     C                     MOVEL*BLANK    WN0349 30        Special Comment
     C                     MOVEL*BLANK    WN0350 30        Special Comment
     C                     MOVEL*BLANK    WN0351  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0352  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0353  2        Manager Level C
     C                     MOVEL*BLANK    WN0354  3        VP Level Code
     C                     Z-ADD*ZERO     WN0355  70       Attach to Order
     C                     MOVEL*BLANK    WN0356  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0357  70       Invoice Number
     C                     MOVEL*BLANK    WN0358  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0359  70       Invoice Date
     C                     MOVEL*BLANK    WN0360  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0361  1        Modified Flag
     C                     Z-ADD*ZERO     WN0362 112       A/R order Value
     C                     MOVEL*BLANK    WN0363  1        Billing Activit
     C                     MOVEL*BLANK    WN0364  1        Block Order Fla
     C                     MOVEL*BLANK    WN0365  1        Order Certifica
     C                     Z-ADD*ZERO     WN0366 112       Invoice Order V
     C                     MOVEL*BLANK    WN0367  1        Process Sts for
     C                     MOVEL*BLANK    WN0368  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0369  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0370  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0371  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0372  1        Email Cust On O
     C                     MOVEL*BLANK    WN0373  1        Order Emailed
     C                     MOVEL*BLANK    WN0374  1        Export Docs Go
     C                     MOVEL*BLANK    WN0375  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0376  1        Broker Order St
     C                     MOVEL*BLANK    WN0377  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0378  2        Order Requires
     C                     MOVEL*BLANK    WN0379  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0380  2        Export USDA App
     C                     MOVEL*BLANK    WN0381  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0382  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0383  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0384  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0385  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0386  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0387  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0388  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0389  60       Time of Origina
     C                     Z-ADD*ZERO     WN0390  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0391  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0392  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0393 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0394 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0395 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0396 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0397 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0398  70       Claim Number
     C                     MOVEL*BLANK    WN0399  1        EDI Status 1
     C                     MOVEL*BLANK    WN0400  1        EDI Status 2
     C                     MOVEL*BLANK    WN0401  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0402  60       Job Time
     C                     MOVEL*BLANK    WN0403 10        User Id
     C                     MOVEL*BLANK    WN0404 10        Job Name
     C                     Z-ADD*ZERO     WN0405  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDYL0057    WXAIC3           Company Number
     C                     Z-ADDWETMOR    WXC4NB           Order Number
      *
     C           KLCHTS    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C           KLCHTS    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YGRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0156    WXBZNA    P      Carrier Code
     C                     Z-ADDWETMLD    WXRMNB           Load ID
     C                     MOVELYL0059    WXJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWXAIC3    PAAIC3           Company Number
     C                     Z-ADDWXC4NB    PAC4NB           Order Number
     C                     MOVELWXJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWXANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWXBKC7    PABKC7           Ship To Custome
     C                     MOVELWXBRTX    PABRTX    P      Ship To Name
     C                     MOVELWXHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWXHONA    PAHONA    P      Ship To Address
     C                     MOVELWXHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWXHNNA    PAHNNA    P      Ship To City
     C                     MOVELWXDBCD    PADBCD    P      Ship To State C
     C                     MOVELWXCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWXB0C7    PAB0C7           Bill to Custome
     C                     MOVELWXAETX    PAAETX    P      Bill to Name
     C                     MOVELWXB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWXB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWXB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWXB2NA    PAB2NA    P      Bill to City
     C                     MOVELWXBHCD    PABHCD    P      Bill to State C
     C                     MOVELWXC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWXBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWXA0DT    PAA0DT           Order Date
     C                     Z-ADDWXA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWXGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWXACDT    PAACDT           Cancel Date
     C                     MOVELWXAQCD    PAAQCD    P      Terms Code
     C                     MOVELWXB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWXBYNA    PABYNA    P      Special Instruc
     C                     MOVELWXBZNA    PABZNA    P      Carrier Code
     C                     MOVELWXGTST    PAGTST    P      Comment Print A
     C                     MOVELWXGVST    PAGVST    P      Comment Print I
     C                     MOVELWXGUST    PAGUST    P      Comment Print P
     C                     MOVELWXQFST    PAQFST    P      Comment Print S
     C                     MOVELWXCQCD    PACQCD    P      Reason Code
     C                     MOVELWXGJST    PAGJST    P      Order in Use
     C                     MOVELWXGWST    PAGWST    P      Header Status
     C                     MOVELWXGXST    PAGXST    P      Header Status L
     C                     MOVELWXGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWXAODT    PAAODT           Scheduled Ship
     C                     MOVELWXAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWXCXDT    PACXDT           Date of Origina
     C                     Z-ADDWXJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWXA1WG    PAA1WG           Order Weight To
     C                     MOVELWXXIST    PAXIST    P      Credit Hold
     C                     MOVELWXXJST    PAXJST    P      Production Hold
     C                     MOVELWXXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWXEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWXAFTM    PAAFTM           Requested Deliv
     C                     MOVELWXE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWXE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWXRMNB    PARMNB           Load ID
     C                     Z-ADDWXTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWXR1NB    PAR1NB           Rated Freight
     C                     MOVELWXPJST    PAPJST    P      LTL Flag
     C                     MOVELWXU0ST    PAU0ST    P      Price Audit
     C                     MOVELWXU1ST    PAU1ST    P      Price Status
     C                     MOVELWXQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWXU2ST    PAU2ST    P      Export Status
     C                     MOVELWXVEST    PAVEST    P      Palletize
     C                     MOVELWXVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWXVGST    PAVGST    P      Slip Sheet
     C                     MOVELWXRPCD    PARPCD    P      Age Code
     C                     Z-ADDWXRNNB    PARNNB           Reefer Temperat
     C                     MOVELWXVDST    PAVDST    P      Load Type
     C                     Z-ADDWXATIN    PAATIN           Attach to Invoi
     C                     MOVELWXU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWXU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWXRSRN    PARSRN           Resell Referenc
     C                     MOVELWXMHNA    PAMHNA    P      Special Comment
     C                     MOVELWXMINA    PAMINA    P      Special Comment
     C                     MOVELWXWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWXR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWXBFCD    PABFCD    P      Manager Level C
     C                     MOVELWXQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWXT3NB    PAT3NB           Attach to Order
     C                     MOVELWXSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWXCONB    PACONB           Invoice Number
     C                     MOVELWXCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWXAWDT    PAAWDT           Invoice Date
     C                     MOVELWXJPCD    PAJPCD    P      Event Code
     C                     MOVELWXXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWXZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWXVRVA    PAVRVA           A/R order Value
     C                     MOVELWXOBST    PAOBST    P      Billing Activit
     C                     MOVELWXBCST    PABCST    P      Block Order Fla
     C                     MOVELWXBDST    PABDST    P      Order Certifica
     C                     Z-ADDWXB7VL    PAB7VL           Invoice Order V
     C                     MOVELWXGASX    PAGASX    P      Process Sts for
     C                     MOVELWXGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWXGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWXGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWXFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWXFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWXFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWXFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWXFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWXFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWXFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWXFUSX    PAFUSX    P      Order Requires
     C                     MOVELWXFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWXFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWXFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWXFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWXNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWXNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWXNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWXNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWXNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWXBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWXBQTM    PABQTM           Time of Origina
     C                     Z-ADDWXBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWXBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWXBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWXH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWXH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWXH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWXH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWXH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWXC0C7    PAC0C7           Claim Number
     C                     MOVELWXUVST    PAUVST    P      EDI Status 1
     C                     MOVELWXUWST    PAUWST    P      EDI Status 2
     C                     MOVELWXUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWXAATM    PAAATM           Job Time
     C                     MOVELWXAYNA    PAAYNA    P      User Id
     C                     MOVELWXA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWXAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQTT01           Company Number
     C           *LIKE     DEFN TFC4NB    WQTT02           Order Number
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           Company Number
     C                     KFLD           WQTT02           Order Number
      * Setup key
     C                     Z-ADDWL0429    WQTT01           Company Number
     C                     Z-ADDWL0430    WQTT02           Order Number
      * Establish starting position
     C           KRSTT     SETLL@BGWKL1                    *
     C           KRSTT     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR TUCHRC
     C           KRSTT     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0406  70       Item Code
     C                     MOVEL*BLANK    WN0407  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0408  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0409  70       Order Group Cod
     C                     MOVEL*BLANK    WN0410  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0411  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0412 112       Billing Detail
     C                     Z-ADD*ZERO     WN0413 112       Billing Detail
     C                     Z-ADD*ZERO     WN0414 112       Billing Detail
     C                     Z-ADD*ZERO     WN0415 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0416  1        Comment Print A
     C                     MOVEL*BLANK    WN0417  1        Comment Print I
     C                     MOVEL*BLANK    WN0418  1        Comment Print P
     C                     MOVEL*BLANK    WN0419  1        Comment Print S
     C                     Z-ADD*ZERO     WN0420 112       Extended Amount
     C                     Z-ADD*ZERO     WN0421  70       Market Pricing
     C                     MOVEL*BLANK    WN0422  3        Commodity Marke
     C                     MOVEL*BLANK    WN0423  3        Date Method Cod
     C                     MOVEL*BLANK    WN0424  3        Price Method Co
     C                     Z-ADD*ZERO     WN0425 114       Price Overage O
     C                     Z-ADD*ZERO     WN0426  70       Contract Number
     C                     MOVEL*BLANK    WN0427  1        Price Status
     C                     Z-ADD*ZERO     WN0428  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0429  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0430  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0431  1        Work Confirm St
     C                     MOVEL*BLANK    WN0432  1        Work Over/Short
     C                     MOVEL*BLANK    WN0433  1        OD Production P
     C                     MOVEL*BLANK    WN0434 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0435 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0436  1        Age Code
     C                     MOVEL*BLANK    WN0437  1        Palletize
     C                     MOVEL*BLANK    WN0438  1        Slip Sheet
     C                     MOVEL*BLANK    WN0439  1        Catch Weight St
     C                     MOVEL*BLANK    WN0440  1        Price Audit
     C                     MOVEL*BLANK    WN0441  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0442  1        Production Date
     C                     Z-ADD*ZERO     WN0443 112       Rated Freight
     C                     Z-ADD*ZERO     WN0444 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0445 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0446 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0447 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0448 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0449 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0450 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0451 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0452 114       Unit Price
     C                     Z-ADD*ZERO     WN0453 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0454 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0455 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0456 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0457  70       Requested Ship
     C                     Z-ADD*ZERO     WN0458  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0459  70       Actual Shipped
     C                     MOVEL*BLANK    WN0460  1        Affect Inventor
     C                     MOVEL*BLANK    WN0461  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0462  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0463  30       Item Structure
     C                     Z-ADD*ZERO     WN0464  30       Item Structure
     C                     Z-ADD*ZERO     WN0465  30       Item Structure
     C                     MOVEL*BLANK    WN0466  2        Item Level
     C                     MOVEL*BLANK    WN0467  2        Quality Level
     C                     MOVEL*BLANK    WN0468  2        Pricing Product
     C                     MOVEL*BLANK    WN0469  2        Season Product
     C                     Z-ADD*ZERO     WN0470  70       Date of Origina
     C                     MOVEL*BLANK    WN0471 10        User Profile Na
     C                     MOVEL*BLANK    WN0472  6        Country Code
     C                     MOVEL*BLANK    WN0473  2        Event Code
     C                     MOVEL*BLANK    WN0474  3        Reason Code
     C                     MOVEL*BLANK    WN0475  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0476  1        Modified Flag
     C                     MOVEL*BLANK    WN0477  1        Substituted Fla
     C                     MOVEL*BLANK    WN0478  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0479 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0480 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0481  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0482  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0483  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0484  1        Affect Commissi
     C                     MOVEL*BLANK    WN0485  1        Affect Pricing
     C                     MOVEL*BLANK    WN0486  1        Released by Use
     C                     MOVEL*BLANK    WN0487  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0488  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0489  3        Production Ware
     C                     MOVEL*BLANK    WN0490  3        OD Price Type
     C                     Z-ADD*ZERO     WN0491  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0492  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0493  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0494  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0495  60       Price Code
     C                     Z-ADD*ZERO     WN0496  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0497  60       Substitution Li
     C                     Z-ADD*ZERO     WN0498  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0499 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0500 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0501 112       OD Item Target
     C                     Z-ADD*ZERO     WN0502 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0503 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0504 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0505 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0506 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0507 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0508 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0509 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0510 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0511 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0512  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0513  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0514  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0515 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0516  40       Item Age Days
     C                     Z-ADD*ZERO     WN0517  70       Production Ovr
     C                     Z-ADD*ZERO     WN0518  70       Production Ovr
     C                     MOVEL*BLANK    WN0519  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0520  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0521  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0522  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0523  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0524  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0525  1        EDI Status 1
     C                     MOVEL*BLANK    WN0526  1        EDI Status 2
     C                     MOVEL*BLANK    WN0527  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0528  60       Job Time
     C                     MOVEL*BLANK    WN0529 10        User Id
     C                     MOVEL*BLANK    WN0530 10        Job Name
     C                     Z-ADD*ZERO     WN0531  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDTFAIC3    TGAIC3           Company Number
     C                     Z-ADDTFC4NB    TGC4NB           Order Number
     C                     Z-ADDTFDPNB    TGDPNB           Order Sequence
     C                     Z-ADDTFUENB    TGUENB           Order Secondary
      *
     C           KLCHTU    KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGC4NB           Order Number
     C                     KFLD           TGDPNB           Order Sequence
     C                     KFLD           TGUENB           Order Secondary
     C           KLCHTU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YHRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0431    TGNVDT           Deadline Depart
     C                     Z-ADDWL0432    TGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TGAATM           Job Time
     C                     MOVEL##USR     TGAYNA           User Id
     C                     MOVEL##JOB     TGA0NA           Job Name
     C                     Z-ADD##JDT     TGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV Chg TMS Load Flds RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYC4NB           Order Number
      * Setup key
     C                     Z-ADDYL0057    WYAIC3           Company Number
     C                     Z-ADDWETMOR    WYC4NB           Order Number
      * Establish starting position
     C           KRSTV     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * 07/24/19 DN R15161-Replaced Voyage w/ OHE Voyage/Flight & Booking
      *   Number w/ OHE Booking Number.
      * CRT Existing OHE       CR - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0306           Company Number
     C                     Z-ADDWETMOR    WL0307           Order Number
     C                     Z-ADDWETMLD    WL0308           Load ID
     C                     Z-ADD*ZERO     WL0309           Stop/Drop Seque
     C                     MOVEL*BLANK    WL0310           Shipping Line
     C                     MOVELWL0146    WL0311    P      Port Delv Termi
     C                     MOVELWL0149    WL0312    P      OHE City
     C                     MOVELWL0143    WL0313    P      OHE Vessel/Airl
     C                     MOVELYL0076    WL0314    P      OHE Voyage/Flig
     C                     MOVELWL0145    WL0315    P      OHE Booking Num
     C                     MOVELWL0149    WL0316    P      OHE Discharge P
     C                     Z-ADDYL0077    WL0317           OHE Sail/Flight
     C                     Z-ADD*ZERO     WL0318           OHE Port Cut Da
     C                     Z-ADDYL0078    WL0319           OHE Arrival Dat
     C                     MOVELWVVBAA    WL0320    P      OHE Late Delive
     C                     MOVEL'O'       WL0321    P      OHE Ship Status
     C                     MOVELWL0141    WL0322    P      OHE Container N
     C                     MOVEL*BLANK    WL0323           OHE Comment 1
     C                     MOVEL*BLANK    WL0324           OHE Comment 2
     C                     Z-ADD*ZERO     WL0325           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0326           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0327           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0328           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0329           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WL0330           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WL0331           Transload Termi
     C                     Z-ADD*ZERO     WL0332           OHE Est Arrv at
     C                     Z-ADD*ZERO     WL0333           OHE Backhaul ET
     C                     Z-ADD*ZERO     WL0334           OHE Port/Pier P
     C                     Z-ADD*ZERO     WL0335           OHE Actual Ship
     C                     MOVEL*BLANK    WL0336           OHE Carrier SCA
     C                     MOVELYL0080    WL0337    P      OHE Spot Buy
     C                     MOVELYL0081    WL0338    P      OHE PO ACK Flag
     C                     MOVELYL0082    WL0339    P      OHE Override Ty
     C                     MOVELYL0083    WL0340    P      OHE Backhaul St
     C                     MOVELYL0084    WL0341    P      OHE Backhaul ET
     C                     MOVELYL0079    WL0342    P      OHE Load Haul T
     C                     MOVELYL0085    WL0343    P      OHE Backhaul Ca
     C                     MOVELYL0086    WL0344    P      OHE Bookings Co
     C                     MOVELYL0087    WL0345    P      OHE EDI Error R
     C                     MOVELYL0088    WL0346    P      OHE EDI Error R
     C                     Z-ADD*ZERO     WL0347           HPB COA Batch N
     C                     MOVEL*BLANK    WL0348           Delivery P.O. N
     C                     MOVEL*BLANK    WL0349           OHE Intended fo
     C                     MOVELYL0089    WL0350    P      OHE EDI 943 Act
     C                     MOVELYL0090    WL0351    P      OHE EDI 944 Act
     C                     MOVELYL0091    WL0352    P      OHE EDI 940 Act
     C                     MOVELYL0092    WL0353    P      OHE EDI 945 Act
     C                     MOVELYL0093    WL0354    P      OHE EDI 856 Act
     C                     MOVELYL0094    WL0355    P      OHE EDI 824 Act
     C                     MOVEL*BLANK    WL0356           OHE Transload S
     C                     MOVEL*BLANK    WL0357           OHE Abs Rate Ov
     C                     MOVEL*BLANK    WL0358           OHE Appt Confir
     C                     MOVEL*BLANK    WL0359           OHE Backhaul Co
     C                     MOVEL*BLANK    WL0360           OHE Backhaul Ch
     C                     MOVEL*BLANK    WL0361           OHE Transload C
     C                     MOVEL*BLANK    WL0362           OHE Pier Pass I
     C                     MOVEL*BLANK    WL0363           OHE Carrier Nm
     C                     MOVEL*BLANK    WL0364           OHE Appt Confir
     C                     MOVEL*BLANK    WL0365           OHE Backhaul Co
     C                     MOVEL*BLANK    WL0366           Letter of Credi
     C                     Z-ADD*ZERO     WL0367           OHE Backhaul Re
     C                     Z-ADD*ZERO     WL0368           LD Stop/Drop
     C                     Z-ADD*ZERO     WL0369           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0370           OHE Pier Pass F
     C                     Z-ADD*ZERO     WL0371           OHE Port Check
     C                     Z-ADD*ZERO     WL0372           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WL0373           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WL0374           OHE Load Sched
     C                     Z-ADDYL0066    WL0375           Original Appoin
     C                     Z-ADDYL0067    WL0376           Original Appoin
     C                     Z-ADD*ZERO     WL0377           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WL0378           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WL0379           OHE Unused Nume
     C                     Z-ADD*ZERO     WL0380           OHE Orig ABS Fr
     C                     MOVEL*BLANK    WL0381           OHE Genset Numb
     C                     MOVELYL0095    WL0382    P      OHE Email BOL/S
     C                     MOVELYL0096    WL0383    P      OHE EDI Order A
     C                     MOVELYL0097    WL0384    P      OHE Unused Stat
     C                     MOVELYL0098    WL0385    P      OHE Unused Stat
     C                     MOVEL*BLANK    WL0386           OHE Unused Text
     C                     MOVEL*BLANK    WL0387           OHE Unused Text
     C                     MOVEL*BLANK    WL0388           OHE Customer Ve
     C                     MOVEL*BLANK    WL0389           OHE Unused Text
     C                     MOVEL*BLANK    WL0390           OHE Unused Text
     C                     Z-ADD*ZERO     WL0391           OHE Unused Date
     C                     Z-ADD*ZERO     WL0392           OHE Unused Date
     C                     MOVELYL0099    WL0393    P      EDI Status 1
     C                     MOVELYL0100    WL0394    P      EDI Status 2
     C                     MOVELYL0101    WL0395    P      EDI Status 3
     C                     MOVELYL0102    WL0396    P      Record Status
     C                     Z-ADD*ZERO     WL0397           Job Time
     C                     MOVEL*BLANK    WL0398           User Id
     C                     MOVEL*BLANK    WL0399           Job Name
     C                     Z-ADD*ZERO     WL0400           Job Date
     C                     EXSR TLCRRC
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 07/24/19 DN R15161-Replaced Voyage w/ OHE Voyage/Flight & Booking
      *   Number w/ OHE Booking Number.
      * CHG Existing OHE       CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWYAIC3    WL0433           Company Number
     C                     Z-ADDWYC4NB    WL0434           Order Number
     C                     Z-ADDWETMLD    WL0435           Load ID
     C                     Z-ADDWN0055    WL0436           Stop/Drop Seque
     C                     MOVEL*BLANK    WL0437           Shipping Line
     C                     MOVELWL0146    WL0438    P      Port Delv Termi
     C                     MOVELWL0149    WL0439    P      OHE City
     C                     MOVELWL0143    WL0440    P      OHE Vessel/Airl
     C                     MOVELYL0076    WL0441    P      OHE Voyage/Flig
     C                     MOVELWL0145    WL0442    P      OHE Booking Num
     C                     MOVEL*BLANK    WL0443           OHE Discharge P
     C                     Z-ADDYL0077    WL0444           OHE Sail/Flight
     C                     Z-ADDWYQXDT    WL0445           OHE Port Cut Da
     C                     Z-ADDYL0078    WL0446           OHE Arrival Dat
     C                     MOVELWVVBAA    WL0447    P      OHE Late Delive
     C                     MOVEL'O'       WL0448    P      OHE Ship Status
     C                     MOVELWL0141    WL0449    P      OHE Container N
     C                     MOVELWYRLNA    WL0450    P      OHE Comment 1
     C                     MOVELWYRMNA    WL0451    P      OHE Comment 2
     C                     Z-ADDWYGINY    WL0452           OHE Unused Numb
     C                     Z-ADDWYGFNY    WL0453           OHE Unused Numb
     C                     Z-ADDWYGGNY    WL0454           OHE Unused Numb
     C                     Z-ADDWYGHNY    WL0455           OHE Unused Numb
     C                     Z-ADDWYHEVL    WL0456           OHE HPB RIN Equ
     C                     Z-ADDWYHFVL    WL0457           OHE HPB RIN Pri
     C                     Z-ADDWYHGVL    WL0458           Transload Termi
     C                     Z-ADDWYQZDT    WL0459           OHE Est Arrv at
     C                     Z-ADDWYQ0DT    WL0460           OHE Backhaul ET
     C                     Z-ADDWYQ1DT    WL0461           OHE Port/Pier P
     C                     Z-ADDWYQ2DT    WL0462           OHE Actual Ship
     C                     MOVELWYC2TX    WL0463    P      OHE Carrier SCA
     C                     MOVELWYC3TX    WL0464    P      OHE Spot Buy
     C                     MOVELWYC6TX    WL0465    P      OHE PO ACK Flag
     C                     MOVELWYCHTX    WL0466    P      OHE Override Ty
     C                     MOVELWYCITX    WL0467    P      OHE Backhaul St
     C                     MOVELWYCLTX    WL0468    P      OHE Backhaul ET
     C                     MOVELYL0079    WL0469    P      OHE Load Haul T
     C                     MOVELWYCUTX    WL0470    P      OHE Backhaul Ca
     C                     MOVELWYCVTX    WL0471    P      OHE Bookings Co
     C                     MOVELWYB9TX    WL0472    P      OHE EDI Error R
     C                     MOVELWYJWSC    WL0473    P      OHE EDI Error R
     C                     Z-ADDWYITNY    WL0474           HPB COA Batch N
     C                     MOVELWYLMT1    WL0475    P      Delivery P.O. N
     C                     MOVELWYLWAA    WL0476    P      OHE Intended fo
     C                     MOVELWYFVST    WL0477    P      OHE EDI 943 Act
     C                     MOVELWYF0ST    WL0478    P      OHE EDI 944 Act
     C                     MOVELWYF2ST    WL0479    P      OHE EDI 940 Act
     C                     MOVELWYF3ST    WL0480    P      OHE EDI 945 Act
     C                     MOVELWYJUSC    WL0481    P      OHE EDI 856 Act
     C                     MOVELWYJVSC    WL0482    P      OHE EDI 824 Act
     C                     MOVELWYV3T1    WL0483    P      OHE Transload S
     C                     MOVELWYV4T1    WL0484    P      OHE Abs Rate Ov
     C                     MOVELWYV5T1    WL0485    P      OHE Appt Confir
     C                     MOVELWYV6T1    WL0486    P      OHE Backhaul Co
     C                     MOVELWYV7T1    WL0487    P      OHE Backhaul Ch
     C                     MOVELWYV8T1    WL0488    P      OHE Transload C
     C                     MOVELWYV9T1    WL0489    P      OHE Pier Pass I
     C                     MOVELWYWAT1    WL0490    P      OHE Carrier Nm
     C                     MOVELWYWBT1    WL0491    P      OHE Appt Confir
     C                     MOVELWYWCT1    WL0492    P      OHE Backhaul Co
     C                     MOVELWYWDT1    WL0493    P      Letter of Credi
     C                     Z-ADDWYQJNY    WL0494           OHE Backhaul Re
     C                     Z-ADDWYQKNY    WL0495           LD Stop/Drop
     C                     Z-ADDWYQLNY    WL0496           OHE Unused Numb
     C                     Z-ADDWYP8NY    WL0497           OHE Pier Pass F
     C                     Z-ADDWYP9NY    WL0498           OHE Port Check
     C                     Z-ADDWYQANY    WL0499           OHE Port Cut Ti
     C                     Z-ADDWYQCNY    WL0500           OHE Backhaul Tr
     C                     Z-ADDWYQDNY    WL0501           OHE Load Sched
     C                     Z-ADDWYQENY    WL0502           Original Appoin
     C                     Z-ADDWYQFNY    WL0503           Original Appoin
     C                     Z-ADDWYQGNY    WL0504           OHE PowerPro Lo
     C                     Z-ADDWYQHNY    WL0505           OHE PowerPro Lo
     C                     Z-ADDWYQINY    WL0506           OHE Unused Nume
     C                     Z-ADDWYQMNY    WL0507           OHE Orig ABS Fr
     C                     MOVELWYMYU1    WL0508    P      OHE Genset Numb
     C                     MOVELWYJXSC    WL0509    P      OHE Email BOL/S
     C                     MOVELWYJYSC    WL0510    P      OHE EDI Order A
     C                     MOVELWYJZSC    WL0511    P      OHE Unused Stat
     C                     MOVELWYJ0SC    WL0512    P      OHE Unused Stat
     C                     MOVELWYMZU1    WL0513    P      OHE Unused Text
     C                     MOVELWYM0U1    WL0514    P      OHE Unused Text
     C                     MOVELWYM1U1    WL0515    P      OHE Customer Ve
     C                     MOVELWYM2U1    WL0516    P      OHE Unused Text
     C                     MOVELWYM3U1    WL0517    P      OHE Unused Text
     C                     Z-ADDWYW5DT    WL0518           OHE Unused Date
     C                     Z-ADDWYW6DT    WL0519           OHE Unused Date
     C                     MOVELWYUVST    WL0520    P      EDI Status 1
     C                     MOVELWYUWST    WL0521    P      EDI Status 2
     C                     MOVELWYUXST    WL0522    P      EDI Status 3
     C                     MOVELWYVSST    WL0523    P      Record Status
     C                     Z-ADDWYAATM    WL0524           Job Time
     C                     MOVELWYAYNA    WL0525    P      User Id
     C                     MOVELWYA0NA    WL0526    P      Job Name
     C                     Z-ADDWYAXDT    WL0527           Job Date
     C                     EXSR TWCHRC
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG Existing OHE       CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0433    TAAIC3           Company Number
     C                     Z-ADDWL0434    TAC4NB           Order Number
      *
     C           KLCHTW    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
     C           KLCHTW    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YIRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0435    TARMNB           Load ID
     C                     Z-ADDWL0436    TARUNB           Stop/Drop Seque
     C                     MOVELWL0437    TAXACD    P      Shipping Line
     C                     MOVELWL0438    TAOANA    P      Port Delv Termi
     C                     MOVELWL0439    TAHBAA    P      OHE City
     C                     MOVELWL0440    TAJ0T1    P      OHE Vessel/Airl
     C                     MOVELWL0441    TAGENY    P      OHE Voyage/Flig
     C                     MOVELWL0442    TAJ1T1    P      OHE Booking Num
     C                     MOVELWL0443    TAHCAA    P      OHE Discharge P
     C                     Z-ADDWL0444    TAQWDT           OHE Sail/Flight
     C                     Z-ADDWL0445    TAQXDT           OHE Port Cut Da
     C                     Z-ADDWL0446    TAQYDT           OHE Arrival Dat
     C                     MOVELWL0447    TAHDAA    P      OHE Late Delive
     C                     MOVELWL0448    TACCTX    P      OHE Ship Status
     C                     MOVELWL0449    TAJ2T1    P      OHE Container N
     C                     MOVELWL0450    TARLNA    P      OHE Comment 1
     C                     MOVELWL0451    TARMNA    P      OHE Comment 2
     C                     Z-ADDWL0452    TAGINY           OHE Unused Numb
     C                     Z-ADDWL0453    TAGFNY           OHE Unused Numb
     C                     Z-ADDWL0454    TAGGNY           OHE Unused Numb
     C                     Z-ADDWL0455    TAGHNY           OHE Unused Numb
     C                     Z-ADDWL0456    TAHEVL           OHE HPB RIN Equ
     C                     Z-ADDWL0457    TAHFVL           OHE HPB RIN Pri
     C                     Z-ADDWL0458    TAHGVL           Transload Termi
     C                     Z-ADDWL0459    TAQZDT           OHE Est Arrv at
     C                     Z-ADDWL0460    TAQ0DT           OHE Backhaul ET
     C                     Z-ADDWL0461    TAQ1DT           OHE Port/Pier P
     C                     Z-ADDWL0462    TAQ2DT           OHE Actual Ship
     C                     MOVELWL0463    TAC2TX    P      OHE Carrier SCA
     C                     MOVELWL0464    TAC3TX    P      OHE Spot Buy
     C                     MOVELWL0465    TAC6TX    P      OHE PO ACK Flag
     C                     MOVELWL0466    TACHTX    P      OHE Override Ty
     C                     MOVELWL0467    TACITX    P      OHE Backhaul St
     C                     MOVELWL0468    TACLTX    P      OHE Backhaul ET
     C                     MOVELWL0469    TAB4TX    P      OHE Load Haul T
     C                     MOVELWL0470    TACUTX    P      OHE Backhaul Ca
     C                     MOVELWL0471    TACVTX    P      OHE Bookings Co
     C                     MOVELWL0472    TAB9TX    P      OHE EDI Error R
     C                     MOVELWL0473    TAJWSC    P      OHE EDI Error R
     C                     Z-ADDWL0474    TAITNY           HPB COA Batch N
     C                     MOVELWL0475    TALMT1    P      Delivery P.O. N
     C                     MOVELWL0476    TALWAA    P      OHE Intended fo
     C                     MOVELWL0477    TAFVST    P      OHE EDI 943 Act
     C                     MOVELWL0478    TAF0ST    P      OHE EDI 944 Act
     C                     MOVELWL0479    TAF2ST    P      OHE EDI 940 Act
     C                     MOVELWL0480    TAF3ST    P      OHE EDI 945 Act
     C                     MOVELWL0481    TAJUSC    P      OHE EDI 856 Act
     C                     MOVELWL0482    TAJVSC    P      OHE EDI 824 Act
     C                     MOVELWL0483    TAV3T1    P      OHE Transload S
     C                     MOVELWL0484    TAV4T1    P      OHE Abs Rate Ov
     C                     MOVELWL0485    TAV5T1    P      OHE Appt Confir
     C                     MOVELWL0486    TAV6T1    P      OHE Backhaul Co
     C                     MOVELWL0487    TAV7T1    P      OHE Backhaul Ch
     C                     MOVELWL0488    TAV8T1    P      OHE Transload C
     C                     MOVELWL0489    TAV9T1    P      OHE Pier Pass I
     C                     MOVELWL0490    TAWAT1    P      OHE Carrier Nm
     C                     MOVELWL0491    TAWBT1    P      OHE Appt Confir
     C                     MOVELWL0492    TAWCT1    P      OHE Backhaul Co
     C                     MOVELWL0493    TAWDT1    P      Letter of Credi
     C                     Z-ADDWL0494    TAQJNY           OHE Backhaul Re
     C                     Z-ADDWL0495    TAQKNY           LD Stop/Drop
     C                     Z-ADDWL0496    TAQLNY           OHE Unused Numb
     C                     Z-ADDWL0497    TAP8NY           OHE Pier Pass F
     C                     Z-ADDWL0498    TAP9NY           OHE Port Check
     C                     Z-ADDWL0499    TAQANY           OHE Port Cut Ti
     C                     Z-ADDWL0500    TAQCNY           OHE Backhaul Tr
     C                     Z-ADDWL0501    TAQDNY           OHE Load Sched
     C                     Z-ADDWL0502    TAQENY           Original Appoin
     C                     Z-ADDWL0503    TAQFNY           Original Appoin
     C                     Z-ADDWL0504    TAQGNY           OHE PowerPro Lo
     C                     Z-ADDWL0505    TAQHNY           OHE PowerPro Lo
     C                     Z-ADDWL0506    TAQINY           OHE Unused Nume
     C                     Z-ADDWL0507    TAQMNY           OHE Orig ABS Fr
     C                     MOVELWL0508    TAMYU1    P      OHE Genset Numb
     C                     MOVELWL0509    TAJXSC    P      OHE Email BOL/S
     C                     MOVELWL0510    TAJYSC    P      OHE EDI Order A
     C                     MOVELWL0511    TAJZSC    P      OHE Unused Stat
     C                     MOVELWL0512    TAJ0SC    P      OHE Unused Stat
     C                     MOVELWL0513    TAMZU1    P      OHE Unused Text
     C                     MOVELWL0514    TAM0U1    P      OHE Unused Text
     C                     MOVELWL0515    TAM1U1    P      OHE Customer Ve
     C                     MOVELWL0516    TAM2U1    P      OHE Unused Text
     C                     MOVELWL0517    TAM3U1    P      OHE Unused Text
     C                     Z-ADDWL0518    TAW5DT           OHE Unused Date
     C                     Z-ADDWL0519    TAW6DT           OHE Unused Date
     C                     MOVELWL0520    TAUVST    P      EDI Status 1
     C                     MOVELWL0521    TAUWST    P      EDI Status 2
     C                     MOVELWL0522    TAUXST    P      EDI Status 3
     C                     MOVELWL0523    TAVSST    P      Record Status
     C                     Z-ADDWL0524    TAAATM           Job Time
     C                     MOVELWL0525    TAAYNA    P      User Id
     C                     MOVELWL0526    TAA0NA    P      Job Name
     C                     Z-ADDWL0527    TAAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     MOVEL##USR     TAAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0530           Multi Company L
     C                     Z-ADD*ZERO     WL0529           Company Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN THRMNB    WQTX01           Load ID
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX01           Load ID
      * Setup key
     C                     Z-ADDWL0528    WQTX01           Load ID
      * Establish starting position
     C           KRSTX     SETLL@FLCPBW                    *
     C           KRSTX     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Company Number is Equal to zero
     C           WL0529    IFEQ 0                          *IF
     C                     Z-ADDTHAIC3    WL0529           Company Number
     C                     END                             *FI
      * CASE: PAR.Company Number NE DB1.Company Number
     C           WL0529    IFNE THAIC3                     *IF
     C                     MOVEL'Y'       WL0530           Multi Company L
     C                     GOTO TXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTX     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Mult Company Flag  CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0532  30       Company Number
     C                     Z-ADD*ZERO     WN0533  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0534  1        LTL Flag
     C                     MOVEL*BLANK    WN0535  1        Load Status
     C                     Z-ADD*ZERO     WN0536  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0537 15        Seal 1
     C                     MOVEL*BLANK    WN0538 15        Seal 2
     C                     MOVEL*BLANK    WN0539 15        Seal 3
     C                     MOVEL*BLANK    WN0540 15        Seal 4
     C                     MOVEL*BLANK    WN0541 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0542  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0543 112       Flat Amount
     C                     MOVEL*BLANK    WN0544  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0545  50       Total Stops
     C                     MOVEL*BLANK    WN0546 20        Trailer Id
     C                     MOVEL*BLANK    WN0547  3        Transloader Car
     C                     Z-ADD*ZERO     WN0548  40       BOL Time
     C                     MOVEL*BLANK    WN0549  3        Carrier Code
     C                     MOVEL*BLANK    WN0550  7        Truck Size
     C                     Z-ADD*ZERO     WN0551  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0552 112       Rated Freight
     C                     MOVEL*BLANK    WN0553  1        Ship Status
     C                     MOVEL*BLANK    WN0554  1        Load Type
     C                     Z-ADD*ZERO     WN0555  50       Number Pallets
     C                     Z-ADD*ZERO     WN0556  50       Number Pallets
     C                     Z-ADD*ZERO     WN0557 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0558  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0559  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0560  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0561 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0562 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0563  70       Actual Departur
     C                     Z-ADD*ZERO     WN0564  40       Departure Time
     C                     Z-ADD*ZERO     WN0565  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0566  52       Product Tempera
     C                     Z-ADD*ZERO     WN0567  50       Number Spacers
     C                     MOVEL*BLANK    WN0568 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0569  70       Total Load Mile
     C                     MOVEL*BLANK    WN0570 12        Recorder ID
     C                     MOVEL*BLANK    WN0571  2        Shipping Method
     C                     MOVEL*BLANK    WN0572  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0573  2        Ship To State C
     C                     Z-ADD*ZERO     WN0574  70       Gross Weight
     C                     MOVEL*BLANK    WN0575  3        Carrier Broker
     C                     MOVEL*BLANK    WN0576  1        Export Status
     C                     Z-ADD*ZERO     WN0577  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0578  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0579  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0580  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0581  70       Spotted Date
     C                     Z-ADD*ZERO     WN0582  60       Spotted Time
     C                     Z-ADD*ZERO     WN0583  70       Load Finished D
     C                     Z-ADD*ZERO     WN0584  60       Load Finished T
     C                     Z-ADD*ZERO     WN0585  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0586  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0587  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0588  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0589  70       Truck Departure
     C                     Z-ADD*ZERO     WN0590  60       Truck Departure
     C                     Z-ADD*ZERO     WN0591  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0592  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0593  3        Shipping Line
     C                     MOVEL*BLANK    WN0594 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0595 30        Vessel Name
     C                     Z-ADD*ZERO     WN0596  50       Voyage
     C                     Z-ADD*ZERO     WN0597  70       Sail Date
     C                     MOVEL*BLANK    WN0598 12        Booking Number
     C                     MOVEL*BLANK    WN0599 20        Discharge Port
     C                     Z-ADD*ZERO     WN0600  70       Arrival Date
     C                     MOVEL*BLANK    WN0601 12        Container Numbe
     C                     Z-ADD*ZERO     WN0602  70       Date In
     C                     Z-ADD*ZERO     WN0603  60       Time In
     C                     Z-ADD*ZERO     WN0604  70       Date Out
     C                     Z-ADD*ZERO     WN0605  60       Time Out
     C                     Z-ADD*ZERO     WN0606 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0607  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0608  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0609  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0610  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0611  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0612  70       Requested Deliv
     C                     MOVEL*BLANK    WN0613  1        Load Acceptance
     C                     MOVEL*BLANK    WN0614  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0615  70       On Yard Date
     C                     Z-ADD*ZERO     WN0616  60       On Yard Time
     C                     Z-ADD*ZERO     WN0617  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0618  60       Deadline Depart
     C                     MOVEL*BLANK    WN0619  1        Load Held Over
     C                     MOVEL*BLANK    WN0620  1        Load Held Over
     C                     MOVEL*BLANK    WN0621 15        Load Held Over
     C                     MOVEL*BLANK    WN0622 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0623 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0624  70       Express Mail Da
     C                     MOVEL*BLANK    WN0625  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0626  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0627  70       Product Complet
     C                     Z-ADD*ZERO     WN0628  60       Product Complet
     C                     Z-ADD*ZERO     WN0629  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0630  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0631  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0632  1        Load Confirmed
     C                     MOVEL*BLANK    WN0633 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0634  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0635  60       Load Door 1
     C                     Z-ADD*ZERO     WN0636  70       Override Total
     C                     Z-ADD*ZERO     WN0637  60       Load Door 2
     C                     MOVEL*BLANK    WN0638  1        Partial Load
     C                     MOVEL*BLANK    WN0639  1        Load Confirmati
     C                     MOVEL*BLANK    WN0640  1        Export Load USD
     C                     MOVEL*BLANK    WN0641  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0642 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0643 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0644 15        Late Billing Em
     C                     MOVEL*BLANK    WN0645 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0646 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0647  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0648  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0649  1        LH Power Only L
     C                     MOVEL*BLANK    WN0650  1        MG Created Load
     C                     MOVEL*BLANK    WN0651  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0652  2        Load U/M
     C                     MOVEL*BLANK    WN0653  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0654  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0655  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0656  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0657  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0658  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0659  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0660  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0661  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0662  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0663  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0664  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0665  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0666  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0667  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0668  60       LH Unused Time
     C                     MOVEL*BLANK    WN0669  1        EDI Status 1
     C                     MOVEL*BLANK    WN0670  1        EDI Status 2
     C                     MOVEL*BLANK    WN0671  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0672  60       Job Time
     C                     MOVEL*BLANK    WN0673 10        User Id
     C                     MOVEL*BLANK    WN0674 10        Job Name
     C                     Z-ADD*ZERO     WN0675  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0531    WSRMNB           Load ID
      *
     C           KLCHTY    KLIST
     C                     KFLD           WSRMNB           Load ID
     C           KLCHTY    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YJRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0532    WSRVSX    P      Multi Company L
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * Rtv Chk for Unlck Chg RT - TMS Load Event  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0676  50       Stop/Drop Seque
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0042           Status Flag 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQTZ01           TMS Load ID
     C           *LIKE     DEFN WBAYD8    WQTZ02           TMS Extract Dat
     C           *LIKE     DEFN WBAFTH    WQTZ03           TMS Extract Tim
     C           *LIKE     DEFN WBFSU1    WQTZ04           TMS Extract Fil
      * Define keylist
     C           KPSTZ     KLIST
     C                     KFLD           WQTZ01           TMS Load ID
     C                     KFLD           WQTZ02           TMS Extract Dat
     C                     KFLD           WQTZ03           TMS Extract Tim
     C                     KFLD           WQTZ04           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ01           TMS Load ID
     C                     KFLD           WQTZ02           TMS Extract Dat
     C                     KFLD           WQTZ03           TMS Extract Tim
     C                     KFLD           WQTZ04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWATMLD    WQTZ01           TMS Load ID
     C                     Z-ADDWAAYD8    WQTZ02           TMS Extract Dat
     C                     Z-ADDWAAFTH    WQTZ03           TMS Extract Tim
     C                     MOVELWAFSU1    WQTZ04           TMS Extract Fil
     C                     Z-ADD0         WBEVSQ           TMS Event Seque
      * Establish starting position
     C           KPSTZ     SETLL@CSCPXP                    *
     C           KRSTZ     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TMS Event Type is Drop
     C           WBDMSC    IFEQ 'DROP'                     *IF
      * Rtv Ckh Load Dtl      RT - TMS Load Event Shipment  * 
     C                     EXSR NARVGN
     C                     END                             *FI
     C           KRSTZ     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Validate
      *================================================================
      * CASE: DB1.TMS Load Status is Cancelled
     C           WADKSC    IFEQ @CN,003                    *IF
      * dont validate for tms load events/shipments for a cancel. they ma
     C                     ELSE
      * CASE: *OTHERWISE
      * R17040 DN 03/01/21-Set 856 Ready Flag to Yes.
      * CASE: DB1.TMS Carrier Ref PRO/Inv is Entered
     C           WAP4U1    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       YL0003           Check 856 Ready
     C                     END                             *FI
      * Pickup exists from a Warehouse
      * Val Pickup/Drop Exist RT - TMS Load Event  * 
     C                     EXSR SBRVGN
      * CASE: PGM.*Return code is *No value selected
     C           W0RTN     IFEQ @CN,005                    *IF
      * its an extra leg if a pickup doesnt exist from a warehouse
      *    -- create Intl Legs file for these
     C                     MOVEL'E'       WN0043           TMS Extra Leg L
     C                     ELSE
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'D'       WN0043           TMS Extra Leg L
     C                     ELSE
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'PICKUP'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RMC 1/23/20 output on time reason and flag too
      * VAL Load Exists - TMS  RT - Load Header  * 
     C                     EXSR SCRVGN
      * Validate Load
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
      * CASE: PAR.TMS Load Status is Cancelled
     C           WN0001    IFEQ @CN,003                    *IF
      * CANCELLED Load validations
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WN0009    IFEQ 'I'                        *IF
     C           WN0009    OREQ 'S'
     C                     MOVEL'LDSHIN'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Chk Ord Picked    RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Status Flag 10 Y/N is Yes
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'ORDEVT'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       WN0041           Add/Change/Dele
      * Unlock,remove load id from orders, delete load,change log
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.TMS Load Status is Delivered
     C           WN0001    IFEQ @CN,007                    *IF
      * 07/24/18 DN S13418-Removed 'TONU' Processing.
     C                     MOVEL'C'       WN0041           Add/Change/Dele
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0041           Add/Change/Dele
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WN0041           Add/Change/Dele
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Record Found USR is Record Not Found
      *   |- c2    : PAR.TMS Load Status is Cancelled
      *   |- c3    : PAR.TMS Process Status is Unprocessed
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'N'                        *IF
     C           WN0001    IFEQ @CN,003                    *IF
     C           WN0002    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'LOADNF'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     END                             *FI
      * Order Numbers
      * CASE: DB1.TMS Load Status is Cancelled
     C           WADKSC    IFEQ @CN,003                    *IF
      * dont validate for tms load events/shipments for a cancel. they ma
     C                     ELSE
      * CASE: *OTHERWISE
      * 02/26/21 DN R17040-Added 'Check 856 Ready Y/N USR' Parm.
      * Rtv Chk for Order Val RT - TMS Load Event  * 
     C                     EXSR SERVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PGM.*Return code is Error Found
      *   |- c2    : PAR.TMS Process Status is Unprocessed
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ 'ERROR'                    *IF
     C           WN0002    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ORDERR'  WN0003           TMS Error Reaso
     C                     Z-ADD2         WN0002           TMS Process Sta
     C                     END                             *FI
      * S12231 RMC 12/20/17
      * Cant remove order from load if it is shipped/invoiced
      * RTV TMS-Val Ordr cancl RT - Load Detail  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
      * ERR:  Do not Select Record
      * CASE: PAR.TMS Process Status is Error
     C           WN0002    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Process ADD
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Add/Change/Delete USR is Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WN0041    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0024           Export Status
      * Export
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.TMS Movement Type is Export
      *   |- c2    : PAR.Export Status Dft is yes
      *   '-
     C           WADGSC    IFEQ @CN,008                    *IF
     C           WN0046    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       WN0024           Export Status
     C                     END                             *FI
      * Shipping Method
      * CASE: DB1.TMS Payment Method is Collect
     C           WADISC    IFEQ @CN,009                    *IF
     C                     MOVEL'CT'      WN0019           Shipping Method
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'PT'      WN0019           Shipping Method
     C                     END                             *FI
      * Load type
      * CASE: DB1.TMS Shipment Type is Bulk
     C           WADHSC    IFEQ 'BULK'                     *IF
     C                     MOVEL'B'       WN0017           Load Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       WN0017           Load Type
     C                     END                             *FI
      * Load Status
      * CASE:
      *  - c1 ORc2 OR c3 ORc4ORc5ORc6
      *   |- c1    : PAR.TMS Load Status is Booked
      *   |- c2    : PAR.TMS Load Status is Rated
      *   |- c3    : PAR.TMS Load Status is In Transit
      *   |- c4    : DB1.TMS Load Status is Blank
      *   |- c5    : DB1.TMS Load Status is Tendered
      *   |- c6    : DB1.TMS Load Status is Pending
      *   '-
     C           WN0001    IFEQ @CN,010                    *IF
     C           WN0001    OREQ 'RATED'                    *OR
     C           WN0001    OREQ @CN,011                    *OR
     C           WADKSC    OREQ *BLANK                     *OR
     C           WADKSC    OREQ @CN,012                    *OR
     C           WADKSC    OREQ @CN,013                    *OR
      * RMC 12.7.16 added pending
     C                     MOVEL'U'       WN0009           Load Status
     C                     END                             *FI
      * Rtv 1st Order Co      RT - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0013           TMS Load ID
     C                     Z-ADDWAAYD8    WL0014           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0015           TMS Extract Tim
     C                     MOVELWAFSU1    WL0016    P      TMS Extract Fil
     C                     Z-ADD1         WL0017           TMS Event Seque
     C                     Z-ADDWN0007    WL0018           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    WN0007           Company Number
     C                     Z-ADDWL0019    WN0027           Requested Deliv
     C                     Z-ADDWL0020    WN0008           Scheduled Ship
      * Rtv 1st Pickup for LH RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0021           TMS Load ID
     C                     Z-ADDWAAYD8    WL0022           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0023           TMS Extract Tim
     C                     MOVELWAFSU1    WL0024    P      TMS Extract Fil
     C                     Z-ADD1         WL0025           TMS Event Seque
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0015           TMS Planned Dat
     C                     MOVELWL0027    YL0016    P      TMS Location Co
      * Rtv Tot Wt for LH     RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0028           TMS Load ID
     C                     Z-ADDWAAYD8    WL0029           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0030           TMS Extract Tim
     C                     MOVELWAFSU1    WL0031    P      TMS Extract Fil
     C                     Z-ADD1         WL0032           TMS Event Seque
     C                     Z-ADDWN0022    WL0033           Gross Weight
     C                     Z-ADDWN0011    WL0034           Total Load Orde
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0022           Gross Weight
     C                     Z-ADDWL0034    WN0011           Total Load Orde
      * RMC 1/23/20 output late reason from 1st drop too, to upd LH
      * Rtv Drop Shp St f LH  RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0041           TMS Load ID
     C                     Z-ADDWAAYD8    WL0042           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0043           TMS Extract Tim
     C                     MOVELWAFSU1    WL0044    P      TMS Extract Fil
     C                     Z-ADD1         WL0045           TMS Event Seque
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    YL0019    P      TMS State Provi
     C                     MOVELWL0047    YL0001    P      TMS Late Reason
      * Rtv Drop Count f/stps RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0048           TMS Load ID
     C                     Z-ADDWAAYD8    WL0049           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0050           TMS Extract Tim
     C                     MOVELWAFSU1    WL0051    P      TMS Extract Fil
     C                     Z-ADD1         WL0052           TMS Event Seque
     C                     Z-ADDWN0012    WL0053           Total Stops
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0012           Total Stops
     C                     MOVELYL0019    WN0021           Ship To State C
     C                     MOVELYL0016    WN0020           Ship From Wareh
      * RTV Dft Load Seq,Loc   RT - Warehouse  * 
     C                     EXSR STRVGN
      * Default Load Sequence = Yes?
      * CASE: LCL.Default Load Sequence is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     Z-ADD1         YL0022           Schedule Sequen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0022           Schedule Sequen
     C                     END                             *FI
      * Create Carrier if not found
     C                     MOVEL*BLANK    WN0014           Carrier Code
      * CASE: LCL.TMS Carrier SCAC is Entered
     C           YL0004    IFNE *BLANK                     *IF
      * change to lcl
      * RTV Carr from TPM SCAC IF
     C                     MOVEL*BLANK    WN0014           Carrier Code Us
      * RTV Carr from TPM SCAC RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL*BLANK    WL0054           Name
     C                     MOVELYL0004    WL0055    P      SCAC
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    WN0014    P      Carrier Code Us
      * Create Carrier if not found   6.30.16 E4119
      * Create Carrier if not in master file
      * CASE: PAR.Carrier Code Usr is not entered
     C           WN0014    IFEQ *BLANK                     *IF
     C                     MOVELYL0004    YL0024           Carrier Code
      * Val Carrier NF        RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0057    P      Carrier Code
     C                     EXSR SWRVGN
      * Make new carrier code
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,015                    *IF
     C                     MOVEL'0'       YL0025           Text 1 Length U
     C                     MOVEL'Y2U0003' YL0026           Return Code Usr
      * DO WHILE: LCL.Return Code Usr is *Record Already Exists
     C           YL0026    DOWEQ@CN,015                    *DOW
     C                     MOVELYL0024    YL0027           Text 2
     C                     ADD  1         YL0028           Number 1.0 USR
     C                     MOVELYL0028    YL0025           Text 1 Length U
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0027    CAT  YL0025:ZQ YL0024    P      Carrier Code
      * Val Carrier NF        RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0057    P      Carrier Code
     C                     EXSR SWRVGN
     C                     MOVELW0RTN     YL0026           Return Code Usr
     C                     END                             *ITR
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0029           Name
     C                     MOVELYL0004    YL0029           Name
      * CRT OM Carrier         CR - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0058    P      Carrier Code
     C                     MOVELYL0029    WL0059    P      Name
     C                     MOVEL*BLANK    WL0060           Address Line 1
     C                     MOVEL*BLANK    WL0061           Address Line 2
     C                     MOVEL*BLANK    WL0062           Address Line 3
     C                     MOVEL*BLANK    WL0063           City
     C                     MOVEL*BLANK    WL0064           Zip/Postal Code
     C                     Z-ADD*ZERO     WL0065           Telephone Numbe
     C                     MOVEL*BLANK    WL0066           State Code
     C                     Z-ADD*ZERO     WL0067           Carrier Last Us
     C                     MOVEL*BLANK    WL0068           Fax Number
     C                     Z-ADD*ZERO     WL0069           Pallet Balance
     C                     Z-ADD*ZERO     WL0070           Long hook balan
     C                     Z-ADD*ZERO     WL0071           Short hook bala
     C                     Z-ADD*ZERO     WL0072           Tub Balance
     C                     MOVEL'A'       WL0073    P      OM Carrier Stat
     C                     MOVEL*BLANK    WL0074           OM Carrier Comm
     C                     MOVEL*BLANK    WL0075           OM Carrier Comm
     C                     MOVEL*BLANK    WL0076           AP Vendor Numbe
     C                     Z-ADD*ZERO     WL0077           Home Phone
     C                     Z-ADD*ZERO     WL0078           Other Phone
     C                     Z-ADD*ZERO     WL0079           Flat Rate
     C                     Z-ADD*ZERO     WL0080           Rate Per Pound
     C                     Z-ADD*ZERO     WL0081           Unused Rate Per
     C                     Z-ADD*ZERO     WL0082           Miscellaneous C
     C                     MOVEL*BLANK    WL0083           Unused Carrier
     C                     Z-ADD*ZERO     WL0084           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0085           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0086           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0087           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0088           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0089           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0090           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0091           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0092           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0093           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0094           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0095           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0096           Unused Weight R
     C                     Z-ADD*ZERO     WL0097           Unused Weight R
     C                     Z-ADD*ZERO     WL0098           Unused Weight R
     C                     Z-ADD*ZERO     WL0099           Unused Weight R
     C                     Z-ADD*ZERO     WL0100           Unused Weight R
     C                     Z-ADD*ZERO     WL0101           Unused Weight R
     C                     Z-ADD*ZERO     WL0102           Unused Weight R
     C                     Z-ADD*ZERO     WL0103           Unused Weight R
     C                     Z-ADD*ZERO     WL0104           Unused Weight R
     C                     Z-ADD*ZERO     WL0105           Unused Weight R
     C                     Z-ADD*ZERO     WL0106           Unused Weight R
     C                     Z-ADD*ZERO     WL0107           Unused Weight R
     C                     Z-ADD*ZERO     WL0108           Contact Number
     C                     MOVEL'N'       WL0109    P      Certificate of
     C                     MOVEL*BLANK    WL0110           Carrier Unused
     C                     MOVEL*BLANK    WL0111           Carrier Unused
     C                     MOVEL*BLANK    WL0112           Carrier DOT Num
     C                     MOVEL*BLANK    WL0113           Carrier Unused
     C                     MOVEL*BLANK    WL0114           Carrier Unused
     C                     Z-ADD*ZERO     WL0115           Carrier Unused
     C                     MOVEL*BLANK    WL0116           Carrier Fed ID
     C                     Z-ADD*ZERO     WL0117           Amount of Cargo
     C                     Z-ADD*ZERO     WL0118           Amount of Liabi
     C                     Z-ADD*ZERO     WL0119           Date of Expirat
     C                     MOVELYL0030    WL0120    P      SSI Download Fl
     C                     MOVELYL0031    WL0121    P      unused status 2
     C                     MOVELYL0032    WL0122    P      unused status 3
     C                     MOVELYL0033    WL0123    P      EDI Status 1
     C                     MOVELYL0034    WL0124    P      EDI Status 2
     C                     MOVELYL0035    WL0125    P      EDI Status 3
     C                     MOVEL'A'       WL0126    P      Record Status
     C                     Z-ADD*ZERO     WL0127           Job Time
     C                     MOVEL*BLANK    WL0128           User Id
     C                     MOVEL*BLANK    WL0129           Job Name
     C                     Z-ADD*ZERO     WL0130           Job Date
     C                     EXSR SXCRRC
     C                     MOVELYL0024    WN0014           Carrier Code Us
     C                     END                             *FI
     C                     END                             *FI
      * Services:  Shag Wash  10.07.2016 do what it did on EdtCstSvcDspte
     C                     EXSR UCSUBR                     Services:  Shag
      * Rtv Min & Max Pounds  RT - Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'T'       WL0131    P      Truck Size
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0132    YL0036           Maximum pounds
     C                     Z-ADDWL0133    YL0037           Minimum pounds
      * If load weight > maximum pounds for truck, LTL for load is N else
      * CASE: PAR.Gross Weight GE LCL.Maximum pounds
     C           WN0022    IFGE YL0036                     *IF
     C                     MOVEL'N'       YL0038           LTL Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0038           LTL Flag
     C                     END                             *FI
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0039    PARM *ZERO     WQ0002  70       Date
     C                     PARM WAAZD8    WQ0003  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0039    WN0028           Deadline Depart
     C           WAAGTH    MULT 100       YL0040           Deadline Depart
      * RMC 1/23/20 Added to init these to blank
     C                     MOVEL*BLANK    YL0002           LH On-Time Reas
     C                     MOVEL*BLANK    YL0041           On Time - (Y/N)
      * RMC 1/23/20 added this chg to update LH with 1st late reason
      * CASE: LCL.TMS Late Reason Code is Entered
     C           YL0001    IFGT *BLANK                     *IF
      * CASE: LCL.TMS Late Reason Code is NS
     C           YL0001    IFEQ 'NS'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0001    YL0002           LH On-Time Reas
     C                     MOVEL'N'       YL0041           On Time - (Y/N)
     C                     END                             *FI
     C                     END                             *FI
      * CRT Load Header TMS    CR - Load Header  * 
     C                     EXSR SZCRRC
      * For each Pickup from a Warehouse:  Update load detail, order head
      * R17040 DN 03/01/21-Passed in the TMS Carrier Ref PRO/Inv.
      * Rtv Crt Load Dtl      RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0134           TMS Load ID
     C                     Z-ADDWAAYD8    WL0135           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0136           TMS Extract Tim
     C                     MOVELWAFSU1    WL0137    P      TMS Extract Fil
     C                     Z-ADD*ZERO     WL0138           TMS Event Seque
     C                     MOVELYL0004    WL0139    P      TMS Carrier SCA
     C                     MOVELWAUTAA    WL0140    P      TMS Trailer Num
     C                     MOVELWAUUAA    WL0141    P      TMS Container N
     C                     MOVELWAUVAA    WL0142    P      TMS Move Type
     C                     MOVELWAUWAA    WL0143    P      TMS Vessel Name
     C                     MOVELWAUXAA    WL0144    P      TMS Voyage Numb
     C                     MOVELWAFJU1    WL0145    P      TMS Booking Num
     C                     MOVELWAFKU1    WL0146    P      TMS OTR Destina
     C                     MOVELWAFLU1    WL0147    P      TMS OTR Destina
     C                     MOVELWAFMU1    WL0148    P      TMS OTR Destina
     C                     MOVELWAFNU1    WL0149    P      TMS OTR Destina
     C                     MOVELWAFOU1    WL0150    P      TMS OTR Destina
     C                     MOVELWAFPU1    WL0151    P      TMS OTR Destina
     C                     MOVELWAFQU1    WL0152    P      TMS OTR Destina
     C                     Z-ADDWAA7D8    WL0153           TMS Vessel ETD
     C                     Z-ADDWAA8D8    WL0154           TMS Vessel ETA
     C                     MOVELWAP4U1    WL0155    P      TMS Carrier Ref
     C                     MOVELWN0014    WL0156    P      Carrier Code
     C                     Z-ADDWN0028    WL0157           Deadline Depart
     C                     Z-ADDWAAGTH    WL0158           TMS Deadline De
     C                     MOVELWN0041    WL0159    P      Add/Change/Dele
     C                     EXSR TARVGN
      * RMC 1/8/18 Check for multi company
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0006    WL0528           Load ID
     C                     Z-ADDYL0103    WL0529           Company Number
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0529    YL0103           Company Number
     C                     MOVELWL0530    WN0033    P      Multi Company L
      * CASE: PAR.Multi Company Load is not no
     C           WN0033    IFEQ *BLANK                     *IF
     C           WN0033    OREQ 'Y'
      * CHG Mult Company Flag  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0006    WL0531           Load ID
     C                     MOVELWN0033    WL0532    P      Multi Company L
     C                     EXSR TYCHRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Services:  Shag Wash  10.07.2016 do what it did on EdtCstSvcDspt
      *================================================================
      * ** 10/07/2016 RMC R7362 Do what it did in oms: Default shag flag
     C                     MOVEL'N'       WN0031           Load Wash Flag
     C                     MOVEL'N'       WN0030           Load Shag Flag
      * Default Shag & Wash to YES for Internal, Load type Regular
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Location is Internal (Plant)
      *   |- c2    : PAR.Load Type is Regular
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFEQ 'I'                        *IF
     C           WN0017    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0030           Load Shag Flag
     C                     MOVEL'Y'       WN0031           Load Wash Flag
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * *****
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Comments and changes
      *================================================================
      * ** 03/06/2017 LJB E009492 Add Orig appt date/time to the rtv crt
      * *****
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Process CHANGE  if picked/shipped/invoiced, just chg LH,LD
      *================================================================
      * CASE:
      *  - c1 AND c2 AND(c3ORc4)
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Add/Change/Delete USR is Change
      *   |- c3    : PAR.Load Status is Entered,Comb,Unlck,Locked
      *   |- c4    : PAR.Load Status is Shipped or Invoiced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WN0041    IFEQ 'C'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WN0009    IFEQ 'C'                        *IF
     C           WN0009    OREQ 'E'
     C           WN0009    OREQ 'L'
     C           WN0009    OREQ 'U'
     C           WN0009    OREQ 'I'                        *OR
     C           WN0009    OREQ 'S'
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Create Carrier if not found
     C                     MOVEL*BLANK    YL0104           Carrier Code Us
      * CASE: LCL.TMS Carrier SCAC is Entered
     C           YL0004    IFNE *BLANK                     *IF
      * RTV Carr from TPM SCAC IF
     C                     MOVEL*BLANK    YL0104           Carrier Code Us
      * RTV Carr from TPM SCAC RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL*BLANK    WL0054           Name
     C                     MOVELYL0004    WL0055    P      SCAC
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    YL0104    P      Carrier Code Us
      * Create Carrier if not found   6.30.16 E4119
      * Create Carrier if not in master file
      * CASE: PAR.Carrier Code Usr is not entered
     C           YL0104    IFEQ *BLANK                     *IF
     C                     MOVELYL0004    YL0024           Carrier Code
      * Val Carrier NF        RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0057    P      Carrier Code
     C                     EXSR SWRVGN
      * Make new carrier code
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,015                    *IF
     C                     MOVEL'0'       YL0025           Text 1 Length U
     C                     MOVEL'Y2U0003' YL0026           Return Code Usr
      * DO WHILE: LCL.Return Code Usr is *Record Already Exists
     C           YL0026    DOWEQ@CN,015                    *DOW
     C                     MOVELYL0024    YL0027           Text 2
     C                     ADD  1         YL0028           Number 1.0 USR
     C                     MOVELYL0028    YL0025           Text 1 Length U
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0027    CAT  YL0025:ZQ YL0024    P      Carrier Code
      * Val Carrier NF        RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0057    P      Carrier Code
     C                     EXSR SWRVGN
     C                     MOVELW0RTN     YL0026           Return Code Usr
     C                     END                             *ITR
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0029           Name
     C                     MOVELYL0004    YL0029           Name
      * CRT OM Carrier         CR - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0058    P      Carrier Code
     C                     MOVELYL0029    WL0059    P      Name
     C                     MOVEL*BLANK    WL0060           Address Line 1
     C                     MOVEL*BLANK    WL0061           Address Line 2
     C                     MOVEL*BLANK    WL0062           Address Line 3
     C                     MOVEL*BLANK    WL0063           City
     C                     MOVEL*BLANK    WL0064           Zip/Postal Code
     C                     Z-ADD*ZERO     WL0065           Telephone Numbe
     C                     MOVEL*BLANK    WL0066           State Code
     C                     Z-ADD*ZERO     WL0067           Carrier Last Us
     C                     MOVEL*BLANK    WL0068           Fax Number
     C                     Z-ADD*ZERO     WL0069           Pallet Balance
     C                     Z-ADD*ZERO     WL0070           Long hook balan
     C                     Z-ADD*ZERO     WL0071           Short hook bala
     C                     Z-ADD*ZERO     WL0072           Tub Balance
     C                     MOVEL'A'       WL0073    P      OM Carrier Stat
     C                     MOVEL*BLANK    WL0074           OM Carrier Comm
     C                     MOVEL*BLANK    WL0075           OM Carrier Comm
     C                     MOVEL*BLANK    WL0076           AP Vendor Numbe
     C                     Z-ADD*ZERO     WL0077           Home Phone
     C                     Z-ADD*ZERO     WL0078           Other Phone
     C                     Z-ADD*ZERO     WL0079           Flat Rate
     C                     Z-ADD*ZERO     WL0080           Rate Per Pound
     C                     Z-ADD*ZERO     WL0081           Unused Rate Per
     C                     Z-ADD*ZERO     WL0082           Miscellaneous C
     C                     MOVEL*BLANK    WL0083           Unused Carrier
     C                     Z-ADD*ZERO     WL0084           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0085           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0086           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0087           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0088           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0089           Unused Mile Ran
     C                     Z-ADD*ZERO     WL0090           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0091           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0092           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0093           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0094           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0095           Unused Mile Rat
     C                     Z-ADD*ZERO     WL0096           Unused Weight R
     C                     Z-ADD*ZERO     WL0097           Unused Weight R
     C                     Z-ADD*ZERO     WL0098           Unused Weight R
     C                     Z-ADD*ZERO     WL0099           Unused Weight R
     C                     Z-ADD*ZERO     WL0100           Unused Weight R
     C                     Z-ADD*ZERO     WL0101           Unused Weight R
     C                     Z-ADD*ZERO     WL0102           Unused Weight R
     C                     Z-ADD*ZERO     WL0103           Unused Weight R
     C                     Z-ADD*ZERO     WL0104           Unused Weight R
     C                     Z-ADD*ZERO     WL0105           Unused Weight R
     C                     Z-ADD*ZERO     WL0106           Unused Weight R
     C                     Z-ADD*ZERO     WL0107           Unused Weight R
     C                     Z-ADD*ZERO     WL0108           Contact Number
     C                     MOVEL'N'       WL0109    P      Certificate of
     C                     MOVEL*BLANK    WL0110           Carrier Unused
     C                     MOVEL*BLANK    WL0111           Carrier Unused
     C                     MOVEL*BLANK    WL0112           Carrier DOT Num
     C                     MOVEL*BLANK    WL0113           Carrier Unused
     C                     MOVEL*BLANK    WL0114           Carrier Unused
     C                     Z-ADD*ZERO     WL0115           Carrier Unused
     C                     MOVEL*BLANK    WL0116           Carrier Fed ID
     C                     Z-ADD*ZERO     WL0117           Amount of Cargo
     C                     Z-ADD*ZERO     WL0118           Amount of Liabi
     C                     Z-ADD*ZERO     WL0119           Date of Expirat
     C                     MOVELYL0030    WL0120    P      SSI Download Fl
     C                     MOVELYL0031    WL0121    P      unused status 2
     C                     MOVELYL0032    WL0122    P      unused status 3
     C                     MOVELYL0033    WL0123    P      EDI Status 1
     C                     MOVELYL0034    WL0124    P      EDI Status 2
     C                     MOVELYL0035    WL0125    P      EDI Status 3
     C                     MOVEL'A'       WL0126    P      Record Status
     C                     Z-ADD*ZERO     WL0127           Job Time
     C                     MOVEL*BLANK    WL0128           User Id
     C                     MOVEL*BLANK    WL0129           Job Name
     C                     Z-ADD*ZERO     WL0130           Job Date
     C                     EXSR SXCRRC
     C                     MOVELYL0024    YL0104           Carrier Code Us
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Chk for Unlck Chg RT - TMS Load Event  * 
     C                     EXSR TZRVGN
      * RTV Chk for Ord RmTMS RT - Load Detail  * 
     C                     EXSR NDRVGN
      * Changes not req Unlock
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Carrier Code NE LCL.Carrier Code Usr
      *   |- c2    : DB1.TMS Trailer Number NE PAR.Trailer Id
      *   '-
     C           WN0014    IFNE YL0104                     *IF
     C           WAUTAA    ORNE WN0013                     *OR
      * unlock not needed.
     C                     MOVEL'Y'       WN0047           Status Flag 2
     C                     END                             *FI
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0039    PARM *ZERO     WQ0019  70       Date
     C                     PARM WAAZD8    WQ0020  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           WAAGTH    MULT 100       YL0040           Deadline Depart
      * Chg DDT not req unlock
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Deadline Departure Date NE LCL.Date
      *   |- c2    : LCL.Deadline Departure Time NE PAR.Deadline Departur
      *   '-
     C           WN0028    IFNE YL0039                     *IF
     C           YL0040    ORNE WN0029                     *OR
      * unlock not needed.
     C                     MOVEL'Y'       WN0047           Status Flag 2
     C                     END                             *FI
      * Process if no ERROR
      * CASE: PAR.TMS Process Status is Error
     C           WN0002    IFEQ 2                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Export
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.TMS Movement Type is Export
      *   |- c2    : PAR.Export Status Dft is yes
      *   '-
     C           WADGSC    IFEQ @CN,008                    *IF
     C           WN0046    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       WN0024           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0024           Export Status
     C                     END                             *FI
      * Shipping Method
      * CASE: DB1.TMS Payment Method is Collect
     C           WADISC    IFEQ @CN,009                    *IF
     C                     MOVEL'CT'      WN0019           Shipping Method
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'PT'      WN0019           Shipping Method
     C                     END                             *FI
      * Load type
      * CASE: DB1.TMS Shipment Type is Bulk
     C           WADHSC    IFEQ 'BULK'                     *IF
     C                     MOVEL'B'       WN0017           Load Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       WN0017           Load Type
     C                     END                             *FI
      * Rtv 1st Order Co      RT - TMS Load Event Shipment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0013           TMS Load ID
     C                     Z-ADDWAAYD8    WL0014           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0015           TMS Extract Tim
     C                     MOVELWAFSU1    WL0016    P      TMS Extract Fil
     C                     Z-ADD1         WL0017           TMS Event Seque
     C                     Z-ADDWN0007    WL0018           Company Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    WN0007           Company Number
     C                     Z-ADDWL0019    WN0027           Requested Deliv
     C                     Z-ADDWL0020    WN0008           Scheduled Ship
      * Rtv 1st Pickup for LH RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0021           TMS Load ID
     C                     Z-ADDWAAYD8    WL0022           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0023           TMS Extract Tim
     C                     MOVELWAFSU1    WL0024    P      TMS Extract Fil
     C                     Z-ADD1         WL0025           TMS Event Seque
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0015           TMS Planned Dat
     C                     MOVELWL0027    YL0016    P      TMS Location Co
      * Rtv Tot Wt for LH     RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0028           TMS Load ID
     C                     Z-ADDWAAYD8    WL0029           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0030           TMS Extract Tim
     C                     MOVELWAFSU1    WL0031    P      TMS Extract Fil
     C                     Z-ADD1         WL0032           TMS Event Seque
     C                     Z-ADDWN0022    WL0033           Gross Weight
     C                     Z-ADDYL0117    WL0034           Total Load Orde
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0022           Gross Weight
     C                     Z-ADDWL0034    YL0117           Total Load Orde
      * Rtv Min & Max Pounds  RT - Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'T'       WL0131    P      Truck Size
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0132    YL0036           Maximum pounds
     C                     Z-ADDWL0133    YL0037           Minimum pounds
      * If load weight > maximum pounds for truck, LTL for load is N else
      * CASE: PAR.Gross Weight GE LCL.Maximum pounds
     C           WN0022    IFGE YL0036                     *IF
     C                     MOVEL'N'       YL0038           LTL Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0038           LTL Flag
     C                     END                             *FI
      * RMC 1/23/20 output late reason from 1st drop to update LH
      * Rtv Drop Shp St f LH  RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0041           TMS Load ID
     C                     Z-ADDWAAYD8    WL0042           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0043           TMS Extract Tim
     C                     MOVELWAFSU1    WL0044    P      TMS Extract Fil
     C                     Z-ADD1         WL0045           TMS Event Seque
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    YL0019    P      TMS State Provi
     C                     MOVELWL0047    YL0001    P      TMS Late Reason
      * Rtv Drop Count f/stps RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0048           TMS Load ID
     C                     Z-ADDWAAYD8    WL0049           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0050           TMS Extract Tim
     C                     MOVELWAFSU1    WL0051    P      TMS Extract Fil
     C                     Z-ADD1         WL0052           TMS Event Seque
     C                     Z-ADDWN0012    WL0053           Total Stops
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WN0012           Total Stops
     C                     MOVELYL0019    WN0021           Ship To State C
     C                     MOVELYL0016    WN0020           Ship From Wareh
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0039    PARM *ZERO     WQ0021  70       Date
     C                     PARM WAAZD8    WQ0022  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0039    WN0028           Deadline Depart
     C           WAAGTH    MULT 100       YL0040           Deadline Depart
     C                     MOVEL*BLANK    YL0002           LH On-Time Reas
     C                     MOVEL*BLANK    YL0041           On Time - (Y/N)
      * RMC 1/23/20 added this chg to update LH with 1st late reason
      * CASE: PAR.LH On-Time Reason Code is Blank
     C           WN0034    IFEQ *BLANK                     *IF
      * CASE:
      *  - NOTc1 AND c2
      *   |- c1    : LCL.TMS Late Reason Code is NS
      *   |- c2    : LCL.TMS Late Reason Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'NS'                       *IF
     C                     ELSE
     C           YL0001    IFGT *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0001    YL0002           LH On-Time Reas
     C                     MOVEL'N'       YL0041           On Time - (Y/N)
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * upd with what was already there - dont change if not blank
     C                     MOVELWN0034    YL0002           LH On-Time Reas
     C                     MOVELWN0025    YL0041           On Time - (Y/N)
     C                     END                             *FI
      * RTV Chg from TMS      RT - Load Header  * 
     C                     EXSR NFRVGN
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : PAR.Event Code SavUsr is Shipped Thru 07 History
      *   |- c2    : PAR.Status Flag 2  Y/N is Yes
      *   |- c3    : PAR.Status Flag 1  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0045    IFGE '04'                       *IF
     C           WN0045    ANDLE'07'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0047    IFEQ 'Y'                        *IF
     C           WN0042    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Cant change order if picked thru invoiced 8/17
      *    change load detail only --- dont recreate
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv.
      * Rtv Chg Load Dtl      RT - TMS Load Event  * 
     C                     EXSR NHRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * For Changes, delete LD, zerout load in OH  (doing this in case st
      * only if something is changing  (status 1=Yes)
      * CASE: PAR.Status Flag 1  Y/N is Yes
     C           WN0042    IFEQ 'Y'                        *IF
      * RTV DLT for TMS Chg   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0533           Load ID
     C                     MOVELWN0014    WL0534    P      Carrier Code
     C                     EXSR NORVGN
      * 2nd Pass:   Create LD, upd OH for Pickup from Warehouse
      * R17040 DN 03/01/21-Passed in TMS Carrier Ref PRO/Inv.
      * Rtv Crt Load Dtl      RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0134           TMS Load ID
     C                     Z-ADDWAAYD8    WL0135           TMS Extract Dat
     C                     Z-ADDWAAFTH    WL0136           TMS Extract Tim
     C                     MOVELWAFSU1    WL0137    P      TMS Extract Fil
     C                     Z-ADD0         WL0138           TMS Event Seque
     C                     MOVELYL0004    WL0139    P      TMS Carrier SCA
     C                     MOVELWAUTAA    WL0140    P      TMS Trailer Num
     C                     MOVELWAUUAA    WL0141    P      TMS Container N
     C                     MOVELWAUVAA    WL0142    P      TMS Move Type
     C                     MOVELWAUWAA    WL0143    P      TMS Vessel Name
     C                     MOVELWAUXAA    WL0144    P      TMS Voyage Numb
     C                     MOVELWAFJU1    WL0145    P      TMS Booking Num
     C                     MOVELWAFKU1    WL0146    P      TMS OTR Destina
     C                     MOVELWAFLU1    WL0147    P      TMS OTR Destina
     C                     MOVELWAFMU1    WL0148    P      TMS OTR Destina
     C                     MOVELWAFNU1    WL0149    P      TMS OTR Destina
     C                     MOVELWAFOU1    WL0150    P      TMS OTR Destina
     C                     MOVELWAFPU1    WL0151    P      TMS OTR Destina
     C                     MOVELWAFQU1    WL0152    P      TMS OTR Destina
     C                     Z-ADDWAA7D8    WL0153           TMS Vessel ETD
     C                     Z-ADDWAA8D8    WL0154           TMS Vessel ETA
     C                     MOVELWAP4U1    WL0155    P      TMS Carrier Ref
     C                     MOVELYL0104    WL0156    P      Carrier Code
     C                     Z-ADDWN0028    WL0157           Deadline Depart
     C                     Z-ADDWAAGTH    WL0158           TMS Deadline De
     C                     MOVELWN0041    WL0159    P      Add/Change/Dele
     C                     EXSR TARVGN
     C                     END                             *FI
      * RMC 1/8/18 Check for multi company
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0006    WL0528           Load ID
     C                     Z-ADDYL0103    WL0529           Company Number
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0529    YL0103           Company Number
     C                     MOVELWL0530    WN0033    P      Multi Company L
      * CASE: PAR.Multi Company Load is not no
     C           WN0033    IFEQ *BLANK                     *IF
     C           WN0033    OREQ 'Y'
      * CHG Mult Company Flag  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0006    WL0531           Load ID
     C                     MOVELWN0033    WL0532    P      Multi Company L
     C                     EXSR TYCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Output the Load Header changes to Load order change log
      *================================================================
      * Change to Carrier
     C                     MOVEL'CARCHG'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WULHT1           Change Log Prio
     C                     MOVELTIBZNA    WULHT1           Change Log Prio
     C                     MOVEL*BLANK    WULKT1           Change Log New
     C                     MOVELYL0104    WULKT1           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDTIRMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWULHT1    PBMNTX    P      Change Log Prio
     C                     MOVELWULKT1    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELYL0104    PBBZNA    P      Carrier Code
     C                     Z-ADDTIAIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Changes and comments
      *================================================================
      * * 04/24/2017 LJB E009492  IF TMS Appointment Date is entered see
      * *    Original Appointment Date is entered. If not then this is th
      * *    first entry. Update OHE. This should be done in the CRT rout
      * *    but this should catch it if it gets missed.
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 9/30/16 e4119
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0043  70       Load ID
     C           YL0049    PARM *BLANK    WQ0044  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0057  70       Load ID
     C           WN1110    PARM *BLANK    WQ0058  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Process DELETE
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Add/Change/Delete USR is Delete
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WN0041    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * First:  Process unlock load request - write carlisle
      * CASE: PAR.Load Status is Lock
     C           WN0009    IFEQ 'L'                        *IF
      *
     C                     MOVEL*BLANK    WN1421  3        Shipping Line
     C                     MOVEL*BLANK    WN1422 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1423  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1424  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0565           Load ID
     C                     MOVEL'U'       WL0566    P      Load Status
     C                     Z-ADD*ZERO     WL0567           Rated Freight
     C                     EXSR OTCHRC
      *
     C                     MOVEL*BLANK    WN1568  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1569  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1570  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1571  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0539           Load ID
     C                     EXSR OLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0540    WN1568    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,020   WL0568    P      System Value Co
     C                     EXSR OURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0569    YL0148    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0007    WL0541           PFS Company Num
     C                     MOVEL'LDORDD'  WL0542    P      PFS Interface C
     C                     EXSR OPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0543    YL0149    P      PFS AccuSort Ac
     C                     MOVELWL0544    YL0150    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0149    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1568    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0136  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0137  70       Load ID
     C                     PARM WN0007    WQ0138  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0139  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0150    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0140  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0141  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WATMLD    WQ0142  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0570           Load ID
     C                     Z-ADD*ZERO     WL0571           Stop/Drop Seque
     C                     EXSR OVRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL'U'       WUMOTX           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWATMLD    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWN0009    PBMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWN0014    PBBZNA    P      Carrier Code
     C                     Z-ADDWN0007    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * For each Pickup from a Warehouse:  Delete load detail, upd order
      * RTV DLT for TMS Chg   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0006    WL0533           Load ID
     C                     MOVELWN0014    WL0534    P      Carrier Code
     C                     EXSR NORVGN
      * DLT Load Header        DL - Load Header  * 
     C                     EXSR PBDLRC
     C                     Z-ADD1         WN0002           TMS Process Sta
     C                     END                             *FI
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WATMLD           TMS Load ID
     C                     Z-ADD*ZERO     WAAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WAAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WALTMP           TMS Temperature
     C                     Z-ADD*ZERO     WACRDS           TMS Carrier Dis
     C                     Z-ADD*ZERO     WAAZD8           TMS Deadline De
     C                     Z-ADD*ZERO     WAAGTH           TMS Deadline De
     C                     Z-ADD*ZERO     WAA7D8           TMS Vessel ETD
     C                     Z-ADD*ZERO     WAA8D8           TMS Vessel ETA
     C                     Z-ADD*ZERO     WATPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WAA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WAD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTMLD           TMS Load ID
     C                     Z-ADD*ZERO     WBAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WBAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WBEVSQ           TMS Event Seque
     C                     Z-ADD*ZERO     WBA1D8           TMS Earliest Da
     C                     Z-ADD*ZERO     WBAHTH           TMS Earliest Ti
     C                     Z-ADD*ZERO     WBA2D8           TMS Latest Date
     C                     Z-ADD*ZERO     WBAITH           TMS Latest Time
     C                     Z-ADD*ZERO     WBA3D8           TMS Planned Dat
     C                     Z-ADD*ZERO     WBAJTH           TMS Planned Tim
     C                     Z-ADD*ZERO     WBA4D8           TMS Actual Date
     C                     Z-ADD*ZERO     WBAKTH           TMS Actual Time
     C                     Z-ADD*ZERO     WBG1NB           TMS Weight
     C                     Z-ADD*ZERO     WBA6D8           TMS Appointment
     C                     Z-ADD*ZERO     WBAMTH           TMS Appointment
     C                     Z-ADD*ZERO     WBA9D8           TMS Actual Car
     C                     Z-ADD*ZERO     WBANTH           TMS Actual Car
     C                     Z-ADD*ZERO     WBTPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WBA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WBD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WETMLD           TMS Load ID
     C                     Z-ADD*ZERO     WEAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WEAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WEEVSQ           TMS Event Seque
     C                     Z-ADD*ZERO     WETMOR           TMS Order ID
     C                     Z-ADD*ZERO     WEHFNB           TMS Miles from
     C                     Z-ADD*ZERO     WETPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WEA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WED9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WHRWNB           Miles to next s
     C                     Z-ADD*ZERO     WHRXNB           Freight Charge
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WHT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHKFDT           Appointment Con
     C                     Z-ADD*ZERO     WHACTM           Appointment Con
     C                     Z-ADD*ZERO     WHEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WHAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHZ4NB           MPC Number
     C                     Z-ADD*ZERO     WHN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WHN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WHN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WHB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WHB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WHB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WKBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WKBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WKBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WKBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WLEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WLNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WLNSVA           Long hook balan
     C                     Z-ADD*ZERO     WLNTVA           Short hook bala
     C                     Z-ADD*ZERO     WLNUVA           Tub Balance
     C                     Z-ADD*ZERO     WLS8NB           Home Phone
     C                     Z-ADD*ZERO     WLS9NB           Other Phone
     C                     Z-ADD*ZERO     WLNMVA           Flat Rate
     C                     Z-ADD*ZERO     WLNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WLNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WLNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WLQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WLQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WLMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WLMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WLRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WLMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WLBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WLDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WLDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WLDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WLDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WLDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WLDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WLB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WLB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WLB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WLB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WLB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WLB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WLAAC7           Contact Number
     C                     Z-ADD*ZERO     WLTENO           Carrier Unused
     C                     Z-ADD*ZERO     WLAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WLAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WLKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WRRTNB           Maximum Units
     C                     Z-ADD*ZERO     WRTANB           Minimum pounds
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Clear all neither parameters
      * CRT Load Header TMS    CR - Load Header  * 
     C                     Z-ADD*ZERO     WSSDNB           Number Pallets
     C                     Z-ADD*ZERO     WSPAOU           Number Pallets
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYC4NB           Order Number
     C                     Z-ADD*ZERO     WYRMNB           Load ID
     C                     Z-ADD*ZERO     WYRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WYQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WYQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WYQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WYGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WYGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WYGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WYGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WYHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WYHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WYHGVL           Transload Termi
     C                     Z-ADD*ZERO     WYQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WYQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WYQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WYQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WYITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WYQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WYQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WYQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WYP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WYP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WYQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WYQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WYQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WYQENY           Original Appoin
     C                     Z-ADD*ZERO     WYQFNY           Original Appoin
     C                     Z-ADD*ZERO     WYQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WYQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WYQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WYQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WYW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WYW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field @Blank for 5
     C                     MOVEL*BLANK    WUKGTX  5
      * Define work field Original Appointment Date
     C                     Z-ADD*ZERO     WUQENY  60
      * Define work field Original Appointment Time
     C                     Z-ADD*ZERO     WUQFNY  60
      * Clear all neither parameters
      * CRT Load Detail        CR - Load Detail  * 
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCC4NB           Order Number
     C                     Z-ADD*ZERO     TCQ2NB           Event Number
     C                     Z-ADD*ZERO     TCAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     TCQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     TCD2DT           Event Date
     C                     Z-ADD*ZERO     TCAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     TCQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     TCQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     TCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFAIC3           Company Number
     C                     Z-ADD*ZERO     TFC4NB           Order Number
     C                     Z-ADD*ZERO     TFDPNB           Order Sequence
     C                     Z-ADD*ZERO     TFUENB           Order Secondary
     C                     Z-ADD*ZERO     TFHGCD           Item Code
     C                     Z-ADD*ZERO     TFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     TFMAVA           Billing Detail
     C                     Z-ADD*ZERO     TFKDVA           Billing Detail
     C                     Z-ADD*ZERO     TFL8VA           Billing Detail
     C                     Z-ADD*ZERO     TFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     TFAYVA           Extended Amount
     C                     Z-ADD*ZERO     TFEXDT           Market Pricing
     C                     Z-ADD*ZERO     TFBZPR           Price Overage O
     C                     Z-ADD*ZERO     TFL6NB           Contract Number
     C                     Z-ADD*ZERO     TFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     TFR1NB           Rated Freight
     C                     Z-ADD*ZERO     TFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     TFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     TFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     TFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     TFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     TFATWG           Weight Shipped
     C                     Z-ADD*ZERO     TFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     TFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TFAKPR           Unit Price
     C                     Z-ADD*ZERO     TFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     TFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     TFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     TFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     TFA5DT           Requested Ship
     C                     Z-ADD*ZERO     TFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     TFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     TFRGNB           Item Structure
     C                     Z-ADD*ZERO     TFRHNB           Item Structure
     C                     Z-ADD*ZERO     TFRINB           Item Structure
     C                     Z-ADD*ZERO     TFCXDT           Date of Origina
     C                     Z-ADD*ZERO     TFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     TFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     TFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     TFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     TFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     TFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     TFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     TFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     TFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     TFBVTM           Price Code
     C                     Z-ADD*ZERO     TFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     TFBXTM           Substitution Li
     C                     Z-ADD*ZERO     TFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     TFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     TFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     TFH7NX           OD Item Target
     C                     Z-ADD*ZERO     TFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     TFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     TFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     TFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     TFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     TFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     TFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     TFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     TFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     TFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     TFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     TFRINY           Item Age Days
     C                     Z-ADD*ZERO     TFTIDT           Production Ovr
     C                     Z-ADD*ZERO     TFTJDT           Production Ovr
     C                     Z-ADD*ZERO     TFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     TFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     TFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     TFAATM           Job Time
     C                     Z-ADD*ZERO     TFAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Change Log Prior Val Usr1
     C                     MOVEL*BLANK    WULHT1 12
      * Define work field Change Log New VL Usr 2
     C                     MOVEL*BLANK    WULKT1 12
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Company Number     041405
     C                     Z-ADD*ZERO     WUBQC3  30
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TKMILE           Miles to First
     C                     Z-ADD*ZERO     TKHRRQ           Hours Required
     C                     Z-ADD*ZERO     TKAATM           Job Time
     C                     Z-ADD*ZERO     TKAXDT           Job Date
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TMNMVA           Flat Rate
     C                     Z-ADD*ZERO     TMEPPR           Bulk Rate
     C                     Z-ADD*ZERO     TMEQPR           Export Fresh Fl
     C                     Z-ADD*ZERO     TMERPR           Export Frozen F
     C                     Z-ADD*ZERO     TMOQDT           CDR Unused Date
     C                     Z-ADD*ZERO     TMORDT           CDR Unused Date
     C                     Z-ADD*ZERO     TMGXVL           CDR Unused Amou
     C                     Z-ADD*ZERO     TMAATM           Job Time
     C                     Z-ADD*ZERO     TMAXDT           Job Date
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TOY1NX           PFS Company Num
     C                     Z-ADD*ZERO     TOQEDT           PFS Last Update
     C                     Z-ADD*ZERO     TOCUTM           PFS Last Update
     C                     Z-ADD*ZERO     TOB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     TOB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     TOUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     TOAHNY           PFS Create Date
     C                     Z-ADD*ZERO     TOAINY           PFS Create Time
     C                     Z-ADD*ZERO     TOAJNY           PFS Change Date
     C                     Z-ADD*ZERO     TOAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TRK4DT           Created Date
     C                     Z-ADD*ZERO     TRA1TM           Created Time
     C                     Z-ADD*ZERO     TRDXNB           Sequence Number
     C                     Z-ADD*ZERO     TRRMNB           Load ID
     C                     Z-ADD*ZERO     TRRVNB           Stop/Drop
     C                     Z-ADD*ZERO     TRAIC3           Company Number
     C                     Z-ADD*ZERO     TRC4NB           Order Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TVM8NB           System Value Nu
     C                     Z-ADD*ZERO     TVAATM           Job Time
     C                     Z-ADD*ZERO     TVAXDT           Job Date
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHCHRC.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  80
     C                     Z-ADD*ZERO     WL0003  40
     C                     MOVEL*BLANK    WL0004 25
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  61
     C                     MOVEL*BLANK    WL0008  1
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  6
     C                     Z-ADD*ZERO     WL0011  80
     C                     Z-ADD*ZERO     WL0012  60
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  80
     C                     Z-ADD*ZERO     WL0015  40
     C                     MOVEL*BLANK    WL0016 25
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  80
     C                     Z-ADD*ZERO     WL0023  40
     C                     MOVEL*BLANK    WL0024 25
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  80
     C                     MOVEL*BLANK    WL0027 10
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  80
     C                     Z-ADD*ZERO     WL0030  40
     C                     MOVEL*BLANK    WL0031 25
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  80
     C                     Z-ADD*ZERO     WL0037  40
     C                     MOVEL*BLANK    WL0038 25
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040 112
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  80
     C                     Z-ADD*ZERO     WL0043  40
     C                     MOVEL*BLANK    WL0044 25
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046 50
     C                     MOVEL*BLANK    WL0047  3
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  80
     C                     Z-ADD*ZERO     WL0050  40
     C                     MOVEL*BLANK    WL0051 25
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  50
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0054 30
     C                     MOVEL*BLANK    WL0055  4
     C                     MOVEL*BLANK    WL0056  3
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0057  3
      * Define local variables for subroutine SXCRRC.
     C                     MOVEL*BLANK    WL0058  3
     C                     MOVEL*BLANK    WL0059 30
     C                     MOVEL*BLANK    WL0060 30
     C                     MOVEL*BLANK    WL0061 30
     C                     MOVEL*BLANK    WL0062 30
     C                     MOVEL*BLANK    WL0063 20
     C                     MOVEL*BLANK    WL0064 11
     C                     Z-ADD*ZERO     WL0065 110
     C                     MOVEL*BLANK    WL0066  2
     C                     Z-ADD*ZERO     WL0067  70
     C                     MOVEL*BLANK    WL0068 25
     C                     Z-ADD*ZERO     WL0069 112
     C                     Z-ADD*ZERO     WL0070 112
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072 112
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074 30
     C                     MOVEL*BLANK    WL0075 30
     C                     MOVEL*BLANK    WL0076 10
     C                     Z-ADD*ZERO     WL0077 110
     C                     Z-ADD*ZERO     WL0078 110
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080  72
     C                     Z-ADD*ZERO     WL0081  72
     C                     Z-ADD*ZERO     WL0082  72
     C                     MOVEL*BLANK    WL0083  3
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  70
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090 114
     C                     Z-ADD*ZERO     WL0091 114
     C                     Z-ADD*ZERO     WL0092 114
     C                     Z-ADD*ZERO     WL0093 114
     C                     Z-ADD*ZERO     WL0094 114
     C                     Z-ADD*ZERO     WL0095 114
     C                     Z-ADD*ZERO     WL0096 112
     C                     Z-ADD*ZERO     WL0097 112
     C                     Z-ADD*ZERO     WL0098 112
     C                     Z-ADD*ZERO     WL0099 112
     C                     Z-ADD*ZERO     WL0100 112
     C                     Z-ADD*ZERO     WL0101 112
     C                     Z-ADD*ZERO     WL0102 114
     C                     Z-ADD*ZERO     WL0103 114
     C                     Z-ADD*ZERO     WL0104 114
     C                     Z-ADD*ZERO     WL0105 114
     C                     Z-ADD*ZERO     WL0106 114
     C                     Z-ADD*ZERO     WL0107 114
     C                     Z-ADD*ZERO     WL0108  70
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110 30
     C                     MOVEL*BLANK    WL0111 30
     C                     MOVEL*BLANK    WL0112 20
     C                     MOVEL*BLANK    WL0113  2
     C                     MOVEL*BLANK    WL0114 11
     C                     Z-ADD*ZERO     WL0115 110
     C                     MOVEL*BLANK    WL0116 25
     C                     Z-ADD*ZERO     WL0117 110
     C                     Z-ADD*ZERO     WL0118 110
     C                     Z-ADD*ZERO     WL0119  70
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123  1
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     Z-ADD*ZERO     WL0127  60
     C                     MOVEL*BLANK    WL0128 10
     C                     MOVEL*BLANK    WL0129 10
     C                     Z-ADD*ZERO     WL0130  70
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0131  7
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  70
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  80
     C                     Z-ADD*ZERO     WL0136  40
     C                     MOVEL*BLANK    WL0137 25
     C                     Z-ADD*ZERO     WL0138  70
     C                     MOVEL*BLANK    WL0139 10
     C                     MOVEL*BLANK    WL0140 15
     C                     MOVEL*BLANK    WL0141 20
     C                     MOVEL*BLANK    WL0142 15
     C                     MOVEL*BLANK    WL0143 30
     C                     MOVEL*BLANK    WL0144 20
     C                     MOVEL*BLANK    WL0145 30
     C                     MOVEL*BLANK    WL0146 50
     C                     MOVEL*BLANK    WL0147 50
     C                     MOVEL*BLANK    WL0148 50
     C                     MOVEL*BLANK    WL0149 50
     C                     MOVEL*BLANK    WL0150 50
     C                     MOVEL*BLANK    WL0151 20
     C                     MOVEL*BLANK    WL0152 10
     C                     Z-ADD*ZERO     WL0153  80
     C                     Z-ADD*ZERO     WL0154  80
     C                     MOVEL*BLANK    WL0155 25
     C                     MOVEL*BLANK    WL0156  3
     C                     Z-ADD*ZERO     WL0157  70
     C                     Z-ADD*ZERO     WL0158  40
     C                     MOVEL*BLANK    WL0159  1
      * Define local variables for subroutine TBCHRC.
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  80
     C                     Z-ADD*ZERO     WL0162  40
     C                     MOVEL*BLANK    WL0163 25
     C                     Z-ADD*ZERO     WL0164  70
     C                     MOVEL*BLANK    WL0165 10
     C                     Z-ADD*ZERO     WL0166  80
     C                     Z-ADD*ZERO     WL0167  40
     C                     Z-ADD*ZERO     WL0168  80
     C                     Z-ADD*ZERO     WL0169  40
     C                     Z-ADD*ZERO     WL0170  80
     C                     Z-ADD*ZERO     WL0171  40
     C                     Z-ADD*ZERO     WL0172  80
     C                     Z-ADD*ZERO     WL0173  40
     C                     MOVEL*BLANK    WL0174 10
     C                     MOVEL*BLANK    WL0175 10
     C                     MOVEL*BLANK    WL0176 50
     C                     MOVEL*BLANK    WL0177 50
     C                     MOVEL*BLANK    WL0178 50
     C                     MOVEL*BLANK    WL0179 50
     C                     MOVEL*BLANK    WL0180 50
     C                     MOVEL*BLANK    WL0181 20
     C                     MOVEL*BLANK    WL0182 10
     C                     Z-ADD*ZERO     WL0183 112
     C                     MOVEL*BLANK    WL0184 10
     C                     Z-ADD*ZERO     WL0185  80
     C                     Z-ADD*ZERO     WL0186  40
     C                     Z-ADD*ZERO     WL0187  80
     C                     Z-ADD*ZERO     WL0188  40
     C                     MOVEL*BLANK    WL0189  3
     C                     MOVEL*BLANK    WL0190 25
     C                     MOVEL*BLANK    WL0191  1
     C                     Z-ADD*ZERO     WL0192  30
     C                     MOVEL*BLANK    WL0193  6
     C                     Z-ADD*ZERO     WL0194  80
     C                     Z-ADD*ZERO     WL0195  60
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0196  30
     C                     Z-ADD*ZERO     WL0197  70
     C                     Z-ADD*ZERO     WL0198  70
     C                     MOVEL*BLANK    WL0199  2
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0200  70
     C                     MOVEL*BLANK    WL0201  1
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0202  30
     C                     Z-ADD*ZERO     WL0203  70
     C                     MOVEL*BLANK    WL0204  3
     C                     Z-ADD*ZERO     WL0205  70
     C                     Z-ADD*ZERO     WL0206 112
     C                     MOVEL*BLANK    WL0207  2
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0208  30
     C                     Z-ADD*ZERO     WL0209  70
     C                     Z-ADD*ZERO     WL0210  70
      * Define local variables for subroutine TKCHRC.
     C                     Z-ADD*ZERO     WL0211  30
     C                     Z-ADD*ZERO     WL0212  70
     C                     Z-ADD*ZERO     WL0213  70
     C                     Z-ADD*ZERO     WL0214  50
     C                     MOVEL*BLANK    WL0215  3
     C                     MOVEL*BLANK    WL0216 20
     C                     MOVEL*BLANK    WL0217 25
     C                     MOVEL*BLANK    WL0218 30
     C                     MOVEL*BLANK    WL0219 15
     C                     MOVEL*BLANK    WL0220 15
     C                     MOVEL*BLANK    WL0221 20
     C                     Z-ADD*ZERO     WL0222  70
     C                     Z-ADD*ZERO     WL0223  70
     C                     Z-ADD*ZERO     WL0224  70
     C                     MOVEL*BLANK    WL0225  3
     C                     MOVEL*BLANK    WL0226  1
     C                     MOVEL*BLANK    WL0227 12
     C                     MOVEL*BLANK    WL0228 35
     C                     MOVEL*BLANK    WL0229 75
     C                     Z-ADD*ZERO     WL0230 110
     C                     Z-ADD*ZERO     WL0231 110
     C                     Z-ADD*ZERO     WL0232 110
     C                     Z-ADD*ZERO     WL0233 110
     C                     Z-ADD*ZERO     WL0234 112
     C                     Z-ADD*ZERO     WL0235 112
     C                     Z-ADD*ZERO     WL0236 112
     C                     Z-ADD*ZERO     WL0237  70
     C                     Z-ADD*ZERO     WL0238  70
     C                     Z-ADD*ZERO     WL0239  70
     C                     Z-ADD*ZERO     WL0240  70
     C                     MOVEL*BLANK    WL0241  4
     C                     MOVEL*BLANK    WL0242  4
     C                     MOVEL*BLANK    WL0243  4
     C                     MOVEL*BLANK    WL0244  2
     C                     MOVEL*BLANK    WL0245  2
     C                     MOVEL*BLANK    WL0246  2
     C                     MOVEL*BLANK    WL0247  3
     C                     MOVEL*BLANK    WL0248  3
     C                     MOVEL*BLANK    WL0249  3
     C                     MOVEL*BLANK    WL0250  5
     C                     MOVEL*BLANK    WL0251  5
     C                     Z-ADD*ZERO     WL0252  50
     C                     MOVEL*BLANK    WL0253 38
     C                     MOVEL*BLANK    WL0254  6
     C                     MOVEL*BLANK    WL0255  6
     C                     MOVEL*BLANK    WL0256  6
     C                     MOVEL*BLANK    WL0257  6
     C                     MOVEL*BLANK    WL0258  6
     C                     MOVEL*BLANK    WL0259  1
     C                     MOVEL*BLANK    WL0260  1
     C                     MOVEL*BLANK    WL0261 10
     C                     MOVEL*BLANK    WL0262 10
     C                     MOVEL*BLANK    WL0263 10
     C                     MOVEL*BLANK    WL0264 15
     C                     MOVEL*BLANK    WL0265 15
     C                     MOVEL*BLANK    WL0266 15
     C                     MOVEL*BLANK    WL0267 30
     C                     MOVEL*BLANK    WL0268 30
     C                     MOVEL*BLANK    WL0269 30
     C                     MOVEL*BLANK    WL0270 50
     C                     MOVEL*BLANK    WL0271 50
     C                     Z-ADD*ZERO     WL0272  30
     C                     Z-ADD*ZERO     WL0273  30
     C                     Z-ADD*ZERO     WL0274  30
     C                     Z-ADD*ZERO     WL0275  52
     C                     Z-ADD*ZERO     WL0276  52
     C                     Z-ADD*ZERO     WL0277  50
     C                     Z-ADD*ZERO     WL0278  60
     C                     Z-ADD*ZERO     WL0279  60
     C                     Z-ADD*ZERO     WL0280  60
     C                     Z-ADD*ZERO     WL0281  60
     C                     Z-ADD*ZERO     WL0282  90
     C                     Z-ADD*ZERO     WL0283  90
     C                     Z-ADD*ZERO     WL0284  90
     C                     Z-ADD*ZERO     WL0285  96
     C                     MOVEL*BLANK    WL0286 15
     C                     MOVEL*BLANK    WL0287  1
     C                     MOVEL*BLANK    WL0288  1
     C                     MOVEL*BLANK    WL0289  2
     C                     MOVEL*BLANK    WL0290  2
     C                     MOVEL*BLANK    WL0291  5
     C                     MOVEL*BLANK    WL0292  5
     C                     MOVEL*BLANK    WL0293 15
     C                     MOVEL*BLANK    WL0294 15
     C                     MOVEL*BLANK    WL0295 30
     C                     Z-ADD*ZERO     WL0296  70
     C                     Z-ADD*ZERO     WL0297  70
     C                     MOVEL*BLANK    WL0298  1
     C                     MOVEL*BLANK    WL0299  1
     C                     MOVEL*BLANK    WL0300  1
     C                     MOVEL*BLANK    WL0301  1
     C                     Z-ADD*ZERO     WL0302  60
     C                     MOVEL*BLANK    WL0303 10
     C                     MOVEL*BLANK    WL0304 10
     C                     Z-ADD*ZERO     WL0305  70
      * Define local variables for subroutine TLCRRC.
     C                     Z-ADD*ZERO     WL0306  30
     C                     Z-ADD*ZERO     WL0307  70
     C                     Z-ADD*ZERO     WL0308  70
     C                     Z-ADD*ZERO     WL0309  50
     C                     MOVEL*BLANK    WL0310  3
     C                     MOVEL*BLANK    WL0311 20
     C                     MOVEL*BLANK    WL0312 25
     C                     MOVEL*BLANK    WL0313 30
     C                     MOVEL*BLANK    WL0314 15
     C                     MOVEL*BLANK    WL0315 15
     C                     MOVEL*BLANK    WL0316 20
     C                     Z-ADD*ZERO     WL0317  70
     C                     Z-ADD*ZERO     WL0318  70
     C                     Z-ADD*ZERO     WL0319  70
     C                     MOVEL*BLANK    WL0320  3
     C                     MOVEL*BLANK    WL0321  1
     C                     MOVEL*BLANK    WL0322 12
     C                     MOVEL*BLANK    WL0323 35
     C                     MOVEL*BLANK    WL0324 75
     C                     Z-ADD*ZERO     WL0325 110
     C                     Z-ADD*ZERO     WL0326 110
     C                     Z-ADD*ZERO     WL0327 110
     C                     Z-ADD*ZERO     WL0328 110
     C                     Z-ADD*ZERO     WL0329 112
     C                     Z-ADD*ZERO     WL0330 112
     C                     Z-ADD*ZERO     WL0331 112
     C                     Z-ADD*ZERO     WL0332  70
     C                     Z-ADD*ZERO     WL0333  70
     C                     Z-ADD*ZERO     WL0334  70
     C                     Z-ADD*ZERO     WL0335  70
     C                     MOVEL*BLANK    WL0336  4
     C                     MOVEL*BLANK    WL0337  4
     C                     MOVEL*BLANK    WL0338  4
     C                     MOVEL*BLANK    WL0339  2
     C                     MOVEL*BLANK    WL0340  2
     C                     MOVEL*BLANK    WL0341  2
     C                     MOVEL*BLANK    WL0342  3
     C                     MOVEL*BLANK    WL0343  3
     C                     MOVEL*BLANK    WL0344  3
     C                     MOVEL*BLANK    WL0345  5
     C                     MOVEL*BLANK    WL0346  5
     C                     Z-ADD*ZERO     WL0347  50
     C                     MOVEL*BLANK    WL0348 38
     C                     MOVEL*BLANK    WL0349  6
     C                     MOVEL*BLANK    WL0350  6
     C                     MOVEL*BLANK    WL0351  6
     C                     MOVEL*BLANK    WL0352  6
     C                     MOVEL*BLANK    WL0353  6
     C                     MOVEL*BLANK    WL0354  1
     C                     MOVEL*BLANK    WL0355  1
     C                     MOVEL*BLANK    WL0356 10
     C                     MOVEL*BLANK    WL0357 10
     C                     MOVEL*BLANK    WL0358 10
     C                     MOVEL*BLANK    WL0359 15
     C                     MOVEL*BLANK    WL0360 15
     C                     MOVEL*BLANK    WL0361 15
     C                     MOVEL*BLANK    WL0362 30
     C                     MOVEL*BLANK    WL0363 30
     C                     MOVEL*BLANK    WL0364 30
     C                     MOVEL*BLANK    WL0365 50
     C                     MOVEL*BLANK    WL0366 50
     C                     Z-ADD*ZERO     WL0367  30
     C                     Z-ADD*ZERO     WL0368  30
     C                     Z-ADD*ZERO     WL0369  30
     C                     Z-ADD*ZERO     WL0370  52
     C                     Z-ADD*ZERO     WL0371  52
     C                     Z-ADD*ZERO     WL0372  50
     C                     Z-ADD*ZERO     WL0373  60
     C                     Z-ADD*ZERO     WL0374  60
     C                     Z-ADD*ZERO     WL0375  60
     C                     Z-ADD*ZERO     WL0376  60
     C                     Z-ADD*ZERO     WL0377  90
     C                     Z-ADD*ZERO     WL0378  90
     C                     Z-ADD*ZERO     WL0379  90
     C                     Z-ADD*ZERO     WL0380  96
     C                     MOVEL*BLANK    WL0381 15
     C                     MOVEL*BLANK    WL0382  1
     C                     MOVEL*BLANK    WL0383  1
     C                     MOVEL*BLANK    WL0384  2
     C                     MOVEL*BLANK    WL0385  2
     C                     MOVEL*BLANK    WL0386  5
     C                     MOVEL*BLANK    WL0387  5
     C                     MOVEL*BLANK    WL0388 15
     C                     MOVEL*BLANK    WL0389 15
     C                     MOVEL*BLANK    WL0390 30
     C                     Z-ADD*ZERO     WL0391  70
     C                     Z-ADD*ZERO     WL0392  70
     C                     MOVEL*BLANK    WL0393  1
     C                     MOVEL*BLANK    WL0394  1
     C                     MOVEL*BLANK    WL0395  1
     C                     MOVEL*BLANK    WL0396  1
     C                     Z-ADD*ZERO     WL0397  60
     C                     MOVEL*BLANK    WL0398 10
     C                     MOVEL*BLANK    WL0399 10
     C                     Z-ADD*ZERO     WL0400  70
      * Define local variables for subroutine TMDLRC.
     C                     Z-ADD*ZERO     WL0401  70
     C                     Z-ADD*ZERO     WL0402  50
      * Define local variables for subroutine TNCHRC.
     C                     Z-ADD*ZERO     WL0403  30
     C                     Z-ADD*ZERO     WL0404  70
     C                     Z-ADD*ZERO     WL0405  60
     C                     Z-ADD*ZERO     WL0406  60
      * Define local variables for subroutine TQRVGN.
     C                     Z-ADD*ZERO     WL0407  30
     C                     Z-ADD*ZERO     WL0408  70
     C                     Z-ADD*ZERO     WL0409  50
     C                     MOVEL*BLANK    WL0410  2
     C                     Z-ADD*ZERO     WL0411  70
     C                     MOVEL*BLANK    WL0412  1
     C                     Z-ADD*ZERO     WL0413  70
      * Define local variables for subroutine TRCRRC.
     C                     Z-ADD*ZERO     WL0414  30
     C                     Z-ADD*ZERO     WL0415  70
     C                     Z-ADD*ZERO     WL0416  50
     C                     MOVEL*BLANK    WL0417  2
     C                     Z-ADD*ZERO     WL0418  30
     C                     Z-ADD*ZERO     WL0419  70
     C                     MOVEL*BLANK    WL0420  2
     C                     Z-ADD*ZERO     WL0421  70
     C                     MOVEL*BLANK    WL0422  1
     C                     MOVEL*BLANK    WL0423  1
     C                     MOVEL*BLANK    WL0424  1
     C                     Z-ADD*ZERO     WL0425  30
     C                     Z-ADD*ZERO     WL0426  70
     C                     Z-ADD*ZERO     WL0427  50
     C                     Z-ADD*ZERO     WL0428  70
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0429  30
     C                     Z-ADD*ZERO     WL0430  70
     C                     Z-ADD*ZERO     WL0431  70
     C                     Z-ADD*ZERO     WL0432  60
      * Define local variables for subroutine TWCHRC.
     C                     Z-ADD*ZERO     WL0433  30
     C                     Z-ADD*ZERO     WL0434  70
     C                     Z-ADD*ZERO     WL0435  70
     C                     Z-ADD*ZERO     WL0436  50
     C                     MOVEL*BLANK    WL0437  3
     C                     MOVEL*BLANK    WL0438 20
     C                     MOVEL*BLANK    WL0439 25
     C                     MOVEL*BLANK    WL0440 30
     C                     MOVEL*BLANK    WL0441 15
     C                     MOVEL*BLANK    WL0442 15
     C                     MOVEL*BLANK    WL0443 20
     C                     Z-ADD*ZERO     WL0444  70
     C                     Z-ADD*ZERO     WL0445  70
     C                     Z-ADD*ZERO     WL0446  70
     C                     MOVEL*BLANK    WL0447  3
     C                     MOVEL*BLANK    WL0448  1
     C                     MOVEL*BLANK    WL0449 12
     C                     MOVEL*BLANK    WL0450 35
     C                     MOVEL*BLANK    WL0451 75
     C                     Z-ADD*ZERO     WL0452 110
     C                     Z-ADD*ZERO     WL0453 110
     C                     Z-ADD*ZERO     WL0454 110
     C                     Z-ADD*ZERO     WL0455 110
     C                     Z-ADD*ZERO     WL0456 112
     C                     Z-ADD*ZERO     WL0457 112
     C                     Z-ADD*ZERO     WL0458 112
     C                     Z-ADD*ZERO     WL0459  70
     C                     Z-ADD*ZERO     WL0460  70
     C                     Z-ADD*ZERO     WL0461  70
     C                     Z-ADD*ZERO     WL0462  70
     C                     MOVEL*BLANK    WL0463  4
     C                     MOVEL*BLANK    WL0464  4
     C                     MOVEL*BLANK    WL0465  4
     C                     MOVEL*BLANK    WL0466  2
     C                     MOVEL*BLANK    WL0467  2
     C                     MOVEL*BLANK    WL0468  2
     C                     MOVEL*BLANK    WL0469  3
     C                     MOVEL*BLANK    WL0470  3
     C                     MOVEL*BLANK    WL0471  3
     C                     MOVEL*BLANK    WL0472  5
     C                     MOVEL*BLANK    WL0473  5
     C                     Z-ADD*ZERO     WL0474  50
     C                     MOVEL*BLANK    WL0475 38
     C                     MOVEL*BLANK    WL0476  6
     C                     MOVEL*BLANK    WL0477  6
     C                     MOVEL*BLANK    WL0478  6
     C                     MOVEL*BLANK    WL0479  6
     C                     MOVEL*BLANK    WL0480  6
     C                     MOVEL*BLANK    WL0481  1
     C                     MOVEL*BLANK    WL0482  1
     C                     MOVEL*BLANK    WL0483 10
     C                     MOVEL*BLANK    WL0484 10
     C                     MOVEL*BLANK    WL0485 10
     C                     MOVEL*BLANK    WL0486 15
     C                     MOVEL*BLANK    WL0487 15
     C                     MOVEL*BLANK    WL0488 15
     C                     MOVEL*BLANK    WL0489 30
     C                     MOVEL*BLANK    WL0490 30
     C                     MOVEL*BLANK    WL0491 30
     C                     MOVEL*BLANK    WL0492 50
     C                     MOVEL*BLANK    WL0493 50
     C                     Z-ADD*ZERO     WL0494  30
     C                     Z-ADD*ZERO     WL0495  30
     C                     Z-ADD*ZERO     WL0496  30
     C                     Z-ADD*ZERO     WL0497  52
     C                     Z-ADD*ZERO     WL0498  52
     C                     Z-ADD*ZERO     WL0499  50
     C                     Z-ADD*ZERO     WL0500  60
     C                     Z-ADD*ZERO     WL0501  60
     C                     Z-ADD*ZERO     WL0502  60
     C                     Z-ADD*ZERO     WL0503  60
     C                     Z-ADD*ZERO     WL0504  90
     C                     Z-ADD*ZERO     WL0505  90
     C                     Z-ADD*ZERO     WL0506  90
     C                     Z-ADD*ZERO     WL0507  96
     C                     MOVEL*BLANK    WL0508 15
     C                     MOVEL*BLANK    WL0509  1
     C                     MOVEL*BLANK    WL0510  1
     C                     MOVEL*BLANK    WL0511  2
     C                     MOVEL*BLANK    WL0512  2
     C                     MOVEL*BLANK    WL0513  5
     C                     MOVEL*BLANK    WL0514  5
     C                     MOVEL*BLANK    WL0515 15
     C                     MOVEL*BLANK    WL0516 15
     C                     MOVEL*BLANK    WL0517 30
     C                     Z-ADD*ZERO     WL0518  70
     C                     Z-ADD*ZERO     WL0519  70
     C                     MOVEL*BLANK    WL0520  1
     C                     MOVEL*BLANK    WL0521  1
     C                     MOVEL*BLANK    WL0522  1
     C                     MOVEL*BLANK    WL0523  1
     C                     Z-ADD*ZERO     WL0524  60
     C                     MOVEL*BLANK    WL0525 10
     C                     MOVEL*BLANK    WL0526 10
     C                     Z-ADD*ZERO     WL0527  70
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0528  70
     C                     Z-ADD*ZERO     WL0529  30
     C                     MOVEL*BLANK    WL0530  1
      * Define local variables for subroutine TYCHRC.
     C                     Z-ADD*ZERO     WL0531  70
     C                     MOVEL*BLANK    WL0532  1
      * Define local variables for subroutine NORVGN.
     C                     Z-ADD*ZERO     WL0533  70
     C                     MOVEL*BLANK    WL0534  3
      * Define local variables for subroutine OBRVGN.
     C                     Z-ADD*ZERO     WL0535  70
     C                     Z-ADD*ZERO     WL0536  50
     C                     Z-ADD*ZERO     WL0537  70
     C                     Z-ADD*ZERO     WL0538  50
      * Define local variables for subroutine OLRVGN.
     C                     Z-ADD*ZERO     WL0539  70
     C                     MOVEL*BLANK    WL0540  1
      * Define local variables for subroutine OPRVGN.
     C                     Z-ADD*ZERO     WL0541  30
     C                     MOVEL*BLANK    WL0542  6
     C                     MOVEL*BLANK    WL0543  1
     C                     MOVEL*BLANK    WL0544  1
      * Define local variables for subroutine OQRVGN.
     C                     Z-ADD*ZERO     WL0545  70
     C                     Z-ADD*ZERO     WL0546  60
     C                     Z-ADD*ZERO     WL0547  30
      * Define local variables for subroutine ORRVGN.
     C                     Z-ADD*ZERO     WL0548  70
     C                     Z-ADD*ZERO     WL0549  30
      * Define local variables for subroutine OSCRRC.
     C                     Z-ADD*ZERO     WL0550  70
     C                     Z-ADD*ZERO     WL0551  60
     C                     Z-ADD*ZERO     WL0552  30
     C                     Z-ADD*ZERO     WL0553  70
     C                     Z-ADD*ZERO     WL0554  50
     C                     MOVEL*BLANK    WL0555  6
     C                     MOVEL*BLANK    WL0556  3
     C                     MOVEL*BLANK    WL0557 12
     C                     MOVEL*BLANK    WL0558 12
     C                     MOVEL*BLANK    WL0559 10
     C                     MOVEL*BLANK    WL0560 10
     C                     MOVEL*BLANK    WL0561  3
     C                     MOVEL*BLANK    WL0562  3
     C                     Z-ADD*ZERO     WL0563  30
     C                     Z-ADD*ZERO     WL0564  70
      * Define local variables for subroutine OTCHRC.
     C                     Z-ADD*ZERO     WL0565  70
     C                     MOVEL*BLANK    WL0566  1
     C                     Z-ADD*ZERO     WL0567 112
      * Define local variables for subroutine OURVGN.
     C                     MOVEL*BLANK    WL0568 10
     C                     MOVEL*BLANK    WL0569 40
      * Define local variables for subroutine OVRVGN.
     C                     Z-ADD*ZERO     WL0570  70
     C                     Z-ADD*ZERO     WL0571  50
      * Define local variables for subroutine PACHRC.
     C                     Z-ADD*ZERO     WL0572  30
     C                     Z-ADD*ZERO     WL0573  70
     C                     Z-ADD*ZERO     WL0574  30
     C                     Z-ADD*ZERO     WL0575  30
     C                     Z-ADD*ZERO     WL0576 112
      * Define local work field TMS Late Reason Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Check 856 Ready Y/N USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field TMS Carrier SCAC
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Status Flag 10 Y/N
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Status Flag 10 Y/N
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field TMS Planned Date
     C                     Z-ADD*ZERO     YL0015  80
      * Define local work field TMS Location Code
     C                     MOVEL*BLANK    YL0016 10
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field TMS State Province
     C                     MOVEL*BLANK    YL0019 50
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Default Load Sequence
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field SCAC
     C                     MOVEL*BLANK    YL0023  4
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0026  7
      * Define local work field Text 2
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Number 1.0 USR
     C                     Z-ADD*ZERO     YL0028  10
      * Define local work field Name
     C                     MOVEL*BLANK    YL0029 30
      * Define local work field SSI Download Flag
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field unused status 2
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field unused status 3
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Maximum pounds
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field Minimum pounds
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field LTL Flag
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0040  60
      * Define local work field On Time - (Y/N)
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field LH Unused Sts
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Partial Load
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Late Billing Email Flag
     C                     MOVEL*BLANK    YL0046 15
      * Define local work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field LH Unused Sts 5
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Load U/M
     C                     MOVEL*BLANK    YL0049  2
      * Define local work field TPM Shipment Status
     C                     MOVEL*BLANK    YL0050  2
      * Define local work field LH Unused Sts 8
     C                     MOVEL*BLANK    YL0051  2
      * Define local work field LH Held Over Reason
     C                     MOVEL*BLANK    YL0052  3
      * Define local work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YL0053  70
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0057  30
      * Define local work field Load ID USR
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field Event Code Last
     C                     MOVEL*BLANK    YL0059  2
      * Define local work field Load Status New
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0061 12
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field Actual Delivery Date
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0064  70
      * Define local work field Date Out (6,0) USR
     C                     Z-ADD*ZERO     YL0065  60
      * Define local work field Original Appointment Date
     C                     Z-ADD*ZERO     YL0066  60
      * Define local work field Original Appointment Time
     C                     Z-ADD*ZERO     YL0067  60
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0068  60
      * Define local work field Actual Delivery time
     C                     Z-ADD*ZERO     YL0069  60
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0070  60
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field On Time Add'l Rsn Unused
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field LD Unused Time 2
     C                     Z-ADD*ZERO     YL0073  60
      * Define local work field LD Unused Sts 2
     C                     MOVEL*BLANK    YL0074  1
      * Define local work field HPB Transload Station
     C                     MOVEL*BLANK    YL0075  2
      * Define local work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YL0076 15
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0077  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0078  70
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0079  3
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0080  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0081  4
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0082  2
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0083  2
      * Define local work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YL0084  2
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0085  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0086  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0087  5
      * Define local work field OHE EDI Error Reasons 2
     C                     MOVEL*BLANK    YL0088  5
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0089  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0090  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0091  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0092  6
      * Define local work field OHE EDI 856 Action
     C                     MOVEL*BLANK    YL0093  1
      * Define local work field OHE EDI 824 Action
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field OHE Email BOL/Sent
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field OHE EDI Order Automated
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field OHE Unused Status 3
     C                     MOVEL*BLANK    YL0097  2
      * Define local work field OHE Unused Status 4
     C                     MOVEL*BLANK    YL0098  2
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0099  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0100  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0102  1
      * Define local work field Company Number     051922
     C                     Z-ADD*ZERO     YL0103  30
      * Define local work field Carrier Code Usr
     C                     MOVEL*BLANK    YL0104  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0105  30
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0106  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0107  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0108  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0109  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0110  70
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0111  50
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0112  1
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0113  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0114  60
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0115  70
      * Define local work field Time
     C                     Z-ADD*ZERO     YL0116  60
      * Define local work field Total Load Order Weight
     C                     Z-ADD*ZERO     YL0117  70
      * Define local work field Truck Size
     C                     MOVEL*BLANK    YL0118  7
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0119  52
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0120 20
      * Define local work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YL0121  70
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0122  70
      * Define local work field Actual Delivery Date
     C                     Z-ADD*ZERO     YL0123  70
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0124  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0125  60
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0126  30
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0002  2
      * Define local work field Date Out (6,0) USR
     C                     Z-ADD*ZERO     YL0127  60
      * Define local work field Original Appointment Date
     C                     Z-ADD*ZERO     YL0128  60
      * Define local work field Original Appointment Time
     C                     Z-ADD*ZERO     YL0129  60
      * Define local work field Actual Delivery time
     C                     Z-ADD*ZERO     YL0130  60
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0131  60
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0132  1
      * Define local work field Carrier Ref PRO/Inv
     C                     MOVEL*BLANK    YL0133 25
      * Define local work field Cust Assigned Appt #
     C                     MOVEL*BLANK    YL0134 25
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0135 12
      * Define local work field *SFLSEL
     C                     MOVEL*BLANK    YL0136  1
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0137  1
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0003  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0138  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0139  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0140  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0141  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0142  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0004 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0143  1
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0144  30
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0145 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0146 155
      * Define local work field Created Time
     C                     Z-ADD*ZERO     YL0147  60
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0148  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0149  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0150  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 TENDER REJ
00002 TENDER EXP
00003 CANCELLED
00004 WAREHOUSE
00005 Y2U0016
00006 Y2U0005
00007 DELIVERED
00008 EXPORT
00009 COLLECT
00010 BOOKED
00011 IN TRANSIT
00012 TENDERED
00013 PENDING
00014 PICKUP
00015 Y2U0003
00016 ORDEVT
00017 PDIZPCLP
00018 Auto Print Prelim. Pick
00019 PDSNPFR
00020 PLTFLRSYS
