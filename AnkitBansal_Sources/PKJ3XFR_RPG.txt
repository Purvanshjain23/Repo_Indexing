     H/TITLE Clc Shrd Risk Sliding XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : SYNON/2  Version:  1054
     H* Function type : Execute external function
      *
     H* Company       :    Hog Procurement & Evaluation
     H* System        : HPEMDL
     H* User name     : ISSMASO
     H* Date          : 09/29/95  Time  : 15:22:20
     H* Copyright     :    Hog Procurement & Evaluation
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * O :  TH CM Base Mkt Price
     I                                    P   1   32P1AMPR
      * I :  PSC Floor Price
     I                                    P   4   62P1AZPR
      * I :  PSC Ceiling Price
     I                                    P   7   92P1A0PR
      * I :  Market Price USR
     I                                    P  10  122P1BDPR
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AMPR    PARM P1AMPR    WP0001  52       TH CM Base Mkt
     C           P1AZPR    PARM           WP0002  52       PSC Floor Price
     C           P1A0PR    PARM           WP0003  52       PSC Ceiling Pri
     C           P1BDPR    PARM           WP0004  52       Market Price US
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Shrd Risk Sliding XF
      * CASE: Floor Price <= Market Price <= Ceiling Price
      *  - c1 AND c2
      *   |- c1    : PAR.Market Price USR GE PAR.PSC Floor Price
      *   |- c2    : PAR.Market Price USR LE PAR.PSC Ceiling Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BDPR    IFGE P1AZPR                     *IF
     C           P1BDPR    IFLE P1A0PR                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1BDPR    P1AMPR           TH CM Base Mkt
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Market Price USR LT PAR.PSC Floor Price
     C           P1BDPR    IFLT P1AZPR                     *IF
      * Floor Price - ((Floor Price - Market Price) / 2)
      * Mid Market & Floor
      * PAR.TH Base Mkt Price =
      *    *COMPUTE ((x1 - ((x1 - x2) / x3)))
      * x1    : PAR.PSC Floor Price
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.PSC Floor Price
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.Market Price USR
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.2
     C           P1AZPR    SUB  P1BDPR    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  2         W0WD01           *Synon (17,7) w
     C           P1AZPR    SUB  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P1AMPR           TH CM Base Mkt
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Market Price USR GT PAR.PSC Ceiling Price
     C           P1BDPR    IFGT P1A0PR                     *IF
      * Ceiling Price + ((Market Price - Ceiling Price) / 2)
      * Mid Ceiling & Market
      * PAR.TH Base Mkt Price =
      *    *COMPUTE ((x1 + ((x2 - x1) / x3)))
      * x1    : PAR.PSC Ceiling Price
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Market Price USR
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.PSC Ceiling Price
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.2
     C           P1BDPR    SUB  P1A0PR    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  2         W0WD01           *Synon (17,7) w
     C           P1A0PR    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P1AMPR           TH CM Base Mkt
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
