     H/TITLE Exc Maint Intl Legs   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 02/24/21  Time  : 15:14:59
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBCXCPL1IF  E           K        DISK
      * RTV : TMS International Shipmnt Retrieval index
      *
     FPBCWCPL0IF  E           K        DISK
      * RTV : TMS International Legs    Retrieval index
      *
     FPBCSCPL1IF  E           K        DISK
      * RTV : TMS Load Event            Retrieval index
      *
     FPBCUCPL1IF  E           K        DISK
      * RTV : TMS Load Event Shipment   Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPBCXCPL0UF  E           K        DISK                      A
      * UPD : TMS International Shipmnt Update index
      *
     FPBCUCPL0UF  E           K        DISK
      * UPD : TMS Load Event Shipment   Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FPBCSCPL0UF  E           K        DISK
      * UPD : TMS Load Event            Update index
      *
     FPBCWCPL1UF  E           K        DISK                      A
      * UPD : TMS International Legs    Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@CXCPX9
      * TMS International Shipmnt Retrieval index
      * Renamed input format fields
     I              CXTMLD                          WATMLD
     I              CXAYD8                          WAAYD8
     I              CXAFTH                          WAAFTH
     I              CXFSU1                          WAFSU1
     I              CXEVSQ                          WAEVSQ
     I              CXTMOR                          WATMOR
     I              CXDMSC                          WADMSC
     I              CXA1D8                          WAA1D8
     I              CXAHTH                          WAAHTH
     I              CXA2D8                          WAA2D8
     I              CXAITH                          WAAITH
     I              CXA3D8                          WAA3D8
     I              CXAJTH                          WAAJTH
     I              CXA4D8                          WAA4D8
     I              CXAKTH                          WAAKTH
     I              CXDNSC                          WADNSC
     I              CXUZAA                          WAUZAA
     I              CXFFU1                          WAFFU1
     I              CXUGU1                          WAUGU1
     I              CXFHU1                          WAFHU1
     I              CXU0AA                          WAU0AA
     I              CXU1AA                          WAU1AA
     I              CXU3AA                          WAU3AA
     I              CXU4AA                          WAU4AA
     I              CXG1NB                          WAG1NB
     I              CXDOSC                          WADOSC
     I              CXHFNB                          WAHFNB
     I              CXA6D8                          WAA6D8
     I              CXAMTH                          WAAMTH
     I              CXDLSC                          WADLSC
     I              CXTPRC                          WATPRC
     I              CXUYAA                          WAUYAA
     I              CXA0D8                          WAA0D8
     I              CXD9TM                          WAD9TM
      *
     I@CXCPX5
      * TMS International Shipmnt Update index
      * Renamed input format fields
     I              CXTMLD                          WBTMLD
     I              CXAYD8                          WBAYD8
     I              CXAFTH                          WBAFTH
     I              CXFSU1                          WBFSU1
     I              CXEVSQ                          WBEVSQ
     I              CXTMOR                          WBTMOR
     I              CXDMSC                          WBDMSC
     I              CXA1D8                          WBA1D8
     I              CXAHTH                          WBAHTH
     I              CXA2D8                          WBA2D8
     I              CXAITH                          WBAITH
     I              CXA3D8                          WBA3D8
     I              CXAJTH                          WBAJTH
     I              CXA4D8                          WBA4D8
     I              CXAKTH                          WBAKTH
     I              CXDNSC                          WBDNSC
     I              CXUZAA                          WBUZAA
     I              CXFFU1                          WBFFU1
     I              CXUGU1                          WBUGU1
     I              CXFHU1                          WBFHU1
     I              CXU0AA                          WBU0AA
     I              CXU1AA                          WBU1AA
     I              CXU3AA                          WBU3AA
     I              CXU4AA                          WBU4AA
     I              CXG1NB                          WBG1NB
     I              CXDOSC                          WBDOSC
     I              CXHFNB                          WBHFNB
     I              CXA6D8                          WBA6D8
     I              CXAMTH                          WBAMTH
     I              CXDLSC                          WBDLSC
     I              CXTPRC                          WBTPRC
     I              CXUYAA                          WBUYAA
     I              CXA0D8                          WBA0D8
     I              CXD9TM                          WBD9TM
      *
     I@CWCPX6
      * TMS International Legs    Retrieval index
      * Renamed input format fields
     I              CWTMLD                          WCTMLD
     I              CWAYD8                          WCAYD8
     I              CWAFTH                          WCAFTH
     I              CWFSU1                          WCFSU1
     I              CWUPAA                          WCUPAA
     I              CWLTMP                          WCLTMP
     I              CWDFSC                          WCDFSC
     I              CWDGSC                          WCDGSC
     I              CWDHSC                          WCDHSC
     I              CWDISC                          WCDISC
     I              CWDJSC                          WCDJSC
     I              CWDKSC                          WCDKSC
     I              CWUQAA                          WCUQAA
     I              CWURAA                          WCURAA
     I              CWUSAA                          WCUSAA
     I              CWCRDS                          WCCRDS
     I              CWAZD8                          WCAZD8
     I              CWAGTH                          WCAGTH
     I              CWUTAA                          WCUTAA
     I              CWUUAA                          WCUUAA
     I              CWUVAA                          WCUVAA
     I              CWUWAA                          WCUWAA
     I              CWUXAA                          WCUXAA
     I              CWFJU1                          WCFJU1
     I              CWFKU1                          WCFKU1
     I              CWFLU1                          WCFLU1
     I              CWFMU1                          WCFMU1
     I              CWFNU1                          WCFNU1
     I              CWFOU1                          WCFOU1
     I              CWFPU1                          WCFPU1
     I              CWFQU1                          WCFQU1
     I              CWA7D8                          WCA7D8
     I              CWA8D8                          WCA8D8
     I              CWDLSC                          WCDLSC
     I              CWTPRC                          WCTPRC
     I              CWUYAA                          WCUYAA
     I              CWA0D8                          WCA0D8
     I              CWD9TM                          WCD9TM
      *
     I@CSCPXP
      * TMS Load Event            Retrieval index
      * Renamed input format fields
     I              CSTMLD                          WDTMLD
     I              CSAYD8                          WDAYD8
     I              CSAFTH                          WDAFTH
     I              CSFSU1                          WDFSU1
     I              CSEVSQ                          WDEVSQ
     I              CSDMSC                          WDDMSC
     I              CSA1D8                          WDA1D8
     I              CSAHTH                          WDAHTH
     I              CSA2D8                          WDA2D8
     I              CSAITH                          WDAITH
     I              CSA3D8                          WDA3D8
     I              CSAJTH                          WDAJTH
     I              CSA4D8                          WDA4D8
     I              CSAKTH                          WDAKTH
     I              CSDNSC                          WDDNSC
     I              CSUZAA                          WDUZAA
     I              CSFFU1                          WDFFU1
     I              CSUGU1                          WDUGU1
     I              CSFHU1                          WDFHU1
     I              CSU0AA                          WDU0AA
     I              CSU1AA                          WDU1AA
     I              CSU3AA                          WDU3AA
     I              CSU4AA                          WDU4AA
     I              CSG1NB                          WDG1NB
     I              CSDOSC                          WDDOSC
     I              CSA6D8                          WDA6D8
     I              CSAMTH                          WDAMTH
     I              CSA9D8                          WDA9D8
     I              CSANTH                          WDANTH
     I              CSVBAA                          WDVBAA
     I              CSP5U1                          WDP5U1
     I              CSDLSC                          WDDLSC
     I              CSTPRC                          WDTPRC
     I              CSUYAA                          WDUYAA
     I              CSA0D8                          WDA0D8
     I              CSD9TM                          WDD9TM
      *
     I@CUCPXS
      * TMS Load Event Shipment   Retrieval index
      * Renamed input format fields
     I              CUTMLD                          WETMLD
     I              CUAYD8                          WEAYD8
     I              CUAFTH                          WEAFTH
     I              CUFSU1                          WEFSU1
     I              CUEVSQ                          WEEVSQ
     I              CUTMOR                          WETMOR
     I              CUHFNB                          WEHFNB
     I              CUDLSC                          WEDLSC
     I              CUTPRC                          WETPRC
     I              CUUYAA                          WEUYAA
     I              CUA0D8                          WEA0D8
     I              CUD9TM                          WED9TM
      *
     I@CUCPXR
      * TMS Load Event Shipment   Update index
      * Renamed input format fields
     I              CUTMLD                          WFTMLD
     I              CUAYD8                          WFAYD8
     I              CUAFTH                          WFAFTH
     I              CUFSU1                          WFFSU1
     I              CUEVSQ                          WFEVSQ
     I              CUTMOR                          WFTMOR
     I              CUHFNB                          WFHFNB
     I              CUDLSC                          WFDLSC
     I              CUTPRC                          WFTPRC
     I              CUUYAA                          WFUYAA
     I              CUA0D8                          WFA0D8
     I              CUD9TM                          WFD9TM
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WHAIC3
     I              AMC4NB                          WHC4NB
     I              AMRMNB                          WHRMNB
     I              AMRUNB                          WHRUNB
     I              AMXACD                          WHXACD
     I              AMOANA                          WHOANA
     I              AMHBAA                          WHHBAA
     I              AMJ0T1                          WHJ0T1
     I              AMGENY                          WHGENY
     I              AMJ1T1                          WHJ1T1
     I              AMHCAA                          WHHCAA
     I              AMQWDT                          WHQWDT
     I              AMQXDT                          WHQXDT
     I              AMQYDT                          WHQYDT
     I              AMHDAA                          WHHDAA
     I              AMCCTX                          WHCCTX
     I              AMJ2T1                          WHJ2T1
     I              AMRLNA                          WHRLNA
     I              AMRMNA                          WHRMNA
     I              AMGINY                          WHGINY
     I              AMGFNY                          WHGFNY
     I              AMGGNY                          WHGGNY
     I              AMGHNY                          WHGHNY
     I              AMHEVL                          WHHEVL
     I              AMHFVL                          WHHFVL
     I              AMHGVL                          WHHGVL
     I              AMQZDT                          WHQZDT
     I              AMQ0DT                          WHQ0DT
     I              AMQ1DT                          WHQ1DT
     I              AMQ2DT                          WHQ2DT
     I              AMC2TX                          WHC2TX
     I              AMC3TX                          WHC3TX
     I              AMC6TX                          WHC6TX
     I              AMCHTX                          WHCHTX
     I              AMCITX                          WHCITX
     I              AMCLTX                          WHCLTX
     I              AMB4TX                          WHB4TX
     I              AMCUTX                          WHCUTX
     I              AMCVTX                          WHCVTX
     I              AMB9TX                          WHB9TX
     I              AMJWSC                          WHJWSC
     I              AMITNY                          WHITNY
     I              AMLMT1                          WHLMT1
     I              AMLWAA                          WHLWAA
     I              AMFVST                          WHFVST
     I              AMF0ST                          WHF0ST
     I              AMF2ST                          WHF2ST
     I              AMF3ST                          WHF3ST
     I              AMJUSC                          WHJUSC
     I              AMJVSC                          WHJVSC
     I              AMV3T1                          WHV3T1
     I              AMV4T1                          WHV4T1
     I              AMV5T1                          WHV5T1
     I              AMV6T1                          WHV6T1
     I              AMV7T1                          WHV7T1
     I              AMV8T1                          WHV8T1
     I              AMV9T1                          WHV9T1
     I              AMWAT1                          WHWAT1
     I              AMWBT1                          WHWBT1
     I              AMWCT1                          WHWCT1
     I              AMWDT1                          WHWDT1
     I              AMQJNY                          WHQJNY
     I              AMQKNY                          WHQKNY
     I              AMQLNY                          WHQLNY
     I              AMP8NY                          WHP8NY
     I              AMP9NY                          WHP9NY
     I              AMQANY                          WHQANY
     I              AMQCNY                          WHQCNY
     I              AMQDNY                          WHQDNY
     I              AMQENY                          WHQENY
     I              AMQFNY                          WHQFNY
     I              AMQGNY                          WHQGNY
     I              AMQHNY                          WHQHNY
     I              AMQINY                          WHQINY
     I              AMQMNY                          WHQMNY
     I              AMMYU1                          WHMYU1
     I              AMJXSC                          WHJXSC
     I              AMJYSC                          WHJYSC
     I              AMJZSC                          WHJZSC
     I              AMJ0SC                          WHJ0SC
     I              AMMZU1                          WHMZU1
     I              AMM0U1                          WHM0U1
     I              AMM1U1                          WHM1U1
     I              AMM2U1                          WHM2U1
     I              AMM3U1                          WHM3U1
     I              AMW5DT                          WHW5DT
     I              AMW6DT                          WHW6DT
     I              AMUVST                          WHUVST
     I              AMUWST                          WHUWST
     I              AMUXST                          WHUXST
     I              AMVSST                          WHVSST
     I              AMAATM                          WHAATM
     I              AMAYNA                          WHAYNA
     I              AMA0NA                          WHA0NA
     I              AMAXDT                          WHAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     I@CSCPXO
      * TMS Load Event            Update index
      * Renamed input format fields
     I              CSTMLD                          WJTMLD
     I              CSAYD8                          WJAYD8
     I              CSAFTH                          WJAFTH
     I              CSFSU1                          WJFSU1
     I              CSEVSQ                          WJEVSQ
     I              CSDMSC                          WJDMSC
     I              CSA1D8                          WJA1D8
     I              CSAHTH                          WJAHTH
     I              CSA2D8                          WJA2D8
     I              CSAITH                          WJAITH
     I              CSA3D8                          WJA3D8
     I              CSAJTH                          WJAJTH
     I              CSA4D8                          WJA4D8
     I              CSAKTH                          WJAKTH
     I              CSDNSC                          WJDNSC
     I              CSUZAA                          WJUZAA
     I              CSFFU1                          WJFFU1
     I              CSUGU1                          WJUGU1
     I              CSFHU1                          WJFHU1
     I              CSU0AA                          WJU0AA
     I              CSU1AA                          WJU1AA
     I              CSU3AA                          WJU3AA
     I              CSU4AA                          WJU4AA
     I              CSG1NB                          WJG1NB
     I              CSDOSC                          WJDOSC
     I              CSA6D8                          WJA6D8
     I              CSAMTH                          WJAMTH
     I              CSA9D8                          WJA9D8
     I              CSANTH                          WJANTH
     I              CSVBAA                          WJVBAA
     I              CSP5U1                          WJP5U1
     I              CSDLSC                          WJDLSC
     I              CSTPRC                          WJTPRC
     I              CSUYAA                          WJUYAA
     I              CSA0D8                          WJA0D8
     I              CSD9TM                          WJD9TM
      *
     I@CWCPX7
      * TMS International Legs    Update index
      * Renamed input format fields
     I              CWTMLD                          WKTMLD
     I              CWAYD8                          WKAYD8
     I              CWAFTH                          WKAFTH
     I              CWFSU1                          WKFSU1
     I              CWUPAA                          WKUPAA
     I              CWLTMP                          WKLTMP
     I              CWDFSC                          WKDFSC
     I              CWDGSC                          WKDGSC
     I              CWDHSC                          WKDHSC
     I              CWDISC                          WKDISC
     I              CWDJSC                          WKDJSC
     I              CWDKSC                          WKDKSC
     I              CWUQAA                          WKUQAA
     I              CWURAA                          WKURAA
     I              CWUSAA                          WKUSAA
     I              CWCRDS                          WKCRDS
     I              CWAZD8                          WKAZD8
     I              CWAGTH                          WKAGTH
     I              CWUTAA                          WKUTAA
     I              CWUUAA                          WKUUAA
     I              CWUVAA                          WKUVAA
     I              CWUWAA                          WKUWAA
     I              CWUXAA                          WKUXAA
     I              CWFJU1                          WKFJU1
     I              CWFKU1                          WKFKU1
     I              CWFLU1                          WKFLU1
     I              CWFMU1                          WKFMU1
     I              CWFNU1                          WKFNU1
     I              CWFOU1                          WKFOU1
     I              CWFPU1                          WKFPU1
     I              CWFQU1                          WKFQU1
     I              CWA7D8                          WKA7D8
     I              CWA8D8                          WKA8D8
     I              CWDLSC                          WKDLSC
     I              CWTPRC                          WKTPRC
     I              CWUYAA                          WKUYAA
     I              CWA0D8                          WKA0D8
     I              CWD9TM                          WKD9TM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBCX1    E DSPBCXCPL0
      * UPD : TMS International Shipmnt Update index
      * Renamed input format fields
     I              CXTMLD                          WBTMLD
     I              CXAYD8                          WBAYD8
     I              CXAFTH                          WBAFTH
     I              CXFSU1                          WBFSU1
     I              CXEVSQ                          WBEVSQ
     I              CXTMOR                          WBTMOR
     I              CXDMSC                          WBDMSC
     I              CXA1D8                          WBA1D8
     I              CXAHTH                          WBAHTH
     I              CXA2D8                          WBA2D8
     I              CXAITH                          WBAITH
     I              CXA3D8                          WBA3D8
     I              CXAJTH                          WBAJTH
     I              CXA4D8                          WBA4D8
     I              CXAKTH                          WBAKTH
     I              CXDNSC                          WBDNSC
     I              CXUZAA                          WBUZAA
     I              CXFFU1                          WBFFU1
     I              CXUGU1                          WBUGU1
     I              CXFHU1                          WBFHU1
     I              CXU0AA                          WBU0AA
     I              CXU1AA                          WBU1AA
     I              CXU3AA                          WBU3AA
     I              CXU4AA                          WBU4AA
     I              CXG1NB                          WBG1NB
     I              CXDOSC                          WBDOSC
     I              CXHFNB                          WBHFNB
     I              CXA6D8                          WBA6D8
     I              CXAMTH                          WBAMTH
     I              CXDLSC                          WBDLSC
     I              CXTPRC                          WBTPRC
     I              CXUYAA                          WBUYAA
     I              CXA0D8                          WBA0D8
     I              CXD9TM                          WBD9TM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPBCU1    E DSPBCUCPL0
      * UPD : TMS Load Event Shipment   Update index
      * Renamed input format fields
     I              CUTMLD                          WFTMLD
     I              CUAYD8                          WFAYD8
     I              CUAFTH                          WFAFTH
     I              CUFSU1                          WFFSU1
     I              CUEVSQ                          WFEVSQ
     I              CUTMOR                          WFTMOR
     I              CUHFNB                          WFHFNB
     I              CUDLSC                          WFDLSC
     I              CUTPRC                          WFTPRC
     I              CUUYAA                          WFUYAA
     I              CUA0D8                          WFA0D8
     I              CUD9TM                          WFD9TM
      *
     IYARDCS      DS                             73
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     IYBRDCS      DS                            894
     IQPBCS1    E DSPBCSCPL0
      * UPD : TMS Load Event            Update index
      * Renamed input format fields
     I              CSTMLD                          WJTMLD
     I              CSAYD8                          WJAYD8
     I              CSAFTH                          WJAFTH
     I              CSFSU1                          WJFSU1
     I              CSEVSQ                          WJEVSQ
     I              CSDMSC                          WJDMSC
     I              CSA1D8                          WJA1D8
     I              CSAHTH                          WJAHTH
     I              CSA2D8                          WJA2D8
     I              CSAITH                          WJAITH
     I              CSA3D8                          WJA3D8
     I              CSAJTH                          WJAJTH
     I              CSA4D8                          WJA4D8
     I              CSAKTH                          WJAKTH
     I              CSDNSC                          WJDNSC
     I              CSUZAA                          WJUZAA
     I              CSFFU1                          WJFFU1
     I              CSUGU1                          WJUGU1
     I              CSFHU1                          WJFHU1
     I              CSU0AA                          WJU0AA
     I              CSU1AA                          WJU1AA
     I              CSU3AA                          WJU3AA
     I              CSU4AA                          WJU4AA
     I              CSG1NB                          WJG1NB
     I              CSDOSC                          WJDOSC
     I              CSA6D8                          WJA6D8
     I              CSAMTH                          WJAMTH
     I              CSA9D8                          WJA9D8
     I              CSANTH                          WJANTH
     I              CSVBAA                          WJVBAA
     I              CSP5U1                          WJP5U1
     I              CSDLSC                          WJDLSC
     I              CSTPRC                          WJTPRC
     I              CSUYAA                          WJUYAA
     I              CSA0D8                          WJA0D8
     I              CSD9TM                          WJD9TM
      *
     IYCRDCS      DS                            485
     IQPBCW1    E DSPBCWCPL1
      * UPD : TMS International Legs    Update index
      * Renamed input format fields
     I              CWTMLD                          WKTMLD
     I              CWAYD8                          WKAYD8
     I              CWAFTH                          WKAFTH
     I              CWFSU1                          WKFSU1
     I              CWUPAA                          WKUPAA
     I              CWLTMP                          WKLTMP
     I              CWDFSC                          WKDFSC
     I              CWDGSC                          WKDGSC
     I              CWDHSC                          WKDHSC
     I              CWDISC                          WKDISC
     I              CWDJSC                          WKDJSC
     I              CWDKSC                          WKDKSC
     I              CWUQAA                          WKUQAA
     I              CWURAA                          WKURAA
     I              CWUSAA                          WKUSAA
     I              CWCRDS                          WKCRDS
     I              CWAZD8                          WKAZD8
     I              CWAGTH                          WKAGTH
     I              CWUTAA                          WKUTAA
     I              CWUUAA                          WKUUAA
     I              CWUVAA                          WKUVAA
     I              CWUWAA                          WKUWAA
     I              CWUXAA                          WKUXAA
     I              CWFJU1                          WKFJU1
     I              CWFKU1                          WKFKU1
     I              CWFLU1                          WKFLU1
     I              CWFMU1                          WKFMU1
     I              CWFNU1                          WKFNU1
     I              CWFOU1                          WKFOU1
     I              CWFPU1                          WKFPU1
     I              CWFQU1                          WKFQU1
     I              CWA7D8                          WKA7D8
     I              CWA8D8                          WKA8D8
     I              CWDLSC                          WKDLSC
     I              CWTPRC                          WKTPRC
     I              CWUYAA                          WKUYAA
     I              CWA0D8                          WKA0D8
     I              CWD9TM                          WKD9TM
      *
     IYDRDCS      DS                            585
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: TMS Load
      * I :  TMS Load ID
     I                                    P   1   40P1TMLD
      * I :  TMS Extract Date
     I                                        5  120P1AYD8
      * I :  TMS Extract Time
     I                                    P  13  150P1AFTH
      * I :  TMS Extract File Name
     I                                       16  40 P1FSU1
      * I :  TMS Customer Load ID
     I                                       41  50 P1UPAA
      * I :  TMS Temperature
     I                                    P  51  521P1LTMP
      * I :  TMS Temperature UOM
     I                                       53  53 P1DFSC
      * I :  TMS Movement Type
     I                                       54  63 P1DGSC
      * I :  TMS Shipment Type
     I                                       64  73 P1DHSC
      * I :  TMS Payment Method
     I                                       74  83 P1DISC
      * I :  TMS POD Received
     I                                       84  84 P1DJSC
      * I :  TMS Load Status
     I                                       85  99 P1DKSC
      * I :  TMS Load Owner
     I                                      100 103 P1UQAA
      * I :  TMS Carrier SCAC
     I                                      104 113 P1URAA
      * I :  TMS Carrier Mode
     I                                      114 123 P1USAA
      * I :  TMS Carrier Distance
     I                                    P 124 1271P1CRDS
      * I :  TMS Deadline Depart Date
     I                                      128 1350P1AZD8
      * I :  TMS Deadline Depart Time
     I                                    P 136 1380P1AGTH
      * I :  TMS Trailer Number
     I                                      139 153 P1UTAA
      * I :  TMS Container Number
     I                                      154 173 P1UUAA
      * I :  TMS Move Type
     I                                      174 188 P1UVAA
      * I :  TMS Vessel Name
     I                                      189 218 P1UWAA
      * I :  TMS Voyage Number
     I                                      219 238 P1UXAA
      * I :  TMS Booking Number
     I                                      239 268 P1FJU1
      * I :  TMS OTR Destination Name
     I                                      269 318 P1FKU1
      * I :  TMS OTR Destination Addr1
     I                                      319 368 P1FLU1
      * I :  TMS OTR Destination Addr2
     I                                      369 418 P1FMU1
      * I :  TMS OTR Destination City
     I                                      419 468 P1FNU1
      * I :  TMS OTR Destination State
     I                                      469 518 P1FOU1
      * I :  TMS OTR Destination Zip
     I                                      519 538 P1FPU1
      * I :  TMS OTR Destination Cntry
     I                                      539 548 P1FQU1
      * I :  TMS Vessel ETD Date
     I                                      549 5560P1A7D8
      * I :  TMS Vessel ETA Date
     I                                      557 5640P1A8D8
      * I :  TMS Record Status
     I                                      565 565 P1DLSC
      * I :  TMS Process Status
     I                                    P 566 5670P1TPRC
      * I :  TMS Error Reason
     I                                      568 573 P1UYAA
      * I :  TMS Change Date
     I                                      574 5810P1A0D8
      * I :  TMS Change time
     I                                    P 582 5850P1D9TM
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TMLD    PARM           WP0001  70       TMS Load ID
     C           P1AYD8    PARM           WP0002  80       TMS Extract Dat
     C           P1AFTH    PARM           WP0003  40       TMS Extract Tim
     C           P1FSU1    PARM           WP0004 25        TMS Extract Fil
     C           P1UPAA    PARM           WP0005 10        TMS Customer Lo
     C           P1LTMP    PARM           WP0006  31       TMS Temperature
     C           P1DFSC    PARM           WP0007  1        TMS Temperature
     C           P1DGSC    PARM           WP0008 10        TMS Movement Ty
     C           P1DHSC    PARM           WP0009 10        TMS Shipment Ty
     C           P1DISC    PARM           WP0010 10        TMS Payment Met
     C           P1DJSC    PARM           WP0011  1        TMS POD Receive
     C           P1DKSC    PARM           WP0012 15        TMS Load Status
     C           P1UQAA    PARM           WP0013  4        TMS Load Owner
     C           P1URAA    PARM           WP0014 10        TMS Carrier SCA
     C           P1USAA    PARM           WP0015 10        TMS Carrier Mod
     C           P1CRDS    PARM           WP0016  71       TMS Carrier Dis
     C           P1AZD8    PARM           WP0017  80       TMS Deadline De
     C           P1AGTH    PARM           WP0018  40       TMS Deadline De
     C           P1UTAA    PARM           WP0019 15        TMS Trailer Num
     C           P1UUAA    PARM           WP0020 20        TMS Container N
     C           P1UVAA    PARM           WP0021 15        TMS Move Type
     C           P1UWAA    PARM           WP0022 30        TMS Vessel Name
     C           P1UXAA    PARM           WP0023 20        TMS Voyage Numb
     C           P1FJU1    PARM           WP0024 30        TMS Booking Num
     C           P1FKU1    PARM           WP0025 50        TMS OTR Destina
     C           P1FLU1    PARM           WP0026 50        TMS OTR Destina
     C           P1FMU1    PARM           WP0027 50        TMS OTR Destina
     C           P1FNU1    PARM           WP0028 50        TMS OTR Destina
     C           P1FOU1    PARM           WP0029 50        TMS OTR Destina
     C           P1FPU1    PARM           WP0030 20        TMS OTR Destina
     C           P1FQU1    PARM           WP0031 10        TMS OTR Destina
     C           P1A7D8    PARM           WP0032  80       TMS Vessel ETD
     C           P1A8D8    PARM           WP0033  80       TMS Vessel ETA
     C           P1DLSC    PARM           WP0034  1        TMS Record Stat
     C           P1TPRC    PARM           WP0035  30       TMS Process Sta
     C           P1UYAA    PARM           WP0036  6        TMS Error Reaso
     C           P1A0D8    PARM           WP0037  80       TMS Change Date
     C           P1D9TM    PARM           WP0038  60       TMS Change time
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Maint Intl Legs   XF
      * Rtv Dlt Intl Legs     RT - TMS International Shipmnt  * 
     C                     EXSR SARVGN
      * Rtv Crt/Chg TMS Intl  RT - TMS International Legs  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Dlt Intl Legs     RT - TMS International Shipmnt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WATMLD    WQSA01           TMS Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           TMS Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSA01           TMS Load ID
      * Establish starting position
     C           KRSSA     SETLL@CXCPX9                    *
     C           KRSSA     READE@CXCPX9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4943' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete TMS International - TMS International Shipmnt  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@CXCPX9                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete TMS International - TMS International Shipmnt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CXCPX5
     C                     Z-ADDWATMLD    WBTMLD           TMS Load ID
     C                     Z-ADDWAAYD8    WBAYD8           TMS Extract Dat
     C                     Z-ADDWAAFTH    WBAFTH           TMS Extract Tim
     C                     MOVELWAFSU1    WBFSU1           TMS Extract Fil
     C                     Z-ADDWAEVSQ    WBEVSQ           TMS Event Seque
     C                     Z-ADDWATMOR    WBTMOR           TMS Order ID
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBTMLD           TMS Load ID
     C                     KFLD           WBAYD8           TMS Extract Dat
     C                     KFLD           WBAFTH           TMS Extract Tim
     C                     KFLD           WBFSU1           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
     C                     KFLD           WBTMOR           TMS Order ID
     C           KLDLSB    CHAIN@CXCPX5              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCXCPL0'MDACP
     C                     MOVEL'@CXCPX5' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CXCPX5                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg TMS Intl  RT - TMS International Legs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCTMLD    WQSC01           TMS Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           TMS Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSC01           TMS Load ID
      * Establish starting position
     C           KRSSC     SETLL@CWCPX6                    *
     C           KRSSC     READE@CWCPX6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4941' W0RTN   7
      * USER: Processing if Data record not found
      * FOR NOT 'WAREHOUSE' ADDRESS TYPES ONLY
      * Rtv Crt Intl Legs     RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1TMLD    WL0001           TMS Load ID
     C                     Z-ADDP1AYD8    WL0002           TMS Extract Dat
     C                     Z-ADDP1AFTH    WL0003           TMS Extract Tim
     C                     MOVELP1FSU1    WL0004    P      TMS Extract Fil
     C                     MOVELYL0001    WL0005    P      Record Created
     C                     MOVELP1URAA    WL0006    P      TMS Carrier SCA
     C                     MOVELP1USAA    WL0007    P      TMS Carrier Mod
     C                     MOVELP1UUAA    WL0008    P      TMS Container N
     C                     MOVELP1UWAA    WL0009    P      TMS Vessel Name
     C                     MOVELP1UXAA    WL0010    P      TMS Voyage Numb
     C                     MOVELP1FJU1    WL0011    P      TMS Booking Num
     C                     MOVELP1FKU1    WL0012    P      TMS OTR Destina
     C                     MOVELP1FNU1    WL0013    P      TMS OTR Destina
     C                     Z-ADDP1A7D8    WL0014           TMS Vessel ETD
     C                     Z-ADDP1A8D8    WL0015           TMS Vessel ETA
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Record Created
      * CASE: LCL.Record Created        USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Crt TMS Intl          CR - TMS International Legs  * 
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg TMS Intl          CH - TMS International Legs  * 
     C                     EXSR SMCHRC
      * Rtv Crt Intl Legs     RT - TMS Load Event  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCTMLD    WL0001           TMS Load ID
     C                     Z-ADDWCAYD8    WL0002           TMS Extract Dat
     C                     Z-ADDWCAFTH    WL0003           TMS Extract Tim
     C                     MOVELWCFSU1    WL0004    P      TMS Extract Fil
     C                     MOVELYL0001    WL0005    P      Record Created
     C                     MOVELWCURAA    WL0006    P      TMS Carrier SCA
     C                     MOVELWCUSAA    WL0007    P      TMS Carrier Mod
     C                     MOVELWCUUAA    WL0008    P      TMS Container N
     C                     MOVELWCUWAA    WL0009    P      TMS Vessel Name
     C                     MOVELWCUXAA    WL0010    P      TMS Voyage Numb
     C                     MOVELWCFJU1    WL0011    P      TMS Booking Num
     C                     MOVELWCFKU1    WL0012    P      TMS OTR Destina
     C                     MOVELWCFNU1    WL0013    P      TMS OTR Destina
     C                     Z-ADDWCA7D8    WL0014           TMS Vessel ETD
     C                     Z-ADDWCA8D8    WL0015           TMS Vessel ETA
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0001    P      Record Created
     C           KRSSC     READE@CWCPX6                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Crt Intl Legs     RT - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0005           Record Created
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDTMLD    WQSD01           TMS Load ID
     C           *LIKE     DEFN WDAYD8    WQSD02           TMS Extract Dat
     C           *LIKE     DEFN WDAFTH    WQSD03           TMS Extract Tim
     C           *LIKE     DEFN WDFSU1    WQSD04           TMS Extract Fil
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           TMS Load ID
     C                     KFLD           WQSD02           TMS Extract Dat
     C                     KFLD           WQSD03           TMS Extract Tim
     C                     KFLD           WQSD04           TMS Extract Fil
      * Setup key
     C                     Z-ADDWL0001    WQSD01           TMS Load ID
     C                     Z-ADDWL0002    WQSD02           TMS Extract Dat
     C                     Z-ADDWL0003    WQSD03           TMS Extract Tim
     C                     MOVELWL0004    WQSD04           TMS Extract Fil
      * Establish starting position
     C           KRSSD     SETLL@CSCPXP                    *
     C           KRSSD     READE@CSCPXP                  90*
      * Data record not found
     C   90                MOVEL'USR4932' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create intl shipment for each order in the event sequence
      * CASE: DB1.TMS Address Type is Warehouse
     C           WDDNSC    IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Crt Intl Leg Shpm RT - TMS Load Event Shipment  * 
     C                     EXSR SERVGN
     C                     MOVEL'Y'       WL0005           Record Created
      * Change TMS Load Event - TMS Load Event  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSD     READE@CSCPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Crt Intl Leg Shpm RT - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0002           Order Number Sa
      * Declare restrictor key work fields
     C           *LIKE     DEFN WETMLD    WQSE01           TMS Load ID
     C           *LIKE     DEFN WEAYD8    WQSE02           TMS Extract Dat
     C           *LIKE     DEFN WEAFTH    WQSE03           TMS Extract Tim
     C           *LIKE     DEFN WEFSU1    WQSE04           TMS Extract Fil
     C           *LIKE     DEFN WEEVSQ    WQSE05           TMS Event Seque
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           TMS Load ID
     C                     KFLD           WQSE02           TMS Extract Dat
     C                     KFLD           WQSE03           TMS Extract Tim
     C                     KFLD           WQSE04           TMS Extract Fil
     C                     KFLD           WQSE05           TMS Event Seque
      * Setup key
     C                     Z-ADDWDTMLD    WQSE01           TMS Load ID
     C                     Z-ADDWDAYD8    WQSE02           TMS Extract Dat
     C                     Z-ADDWDAFTH    WQSE03           TMS Extract Tim
     C                     MOVELWDFSU1    WQSE04           TMS Extract Fil
     C                     Z-ADDWDEVSQ    WQSE05           TMS Event Seque
      * Establish starting position
     C           KRSSE     SETLL@CUCPXS                    *
     C           KRSSE     READE@CUCPXS                  90*
      * Data record not found
     C   90                MOVEL'USR4936' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt TMS Intl          CR - TMS International Shipmnt  * 
     C                     EXSR SFCRRC
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
     C                     EXSR SGCHRC
      * Update OHE from Load where Carrier Mode=OCEAN with the vessel,voy
      * CASE: PAR.TMS Carrier Mode is Ocean
     C           WL0007    IFEQ 'OCEAN'                    *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.TMS Order ID is entered
      *   |- c2    : DB1.TMS Order ID NE LCL.Order Number Saved USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WETMOR    IFNE 0                          *IF
     C           WETMOR    IFNE YL0002                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWETMOR    YL0002           Order Number Sa
      * Order header Ext updates
      * 07/24/19 DN R15161-Set OHE Voyage/Flight.
      * CASE: *OTHERWISE
      * OHE Voyage/Flight field type was changed from NBR (5) to TXT (15)
      * No longer need to check if value is numeric.
     C                     MOVELWL0010    YL0003           OHE Voyage/Flig
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0004    PARM *ZERO     WQ0001  70       Date
     C                     PARM WL0014    WQ0002  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0005    PARM *ZERO     WQ0003  70       Date
     C                     PARM WL0015    WQ0004  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Company for Ord   RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * (dont upd load or stop/drop)
      * 07/24/19 DN R15161-Replaced PAR.Voyage with OHE Voyage/Flight &
      *   PAR.Booking Number with OHE Booking Number.
      * RTV Chg TMS Load Fld2 RT - Order Header Extension  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@CUCPXS                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt TMS Intl          CR - TMS International Shipmnt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CXCPX5
     C                     Z-ADDWETMLD    WBTMLD           TMS Load ID
     C                     Z-ADDWEAYD8    WBAYD8           TMS Extract Dat
     C                     Z-ADDWEAFTH    WBAFTH           TMS Extract Tim
     C                     MOVELWEFSU1    WBFSU1           TMS Extract Fil
     C                     Z-ADDWEEVSQ    WBEVSQ           TMS Event Seque
     C                     Z-ADDWETMOR    WBTMOR           TMS Order ID
     C                     MOVELWDDMSC    WBDMSC           TMS Event Type
     C                     Z-ADDWDA1D8    WBA1D8           TMS Earliest Da
     C                     Z-ADDWDAHTH    WBAHTH           TMS Earliest Ti
     C                     Z-ADDWDA2D8    WBA2D8           TMS Latest Date
     C                     Z-ADDWDAITH    WBAITH           TMS Latest Time
     C                     Z-ADDWDA3D8    WBA3D8           TMS Planned Dat
     C                     Z-ADDWDAJTH    WBAJTH           TMS Planned Tim
     C                     Z-ADDWDA4D8    WBA4D8           TMS Actual Date
     C                     Z-ADDWDAKTH    WBAKTH           TMS Actual Time
     C                     MOVELWDDNSC    WBDNSC           TMS Address Typ
     C                     MOVELWDUZAA    WBUZAA           TMS Location Co
     C                     MOVELWDFFU1    WBFFU1           TMS Address Nam
     C                     MOVELWDUGU1    WBUGU1           TMS Address Lin
     C                     MOVELWDFHU1    WBFHU1           TMS Address Lin
     C                     MOVELWDU0AA    WBU0AA           TMS City
     C                     MOVELWDU1AA    WBU1AA           TMS State Provi
     C                     MOVELWDU3AA    WBU3AA           TMS Postal Code
     C                     MOVELWDU4AA    WBU4AA           TMS Country Cod
     C                     Z-ADDWDG1NB    WBG1NB           TMS Weight
     C                     MOVELWDDOSC    WBDOSC           TMS Weight UOM
     C                     Z-ADDWEHFNB    WBHFNB           TMS Miles from
     C                     Z-ADDWDA6D8    WBA6D8           TMS Appointment
     C                     Z-ADDWDAMTH    WBAMTH           TMS Appointment
     C                     MOVELWEDLSC    WBDLSC           TMS Record Stat
     C                     Z-ADDWETPRC    WBTPRC           TMS Process Sta
     C                     MOVELWEUYAA    WBUYAA           TMS Error Reaso
     C                     Z-ADDWEA0D8    WBA0D8           TMS Change Date
     C                     Z-ADDWED9TM    WBD9TM           TMS Change time
      *
     C           KLCRSF    KLIST
     C                     KFLD           WBTMLD           TMS Load ID
     C                     KFLD           WBAYD8           TMS Extract Dat
     C                     KFLD           WBAFTH           TMS Extract Tim
     C                     KFLD           WBFSU1           TMS Extract Fil
     C                     KFLD           WBEVSQ           TMS Event Seque
     C                     KFLD           WBTMOR           TMS Order ID
      * Check for duplicate primary key
     C           KLCRSF    SETLL@CXCPX5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4944' W0RTN   7
      * Send message 'TMS International Ship EX'
     C                     MOVEL'USR4944' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@CXCPX5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Change TMS Load Event Shi - TMS Load Event Shipment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CUCPXR
     C                     Z-ADDWETMLD    WFTMLD           TMS Load ID
     C                     Z-ADDWEAYD8    WFAYD8           TMS Extract Dat
     C                     Z-ADDWEAFTH    WFAFTH           TMS Extract Tim
     C                     MOVELWEFSU1    WFFSU1    P      TMS Extract Fil
     C                     Z-ADDWEEVSQ    WFEVSQ           TMS Event Seque
     C                     Z-ADDWETMOR    WFTMOR           TMS Order ID
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFTMLD           TMS Load ID
     C                     KFLD           WFAYD8           TMS Extract Dat
     C                     KFLD           WFAFTH           TMS Extract Tim
     C                     KFLD           WFFSU1           TMS Extract Fil
     C                     KFLD           WFEVSQ           TMS Event Seque
     C                     KFLD           WFTMOR           TMS Order ID
     C           KLCHSG    CHAIN@CUCPXR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCUCPL0'MDACP
     C                     MOVEL'@CUCPXR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCU1    YARDCS
      * Move non-key fields to @CUCPXR
     C                     Z-ADDWEHFNB    WFHFNB           TMS Miles from
     C                     MOVELWEDLSC    WFDLSC    P      TMS Record Stat
     C                     Z-ADD1         WFTPRC           TMS Process Sta
     C                     MOVELWEUYAA    WFUYAA    P      TMS Error Reaso
     C                     Z-ADDWEA0D8    WFA0D8           TMS Change Date
     C                     Z-ADDWED9TM    WFD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCU1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set TMS Record Stampp IF
     C                     Z-ADD##JTM     WFD9TM           TMS Change time
     C                     Z-ADD##JDT     WFA0D8           TMS Change Date
      * Set PGM.*Record Data Changed flag
     C           QPBCU1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CUCPXR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCUCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGC4NB    WQSH01           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Order Number
      * Setup key
     C                     Z-ADDWETMOR    WQSH01           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BFCPY2                    *
     C           KRSSH     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGAIC3    YL0006           Company Number
     C           KRSSH     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Chg TMS Load Fld2 RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDYL0006    WHAIC3           Company Number
     C                     Z-ADDWETMOR    WHC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * better be here already
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Existing OHE       CH - Order Header Extension  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Existing OHE       CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHSJ    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWHRMNB    WIRMNB           Load ID
     C                     Z-ADDWHRUNB    WIRUNB           Stop/Drop Seque
     C                     MOVELWL0006    WIXACD    P      Shipping Line
     C                     MOVELWL0012    WIOANA    P      Port Delv Termi
     C                     MOVELWL0013    WIHBAA    P      OHE City
     C                     MOVELWL0009    WIJ0T1    P      OHE Vessel/Airl
     C                     MOVELYL0003    WIGENY    P      OHE Voyage/Flig
     C                     MOVELWL0011    WIJ1T1    P      OHE Booking Num
     C                     MOVEL*BLANK    WIHCAA    P      OHE Discharge P
     C                     Z-ADDYL0004    WIQWDT           OHE Sail/Flight
     C                     Z-ADDWHQXDT    WIQXDT           OHE Port Cut Da
     C                     Z-ADDYL0005    WIQYDT           OHE Arrival Dat
     C                     MOVELWHHDAA    WIHDAA    P      OHE Late Delive
     C                     MOVEL'O'       WICCTX    P      OHE Ship Status
     C                     MOVELWL0008    WIJ2T1    P      OHE Container N
     C                     MOVELWHRLNA    WIRLNA    P      OHE Comment 1
     C                     MOVELWHRMNA    WIRMNA    P      OHE Comment 2
     C                     Z-ADDWHGINY    WIGINY           OHE Unused Numb
     C                     Z-ADDWHGFNY    WIGFNY           OHE Unused Numb
     C                     Z-ADDWHGGNY    WIGGNY           OHE Unused Numb
     C                     Z-ADDWHGHNY    WIGHNY           OHE Unused Numb
     C                     Z-ADDWHHEVL    WIHEVL           OHE HPB RIN Equ
     C                     Z-ADDWHHFVL    WIHFVL           OHE HPB RIN Pri
     C                     Z-ADDWHHGVL    WIHGVL           Transload Termi
     C                     Z-ADDWHQZDT    WIQZDT           OHE Est Arrv at
     C                     Z-ADDWHQ0DT    WIQ0DT           OHE Backhaul ET
     C                     Z-ADDWHQ1DT    WIQ1DT           OHE Port/Pier P
     C                     Z-ADDWHQ2DT    WIQ2DT           OHE Actual Ship
     C                     MOVELWHC2TX    WIC2TX    P      OHE Carrier SCA
     C                     MOVELWHC3TX    WIC3TX    P      OHE Spot Buy
     C                     MOVELWHC6TX    WIC6TX    P      OHE PO ACK Flag
     C                     MOVELWHCHTX    WICHTX    P      OHE Override Ty
     C                     MOVELWHCITX    WICITX    P      OHE Backhaul St
     C                     MOVELWHCLTX    WICLTX    P      OHE Backhaul ET
     C                     MOVELYL0007    WIB4TX    P      OHE Load Haul T
     C                     MOVELWHCUTX    WICUTX    P      OHE Backhaul Ca
     C                     MOVELWHCVTX    WICVTX    P      OHE Bookings Co
     C                     MOVELWHB9TX    WIB9TX    P      OHE EDI Error R
     C                     MOVELWHJWSC    WIJWSC    P      OHE EDI Error R
     C                     Z-ADDWHITNY    WIITNY           HPB COA Batch N
     C                     MOVELWHLMT1    WILMT1    P      Delivery P.O. N
     C                     MOVELWHLWAA    WILWAA    P      OHE Intended fo
     C                     MOVELWHFVST    WIFVST    P      OHE EDI 943 Act
     C                     MOVELWHF0ST    WIF0ST    P      OHE EDI 944 Act
     C                     MOVELWHF2ST    WIF2ST    P      OHE EDI 940 Act
     C                     MOVELWHF3ST    WIF3ST    P      OHE EDI 945 Act
     C                     MOVELWHJUSC    WIJUSC    P      OHE EDI 856 Act
     C                     MOVELWHJVSC    WIJVSC    P      OHE EDI 824 Act
     C                     MOVELWHV3T1    WIV3T1    P      OHE Transload S
     C                     MOVELWHV4T1    WIV4T1    P      OHE Abs Rate Ov
     C                     MOVELWHV5T1    WIV5T1    P      OHE Appt Confir
     C                     MOVELWHV6T1    WIV6T1    P      OHE Backhaul Co
     C                     MOVELWHV7T1    WIV7T1    P      OHE Backhaul Ch
     C                     MOVELWHV8T1    WIV8T1    P      OHE Transload C
     C                     MOVELWHV9T1    WIV9T1    P      OHE Pier Pass I
     C                     MOVELWHWAT1    WIWAT1    P      OHE Carrier Nm
     C                     MOVELWHWBT1    WIWBT1    P      OHE Appt Confir
     C                     MOVELWHWCT1    WIWCT1    P      OHE Backhaul Co
     C                     MOVELWHWDT1    WIWDT1    P      Letter of Credi
     C                     Z-ADDWHQJNY    WIQJNY           OHE Backhaul Re
     C                     Z-ADDWHQKNY    WIQKNY           LD Stop/Drop
     C                     Z-ADDWHQLNY    WIQLNY           OHE Unused Numb
     C                     Z-ADDWHP8NY    WIP8NY           OHE Pier Pass F
     C                     Z-ADDWHP9NY    WIP9NY           OHE Port Check
     C                     Z-ADDWHQANY    WIQANY           OHE Port Cut Ti
     C                     Z-ADDWHQCNY    WIQCNY           OHE Backhaul Tr
     C                     Z-ADDWHQDNY    WIQDNY           OHE Load Sched
     C                     Z-ADDWHQENY    WIQENY           Original Appoin
     C                     Z-ADDWHQFNY    WIQFNY           Original Appoin
     C                     Z-ADDWHQGNY    WIQGNY           OHE PowerPro Lo
     C                     Z-ADDWHQHNY    WIQHNY           OHE PowerPro Lo
     C                     Z-ADDWHQINY    WIQINY           OHE Unused Nume
     C                     Z-ADDWHQMNY    WIQMNY           OHE Orig ABS Fr
     C                     MOVELWHMYU1    WIMYU1    P      OHE Genset Numb
     C                     MOVELWHJXSC    WIJXSC    P      OHE Email BOL/S
     C                     MOVELWHJYSC    WIJYSC    P      OHE Unused Stat
     C                     MOVELWHJZSC    WIJZSC    P      OHE Unused Stat
     C                     MOVELWHJ0SC    WIJ0SC    P      OHE Unused Stat
     C                     MOVELWHMZU1    WIMZU1    P      OHE Unused Text
     C                     MOVELWHM0U1    WIM0U1    P      OHE Unused Text
     C                     MOVELWHM1U1    WIM1U1    P      OHE Customer Ve
     C                     MOVELWHM2U1    WIM2U1    P      OHE Unused Text
     C                     MOVELWHM3U1    WIM3U1    P      OHE Unused Text
     C                     Z-ADDWHW5DT    WIW5DT           OHE Unused Date
     C                     Z-ADDWHW6DT    WIW6DT           OHE Unused Date
     C                     MOVELWHUVST    WIUVST    P      EDI Status 1
     C                     MOVELWHUWST    WIUWST    P      EDI Status 2
     C                     MOVELWHUXST    WIUXST    P      EDI Status 3
     C                     MOVELWHVSST    WIVSST    P      Record Status
     C                     Z-ADDWHAATM    WIAATM           Job Time
     C                     MOVELWHAYNA    WIAYNA    P      User Id
     C                     MOVELWHA0NA    WIA0NA    P      Job Name
     C                     Z-ADDWHAXDT    WIAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     MOVEL##USR     WIAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Change TMS Load Event - TMS Load Event  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @CSCPXO
     C                     Z-ADDWDTMLD    WJTMLD           TMS Load ID
     C                     Z-ADDWDAYD8    WJAYD8           TMS Extract Dat
     C                     Z-ADDWDAFTH    WJAFTH           TMS Extract Tim
     C                     MOVELWDFSU1    WJFSU1    P      TMS Extract Fil
     C                     Z-ADDWDEVSQ    WJEVSQ           TMS Event Seque
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJTMLD           TMS Load ID
     C                     KFLD           WJAYD8           TMS Extract Dat
     C                     KFLD           WJAFTH           TMS Extract Tim
     C                     KFLD           WJFSU1           TMS Extract Fil
     C                     KFLD           WJEVSQ           TMS Event Seque
     C           KLCHSK    CHAIN@CSCPXO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCSCPL0'MDACP
     C                     MOVEL'@CSCPXO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCS1    YCRDCS
      * Move non-key fields to @CSCPXO
     C                     MOVELWDDMSC    WJDMSC    P      TMS Event Type
     C                     Z-ADDWDA1D8    WJA1D8           TMS Earliest Da
     C                     Z-ADDWDAHTH    WJAHTH           TMS Earliest Ti
     C                     Z-ADDWDA2D8    WJA2D8           TMS Latest Date
     C                     Z-ADDWDAITH    WJAITH           TMS Latest Time
     C                     Z-ADDWDA3D8    WJA3D8           TMS Planned Dat
     C                     Z-ADDWDAJTH    WJAJTH           TMS Planned Tim
     C                     Z-ADDWDA4D8    WJA4D8           TMS Actual Date
     C                     Z-ADDWDAKTH    WJAKTH           TMS Actual Time
     C                     MOVELWDDNSC    WJDNSC    P      TMS Address Typ
     C                     MOVELWDUZAA    WJUZAA    P      TMS Location Co
     C                     MOVELWDFFU1    WJFFU1    P      TMS Address Nam
     C                     MOVELWDUGU1    WJUGU1    P      TMS Address Lin
     C                     MOVELWDFHU1    WJFHU1    P      TMS Address Lin
     C                     MOVELWDU0AA    WJU0AA    P      TMS City
     C                     MOVELWDU1AA    WJU1AA    P      TMS State Provi
     C                     MOVELWDU3AA    WJU3AA    P      TMS Postal Code
     C                     MOVELWDU4AA    WJU4AA    P      TMS Country Cod
     C                     Z-ADDWDG1NB    WJG1NB           TMS Weight
     C                     MOVELWDDOSC    WJDOSC    P      TMS Weight UOM
     C                     Z-ADDWDA6D8    WJA6D8           TMS Appointment
     C                     Z-ADDWDAMTH    WJAMTH           TMS Appointment
     C                     Z-ADDWDA9D8    WJA9D8           TMS Actual Car
     C                     Z-ADDWDANTH    WJANTH           TMS Actual Car
     C                     MOVELWDVBAA    WJVBAA    P      TMS Late Reason
     C                     MOVELWDP5U1    WJP5U1    P      TMS Cust Assign
     C                     MOVELWDDLSC    WJDLSC    P      TMS Record Stat
     C                     Z-ADD1         WJTPRC           TMS Process Sta
     C                     MOVELWDUYAA    WJUYAA    P      TMS Error Reaso
     C                     Z-ADDWDA0D8    WJA0D8           TMS Change Date
     C                     Z-ADDWDD9TM    WJD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@CSCPXO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Crt TMS Intl          CR - TMS International Legs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CWCPX7
     C                     Z-ADDP1TMLD    WKTMLD           TMS Load ID
     C                     Z-ADDP1AYD8    WKAYD8           TMS Extract Dat
     C                     Z-ADDP1AFTH    WKAFTH           TMS Extract Tim
     C                     MOVELP1FSU1    WKFSU1           TMS Extract Fil
     C                     MOVELP1UPAA    WKUPAA           TMS Customer Lo
     C                     Z-ADDP1LTMP    WKLTMP           TMS Temperature
     C                     MOVELP1DFSC    WKDFSC           TMS Temperature
     C                     MOVELP1DGSC    WKDGSC           TMS Movement Ty
     C                     MOVELP1DHSC    WKDHSC           TMS Shipment Ty
     C                     MOVELP1DISC    WKDISC           TMS Payment Met
     C                     MOVELP1DJSC    WKDJSC           TMS POD Receive
     C                     MOVELP1DKSC    WKDKSC           TMS Load Status
     C                     MOVELP1UQAA    WKUQAA           TMS Load Owner
     C                     MOVELP1URAA    WKURAA           TMS Carrier SCA
     C                     MOVELP1USAA    WKUSAA           TMS Carrier Mod
     C                     Z-ADDP1CRDS    WKCRDS           TMS Carrier Dis
     C                     Z-ADDP1AZD8    WKAZD8           TMS Deadline De
     C                     Z-ADDP1AGTH    WKAGTH           TMS Deadline De
     C                     MOVELP1UTAA    WKUTAA           TMS Trailer Num
     C                     MOVELP1UUAA    WKUUAA           TMS Container N
     C                     MOVELP1UVAA    WKUVAA           TMS Move Type
     C                     MOVELP1UWAA    WKUWAA           TMS Vessel Name
     C                     MOVELP1UXAA    WKUXAA           TMS Voyage Numb
     C                     MOVELP1FJU1    WKFJU1           TMS Booking Num
     C                     MOVELP1FKU1    WKFKU1           TMS OTR Destina
     C                     MOVELP1FLU1    WKFLU1           TMS OTR Destina
     C                     MOVELP1FMU1    WKFMU1           TMS OTR Destina
     C                     MOVELP1FNU1    WKFNU1           TMS OTR Destina
     C                     MOVELP1FOU1    WKFOU1           TMS OTR Destina
     C                     MOVELP1FPU1    WKFPU1           TMS OTR Destina
     C                     MOVELP1FQU1    WKFQU1           TMS OTR Destina
     C                     Z-ADDP1A7D8    WKA7D8           TMS Vessel ETD
     C                     Z-ADDP1A8D8    WKA8D8           TMS Vessel ETA
     C                     MOVELP1DLSC    WKDLSC           TMS Record Stat
     C                     Z-ADDP1TPRC    WKTPRC           TMS Process Sta
     C                     MOVELP1UYAA    WKUYAA           TMS Error Reaso
     C                     Z-ADDP1A0D8    WKA0D8           TMS Change Date
     C                     Z-ADDP1D9TM    WKD9TM           TMS Change time
      *
     C           KLCRSL    KLIST
     C                     KFLD           WKTMLD           TMS Load ID
     C                     KFLD           WKAYD8           TMS Extract Dat
     C                     KFLD           WKAFTH           TMS Extract Tim
     C                     KFLD           WKFSU1           TMS Extract Fil
      * Check for duplicate primary key
     C           KLCRSL    SETLL@CWCPX7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4942' W0RTN   7
      * Send message 'TMS International Legs EX'
     C                     MOVEL'USR4942' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@CWCPX7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg TMS Intl          CH - TMS International Legs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @CWCPX7
     C                     Z-ADDWCTMLD    WKTMLD           TMS Load ID
     C                     Z-ADDP1AYD8    WKAYD8           TMS Extract Dat
     C                     Z-ADDP1AFTH    WKAFTH           TMS Extract Tim
     C                     MOVELWCFSU1    WKFSU1    P      TMS Extract Fil
      *
     C           KLCHSM    KLIST
     C                     KFLD           WKTMLD           TMS Load ID
     C                     KFLD           WKAYD8           TMS Extract Dat
     C                     KFLD           WKAFTH           TMS Extract Tim
     C                     KFLD           WKFSU1           TMS Extract Fil
     C           KLCHSM    CHAIN@CWCPX7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCWCPL1'MDACP
     C                     MOVEL'@CWCPX7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCW1    YDRDCS
      * Move non-key fields to @CWCPX7
     C                     MOVELP1UPAA    WKUPAA    P      TMS Customer Lo
     C                     Z-ADDP1LTMP    WKLTMP           TMS Temperature
     C                     MOVELP1DFSC    WKDFSC    P      TMS Temperature
     C                     MOVELP1DGSC    WKDGSC    P      TMS Movement Ty
     C                     MOVELP1DHSC    WKDHSC    P      TMS Shipment Ty
     C                     MOVELP1DISC    WKDISC    P      TMS Payment Met
     C                     MOVELP1DJSC    WKDJSC    P      TMS POD Receive
     C                     MOVELP1DKSC    WKDKSC    P      TMS Load Status
     C                     MOVELP1UQAA    WKUQAA    P      TMS Load Owner
     C                     MOVELP1URAA    WKURAA    P      TMS Carrier SCA
     C                     MOVELP1USAA    WKUSAA    P      TMS Carrier Mod
     C                     Z-ADDP1CRDS    WKCRDS           TMS Carrier Dis
     C                     Z-ADDP1AZD8    WKAZD8           TMS Deadline De
     C                     Z-ADDP1AGTH    WKAGTH           TMS Deadline De
     C                     MOVELP1UTAA    WKUTAA    P      TMS Trailer Num
     C                     MOVELP1UUAA    WKUUAA    P      TMS Container N
     C                     MOVELP1UVAA    WKUVAA    P      TMS Move Type
     C                     MOVELP1UWAA    WKUWAA    P      TMS Vessel Name
     C                     MOVELP1UXAA    WKUXAA    P      TMS Voyage Numb
     C                     MOVELP1FJU1    WKFJU1    P      TMS Booking Num
     C                     MOVELP1FKU1    WKFKU1    P      TMS OTR Destina
     C                     MOVELP1FLU1    WKFLU1    P      TMS OTR Destina
     C                     MOVELP1FMU1    WKFMU1    P      TMS OTR Destina
     C                     MOVELP1FNU1    WKFNU1    P      TMS OTR Destina
     C                     MOVELP1FOU1    WKFOU1    P      TMS OTR Destina
     C                     MOVELP1FPU1    WKFPU1    P      TMS OTR Destina
     C                     MOVELP1FQU1    WKFQU1    P      TMS OTR Destina
     C                     Z-ADDP1A7D8    WKA7D8           TMS Vessel ETD
     C                     Z-ADDP1A8D8    WKA8D8           TMS Vessel ETA
     C                     MOVELP1DLSC    WKDLSC    P      TMS Record Stat
     C                     Z-ADDP1TPRC    WKTPRC           TMS Process Sta
     C                     MOVELP1UYAA    WKUYAA    P      TMS Error Reaso
     C                     Z-ADDP1A0D8    WKA0D8           TMS Change Date
     C                     Z-ADDP1D9TM    WKD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCW1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@CWCPX7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCWCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WATMLD           TMS Load ID
     C                     Z-ADD*ZERO     WAAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WAAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WAEVSQ           TMS Event Seque
     C                     Z-ADD*ZERO     WATMOR           TMS Order ID
     C                     Z-ADD*ZERO     WAA1D8           TMS Earliest Da
     C                     Z-ADD*ZERO     WAAHTH           TMS Earliest Ti
     C                     Z-ADD*ZERO     WAA2D8           TMS Latest Date
     C                     Z-ADD*ZERO     WAAITH           TMS Latest Time
     C                     Z-ADD*ZERO     WAA3D8           TMS Planned Dat
     C                     Z-ADD*ZERO     WAAJTH           TMS Planned Tim
     C                     Z-ADD*ZERO     WAA4D8           TMS Actual Date
     C                     Z-ADD*ZERO     WAAKTH           TMS Actual Time
     C                     Z-ADD*ZERO     WAG1NB           TMS Weight
     C                     Z-ADD*ZERO     WAHFNB           TMS Miles from
     C                     Z-ADD*ZERO     WAA6D8           TMS Appointment
     C                     Z-ADD*ZERO     WAAMTH           TMS Appointment
     C                     Z-ADD*ZERO     WATPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WAA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WAD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCTMLD           TMS Load ID
     C                     Z-ADD*ZERO     WCAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WCAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WCLTMP           TMS Temperature
     C                     Z-ADD*ZERO     WCCRDS           TMS Carrier Dis
     C                     Z-ADD*ZERO     WCAZD8           TMS Deadline De
     C                     Z-ADD*ZERO     WCAGTH           TMS Deadline De
     C                     Z-ADD*ZERO     WCA7D8           TMS Vessel ETD
     C                     Z-ADD*ZERO     WCA8D8           TMS Vessel ETA
     C                     Z-ADD*ZERO     WCTPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WCA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WCD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDTMLD           TMS Load ID
     C                     Z-ADD*ZERO     WDAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WDAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WDEVSQ           TMS Event Seque
     C                     Z-ADD*ZERO     WDA1D8           TMS Earliest Da
     C                     Z-ADD*ZERO     WDAHTH           TMS Earliest Ti
     C                     Z-ADD*ZERO     WDA2D8           TMS Latest Date
     C                     Z-ADD*ZERO     WDAITH           TMS Latest Time
     C                     Z-ADD*ZERO     WDA3D8           TMS Planned Dat
     C                     Z-ADD*ZERO     WDAJTH           TMS Planned Tim
     C                     Z-ADD*ZERO     WDA4D8           TMS Actual Date
     C                     Z-ADD*ZERO     WDAKTH           TMS Actual Time
     C                     Z-ADD*ZERO     WDG1NB           TMS Weight
     C                     Z-ADD*ZERO     WDA6D8           TMS Appointment
     C                     Z-ADD*ZERO     WDAMTH           TMS Appointment
     C                     Z-ADD*ZERO     WDA9D8           TMS Actual Car
     C                     Z-ADD*ZERO     WDANTH           TMS Actual Car
     C                     Z-ADD*ZERO     WDTPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WDA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WDD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WETMLD           TMS Load ID
     C                     Z-ADD*ZERO     WEAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WEAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WEEVSQ           TMS Event Seque
     C                     Z-ADD*ZERO     WETMOR           TMS Order ID
     C                     Z-ADD*ZERO     WEHFNB           TMS Miles from
     C                     Z-ADD*ZERO     WETPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WEA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WED9TM           TMS Change time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WGA0DT           Order Date
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGACDT           Cancel Date
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WGA1WG           Order Weight To
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WGRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WGT3NB           Attach to Order
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGAWDT           Invoice Date
     C                     Z-ADD*ZERO     WGVRVA           A/R order Value
     C                     Z-ADD*ZERO     WGB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WGNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WGNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WGNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WGNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WGNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WGBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WGBQTM           Time of Origina
     C                     Z-ADD*ZERO     WGBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WGBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WGBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WGH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WGH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WGH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WGH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WGH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WGC0C7           Claim Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WHQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WHQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WHQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WHGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WHHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WHHGVL           Transload Termi
     C                     Z-ADD*ZERO     WHQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WHQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WHQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WHQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WHITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WHQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WHQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WHQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WHP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WHP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WHQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WHQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WHQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WHQENY           Original Appoin
     C                     Z-ADD*ZERO     WHQFNY           Original Appoin
     C                     Z-ADD*ZERO     WHQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WHQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WHQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WHQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WHW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WHW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  80
     C                     Z-ADD*ZERO     WL0003  40
     C                     MOVEL*BLANK    WL0004 25
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007 10
     C                     MOVEL*BLANK    WL0008 20
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010 20
     C                     MOVEL*BLANK    WL0011 30
     C                     MOVEL*BLANK    WL0012 50
     C                     MOVEL*BLANK    WL0013 50
     C                     Z-ADD*ZERO     WL0014  80
     C                     Z-ADD*ZERO     WL0015  80
      * Define local work field Record Created        USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Order Number Saved USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YL0003 15
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0007  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 WAREHOUSE
