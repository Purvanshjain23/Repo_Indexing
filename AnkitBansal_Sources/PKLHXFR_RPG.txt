     H/TITLE Bal Tattoo W/Kill Edt  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:39:16
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPN6IF  E           K        DISK
      * RSQ : Tattoo Header             Kill/Shf/Ttto  Active
      *
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKB6CPL0IF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WABVCD
     I              BOCBTX                          WACBTX
     I              BOC5ST                          WAC5ST
     I              BOAFPC                          WAAFPC
     I              BOAGPC                          WAAGPC
     I              BOFEST                          WAFEST
     I              BOAAVN                          WAAAVN
     I              BOAADT                          WAAADT
     I              BOAMTM                          WAAMTM
     I              BOAJST                          WAAJST
     I              BOAHVN                          WAAHVN
     I              BOAGVN                          WAAGVN
     I              BOABVN                          WAABVN
     I              BOABDT                          WAABDT
     I              BOABTM                          WAABTM
      *
     I@A1CPXO
      * Tattoo Header             Kill/Shf/Ttto  Active
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@B6CPGX
      * Eval/Loss Error           Retrieval index
      * Renamed input format fields
     I              B6HRNB                          WCHRNB
     I              B6BPDT                          WCBPDT
     I              B6IRNB                          WCIRNB
     I              B6BONM                          WCBONM
     I              B6LDNM                          WCLDNM
     I              B6FPNB                          WCFPNB
     I              B6DYST                          WCDYST
     I              B6DXST                          WCDXST
     I              B6B7TX                          WCB7TX
     I              B6AAVN                          WCAAVN
     I              B6AADT                          WCAADT
     I              B6AMTM                          WCAMTM
     I              B6AJST                          WCAJST
     I              B6AHVN                          WCAHVN
     I              B6AGVN                          WCAGVN
     I              B6ABVN                          WCABVN
     I              B6ABDT                          WCABDT
     I              B6ABTM                          WCABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WDHRNB
     I              B6BPDT                          WDBPDT
     I              B6IRNB                          WDIRNB
     I              B6BONM                          WDBONM
     I              B6LDNM                          WDLDNM
     I              B6FPNB                          WDFPNB
     I              B6DYST                          WDDYST
     I              B6DXST                          WDDXST
     I              B6B7TX                          WDB7TX
     I              B6AAVN                          WDAAVN
     I              B6AADT                          WDAADT
     I              B6AMTM                          WDAMTM
     I              B6AJST                          WDAJST
     I              B6AHVN                          WDAHVN
     I              B6AGVN                          WDAGVN
     I              B6ABVN                          WDABVN
     I              B6ABDT                          WDABDT
     I              B6ABTM                          WDABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                            583
      * RCD : Tattoo Header             Retrieval index
      * I : MAP BOH Company Number
     I                                    P   1   20PAHMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : MAP BOL Load Number
     I                                    P   7   90PABONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : MAP TH Kill Date
     I                                    P  13  160PAB0DT
      * I : MAP TH Purchase Date
     I                                    P  17  200PAAWDT
      * I : MAP TH Group Reference
     I                                       21  30 PABICD
      * I : MAP TH Live Purchase UOM
     I                                       31  32 PACPST
      * I : MAP TH Live Purchase Price
     I                                    P  33  352PAACPR
      * I : MAP TH Live Gross Amt
     I                                    P  36  392PAB9PR
      * I : MAP TH LIve Net Amt
     I                                    P  40  432PACAPR
      * I : MAP TH Resale UOM
     I                                       44  45 PAC4ST
      * I : MAP TH Recalc Live Wgt Yld
     I                                    P  46  482PAAIPR
      * I : MAP TH Pricing Date
     I                                    P  49  520PAA6DT
      * I : MAP TH Resale Spread Sts
     I                                       53  53 PAC2ST
      * I : MAP TH Dead On Arrival
     I                                    P  54  560PACXNB
      * I : MAP TH Head Received
     I                                    P  57  590PACWNB
      * I : MAP TH Yard Deads
     I                                    P  60  620PAFCNB
      * I : MAP TH Held Over
     I                                    P  63  650PAH9NB
      * I : MAP TH Head Condemned
     I                                    P  66  680PAFDNB
      * I : MAP TH Head Killed
     I                                    P  69  710PAFENB
      * I : MAP TH Head Adds
     I                                    P  72  740PAHENB
      * I : MAP TH Head Accepted
     I                                    P  75  770PAHFNB
      * I : MAP TH Live Wgt
     I                                    P  78  811PACYNB
      * I : MAP TH Adj Live Wgt
     I                                    P  82  851PALRNB
      * I : MAP TH Hot Wgt
     I                                    P  86  891PAE0NB
      * I : MAP TH Tot Loin Eye Depth
     I                                    P  90  931PAA5PC
      * I : MAP TH Tot Backfat Inches
     I                                    P  94  971PAFBNB
      * I : MAP TH Tot Light Reflectance
     I                                    P  98 1011PAA4PC
      * I : MAP TH Avg Live Wgt
     I                                    P 102 1041PAF7NB
      * I : MAP TH Avg Hot Wgt
     I                                    P 105 1071PAHDNB
      * I : MAP TH Avg Light Reflectance
     I                                    P 108 1091PAF5NB
      * I : MAP TH Avg Lean Percent
     I                                    P 110 1111PAF4NB
      * I : MAP TH Avg Loin Eye Depth
     I                                    P 112 1131PAF3NB
      * I : MAP TH Avg Backfat
     I                                    P 114 1151PAF2NB
      * I : MAP TH Std Yield Percent
     I                                    P 116 1182PAAVPC
      * I : MAP TH Actual Yield %
     I                                    P 119 1212PAAWPC
      * I : MAP TH Adj Actual Yield %
     I                                    P 122 1242PACWPC
      * I : MAP TH Yield Difference
     I                                    P 125 1272PAA8PC
      * I : MAP TH Recalc Live Wgt
     I                                    P 128 1291PAA7PC
      * I : MAP TH CM Market Price
     I                                    P 130 1322PAB8PR
      * I : MAP TH CM Base Mkt Price
     I                                    P 133 1352PAAMPR
      * I : MAP TH CM Base Mkt Price Amt
     I                                    P 136 1392PAANPR
      * I : MAP TH CM Sort Discount Amt
     I                                    P 140 1432PAAYVA
      * I : MAP TH CM Yield Gain/Loss Amt
     I                                    P 144 1472PAAWVA
      * I : MAP TH CM Base Carcass Value
     I                                    P 148 1512PAAOPR
      * I : MAP TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552PAAXVA
      * I : MAP TH CM Carcass Gross Amt
     I                                    P 156 1592PAAPPR
      * I : MAP TH Deduction Amt
     I                                    P 160 1632PAASPR
      * I : MAP TH Total Net WO Adds
     I                                    P 164 1672PAA4VA
      * I : MAP TH Carcass Net Amt
     I                                    P 168 1712PAATPR
      * I : MAP TH Additions Amt
     I                                    P 172 1752PAA5VA
      * I : MAP TH Payment Gross
     I                                    P 176 1792PACBPR
      * I : MAP Th Payment Net Amt
     I                                    P 180 1832PACCPR
      * I : MAP TH AP Voucher/Document#
     I                                    P 184 1880PALPNB
      * I : MAP TH Freight Amount
     I                                    P 189 1922PACDPR
      * I : MAP TH Accrual Amount
     I                                    P 193 1962PAA7VA
      * I : MAP TH Fixed Cost Amount
     I                                    P 197 2002PAA2PR
      * I : MAP TH Calc Net Sts
     I                                      201 201 PAJWST
      * I : MAP TH Payment Sts
     I                                      202 203 PACWST
      * O : MAP TH Header Error Sts
     I                                      204 204 PAD7ST
      * O : MAP TH Detail Error Sts
     I                                      205 205 PAD8ST
      * O : MAP TH Kill Balancing Sts
     I                                      206 206 PADWST
      * O : MAP TH Bal to Kill Gen
     I                                      207 207 PAD6ST
      * I : MAP TH Commission A/P Voucher
     I                                      208 2150PAGHNB
      * I : MAP TH Voucher Payment Date
     I                                    P 216 2190PABYDT
      * I : MAP TH User Error Override
     I                                      220 220 PAE0ST
      * I : MAP TH Held Over Record
     I                                      221 221 PAE1ST
      * I : MAP TH Sex
     I                                      222 222 PAE2ST
      * I : MAP TH Held/Ovr Completed Dte
     I                                    P 223 2260PABSDT
      * I : MAP TH Commission Paid Date
     I                                    P 227 2300PABTDT
      * I : MAP TH Actual Check Date
     I                                    P 231 2340PABUDT
      * I : MAP TH Shipped Weight
     I                                    P 235 2381PAHGNB
      * I : MAP TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421PAHHNB
      * I : MAP TH FFLI
     I                                    P 243 2441PAHINB
      * I : MAP TH Kill Product Value
     I                                    P 245 2482PAA3PR
      * I : MAP TH Cut Product Value
     I                                    P 249 2522PAA4PR
      * I : MAP TH Render Product Value
     I                                    P 253 2562PAA6PR
      * I : MAP TH Head Excluded
     I                                    P 257 2590PAJ9NB
      * I : MAP TH CM Bse Mkt Live /CWT
     I                                    P 260 2622PAD6PR
      * I : MAP TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652PAD7PR
      * I : MAP TH CM Srt Dsc Live /CWT
     I                                    P 266 2682PAD8PR
      * I : MAP TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712PAD9PR
      * I : MAP TH CM Yld G/L Live /CWT
     I                                    P 272 2742PAEAPR
      * I : MAP TH CM Yld G/L Carc /CWT
     I                                    P 275 2772PAEBPR
      * I : MAP TH CM Crc Val Live /CWT
     I                                    P 278 2802PAECPR
      * I : MAP TH CM Crc Val Carc /CWT
     I                                    P 281 2832PAEDPR
      * I : MAP TH CM Lean Prem Live /CWT
     I                                    P 284 2862PAEEPR
      * I : MAP TH CM Lean Prem Carc /CWT
     I                                    P 287 2892PAEFPR
      * I : MAP TH CM Gross Live /CWT
     I                                    P 290 2922PAEGPR
      * I : MAP TH CM Gross Carc /CWT
     I                                    P 293 2952PAEHPR
      * I : MAP TH Source Type
     I                                      296 296 PAKAST
      * I : MAP TH Scale Ticket Sts
     I                                      297 297 PAJ7ST
      * I : MAP TH Payment Type
     I                                      298 298 PAJ9ST
      * I : MAP TH HPS Movement Ref #
     I                                    P 299 3020PAOXNB
      * I : MAP TH Source Code
     I                                      303 305 PALKST
      * I : MAP TH Hog Class Type
     I                                      306 306 PALLST
      * I : MAP TH Posted to HPS Flag
     I                                      307 307 PAJ8ST
      * I : MAP TH Schedule Kill Shift
     I                                      308 308 PALIST
      * I : MAP TH Shift Held Over
     I                                      309 309 PALJST
      * I : MAP DF Defect Code
     I                                      492 497 PABDCD
      * I : MAP THP Process Code
     I                                      498 503 PACSCD
      * I : MAP PD Producer Code
     I                                      504 509 PAABCD
      * I : MAP PL Location Code
     I                                      510 515 PAAECD
      * I : MAP HB Buyer Code
     I                                      516 518 PAACCD
      * I : MAP GN Genetic Code
     I                                      519 523 PAAGCD
      * I : MAP HC Class Code
     I                                      524 526 PABECD
      * I : MAP RS User Changed
     I                                      527 536 PAAAVN
      * I : MAP RS Date Changed
     I                                    P 537 5400PAAADT
      * I : MAP RS Time Changed
     I                                    P 541 5440PAAMTM
      * I : MAP RS Record Status
     I                                      545 545 PAAJST
      * I : MAP RS Job
     I                                      546 555 PAAHVN
      * I : MAP RS Program
     I                                      556 565 PAAGVN
      * I : MAP RS User Added
     I                                      566 575 PAABVN
      * I : MAP RS Date Added
     I                                    P 576 5790PAABDT
      * I : MAP RS Time Added
     I                                    P 580 5830PAABTM
      *
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WDHRNB
     I              B6BPDT                          WDBPDT
     I              B6IRNB                          WDIRNB
     I              B6BONM                          WDBONM
     I              B6LDNM                          WDLDNM
     I              B6FPNB                          WDFPNB
     I              B6DYST                          WDDYST
     I              B6DXST                          WDDXST
     I              B6B7TX                          WDB7TX
     I              B6AAVN                          WDAAVN
     I              B6AADT                          WDAADT
     I              B6AMTM                          WDAMTM
     I              B6AJST                          WDAJST
     I              B6AHVN                          WDAHVN
     I              B6AGVN                          WDAGVN
     I              B6ABVN                          WDABVN
     I              B6ABDT                          WDABDT
     I              B6ABTM                          WDABTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            583
     IYCRDCS      DS                            583
     IYDRDCS      DS                            583
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Tattoo Header             Shft/Kill/Err/Tatto
      * I : RST BOH Company Number
     I                                    P   1   20PBHMNB
      * I : RST TH Schedule Kill Shift
     I                                        3   3 PBLIST
      * I : RST TH Kill Date
     I                                    P   4   70PBB0DT
      * I : POS TH Kill Balancing Sts
     I                                        8   8 PBDWST
      *
      * Outward parameters
     IPCRC        DS                             28
      * KEY : Eval Trans                Tattoo Carcass Active
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PCBNNB
      * I : RST BOL Load Number
     I                                    P   7   90PCBONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PCCVNB
      * I : RST TH Kill Date
     I                                    P  13  160PCB0DT
      *
     IYERDCS      DS                            583
     IYFRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Control HPE
      * I : MAP CC Company Number
     I                                    P   1   20P1HONB
      * I : MAP Current Kill Date
     I                                    P   3   60P1B1DT
     IP2PARM      DS
      * FLD: Tattoo Header
      * I : MAP BOH Company Number
     I                                    P   1   20P2HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P2BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P2BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P2CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P2B0DT
      * I :  TH Kill Balancing Sts
     I                                       17  17 P2DWST
      * I : MAP TH Schedule Kill Shift
     I                                       18  18 P2LIST
     IP3PARM      DS
      * I : MAP Requested by User to Bal
     I                                        1   1 P3G2ST
     IP4PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P4EVTX
     IP5PARM      DS
      * I :  Execution Location    USR
     I                                        1   1 P5TUST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1B1DT    PARM           WP0002  70       Current Kill Da
     C           P2HMNB    PARM           WP0003  30       BOH Company Num
     C           P2BNNB    PARM           WP0004  70       BOH Buy Order N
     C           P2BONB    PARM           WP0005  50       BOL Load Number
     C           P2CVNB    PARM           WP0006  50       TH Tattoo Numbe
     C           P2B0DT    PARM           WP0007  70       TH Kill Date
     C           P2DWST    PARM           WP0008  1        TH Kill Balanci
     C           P2LIST    PARM           WP0009  1        TH Schedule Kil
     C           P3G2ST    PARM           WP0010  1        Requested by Us
     C           P4EVTX    PARM           WP0011 40        Oms System Valu
     C           P5TUST    PARM           WP0012  1        Execution Locat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bal Tattoo W/Kill Edt  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Load all validation errors for min/max
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
      * Read the Tatto file either all/ or 1 record
      * CASE: PAR.TH Tattoo Number is Zero
     C           P2CVNB    IFEQ *ZERO                      *IF
      * New 1/18/05 delete held overs that were undone
      * Exc Held Over Undo    XF - Tattoo Header  * 
     C                     CALL 'PLFGXFR'              90  Exc Held Over U
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM P1B1DT    WQ0002  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLFGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Batch balancing, upl will have shift but payment edit
      *       will process all shifts
      * Accumulate Totals Validate all Tatto's Carcass
      * Chg Fls/Bal ALL Tatto RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * Only on batch processing
      * Print Exception reports
      *       Print Evaluation errors
      *       Print Loss errors
      * CASE: PAR.TH Schedule Kill Shift EQ WRK.Blank Usr 1 fld Usr
     C           P2LIST    IFEQ WUIXTX                     *IF
      * shift  1
      * Prt Eval/Loss Excepts PF - Tattoo Header  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
     C                     MOVEL'1'       PBLIST    P      TH Schedule Kil
     C                     Z-ADDP1B1DT    PBB0DT           TH Kill Date
     C                     MOVELP2DWST    PBDWST    P      TH Kill Balanci
      *
     C                     CALL 'PKLIPFR'              90  Prt Eval/Loss E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
     C                     PARM P4EVTX    WQ0113 40        Oms System Valu
     C                     PARM P5TUST    WQ0114  1        Execution Locat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLIPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * shift  2
      * Prt Eval/Loss Excepts PF - Tattoo Header  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
     C                     MOVEL'2'       PBLIST    P      TH Schedule Kil
     C                     Z-ADDP1B1DT    PBB0DT           TH Kill Date
     C                     MOVELP2DWST    PBDWST    P      TH Kill Balanci
      *
     C                     CALL 'PKLIPFR'              90  Prt Eval/Loss E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
     C                     PARM P4EVTX    WQ0115 40        Oms System Valu
     C                     PARM P5TUST    WQ0116  1        Execution Locat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLIPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * shift requested
      * Prt Eval/Loss Excepts PF - Tattoo Header  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
     C                     MOVELP2LIST    PBLIST    P      TH Schedule Kil
     C                     Z-ADDP1B1DT    PBB0DT           TH Kill Date
     C                     MOVELP2DWST    PBDWST    P      TH Kill Balanci
      *
     C                     CALL 'PKLIPFR'              90  Prt Eval/Loss E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
     C                     PARM P4EVTX    WQ0117 40        Oms System Valu
     C                     PARM P5TUST    WQ0118  1        Execution Locat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLIPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Interactive balancing
      * Accumulate Totals Validate all Tatto's Carcass
      * Chg Fls/Bal 1 Tatto   RT - Tattoo Header  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           WABVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDWAAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDWAAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           WABVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDWAAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDWAAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           WABVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDWAAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDWAAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           WABVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDWAAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDWAAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           WABVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDWAAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDWAAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           WABVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDWAAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDWAAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           WABVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDWAAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDWAAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           WABVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDWAAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDWAAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           WABVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDWAAFPC    WUJHNB           Head < Percent
     C                     Z-ADDWAAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           WABVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDWAAFPC    WUJJNB           Head > Percent
     C                     Z-ADDWAAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           WABVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDWAAFPC    WUJDNB           High Yield Min
     C                     Z-ADDWAAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           WABVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDWAAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDWAAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Chg Fls/Bal ALL Tatto RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQSB02           TH Kill Date
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           TH Kill Date
     C                     KFLD           WBLIST           TH Schedule Kil
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           TH Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WQSB01           BOH Company Num
     C                     Z-ADDP1B1DT    WQSB02           TH Kill Date
     C                     MOVELP2LIST    WBLIST           TH Schedule Kil
      * Establish starting position
     C           KPSSB     SETLL@A1CPXO                    *
     C           KRSSB     READE@A1CPXO                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.TH Schedule Kill Shift NE WRK.Blank Usr 1 fld Usr
     C           P2LIST    IFNE WUIXTX                     *IF
      * CASE: PAR.TH Schedule Kill Shift EQ DB1.TH Schedule Kill Shift
     C           P2LIST    IFEQ WBLIST                     *IF
      * Pass in what shift to process
      * subject or market hogs process
      * CASE: check for hog class type of market, or subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'                        *OR
      * If receiving or slaughter processing code
      * CASE: Receiving or Slaughter
      *  - c1 OR c2
      *   |- c1    : DB1.THP Process Code is Receiving
      *   |- c2    : DB1.THP Process Code is Slaughter
      *   '-
     C           WBCSCD    IFEQ 'RECV'                     *IF
     C           WBCSCD    OREQ 'SLG'                      *OR
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0003  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0004  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0005  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0006  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0007  71       %Lean High Min
     C                     PARM WUJLNB    WQ0008  71       %Lean High Max
     C                     PARM WUJMNB    WQ0009  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0010  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0011  71       High Yield Min
     C                     PARM WUJENB    WQ0012  71       High Yield Max
     C                     PARM WUJFNB    WQ0013  71       Low Yield Min
     C                     PARM WUJGNB    WQ0014  71       Low Yield Max
     C                     PARM WUJHNB    WQ0015  71       Head < Percent
     C                     PARM WUJINB    WQ0016  71       Head < Percent
     C                     PARM WUJJNB    WQ0017  71       Head > Percent
     C                     PARM WUJKNB    WQ0018  71       Head > Percent
     C                     PARM WUK5NB    WQ0019  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0020  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0021  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0022  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0023  71       LoinEye High Mi
     C                     PARM WULANB    WQ0024  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0025  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0026  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0027  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If system says to balance tattoo then create records
      * CASE: WRK.TH Kill Balancing Sts is Balance
     C           WUDWST    IFEQ 'B'                        *IF
      * CASE: WRK.TH Bal to Kill Gen is System Generated
     C           WUD6ST    IFEQ 'G'                        *IF
      * Crt Add Rec By Tatto  XF - Eval Trans  * 
     C                     CALL 'PKLQXFR'              90  Crt Add Rec By
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0028  30       BOH Company Num
     C                     PARM WBBNNB    WQ0029  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0030  50       BOL Load Number
     C                     PARM WBCVNB    WQ0031  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0032  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0033  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0034  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0035  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0036  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0037  71       %Lean High Min
     C                     PARM WUJLNB    WQ0038  71       %Lean High Max
     C                     PARM WUJMNB    WQ0039  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0040  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0041  71       High Yield Min
     C                     PARM WUJENB    WQ0042  71       High Yield Max
     C                     PARM WUJFNB    WQ0043  71       Low Yield Min
     C                     PARM WUJGNB    WQ0044  71       Low Yield Max
     C                     PARM WUJHNB    WQ0045  71       Head < Percent
     C                     PARM WUJINB    WQ0046  71       Head < Percent
     C                     PARM WUJJNB    WQ0047  71       Head > Percent
     C                     PARM WUJKNB    WQ0048  71       Head > Percent
     C                     PARM WUK5NB    WQ0049  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0050  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0051  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0052  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0053  71       LoinEye High Mi
     C                     PARM WULANB    WQ0054  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0055  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0056  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0057  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * This tattoo header is in the process code at the incorrect time
      * either this is wip or payment
     C                     MOVEL'K'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SDCRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Resale
      * CASE: DB1.TH Hog Class Type is Resale
     C           WBLLST    IFEQ 'R'                        *IF
      * RESALE UPDATE ADJUSTED LIVE WEIGHT
     C           WBCWNB    SUB  WBFCNB    WUF6NB           Net Head Usr
     C                     SUB  WBFDNB    WUF6NB           Net Head Usr
      * Calculate Adj Live Weight
      * CASE: DB1.TH Head Received EQ WRK.Net Head Usr
     C           WBCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWBCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUF6NB    MULT WBF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * All and will be used in payments
      * subject or market hogs process
      * CASE: check for hog class type of market, or subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'                        *OR
      * If receiving or slaughter processing code
      * CASE: Receiving or Slaughter
      *  - c1 OR c2
      *   |- c1    : DB1.THP Process Code is Receiving
      *   |- c2    : DB1.THP Process Code is Slaughter
      *   '-
     C           WBCSCD    IFEQ 'RECV'                     *IF
     C           WBCSCD    OREQ 'SLG'                      *OR
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0058  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0059  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0060  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0061  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0062  71       %Lean High Min
     C                     PARM WUJLNB    WQ0063  71       %Lean High Max
     C                     PARM WUJMNB    WQ0064  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0065  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0066  71       High Yield Min
     C                     PARM WUJENB    WQ0067  71       High Yield Max
     C                     PARM WUJFNB    WQ0068  71       Low Yield Min
     C                     PARM WUJGNB    WQ0069  71       Low Yield Max
     C                     PARM WUJHNB    WQ0070  71       Head < Percent
     C                     PARM WUJINB    WQ0071  71       Head < Percent
     C                     PARM WUJJNB    WQ0072  71       Head > Percent
     C                     PARM WUJKNB    WQ0073  71       Head > Percent
     C                     PARM WUK5NB    WQ0074  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0075  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0076  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0077  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0078  71       LoinEye High Mi
     C                     PARM WULANB    WQ0079  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0080  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0081  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0082  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If system says to balance tattoo then create records
      * CASE: WRK.TH Kill Balancing Sts is Balance
     C           WUDWST    IFEQ 'B'                        *IF
      * CASE: WRK.TH Bal to Kill Gen is System Generated
     C           WUD6ST    IFEQ 'G'                        *IF
      * Crt Add Rec By Tatto  XF - Eval Trans  * 
     C                     CALL 'PKLQXFR'              90  Crt Add Rec By
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0083  30       BOH Company Num
     C                     PARM WBBNNB    WQ0084  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0085  50       BOL Load Number
     C                     PARM WBCVNB    WQ0086  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0087  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0088  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0089  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0090  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0091  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0092  71       %Lean High Min
     C                     PARM WUJLNB    WQ0093  71       %Lean High Max
     C                     PARM WUJMNB    WQ0094  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0095  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0096  71       High Yield Min
     C                     PARM WUJENB    WQ0097  71       High Yield Max
     C                     PARM WUJFNB    WQ0098  71       Low Yield Min
     C                     PARM WUJGNB    WQ0099  71       Low Yield Max
     C                     PARM WUJHNB    WQ0100  71       Head < Percent
     C                     PARM WUJINB    WQ0101  71       Head < Percent
     C                     PARM WUJJNB    WQ0102  71       Head > Percent
     C                     PARM WUJKNB    WQ0103  71       Head > Percent
     C                     PARM WUK5NB    WQ0104  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0105  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0106  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0107  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0108  71       LoinEye High Mi
     C                     PARM WULANB    WQ0109  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0110  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0111  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0112  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * This tattoo header is in the process code at the incorrect time
      * either this is wip or payment
     C                     MOVEL'K'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Resale
      * CASE: DB1.TH Hog Class Type is Resale
     C           WBLLST    IFEQ 'R'                        *IF
      * RESALE UPDATE ADJUSTED LIVE WEIGHT
     C           WBCWNB    SUB  WBFCNB    WUF6NB           Net Head Usr
     C                     SUB  WBFDNB    WUF6NB           Net Head Usr
      * Calculate Adj Live Weight
      * CASE: DB1.TH Head Received EQ WRK.Net Head Usr
     C           WBCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWBCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUF6NB    MULT WBF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@A1CPXO                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHRNB           KV Company Numb
     C                     KFLD           WCBPDT           KV Kill Date
     C                     KFLD           WCIRNB           KV TATTOO NUMBE
     C                     KFLD           WCBONM           KV Buy Order Nu
     C                     KFLD           WCLDNM           KV Load Number
     C                     KFLD           WCFPNB           KV Record Numbe
     C                     KFLD           WCDYST           KV Record Type
     C                     KFLD           WCDXST           KV Error Code
      * Setup key
     C                     Z-ADDWBHMNB    WCHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WCBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WCIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WCBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WCLDNM           KV Load Number
     C                     Z-ADD999999    WCFPNB           KV Record Numbe
     C                     MOVEL'H'       WCDYST           KV Record Type
     C                     MOVEL'HPC'     WCDXST           KV Error Code
      * Establish starting position
     C           KRSSC     CHAIN@B6CPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWBHMNB    WDHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WDBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WDIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WDBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WDLDNM           KV Load Number
     C                     Z-ADD999999    WDFPNB           KV Record Numbe
     C                     MOVEL'H'       WDDYST           KV Record Type
     C                     MOVEL'HPC'     WDDXST           KV Error Code
     C                     MOVEL@CN,001   WDB7TX           KV Error Descri
     C                     MOVEL@CN,002   WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,001   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           WDHRNB           KV Company Numb
     C                     KFLD           WDBPDT           KV Kill Date
     C                     KFLD           WDIRNB           KV TATTOO NUMBE
     C                     KFLD           WDBONM           KV Buy Order Nu
     C                     KFLD           WDLDNM           KV Load Number
     C                     KFLD           WDFPNB           KV Record Numbe
     C                     KFLD           WDDYST           KV Record Type
     C                     KFLD           WDDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WABVCD           EV Validation C
      * Setup key
     C                     MOVEL'HPC'     WABVCD           EV Validation C
      * Establish starting position
     C           KRSSE     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWACBTX    WDB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0014  50       TH Held Over
     C                     Z-ADD*ZERO     WN0015  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Detail Error
     C                     MOVEL*BLANK    WN0057  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0058  80       TH Commission A
     C                     Z-ADD*ZERO     WN0059  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0060  1        TH User Error O
     C                     MOVEL*BLANK    WN0061  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0062  1        TH Sex
     C                     Z-ADD*ZERO     WN0063  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0064  70       TH Commission P
     C                     Z-ADD*ZERO     WN0065  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0066  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0067  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0068  31       TH FFLI
     C                     Z-ADD*ZERO     WN0069  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0070  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0071  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0072  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0073  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0074  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0075  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0076  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0077  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0078  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0079  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0083  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0084  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0085  1        TH Source Type
     C                     MOVEL*BLANK    WN0086  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0087  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0088  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0089  3        TH Source Code
     C                     MOVEL*BLANK    WN0090  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0091  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0092  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0093  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0094  3        TH State
     C                     MOVEL*BLANK    WN0095  3        TH Unused Code
     C                     MOVEL*BLANK    WN0096  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0097  1        TH Commission S
     C                     MOVEL*BLANK    WN0098  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0099  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0100  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0101  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0102  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0103  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0104  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0105  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0106  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0107  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0108  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0109  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0110  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0111  3        TH PHA Average
     C                     MOVEL*BLANK    WN0112  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0113  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0114  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0115  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0116  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0117  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0118  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0119  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0120  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0121  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0122  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0123  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0124  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0125 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0126 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0127 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0128 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0129  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0130  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0131  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0132  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0133  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0134  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0135  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0136  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0137  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0138  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0139  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0140  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0141  70       TH Unused Date
     C                     MOVEL*BLANK    WN0142  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0143  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0144  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0145  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0146  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0147  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0148  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0149  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0150  6        DF Defect Code
     C                     MOVEL*BLANK    WN0151  6        THP Process Cod
     C                     MOVEL*BLANK    WN0152  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0153  6        PL Location Cod
     C                     MOVEL*BLANK    WN0154  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0155  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0156  3        HC Class Code
     C                     MOVEL*BLANK    WN0157 10        RS User Changed
     C                     Z-ADD*ZERO     WN0158  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0159  60       RS Time Changed
     C                     MOVEL*BLANK    WN0160  1        RS Record Statu
     C                     MOVEL*BLANK    WN0161 10        RS Job
     C                     MOVEL*BLANK    WN0162 10        RS Program
     C                     MOVEL*BLANK    WN0163 10        RS User Added
     C                     Z-ADD*ZERO     WN0164  70       RS Date Added
     C                     Z-ADD*ZERO     WN0165  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSF    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWUD7ST    WED7ST    P      TH Header Error
     C                     MOVELWUDWST    WEDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0166  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0167 10        TH Group Refere
     C                     MOVEL*BLANK    WN0168  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0169  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0170  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0171  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0172  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0173  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0174  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0175  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0176  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0177  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0178  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0179  50       TH Held Over
     C                     Z-ADD*ZERO     WN0180  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0181  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0182  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0183  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0184  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0185  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0186  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0187  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0188  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0189  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0190  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0191  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0192  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0193  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0194  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0195  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0196  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0197  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0198  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0199  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0200  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0201  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0202  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0203  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0204  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0205  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0206  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0207  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0208  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0209  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0210  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0211  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0212  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0213  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0214  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0215  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0216  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0217  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0218  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0219  1        TH Header Error
     C                     MOVEL*BLANK    WN0220  1        TH Detail Error
     C                     MOVEL*BLANK    WN0221  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0222  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0223  80       TH Commission A
     C                     Z-ADD*ZERO     WN0224  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0225  1        TH User Error O
     C                     MOVEL*BLANK    WN0226  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0227  1        TH Sex
     C                     Z-ADD*ZERO     WN0228  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0229  70       TH Commission P
     C                     Z-ADD*ZERO     WN0230  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0231  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0232  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0233  31       TH FFLI
     C                     Z-ADD*ZERO     WN0234  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0235  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0236  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0237  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0238  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0239  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0240  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0241  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0242  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0243  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0244  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0245  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0246  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0247  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0248  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0249  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0250  1        TH Source Type
     C                     MOVEL*BLANK    WN0251  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0252  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0253  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0254  3        TH Source Code
     C                     MOVEL*BLANK    WN0255  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0256  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0257  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0258  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0259  3        TH State
     C                     MOVEL*BLANK    WN0260  3        TH Unused Code
     C                     MOVEL*BLANK    WN0261  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0262  1        TH Commission S
     C                     MOVEL*BLANK    WN0263  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0264  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0265  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0266  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0267  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0268  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0269  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0270  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0271  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0272  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0273  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0274  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0275  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0276  3        TH PHA Average
     C                     MOVEL*BLANK    WN0277  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0278  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0279  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0280  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0281  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0282  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0283  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0284  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0285  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0286  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0287  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0288  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0289  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0290 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0291 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0292 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0293 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0294  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0295  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0296  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0297  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0298  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0299  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0300  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0301  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0302  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0303  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0304  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0305  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0306  70       TH Unused Date
     C                     MOVEL*BLANK    WN0307  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0308  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0309  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0310  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0311  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0312  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0313  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0314  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0315  6        DF Defect Code
     C                     MOVEL*BLANK    WN0316  6        THP Process Cod
     C                     MOVEL*BLANK    WN0317  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0318  6        PL Location Cod
     C                     MOVEL*BLANK    WN0319  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0320  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0321  3        HC Class Code
     C                     MOVEL*BLANK    WN0322 10        RS User Changed
     C                     Z-ADD*ZERO     WN0323  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0324  60       RS Time Changed
     C                     MOVEL*BLANK    WN0325  1        RS Record Statu
     C                     MOVEL*BLANK    WN0326 10        RS Job
     C                     MOVEL*BLANK    WN0327 10        RS Program
     C                     MOVEL*BLANK    WN0328 10        RS User Added
     C                     Z-ADD*ZERO     WN0329  70       RS Date Added
     C                     Z-ADD*ZERO     WN0330  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWULRNB    WELRNB           TH Adj Live Wgt
     C                     Z-ADDWBCWPC    WECWPC           TH Adj Actual Y
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCHRNB           KV Company Numb
     C                     KFLD           WCBPDT           KV Kill Date
     C                     KFLD           WCIRNB           KV TATTOO NUMBE
     C                     KFLD           WCBONM           KV Buy Order Nu
     C                     KFLD           WCLDNM           KV Load Number
     C                     KFLD           WCFPNB           KV Record Numbe
     C                     KFLD           WCDYST           KV Record Type
     C                     KFLD           WCDXST           KV Error Code
      * Setup key
     C                     Z-ADDWBHMNB    WCHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WCBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WCIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WCBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WCLDNM           KV Load Number
     C                     Z-ADD999999    WCFPNB           KV Record Numbe
     C                     MOVEL'H'       WCDYST           KV Record Type
     C                     MOVEL'HPC'     WCDXST           KV Error Code
      * Establish starting position
     C           KRSSH     CHAIN@B6CPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWBHMNB    WDHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WDBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WDIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WDBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WDLDNM           KV Load Number
     C                     Z-ADD999999    WDFPNB           KV Record Numbe
     C                     MOVEL'H'       WDDYST           KV Record Type
     C                     MOVEL'HPC'     WDDXST           KV Error Code
     C                     MOVEL@CN,001   WDB7TX           KV Error Descri
     C                     MOVEL@CN,002   WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,001   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WDHRNB           KV Company Numb
     C                     KFLD           WDBPDT           KV Kill Date
     C                     KFLD           WDIRNB           KV TATTOO NUMBE
     C                     KFLD           WDBONM           KV Buy Order Nu
     C                     KFLD           WDLDNM           KV Load Number
     C                     KFLD           WDFPNB           KV Record Numbe
     C                     KFLD           WDDYST           KV Record Type
     C                     KFLD           WDDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WABVCD           EV Validation C
      * Setup key
     C                     MOVEL'HPC'     WABVCD           EV Validation C
      * Establish starting position
     C           KRSSJ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWACBTX    WDB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0331  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0332 10        TH Group Refere
     C                     MOVEL*BLANK    WN0333  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0334  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0335  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0336  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0337  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0338  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0339  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0340  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0341  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0342  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0343  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0344  50       TH Held Over
     C                     Z-ADD*ZERO     WN0345  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0346  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0347  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0348  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0349  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0350  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0351  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0352  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0353  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0354  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0355  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0356  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0357  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0358  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0359  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0360  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0361  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0362  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0363  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0364  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0365  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0366  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0367  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0368  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0369  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0370  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0371  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0372  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0373  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0374  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0375  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0376  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0377  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0378  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0379  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0380  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0381  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0382  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0383  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0384  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0385  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0386  1        TH Detail Error
     C                     MOVEL*BLANK    WN0387  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0388  80       TH Commission A
     C                     Z-ADD*ZERO     WN0389  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0390  1        TH User Error O
     C                     MOVEL*BLANK    WN0391  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0392  1        TH Sex
     C                     Z-ADD*ZERO     WN0393  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0394  70       TH Commission P
     C                     Z-ADD*ZERO     WN0395  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0396  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0397  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0398  31       TH FFLI
     C                     Z-ADD*ZERO     WN0399  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0400  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0401  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0402  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0403  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0404  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0405  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0406  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0407  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0408  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0409  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0410  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0411  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0412  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0413  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0414  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0415  1        TH Source Type
     C                     MOVEL*BLANK    WN0416  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0417  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0418  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0419  3        TH Source Code
     C                     MOVEL*BLANK    WN0420  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0421  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0422  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0423  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0424  3        TH State
     C                     MOVEL*BLANK    WN0425  3        TH Unused Code
     C                     MOVEL*BLANK    WN0426  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0427  1        TH Commission S
     C                     MOVEL*BLANK    WN0428  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0429  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0430  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0431  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0432  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0433  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0434  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0435  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0436  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0437  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0438  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0439  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0440  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0441  3        TH PHA Average
     C                     MOVEL*BLANK    WN0442  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0443  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0444  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0445  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0446  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0447  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0448  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0449  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0450  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0451  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0452  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0453  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0454  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0455 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0456 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0457 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0458 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0459  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0460  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0461  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0462  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0463  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0464  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0465  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0466  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0467  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0468  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0469  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0470  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0471  70       TH Unused Date
     C                     MOVEL*BLANK    WN0472  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0473  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0474  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0475  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0476  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0477  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0478  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0479  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0480  6        DF Defect Code
     C                     MOVEL*BLANK    WN0481  6        THP Process Cod
     C                     MOVEL*BLANK    WN0482  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0483  6        PL Location Cod
     C                     MOVEL*BLANK    WN0484  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0485  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0486  3        HC Class Code
     C                     MOVEL*BLANK    WN0487 10        RS User Changed
     C                     Z-ADD*ZERO     WN0488  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0489  60       RS Time Changed
     C                     MOVEL*BLANK    WN0490  1        RS Record Statu
     C                     MOVEL*BLANK    WN0491 10        RS Job
     C                     MOVEL*BLANK    WN0492 10        RS Program
     C                     MOVEL*BLANK    WN0493 10        RS User Added
     C                     Z-ADD*ZERO     WN0494  70       RS Date Added
     C                     Z-ADD*ZERO     WN0495  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSK    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSK    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWUD7ST    WED7ST    P      TH Header Error
     C                     MOVELWUDWST    WEDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0496  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0497 10        TH Group Refere
     C                     MOVEL*BLANK    WN0498  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0499  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0500  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0501  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0502  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0503  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0504  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0505  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0506  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0507  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0508  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0509  50       TH Held Over
     C                     Z-ADD*ZERO     WN0510  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0511  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0512  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0513  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0514  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0515  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0516  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0517  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0518  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0519  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0520  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0521  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0522  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0523  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0524  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0525  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0526  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0527  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0528  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0529  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0530  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0531  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0532  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0533  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0534  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0535  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0536  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0537  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0538  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0539  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0540  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0541  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0542  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0543  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0544  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0545  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0546  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0547  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0548  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0549  1        TH Header Error
     C                     MOVEL*BLANK    WN0550  1        TH Detail Error
     C                     MOVEL*BLANK    WN0551  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0552  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0553  80       TH Commission A
     C                     Z-ADD*ZERO     WN0554  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0555  1        TH User Error O
     C                     MOVEL*BLANK    WN0556  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0557  1        TH Sex
     C                     Z-ADD*ZERO     WN0558  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0559  70       TH Commission P
     C                     Z-ADD*ZERO     WN0560  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0561  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0562  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0563  31       TH FFLI
     C                     Z-ADD*ZERO     WN0564  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0565  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0566  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0567  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0568  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0569  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0570  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0571  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0572  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0573  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0574  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0575  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0576  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0577  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0578  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0579  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0580  1        TH Source Type
     C                     MOVEL*BLANK    WN0581  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0582  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0583  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0584  3        TH Source Code
     C                     MOVEL*BLANK    WN0585  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0586  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0587  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0588  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0589  3        TH State
     C                     MOVEL*BLANK    WN0590  3        TH Unused Code
     C                     MOVEL*BLANK    WN0591  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0592  1        TH Commission S
     C                     MOVEL*BLANK    WN0593  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0594  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0595  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0596  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0597  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0598  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0599  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0600  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0601  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0602  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0603  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0604  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0605  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0606  3        TH PHA Average
     C                     MOVEL*BLANK    WN0607  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0608  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0609  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0610  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0611  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0612  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0613  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0614  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0615  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0616  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0617  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0618  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0619  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0620 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0621 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0622 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0623 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0624  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0625  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0626  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0627  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0628  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0629  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0630  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0631  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0632  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0633  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0634  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0635  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0636  70       TH Unused Date
     C                     MOVEL*BLANK    WN0637  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0638  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0639  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0640  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0641  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0642  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0643  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0644  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0645  6        DF Defect Code
     C                     MOVEL*BLANK    WN0646  6        THP Process Cod
     C                     MOVEL*BLANK    WN0647  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0648  6        PL Location Cod
     C                     MOVEL*BLANK    WN0649  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0650  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0651  3        HC Class Code
     C                     MOVEL*BLANK    WN0652 10        RS User Changed
     C                     Z-ADD*ZERO     WN0653  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0654  60       RS Time Changed
     C                     MOVEL*BLANK    WN0655  1        RS Record Statu
     C                     MOVEL*BLANK    WN0656 10        RS Job
     C                     MOVEL*BLANK    WN0657 10        RS Program
     C                     MOVEL*BLANK    WN0658 10        RS User Added
     C                     Z-ADD*ZERO     WN0659  70       RS Date Added
     C                     Z-ADD*ZERO     WN0660  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSL    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWULRNB    WELRNB           TH Adj Live Wgt
     C                     Z-ADDWBCWPC    WECWPC           TH Adj Actual Y
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Chg Fls/Bal 1 Tatto   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQSM02           TH Kill Date
     C           *LIKE     DEFN WBLIST    WQSM03           TH Schedule Kil
     C           *LIKE     DEFN WBCVNB    WQSM04           TH Tattoo Numbe
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           TH Kill Date
     C                     KFLD           WQSM03           TH Schedule Kil
     C                     KFLD           WQSM04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDP2HMNB    WQSM01           BOH Company Num
     C                     Z-ADDP2B0DT    WQSM02           TH Kill Date
     C                     MOVELP2LIST    WQSM03           TH Schedule Kil
     C                     Z-ADDP2CVNB    WQSM04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSM     SETLL@A1CPXO                    *
     C           KRSSM     READE@A1CPXO                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * subject or market hogs process
      * CASE: Check for Hog Class Type of Market, or Subject
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'                        *OR
      * If receiving or slaughter processing code
      * CASE: Receiving or Slaughter
      *  - c1 OR c2
      *   |- c1    : DB1.THP Process Code is Receiving
      *   |- c2    : DB1.THP Process Code is Slaughter
      *   '-
     C           WBCSCD    IFEQ 'RECV'                     *IF
     C           WBCSCD    OREQ 'SLG'                      *OR
      * CASE: PAR.Requested by User to Bal is Yes
     C           P3G2ST    IFEQ 'Y'                        *IF
      * Dlt Add Rec by Tatto  XF - Eval Trans  * 
     C                     CLEARPCRC
     C                     Z-ADDWBHMNB    PCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    PCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PCB0DT           TH Kill Date
      *
     C                     CALL 'PKLPXFR'              90  Dlt Add Rec by
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Eval Trans
     C                     PARM P3G2ST    WQ0119  1        Requested by Us
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0120  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0121  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0122  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0123  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0124  71       %Lean High Min
     C                     PARM WUJLNB    WQ0125  71       %Lean High Max
     C                     PARM WUJMNB    WQ0126  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0127  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0128  71       High Yield Min
     C                     PARM WUJENB    WQ0129  71       High Yield Max
     C                     PARM WUJFNB    WQ0130  71       Low Yield Min
     C                     PARM WUJGNB    WQ0131  71       Low Yield Max
     C                     PARM WUJHNB    WQ0132  71       Head < Percent
     C                     PARM WUJINB    WQ0133  71       Head < Percent
     C                     PARM WUJJNB    WQ0134  71       Head > Percent
     C                     PARM WUJKNB    WQ0135  71       Head > Percent
     C                     PARM WUK5NB    WQ0136  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0137  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0138  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0139  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0140  71       LoinEye High Mi
     C                     PARM WULANB    WQ0141  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0142  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0143  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0144  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Tattoo is either balanced or ready to create add records
      * CASE: WRK.TH Kill Balancing Sts is Balance
     C           WUDWST    IFEQ 'B'                        *IF
      * If true this will then create plug records
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.TH Bal to Kill Gen is System Generated
      *   |- c2    : WRK.TH Bal to Kill Gen is User Requested Generated
      *   '-
     C           WUD6ST    IFEQ 'G'                        *IF
     C           WUD6ST    OREQ 'U'                        *OR
      * Crt Add Rec By Tatto  XF - Eval Trans  * 
     C                     CALL 'PKLQXFR'              90  Crt Add Rec By
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0145  30       BOH Company Num
     C                     PARM WBBNNB    WQ0146  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0147  50       BOL Load Number
     C                     PARM WBCVNB    WQ0148  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0149  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * After creation revalidate for totals and reverifing
      * Val Kill Transaction   XF - STR Batch Processing  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
     C                     Z-ADDWBAWDT    PAAWDT           TH Purchase Dat
     C                     MOVELWBBICD    PABICD    P      TH Group Refere
     C                     MOVELWBCPST    PACPST    P      TH Live Purchas
     C                     Z-ADDWBACPR    PAACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    PAB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    PACAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    PAC4ST    P      TH Resale UOM
     C                     Z-ADDWBAIPR    PAAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    PAA6DT           TH Pricing Date
     C                     MOVELWBC2ST    PAC2ST    P      TH Resale Sprea
     C                     Z-ADDWBCXNB    PACXNB           TH Dead On Arri
     C                     Z-ADDWBCWNB    PACWNB           TH Head Receive
     C                     Z-ADDWBFCNB    PAFCNB           TH Yard Deads
     C                     Z-ADDWBH9NB    PAH9NB           TH Held Over
     C                     Z-ADDWBFDNB    PAFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    PAFENB           TH Head Killed
     C                     Z-ADDWBHENB    PAHENB           TH Head Adds
     C                     Z-ADDWBHFNB    PAHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    PACYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    PALRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    PAE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    PAA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    PAFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    PAA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    PAF7NB           TH Avg Live Wgt
     C                     Z-ADDWBHDNB    PAHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    PAF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    PAF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    PAF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    PAF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    PAAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    PAAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    PACWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    PAA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    PAA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    PAB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    PAAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    PAANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    PAAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    PAAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    PAAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    PAAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    PAAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    PAASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    PAA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    PAATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    PAA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    PACBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    PACCPR           Th Payment Net
     C                     Z-ADDWBLPNB    PALPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    PACDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    PAA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    PAA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    PAJWST    P      TH Calc Net Sts
     C                     MOVELWBCWST    PACWST    P      TH Payment Sts
     C                     Z-ADDWBGHNB    PAGHNB           TH Commission A
     C                     Z-ADDWBBYDT    PABYDT           TH Voucher Paym
     C                     MOVELWBE0ST    PAE0ST    P      TH User Error O
     C                     MOVELWBE1ST    PAE1ST    P      TH Held Over Re
     C                     MOVELWBE2ST    PAE2ST    P      TH Sex
     C                     Z-ADDWBBSDT    PABSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    PABTDT           TH Commission P
     C                     Z-ADDWBBUDT    PABUDT           TH Actual Check
     C                     Z-ADDWBHGNB    PAHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    PAHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    PAHINB           TH FFLI
     C                     Z-ADDWBA3PR    PAA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    PAA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    PAA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    PAJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    PAD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    PAD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    PAD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    PAD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    PAEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    PAEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    PAECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    PAEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    PAEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    PAEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    PAEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    PAEHPR           TH CM Gross Car
     C                     MOVELWBKAST    PAKAST    P      TH Source Type
     C                     MOVELWBJ7ST    PAJ7ST    P      TH Scale Ticket
     C                     MOVELWBJ9ST    PAJ9ST    P      TH Payment Type
     C                     Z-ADDWBOXNB    PAOXNB           TH HPS Movement
     C                     MOVELWBLKST    PALKST    P      TH Source Code
     C                     MOVELWBLLST    PALLST    P      TH Hog Class Ty
     C                     MOVELWBJ8ST    PAJ8ST    P      TH Posted to HP
     C                     MOVELWBLIST    PALIST    P      TH Schedule Kil
     C                     MOVELWBLJST    PALJST    P      TH Shift Held O
     C                     MOVELWBBDCD    PABDCD    P      DF Defect Code
     C                     MOVELWBCSCD    PACSCD    P      THP Process Cod
     C                     MOVELWBABCD    PAABCD    P      PD Producer Cod
     C                     MOVELWBAECD    PAAECD    P      PL Location Cod
     C                     MOVELWBACCD    PAACCD    P      HB Buyer Code
     C                     MOVELWBAGCD    PAAGCD    P      GN Genetic Code
     C                     MOVELWBBECD    PABECD    P      HC Class Code
     C                     MOVELWBAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    PAAADT           RS Date Changed
     C                     Z-ADDWBAMTM    PAAMTM           RS Time Changed
     C                     MOVELWBAJST    PAAJST    P      RS Record Statu
     C                     MOVELWBAHVN    PAAHVN    P      RS Job
     C                     MOVELWBAGVN    PAAGVN    P      RS Program
     C                     MOVELWBABVN    PAABVN    P      RS User Added
     C                     Z-ADDWBABDT    PAABDT           RS Date Added
     C                     Z-ADDWBABTM    PAABTM           RS Time Added
      *
     C                     CALL 'PKHJXFR'              90  Val Kill Transa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Tattoo Hea
     C                     PARM WUI7NB    WQ0150  71       Carcass Dbw Min
     C                     PARM WUI8NB    WQ0151  71       Carcass Dbw Max
     C                     PARM WUI9NB    WQ0152  71       Carcass Lgt Min
     C                     PARM WUJANB    WQ0153  71       Carcass Lgt Max
     C                     PARM WUJBNB    WQ0154  71       %Lean High Min
     C                     PARM WUJLNB    WQ0155  71       %Lean High Max
     C                     PARM WUJMNB    WQ0156  71       %Lean Low Min
     C                     PARM WUJCNB    WQ0157  71       %Lean Low Max
     C                     PARM WUJDNB    WQ0158  71       High Yield Min
     C                     PARM WUJENB    WQ0159  71       High Yield Max
     C                     PARM WUJFNB    WQ0160  71       Low Yield Min
     C                     PARM WUJGNB    WQ0161  71       Low Yield Max
     C                     PARM WUJHNB    WQ0162  71       Head < Percent
     C                     PARM WUJINB    WQ0163  71       Head < Percent
     C                     PARM WUJJNB    WQ0164  71       Head > Percent
     C                     PARM WUJKNB    WQ0165  71       Head > Percent
     C                     PARM WUK5NB    WQ0166  71       BackFat High Mi
     C                     PARM WUK6NB    WQ0167  71       BackFat High Ma
     C                     PARM WUK7NB    WQ0168  71       BackFat Low Min
     C                     PARM WUK8NB    WQ0169  71       Backfat Low Max
     C                     PARM WUK9NB    WQ0170  71       LoinEye High Mi
     C                     PARM WULANB    WQ0171  71       LoinEye High Ma
     C                     PARM WULBNB    WQ0172  71       LoinEye Low Min
     C                     PARM WULCNB    WQ0173  71       LoinEye Low Max
     C                     PARM P3G2ST    WQ0174  1        Requested by Us
      *
     C                     MOVELPAD7ST    WUD7ST           TH Header Error
     C                     MOVELPAD8ST    WUD8ST           TH Detail Error
     C                     MOVELPADWST    WUDWST           TH Kill Balanci
     C                     MOVELPAD6ST    WUD6ST           TH Bal to Kill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKHJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * This tattoo header is in the process code at the incorrect time
      * either this is wip or payment
     C                     MOVEL'K'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
     C                     EXSR SQCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           WBCWNB    SUB  WBFCNB    WUF6NB           Net Head Usr
     C                     SUB  WBFDNB    WUF6NB           Net Head Usr
      * Calculate Adj Live Weight
      * CASE: DB1.TH Head Received EQ WRK.Net Head Usr
     C           WBCWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDWBCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUF6NB    MULT WBF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C           KRSSM     READE@A1CPXO                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Check For Pay Err RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCHRNB           KV Company Numb
     C                     KFLD           WCBPDT           KV Kill Date
     C                     KFLD           WCIRNB           KV TATTOO NUMBE
     C                     KFLD           WCBONM           KV Buy Order Nu
     C                     KFLD           WCLDNM           KV Load Number
     C                     KFLD           WCFPNB           KV Record Numbe
     C                     KFLD           WCDYST           KV Record Type
     C                     KFLD           WCDXST           KV Error Code
      * Setup key
     C                     Z-ADDWBHMNB    WCHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WCBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WCIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WCBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WCLDNM           KV Load Number
     C                     Z-ADD999999    WCFPNB           KV Record Numbe
     C                     MOVEL'H'       WCDYST           KV Record Type
     C                     MOVEL'HPC'     WCDXST           KV Error Code
      * Establish starting position
     C           KRSSN     CHAIN@B6CPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWBHMNB    WDHRNB           KV Company Numb
     C                     Z-ADDWBB0DT    WDBPDT           KV Kill Date
     C                     Z-ADDWBCVNB    WDIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBNNB    WDBONM           KV Buy Order Nu
     C                     Z-ADDWBBONB    WDLDNM           KV Load Number
     C                     Z-ADD999999    WDFPNB           KV Record Numbe
     C                     MOVEL'H'       WDDYST           KV Record Type
     C                     MOVEL'HPC'     WDDXST           KV Error Code
     C                     MOVEL@CN,001   WDB7TX           KV Error Descri
     C                     MOVEL@CN,002   WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,001   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WDHRNB           KV Company Numb
     C                     KFLD           WDBPDT           KV Kill Date
     C                     KFLD           WDIRNB           KV TATTOO NUMBE
     C                     KFLD           WDBONM           KV Buy Order Nu
     C                     KFLD           WDLDNM           KV Load Number
     C                     KFLD           WDFPNB           KV Record Numbe
     C                     KFLD           WDDYST           KV Record Type
     C                     KFLD           WDDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WABVCD           EV Validation C
      * Setup key
     C                     MOVEL'HPC'     WABVCD           EV Validation C
      * Establish starting position
     C           KRSSP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWACBTX    WDB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Tattoo Hdr Bal Sts CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0661  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0662 10        TH Group Refere
     C                     MOVEL*BLANK    WN0663  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0664  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0665  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0666  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0667  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0668  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0669  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0670  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0671  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0672  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0673  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0674  50       TH Held Over
     C                     Z-ADD*ZERO     WN0675  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0676  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0677  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0678  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0679  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0680  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0681  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0682  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0683  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0684  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0685  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0686  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0687  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0688  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0689  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0690  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0691  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0692  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0693  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0694  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0695  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0696  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0697  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0698  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0699  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0700  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0701  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0702  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0703  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0704  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0705  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0706  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0707  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0708  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0709  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0710  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0711  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0712  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0713  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0714  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0715  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0716  1        TH Detail Error
     C                     MOVEL*BLANK    WN0717  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0718  80       TH Commission A
     C                     Z-ADD*ZERO     WN0719  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0720  1        TH User Error O
     C                     MOVEL*BLANK    WN0721  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0722  1        TH Sex
     C                     Z-ADD*ZERO     WN0723  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0724  70       TH Commission P
     C                     Z-ADD*ZERO     WN0725  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0726  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0727  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0728  31       TH FFLI
     C                     Z-ADD*ZERO     WN0729  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0730  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0731  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0732  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0733  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0734  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0735  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0736  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0737  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0738  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0739  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0740  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0741  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0742  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0743  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0744  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0745  1        TH Source Type
     C                     MOVEL*BLANK    WN0746  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0747  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0748  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0749  3        TH Source Code
     C                     MOVEL*BLANK    WN0750  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0751  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0752  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0753  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0754  3        TH State
     C                     MOVEL*BLANK    WN0755  3        TH Unused Code
     C                     MOVEL*BLANK    WN0756  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0757  1        TH Commission S
     C                     MOVEL*BLANK    WN0758  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0759  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0760  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0761  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0762  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0763  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0764  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0765  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0766  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0767  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0768  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0769  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0770  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0771  3        TH PHA Average
     C                     MOVEL*BLANK    WN0772  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0773  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0774  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0775  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0776  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0777  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0778  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0779  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0780  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0781  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0782  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0783  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0784  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0785 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0786 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0787 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0788 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0789  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0790  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0791  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0792  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0793  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0794  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0795  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0796  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0797  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0798  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0799  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0800  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0801  70       TH Unused Date
     C                     MOVEL*BLANK    WN0802  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0803  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0804  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0805  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0806  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0807  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0808  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0809  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0810  6        DF Defect Code
     C                     MOVEL*BLANK    WN0811  6        THP Process Cod
     C                     MOVEL*BLANK    WN0812  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0813  6        PL Location Cod
     C                     MOVEL*BLANK    WN0814  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0815  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0816  3        HC Class Code
     C                     MOVEL*BLANK    WN0817 10        RS User Changed
     C                     Z-ADD*ZERO     WN0818  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0819  60       RS Time Changed
     C                     MOVEL*BLANK    WN0820  1        RS Record Statu
     C                     MOVEL*BLANK    WN0821 10        RS Job
     C                     MOVEL*BLANK    WN0822 10        RS Program
     C                     MOVEL*BLANK    WN0823 10        RS User Added
     C                     Z-ADD*ZERO     WN0824  70       RS Date Added
     C                     Z-ADD*ZERO     WN0825  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSQ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWUD7ST    WED7ST    P      TH Header Error
     C                     MOVELWUDWST    WEDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Adj lv Wgt/Adj Yld CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0826  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0827 10        TH Group Refere
     C                     MOVEL*BLANK    WN0828  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0829  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0830  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0831  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0832  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0833  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0834  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0835  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0836  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0837  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0838  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0839  50       TH Held Over
     C                     Z-ADD*ZERO     WN0840  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0841  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0842  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0843  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0844  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0845  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0846  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0847  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0848  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0849  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0850  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0851  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0852  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0853  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0854  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0855  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0856  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0857  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0858  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0859  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0860  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0861  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0862  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0863  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0864  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0865  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0866  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0867  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0868  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0869  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0870  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0871  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0872  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0873  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0874  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0875  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0876  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0877  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0878  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0879  1        TH Header Error
     C                     MOVEL*BLANK    WN0880  1        TH Detail Error
     C                     MOVEL*BLANK    WN0881  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0882  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0883  80       TH Commission A
     C                     Z-ADD*ZERO     WN0884  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0885  1        TH User Error O
     C                     MOVEL*BLANK    WN0886  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0887  1        TH Sex
     C                     Z-ADD*ZERO     WN0888  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0889  70       TH Commission P
     C                     Z-ADD*ZERO     WN0890  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0891  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0892  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0893  31       TH FFLI
     C                     Z-ADD*ZERO     WN0894  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0895  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0896  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0897  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0898  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0899  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0900  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0901  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0902  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0903  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0904  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0905  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0906  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0907  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0908  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0909  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0910  1        TH Source Type
     C                     MOVEL*BLANK    WN0911  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0912  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0913  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0914  3        TH Source Code
     C                     MOVEL*BLANK    WN0915  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0916  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0917  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0918  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0919  3        TH State
     C                     MOVEL*BLANK    WN0920  3        TH Unused Code
     C                     MOVEL*BLANK    WN0921  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0922  1        TH Commission S
     C                     MOVEL*BLANK    WN0923  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0924  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0925  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0926  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0927  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0928  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0929  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0930  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0931  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0932  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0933  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0934  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0935  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0936  3        TH PHA Average
     C                     MOVEL*BLANK    WN0937  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0938  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0939  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0940  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0941  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0942  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0943  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0944  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0945  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0946  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0947  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0948  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0949  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0950 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0951 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0952 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0953 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0954  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0955  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0956  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0957  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0958  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0959  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0960  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0961  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0962  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0963  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0964  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0965  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0966  70       TH Unused Date
     C                     MOVEL*BLANK    WN0967  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0968  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0969  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0970  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0971  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0972  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0973  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0974  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0975  6        DF Defect Code
     C                     MOVEL*BLANK    WN0976  6        THP Process Cod
     C                     MOVEL*BLANK    WN0977  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0978  6        PL Location Cod
     C                     MOVEL*BLANK    WN0979  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0980  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0981  3        HC Class Code
     C                     MOVEL*BLANK    WN0982 10        RS User Changed
     C                     Z-ADD*ZERO     WN0983  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0984  60       RS Time Changed
     C                     MOVEL*BLANK    WN0985  1        RS Record Statu
     C                     MOVEL*BLANK    WN0986 10        RS Job
     C                     MOVEL*BLANK    WN0987 10        RS Program
     C                     MOVEL*BLANK    WN0988 10        RS User Added
     C                     Z-ADD*ZERO     WN0989  70       RS Date Added
     C                     Z-ADD*ZERO     WN0990  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSR    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSR    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YFRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWULRNB    WELRNB           TH Adj Live Wgt
     C                     Z-ADDWBCWPC    WECWPC           TH Adj Actual Y
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI7NB  71
      * Define work field Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI8NB  71
      * Define work field Carcass Lgt Min
     C                     Z-ADD*ZERO     WUI9NB  71
      * Define work field Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJANB  71
      * Define work field %Lean High Min
     C                     Z-ADD*ZERO     WUJBNB  71
      * Define work field %Lean High Max
     C                     Z-ADD*ZERO     WUJLNB  71
      * Define work field %Lean Low Min
     C                     Z-ADD*ZERO     WUJMNB  71
      * Define work field %Lean Low Max
     C                     Z-ADD*ZERO     WUJCNB  71
      * Define work field High Yield Min
     C                     Z-ADD*ZERO     WUJDNB  71
      * Define work field High Yield Max
     C                     Z-ADD*ZERO     WUJENB  71
      * Define work field Low Yield Min
     C                     Z-ADD*ZERO     WUJFNB  71
      * Define work field Low Yield Max
     C                     Z-ADD*ZERO     WUJGNB  71
      * Define work field Head < Percent Min
     C                     Z-ADD*ZERO     WUJHNB  71
      * Define work field Head < Percent Max
     C                     Z-ADD*ZERO     WUJINB  71
      * Define work field Head > Percent Min
     C                     Z-ADD*ZERO     WUJJNB  71
      * Define work field Head > Percent Max
     C                     Z-ADD*ZERO     WUJKNB  71
      * Define work field BackFat High Min
     C                     Z-ADD*ZERO     WUK5NB  71
      * Define work field BackFat High Max
     C                     Z-ADD*ZERO     WUK6NB  71
      * Define work field BackFat Low Min
     C                     Z-ADD*ZERO     WUK7NB  71
      * Define work field Backfat Low Max
     C                     Z-ADD*ZERO     WUK8NB  71
      * Define work field LoinEye High Min
     C                     Z-ADD*ZERO     WUK9NB  71
      * Define work field LoinEye High Max
     C                     Z-ADD*ZERO     WULANB  71
      * Define work field LoinEye Low Min
     C                     Z-ADD*ZERO     WULBNB  71
      * Define work field LoinEye Low Max
     C                     Z-ADD*ZERO     WULCNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAFPC           EV Minimum
     C                     Z-ADD*ZERO     WAAGPC           EV Maximum
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field TH Header Error Sts
     C                     MOVEL*BLANK    WUD7ST  1
      * Define work field TH Detail Error Sts
     C                     MOVEL*BLANK    WUD8ST  1
      * Define work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    WUDWST  1
      * Define work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    WUD6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WCBPDT           KV Kill Date
     C                     Z-ADD*ZERO     WCIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WCBONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WCLDNM           KV Load Number
     C                     Z-ADD*ZERO     WCFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Header Process Code Invld
00002 *BLANKS
